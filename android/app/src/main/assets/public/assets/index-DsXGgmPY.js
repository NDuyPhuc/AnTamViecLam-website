var fG=Object.defineProperty;var C2=n=>{throw TypeError(n)};var pG=(n,e,t)=>e in n?fG(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var X=(n,e,t)=>pG(n,typeof e!="symbol"?e+"":e,t),SA=(n,e,t)=>e.has(n)||C2("Cannot "+t);var S=(n,e,t)=>(SA(n,e,"read from private field"),t?t.call(n):e.get(n)),se=(n,e,t)=>e.has(n)?C2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),H=(n,e,t,r)=>(SA(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),we=(n,e,t)=>(SA(n,e,"access private method"),t);var Jg=(n,e,t,r)=>({set _(i){H(n,e,i,t)},get _(){return S(n,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function K5(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var NA={exports:{}},Yg={},kA={exports:{}},gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S2;function mG(){if(S2)return gt;S2=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function _(z){return z===null||typeof z!="object"?null:(z=m&&z[m]||z["@@iterator"],typeof z=="function"?z:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,A={};function N(z,ce,Pe){this.props=z,this.context=ce,this.refs=A,this.updater=Pe||x}N.prototype.isReactComponent={},N.prototype.setState=function(z,ce){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ce,"setState")},N.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function F(){}F.prototype=N.prototype;function B(z,ce,Pe){this.props=z,this.context=ce,this.refs=A,this.updater=Pe||x}var O=B.prototype=new F;O.constructor=B,b(O,N.prototype),O.isPureReactComponent=!0;var q=Array.isArray,W=Object.prototype.hasOwnProperty,$={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function k(z,ce,Pe){var Re,Ye={},Xe=null,et=null;if(ce!=null)for(Re in ce.ref!==void 0&&(et=ce.ref),ce.key!==void 0&&(Xe=""+ce.key),ce)W.call(ce,Re)&&!D.hasOwnProperty(Re)&&(Ye[Re]=ce[Re]);var Ne=arguments.length-2;if(Ne===1)Ye.children=Pe;else if(1<Ne){for(var Te=Array(Ne),Ve=0;Ve<Ne;Ve++)Te[Ve]=arguments[Ve+2];Ye.children=Te}if(z&&z.defaultProps)for(Re in Ne=z.defaultProps,Ne)Ye[Re]===void 0&&(Ye[Re]=Ne[Re]);return{$$typeof:n,type:z,key:Xe,ref:et,props:Ye,_owner:$.current}}function R(z,ce){return{$$typeof:n,type:z.type,key:ce,ref:z.ref,props:z.props,_owner:z._owner}}function U(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function M(z){var ce={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(Pe){return ce[Pe]})}var j=/\/+/g;function V(z,ce){return typeof z=="object"&&z!==null&&z.key!=null?M(""+z.key):ce.toString(36)}function Ee(z,ce,Pe,Re,Ye){var Xe=typeof z;(Xe==="undefined"||Xe==="boolean")&&(z=null);var et=!1;if(z===null)et=!0;else switch(Xe){case"string":case"number":et=!0;break;case"object":switch(z.$$typeof){case n:case e:et=!0}}if(et)return et=z,Ye=Ye(et),z=Re===""?"."+V(et,0):Re,q(Ye)?(Pe="",z!=null&&(Pe=z.replace(j,"$&/")+"/"),Ee(Ye,ce,Pe,"",function(Ve){return Ve})):Ye!=null&&(U(Ye)&&(Ye=R(Ye,Pe+(!Ye.key||et&&et.key===Ye.key?"":(""+Ye.key).replace(j,"$&/")+"/")+z)),ce.push(Ye)),1;if(et=0,Re=Re===""?".":Re+":",q(z))for(var Ne=0;Ne<z.length;Ne++){Xe=z[Ne];var Te=Re+V(Xe,Ne);et+=Ee(Xe,ce,Pe,Te,Ye)}else if(Te=_(z),typeof Te=="function")for(z=Te.call(z),Ne=0;!(Xe=z.next()).done;)Xe=Xe.value,Te=Re+V(Xe,Ne++),et+=Ee(Xe,ce,Pe,Te,Ye);else if(Xe==="object")throw ce=String(z),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.");return et}function le(z,ce,Pe){if(z==null)return z;var Re=[],Ye=0;return Ee(z,Re,"","",function(Xe){return ce.call(Pe,Xe,Ye++)}),Re}function pe(z){if(z._status===-1){var ce=z._result;ce=ce(),ce.then(function(Pe){(z._status===0||z._status===-1)&&(z._status=1,z._result=Pe)},function(Pe){(z._status===0||z._status===-1)&&(z._status=2,z._result=Pe)}),z._status===-1&&(z._status=0,z._result=ce)}if(z._status===1)return z._result.default;throw z._result}var be={current:null},de={transition:null},xe={ReactCurrentDispatcher:be,ReactCurrentBatchConfig:de,ReactCurrentOwner:$};function ne(){throw Error("act(...) is not supported in production builds of React.")}return gt.Children={map:le,forEach:function(z,ce,Pe){le(z,function(){ce.apply(this,arguments)},Pe)},count:function(z){var ce=0;return le(z,function(){ce++}),ce},toArray:function(z){return le(z,function(ce){return ce})||[]},only:function(z){if(!U(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},gt.Component=N,gt.Fragment=t,gt.Profiler=i,gt.PureComponent=B,gt.StrictMode=r,gt.Suspense=c,gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xe,gt.act=ne,gt.cloneElement=function(z,ce,Pe){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var Re=b({},z.props),Ye=z.key,Xe=z.ref,et=z._owner;if(ce!=null){if(ce.ref!==void 0&&(Xe=ce.ref,et=$.current),ce.key!==void 0&&(Ye=""+ce.key),z.type&&z.type.defaultProps)var Ne=z.type.defaultProps;for(Te in ce)W.call(ce,Te)&&!D.hasOwnProperty(Te)&&(Re[Te]=ce[Te]===void 0&&Ne!==void 0?Ne[Te]:ce[Te])}var Te=arguments.length-2;if(Te===1)Re.children=Pe;else if(1<Te){Ne=Array(Te);for(var Ve=0;Ve<Te;Ve++)Ne[Ve]=arguments[Ve+2];Re.children=Ne}return{$$typeof:n,type:z.type,key:Ye,ref:Xe,props:Re,_owner:et}},gt.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:s,_context:z},z.Consumer=z},gt.createElement=k,gt.createFactory=function(z){var ce=k.bind(null,z);return ce.type=z,ce},gt.createRef=function(){return{current:null}},gt.forwardRef=function(z){return{$$typeof:a,render:z}},gt.isValidElement=U,gt.lazy=function(z){return{$$typeof:h,_payload:{_status:-1,_result:z},_init:pe}},gt.memo=function(z,ce){return{$$typeof:d,type:z,compare:ce===void 0?null:ce}},gt.startTransition=function(z){var ce=de.transition;de.transition={};try{z()}finally{de.transition=ce}},gt.unstable_act=ne,gt.useCallback=function(z,ce){return be.current.useCallback(z,ce)},gt.useContext=function(z){return be.current.useContext(z)},gt.useDebugValue=function(){},gt.useDeferredValue=function(z){return be.current.useDeferredValue(z)},gt.useEffect=function(z,ce){return be.current.useEffect(z,ce)},gt.useId=function(){return be.current.useId()},gt.useImperativeHandle=function(z,ce,Pe){return be.current.useImperativeHandle(z,ce,Pe)},gt.useInsertionEffect=function(z,ce){return be.current.useInsertionEffect(z,ce)},gt.useLayoutEffect=function(z,ce){return be.current.useLayoutEffect(z,ce)},gt.useMemo=function(z,ce){return be.current.useMemo(z,ce)},gt.useReducer=function(z,ce,Pe){return be.current.useReducer(z,ce,Pe)},gt.useRef=function(z){return be.current.useRef(z)},gt.useState=function(z){return be.current.useState(z)},gt.useSyncExternalStore=function(z,ce,Pe){return be.current.useSyncExternalStore(z,ce,Pe)},gt.useTransition=function(){return be.current.useTransition()},gt.version="18.3.1",gt}var N2;function zS(){return N2||(N2=1,kA.exports=mG()),kA.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k2;function gG(){if(k2)return Yg;k2=1;var n=zS(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,d){var h,m={},_=null,x=null;d!==void 0&&(_=""+d),c.key!==void 0&&(_=""+c.key),c.ref!==void 0&&(x=c.ref);for(h in c)r.call(c,h)&&!s.hasOwnProperty(h)&&(m[h]=c[h]);if(a&&a.defaultProps)for(h in c=a.defaultProps,c)m[h]===void 0&&(m[h]=c[h]);return{$$typeof:e,type:a,key:_,ref:x,props:m,_owner:i.current}}return Yg.Fragment=t,Yg.jsx=o,Yg.jsxs=o,Yg}var P2;function yG(){return P2||(P2=1,NA.exports=gG()),NA.exports}var p=yG(),Y=zS();const wG=K5(Y);var av={},PA={exports:{}},hi={},RA={exports:{}},DA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2;function _G(){return R2||(R2=1,(function(n){function e(de,xe){var ne=de.length;de.push(xe);e:for(;0<ne;){var z=ne-1>>>1,ce=de[z];if(0<i(ce,xe))de[z]=xe,de[ne]=ce,ne=z;else break e}}function t(de){return de.length===0?null:de[0]}function r(de){if(de.length===0)return null;var xe=de[0],ne=de.pop();if(ne!==xe){de[0]=ne;e:for(var z=0,ce=de.length,Pe=ce>>>1;z<Pe;){var Re=2*(z+1)-1,Ye=de[Re],Xe=Re+1,et=de[Xe];if(0>i(Ye,ne))Xe<ce&&0>i(et,Ye)?(de[z]=et,de[Xe]=ne,z=Xe):(de[z]=Ye,de[Re]=ne,z=Re);else if(Xe<ce&&0>i(et,ne))de[z]=et,de[Xe]=ne,z=Xe;else break e}}return xe}function i(de,xe){var ne=de.sortIndex-xe.sortIndex;return ne!==0?ne:de.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,m=null,_=3,x=!1,b=!1,A=!1,N=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(de){for(var xe=t(d);xe!==null;){if(xe.callback===null)r(d);else if(xe.startTime<=de)r(d),xe.sortIndex=xe.expirationTime,e(c,xe);else break;xe=t(d)}}function q(de){if(A=!1,O(de),!b)if(t(c)!==null)b=!0,pe(W);else{var xe=t(d);xe!==null&&be(q,xe.startTime-de)}}function W(de,xe){b=!1,A&&(A=!1,F(k),k=-1),x=!0;var ne=_;try{for(O(xe),m=t(c);m!==null&&(!(m.expirationTime>xe)||de&&!M());){var z=m.callback;if(typeof z=="function"){m.callback=null,_=m.priorityLevel;var ce=z(m.expirationTime<=xe);xe=n.unstable_now(),typeof ce=="function"?m.callback=ce:m===t(c)&&r(c),O(xe)}else r(c);m=t(c)}if(m!==null)var Pe=!0;else{var Re=t(d);Re!==null&&be(q,Re.startTime-xe),Pe=!1}return Pe}finally{m=null,_=ne,x=!1}}var $=!1,D=null,k=-1,R=5,U=-1;function M(){return!(n.unstable_now()-U<R)}function j(){if(D!==null){var de=n.unstable_now();U=de;var xe=!0;try{xe=D(!0,de)}finally{xe?V():($=!1,D=null)}}else $=!1}var V;if(typeof B=="function")V=function(){B(j)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,le=Ee.port2;Ee.port1.onmessage=j,V=function(){le.postMessage(null)}}else V=function(){N(j,0)};function pe(de){D=de,$||($=!0,V())}function be(de,xe){k=N(function(){de(n.unstable_now())},xe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(de){de.callback=null},n.unstable_continueExecution=function(){b||x||(b=!0,pe(W))},n.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<de?Math.floor(1e3/de):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(de){switch(_){case 1:case 2:case 3:var xe=3;break;default:xe=_}var ne=_;_=xe;try{return de()}finally{_=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(de,xe){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var ne=_;_=de;try{return xe()}finally{_=ne}},n.unstable_scheduleCallback=function(de,xe,ne){var z=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?z+ne:z):ne=z,de){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=ne+ce,de={id:h++,callback:xe,priorityLevel:de,startTime:ne,expirationTime:ce,sortIndex:-1},ne>z?(de.sortIndex=ne,e(d,de),t(c)===null&&de===t(d)&&(A?(F(k),k=-1):A=!0,be(q,ne-z))):(de.sortIndex=ce,e(c,de),b||x||(b=!0,pe(W))),de},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(de){var xe=_;return function(){var ne=_;_=xe;try{return de.apply(this,arguments)}finally{_=ne}}}})(DA)),DA}var D2;function vG(){return D2||(D2=1,RA.exports=_G()),RA.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M2;function EG(){if(M2)return hi;M2=1;var n=zS(),e=vG();function t(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(i[l]=u,l=0;l<u.length;l++)r.add(u[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function _(l){return c.call(m,l)?!0:c.call(h,l)?!1:d.test(l)?m[l]=!0:(h[l]=!0,!1)}function x(l,u,f,v){if(f!==null&&f.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return v?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function b(l,u,f,v){if(u===null||typeof u>"u"||x(l,u,f,v))return!0;if(v)return!1;if(f!==null)switch(f.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function A(l,u,f,v,E,T,P){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=v,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=u,this.sanitizeURL=T,this.removeEmptyString=P}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){N[l]=new A(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];N[u]=new A(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){N[l]=new A(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){N[l]=new A(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){N[l]=new A(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){N[l]=new A(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){N[l]=new A(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){N[l]=new A(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){N[l]=new A(l,5,!1,l.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(F,B);N[u]=new A(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(F,B);N[u]=new A(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(F,B);N[u]=new A(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){N[l]=new A(l,1,!1,l.toLowerCase(),null,!1,!1)}),N.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){N[l]=new A(l,1,!1,l.toLowerCase(),null,!0,!0)});function O(l,u,f,v){var E=N.hasOwnProperty(u)?N[u]:null;(E!==null?E.type!==0:v||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(b(u,f,E,v)&&(f=null),v||E===null?_(u)&&(f===null?l.removeAttribute(u):l.setAttribute(u,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(u=E.attributeName,v=E.attributeNamespace,f===null?l.removeAttribute(u):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,v?l.setAttributeNS(v,u,f):l.setAttribute(u,f))))}var q=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,W=Symbol.for("react.element"),$=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),M=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),be=Symbol.for("react.offscreen"),de=Symbol.iterator;function xe(l){return l===null||typeof l!="object"?null:(l=de&&l[de]||l["@@iterator"],typeof l=="function"?l:null)}var ne=Object.assign,z;function ce(l){if(z===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);z=u&&u[1]||""}return`
`+z+l}var Pe=!1;function Re(l,u){if(!l||Pe)return"";Pe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(ie){var v=ie}Reflect.construct(l,[],u)}else{try{u.call()}catch(ie){v=ie}l.call(u.prototype)}else{try{throw Error()}catch(ie){v=ie}l()}}catch(ie){if(ie&&v&&typeof ie.stack=="string"){for(var E=ie.stack.split(`
`),T=v.stack.split(`
`),P=E.length-1,G=T.length-1;1<=P&&0<=G&&E[P]!==T[G];)G--;for(;1<=P&&0<=G;P--,G--)if(E[P]!==T[G]){if(P!==1||G!==1)do if(P--,G--,0>G||E[P]!==T[G]){var K=`
`+E[P].replace(" at new "," at ");return l.displayName&&K.includes("<anonymous>")&&(K=K.replace("<anonymous>",l.displayName)),K}while(1<=P&&0<=G);break}}}finally{Pe=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?ce(l):""}function Ye(l){switch(l.tag){case 5:return ce(l.type);case 16:return ce("Lazy");case 13:return ce("Suspense");case 19:return ce("SuspenseList");case 0:case 2:case 15:return l=Re(l.type,!1),l;case 11:return l=Re(l.type.render,!1),l;case 1:return l=Re(l.type,!0),l;default:return""}}function Xe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case D:return"Fragment";case $:return"Portal";case R:return"Profiler";case k:return"StrictMode";case V:return"Suspense";case Ee:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case M:return(l.displayName||"Context")+".Consumer";case U:return(l._context.displayName||"Context")+".Provider";case j:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case le:return u=l.displayName||null,u!==null?u:Xe(l.type)||"Memo";case pe:u=l._payload,l=l._init;try{return Xe(l(u))}catch{}}return null}function et(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xe(u);case 8:return u===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function Ne(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Te(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Ve(l){var u=Te(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),v=""+l[u];if(!l.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,T=f.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return E.call(this)},set:function(P){v=""+P,T.call(this,P)}}),Object.defineProperty(l,u,{enumerable:f.enumerable}),{getValue:function(){return v},setValue:function(P){v=""+P},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function it(l){l._valueTracker||(l._valueTracker=Ve(l))}function st(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),v="";return l&&(v=Te(l)?l.checked?"true":"false":l.value),l=v,l!==f?(u.setValue(l),!0):!1}function lt(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function mt(l,u){var f=u.checked;return ne({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function zt(l,u){var f=u.defaultValue==null?"":u.defaultValue,v=u.checked!=null?u.checked:u.defaultChecked;f=Ne(u.value!=null?u.value:f),l._wrapperState={initialChecked:v,initialValue:f,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function tn(l,u){u=u.checked,u!=null&&O(l,"checked",u,!1)}function Gr(l,u){tn(l,u);var f=Ne(u.value),v=u.type;if(f!=null)v==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(v==="submit"||v==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?gn(l,u.type,f):u.hasOwnProperty("defaultValue")&&gn(l,u.type,Ne(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function co(l,u,f){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var v=u.type;if(!(v!=="submit"&&v!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,f||u===l.value||(l.value=u),l.defaultValue=u}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function gn(l,u,f){(u!=="number"||lt(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var yn=Array.isArray;function si(l,u,f,v){if(l=l.options,u){u={};for(var E=0;E<f.length;E++)u["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=u.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&v&&(l[f].defaultSelected=!0)}else{for(f=""+Ne(f),u=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,v&&(l[E].defaultSelected=!0);return}u!==null||l[E].disabled||(u=l[E])}u!==null&&(u.selected=!0)}}function kl(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Pl(l,u){var f=u.value;if(f==null){if(f=u.children,u=u.defaultValue,f!=null){if(u!=null)throw Error(t(92));if(yn(f)){if(1<f.length)throw Error(t(93));f=f[0]}u=f}u==null&&(u=""),f=u}l._wrapperState={initialValue:Ne(f)}}function Au(l,u){var f=Ne(u.value),v=Ne(u.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),u.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),v!=null&&(l.defaultValue=""+v)}function bs(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function Rl(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _a(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?Rl(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Cs,bu=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,f,v,E){MSApp.execUnsafeLocalFunction(function(){return l(u,f,v,E)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(Cs=Cs||document.createElement("div"),Cs.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Cs.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function uo(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},va=["Webkit","ms","Moz","O"];Object.keys(ho).forEach(function(l){va.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),ho[u]=ho[l]})});function fo(l,u,f){return u==null||typeof u=="boolean"||u===""?"":f||typeof u!="number"||u===0||ho.hasOwnProperty(l)&&ho[l]?(""+u).trim():u+"px"}function Dl(l,u){l=l.style;for(var f in u)if(u.hasOwnProperty(f)){var v=f.indexOf("--")===0,E=fo(f,u[f],v);f==="float"&&(f="cssFloat"),v?l.setProperty(f,E):l[f]=E}}var Cu=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ci(l,u){if(u){if(Cu[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function Ml(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ss=null;function Ll(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Ns=null,ks=null,ue=null;function tt(l){if(l=Lg(l)){if(typeof Ns!="function")throw Error(t(280));var u=l.stateNode;u&&(u=x_(u),Ns(l.stateNode,l.type,u))}}function xt(l){ks?ue?ue.push(l):ue=[l]:ks=l}function Jn(){if(ks){var l=ks,u=ue;if(ue=ks=null,tt(l),u)for(l=0;l<u.length;l++)tt(u[l])}}function Ol(l,u){return l(u)}function Si(){}var oi=!1;function lg(l,u,f){if(oi)return l(u,f);oi=!0;try{return Ol(l,u,f)}finally{oi=!1,(ks!==null||ue!==null)&&(Si(),Jn())}}function Ps(l,u){var f=l.stateNode;if(f===null)return null;var v=x_(f);if(v===null)return null;f=v[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(l=l.type,v=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!v;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,u,typeof f));return f}var Vl=!1;if(a)try{var Fl={};Object.defineProperty(Fl,"passive",{get:function(){Vl=!0}}),window.addEventListener("test",Fl,Fl),window.removeEventListener("test",Fl,Fl)}catch{Vl=!1}function Zw(l,u,f,v,E,T,P,G,K){var ie=Array.prototype.slice.call(arguments,3);try{u.apply(f,ie)}catch(ye){this.onError(ye)}}var Ea=!1,po=null,Hh=!1,es=null,e_={onError:function(l){Ea=!0,po=l}};function t_(l,u,f,v,E,T,P,G,K){Ea=!1,po=null,Zw.apply(e_,arguments)}function cg(l,u,f,v,E,T,P,G,K){if(t_.apply(this,arguments),Ea){if(Ea){var ie=po;Ea=!1,po=null}else throw Error(t(198));Hh||(Hh=!0,es=ie)}}function Rs(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function ug(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function n_(l){if(Rs(l)!==l)throw Error(t(188))}function r_(l){var u=l.alternate;if(!u){if(u=Rs(l),u===null)throw Error(t(188));return u!==l?null:l}for(var f=l,v=u;;){var E=f.return;if(E===null)break;var T=E.alternate;if(T===null){if(v=E.return,v!==null){f=v;continue}break}if(E.child===T.child){for(T=E.child;T;){if(T===f)return n_(E),l;if(T===v)return n_(E),u;T=T.sibling}throw Error(t(188))}if(f.return!==v.return)f=E,v=T;else{for(var P=!1,G=E.child;G;){if(G===f){P=!0,f=E,v=T;break}if(G===v){P=!0,v=E,f=T;break}G=G.sibling}if(!P){for(G=T.child;G;){if(G===f){P=!0,f=T,v=E;break}if(G===v){P=!0,v=T,f=E;break}G=G.sibling}if(!P)throw Error(t(189))}}if(f.alternate!==v)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:u}function i_(l){return l=r_(l),l!==null?Su(l):null}function Su(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=Su(l);if(u!==null)return u;l=l.sibling}return null}var dg=e.unstable_scheduleCallback,Gh=e.unstable_cancelCallback,Nu=e.unstable_shouldYield,xa=e.unstable_requestPaint,nn=e.unstable_now,sI=e.unstable_getCurrentPriorityLevel,jh=e.unstable_ImmediatePriority,hg=e.unstable_UserBlockingPriority,ku=e.unstable_NormalPriority,fg=e.unstable_LowPriority,qh=e.unstable_IdlePriority,Pu=null,Ni=null;function s_(l){if(Ni&&typeof Ni.onCommitFiberRoot=="function")try{Ni.onCommitFiberRoot(Pu,l,void 0,(l.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:Ru,mo=Math.log,ts=Math.LN2;function Ru(l){return l>>>=0,l===0?32:31-(mo(l)/ts|0)|0}var go=64,Ul=4194304;function Dt(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Ta(l,u){var f=l.pendingLanes;if(f===0)return 0;var v=0,E=l.suspendedLanes,T=l.pingedLanes,P=f&268435455;if(P!==0){var G=P&~E;G!==0?v=Dt(G):(T&=P,T!==0&&(v=Dt(T)))}else P=f&~E,P!==0?v=Dt(P):T!==0&&(v=Dt(T));if(v===0)return 0;if(u!==0&&u!==v&&(u&E)===0&&(E=v&-v,T=u&-u,E>=T||E===16&&(T&4194240)!==0))return u;if((v&4)!==0&&(v|=f&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=v;0<u;)f=31-ki(u),E=1<<f,v|=l[f],u&=~E;return v}function Du(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mu(l,u){for(var f=l.suspendedLanes,v=l.pingedLanes,E=l.expirationTimes,T=l.pendingLanes;0<T;){var P=31-ki(T),G=1<<P,K=E[P];K===-1?((G&f)===0||(G&v)!==0)&&(E[P]=Du(G,u)):K<=u&&(l.expiredLanes|=G),T&=~G}}function pg(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function mg(){var l=go;return go<<=1,(go&4194240)===0&&(go=64),l}function gg(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function Lu(l,u,f){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-ki(u),l[u]=f}function oI(l,u){var f=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var v=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-ki(f),T=1<<E;u[E]=0,v[E]=-1,l[E]=-1,f&=~T}}function yg(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var v=31-ki(f),E=1<<v;E&u|l[v]&u&&(l[v]|=u),f&=~E}}var Tt=0;function yo(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var wg,zh,_g,vg,Eg,wo=!1,$h=[],_o=null,vo=null,hr=null,Ou=new Map,Ia=new Map,Pi=[],o_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bl(l,u){switch(l){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":vo=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":Ou.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ia.delete(u.pointerId)}}function Ds(l,u,f,v,E,T){return l===null||l.nativeEvent!==T?(l={blockedOn:u,domEventName:f,eventSystemFlags:v,nativeEvent:T,targetContainers:[E]},u!==null&&(u=Lg(u),u!==null&&zh(u)),l):(l.eventSystemFlags|=v,u=l.targetContainers,E!==null&&u.indexOf(E)===-1&&u.push(E),l)}function a_(l,u,f,v,E){switch(u){case"focusin":return _o=Ds(_o,l,u,f,v,E),!0;case"dragenter":return vo=Ds(vo,l,u,f,v,E),!0;case"mouseover":return hr=Ds(hr,l,u,f,v,E),!0;case"pointerover":var T=E.pointerId;return Ou.set(T,Ds(Ou.get(T)||null,l,u,f,v,E)),!0;case"gotpointercapture":return T=E.pointerId,Ia.set(T,Ds(Ia.get(T)||null,l,u,f,v,E)),!0}return!1}function Wh(l){var u=Bu(l.target);if(u!==null){var f=Rs(u);if(f!==null){if(u=f.tag,u===13){if(u=ug(f),u!==null){l.blockedOn=u,Eg(l.priority,function(){_g(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function $t(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=Kh(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var v=new f.constructor(f.type,f);Ss=v,f.target.dispatchEvent(v),Ss=null}else return u=Lg(f),u!==null&&zh(u),l.blockedOn=f,!1;u.shift()}return!0}function l_(l,u,f){$t(l)&&f.delete(u)}function aI(){wo=!1,_o!==null&&$t(_o)&&(_o=null),vo!==null&&$t(vo)&&(vo=null),hr!==null&&$t(hr)&&(hr=null),Ou.forEach(l_),Ia.forEach(l_)}function Hl(l,u){l.blockedOn===u&&(l.blockedOn=null,wo||(wo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,aI)))}function Gl(l){function u(E){return Hl(E,l)}if(0<$h.length){Hl($h[0],l);for(var f=1;f<$h.length;f++){var v=$h[f];v.blockedOn===l&&(v.blockedOn=null)}}for(_o!==null&&Hl(_o,l),vo!==null&&Hl(vo,l),hr!==null&&Hl(hr,l),Ou.forEach(u),Ia.forEach(u),f=0;f<Pi.length;f++)v=Pi[f],v.blockedOn===l&&(v.blockedOn=null);for(;0<Pi.length&&(f=Pi[0],f.blockedOn===null);)Wh(f),f.blockedOn===null&&Pi.shift()}var Aa=q.ReactCurrentBatchConfig,ba=!0;function Eo(l,u,f,v){var E=Tt,T=Aa.transition;Aa.transition=null;try{Tt=1,xg(l,u,f,v)}finally{Tt=E,Aa.transition=T}}function c_(l,u,f,v){var E=Tt,T=Aa.transition;Aa.transition=null;try{Tt=4,xg(l,u,f,v)}finally{Tt=E,Aa.transition=T}}function xg(l,u,f,v){if(ba){var E=Kh(l,u,f,v);if(E===null)wI(l,u,v,xo,f),Bl(l,v);else if(a_(E,l,u,f,v))v.stopPropagation();else if(Bl(l,v),u&4&&-1<o_.indexOf(l)){for(;E!==null;){var T=Lg(E);if(T!==null&&wg(T),T=Kh(l,u,f,v),T===null&&wI(l,u,v,xo,f),T===E)break;E=T}E!==null&&v.stopPropagation()}else wI(l,u,v,null,f)}}var xo=null;function Kh(l,u,f,v){if(xo=null,l=Ll(v),l=Bu(l),l!==null)if(u=Rs(l),u===null)l=null;else if(f=u.tag,f===13){if(l=ug(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return xo=l,null}function Qh(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sI()){case jh:return 1;case hg:return 4;case ku:case fg:return 16;case qh:return 536870912;default:return 16}default:return 16}}var Ri=null,Jh=null,Ca=null;function u_(){if(Ca)return Ca;var l,u=Jh,f=u.length,v,E="value"in Ri?Ri.value:Ri.textContent,T=E.length;for(l=0;l<f&&u[l]===E[l];l++);var P=f-l;for(v=1;v<=P&&u[f-v]===E[T-v];v++);return Ca=E.slice(l,1<v?1-v:void 0)}function Vu(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function To(){return!0}function Tg(){return!1}function Ar(l){function u(f,v,E,T,P){this._reactName=f,this._targetInst=E,this.type=v,this.nativeEvent=T,this.target=P,this.currentTarget=null;for(var G in l)l.hasOwnProperty(G)&&(f=l[G],this[G]=f?f(T):T[G]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?To:Tg,this.isPropagationStopped=Tg,this}return ne(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),u}var Io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fu=Ar(Io),jl=ne({},Io,{view:0,detail:0}),Yh=Ar(jl),Xh,Zh,Di,Uu=ne({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ot,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Di&&(Di&&l.type==="mousemove"?(Xh=l.screenX-Di.screenX,Zh=l.screenY-Di.screenY):Zh=Xh=0,Di=l),Xh)},movementY:function(l){return"movementY"in l?l.movementY:Zh}}),Ig=Ar(Uu),d_=ne({},Uu,{dataTransfer:0}),h_=Ar(d_),ef=ne({},jl,{relatedTarget:0}),fr=Ar(ef),f_=ne({},Io,{animationName:0,elapsedTime:0,pseudoElement:0}),p_=Ar(f_),ql=ne({},Io,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),w=Ar(ql),I=ne({},Io,{data:0}),C=Ar(I),L={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},te={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ce(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=ae[l])?!!u[l]:!1}function ot(){return Ce}var Nn=ne({},jl,{key:function(l){if(l.key){var u=L[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=Vu(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?te[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ot,charCode:function(l){return l.type==="keypress"?Vu(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Vu(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Ft=Ar(Nn),Vn=ne({},Uu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mi=Ar(Vn),Sa=ne({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ot}),Ao=Ar(Sa),bo=ne({},Io,{propertyName:0,elapsedTime:0,pseudoElement:0}),tf=Ar(bo),Ag=ne({},Uu,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),aH=Ar(Ag),lH=[9,13,27,32],lI=a&&"CompositionEvent"in window,bg=null;a&&"documentMode"in document&&(bg=document.documentMode);var cH=a&&"TextEvent"in window&&!bg,_P=a&&(!lI||bg&&8<bg&&11>=bg),vP=" ",EP=!1;function xP(l,u){switch(l){case"keyup":return lH.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TP(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var nf=!1;function uH(l,u){switch(l){case"compositionend":return TP(u);case"keypress":return u.which!==32?null:(EP=!0,vP);case"textInput":return l=u.data,l===vP&&EP?null:l;default:return null}}function dH(l,u){if(nf)return l==="compositionend"||!lI&&xP(l,u)?(l=u_(),Ca=Jh=Ri=null,nf=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return _P&&u.locale!=="ko"?null:u.data;default:return null}}var hH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IP(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!hH[l.type]:u==="textarea"}function AP(l,u,f,v){xt(v),u=__(u,"onChange"),0<u.length&&(f=new Fu("onChange","change",null,f,v),l.push({event:f,listeners:u}))}var Cg=null,Sg=null;function fH(l){jP(l,0)}function m_(l){var u=lf(l);if(st(u))return l}function pH(l,u){if(l==="change")return u}var bP=!1;if(a){var cI;if(a){var uI="oninput"in document;if(!uI){var CP=document.createElement("div");CP.setAttribute("oninput","return;"),uI=typeof CP.oninput=="function"}cI=uI}else cI=!1;bP=cI&&(!document.documentMode||9<document.documentMode)}function SP(){Cg&&(Cg.detachEvent("onpropertychange",NP),Sg=Cg=null)}function NP(l){if(l.propertyName==="value"&&m_(Sg)){var u=[];AP(u,Sg,l,Ll(l)),lg(fH,u)}}function mH(l,u,f){l==="focusin"?(SP(),Cg=u,Sg=f,Cg.attachEvent("onpropertychange",NP)):l==="focusout"&&SP()}function gH(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return m_(Sg)}function yH(l,u){if(l==="click")return m_(u)}function wH(l,u){if(l==="input"||l==="change")return m_(u)}function _H(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Ms=typeof Object.is=="function"?Object.is:_H;function Ng(l,u){if(Ms(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),v=Object.keys(u);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var E=f[v];if(!c.call(u,E)||!Ms(l[E],u[E]))return!1}return!0}function kP(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function PP(l,u){var f=kP(l);l=0;for(var v;f;){if(f.nodeType===3){if(v=l+f.textContent.length,l<=u&&v>=u)return{node:f,offset:u-l};l=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=kP(f)}}function RP(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?RP(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function DP(){for(var l=window,u=lt();u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=lt(l.document)}return u}function dI(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function vH(l){var u=DP(),f=l.focusedElem,v=l.selectionRange;if(u!==f&&f&&f.ownerDocument&&RP(f.ownerDocument.documentElement,f)){if(v!==null&&dI(f)){if(u=v.start,l=v.end,l===void 0&&(l=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(l,f.value.length);else if(l=(u=f.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,T=Math.min(v.start,E);v=v.end===void 0?T:Math.min(v.end,E),!l.extend&&T>v&&(E=v,v=T,T=E),E=PP(f,T);var P=PP(f,v);E&&P&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==P.node||l.focusOffset!==P.offset)&&(u=u.createRange(),u.setStart(E.node,E.offset),l.removeAllRanges(),T>v?(l.addRange(u),l.extend(P.node,P.offset)):(u.setEnd(P.node,P.offset),l.addRange(u)))}}for(u=[],l=f;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)l=u[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var EH=a&&"documentMode"in document&&11>=document.documentMode,rf=null,hI=null,kg=null,fI=!1;function MP(l,u,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;fI||rf==null||rf!==lt(v)||(v=rf,"selectionStart"in v&&dI(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),kg&&Ng(kg,v)||(kg=v,v=__(hI,"onSelect"),0<v.length&&(u=new Fu("onSelect","select",null,u,f),l.push({event:u,listeners:v}),u.target=rf)))}function g_(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var sf={animationend:g_("Animation","AnimationEnd"),animationiteration:g_("Animation","AnimationIteration"),animationstart:g_("Animation","AnimationStart"),transitionend:g_("Transition","TransitionEnd")},pI={},LP={};a&&(LP=document.createElement("div").style,"AnimationEvent"in window||(delete sf.animationend.animation,delete sf.animationiteration.animation,delete sf.animationstart.animation),"TransitionEvent"in window||delete sf.transitionend.transition);function y_(l){if(pI[l])return pI[l];if(!sf[l])return l;var u=sf[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in LP)return pI[l]=u[f];return l}var OP=y_("animationend"),VP=y_("animationiteration"),FP=y_("animationstart"),UP=y_("transitionend"),BP=new Map,HP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zl(l,u){BP.set(l,u),s(u,[l])}for(var mI=0;mI<HP.length;mI++){var gI=HP[mI],xH=gI.toLowerCase(),TH=gI[0].toUpperCase()+gI.slice(1);zl(xH,"on"+TH)}zl(OP,"onAnimationEnd"),zl(VP,"onAnimationIteration"),zl(FP,"onAnimationStart"),zl("dblclick","onDoubleClick"),zl("focusin","onFocus"),zl("focusout","onBlur"),zl(UP,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pg));function GP(l,u,f){var v=l.type||"unknown-event";l.currentTarget=f,cg(v,u,void 0,l),l.currentTarget=null}function jP(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var v=l[f],E=v.event;v=v.listeners;e:{var T=void 0;if(u)for(var P=v.length-1;0<=P;P--){var G=v[P],K=G.instance,ie=G.currentTarget;if(G=G.listener,K!==T&&E.isPropagationStopped())break e;GP(E,G,ie),T=K}else for(P=0;P<v.length;P++){if(G=v[P],K=G.instance,ie=G.currentTarget,G=G.listener,K!==T&&E.isPropagationStopped())break e;GP(E,G,ie),T=K}}}if(Hh)throw l=es,Hh=!1,es=null,l}function rn(l,u){var f=u[II];f===void 0&&(f=u[II]=new Set);var v=l+"__bubble";f.has(v)||(qP(u,l,2,!1),f.add(v))}function yI(l,u,f){var v=0;u&&(v|=4),qP(f,l,v,u)}var w_="_reactListening"+Math.random().toString(36).slice(2);function Rg(l){if(!l[w_]){l[w_]=!0,r.forEach(function(f){f!=="selectionchange"&&(IH.has(f)||yI(f,!1,l),yI(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[w_]||(u[w_]=!0,yI("selectionchange",!1,u))}}function qP(l,u,f,v){switch(Qh(u)){case 1:var E=Eo;break;case 4:E=c_;break;default:E=xg}f=E.bind(null,u,f,l),E=void 0,!Vl||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(E=!0),v?E!==void 0?l.addEventListener(u,f,{capture:!0,passive:E}):l.addEventListener(u,f,!0):E!==void 0?l.addEventListener(u,f,{passive:E}):l.addEventListener(u,f,!1)}function wI(l,u,f,v,E){var T=v;if((u&1)===0&&(u&2)===0&&v!==null)e:for(;;){if(v===null)return;var P=v.tag;if(P===3||P===4){var G=v.stateNode.containerInfo;if(G===E||G.nodeType===8&&G.parentNode===E)break;if(P===4)for(P=v.return;P!==null;){var K=P.tag;if((K===3||K===4)&&(K=P.stateNode.containerInfo,K===E||K.nodeType===8&&K.parentNode===E))return;P=P.return}for(;G!==null;){if(P=Bu(G),P===null)return;if(K=P.tag,K===5||K===6){v=T=P;continue e}G=G.parentNode}}v=v.return}lg(function(){var ie=T,ye=Ll(f),ve=[];e:{var me=BP.get(l);if(me!==void 0){var Oe=Fu,Ge=l;switch(l){case"keypress":if(Vu(f)===0)break e;case"keydown":case"keyup":Oe=Ft;break;case"focusin":Ge="focus",Oe=fr;break;case"focusout":Ge="blur",Oe=fr;break;case"beforeblur":case"afterblur":Oe=fr;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Oe=Ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Oe=h_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Oe=Ao;break;case OP:case VP:case FP:Oe=p_;break;case UP:Oe=tf;break;case"scroll":Oe=Yh;break;case"wheel":Oe=aH;break;case"copy":case"cut":case"paste":Oe=w;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Oe=Mi}var qe=(u&4)!==0,kn=!qe&&l==="scroll",ee=qe?me!==null?me+"Capture":null:me;qe=[];for(var J=ie,re;J!==null;){re=J;var Ae=re.stateNode;if(re.tag===5&&Ae!==null&&(re=Ae,ee!==null&&(Ae=Ps(J,ee),Ae!=null&&qe.push(Dg(J,Ae,re)))),kn)break;J=J.return}0<qe.length&&(me=new Oe(me,Ge,null,f,ye),ve.push({event:me,listeners:qe}))}}if((u&7)===0){e:{if(me=l==="mouseover"||l==="pointerover",Oe=l==="mouseout"||l==="pointerout",me&&f!==Ss&&(Ge=f.relatedTarget||f.fromElement)&&(Bu(Ge)||Ge[Na]))break e;if((Oe||me)&&(me=ye.window===ye?ye:(me=ye.ownerDocument)?me.defaultView||me.parentWindow:window,Oe?(Ge=f.relatedTarget||f.toElement,Oe=ie,Ge=Ge?Bu(Ge):null,Ge!==null&&(kn=Rs(Ge),Ge!==kn||Ge.tag!==5&&Ge.tag!==6)&&(Ge=null)):(Oe=null,Ge=ie),Oe!==Ge)){if(qe=Ig,Ae="onMouseLeave",ee="onMouseEnter",J="mouse",(l==="pointerout"||l==="pointerover")&&(qe=Mi,Ae="onPointerLeave",ee="onPointerEnter",J="pointer"),kn=Oe==null?me:lf(Oe),re=Ge==null?me:lf(Ge),me=new qe(Ae,J+"leave",Oe,f,ye),me.target=kn,me.relatedTarget=re,Ae=null,Bu(ye)===ie&&(qe=new qe(ee,J+"enter",Ge,f,ye),qe.target=re,qe.relatedTarget=kn,Ae=qe),kn=Ae,Oe&&Ge)t:{for(qe=Oe,ee=Ge,J=0,re=qe;re;re=of(re))J++;for(re=0,Ae=ee;Ae;Ae=of(Ae))re++;for(;0<J-re;)qe=of(qe),J--;for(;0<re-J;)ee=of(ee),re--;for(;J--;){if(qe===ee||ee!==null&&qe===ee.alternate)break t;qe=of(qe),ee=of(ee)}qe=null}else qe=null;Oe!==null&&zP(ve,me,Oe,qe,!1),Ge!==null&&kn!==null&&zP(ve,kn,Ge,qe,!0)}}e:{if(me=ie?lf(ie):window,Oe=me.nodeName&&me.nodeName.toLowerCase(),Oe==="select"||Oe==="input"&&me.type==="file")var ze=pH;else if(IP(me))if(bP)ze=wH;else{ze=gH;var We=mH}else(Oe=me.nodeName)&&Oe.toLowerCase()==="input"&&(me.type==="checkbox"||me.type==="radio")&&(ze=yH);if(ze&&(ze=ze(l,ie))){AP(ve,ze,f,ye);break e}We&&We(l,me,ie),l==="focusout"&&(We=me._wrapperState)&&We.controlled&&me.type==="number"&&gn(me,"number",me.value)}switch(We=ie?lf(ie):window,l){case"focusin":(IP(We)||We.contentEditable==="true")&&(rf=We,hI=ie,kg=null);break;case"focusout":kg=hI=rf=null;break;case"mousedown":fI=!0;break;case"contextmenu":case"mouseup":case"dragend":fI=!1,MP(ve,f,ye);break;case"selectionchange":if(EH)break;case"keydown":case"keyup":MP(ve,f,ye)}var Ke;if(lI)e:{switch(l){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else nf?xP(l,f)&&(nt="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(nt="onCompositionStart");nt&&(_P&&f.locale!=="ko"&&(nf||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&nf&&(Ke=u_()):(Ri=ye,Jh="value"in Ri?Ri.value:Ri.textContent,nf=!0)),We=__(ie,nt),0<We.length&&(nt=new C(nt,l,null,f,ye),ve.push({event:nt,listeners:We}),Ke?nt.data=Ke:(Ke=TP(f),Ke!==null&&(nt.data=Ke)))),(Ke=cH?uH(l,f):dH(l,f))&&(ie=__(ie,"onBeforeInput"),0<ie.length&&(ye=new C("onBeforeInput","beforeinput",null,f,ye),ve.push({event:ye,listeners:ie}),ye.data=Ke))}jP(ve,u)})}function Dg(l,u,f){return{instance:l,listener:u,currentTarget:f}}function __(l,u){for(var f=u+"Capture",v=[];l!==null;){var E=l,T=E.stateNode;E.tag===5&&T!==null&&(E=T,T=Ps(l,f),T!=null&&v.unshift(Dg(l,T,E)),T=Ps(l,u),T!=null&&v.push(Dg(l,T,E))),l=l.return}return v}function of(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function zP(l,u,f,v,E){for(var T=u._reactName,P=[];f!==null&&f!==v;){var G=f,K=G.alternate,ie=G.stateNode;if(K!==null&&K===v)break;G.tag===5&&ie!==null&&(G=ie,E?(K=Ps(f,T),K!=null&&P.unshift(Dg(f,K,G))):E||(K=Ps(f,T),K!=null&&P.push(Dg(f,K,G)))),f=f.return}P.length!==0&&l.push({event:u,listeners:P})}var AH=/\r\n?/g,bH=/\u0000|\uFFFD/g;function $P(l){return(typeof l=="string"?l:""+l).replace(AH,`
`).replace(bH,"")}function v_(l,u,f){if(u=$P(u),$P(l)!==u&&f)throw Error(t(425))}function E_(){}var _I=null,vI=null;function EI(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var xI=typeof setTimeout=="function"?setTimeout:void 0,CH=typeof clearTimeout=="function"?clearTimeout:void 0,WP=typeof Promise=="function"?Promise:void 0,SH=typeof queueMicrotask=="function"?queueMicrotask:typeof WP<"u"?function(l){return WP.resolve(null).then(l).catch(NH)}:xI;function NH(l){setTimeout(function(){throw l})}function TI(l,u){var f=u,v=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(v===0){l.removeChild(E),Gl(u);return}v--}else f!=="$"&&f!=="$?"&&f!=="$!"||v++;f=E}while(f);Gl(u)}function $l(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function KP(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return l;u--}else f==="/$"&&u++}l=l.previousSibling}return null}var af=Math.random().toString(36).slice(2),Co="__reactFiber$"+af,Mg="__reactProps$"+af,Na="__reactContainer$"+af,II="__reactEvents$"+af,kH="__reactListeners$"+af,PH="__reactHandles$"+af;function Bu(l){var u=l[Co];if(u)return u;for(var f=l.parentNode;f;){if(u=f[Na]||f[Co]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=KP(l);l!==null;){if(f=l[Co])return f;l=KP(l)}return u}l=f,f=l.parentNode}return null}function Lg(l){return l=l[Co]||l[Na],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function lf(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function x_(l){return l[Mg]||null}var AI=[],cf=-1;function Wl(l){return{current:l}}function sn(l){0>cf||(l.current=AI[cf],AI[cf]=null,cf--)}function Kt(l,u){cf++,AI[cf]=l.current,l.current=u}var Kl={},br=Wl(Kl),ai=Wl(!1),Hu=Kl;function uf(l,u){var f=l.type.contextTypes;if(!f)return Kl;var v=l.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===u)return v.__reactInternalMemoizedMaskedChildContext;var E={},T;for(T in f)E[T]=u[T];return v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=E),E}function li(l){return l=l.childContextTypes,l!=null}function T_(){sn(ai),sn(br)}function QP(l,u,f){if(br.current!==Kl)throw Error(t(168));Kt(br,u),Kt(ai,f)}function JP(l,u,f){var v=l.stateNode;if(u=u.childContextTypes,typeof v.getChildContext!="function")return f;v=v.getChildContext();for(var E in v)if(!(E in u))throw Error(t(108,et(l)||"Unknown",E));return ne({},f,v)}function I_(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Kl,Hu=br.current,Kt(br,l),Kt(ai,ai.current),!0}function YP(l,u,f){var v=l.stateNode;if(!v)throw Error(t(169));f?(l=JP(l,u,Hu),v.__reactInternalMemoizedMergedChildContext=l,sn(ai),sn(br),Kt(br,l)):sn(ai),Kt(ai,f)}var ka=null,A_=!1,bI=!1;function XP(l){ka===null?ka=[l]:ka.push(l)}function RH(l){A_=!0,XP(l)}function Ql(){if(!bI&&ka!==null){bI=!0;var l=0,u=Tt;try{var f=ka;for(Tt=1;l<f.length;l++){var v=f[l];do v=v(!0);while(v!==null)}ka=null,A_=!1}catch(E){throw ka!==null&&(ka=ka.slice(l+1)),dg(jh,Ql),E}finally{Tt=u,bI=!1}}return null}var df=[],hf=0,b_=null,C_=0,ns=[],rs=0,Gu=null,Pa=1,Ra="";function ju(l,u){df[hf++]=C_,df[hf++]=b_,b_=l,C_=u}function ZP(l,u,f){ns[rs++]=Pa,ns[rs++]=Ra,ns[rs++]=Gu,Gu=l;var v=Pa;l=Ra;var E=32-ki(v)-1;v&=~(1<<E),f+=1;var T=32-ki(u)+E;if(30<T){var P=E-E%5;T=(v&(1<<P)-1).toString(32),v>>=P,E-=P,Pa=1<<32-ki(u)+E|f<<E|v,Ra=T+l}else Pa=1<<T|f<<E|v,Ra=l}function CI(l){l.return!==null&&(ju(l,1),ZP(l,1,0))}function SI(l){for(;l===b_;)b_=df[--hf],df[hf]=null,C_=df[--hf],df[hf]=null;for(;l===Gu;)Gu=ns[--rs],ns[rs]=null,Ra=ns[--rs],ns[rs]=null,Pa=ns[--rs],ns[rs]=null}var Li=null,Oi=null,cn=!1,Ls=null;function eR(l,u){var f=as(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=l,u=l.deletions,u===null?(l.deletions=[f],l.flags|=16):u.push(f)}function tR(l,u){switch(l.tag){case 5:var f=l.type;return u=u.nodeType!==1||f.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Li=l,Oi=$l(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Li=l,Oi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(f=Gu!==null?{id:Pa,overflow:Ra}:null,l.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=as(18,null,null,0),f.stateNode=u,f.return=l,l.child=f,Li=l,Oi=null,!0):!1;default:return!1}}function NI(l){return(l.mode&1)!==0&&(l.flags&128)===0}function kI(l){if(cn){var u=Oi;if(u){var f=u;if(!tR(l,u)){if(NI(l))throw Error(t(418));u=$l(f.nextSibling);var v=Li;u&&tR(l,u)?eR(v,f):(l.flags=l.flags&-4097|2,cn=!1,Li=l)}}else{if(NI(l))throw Error(t(418));l.flags=l.flags&-4097|2,cn=!1,Li=l}}}function nR(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Li=l}function S_(l){if(l!==Li)return!1;if(!cn)return nR(l),cn=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!EI(l.type,l.memoizedProps)),u&&(u=Oi)){if(NI(l))throw rR(),Error(t(418));for(;u;)eR(l,u),u=$l(u.nextSibling)}if(nR(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(u===0){Oi=$l(l.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++}l=l.nextSibling}Oi=null}}else Oi=Li?$l(l.stateNode.nextSibling):null;return!0}function rR(){for(var l=Oi;l;)l=$l(l.nextSibling)}function ff(){Oi=Li=null,cn=!1}function PI(l){Ls===null?Ls=[l]:Ls.push(l)}var DH=q.ReactCurrentBatchConfig;function Og(l,u,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var v=f.stateNode}if(!v)throw Error(t(147,l));var E=v,T=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===T?u.ref:(u=function(P){var G=E.refs;P===null?delete G[T]:G[T]=P},u._stringRef=T,u)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function N_(l,u){throw l=Object.prototype.toString.call(u),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function iR(l){var u=l._init;return u(l._payload)}function sR(l){function u(ee,J){if(l){var re=ee.deletions;re===null?(ee.deletions=[J],ee.flags|=16):re.push(J)}}function f(ee,J){if(!l)return null;for(;J!==null;)u(ee,J),J=J.sibling;return null}function v(ee,J){for(ee=new Map;J!==null;)J.key!==null?ee.set(J.key,J):ee.set(J.index,J),J=J.sibling;return ee}function E(ee,J){return ee=rc(ee,J),ee.index=0,ee.sibling=null,ee}function T(ee,J,re){return ee.index=re,l?(re=ee.alternate,re!==null?(re=re.index,re<J?(ee.flags|=2,J):re):(ee.flags|=2,J)):(ee.flags|=1048576,J)}function P(ee){return l&&ee.alternate===null&&(ee.flags|=2),ee}function G(ee,J,re,Ae){return J===null||J.tag!==6?(J=xA(re,ee.mode,Ae),J.return=ee,J):(J=E(J,re),J.return=ee,J)}function K(ee,J,re,Ae){var ze=re.type;return ze===D?ye(ee,J,re.props.children,Ae,re.key):J!==null&&(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===pe&&iR(ze)===J.type)?(Ae=E(J,re.props),Ae.ref=Og(ee,J,re),Ae.return=ee,Ae):(Ae=Z_(re.type,re.key,re.props,null,ee.mode,Ae),Ae.ref=Og(ee,J,re),Ae.return=ee,Ae)}function ie(ee,J,re,Ae){return J===null||J.tag!==4||J.stateNode.containerInfo!==re.containerInfo||J.stateNode.implementation!==re.implementation?(J=TA(re,ee.mode,Ae),J.return=ee,J):(J=E(J,re.children||[]),J.return=ee,J)}function ye(ee,J,re,Ae,ze){return J===null||J.tag!==7?(J=Yu(re,ee.mode,Ae,ze),J.return=ee,J):(J=E(J,re),J.return=ee,J)}function ve(ee,J,re){if(typeof J=="string"&&J!==""||typeof J=="number")return J=xA(""+J,ee.mode,re),J.return=ee,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case W:return re=Z_(J.type,J.key,J.props,null,ee.mode,re),re.ref=Og(ee,null,J),re.return=ee,re;case $:return J=TA(J,ee.mode,re),J.return=ee,J;case pe:var Ae=J._init;return ve(ee,Ae(J._payload),re)}if(yn(J)||xe(J))return J=Yu(J,ee.mode,re,null),J.return=ee,J;N_(ee,J)}return null}function me(ee,J,re,Ae){var ze=J!==null?J.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return ze!==null?null:G(ee,J,""+re,Ae);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case W:return re.key===ze?K(ee,J,re,Ae):null;case $:return re.key===ze?ie(ee,J,re,Ae):null;case pe:return ze=re._init,me(ee,J,ze(re._payload),Ae)}if(yn(re)||xe(re))return ze!==null?null:ye(ee,J,re,Ae,null);N_(ee,re)}return null}function Oe(ee,J,re,Ae,ze){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return ee=ee.get(re)||null,G(J,ee,""+Ae,ze);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case W:return ee=ee.get(Ae.key===null?re:Ae.key)||null,K(J,ee,Ae,ze);case $:return ee=ee.get(Ae.key===null?re:Ae.key)||null,ie(J,ee,Ae,ze);case pe:var We=Ae._init;return Oe(ee,J,re,We(Ae._payload),ze)}if(yn(Ae)||xe(Ae))return ee=ee.get(re)||null,ye(J,ee,Ae,ze,null);N_(J,Ae)}return null}function Ge(ee,J,re,Ae){for(var ze=null,We=null,Ke=J,nt=J=0,Zn=null;Ke!==null&&nt<re.length;nt++){Ke.index>nt?(Zn=Ke,Ke=null):Zn=Ke.sibling;var St=me(ee,Ke,re[nt],Ae);if(St===null){Ke===null&&(Ke=Zn);break}l&&Ke&&St.alternate===null&&u(ee,Ke),J=T(St,J,nt),We===null?ze=St:We.sibling=St,We=St,Ke=Zn}if(nt===re.length)return f(ee,Ke),cn&&ju(ee,nt),ze;if(Ke===null){for(;nt<re.length;nt++)Ke=ve(ee,re[nt],Ae),Ke!==null&&(J=T(Ke,J,nt),We===null?ze=Ke:We.sibling=Ke,We=Ke);return cn&&ju(ee,nt),ze}for(Ke=v(ee,Ke);nt<re.length;nt++)Zn=Oe(Ke,ee,nt,re[nt],Ae),Zn!==null&&(l&&Zn.alternate!==null&&Ke.delete(Zn.key===null?nt:Zn.key),J=T(Zn,J,nt),We===null?ze=Zn:We.sibling=Zn,We=Zn);return l&&Ke.forEach(function(ic){return u(ee,ic)}),cn&&ju(ee,nt),ze}function qe(ee,J,re,Ae){var ze=xe(re);if(typeof ze!="function")throw Error(t(150));if(re=ze.call(re),re==null)throw Error(t(151));for(var We=ze=null,Ke=J,nt=J=0,Zn=null,St=re.next();Ke!==null&&!St.done;nt++,St=re.next()){Ke.index>nt?(Zn=Ke,Ke=null):Zn=Ke.sibling;var ic=me(ee,Ke,St.value,Ae);if(ic===null){Ke===null&&(Ke=Zn);break}l&&Ke&&ic.alternate===null&&u(ee,Ke),J=T(ic,J,nt),We===null?ze=ic:We.sibling=ic,We=ic,Ke=Zn}if(St.done)return f(ee,Ke),cn&&ju(ee,nt),ze;if(Ke===null){for(;!St.done;nt++,St=re.next())St=ve(ee,St.value,Ae),St!==null&&(J=T(St,J,nt),We===null?ze=St:We.sibling=St,We=St);return cn&&ju(ee,nt),ze}for(Ke=v(ee,Ke);!St.done;nt++,St=re.next())St=Oe(Ke,ee,nt,St.value,Ae),St!==null&&(l&&St.alternate!==null&&Ke.delete(St.key===null?nt:St.key),J=T(St,J,nt),We===null?ze=St:We.sibling=St,We=St);return l&&Ke.forEach(function(hG){return u(ee,hG)}),cn&&ju(ee,nt),ze}function kn(ee,J,re,Ae){if(typeof re=="object"&&re!==null&&re.type===D&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case W:e:{for(var ze=re.key,We=J;We!==null;){if(We.key===ze){if(ze=re.type,ze===D){if(We.tag===7){f(ee,We.sibling),J=E(We,re.props.children),J.return=ee,ee=J;break e}}else if(We.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===pe&&iR(ze)===We.type){f(ee,We.sibling),J=E(We,re.props),J.ref=Og(ee,We,re),J.return=ee,ee=J;break e}f(ee,We);break}else u(ee,We);We=We.sibling}re.type===D?(J=Yu(re.props.children,ee.mode,Ae,re.key),J.return=ee,ee=J):(Ae=Z_(re.type,re.key,re.props,null,ee.mode,Ae),Ae.ref=Og(ee,J,re),Ae.return=ee,ee=Ae)}return P(ee);case $:e:{for(We=re.key;J!==null;){if(J.key===We)if(J.tag===4&&J.stateNode.containerInfo===re.containerInfo&&J.stateNode.implementation===re.implementation){f(ee,J.sibling),J=E(J,re.children||[]),J.return=ee,ee=J;break e}else{f(ee,J);break}else u(ee,J);J=J.sibling}J=TA(re,ee.mode,Ae),J.return=ee,ee=J}return P(ee);case pe:return We=re._init,kn(ee,J,We(re._payload),Ae)}if(yn(re))return Ge(ee,J,re,Ae);if(xe(re))return qe(ee,J,re,Ae);N_(ee,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,J!==null&&J.tag===6?(f(ee,J.sibling),J=E(J,re),J.return=ee,ee=J):(f(ee,J),J=xA(re,ee.mode,Ae),J.return=ee,ee=J),P(ee)):f(ee,J)}return kn}var pf=sR(!0),oR=sR(!1),k_=Wl(null),P_=null,mf=null,RI=null;function DI(){RI=mf=P_=null}function MI(l){var u=k_.current;sn(k_),l._currentValue=u}function LI(l,u,f){for(;l!==null;){var v=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,v!==null&&(v.childLanes|=u)):v!==null&&(v.childLanes&u)!==u&&(v.childLanes|=u),l===f)break;l=l.return}}function gf(l,u){P_=l,RI=mf=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(ci=!0),l.firstContext=null)}function is(l){var u=l._currentValue;if(RI!==l)if(l={context:l,memoizedValue:u,next:null},mf===null){if(P_===null)throw Error(t(308));mf=l,P_.dependencies={lanes:0,firstContext:l}}else mf=mf.next=l;return u}var qu=null;function OI(l){qu===null?qu=[l]:qu.push(l)}function aR(l,u,f,v){var E=u.interleaved;return E===null?(f.next=f,OI(u)):(f.next=E.next,E.next=f),u.interleaved=f,Da(l,v)}function Da(l,u){l.lanes|=u;var f=l.alternate;for(f!==null&&(f.lanes|=u),f=l,l=l.return;l!==null;)l.childLanes|=u,f=l.alternate,f!==null&&(f.childLanes|=u),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Jl=!1;function VI(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lR(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ma(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function Yl(l,u,f){var v=l.updateQueue;if(v===null)return null;if(v=v.shared,(Ct&2)!==0){var E=v.pending;return E===null?u.next=u:(u.next=E.next,E.next=u),v.pending=u,Da(l,f)}return E=v.interleaved,E===null?(u.next=u,OI(v)):(u.next=E.next,E.next=u),v.interleaved=u,Da(l,f)}function R_(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var v=u.lanes;v&=l.pendingLanes,f|=v,u.lanes=f,yg(l,f)}}function cR(l,u){var f=l.updateQueue,v=l.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var E=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var P={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?E=T=P:T=T.next=P,f=f.next}while(f!==null);T===null?E=T=u:T=T.next=u}else E=T=u;f={baseState:v.baseState,firstBaseUpdate:E,lastBaseUpdate:T,shared:v.shared,effects:v.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}function D_(l,u,f,v){var E=l.updateQueue;Jl=!1;var T=E.firstBaseUpdate,P=E.lastBaseUpdate,G=E.shared.pending;if(G!==null){E.shared.pending=null;var K=G,ie=K.next;K.next=null,P===null?T=ie:P.next=ie,P=K;var ye=l.alternate;ye!==null&&(ye=ye.updateQueue,G=ye.lastBaseUpdate,G!==P&&(G===null?ye.firstBaseUpdate=ie:G.next=ie,ye.lastBaseUpdate=K))}if(T!==null){var ve=E.baseState;P=0,ye=ie=K=null,G=T;do{var me=G.lane,Oe=G.eventTime;if((v&me)===me){ye!==null&&(ye=ye.next={eventTime:Oe,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var Ge=l,qe=G;switch(me=u,Oe=f,qe.tag){case 1:if(Ge=qe.payload,typeof Ge=="function"){ve=Ge.call(Oe,ve,me);break e}ve=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=qe.payload,me=typeof Ge=="function"?Ge.call(Oe,ve,me):Ge,me==null)break e;ve=ne({},ve,me);break e;case 2:Jl=!0}}G.callback!==null&&G.lane!==0&&(l.flags|=64,me=E.effects,me===null?E.effects=[G]:me.push(G))}else Oe={eventTime:Oe,lane:me,tag:G.tag,payload:G.payload,callback:G.callback,next:null},ye===null?(ie=ye=Oe,K=ve):ye=ye.next=Oe,P|=me;if(G=G.next,G===null){if(G=E.shared.pending,G===null)break;me=G,G=me.next,me.next=null,E.lastBaseUpdate=me,E.shared.pending=null}}while(!0);if(ye===null&&(K=ve),E.baseState=K,E.firstBaseUpdate=ie,E.lastBaseUpdate=ye,u=E.shared.interleaved,u!==null){E=u;do P|=E.lane,E=E.next;while(E!==u)}else T===null&&(E.shared.lanes=0);Wu|=P,l.lanes=P,l.memoizedState=ve}}function uR(l,u,f){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var v=l[u],E=v.callback;if(E!==null){if(v.callback=null,v=f,typeof E!="function")throw Error(t(191,E));E.call(v)}}}var Vg={},So=Wl(Vg),Fg=Wl(Vg),Ug=Wl(Vg);function zu(l){if(l===Vg)throw Error(t(174));return l}function FI(l,u){switch(Kt(Ug,u),Kt(Fg,l),Kt(So,Vg),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:_a(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=_a(u,l)}sn(So),Kt(So,u)}function yf(){sn(So),sn(Fg),sn(Ug)}function dR(l){zu(Ug.current);var u=zu(So.current),f=_a(u,l.type);u!==f&&(Kt(Fg,l),Kt(So,f))}function UI(l){Fg.current===l&&(sn(So),sn(Fg))}var wn=Wl(0);function M_(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var BI=[];function HI(){for(var l=0;l<BI.length;l++)BI[l]._workInProgressVersionPrimary=null;BI.length=0}var L_=q.ReactCurrentDispatcher,GI=q.ReactCurrentBatchConfig,$u=0,_n=null,zn=null,Yn=null,O_=!1,Bg=!1,Hg=0,MH=0;function Cr(){throw Error(t(321))}function jI(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!Ms(l[f],u[f]))return!1;return!0}function qI(l,u,f,v,E,T){if($u=T,_n=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,L_.current=l===null||l.memoizedState===null?FH:UH,l=f(v,E),Bg){T=0;do{if(Bg=!1,Hg=0,25<=T)throw Error(t(301));T+=1,Yn=zn=null,u.updateQueue=null,L_.current=BH,l=f(v,E)}while(Bg)}if(L_.current=U_,u=zn!==null&&zn.next!==null,$u=0,Yn=zn=_n=null,O_=!1,u)throw Error(t(300));return l}function zI(){var l=Hg!==0;return Hg=0,l}function No(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?_n.memoizedState=Yn=l:Yn=Yn.next=l,Yn}function ss(){if(zn===null){var l=_n.alternate;l=l!==null?l.memoizedState:null}else l=zn.next;var u=Yn===null?_n.memoizedState:Yn.next;if(u!==null)Yn=u,zn=l;else{if(l===null)throw Error(t(310));zn=l,l={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},Yn===null?_n.memoizedState=Yn=l:Yn=Yn.next=l}return Yn}function Gg(l,u){return typeof u=="function"?u(l):u}function $I(l){var u=ss(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var v=zn,E=v.baseQueue,T=f.pending;if(T!==null){if(E!==null){var P=E.next;E.next=T.next,T.next=P}v.baseQueue=E=T,f.pending=null}if(E!==null){T=E.next,v=v.baseState;var G=P=null,K=null,ie=T;do{var ye=ie.lane;if(($u&ye)===ye)K!==null&&(K=K.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),v=ie.hasEagerState?ie.eagerState:l(v,ie.action);else{var ve={lane:ye,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};K===null?(G=K=ve,P=v):K=K.next=ve,_n.lanes|=ye,Wu|=ye}ie=ie.next}while(ie!==null&&ie!==T);K===null?P=v:K.next=G,Ms(v,u.memoizedState)||(ci=!0),u.memoizedState=v,u.baseState=P,u.baseQueue=K,f.lastRenderedState=v}if(l=f.interleaved,l!==null){E=l;do T=E.lane,_n.lanes|=T,Wu|=T,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function WI(l){var u=ss(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var v=f.dispatch,E=f.pending,T=u.memoizedState;if(E!==null){f.pending=null;var P=E=E.next;do T=l(T,P.action),P=P.next;while(P!==E);Ms(T,u.memoizedState)||(ci=!0),u.memoizedState=T,u.baseQueue===null&&(u.baseState=T),f.lastRenderedState=T}return[T,v]}function hR(){}function fR(l,u){var f=_n,v=ss(),E=u(),T=!Ms(v.memoizedState,E);if(T&&(v.memoizedState=E,ci=!0),v=v.queue,KI(gR.bind(null,f,v,l),[l]),v.getSnapshot!==u||T||Yn!==null&&Yn.memoizedState.tag&1){if(f.flags|=2048,jg(9,mR.bind(null,f,v,E,u),void 0,null),Xn===null)throw Error(t(349));($u&30)!==0||pR(f,u,E)}return E}function pR(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=_n.updateQueue,u===null?(u={lastEffect:null,stores:null},_n.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function mR(l,u,f,v){u.value=f,u.getSnapshot=v,yR(u)&&wR(l)}function gR(l,u,f){return f(function(){yR(u)&&wR(l)})}function yR(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!Ms(l,f)}catch{return!0}}function wR(l){var u=Da(l,1);u!==null&&Us(u,l,1,-1)}function _R(l){var u=No();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gg,lastRenderedState:l},u.queue=l,l=l.dispatch=VH.bind(null,_n,l),[u.memoizedState,l]}function jg(l,u,f,v){return l={tag:l,create:u,destroy:f,deps:v,next:null},u=_n.updateQueue,u===null?(u={lastEffect:null,stores:null},_n.updateQueue=u,u.lastEffect=l.next=l):(f=u.lastEffect,f===null?u.lastEffect=l.next=l:(v=f.next,f.next=l,l.next=v,u.lastEffect=l)),l}function vR(){return ss().memoizedState}function V_(l,u,f,v){var E=No();_n.flags|=l,E.memoizedState=jg(1|u,f,void 0,v===void 0?null:v)}function F_(l,u,f,v){var E=ss();v=v===void 0?null:v;var T=void 0;if(zn!==null){var P=zn.memoizedState;if(T=P.destroy,v!==null&&jI(v,P.deps)){E.memoizedState=jg(u,f,T,v);return}}_n.flags|=l,E.memoizedState=jg(1|u,f,T,v)}function ER(l,u){return V_(8390656,8,l,u)}function KI(l,u){return F_(2048,8,l,u)}function xR(l,u){return F_(4,2,l,u)}function TR(l,u){return F_(4,4,l,u)}function IR(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function AR(l,u,f){return f=f!=null?f.concat([l]):null,F_(4,4,IR.bind(null,u,l),f)}function QI(){}function bR(l,u){var f=ss();u=u===void 0?null:u;var v=f.memoizedState;return v!==null&&u!==null&&jI(u,v[1])?v[0]:(f.memoizedState=[l,u],l)}function CR(l,u){var f=ss();u=u===void 0?null:u;var v=f.memoizedState;return v!==null&&u!==null&&jI(u,v[1])?v[0]:(l=l(),f.memoizedState=[l,u],l)}function SR(l,u,f){return($u&21)===0?(l.baseState&&(l.baseState=!1,ci=!0),l.memoizedState=f):(Ms(f,u)||(f=mg(),_n.lanes|=f,Wu|=f,l.baseState=!0),u)}function LH(l,u){var f=Tt;Tt=f!==0&&4>f?f:4,l(!0);var v=GI.transition;GI.transition={};try{l(!1),u()}finally{Tt=f,GI.transition=v}}function NR(){return ss().memoizedState}function OH(l,u,f){var v=tc(l);if(f={lane:v,action:f,hasEagerState:!1,eagerState:null,next:null},kR(l))PR(u,f);else if(f=aR(l,u,f,v),f!==null){var E=qr();Us(f,l,v,E),RR(f,u,v)}}function VH(l,u,f){var v=tc(l),E={lane:v,action:f,hasEagerState:!1,eagerState:null,next:null};if(kR(l))PR(u,E);else{var T=l.alternate;if(l.lanes===0&&(T===null||T.lanes===0)&&(T=u.lastRenderedReducer,T!==null))try{var P=u.lastRenderedState,G=T(P,f);if(E.hasEagerState=!0,E.eagerState=G,Ms(G,P)){var K=u.interleaved;K===null?(E.next=E,OI(u)):(E.next=K.next,K.next=E),u.interleaved=E;return}}catch{}finally{}f=aR(l,u,E,v),f!==null&&(E=qr(),Us(f,l,v,E),RR(f,u,v))}}function kR(l){var u=l.alternate;return l===_n||u!==null&&u===_n}function PR(l,u){Bg=O_=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function RR(l,u,f){if((f&4194240)!==0){var v=u.lanes;v&=l.pendingLanes,f|=v,u.lanes=f,yg(l,f)}}var U_={readContext:is,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useInsertionEffect:Cr,useLayoutEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useMutableSource:Cr,useSyncExternalStore:Cr,useId:Cr,unstable_isNewReconciler:!1},FH={readContext:is,useCallback:function(l,u){return No().memoizedState=[l,u===void 0?null:u],l},useContext:is,useEffect:ER,useImperativeHandle:function(l,u,f){return f=f!=null?f.concat([l]):null,V_(4194308,4,IR.bind(null,u,l),f)},useLayoutEffect:function(l,u){return V_(4194308,4,l,u)},useInsertionEffect:function(l,u){return V_(4,2,l,u)},useMemo:function(l,u){var f=No();return u=u===void 0?null:u,l=l(),f.memoizedState=[l,u],l},useReducer:function(l,u,f){var v=No();return u=f!==void 0?f(u):u,v.memoizedState=v.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},v.queue=l,l=l.dispatch=OH.bind(null,_n,l),[v.memoizedState,l]},useRef:function(l){var u=No();return l={current:l},u.memoizedState=l},useState:_R,useDebugValue:QI,useDeferredValue:function(l){return No().memoizedState=l},useTransition:function(){var l=_R(!1),u=l[0];return l=LH.bind(null,l[1]),No().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,f){var v=_n,E=No();if(cn){if(f===void 0)throw Error(t(407));f=f()}else{if(f=u(),Xn===null)throw Error(t(349));($u&30)!==0||pR(v,u,f)}E.memoizedState=f;var T={value:f,getSnapshot:u};return E.queue=T,ER(gR.bind(null,v,T,l),[l]),v.flags|=2048,jg(9,mR.bind(null,v,T,f,u),void 0,null),f},useId:function(){var l=No(),u=Xn.identifierPrefix;if(cn){var f=Ra,v=Pa;f=(v&~(1<<32-ki(v)-1)).toString(32)+f,u=":"+u+"R"+f,f=Hg++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=MH++,u=":"+u+"r"+f.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},UH={readContext:is,useCallback:bR,useContext:is,useEffect:KI,useImperativeHandle:AR,useInsertionEffect:xR,useLayoutEffect:TR,useMemo:CR,useReducer:$I,useRef:vR,useState:function(){return $I(Gg)},useDebugValue:QI,useDeferredValue:function(l){var u=ss();return SR(u,zn.memoizedState,l)},useTransition:function(){var l=$I(Gg)[0],u=ss().memoizedState;return[l,u]},useMutableSource:hR,useSyncExternalStore:fR,useId:NR,unstable_isNewReconciler:!1},BH={readContext:is,useCallback:bR,useContext:is,useEffect:KI,useImperativeHandle:AR,useInsertionEffect:xR,useLayoutEffect:TR,useMemo:CR,useReducer:WI,useRef:vR,useState:function(){return WI(Gg)},useDebugValue:QI,useDeferredValue:function(l){var u=ss();return zn===null?u.memoizedState=l:SR(u,zn.memoizedState,l)},useTransition:function(){var l=WI(Gg)[0],u=ss().memoizedState;return[l,u]},useMutableSource:hR,useSyncExternalStore:fR,useId:NR,unstable_isNewReconciler:!1};function Os(l,u){if(l&&l.defaultProps){u=ne({},u),l=l.defaultProps;for(var f in l)u[f]===void 0&&(u[f]=l[f]);return u}return u}function JI(l,u,f,v){u=l.memoizedState,f=f(v,u),f=f==null?u:ne({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var B_={isMounted:function(l){return(l=l._reactInternals)?Rs(l)===l:!1},enqueueSetState:function(l,u,f){l=l._reactInternals;var v=qr(),E=tc(l),T=Ma(v,E);T.payload=u,f!=null&&(T.callback=f),u=Yl(l,T,E),u!==null&&(Us(u,l,E,v),R_(u,l,E))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var v=qr(),E=tc(l),T=Ma(v,E);T.tag=1,T.payload=u,f!=null&&(T.callback=f),u=Yl(l,T,E),u!==null&&(Us(u,l,E,v),R_(u,l,E))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=qr(),v=tc(l),E=Ma(f,v);E.tag=2,u!=null&&(E.callback=u),u=Yl(l,E,v),u!==null&&(Us(u,l,v,f),R_(u,l,v))}};function DR(l,u,f,v,E,T,P){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(v,T,P):u.prototype&&u.prototype.isPureReactComponent?!Ng(f,v)||!Ng(E,T):!0}function MR(l,u,f){var v=!1,E=Kl,T=u.contextType;return typeof T=="object"&&T!==null?T=is(T):(E=li(u)?Hu:br.current,v=u.contextTypes,T=(v=v!=null)?uf(l,E):Kl),u=new u(f,T),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=B_,l.stateNode=u,u._reactInternals=l,v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=T),u}function LR(l,u,f,v){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,v),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,v),u.state!==l&&B_.enqueueReplaceState(u,u.state,null)}function YI(l,u,f,v){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},VI(l);var T=u.contextType;typeof T=="object"&&T!==null?E.context=is(T):(T=li(u)?Hu:br.current,E.context=uf(l,T)),E.state=l.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(JI(l,u,T,f),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&B_.enqueueReplaceState(E,E.state,null),D_(l,f,E,v),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function wf(l,u){try{var f="",v=u;do f+=Ye(v),v=v.return;while(v);var E=f}catch(T){E=`
Error generating stack: `+T.message+`
`+T.stack}return{value:l,source:u,stack:E,digest:null}}function XI(l,u,f){return{value:l,source:null,stack:f??null,digest:u??null}}function ZI(l,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var HH=typeof WeakMap=="function"?WeakMap:Map;function OR(l,u,f){f=Ma(-1,f),f.tag=3,f.payload={element:null};var v=u.value;return f.callback=function(){W_||(W_=!0,pA=v),ZI(l,u)},f}function VR(l,u,f){f=Ma(-1,f),f.tag=3;var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var E=u.value;f.payload=function(){return v(E)},f.callback=function(){ZI(l,u)}}var T=l.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){ZI(l,u),typeof v!="function"&&(Zl===null?Zl=new Set([this]):Zl.add(this));var P=u.stack;this.componentDidCatch(u.value,{componentStack:P!==null?P:""})}),f}function FR(l,u,f){var v=l.pingCache;if(v===null){v=l.pingCache=new HH;var E=new Set;v.set(u,E)}else E=v.get(u),E===void 0&&(E=new Set,v.set(u,E));E.has(f)||(E.add(f),l=tG.bind(null,l,u,f),u.then(l,l))}function UR(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function BR(l,u,f,v,E){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=Ma(-1,1),u.tag=2,Yl(f,u,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var GH=q.ReactCurrentOwner,ci=!1;function jr(l,u,f,v){u.child=l===null?oR(u,null,f,v):pf(u,l.child,f,v)}function HR(l,u,f,v,E){f=f.render;var T=u.ref;return gf(u,E),v=qI(l,u,f,v,T,E),f=zI(),l!==null&&!ci?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,La(l,u,E)):(cn&&f&&CI(u),u.flags|=1,jr(l,u,v,E),u.child)}function GR(l,u,f,v,E){if(l===null){var T=f.type;return typeof T=="function"&&!EA(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=T,jR(l,u,T,v,E)):(l=Z_(f.type,null,v,u,u.mode,E),l.ref=u.ref,l.return=u,u.child=l)}if(T=l.child,(l.lanes&E)===0){var P=T.memoizedProps;if(f=f.compare,f=f!==null?f:Ng,f(P,v)&&l.ref===u.ref)return La(l,u,E)}return u.flags|=1,l=rc(T,v),l.ref=u.ref,l.return=u,u.child=l}function jR(l,u,f,v,E){if(l!==null){var T=l.memoizedProps;if(Ng(T,v)&&l.ref===u.ref)if(ci=!1,u.pendingProps=v=T,(l.lanes&E)!==0)(l.flags&131072)!==0&&(ci=!0);else return u.lanes=l.lanes,La(l,u,E)}return eA(l,u,f,v,E)}function qR(l,u,f){var v=u.pendingProps,E=v.children,T=l!==null?l.memoizedState:null;if(v.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(vf,Vi),Vi|=f;else{if((f&1073741824)===0)return l=T!==null?T.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Kt(vf,Vi),Vi|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=T!==null?T.baseLanes:f,Kt(vf,Vi),Vi|=v}else T!==null?(v=T.baseLanes|f,u.memoizedState=null):v=f,Kt(vf,Vi),Vi|=v;return jr(l,u,E,f),u.child}function zR(l,u){var f=u.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function eA(l,u,f,v,E){var T=li(f)?Hu:br.current;return T=uf(u,T),gf(u,E),f=qI(l,u,f,v,T,E),v=zI(),l!==null&&!ci?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,La(l,u,E)):(cn&&v&&CI(u),u.flags|=1,jr(l,u,f,E),u.child)}function $R(l,u,f,v,E){if(li(f)){var T=!0;I_(u)}else T=!1;if(gf(u,E),u.stateNode===null)G_(l,u),MR(u,f,v),YI(u,f,v,E),v=!0;else if(l===null){var P=u.stateNode,G=u.memoizedProps;P.props=G;var K=P.context,ie=f.contextType;typeof ie=="object"&&ie!==null?ie=is(ie):(ie=li(f)?Hu:br.current,ie=uf(u,ie));var ye=f.getDerivedStateFromProps,ve=typeof ye=="function"||typeof P.getSnapshotBeforeUpdate=="function";ve||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(G!==v||K!==ie)&&LR(u,P,v,ie),Jl=!1;var me=u.memoizedState;P.state=me,D_(u,v,P,E),K=u.memoizedState,G!==v||me!==K||ai.current||Jl?(typeof ye=="function"&&(JI(u,f,ye,v),K=u.memoizedState),(G=Jl||DR(u,f,G,v,me,K,ie))?(ve||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(u.flags|=4194308)):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=v,u.memoizedState=K),P.props=v,P.state=K,P.context=ie,v=G):(typeof P.componentDidMount=="function"&&(u.flags|=4194308),v=!1)}else{P=u.stateNode,lR(l,u),G=u.memoizedProps,ie=u.type===u.elementType?G:Os(u.type,G),P.props=ie,ve=u.pendingProps,me=P.context,K=f.contextType,typeof K=="object"&&K!==null?K=is(K):(K=li(f)?Hu:br.current,K=uf(u,K));var Oe=f.getDerivedStateFromProps;(ye=typeof Oe=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(G!==ve||me!==K)&&LR(u,P,v,K),Jl=!1,me=u.memoizedState,P.state=me,D_(u,v,P,E);var Ge=u.memoizedState;G!==ve||me!==Ge||ai.current||Jl?(typeof Oe=="function"&&(JI(u,f,Oe,v),Ge=u.memoizedState),(ie=Jl||DR(u,f,ie,v,me,Ge,K)||!1)?(ye||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(v,Ge,K),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(v,Ge,K)),typeof P.componentDidUpdate=="function"&&(u.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof P.componentDidUpdate!="function"||G===l.memoizedProps&&me===l.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&me===l.memoizedState||(u.flags|=1024),u.memoizedProps=v,u.memoizedState=Ge),P.props=v,P.state=Ge,P.context=K,v=ie):(typeof P.componentDidUpdate!="function"||G===l.memoizedProps&&me===l.memoizedState||(u.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&me===l.memoizedState||(u.flags|=1024),v=!1)}return tA(l,u,f,v,T,E)}function tA(l,u,f,v,E,T){zR(l,u);var P=(u.flags&128)!==0;if(!v&&!P)return E&&YP(u,f,!1),La(l,u,T);v=u.stateNode,GH.current=u;var G=P&&typeof f.getDerivedStateFromError!="function"?null:v.render();return u.flags|=1,l!==null&&P?(u.child=pf(u,l.child,null,T),u.child=pf(u,null,G,T)):jr(l,u,G,T),u.memoizedState=v.state,E&&YP(u,f,!0),u.child}function WR(l){var u=l.stateNode;u.pendingContext?QP(l,u.pendingContext,u.pendingContext!==u.context):u.context&&QP(l,u.context,!1),FI(l,u.containerInfo)}function KR(l,u,f,v,E){return ff(),PI(E),u.flags|=256,jr(l,u,f,v),u.child}var nA={dehydrated:null,treeContext:null,retryLane:0};function rA(l){return{baseLanes:l,cachePool:null,transitions:null}}function QR(l,u,f){var v=u.pendingProps,E=wn.current,T=!1,P=(u.flags&128)!==0,G;if((G=P)||(G=l!==null&&l.memoizedState===null?!1:(E&2)!==0),G?(T=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Kt(wn,E&1),l===null)return kI(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(P=v.children,l=v.fallback,T?(v=u.mode,T=u.child,P={mode:"hidden",children:P},(v&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=P):T=ev(P,v,0,null),l=Yu(l,v,f,null),T.return=u,l.return=u,T.sibling=l,u.child=T,u.child.memoizedState=rA(f),u.memoizedState=nA,l):iA(u,P));if(E=l.memoizedState,E!==null&&(G=E.dehydrated,G!==null))return jH(l,u,P,v,G,E,f);if(T){T=v.fallback,P=u.mode,E=l.child,G=E.sibling;var K={mode:"hidden",children:v.children};return(P&1)===0&&u.child!==E?(v=u.child,v.childLanes=0,v.pendingProps=K,u.deletions=null):(v=rc(E,K),v.subtreeFlags=E.subtreeFlags&14680064),G!==null?T=rc(G,T):(T=Yu(T,P,f,null),T.flags|=2),T.return=u,v.return=u,v.sibling=T,u.child=v,v=T,T=u.child,P=l.child.memoizedState,P=P===null?rA(f):{baseLanes:P.baseLanes|f,cachePool:null,transitions:P.transitions},T.memoizedState=P,T.childLanes=l.childLanes&~f,u.memoizedState=nA,v}return T=l.child,l=T.sibling,v=rc(T,{mode:"visible",children:v.children}),(u.mode&1)===0&&(v.lanes=f),v.return=u,v.sibling=null,l!==null&&(f=u.deletions,f===null?(u.deletions=[l],u.flags|=16):f.push(l)),u.child=v,u.memoizedState=null,v}function iA(l,u){return u=ev({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function H_(l,u,f,v){return v!==null&&PI(v),pf(u,l.child,null,f),l=iA(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function jH(l,u,f,v,E,T,P){if(f)return u.flags&256?(u.flags&=-257,v=XI(Error(t(422))),H_(l,u,P,v)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(T=v.fallback,E=u.mode,v=ev({mode:"visible",children:v.children},E,0,null),T=Yu(T,E,P,null),T.flags|=2,v.return=u,T.return=u,v.sibling=T,u.child=v,(u.mode&1)!==0&&pf(u,l.child,null,P),u.child.memoizedState=rA(P),u.memoizedState=nA,T);if((u.mode&1)===0)return H_(l,u,P,null);if(E.data==="$!"){if(v=E.nextSibling&&E.nextSibling.dataset,v)var G=v.dgst;return v=G,T=Error(t(419)),v=XI(T,v,void 0),H_(l,u,P,v)}if(G=(P&l.childLanes)!==0,ci||G){if(v=Xn,v!==null){switch(P&-P){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(v.suspendedLanes|P))!==0?0:E,E!==0&&E!==T.retryLane&&(T.retryLane=E,Da(l,E),Us(v,l,E,-1))}return vA(),v=XI(Error(t(421))),H_(l,u,P,v)}return E.data==="$?"?(u.flags|=128,u.child=l.child,u=nG.bind(null,l),E._reactRetry=u,null):(l=T.treeContext,Oi=$l(E.nextSibling),Li=u,cn=!0,Ls=null,l!==null&&(ns[rs++]=Pa,ns[rs++]=Ra,ns[rs++]=Gu,Pa=l.id,Ra=l.overflow,Gu=u),u=iA(u,v.children),u.flags|=4096,u)}function JR(l,u,f){l.lanes|=u;var v=l.alternate;v!==null&&(v.lanes|=u),LI(l.return,u,f)}function sA(l,u,f,v,E){var T=l.memoizedState;T===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:E}:(T.isBackwards=u,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=f,T.tailMode=E)}function YR(l,u,f){var v=u.pendingProps,E=v.revealOrder,T=v.tail;if(jr(l,u,v.children,f),v=wn.current,(v&2)!==0)v=v&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&JR(l,f,u);else if(l.tag===19)JR(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}v&=1}if(Kt(wn,v),(u.mode&1)===0)u.memoizedState=null;else switch(E){case"forwards":for(f=u.child,E=null;f!==null;)l=f.alternate,l!==null&&M_(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=u.child,u.child=null):(E=f.sibling,f.sibling=null),sA(u,!1,E,f,T);break;case"backwards":for(f=null,E=u.child,u.child=null;E!==null;){if(l=E.alternate,l!==null&&M_(l)===null){u.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}sA(u,!0,f,null,T);break;case"together":sA(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function G_(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function La(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),Wu|=u.lanes,(f&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(t(153));if(u.child!==null){for(l=u.child,f=rc(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=rc(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function qH(l,u,f){switch(u.tag){case 3:WR(u),ff();break;case 5:dR(u);break;case 1:li(u.type)&&I_(u);break;case 4:FI(u,u.stateNode.containerInfo);break;case 10:var v=u.type._context,E=u.memoizedProps.value;Kt(k_,v._currentValue),v._currentValue=E;break;case 13:if(v=u.memoizedState,v!==null)return v.dehydrated!==null?(Kt(wn,wn.current&1),u.flags|=128,null):(f&u.child.childLanes)!==0?QR(l,u,f):(Kt(wn,wn.current&1),l=La(l,u,f),l!==null?l.sibling:null);Kt(wn,wn.current&1);break;case 19:if(v=(f&u.childLanes)!==0,(l.flags&128)!==0){if(v)return YR(l,u,f);u.flags|=128}if(E=u.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Kt(wn,wn.current),v)break;return null;case 22:case 23:return u.lanes=0,qR(l,u,f)}return La(l,u,f)}var XR,oA,ZR,e2;XR=function(l,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},oA=function(){},ZR=function(l,u,f,v){var E=l.memoizedProps;if(E!==v){l=u.stateNode,zu(So.current);var T=null;switch(f){case"input":E=mt(l,E),v=mt(l,v),T=[];break;case"select":E=ne({},E,{value:void 0}),v=ne({},v,{value:void 0}),T=[];break;case"textarea":E=kl(l,E),v=kl(l,v),T=[];break;default:typeof E.onClick!="function"&&typeof v.onClick=="function"&&(l.onclick=E_)}Ci(f,v);var P;f=null;for(ie in E)if(!v.hasOwnProperty(ie)&&E.hasOwnProperty(ie)&&E[ie]!=null)if(ie==="style"){var G=E[ie];for(P in G)G.hasOwnProperty(P)&&(f||(f={}),f[P]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(i.hasOwnProperty(ie)?T||(T=[]):(T=T||[]).push(ie,null));for(ie in v){var K=v[ie];if(G=E!=null?E[ie]:void 0,v.hasOwnProperty(ie)&&K!==G&&(K!=null||G!=null))if(ie==="style")if(G){for(P in G)!G.hasOwnProperty(P)||K&&K.hasOwnProperty(P)||(f||(f={}),f[P]="");for(P in K)K.hasOwnProperty(P)&&G[P]!==K[P]&&(f||(f={}),f[P]=K[P])}else f||(T||(T=[]),T.push(ie,f)),f=K;else ie==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,G=G?G.__html:void 0,K!=null&&G!==K&&(T=T||[]).push(ie,K)):ie==="children"?typeof K!="string"&&typeof K!="number"||(T=T||[]).push(ie,""+K):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(i.hasOwnProperty(ie)?(K!=null&&ie==="onScroll"&&rn("scroll",l),T||G===K||(T=[])):(T=T||[]).push(ie,K))}f&&(T=T||[]).push("style",f);var ie=T;(u.updateQueue=ie)&&(u.flags|=4)}},e2=function(l,u,f,v){f!==v&&(u.flags|=4)};function qg(l,u){if(!cn)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:v.sibling=null}}function Sr(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,v=0;if(u)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,v|=E.subtreeFlags&14680064,v|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,v|=E.subtreeFlags,v|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=v,l.childLanes=f,u}function zH(l,u,f){var v=u.pendingProps;switch(SI(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(u),null;case 1:return li(u.type)&&T_(),Sr(u),null;case 3:return v=u.stateNode,yf(),sn(ai),sn(br),HI(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(l===null||l.child===null)&&(S_(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ls!==null&&(yA(Ls),Ls=null))),oA(l,u),Sr(u),null;case 5:UI(u);var E=zu(Ug.current);if(f=u.type,l!==null&&u.stateNode!=null)ZR(l,u,f,v,E),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!v){if(u.stateNode===null)throw Error(t(166));return Sr(u),null}if(l=zu(So.current),S_(u)){v=u.stateNode,f=u.type;var T=u.memoizedProps;switch(v[Co]=u,v[Mg]=T,l=(u.mode&1)!==0,f){case"dialog":rn("cancel",v),rn("close",v);break;case"iframe":case"object":case"embed":rn("load",v);break;case"video":case"audio":for(E=0;E<Pg.length;E++)rn(Pg[E],v);break;case"source":rn("error",v);break;case"img":case"image":case"link":rn("error",v),rn("load",v);break;case"details":rn("toggle",v);break;case"input":zt(v,T),rn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!T.multiple},rn("invalid",v);break;case"textarea":Pl(v,T),rn("invalid",v)}Ci(f,T),E=null;for(var P in T)if(T.hasOwnProperty(P)){var G=T[P];P==="children"?typeof G=="string"?v.textContent!==G&&(T.suppressHydrationWarning!==!0&&v_(v.textContent,G,l),E=["children",G]):typeof G=="number"&&v.textContent!==""+G&&(T.suppressHydrationWarning!==!0&&v_(v.textContent,G,l),E=["children",""+G]):i.hasOwnProperty(P)&&G!=null&&P==="onScroll"&&rn("scroll",v)}switch(f){case"input":it(v),co(v,T,!0);break;case"textarea":it(v),bs(v);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(v.onclick=E_)}v=E,u.updateQueue=v,v!==null&&(u.flags|=4)}else{P=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Rl(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=P.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof v.is=="string"?l=P.createElement(f,{is:v.is}):(l=P.createElement(f),f==="select"&&(P=l,v.multiple?P.multiple=!0:v.size&&(P.size=v.size))):l=P.createElementNS(l,f),l[Co]=u,l[Mg]=v,XR(l,u,!1,!1),u.stateNode=l;e:{switch(P=Ml(f,v),f){case"dialog":rn("cancel",l),rn("close",l),E=v;break;case"iframe":case"object":case"embed":rn("load",l),E=v;break;case"video":case"audio":for(E=0;E<Pg.length;E++)rn(Pg[E],l);E=v;break;case"source":rn("error",l),E=v;break;case"img":case"image":case"link":rn("error",l),rn("load",l),E=v;break;case"details":rn("toggle",l),E=v;break;case"input":zt(l,v),E=mt(l,v),rn("invalid",l);break;case"option":E=v;break;case"select":l._wrapperState={wasMultiple:!!v.multiple},E=ne({},v,{value:void 0}),rn("invalid",l);break;case"textarea":Pl(l,v),E=kl(l,v),rn("invalid",l);break;default:E=v}Ci(f,E),G=E;for(T in G)if(G.hasOwnProperty(T)){var K=G[T];T==="style"?Dl(l,K):T==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,K!=null&&bu(l,K)):T==="children"?typeof K=="string"?(f!=="textarea"||K!=="")&&uo(l,K):typeof K=="number"&&uo(l,""+K):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(i.hasOwnProperty(T)?K!=null&&T==="onScroll"&&rn("scroll",l):K!=null&&O(l,T,K,P))}switch(f){case"input":it(l),co(l,v,!1);break;case"textarea":it(l),bs(l);break;case"option":v.value!=null&&l.setAttribute("value",""+Ne(v.value));break;case"select":l.multiple=!!v.multiple,T=v.value,T!=null?si(l,!!v.multiple,T,!1):v.defaultValue!=null&&si(l,!!v.multiple,v.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=E_)}switch(f){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Sr(u),null;case 6:if(l&&u.stateNode!=null)e2(l,u,l.memoizedProps,v);else{if(typeof v!="string"&&u.stateNode===null)throw Error(t(166));if(f=zu(Ug.current),zu(So.current),S_(u)){if(v=u.stateNode,f=u.memoizedProps,v[Co]=u,(T=v.nodeValue!==f)&&(l=Li,l!==null))switch(l.tag){case 3:v_(v.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&v_(v.nodeValue,f,(l.mode&1)!==0)}T&&(u.flags|=4)}else v=(f.nodeType===9?f:f.ownerDocument).createTextNode(v),v[Co]=u,u.stateNode=v}return Sr(u),null;case 13:if(sn(wn),v=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(cn&&Oi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)rR(),ff(),u.flags|=98560,T=!1;else if(T=S_(u),v!==null&&v.dehydrated!==null){if(l===null){if(!T)throw Error(t(318));if(T=u.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[Co]=u}else ff(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Sr(u),T=!1}else Ls!==null&&(yA(Ls),Ls=null),T=!0;if(!T)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=f,u):(v=v!==null,v!==(l!==null&&l.memoizedState!==null)&&v&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(wn.current&1)!==0?$n===0&&($n=3):vA())),u.updateQueue!==null&&(u.flags|=4),Sr(u),null);case 4:return yf(),oA(l,u),l===null&&Rg(u.stateNode.containerInfo),Sr(u),null;case 10:return MI(u.type._context),Sr(u),null;case 17:return li(u.type)&&T_(),Sr(u),null;case 19:if(sn(wn),T=u.memoizedState,T===null)return Sr(u),null;if(v=(u.flags&128)!==0,P=T.rendering,P===null)if(v)qg(T,!1);else{if($n!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(P=M_(l),P!==null){for(u.flags|=128,qg(T,!1),v=P.updateQueue,v!==null&&(u.updateQueue=v,u.flags|=4),u.subtreeFlags=0,v=f,f=u.child;f!==null;)T=f,l=v,T.flags&=14680066,P=T.alternate,P===null?(T.childLanes=0,T.lanes=l,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=P.childLanes,T.lanes=P.lanes,T.child=P.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=P.memoizedProps,T.memoizedState=P.memoizedState,T.updateQueue=P.updateQueue,T.type=P.type,l=P.dependencies,T.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Kt(wn,wn.current&1|2),u.child}l=l.sibling}T.tail!==null&&nn()>Ef&&(u.flags|=128,v=!0,qg(T,!1),u.lanes=4194304)}else{if(!v)if(l=M_(P),l!==null){if(u.flags|=128,v=!0,f=l.updateQueue,f!==null&&(u.updateQueue=f,u.flags|=4),qg(T,!0),T.tail===null&&T.tailMode==="hidden"&&!P.alternate&&!cn)return Sr(u),null}else 2*nn()-T.renderingStartTime>Ef&&f!==1073741824&&(u.flags|=128,v=!0,qg(T,!1),u.lanes=4194304);T.isBackwards?(P.sibling=u.child,u.child=P):(f=T.last,f!==null?f.sibling=P:u.child=P,T.last=P)}return T.tail!==null?(u=T.tail,T.rendering=u,T.tail=u.sibling,T.renderingStartTime=nn(),u.sibling=null,f=wn.current,Kt(wn,v?f&1|2:f&1),u):(Sr(u),null);case 22:case 23:return _A(),v=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==v&&(u.flags|=8192),v&&(u.mode&1)!==0?(Vi&1073741824)!==0&&(Sr(u),u.subtreeFlags&6&&(u.flags|=8192)):Sr(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function $H(l,u){switch(SI(u),u.tag){case 1:return li(u.type)&&T_(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return yf(),sn(ai),sn(br),HI(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return UI(u),null;case 13:if(sn(wn),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(t(340));ff()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return sn(wn),null;case 4:return yf(),null;case 10:return MI(u.type._context),null;case 22:case 23:return _A(),null;case 24:return null;default:return null}}var j_=!1,Nr=!1,WH=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function _f(l,u){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(v){In(l,u,v)}else f.current=null}function aA(l,u,f){try{f()}catch(v){In(l,u,v)}}var t2=!1;function KH(l,u){if(_I=ba,l=DP(),dI(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var E=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var P=0,G=-1,K=-1,ie=0,ye=0,ve=l,me=null;t:for(;;){for(var Oe;ve!==f||E!==0&&ve.nodeType!==3||(G=P+E),ve!==T||v!==0&&ve.nodeType!==3||(K=P+v),ve.nodeType===3&&(P+=ve.nodeValue.length),(Oe=ve.firstChild)!==null;)me=ve,ve=Oe;for(;;){if(ve===l)break t;if(me===f&&++ie===E&&(G=P),me===T&&++ye===v&&(K=P),(Oe=ve.nextSibling)!==null)break;ve=me,me=ve.parentNode}ve=Oe}f=G===-1||K===-1?null:{start:G,end:K}}else f=null}f=f||{start:0,end:0}}else f=null;for(vI={focusedElem:l,selectionRange:f},ba=!1,Ue=u;Ue!==null;)if(u=Ue,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ue=l;else for(;Ue!==null;){u=Ue;try{var Ge=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Ge!==null){var qe=Ge.memoizedProps,kn=Ge.memoizedState,ee=u.stateNode,J=ee.getSnapshotBeforeUpdate(u.elementType===u.type?qe:Os(u.type,qe),kn);ee.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var re=u.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ae){In(u,u.return,Ae)}if(l=u.sibling,l!==null){l.return=u.return,Ue=l;break}Ue=u.return}return Ge=t2,t2=!1,Ge}function zg(l,u,f){var v=u.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var E=v=v.next;do{if((E.tag&l)===l){var T=E.destroy;E.destroy=void 0,T!==void 0&&aA(u,f,T)}E=E.next}while(E!==v)}}function q_(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&l)===l){var v=f.create;f.destroy=v()}f=f.next}while(f!==u)}}function lA(l){var u=l.ref;if(u!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof u=="function"?u(l):u.current=l}}function n2(l){var u=l.alternate;u!==null&&(l.alternate=null,n2(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[Co],delete u[Mg],delete u[II],delete u[kH],delete u[PH])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function r2(l){return l.tag===5||l.tag===3||l.tag===4}function i2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||r2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function cA(l,u,f){var v=l.tag;if(v===5||v===6)l=l.stateNode,u?f.nodeType===8?f.parentNode.insertBefore(l,u):f.insertBefore(l,u):(f.nodeType===8?(u=f.parentNode,u.insertBefore(l,f)):(u=f,u.appendChild(l)),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=E_));else if(v!==4&&(l=l.child,l!==null))for(cA(l,u,f),l=l.sibling;l!==null;)cA(l,u,f),l=l.sibling}function uA(l,u,f){var v=l.tag;if(v===5||v===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(v!==4&&(l=l.child,l!==null))for(uA(l,u,f),l=l.sibling;l!==null;)uA(l,u,f),l=l.sibling}var pr=null,Vs=!1;function Xl(l,u,f){for(f=f.child;f!==null;)s2(l,u,f),f=f.sibling}function s2(l,u,f){if(Ni&&typeof Ni.onCommitFiberUnmount=="function")try{Ni.onCommitFiberUnmount(Pu,f)}catch{}switch(f.tag){case 5:Nr||_f(f,u);case 6:var v=pr,E=Vs;pr=null,Xl(l,u,f),pr=v,Vs=E,pr!==null&&(Vs?(l=pr,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):pr.removeChild(f.stateNode));break;case 18:pr!==null&&(Vs?(l=pr,f=f.stateNode,l.nodeType===8?TI(l.parentNode,f):l.nodeType===1&&TI(l,f),Gl(l)):TI(pr,f.stateNode));break;case 4:v=pr,E=Vs,pr=f.stateNode.containerInfo,Vs=!0,Xl(l,u,f),pr=v,Vs=E;break;case 0:case 11:case 14:case 15:if(!Nr&&(v=f.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){E=v=v.next;do{var T=E,P=T.destroy;T=T.tag,P!==void 0&&((T&2)!==0||(T&4)!==0)&&aA(f,u,P),E=E.next}while(E!==v)}Xl(l,u,f);break;case 1:if(!Nr&&(_f(f,u),v=f.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=f.memoizedProps,v.state=f.memoizedState,v.componentWillUnmount()}catch(G){In(f,u,G)}Xl(l,u,f);break;case 21:Xl(l,u,f);break;case 22:f.mode&1?(Nr=(v=Nr)||f.memoizedState!==null,Xl(l,u,f),Nr=v):Xl(l,u,f);break;default:Xl(l,u,f)}}function o2(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new WH),u.forEach(function(v){var E=rG.bind(null,l,v);f.has(v)||(f.add(v),v.then(E,E))})}}function Fs(l,u){var f=u.deletions;if(f!==null)for(var v=0;v<f.length;v++){var E=f[v];try{var T=l,P=u,G=P;e:for(;G!==null;){switch(G.tag){case 5:pr=G.stateNode,Vs=!1;break e;case 3:pr=G.stateNode.containerInfo,Vs=!0;break e;case 4:pr=G.stateNode.containerInfo,Vs=!0;break e}G=G.return}if(pr===null)throw Error(t(160));s2(T,P,E),pr=null,Vs=!1;var K=E.alternate;K!==null&&(K.return=null),E.return=null}catch(ie){In(E,u,ie)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)a2(u,l),u=u.sibling}function a2(l,u){var f=l.alternate,v=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Fs(u,l),ko(l),v&4){try{zg(3,l,l.return),q_(3,l)}catch(qe){In(l,l.return,qe)}try{zg(5,l,l.return)}catch(qe){In(l,l.return,qe)}}break;case 1:Fs(u,l),ko(l),v&512&&f!==null&&_f(f,f.return);break;case 5:if(Fs(u,l),ko(l),v&512&&f!==null&&_f(f,f.return),l.flags&32){var E=l.stateNode;try{uo(E,"")}catch(qe){In(l,l.return,qe)}}if(v&4&&(E=l.stateNode,E!=null)){var T=l.memoizedProps,P=f!==null?f.memoizedProps:T,G=l.type,K=l.updateQueue;if(l.updateQueue=null,K!==null)try{G==="input"&&T.type==="radio"&&T.name!=null&&tn(E,T),Ml(G,P);var ie=Ml(G,T);for(P=0;P<K.length;P+=2){var ye=K[P],ve=K[P+1];ye==="style"?Dl(E,ve):ye==="dangerouslySetInnerHTML"?bu(E,ve):ye==="children"?uo(E,ve):O(E,ye,ve,ie)}switch(G){case"input":Gr(E,T);break;case"textarea":Au(E,T);break;case"select":var me=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!T.multiple;var Oe=T.value;Oe!=null?si(E,!!T.multiple,Oe,!1):me!==!!T.multiple&&(T.defaultValue!=null?si(E,!!T.multiple,T.defaultValue,!0):si(E,!!T.multiple,T.multiple?[]:"",!1))}E[Mg]=T}catch(qe){In(l,l.return,qe)}}break;case 6:if(Fs(u,l),ko(l),v&4){if(l.stateNode===null)throw Error(t(162));E=l.stateNode,T=l.memoizedProps;try{E.nodeValue=T}catch(qe){In(l,l.return,qe)}}break;case 3:if(Fs(u,l),ko(l),v&4&&f!==null&&f.memoizedState.isDehydrated)try{Gl(u.containerInfo)}catch(qe){In(l,l.return,qe)}break;case 4:Fs(u,l),ko(l);break;case 13:Fs(u,l),ko(l),E=l.child,E.flags&8192&&(T=E.memoizedState!==null,E.stateNode.isHidden=T,!T||E.alternate!==null&&E.alternate.memoizedState!==null||(fA=nn())),v&4&&o2(l);break;case 22:if(ye=f!==null&&f.memoizedState!==null,l.mode&1?(Nr=(ie=Nr)||ye,Fs(u,l),Nr=ie):Fs(u,l),ko(l),v&8192){if(ie=l.memoizedState!==null,(l.stateNode.isHidden=ie)&&!ye&&(l.mode&1)!==0)for(Ue=l,ye=l.child;ye!==null;){for(ve=Ue=ye;Ue!==null;){switch(me=Ue,Oe=me.child,me.tag){case 0:case 11:case 14:case 15:zg(4,me,me.return);break;case 1:_f(me,me.return);var Ge=me.stateNode;if(typeof Ge.componentWillUnmount=="function"){v=me,f=me.return;try{u=v,Ge.props=u.memoizedProps,Ge.state=u.memoizedState,Ge.componentWillUnmount()}catch(qe){In(v,f,qe)}}break;case 5:_f(me,me.return);break;case 22:if(me.memoizedState!==null){u2(ve);continue}}Oe!==null?(Oe.return=me,Ue=Oe):u2(ve)}ye=ye.sibling}e:for(ye=null,ve=l;;){if(ve.tag===5){if(ye===null){ye=ve;try{E=ve.stateNode,ie?(T=E.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(G=ve.stateNode,K=ve.memoizedProps.style,P=K!=null&&K.hasOwnProperty("display")?K.display:null,G.style.display=fo("display",P))}catch(qe){In(l,l.return,qe)}}}else if(ve.tag===6){if(ye===null)try{ve.stateNode.nodeValue=ie?"":ve.memoizedProps}catch(qe){In(l,l.return,qe)}}else if((ve.tag!==22&&ve.tag!==23||ve.memoizedState===null||ve===l)&&ve.child!==null){ve.child.return=ve,ve=ve.child;continue}if(ve===l)break e;for(;ve.sibling===null;){if(ve.return===null||ve.return===l)break e;ye===ve&&(ye=null),ve=ve.return}ye===ve&&(ye=null),ve.sibling.return=ve.return,ve=ve.sibling}}break;case 19:Fs(u,l),ko(l),v&4&&o2(l);break;case 21:break;default:Fs(u,l),ko(l)}}function ko(l){var u=l.flags;if(u&2){try{e:{for(var f=l.return;f!==null;){if(r2(f)){var v=f;break e}f=f.return}throw Error(t(160))}switch(v.tag){case 5:var E=v.stateNode;v.flags&32&&(uo(E,""),v.flags&=-33);var T=i2(l);uA(l,T,E);break;case 3:case 4:var P=v.stateNode.containerInfo,G=i2(l);cA(l,G,P);break;default:throw Error(t(161))}}catch(K){In(l,l.return,K)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function QH(l,u,f){Ue=l,l2(l)}function l2(l,u,f){for(var v=(l.mode&1)!==0;Ue!==null;){var E=Ue,T=E.child;if(E.tag===22&&v){var P=E.memoizedState!==null||j_;if(!P){var G=E.alternate,K=G!==null&&G.memoizedState!==null||Nr;G=j_;var ie=Nr;if(j_=P,(Nr=K)&&!ie)for(Ue=E;Ue!==null;)P=Ue,K=P.child,P.tag===22&&P.memoizedState!==null?d2(E):K!==null?(K.return=P,Ue=K):d2(E);for(;T!==null;)Ue=T,l2(T),T=T.sibling;Ue=E,j_=G,Nr=ie}c2(l)}else(E.subtreeFlags&8772)!==0&&T!==null?(T.return=E,Ue=T):c2(l)}}function c2(l){for(;Ue!==null;){var u=Ue;if((u.flags&8772)!==0){var f=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Nr||q_(5,u);break;case 1:var v=u.stateNode;if(u.flags&4&&!Nr)if(f===null)v.componentDidMount();else{var E=u.elementType===u.type?f.memoizedProps:Os(u.type,f.memoizedProps);v.componentDidUpdate(E,f.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var T=u.updateQueue;T!==null&&uR(u,T,v);break;case 3:var P=u.updateQueue;if(P!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=u.child.stateNode;break;case 1:f=u.child.stateNode}uR(u,P,f)}break;case 5:var G=u.stateNode;if(f===null&&u.flags&4){f=G;var K=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":K.autoFocus&&f.focus();break;case"img":K.src&&(f.src=K.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var ie=u.alternate;if(ie!==null){var ye=ie.memoizedState;if(ye!==null){var ve=ye.dehydrated;ve!==null&&Gl(ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Nr||u.flags&512&&lA(u)}catch(me){In(u,u.return,me)}}if(u===l){Ue=null;break}if(f=u.sibling,f!==null){f.return=u.return,Ue=f;break}Ue=u.return}}function u2(l){for(;Ue!==null;){var u=Ue;if(u===l){Ue=null;break}var f=u.sibling;if(f!==null){f.return=u.return,Ue=f;break}Ue=u.return}}function d2(l){for(;Ue!==null;){var u=Ue;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{q_(4,u)}catch(K){In(u,f,K)}break;case 1:var v=u.stateNode;if(typeof v.componentDidMount=="function"){var E=u.return;try{v.componentDidMount()}catch(K){In(u,E,K)}}var T=u.return;try{lA(u)}catch(K){In(u,T,K)}break;case 5:var P=u.return;try{lA(u)}catch(K){In(u,P,K)}}}catch(K){In(u,u.return,K)}if(u===l){Ue=null;break}var G=u.sibling;if(G!==null){G.return=u.return,Ue=G;break}Ue=u.return}}var JH=Math.ceil,z_=q.ReactCurrentDispatcher,dA=q.ReactCurrentOwner,os=q.ReactCurrentBatchConfig,Ct=0,Xn=null,Fn=null,mr=0,Vi=0,vf=Wl(0),$n=0,$g=null,Wu=0,$_=0,hA=0,Wg=null,ui=null,fA=0,Ef=1/0,Oa=null,W_=!1,pA=null,Zl=null,K_=!1,ec=null,Q_=0,Kg=0,mA=null,J_=-1,Y_=0;function qr(){return(Ct&6)!==0?nn():J_!==-1?J_:J_=nn()}function tc(l){return(l.mode&1)===0?1:(Ct&2)!==0&&mr!==0?mr&-mr:DH.transition!==null?(Y_===0&&(Y_=mg()),Y_):(l=Tt,l!==0||(l=window.event,l=l===void 0?16:Qh(l.type)),l)}function Us(l,u,f,v){if(50<Kg)throw Kg=0,mA=null,Error(t(185));Lu(l,f,v),((Ct&2)===0||l!==Xn)&&(l===Xn&&((Ct&2)===0&&($_|=f),$n===4&&nc(l,mr)),di(l,v),f===1&&Ct===0&&(u.mode&1)===0&&(Ef=nn()+500,A_&&Ql()))}function di(l,u){var f=l.callbackNode;Mu(l,u);var v=Ta(l,l===Xn?mr:0);if(v===0)f!==null&&Gh(f),l.callbackNode=null,l.callbackPriority=0;else if(u=v&-v,l.callbackPriority!==u){if(f!=null&&Gh(f),u===1)l.tag===0?RH(f2.bind(null,l)):XP(f2.bind(null,l)),SH(function(){(Ct&6)===0&&Ql()}),f=null;else{switch(yo(v)){case 1:f=jh;break;case 4:f=hg;break;case 16:f=ku;break;case 536870912:f=qh;break;default:f=ku}f=E2(f,h2.bind(null,l))}l.callbackPriority=u,l.callbackNode=f}}function h2(l,u){if(J_=-1,Y_=0,(Ct&6)!==0)throw Error(t(327));var f=l.callbackNode;if(xf()&&l.callbackNode!==f)return null;var v=Ta(l,l===Xn?mr:0);if(v===0)return null;if((v&30)!==0||(v&l.expiredLanes)!==0||u)u=X_(l,v);else{u=v;var E=Ct;Ct|=2;var T=m2();(Xn!==l||mr!==u)&&(Oa=null,Ef=nn()+500,Qu(l,u));do try{ZH();break}catch(G){p2(l,G)}while(!0);DI(),z_.current=T,Ct=E,Fn!==null?u=0:(Xn=null,mr=0,u=$n)}if(u!==0){if(u===2&&(E=pg(l),E!==0&&(v=E,u=gA(l,E))),u===1)throw f=$g,Qu(l,0),nc(l,v),di(l,nn()),f;if(u===6)nc(l,v);else{if(E=l.current.alternate,(v&30)===0&&!YH(E)&&(u=X_(l,v),u===2&&(T=pg(l),T!==0&&(v=T,u=gA(l,T))),u===1))throw f=$g,Qu(l,0),nc(l,v),di(l,nn()),f;switch(l.finishedWork=E,l.finishedLanes=v,u){case 0:case 1:throw Error(t(345));case 2:Ju(l,ui,Oa);break;case 3:if(nc(l,v),(v&130023424)===v&&(u=fA+500-nn(),10<u)){if(Ta(l,0)!==0)break;if(E=l.suspendedLanes,(E&v)!==v){qr(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=xI(Ju.bind(null,l,ui,Oa),u);break}Ju(l,ui,Oa);break;case 4:if(nc(l,v),(v&4194240)===v)break;for(u=l.eventTimes,E=-1;0<v;){var P=31-ki(v);T=1<<P,P=u[P],P>E&&(E=P),v&=~T}if(v=E,v=nn()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*JH(v/1960))-v,10<v){l.timeoutHandle=xI(Ju.bind(null,l,ui,Oa),v);break}Ju(l,ui,Oa);break;case 5:Ju(l,ui,Oa);break;default:throw Error(t(329))}}}return di(l,nn()),l.callbackNode===f?h2.bind(null,l):null}function gA(l,u){var f=Wg;return l.current.memoizedState.isDehydrated&&(Qu(l,u).flags|=256),l=X_(l,u),l!==2&&(u=ui,ui=f,u!==null&&yA(u)),l}function yA(l){ui===null?ui=l:ui.push.apply(ui,l)}function YH(l){for(var u=l;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var v=0;v<f.length;v++){var E=f[v],T=E.getSnapshot;E=E.value;try{if(!Ms(T(),E))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function nc(l,u){for(u&=~hA,u&=~$_,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var f=31-ki(u),v=1<<f;l[f]=-1,u&=~v}}function f2(l){if((Ct&6)!==0)throw Error(t(327));xf();var u=Ta(l,0);if((u&1)===0)return di(l,nn()),null;var f=X_(l,u);if(l.tag!==0&&f===2){var v=pg(l);v!==0&&(u=v,f=gA(l,v))}if(f===1)throw f=$g,Qu(l,0),nc(l,u),di(l,nn()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Ju(l,ui,Oa),di(l,nn()),null}function wA(l,u){var f=Ct;Ct|=1;try{return l(u)}finally{Ct=f,Ct===0&&(Ef=nn()+500,A_&&Ql())}}function Ku(l){ec!==null&&ec.tag===0&&(Ct&6)===0&&xf();var u=Ct;Ct|=1;var f=os.transition,v=Tt;try{if(os.transition=null,Tt=1,l)return l()}finally{Tt=v,os.transition=f,Ct=u,(Ct&6)===0&&Ql()}}function _A(){Vi=vf.current,sn(vf)}function Qu(l,u){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,CH(f)),Fn!==null)for(f=Fn.return;f!==null;){var v=f;switch(SI(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&T_();break;case 3:yf(),sn(ai),sn(br),HI();break;case 5:UI(v);break;case 4:yf();break;case 13:sn(wn);break;case 19:sn(wn);break;case 10:MI(v.type._context);break;case 22:case 23:_A()}f=f.return}if(Xn=l,Fn=l=rc(l.current,null),mr=Vi=u,$n=0,$g=null,hA=$_=Wu=0,ui=Wg=null,qu!==null){for(u=0;u<qu.length;u++)if(f=qu[u],v=f.interleaved,v!==null){f.interleaved=null;var E=v.next,T=f.pending;if(T!==null){var P=T.next;T.next=E,v.next=P}f.pending=v}qu=null}return l}function p2(l,u){do{var f=Fn;try{if(DI(),L_.current=U_,O_){for(var v=_n.memoizedState;v!==null;){var E=v.queue;E!==null&&(E.pending=null),v=v.next}O_=!1}if($u=0,Yn=zn=_n=null,Bg=!1,Hg=0,dA.current=null,f===null||f.return===null){$n=1,$g=u,Fn=null;break}e:{var T=l,P=f.return,G=f,K=u;if(u=mr,G.flags|=32768,K!==null&&typeof K=="object"&&typeof K.then=="function"){var ie=K,ye=G,ve=ye.tag;if((ye.mode&1)===0&&(ve===0||ve===11||ve===15)){var me=ye.alternate;me?(ye.updateQueue=me.updateQueue,ye.memoizedState=me.memoizedState,ye.lanes=me.lanes):(ye.updateQueue=null,ye.memoizedState=null)}var Oe=UR(P);if(Oe!==null){Oe.flags&=-257,BR(Oe,P,G,T,u),Oe.mode&1&&FR(T,ie,u),u=Oe,K=ie;var Ge=u.updateQueue;if(Ge===null){var qe=new Set;qe.add(K),u.updateQueue=qe}else Ge.add(K);break e}else{if((u&1)===0){FR(T,ie,u),vA();break e}K=Error(t(426))}}else if(cn&&G.mode&1){var kn=UR(P);if(kn!==null){(kn.flags&65536)===0&&(kn.flags|=256),BR(kn,P,G,T,u),PI(wf(K,G));break e}}T=K=wf(K,G),$n!==4&&($n=2),Wg===null?Wg=[T]:Wg.push(T),T=P;do{switch(T.tag){case 3:T.flags|=65536,u&=-u,T.lanes|=u;var ee=OR(T,K,u);cR(T,ee);break e;case 1:G=K;var J=T.type,re=T.stateNode;if((T.flags&128)===0&&(typeof J.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(Zl===null||!Zl.has(re)))){T.flags|=65536,u&=-u,T.lanes|=u;var Ae=VR(T,G,u);cR(T,Ae);break e}}T=T.return}while(T!==null)}y2(f)}catch(ze){u=ze,Fn===f&&f!==null&&(Fn=f=f.return);continue}break}while(!0)}function m2(){var l=z_.current;return z_.current=U_,l===null?U_:l}function vA(){($n===0||$n===3||$n===2)&&($n=4),Xn===null||(Wu&268435455)===0&&($_&268435455)===0||nc(Xn,mr)}function X_(l,u){var f=Ct;Ct|=2;var v=m2();(Xn!==l||mr!==u)&&(Oa=null,Qu(l,u));do try{XH();break}catch(E){p2(l,E)}while(!0);if(DI(),Ct=f,z_.current=v,Fn!==null)throw Error(t(261));return Xn=null,mr=0,$n}function XH(){for(;Fn!==null;)g2(Fn)}function ZH(){for(;Fn!==null&&!Nu();)g2(Fn)}function g2(l){var u=v2(l.alternate,l,Vi);l.memoizedProps=l.pendingProps,u===null?y2(l):Fn=u,dA.current=null}function y2(l){var u=l;do{var f=u.alternate;if(l=u.return,(u.flags&32768)===0){if(f=zH(f,u,Vi),f!==null){Fn=f;return}}else{if(f=$H(f,u),f!==null){f.flags&=32767,Fn=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{$n=6,Fn=null;return}}if(u=u.sibling,u!==null){Fn=u;return}Fn=u=l}while(u!==null);$n===0&&($n=5)}function Ju(l,u,f){var v=Tt,E=os.transition;try{os.transition=null,Tt=1,eG(l,u,f,v)}finally{os.transition=E,Tt=v}return null}function eG(l,u,f,v){do xf();while(ec!==null);if((Ct&6)!==0)throw Error(t(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var T=f.lanes|f.childLanes;if(oI(l,T),l===Xn&&(Fn=Xn=null,mr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||K_||(K_=!0,E2(ku,function(){return xf(),null})),T=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||T){T=os.transition,os.transition=null;var P=Tt;Tt=1;var G=Ct;Ct|=4,dA.current=null,KH(l,f),a2(f,l),vH(vI),ba=!!_I,vI=_I=null,l.current=f,QH(f),xa(),Ct=G,Tt=P,os.transition=T}else l.current=f;if(K_&&(K_=!1,ec=l,Q_=E),T=l.pendingLanes,T===0&&(Zl=null),s_(f.stateNode),di(l,nn()),u!==null)for(v=l.onRecoverableError,f=0;f<u.length;f++)E=u[f],v(E.value,{componentStack:E.stack,digest:E.digest});if(W_)throw W_=!1,l=pA,pA=null,l;return(Q_&1)!==0&&l.tag!==0&&xf(),T=l.pendingLanes,(T&1)!==0?l===mA?Kg++:(Kg=0,mA=l):Kg=0,Ql(),null}function xf(){if(ec!==null){var l=yo(Q_),u=os.transition,f=Tt;try{if(os.transition=null,Tt=16>l?16:l,ec===null)var v=!1;else{if(l=ec,ec=null,Q_=0,(Ct&6)!==0)throw Error(t(331));var E=Ct;for(Ct|=4,Ue=l.current;Ue!==null;){var T=Ue,P=T.child;if((Ue.flags&16)!==0){var G=T.deletions;if(G!==null){for(var K=0;K<G.length;K++){var ie=G[K];for(Ue=ie;Ue!==null;){var ye=Ue;switch(ye.tag){case 0:case 11:case 15:zg(8,ye,T)}var ve=ye.child;if(ve!==null)ve.return=ye,Ue=ve;else for(;Ue!==null;){ye=Ue;var me=ye.sibling,Oe=ye.return;if(n2(ye),ye===ie){Ue=null;break}if(me!==null){me.return=Oe,Ue=me;break}Ue=Oe}}}var Ge=T.alternate;if(Ge!==null){var qe=Ge.child;if(qe!==null){Ge.child=null;do{var kn=qe.sibling;qe.sibling=null,qe=kn}while(qe!==null)}}Ue=T}}if((T.subtreeFlags&2064)!==0&&P!==null)P.return=T,Ue=P;else e:for(;Ue!==null;){if(T=Ue,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:zg(9,T,T.return)}var ee=T.sibling;if(ee!==null){ee.return=T.return,Ue=ee;break e}Ue=T.return}}var J=l.current;for(Ue=J;Ue!==null;){P=Ue;var re=P.child;if((P.subtreeFlags&2064)!==0&&re!==null)re.return=P,Ue=re;else e:for(P=J;Ue!==null;){if(G=Ue,(G.flags&2048)!==0)try{switch(G.tag){case 0:case 11:case 15:q_(9,G)}}catch(ze){In(G,G.return,ze)}if(G===P){Ue=null;break e}var Ae=G.sibling;if(Ae!==null){Ae.return=G.return,Ue=Ae;break e}Ue=G.return}}if(Ct=E,Ql(),Ni&&typeof Ni.onPostCommitFiberRoot=="function")try{Ni.onPostCommitFiberRoot(Pu,l)}catch{}v=!0}return v}finally{Tt=f,os.transition=u}}return!1}function w2(l,u,f){u=wf(f,u),u=OR(l,u,1),l=Yl(l,u,1),u=qr(),l!==null&&(Lu(l,1,u),di(l,u))}function In(l,u,f){if(l.tag===3)w2(l,l,f);else for(;u!==null;){if(u.tag===3){w2(u,l,f);break}else if(u.tag===1){var v=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Zl===null||!Zl.has(v))){l=wf(f,l),l=VR(u,l,1),u=Yl(u,l,1),l=qr(),u!==null&&(Lu(u,1,l),di(u,l));break}}u=u.return}}function tG(l,u,f){var v=l.pingCache;v!==null&&v.delete(u),u=qr(),l.pingedLanes|=l.suspendedLanes&f,Xn===l&&(mr&f)===f&&($n===4||$n===3&&(mr&130023424)===mr&&500>nn()-fA?Qu(l,0):hA|=f),di(l,u)}function _2(l,u){u===0&&((l.mode&1)===0?u=1:(u=Ul,Ul<<=1,(Ul&130023424)===0&&(Ul=4194304)));var f=qr();l=Da(l,u),l!==null&&(Lu(l,u,f),di(l,f))}function nG(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),_2(l,f)}function rG(l,u){var f=0;switch(l.tag){case 13:var v=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:v=l.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(u),_2(l,f)}var v2;v2=function(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps||ai.current)ci=!0;else{if((l.lanes&f)===0&&(u.flags&128)===0)return ci=!1,qH(l,u,f);ci=(l.flags&131072)!==0}else ci=!1,cn&&(u.flags&1048576)!==0&&ZP(u,C_,u.index);switch(u.lanes=0,u.tag){case 2:var v=u.type;G_(l,u),l=u.pendingProps;var E=uf(u,br.current);gf(u,f),E=qI(null,u,v,l,E,f);var T=zI();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,li(v)?(T=!0,I_(u)):T=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,VI(u),E.updater=B_,u.stateNode=E,E._reactInternals=u,YI(u,v,l,f),u=tA(null,u,v,!0,T,f)):(u.tag=0,cn&&T&&CI(u),jr(null,u,E,f),u=u.child),u;case 16:v=u.elementType;e:{switch(G_(l,u),l=u.pendingProps,E=v._init,v=E(v._payload),u.type=v,E=u.tag=sG(v),l=Os(v,l),E){case 0:u=eA(null,u,v,l,f);break e;case 1:u=$R(null,u,v,l,f);break e;case 11:u=HR(null,u,v,l,f);break e;case 14:u=GR(null,u,v,Os(v.type,l),f);break e}throw Error(t(306,v,""))}return u;case 0:return v=u.type,E=u.pendingProps,E=u.elementType===v?E:Os(v,E),eA(l,u,v,E,f);case 1:return v=u.type,E=u.pendingProps,E=u.elementType===v?E:Os(v,E),$R(l,u,v,E,f);case 3:e:{if(WR(u),l===null)throw Error(t(387));v=u.pendingProps,T=u.memoizedState,E=T.element,lR(l,u),D_(u,v,null,f);var P=u.memoizedState;if(v=P.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},u.updateQueue.baseState=T,u.memoizedState=T,u.flags&256){E=wf(Error(t(423)),u),u=KR(l,u,v,f,E);break e}else if(v!==E){E=wf(Error(t(424)),u),u=KR(l,u,v,f,E);break e}else for(Oi=$l(u.stateNode.containerInfo.firstChild),Li=u,cn=!0,Ls=null,f=oR(u,null,v,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(ff(),v===E){u=La(l,u,f);break e}jr(l,u,v,f)}u=u.child}return u;case 5:return dR(u),l===null&&kI(u),v=u.type,E=u.pendingProps,T=l!==null?l.memoizedProps:null,P=E.children,EI(v,E)?P=null:T!==null&&EI(v,T)&&(u.flags|=32),zR(l,u),jr(l,u,P,f),u.child;case 6:return l===null&&kI(u),null;case 13:return QR(l,u,f);case 4:return FI(u,u.stateNode.containerInfo),v=u.pendingProps,l===null?u.child=pf(u,null,v,f):jr(l,u,v,f),u.child;case 11:return v=u.type,E=u.pendingProps,E=u.elementType===v?E:Os(v,E),HR(l,u,v,E,f);case 7:return jr(l,u,u.pendingProps,f),u.child;case 8:return jr(l,u,u.pendingProps.children,f),u.child;case 12:return jr(l,u,u.pendingProps.children,f),u.child;case 10:e:{if(v=u.type._context,E=u.pendingProps,T=u.memoizedProps,P=E.value,Kt(k_,v._currentValue),v._currentValue=P,T!==null)if(Ms(T.value,P)){if(T.children===E.children&&!ai.current){u=La(l,u,f);break e}}else for(T=u.child,T!==null&&(T.return=u);T!==null;){var G=T.dependencies;if(G!==null){P=T.child;for(var K=G.firstContext;K!==null;){if(K.context===v){if(T.tag===1){K=Ma(-1,f&-f),K.tag=2;var ie=T.updateQueue;if(ie!==null){ie=ie.shared;var ye=ie.pending;ye===null?K.next=K:(K.next=ye.next,ye.next=K),ie.pending=K}}T.lanes|=f,K=T.alternate,K!==null&&(K.lanes|=f),LI(T.return,f,u),G.lanes|=f;break}K=K.next}}else if(T.tag===10)P=T.type===u.type?null:T.child;else if(T.tag===18){if(P=T.return,P===null)throw Error(t(341));P.lanes|=f,G=P.alternate,G!==null&&(G.lanes|=f),LI(P,f,u),P=T.sibling}else P=T.child;if(P!==null)P.return=T;else for(P=T;P!==null;){if(P===u){P=null;break}if(T=P.sibling,T!==null){T.return=P.return,P=T;break}P=P.return}T=P}jr(l,u,E.children,f),u=u.child}return u;case 9:return E=u.type,v=u.pendingProps.children,gf(u,f),E=is(E),v=v(E),u.flags|=1,jr(l,u,v,f),u.child;case 14:return v=u.type,E=Os(v,u.pendingProps),E=Os(v.type,E),GR(l,u,v,E,f);case 15:return jR(l,u,u.type,u.pendingProps,f);case 17:return v=u.type,E=u.pendingProps,E=u.elementType===v?E:Os(v,E),G_(l,u),u.tag=1,li(v)?(l=!0,I_(u)):l=!1,gf(u,f),MR(u,v,E),YI(u,v,E,f),tA(null,u,v,!0,l,f);case 19:return YR(l,u,f);case 22:return qR(l,u,f)}throw Error(t(156,u.tag))};function E2(l,u){return dg(l,u)}function iG(l,u,f,v){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(l,u,f,v){return new iG(l,u,f,v)}function EA(l){return l=l.prototype,!(!l||!l.isReactComponent)}function sG(l){if(typeof l=="function")return EA(l)?1:0;if(l!=null){if(l=l.$$typeof,l===j)return 11;if(l===le)return 14}return 2}function rc(l,u){var f=l.alternate;return f===null?(f=as(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Z_(l,u,f,v,E,T){var P=2;if(v=l,typeof l=="function")EA(l)&&(P=1);else if(typeof l=="string")P=5;else e:switch(l){case D:return Yu(f.children,E,T,u);case k:P=8,E|=8;break;case R:return l=as(12,f,u,E|2),l.elementType=R,l.lanes=T,l;case V:return l=as(13,f,u,E),l.elementType=V,l.lanes=T,l;case Ee:return l=as(19,f,u,E),l.elementType=Ee,l.lanes=T,l;case be:return ev(f,E,T,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case U:P=10;break e;case M:P=9;break e;case j:P=11;break e;case le:P=14;break e;case pe:P=16,v=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return u=as(P,f,u,E),u.elementType=l,u.type=v,u.lanes=T,u}function Yu(l,u,f,v){return l=as(7,l,v,u),l.lanes=f,l}function ev(l,u,f,v){return l=as(22,l,v,u),l.elementType=be,l.lanes=f,l.stateNode={isHidden:!1},l}function xA(l,u,f){return l=as(6,l,null,u),l.lanes=f,l}function TA(l,u,f){return u=as(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function oG(l,u,f,v,E){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gg(0),this.expirationTimes=gg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gg(0),this.identifierPrefix=v,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function IA(l,u,f,v,E,T,P,G,K){return l=new oG(l,u,f,G,K),u===1?(u=1,T===!0&&(u|=8)):u=0,T=as(3,null,null,u),l.current=T,T.stateNode=l,T.memoizedState={element:v,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},VI(T),l}function aG(l,u,f){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$,key:v==null?null:""+v,children:l,containerInfo:u,implementation:f}}function x2(l){if(!l)return Kl;l=l._reactInternals;e:{if(Rs(l)!==l||l.tag!==1)throw Error(t(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(li(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(li(f))return JP(l,f,u)}return u}function T2(l,u,f,v,E,T,P,G,K){return l=IA(f,v,!0,l,E,T,P,G,K),l.context=x2(null),f=l.current,v=qr(),E=tc(f),T=Ma(v,E),T.callback=u??null,Yl(f,T,E),l.current.lanes=E,Lu(l,E,v),di(l,v),l}function tv(l,u,f,v){var E=u.current,T=qr(),P=tc(E);return f=x2(f),u.context===null?u.context=f:u.pendingContext=f,u=Ma(T,P),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=Yl(E,u,P),l!==null&&(Us(l,E,P,T),R_(l,E,P)),P}function nv(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function I2(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function AA(l,u){I2(l,u),(l=l.alternate)&&I2(l,u)}function lG(){return null}var A2=typeof reportError=="function"?reportError:function(l){console.error(l)};function bA(l){this._internalRoot=l}rv.prototype.render=bA.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(t(409));tv(l,u,null,null)},rv.prototype.unmount=bA.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;Ku(function(){tv(null,l,null,null)}),u[Na]=null}};function rv(l){this._internalRoot=l}rv.prototype.unstable_scheduleHydration=function(l){if(l){var u=vg();l={blockedOn:null,target:l,priority:u};for(var f=0;f<Pi.length&&u!==0&&u<Pi[f].priority;f++);Pi.splice(f,0,l),f===0&&Wh(l)}};function CA(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function iv(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function b2(){}function cG(l,u,f,v,E){if(E){if(typeof v=="function"){var T=v;v=function(){var ie=nv(P);T.call(ie)}}var P=T2(u,v,l,0,null,!1,!1,"",b2);return l._reactRootContainer=P,l[Na]=P.current,Rg(l.nodeType===8?l.parentNode:l),Ku(),P}for(;E=l.lastChild;)l.removeChild(E);if(typeof v=="function"){var G=v;v=function(){var ie=nv(K);G.call(ie)}}var K=IA(l,0,!1,null,null,!1,!1,"",b2);return l._reactRootContainer=K,l[Na]=K.current,Rg(l.nodeType===8?l.parentNode:l),Ku(function(){tv(u,K,f,v)}),K}function sv(l,u,f,v,E){var T=f._reactRootContainer;if(T){var P=T;if(typeof E=="function"){var G=E;E=function(){var K=nv(P);G.call(K)}}tv(u,P,l,E)}else P=cG(f,u,l,E,v);return nv(P)}wg=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var f=Dt(u.pendingLanes);f!==0&&(yg(u,f|1),di(u,nn()),(Ct&6)===0&&(Ef=nn()+500,Ql()))}break;case 13:Ku(function(){var v=Da(l,1);if(v!==null){var E=qr();Us(v,l,1,E)}}),AA(l,1)}},zh=function(l){if(l.tag===13){var u=Da(l,134217728);if(u!==null){var f=qr();Us(u,l,134217728,f)}AA(l,134217728)}},_g=function(l){if(l.tag===13){var u=tc(l),f=Da(l,u);if(f!==null){var v=qr();Us(f,l,u,v)}AA(l,u)}},vg=function(){return Tt},Eg=function(l,u){var f=Tt;try{return Tt=l,u()}finally{Tt=f}},Ns=function(l,u,f){switch(u){case"input":if(Gr(l,f),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<f.length;u++){var v=f[u];if(v!==l&&v.form===l.form){var E=x_(v);if(!E)throw Error(t(90));st(v),Gr(v,E)}}}break;case"textarea":Au(l,f);break;case"select":u=f.value,u!=null&&si(l,!!f.multiple,u,!1)}},Ol=wA,Si=Ku;var uG={usingClientEntryPoint:!1,Events:[Lg,lf,x_,xt,Jn,wA]},Qg={findFiberByHostInstance:Bu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dG={bundleType:Qg.bundleType,version:Qg.version,rendererPackageName:Qg.rendererPackageName,rendererConfig:Qg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=i_(l),l===null?null:l.stateNode},findFiberByHostInstance:Qg.findFiberByHostInstance||lG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ov=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ov.isDisabled&&ov.supportsFiber)try{Pu=ov.inject(dG),Ni=ov}catch{}}return hi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uG,hi.createPortal=function(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!CA(u))throw Error(t(200));return aG(l,u,null,f)},hi.createRoot=function(l,u){if(!CA(l))throw Error(t(299));var f=!1,v="",E=A2;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),u=IA(l,1,!1,null,null,f,!1,v,E),l[Na]=u.current,Rg(l.nodeType===8?l.parentNode:l),new bA(u)},hi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=i_(u),l=l===null?null:l.stateNode,l},hi.flushSync=function(l){return Ku(l)},hi.hydrate=function(l,u,f){if(!iv(u))throw Error(t(200));return sv(null,l,u,!0,f)},hi.hydrateRoot=function(l,u,f){if(!CA(l))throw Error(t(405));var v=f!=null&&f.hydratedSources||null,E=!1,T="",P=A2;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(T=f.identifierPrefix),f.onRecoverableError!==void 0&&(P=f.onRecoverableError)),u=T2(u,null,l,1,f??null,E,!1,T,P),l[Na]=u.current,Rg(l),v)for(l=0;l<v.length;l++)f=v[l],E=f._getVersion,E=E(f._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[f,E]:u.mutableSourceEagerHydrationData.push(f,E);return new rv(u)},hi.render=function(l,u,f){if(!iv(u))throw Error(t(200));return sv(null,l,u,!1,f)},hi.unmountComponentAtNode=function(l){if(!iv(l))throw Error(t(40));return l._reactRootContainer?(Ku(function(){sv(null,null,l,!1,function(){l._reactRootContainer=null,l[Na]=null})}),!0):!1},hi.unstable_batchedUpdates=wA,hi.unstable_renderSubtreeIntoContainer=function(l,u,f,v){if(!iv(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return sv(l,u,f,!1,v)},hi.version="18.3.1-next-f1338f8080-20240426",hi}var L2;function xG(){if(L2)return PA.exports;L2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),PA.exports=EG(),PA.exports}var O2;function TG(){if(O2)return av;O2=1;var n=xG();return av.createRoot=n.createRoot,av.hydrateRoot=n.hydrateRoot,av}var IG=TG();const Q5=K5(IG);var tr=(n=>(n.Jobs="JOBS",n.Insurance="INSURANCE",n.Messaging="MESSAGING",n.Chatbot="CHATBOT",n.Profile="PROFILE",n.Recommendations="RECOMMENDATIONS",n))(tr||{}),wd=(n=>(n.User="USER",n.Bot="BOT",n))(wd||{}),Jt=(n=>(n.Worker="WORKER",n.Employer="EMPLOYER",n))(Jt||{}),Jo=(n=>(n.NEW_APPLICATION="NEW_APPLICATION",n.NEW_JOB_MATCH="NEW_JOB_MATCH",n.APPLICATION_ACCEPTED="APPLICATION_ACCEPTED",n.APPLICATION_REJECTED="APPLICATION_REJECTED",n))(Jo||{});const Ts=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),ia=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Sx=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),AG=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Fb=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ub=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),bG=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),gc=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.75 18l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 14.25l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 18l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),so=({className:n="w-8 h-8"})=>p.jsx("div",{className:`flex items-center justify-center rounded-full bg-blue-500 text-white ${n}`,children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),$S=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),J5=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),CG=({type:n})=>{const e="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0";switch(n){case Jo.NEW_APPLICATION:return p.jsx("div",{className:`${e} bg-blue-100 text-blue-600`,children:p.jsx(so,{className:"w-5 h-5 bg-transparent"})});case Jo.NEW_JOB_MATCH:return p.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:p.jsx(Ts,{className:"w-5 h-5"})});case Jo.APPLICATION_ACCEPTED:return p.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:p.jsx($S,{className:"w-6 h-6"})});case Jo.APPLICATION_REJECTED:return p.jsx("div",{className:`${e} bg-red-100 text-red-600`,children:p.jsx(J5,{className:"w-6 h-6"})});default:return p.jsx("div",{className:`${e} bg-gray-100 text-gray-600`,children:p.jsx(Ts,{className:"w-5 h-5"})})}},SG=({notifications:n,onNotificationClick:e,onMarkAllAsRead:t,onClose:r})=>{const i=n.filter(s=>!s.isRead).length;return p.jsx("div",{className:"fixed inset-0 z-40",onClick:r,children:p.jsxs("div",{className:"absolute top-20 right-4 sm:right-6 lg:right-8 w-full max-w-sm bg-white rounded-lg shadow-2xl border border-gray-200 overflow-hidden animate-fade-in-down z-50",style:{animationDuration:"0.2s"},onClick:s=>s.stopPropagation(),children:[p.jsxs("div",{className:"p-4 flex items-center justify-between border-b",children:[p.jsx("h3",{className:"font-bold text-gray-800",children:"Thng bo"}),i>0&&p.jsx("button",{onClick:t,className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"nh du tt c l  c"})]}),p.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.length>0?n.map(s=>p.jsxs("div",{onClick:()=>e(s),className:`flex items-start gap-4 p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b ${s.isRead?"bg-white":"bg-indigo-50"}`,children:[p.jsx(CG,{type:s.type}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-700",children:s.message}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.createdAt).toLocaleString("vi-VN")})]}),!s.isRead&&p.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full mt-1 flex-shrink-0"})]},s.id)):p.jsx("div",{className:"p-10 text-center text-gray-500",children:p.jsx("p",{children:"Bn khng c thng bo no."})})})]})})},NG=()=>{};var V2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie=function(n,e){if(!n)throw Um(e)},Um=function(n){return new Error("Firebase Database ("+Y5.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},kG=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},WS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,h=s>>2,m=(s&3)<<4|a>>4;let _=(a&15)<<2|d>>6,x=d&63;c||(x=64,o||(_=64)),r.push(t[h],t[m],t[_],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(X5(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kG(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||d==null||m==null)throw new PG;const _=s<<2|a>>4;if(r.push(_),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const b=d<<6&192|m;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PG extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Z5=function(n){const e=X5(n);return WS.encodeByteArray(e,!0)},aE=function(n){return Z5(n).replace(/\./g,"")},s0=function(n){try{return WS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RG(n){return o0(void 0,n)}function o0(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!DG(t)||(n[t]=o0(n[t],e[t]));return n}function DG(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MG=()=>KS().__FIREBASE_DEFAULTS__,LG=()=>{if(typeof process>"u"||typeof V2>"u")return;const n=V2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OG=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&s0(n[1]);return e&&JSON.parse(e)},QS=()=>{try{return NG()||MG()||LG()||OG()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},JS=()=>{var n;return(n=QS())==null?void 0:n.config},VG=n=>{var e;return(e=QS())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function YS(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[aE(JSON.stringify(t)),aE(JSON.stringify(o)),""].join(".")}const Dy={};function FG(){const n={prod:[],emulator:[]};for(const e of Object.keys(Dy))Dy[e]?n.emulator.push(e):n.prod.push(e);return n}function UG(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let F2=!1;function XS(n,e){if(typeof window>"u"||typeof document>"u"||!mu(window.location.host)||Dy[n]===e||Dy[n]||F2)return;Dy[n]=e;function t(_){return`__firebase__banner__${_}`}const r="__firebase__banner",s=FG().prod.length>0;function o(){const _=document.getElementById(r);_&&_.remove()}function a(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function c(_,x){_.setAttribute("width","24"),_.setAttribute("id",x),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{F2=!0,o()},_}function h(_,x){_.setAttribute("id",x),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=UG(r),x=t("text"),b=document.getElementById(x)||document.createElement("span"),A=t("learnmore"),N=document.getElementById(A)||document.createElement("a"),F=t("preprendIcon"),B=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const O=_.element;a(O),h(N,A);const q=d();c(B,F),O.append(B,b,N,q),document.body.appendChild(O)}s?(b.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xn())}function Nx(){var e;const n=(e=QS())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BG(){return typeof window<"u"||tF()}function tF(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function HG(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nF(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kx(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rF(){const n=xn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function GG(){return Y5.NODE_ADMIN===!0}function iF(){return!Nx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sF(){return!Nx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function eh(){try{return typeof indexedDB=="object"}catch{return!1}}function jG(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}function qG(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zG="FirebaseError";class Vr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=zG,Object.setPrototypeOf(this,Vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ya.prototype.create)}}class ya{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?$G(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Vr(i,a,r)}}function $G(n,e){return n.replace(WG,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const WG=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(n){return JSON.parse(n)}function Wn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=a0(s0(s[0])||""),t=a0(s0(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},KG=function(n){const e=oF(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},QG=function(n){const e=oF(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function th(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function lE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function cE(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function dl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(U2(s)&&U2(o)){if(!dl(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function U2(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gf(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function _y(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let m=0;m<16;m++)r[m]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let m=16;m<80;m++){const _=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(_<<1|_>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],d,h;for(let m=0;m<80;m++){m<40?m<20?(d=a^s&(o^a),h=1518500249):(d=s^o^a,h=1859775393):m<60?(d=s&o|a&(s|o),h=2400959708):(d=s^o^a,h=3395469782);const _=(i<<5|i>>>27)+d+c+h+r[m]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=_}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function aF(n,e){const t=new YG(n,e);return t.subscribe.bind(t)}class YG{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");XG(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=MA),i.error===void 0&&(i.error=MA),i.complete===void 0&&(i.complete=MA);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XG(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function MA(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ze=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){const s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function xi(n,e){return`${n} failed: ${e} argument `}function sr(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(xi(n,e)+"must be a valid function.")}function B2(n,e,t,r){if(t&&(typeof t!="object"||t===null))throw new Error(xi(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZG=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,Ie(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Px=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(n){return n&&n._delegate?n._delegate:n}class qn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new wi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tj(e))try{this.getOrInitializeService({instanceIdentifier:nd})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=nd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=nd){return this.instances.has(e)}getOptions(e=nd){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ej(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=nd){return this.component?this.component.multipleInstances?e:nd:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ej(n){return n===nd?void 0:n}function tj(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Bb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=[];var wt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wt||(wt={}));const lF={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},nj=wt.INFO,rj={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},ij=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=rj[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bm{constructor(e){this.name=e,this._logLevel=nj,this._logHandler=ij,this._userLogHandler=null,tN.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}function sj(n){tN.forEach(e=>{e.setLogLevel(n)})}function oj(n,e){for(const t of tN){let r=null;e&&e.level&&(r=lF[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:wt[s].toLowerCase(),message:a,args:o,type:i.name})}}}const aj=(n,e)=>e.some(t=>n instanceof t);let H2,G2;function lj(){return H2||(H2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cj(){return G2||(G2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cF=new WeakMap,Hb=new WeakMap,uF=new WeakMap,LA=new WeakMap,nN=new WeakMap;function uj(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(sl(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&cF.set(t,n)}).catch(()=>{}),nN.set(e,n),e}function dj(n){if(Hb.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Hb.set(n,e)}let Gb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Hb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||uF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return sl(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hj(n){Gb=n(Gb)}function fj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(OA(this),e,...t);return uF.set(r,e.sort?e.sort():[e]),sl(r)}:cj().includes(n)?function(...e){return n.apply(OA(this),e),sl(cF.get(this))}:function(...e){return sl(n.apply(OA(this),e))}}function pj(n){return typeof n=="function"?fj(n):(n instanceof IDBTransaction&&dj(n),aj(n,lj())?new Proxy(n,Gb):n)}function sl(n){if(n instanceof IDBRequest)return uj(n);if(LA.has(n))return LA.get(n);const e=pj(n);return e!==n&&(LA.set(n,e),nN.set(e,n)),e}const OA=n=>nN.get(n);function Hm(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=sl(o);return r&&o.addEventListener("upgradeneeded",c=>{r(sl(o.result),c.oldVersion,c.newVersion,sl(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}function Jf(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),sl(t).then(()=>{})}const mj=["get","getKey","getAll","getAllKeys","count"],gj=["put","add","delete","clear"],VA=new Map;function j2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(VA.get(e))return VA.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=gj.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||mj.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[t](...a),i&&c.done]))[0]};return VA.set(e,s),s}hj(n=>({...n,get:(e,t,r)=>j2(e,t)||n.get(e,t,r),has:(e,t)=>!!j2(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wj(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function wj(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uE="@firebase/app",jb="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=new Bm("@firebase/app"),_j="@firebase/app-compat",vj="@firebase/analytics-compat",Ej="@firebase/analytics",xj="@firebase/app-check-compat",Tj="@firebase/app-check",Ij="@firebase/auth",Aj="@firebase/auth-compat",bj="@firebase/database",Cj="@firebase/data-connect",Sj="@firebase/database-compat",Nj="@firebase/functions",kj="@firebase/functions-compat",Pj="@firebase/installations",Rj="@firebase/installations-compat",Dj="@firebase/messaging",Mj="@firebase/messaging-compat",Lj="@firebase/performance",Oj="@firebase/performance-compat",Vj="@firebase/remote-config",Fj="@firebase/remote-config-compat",Uj="@firebase/storage",Bj="@firebase/storage-compat",Hj="@firebase/firestore",Gj="@firebase/ai",jj="@firebase/firestore-compat",qj="firebase",zj="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="[DEFAULT]",$j={[uE]:"fire-core",[_j]:"fire-core-compat",[Ej]:"fire-analytics",[vj]:"fire-analytics-compat",[Tj]:"fire-app-check",[xj]:"fire-app-check-compat",[Ij]:"fire-auth",[Aj]:"fire-auth-compat",[bj]:"fire-rtdb",[Cj]:"fire-data-connect",[Sj]:"fire-rtdb-compat",[Nj]:"fire-fn",[kj]:"fire-fn-compat",[Pj]:"fire-iid",[Rj]:"fire-iid-compat",[Dj]:"fire-fcm",[Mj]:"fire-fcm-compat",[Lj]:"fire-perf",[Oj]:"fire-perf-compat",[Vj]:"fire-rc",[Fj]:"fire-rc-compat",[Uj]:"fire-gcs",[Bj]:"fire-gcs-compat",[Hj]:"fire-fst",[jj]:"fire-fst-compat",[Gj]:"fire-vertex","fire-js":"fire-js",[qj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,em=new Map,tm=new Map;function l0(n,e){try{n.container.addComponent(e)}catch(t){hl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function dF(n,e){n.container.addOrOverwriteComponent(e)}function Ii(n){const e=n.name;if(tm.has(e))return hl.debug(`There were multiple attempts to register component ${e}.`),!1;tm.set(e,n);for(const t of Xc.values())l0(t,n);for(const t of em.values())l0(t,n);return!0}function Rx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wj(n,e,t=Yc){Rx(n,e).clearInstance(t)}function rN(n){return n.options!==void 0}function hF(n){return rN(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function ln(n){return n==null?!1:n.settings!==void 0}function Kj(){tm.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ji=new ya("app","Firebase",Qj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fF=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ji.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(n,e){const t=s0(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,s=new Date().getTime();i-s<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class Jj extends fF{constructor(e,t,r,i){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const a=e;super(a.options,o,i)}this._serverConfig={automaticDataCollectionEnabled:s,...t},this._serverConfig.authIdToken&&q2(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&q2(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Er(uE,jb,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){sN(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Ji.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=zj;function iN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Yc,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Ji.create("bad-app-name",{appName:String(i)});if(t||(t=JS()),!t)throw Ji.create("no-options");const s=Xc.get(i);if(s){if(dl(t,s.options)&&dl(r,s.config))return s;throw Ji.create("duplicate-app",{appName:i})}const o=new eN(i);for(const c of tm.values())o.addComponent(c);const a=new fF(t,r,o);return Xc.set(i,a),a}function Yj(n,e={}){if(BG()&&!tF())throw Ji.create("invalid-server-app-environment");let t,r=e||{};if(n&&(rN(n)?t=n.options:hF(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=JS()),!t)throw Ji.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const s=h=>[...h].reduce((m,_)=>Math.imul(31,m)+_.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Ji.create("finalization-registry-not-supported",{});const o=""+s(JSON.stringify(i)),a=em.get(o);if(a)return a.incRefCount(r.releaseOnDeref),a;const c=new eN(o);for(const h of tm.values())c.addComponent(h);const d=new Jj(t,r,o,c);return em.set(o,d),d}function Xj(n=Yc){const e=Xc.get(n);if(!e&&n===Yc&&JS())return iN();if(!e)throw Ji.create("no-app",{appName:n});return e}function Zj(){return Array.from(Xc.values())}async function sN(n){let e=!1;const t=n.name;Xc.has(t)?(e=!0,Xc.delete(t)):em.has(t)&&n.decRefCount()<=0&&(em.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Er(n,e,t){let r=$j[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hl.warn(o.join(" "));return}Ii(new qn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function pF(n,e){if(n!==null&&typeof n!="function")throw Ji.create("invalid-log-argument");oj(n,e)}function mF(n){sj(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eq="firebase-heartbeat-database",tq=1,c0="firebase-heartbeat-store";let FA=null;function gF(){return FA||(FA=Hm(eq,tq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(c0)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ji.create("idb-open",{originalErrorMessage:n.message})})),FA}async function nq(n){try{const t=(await gF()).transaction(c0),r=await t.objectStore(c0).get(yF(n));return await t.done,r}catch(e){if(e instanceof Vr)hl.warn(e.message);else{const t=Ji.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hl.warn(t.message)}}}async function z2(n,e){try{const r=(await gF()).transaction(c0,"readwrite");await r.objectStore(c0).put(e,yF(n)),await r.done}catch(t){if(t instanceof Vr)hl.warn(t.message);else{const r=Ji.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});hl.warn(r.message)}}}function yF(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rq=1024,iq=30;class sq{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new aq(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$2();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>iq){const o=lq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){hl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$2(),{heartbeatsToSend:r,unsentEntries:i}=oq(this._heartbeatsCache.heartbeats),s=aE(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return hl.warn(t),""}}}function $2(){return new Date().toISOString().substring(0,10)}function oq(n,e=rq){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),W2(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),W2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class aq{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eh()?jG().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nq(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return z2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return z2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function W2(n){return aE(JSON.stringify({version:2,heartbeats:n})).length}function lq(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cq(n){Ii(new qn("platform-logger",e=>new yj(e),"PRIVATE")),Ii(new qn("heartbeat",e=>new sq(e),"PRIVATE")),Er(uE,jb,n),Er(uE,jb,"esm2020"),Er("fire-js","")}cq("");const uq=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Vr,SDK_VERSION:vl,_DEFAULT_ENTRY_NAME:Yc,_addComponent:l0,_addOrOverwriteComponent:dF,_apps:Xc,_clearComponents:Kj,_components:tm,_getProvider:Rx,_isFirebaseApp:rN,_isFirebaseServerApp:ln,_isFirebaseServerAppSettings:hF,_registerComponent:Ii,_removeServiceInstance:Wj,_serverApps:em,deleteApp:sN,getApp:Xj,getApps:Zj,initializeApp:iN,initializeServerApp:Yj,onLog:pF,registerVersion:Er,setLogLevel:mF},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dq{constructor(e,t){this._delegate=e,this.firebase=t,l0(e,new qn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),sN(this._delegate)))}_getService(e,t=Yc){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Yc){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){l0(this._delegate,e)}_addOrOverwriteComponent(e){dF(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hq={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},K2=new ya("app-compat","Firebase",hq);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fq(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Er,setLogLevel:mF,onLog:pF,apps:null,SDK_VERSION:vl,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:uq}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(d){delete e[d]}function i(d){if(d=d||Yc,!Yi(e,d))throw K2.create("no-app",{appName:d});return e[d]}i.App=n;function s(d,h={}){const m=iN(d,h);if(Yi(e,m.name))return e[m.name];const _=new n(m,t);return e[m.name]=_,_}function o(){return Object.keys(e).map(d=>e[d])}function a(d){const h=d.name,m=h.replace("-compat","");if(Ii(d)&&d.type==="PUBLIC"){const _=(x=i())=>{if(typeof x[m]!="function")throw K2.create("invalid-app-argument",{appName:h});return x[m]()};d.serviceProps!==void 0&&o0(_,d.serviceProps),t[m]=_,n.prototype[m]=function(...x){return this._getService.bind(this,h).apply(this,d.multipleInstances?x:[])}}return d.type==="PUBLIC"?t[m]:null}function c(d,h){return h==="serverAuth"?null:h}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(){const n=fq(dq);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:wF,extendNamespace:e,createSubscribe:aF,ErrorFactory:ya,deepExtend:o0};function e(t){o0(n,t)}return n}const pq=wF();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=new Bm("@firebase/app-compat"),mq="@firebase/app-compat",gq="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yq(n){Er(mq,gq,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=KS();if(n.firebase!==void 0){Q2.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Q2.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Mn=pq;yq();var wq="firebase",_q="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn.registerVersion(wq,_q,"app-compat");const Xg={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Tf={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vq(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function _F(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Eq=vq,xq=_F,vF=new ya("auth","Firebase",_F());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=new Bm("@firebase/auth");function Tq(n,...e){dE.logLevel<=wt.WARN&&dE.warn(`Auth (${vl}): ${n}`,...e)}function kv(n,...e){dE.logLevel<=wt.ERROR&&dE.error(`Auth (${vl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(n,...e){throw aN(n,...e)}function Kn(n,...e){return aN(n,...e)}function oN(n,e,t){const r={...xq(),[e]:t};return new ya("auth","Firebase",r).create(e,{appName:n.name})}function ur(n){return oN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gm(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ir(n,"argument-error"),oN(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function aN(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return vF.create(n,...e)}function _e(n,e,...t){if(!n)throw aN(e,...t)}function Yo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw kv(e),new Error(e)}function ro(n,e){n||Yo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function lN(){return J2()==="http:"||J2()==="https:"}function J2(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lN()||nF()||"connection"in navigator)?navigator.onLine:!0}function Aq(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,t){this.shortDelay=e,this.longDelay=t,ro(t>e,"Short delay should be less than long delay!"),this.isMobile=ZS()||kx()}get(){return Iq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(n,e){ro(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cq=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Sq=new hw(3e4,6e4);function Cn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Sn(n,e,t,r,i={}){return xF(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Sh({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:c,...s};return HG()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&mu(n.emulatorConfig.host)&&(d.credentials="include"),EF.fetch()(await TF(n,n.config.apiHost,t,a),d)})}async function xF(n,e,t){n._canInitEmulator=!1;const r={...bq,...e};try{const i=new kq(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw vy(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw vy(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw vy(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw vy(n,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw oN(n,h,d);Ir(n,h)}}catch(i){if(i instanceof Vr)throw i;Ir(n,"network-request-failed",{message:String(i)})}}async function El(n,e,t,r,i={}){const s=await Sn(n,e,t,r,i);return"mfaPendingCredential"in s&&Ir(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function TF(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?cN(n.config,i):`${n.config.apiScheme}://${i}`;return Cq.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function Nq(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kq{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Kn(this.auth,"network-request-failed")),Sq.get())})}}function vy(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Kn(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(n){return n!==void 0&&n.getResponse!==void 0}function X2(n){return n!==void 0&&n.enterprise!==void 0}class IF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Nq(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pq(n){return(await Sn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function AF(n,e){return Sn(n,"GET","/v2/recaptchaConfig",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rq(n,e){return Sn(n,"POST","/v1/accounts:delete",e)}async function Dq(n,e){return Sn(n,"POST","/v1/accounts:update",e)}async function hE(n,e){return Sn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Mq(n,e=!1){const t=Fe(n),r=await t.getIdToken(e),i=Dx(r);_e(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:My(UA(i.auth_time)),issuedAtTime:My(UA(i.iat)),expirationTime:My(UA(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function UA(n){return Number(n)*1e3}function Dx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return kv("JWT malformed, contained fewer than 3 sections"),null;try{const i=s0(t);return i?JSON.parse(i):(kv("Failed to decode base64 JWT payload"),null)}catch(i){return kv("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Z2(n){const e=Dx(n);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Vr&&Lq(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Lq({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=My(this.lastLoginAt),this.creationTime=My(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(n){var m;const e=n.auth,t=await n.getIdToken(),r=await fl(n,hE(e,{idToken:t}));_e(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?bF(i.providerUserInfo):[],o=Fq(n.providerData,s),a=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new qb(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function Vq(n){const e=Fe(n);await d0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Fq(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function bF(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uq(n,e){const t=await xF(n,{},async()=>{const r=Sh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await TF(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return n.emulatorConfig&&mu(n.emulatorConfig.host)&&(c.credentials="include"),EF.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Bq(n,e){return Sn(n,"POST","/v2/accounts:revokeToken",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Z2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const t=Z2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await Uq(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Yf;return r&&(_e(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(_e(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(_e(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yf,this.toJSON())}_performRefresh(){return Yo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(n,e){_e(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Xs{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Oq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new qb(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await fl(this,this.stsTokenManager.getToken(this.auth,e));return _e(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Mq(this,e)}reload(){return Vq(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await d0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ln(this.auth.app))return Promise.reject(ur(this.auth));const e=await this.getIdToken();return await fl(this,Rq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:x,providerData:b,stsTokenManager:A}=t;_e(m&&A,e,"internal-error");const N=Yf.fromJSON(this.name,A);_e(typeof m=="string",e,"internal-error"),sc(r,e.name),sc(i,e.name),_e(typeof _=="boolean",e,"internal-error"),_e(typeof x=="boolean",e,"internal-error"),sc(s,e.name),sc(o,e.name),sc(a,e.name),sc(c,e.name),sc(d,e.name),sc(h,e.name);const F=new Xs({uid:m,auth:e,email:i,emailVerified:_,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:N,createdAt:d,lastLoginAt:h});return b&&Array.isArray(b)&&(F.providerData=b.map(B=>({...B}))),c&&(F._redirectEventId=c),F}static async _fromIdTokenResponse(e,t,r=!1){const i=new Yf;i.updateFromServerResponse(t);const s=new Xs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await d0(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];_e(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?bF(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Yf;a.updateFromIdToken(r);const c=new Xs({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new qb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new Map;function Qi(n){ro(n instanceof Function,"Expected a class definition");let e=eD.get(n);return e?(ro(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,eD.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}CF.type="NONE";const nm=CF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(n,e,t){return`firebase:${n}:${e}:${t}`}class Xf{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Kd(this.userKey,i.apiKey,s),this.fullPersistenceKey=Kd("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await hE(this.auth,{idToken:e}).catch(()=>{});return t?Xs._fromGetAccountInfoResponse(this.auth,t,e):null}return Xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Xf(Qi(nm),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Qi(nm);const o=Kd(r,e.config.apiKey,e.name);let a=null;for(const d of t)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const _=await hE(e,{idToken:h}).catch(()=>{});if(!_)break;m=await Xs._fromGetAccountInfoResponse(e,_,h)}else m=Xs._fromJSON(e,h);d!==s&&(a=m),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Xf(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Xf(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(SF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RF(e))return"Blackberry";if(DF(e))return"Webos";if(NF(e))return"Safari";if((e.includes("chrome/")||kF(e))&&!e.includes("edge/"))return"Chrome";if(fw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function SF(n=xn()){return/firefox\//i.test(n)}function NF(n=xn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kF(n=xn()){return/crios\//i.test(n)}function PF(n=xn()){return/iemobile/i.test(n)}function fw(n=xn()){return/android/i.test(n)}function RF(n=xn()){return/blackberry/i.test(n)}function DF(n=xn()){return/webos/i.test(n)}function pw(n=xn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Hq(n=xn()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function Gq(n=xn()){var e;return pw(n)&&!!((e=window.navigator)!=null&&e.standalone)}function jq(){return rF()&&document.documentMode===10}function MF(n=xn()){return pw(n)||fw(n)||DF(n)||RF(n)||/windows phone/i.test(n)||PF(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LF(n,e=[]){let t;switch(n){case"Browser":t=tD(xn());break;case"Worker":t=`${tD(xn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zq(n,e={}){return Sn(n,"GET","/v2/passwordPolicy",Cn(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $q=6;class Wq{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??$q,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kq{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nD(this),this.idTokenSubscription=new nD(this),this.beforeStateQueue=new qq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Qi(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Xf.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await hE(this,{idToken:e}),r=await Xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(ln(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await d0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Aq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ln(this.app))return Promise.reject(ur(this));const t=e?Fe(e):null;return t&&_e(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ln(this.app)?Promise.reject(ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ln(this.app)?Promise.reject(ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zq(this),t=new Wq(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ya("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Bq(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Qi(e)||this._popupRedirectResolver;_e(t,this,"argument-error"),this.redirectPersistenceManager=await Xf.create(this,[Qi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(ln(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Tq(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Tn(n){return Fe(n)}class nD{constructor(e){this.auth=e,this.observer=null,this.addObserver=aF(t=>this.observer=t)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qq(n){mw=n}function uN(n){return mw.loadJS(n)}function Jq(){return mw.recaptchaV2Script}function Yq(){return mw.recaptchaEnterpriseScript}function Xq(){return mw.gapiScript}function OF(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zq=500,ez=6e4,lv=1e12;class tz{constructor(e){this.auth=e,this.counter=lv,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new iz(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||lv;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||lv;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||lv;return(r=this._widgets.get(t))==null||r.execute(),""}}class nz{constructor(){this.enterprise=new rz}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rz{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class iz{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;_e(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=sz(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},ez)},Zq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function sz(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const oz="recaptcha-enterprise",Ly="NO_RECAPTCHA";class VF{constructor(e){this.type=oz,this.auth=Tn(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{AF(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new IF(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function i(s,o,a){const c=window.grecaptcha;X2(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(Ly)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nz().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&X2(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Yq();c.length!==0&&(c+=a),uN(c).then(()=>{i(a,s,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function Zg(n,e,t,r=!1,i=!1){const s=new VF(n);let o;if(i)o=Ly;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function jc(n,e,t,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Zg(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Zg(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(a)});else if(i==="PHONE_PROVIDER")if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Zg(n,e,t);return r(n,a).catch(async c=>{var d;if(((d=n._getRecaptchaConfig())==null?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const h=await Zg(n,e,t,!1,!0);return r(n,h)}return Promise.reject(c)})}else{const a=await Zg(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(i+" provider is not supported.")}async function az(n){const e=Tn(n),t=await AF(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new IF(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new VF(e).verify()}function lz(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Qi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function cz(n,e,t){const r=Tn(n);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=FF(e),{host:o,port:a}=uz(e),c=a===null?"":`:${a}`,d={url:`${s}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e(dl(d,r.config.emulator)&&dl(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,mu(o)?(YS(`${s}//${o}${c}`),XS("Auth",!0)):i||dz()}function FF(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function uz(n){const e=FF(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:rD(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:rD(o)}}}function rD(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function dz(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Yo("not implemented")}_getIdTokenResponse(e){return Yo("not implemented")}_linkToIdToken(e,t){return Yo("not implemented")}_getReauthenticationResolver(e){return Yo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UF(n,e){return Sn(n,"POST","/v1/accounts:resetPassword",Cn(n,e))}async function hz(n,e){return Sn(n,"POST","/v1/accounts:update",e)}async function fz(n,e){return Sn(n,"POST","/v1/accounts:signUp",e)}async function pz(n,e){return Sn(n,"POST","/v1/accounts:update",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mz(n,e){return El(n,"POST","/v1/accounts:signInWithPassword",Cn(n,e))}async function Mx(n,e){return Sn(n,"POST","/v1/accounts:sendOobCode",Cn(n,e))}async function gz(n,e){return Mx(n,e)}async function yz(n,e){return Mx(n,e)}async function wz(n,e){return Mx(n,e)}async function _z(n,e){return Mx(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vz(n,e){return El(n,"POST","/v1/accounts:signInWithEmailLink",Cn(n,e))}async function Ez(n,e){return El(n,"POST","/v1/accounts:signInWithEmailLink",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends jm{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new h0(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new h0(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jc(e,t,"signInWithPassword",mz,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return vz(e,{email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jc(e,r,"signUpPassword",fz,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Ez(e,{idToken:t,email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(n,e){return El(n,"POST","/v1/accounts:signInWithIdp",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz="http://localhost";class da extends jm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new da(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ir("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const o=new da(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ol(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ol(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ol(e,t)}buildRequest(){const e={requestUri:xz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Sh(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iD(n,e){return Sn(n,"POST","/v1/accounts:sendVerificationCode",Cn(n,e))}async function Tz(n,e){return El(n,"POST","/v1/accounts:signInWithPhoneNumber",Cn(n,e))}async function Iz(n,e){const t=await El(n,"POST","/v1/accounts:signInWithPhoneNumber",Cn(n,e));if(t.temporaryProof)throw vy(n,"account-exists-with-different-credential",t);return t}const Az={USER_NOT_FOUND:"user-not-found"};async function bz(n,e){const t={...e,operation:"REAUTH"};return El(n,"POST","/v1/accounts:signInWithPhoneNumber",Cn(n,t),Az)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends jm{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Qd({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Qd({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return Tz(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Iz(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return bz(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Qd({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cz(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Sz(n){const e=Gf(_y(n)).link,t=e?Gf(_y(e)).deep_link_id:null,r=Gf(_y(n)).deep_link_id;return(r?Gf(_y(r)).link:null)||r||t||e||n}class Lx{constructor(e){const t=Gf(_y(e)),r=t.apiKey??null,i=t.oobCode??null,s=Cz(t.mode??null);_e(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Sz(e);try{return new Lx(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.providerId=gu.PROVIDER_ID}static credential(e,t){return h0._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Lx.parseLink(t);return _e(r,"argument-error"),h0._fromEmailAndCode(e,r.code,r.tenantId)}}gu.PROVIDER_ID="password";gu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm extends xl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zf extends qm{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return _e("providerId"in t&&"signInMethod"in t,"argument-error"),da._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return _e(e.idToken||e.accessToken,"argument-error"),da._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Zf.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Zf.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new Zf(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends qm{constructor(){super("facebook.com")}static credential(e){return da._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qo.credential(e.oauthAccessToken)}catch{return null}}}qo.FACEBOOK_SIGN_IN_METHOD="facebook.com";qo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends qm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return da._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return zo.credential(t,r)}catch{return null}}}zo.GOOGLE_SIGN_IN_METHOD="google.com";zo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o extends qm{constructor(){super("github.com")}static credential(e){return da._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $o.credential(e.oauthAccessToken)}catch{return null}}}$o.GITHUB_SIGN_IN_METHOD="github.com";$o.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="http://localhost";class rm extends jm{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ol(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ol(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ol(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new rm(r,s)}static _create(e,t){return new rm(e,t)}buildRequest(){return{requestUri:Nz,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz="saml.";class fE extends xl{constructor(e){_e(e.startsWith(kz),"argument-error"),super(e)}static credentialFromResult(e){return fE.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return fE.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=rm.fromJSON(e);return _e(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return rm._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends qm{constructor(){super("twitter.com")}static credential(e,t){return da._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Wo.credential(t,r)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BF(n,e){return El(n,"POST","/v1/accounts:signUp",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Xs._fromIdTokenResponse(e,r,i),o=sD(r);return new Is({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=sD(r);return new Is({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function sD(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pz(n){var i;if(ln(n.app))return Promise.reject(ur(n));const e=Tn(n);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new Is({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await BF(e,{returnSecureToken:!0}),r=await Is._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE extends Vr{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,pE.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new pE(e,t,r,i)}}function HF(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?pE._fromErrorAndOperation(n,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GF(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rz(n,e){const t=Fe(n);await Ox(!0,t,e);const{providerUserInfo:r}=await Dq(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=GF(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function dN(n,e,t=!1){const r=await fl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Is._forOperation(n,"link",r)}async function Ox(n,e,t){await d0(e);const r=GF(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";_e(r.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jF(n,e,t=!1){const{auth:r}=n;if(ln(r.app))return Promise.reject(ur(r));const i="reauthenticate";try{const s=await fl(n,HF(r,i,e,n),t);_e(s.idToken,r,"internal-error");const o=Dx(s.idToken);_e(o,r,"internal-error");const{sub:a}=o;return _e(n.uid===a,r,"user-mismatch"),Is._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ir(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(n,e,t=!1){if(ln(n.app))return Promise.reject(ur(n));const r="signIn",i=await HF(n,r,e),s=await Is._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Vx(n,e){return qF(Tn(n),e)}async function zF(n,e){const t=Fe(n);return await Ox(!1,t,e.providerId),dN(t,e)}async function $F(n,e){return jF(Fe(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dz(n,e){return El(n,"POST","/v1/accounts:signInWithCustomToken",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mz(n,e){if(ln(n.app))return Promise.reject(ur(n));const t=Tn(n),r=await Dz(t,{token:e,returnSecureToken:!0}),i=await Is._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?hN._fromServerResponse(e,t):"totpInfo"in t?fN._fromServerResponse(e,t):Ir(e,"internal-error")}}class hN extends gw{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new hN(t)}}class fN extends gw{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new fN(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(n,e,t){var r;_e(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),_e(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),_e(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(_e(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(_e(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pN(n){const e=Tn(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Lz(n,e,t){const r=Tn(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Fx(r,i,t),await jc(r,i,"getOobCode",yz,"EMAIL_PASSWORD_PROVIDER")}async function Oz(n,e,t){await UF(Fe(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pN(n),r})}async function Vz(n,e){await pz(Fe(n),{oobCode:e})}async function WF(n,e){const t=Fe(n),r=await UF(t,{oobCode:e}),i=r.requestType;switch(_e(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":_e(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":_e(r.mfaInfo,t,"internal-error");default:_e(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=gw._fromServerResponse(Tn(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Fz(n,e){const{data:t}=await WF(Fe(n),e);return t.email}async function Uz(n,e,t){if(ln(n.app))return Promise.reject(ur(n));const r=Tn(n),o=await jc(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",BF,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&pN(n),c}),a=await Is._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function Bz(n,e,t){return ln(n.app)?Promise.reject(ur(n)):Vx(Fe(n),gu.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pN(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hz(n,e,t){const r=Tn(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){_e(a.handleCodeInApp,r,"argument-error"),a&&Fx(r,o,a)}s(i,t),await jc(r,i,"getOobCode",wz,"EMAIL_PASSWORD_PROVIDER")}function Gz(n,e){const t=Lx.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function jz(n,e,t){if(ln(n.app))return Promise.reject(ur(n));const r=Fe(n),i=gu.credentialWithLink(e,t||u0());return _e(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Vx(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qz(n,e){return Sn(n,"POST","/v1/accounts:createAuthUri",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(n,e){const t=lN()?u0():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await qz(Fe(n),r);return i||[]}async function $z(n,e){const t=Fe(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Fx(t.auth,i,e);const{email:s}=await gz(t.auth,i);s!==n.email&&await n.reload()}async function Wz(n,e,t){const r=Fe(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Fx(r.auth,s,t);const{email:o}=await _z(r.auth,s);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kz(n,e){return Sn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Fe(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await fl(r,Kz(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Jz(n,e){const t=Fe(n);return ln(t.auth.app)?Promise.reject(ur(t.auth)):KF(t,e,null)}function Yz(n,e){return KF(Fe(n),null,e)}async function KF(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const o=await fl(n,hz(r,s));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xz(n){var i,s;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const o=(s=(i=Dx(n.idToken))==null?void 0:i.firebase)==null?void 0:s.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ep(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new Zz(r,t);case"github.com":return new e$(r,t);case"google.com":return new t$(r,t);case"twitter.com":return new n$(r,t,n.screenName||null);case"custom":case"anonymous":return new ep(r,null);default:return new ep(r,e,t)}}class ep{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class QF extends ep{constructor(e,t,r,i){super(e,t,r),this.username=i}}class Zz extends ep{constructor(e,t){super(e,"facebook.com",t)}}class e$ extends QF{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class t$ extends ep{constructor(e,t){super(e,"google.com",t)}}class n$ extends QF{constructor(e,t,r){super(e,"twitter.com",t,r)}}function r$(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:Xz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new _d("enroll",e,t)}static _fromMfaPendingCredential(e){return new _d("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return _d._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return _d._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Tn(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>gw._fromServerResponse(r,a));_e(i.mfaPendingCredential,r,"internal-error");const o=_d._fromMfaPendingCredential(i.mfaPendingCredential);return new mN(o,s,async a=>{const c=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const d={...i,idToken:c.idToken,refreshToken:c.refreshToken};switch(t.operationType){case"signIn":const h=await Is._fromIdTokenResponse(r,t.operationType,d);return await r._updateCurrentUser(h.user),h;case"reauthenticate":return _e(t.user,r,"internal-error"),Is._forOperation(t.user,t.operationType,d);default:Ir(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function i$(n,e){var i;const t=Fe(n),r=e;return _e(e.customData.operationType,t,"argument-error"),_e((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),mN._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(n,e){return Sn(n,"POST","/v2/accounts/mfaEnrollment:start",Cn(n,e))}function s$(n,e){return Sn(n,"POST","/v2/accounts/mfaEnrollment:finalize",Cn(n,e))}function o$(n,e){return Sn(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Cn(n,e))}class gN{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>gw._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new gN(e)}async getSession(){return _d._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await fl(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await fl(this.user,o$(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const BA=new WeakMap;function a$(n){const e=Fe(n);return BA.has(e)||BA.set(e,gN._fromUser(e)),BA.get(e)}const mE="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mE,"1"),this.storage.removeItem(mE),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l$=1e3,c$=10;class YF extends JF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);jq()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,c$):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},l$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}YF.type="LOCAL";const yN=YF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF extends JF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XF.type="SESSION";const nh=XF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ux(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async d=>d(t.origin,s)),c=await u$(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ux.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const d=yw("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(_.data.response);break;default:clearTimeout(h),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(){return window}function h$(n){Bn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wN(){return typeof Bn().WorkerGlobalScope<"u"&&typeof Bn().importScripts=="function"}async function f$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function p$(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function m$(){return wN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF="firebaseLocalStorageDb",g$=1,gE="firebaseLocalStorage",e4="fbase_key";class ww{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Bx(n,e){return n.transaction([gE],e?"readwrite":"readonly").objectStore(gE)}function y$(){const n=indexedDB.deleteDatabase(ZF);return new ww(n).toPromise()}function zb(){const n=indexedDB.open(ZF,g$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(gE,{keyPath:e4})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(gE)?e(r):(r.close(),await y$(),e(await zb()))})})}async function aD(n,e,t){const r=Bx(n,!0).put({[e4]:e,value:t});return new ww(r).toPromise()}async function w$(n,e){const t=Bx(n,!1).get(e),r=await new ww(t).toPromise();return r===void 0?null:r.value}function lD(n,e){const t=Bx(n,!0).delete(e);return new ww(t).toPromise()}const _$=800,v$=3;class t4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>v$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ux._getInstance(m$()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await f$(),!this.activeServiceWorker)return;this.sender=new d$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||p$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zb();return await aD(e,mE,"1"),await lD(e,mE),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>aD(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>w$(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lD(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Bx(i,!1).getAll();return new ww(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}t4.type="LOCAL";const f0=t4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cD(n,e){return Sn(n,"POST","/v2/accounts/mfaSignIn:start",Cn(n,e))}function E$(n,e){return Sn(n,"POST","/v2/accounts/mfaSignIn:finalize",Cn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=OF("rcb"),x$=new hw(3e4,6e4);class T${constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=Bn().grecaptcha)!=null&&e.render)}load(e,t=""){return _e(I$(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Y2(Bn().grecaptcha)?Promise.resolve(Bn().grecaptcha):new Promise((r,i)=>{const s=Bn().setTimeout(()=>{i(Kn(e,"network-request-failed"))},x$.get());Bn()[HA]=()=>{Bn().clearTimeout(s),delete Bn()[HA];const a=Bn().grecaptcha;if(!a||!Y2(a)){i(Kn(e,"internal-error"));return}const c=a.render;a.render=(d,h)=>{const m=c(d,h);return this.counter++,m},this.hostLanguage=t,r(a)};const o=`${Jq()}?${Sh({onload:HA,render:"explicit",hl:t})}`;uN(o).catch(()=>{clearTimeout(s),i(Kn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=Bn().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function I$(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class A${async load(e){return new tz(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy="recaptcha",b$={theme:"light",type:"image"};let C$=class{constructor(e,t,r={...b$}){this.parameters=r,this.type=Oy,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Tn(e),this.isInvisible=this.parameters.size==="invisible",_e(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;_e(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new A$:new T$,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){_e(!this.parameters.sitekey,this.auth,"argument-error"),_e(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),_e(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Bn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){_e(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){_e(lN()&&!wN(),this.auth,"internal-error"),await S$(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Pq(this.auth);_e(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return _e(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function S$(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Qd._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function N$(n,e,t){if(ln(n.app))return Promise.reject(ur(n));const r=Tn(n),i=await Hx(r,e,Fe(t));return new _N(i,s=>Vx(r,s))}async function k$(n,e,t){const r=Fe(n);await Ox(!1,r,"phone");const i=await Hx(r.auth,e,Fe(t));return new _N(i,s=>zF(r,s))}async function P$(n,e,t){const r=Fe(n);if(ln(r.auth.app))return Promise.reject(ur(r.auth));const i=await Hx(r.auth,e,Fe(t));return new _N(i,s=>$F(r,s))}async function Hx(n,e,t){var r;if(!n._getRecaptchaConfig())try{await az(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const s=i.session;if("phoneNumber"in i){_e(s.type==="enroll",n,"internal-error");const o={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await jc(n,o,"mfaSmsEnrollment",async(h,m)=>{if(m.phoneEnrollmentInfo.captchaResponse===Ly){_e((t==null?void 0:t.type)===Oy,h,"argument-error");const _=await GA(h,m,t);return oD(h,_)}return oD(h,m)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneSessionInfo.sessionInfo}else{_e(s.type==="signin",n,"internal-error");const o=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;_e(o,n,"missing-multi-factor-info");const a={mfaPendingCredential:s.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await jc(n,a,"mfaSmsSignIn",async(m,_)=>{if(_.phoneSignInInfo.captchaResponse===Ly){_e((t==null?void 0:t.type)===Oy,m,"argument-error");const x=await GA(m,_,t);return cD(m,x)}return cD(m,_)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await jc(n,s,"sendVerificationCode",async(d,h)=>{if(h.captchaResponse===Ly){_e((t==null?void 0:t.type)===Oy,d,"argument-error");const m=await GA(d,h,t);return iD(d,m)}return iD(d,h)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).sessionInfo}}finally{t==null||t._reset()}}async function R$(n,e){const t=Fe(n);if(ln(t.auth.app))return Promise.reject(ur(t.auth));await dN(t,e)}async function GA(n,e,t){_e(t.type===Oy,n,"argument-error");const r=await t.verify();_e(typeof r=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,a=i.phoneEnrollmentInfo.clientType,c=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:c}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,a=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:a}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh=class Pv{constructor(e){this.providerId=Pv.PROVIDER_ID,this.auth=Tn(e)}verifyPhoneNumber(e,t){return Hx(this.auth,e,Fe(t))}static credential(e,t){return Qd._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Pv.credentialFromTaggedObject(t)}static credentialFromError(e){return Pv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Qd._fromTokenResponse(t,r):null}};rh.PROVIDER_ID="phone";rh.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(n,e){return e?Qi(e):(_e(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN extends jm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ol(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ol(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ol(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function D$(n){return qF(n.auth,new vN(n),n.bypassAuthState)}function M$(n){const{auth:e,user:t}=n;return _e(t,e,"internal-error"),jF(t,new vN(n),n.bypassAuthState)}async function L$(n){const{auth:e,user:t}=n;return _e(t,e,"internal-error"),dN(t,new vN(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return D$;case"linkViaPopup":case"linkViaRedirect":return L$;case"reauthViaPopup":case"reauthViaRedirect":return M$;default:Ir(this.auth,"internal-error")}}resolve(e){ro(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ro(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O$=new hw(2e3,1e4);async function V$(n,e,t){if(ln(n.app))return Promise.reject(Kn(n,"operation-not-supported-in-this-environment"));const r=Tn(n);Gm(n,e,xl);const i=Nh(r,t);return new tl(r,"signInViaPopup",e,i).executeNotNull()}async function F$(n,e,t){const r=Fe(n);if(ln(r.auth.app))return Promise.reject(Kn(r.auth,"operation-not-supported-in-this-environment"));Gm(r.auth,e,xl);const i=Nh(r.auth,t);return new tl(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function U$(n,e,t){const r=Fe(n);Gm(r.auth,e,xl);const i=Nh(r.auth,t);return new tl(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class tl extends n4{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){ro(this.filter.length===1,"Popup operations only handle one event");const e=yw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Kn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Kn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,O$.get())};e()}}tl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$="pendingRedirect",Vy=new Map;class H$ extends n4{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Vy.get(this.auth._key());if(!e){try{const r=await G$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Vy.set(this.auth._key(),e)}return this.bypassAuthState||Vy.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G$(n,e){const t=i4(e),r=r4(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function EN(n,e){return r4(n)._set(i4(e),"true")}function j$(){Vy.clear()}function xN(n,e){Vy.set(n._key(),e)}function r4(n){return Qi(n._redirectPersistence)}function i4(n){return Kd(B$,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q$(n,e,t){return z$(n,e,t)}async function z$(n,e,t){if(ln(n.app))return Promise.reject(ur(n));const r=Tn(n);Gm(n,e,xl),await r._initializationPromise;const i=Nh(r,t);return await EN(i,r),i._openRedirect(r,e,"signInViaRedirect")}function $$(n,e,t){return W$(n,e,t)}async function W$(n,e,t){const r=Fe(n);if(Gm(r.auth,e,xl),ln(r.auth.app))return Promise.reject(ur(r.auth));await r.auth._initializationPromise;const i=Nh(r.auth,t);await EN(i,r.auth);const s=await s4(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function K$(n,e,t){return Q$(n,e,t)}async function Q$(n,e,t){const r=Fe(n);Gm(r.auth,e,xl),await r.auth._initializationPromise;const i=Nh(r.auth,t);await Ox(!1,r,e.providerId),await EN(i,r.auth);const s=await s4(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function J$(n,e){return await Tn(n)._initializationPromise,Gx(n,e,!1)}async function Gx(n,e,t=!1){if(ln(n.app))return Promise.reject(ur(n));const r=Tn(n),i=Nh(r,e),o=await new H$(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function s4(n){const e=yw(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$=600*1e3;class o4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!a4(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(Kn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y$&&this.cachedEventUids.clear(),this.cachedEventUids.has(uD(e))}saveEventToCache(e){this.cachedEventUids.add(uD(e)),this.lastProcessedEventTime=Date.now()}}function uD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function a4({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function X$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return a4(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(n,e={}){return Sn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eW=/^https?/;async function tW(n){if(n.config.emulator)return;const{authorizedDomains:e}=await l4(n);for(const t of e)try{if(nW(t))return}catch{}Ir(n,"unauthorized-domain")}function nW(n){const e=u0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!eW.test(t))return!1;if(Z$.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=new hw(3e4,6e4);function dD(){const n=Bn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function iW(n){return new Promise((e,t)=>{var i,s,o;function r(){dD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dD(),t(Kn(n,"network-request-failed"))},timeout:rW.get()})}if((s=(i=Bn().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Bn().gapi)!=null&&o.load)r();else{const a=OF("iframefcb");return Bn()[a]=()=>{gapi.load?r():t(Kn(n,"network-request-failed"))},uN(`${Xq()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Rv=null,e})}let Rv=null;function sW(n){return Rv=Rv||iW(n),Rv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oW=new hw(5e3,15e3),aW="__/auth/iframe",lW="emulator/auth/iframe",cW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dW(n){const e=n.config;_e(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?cN(e,lW):`https://${n.config.authDomain}/${aW}`,r={apiKey:e.apiKey,appName:n.name,v:vl},i=uW.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Sh(r).slice(1)}`}async function hW(n){const e=await sW(n),t=Bn().gapi;return _e(t,n,"internal-error"),e.open({where:document.body,url:dW(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cW,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Kn(n,"network-request-failed"),a=Bn().setTimeout(()=>{s(o)},oW.get());function c(){Bn().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pW=500,mW=600,gW="_blank",yW="http://localhost";class hD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wW(n,e,t,r=pW,i=mW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...fW,width:r.toString(),height:i.toString(),top:s,left:o},d=xn().toLowerCase();t&&(a=kF(d)?gW:t),SF(d)&&(e=e||yW,c.scrollbars="yes");const h=Object.entries(c).reduce((_,[x,b])=>`${_}${x}=${b},`,"");if(Gq(d)&&a!=="_self")return _W(e||"",a),new hD(null);const m=window.open(e||"",a,h);_e(m,n,"popup-blocked");try{m.focus()}catch{}return new hD(m)}function _W(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW="__/auth/handler",EW="emulator/auth/handler",xW=encodeURIComponent("fac");async function $b(n,e,t,r,i,s){_e(n.config.authDomain,n,"auth-domain-config-required"),_e(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:vl,eventId:i};if(e instanceof xl){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",lE(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries(s||{}))o[h]=m}if(e instanceof qm){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await n._getAppCheckToken(),d=c?`#${xW}=${encodeURIComponent(c)}`:"";return`${TW(n)}?${Sh(a).slice(1)}${d}`}function TW({config:n}){return n.emulator?cN(n,EW):`https://${n.authDomain}/${vW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="webStorageSupport";class IW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nh,this._completeRedirectFn=Gx,this._overrideRedirectResult=xN}async _openPopup(e,t,r,i){var o;ro((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await $b(e,t,r,u0(),i);return wW(e,s,yw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await $b(e,t,r,u0(),i);return h$(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ro(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await hW(e),r=new o4(e);return t.register("authEvent",i=>(_e(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jA,{type:jA},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[jA];s!==void 0&&t(!!s),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tW(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return MF()||NF()||pw()}}const AW=IW;class bW{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Yo("unexpected MultiFactorSessionType")}}}class TN extends bW{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new TN(e)}_finalizeEnroll(e,t,r){return s$(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return E$(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class c4{constructor(){}static assertion(e){return TN._fromCredential(e)}}c4.FACTOR_ID="phone";var fD="@firebase/auth",pD="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SW(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NW(n){Ii(new qn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;_e(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LF(n)},d=new Kq(r,i,s,c);return lz(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new qn("auth-internal",e=>{const t=Tn(e.getProvider("auth").getImmediate());return(r=>new CW(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(fD,pD,SW(n)),Er(fD,pD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW=300;VG("authIdTokenMaxAge");function PW(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Qq({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Kn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",PW().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NW("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RW=2e3;async function DW(n,e,t){const{BuildInfo:r}=ih();ro(e.sessionId,"AuthEvent did not contain a session ID");const i=await FW(e.sessionId),s={};return pw()?s.ibi=r.packageName:fw()?s.apn=r.packageName:Ir(n,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=i,$b(n,t,e.type,void 0,e.eventId??void 0,s)}async function MW(n){const{BuildInfo:e}=ih(),t={};pw()?t.iosBundleId=e.packageName:fw()?t.androidPackageName=e.packageName:Ir(n,"operation-not-supported-in-this-environment"),await l4(n,t)}function LW(n){const{cordova:e}=ih();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,Hq()?"_blank":"_system","location=yes"),t(i)})})}async function OW(n,e,t){const{cordova:r}=ih();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function c(){var _;s();const m=(_=r.plugins.browsertab)==null?void 0:_.close;typeof m=="function"&&m(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function d(){a||(a=window.setTimeout(()=>{o(Kn(n,"redirect-cancelled-by-user"))},RW))}function h(){(document==null?void 0:document.visibilityState)==="visible"&&d()}e.addPassiveListener(c),document.addEventListener("resume",d,!1),fw()&&document.addEventListener("visibilitychange",h,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",d,!1),document.removeEventListener("visibilitychange",h,!1),a&&window.clearTimeout(a)}})}finally{i()}}function VW(n){var t,r,i,s,o,a,c,d,h,m;const e=ih();_e(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),_e(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),_e(typeof((o=(s=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:s.browsertab)==null?void 0:o.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_e(typeof((d=(c=(a=e==null?void 0:e.cordova)==null?void 0:a.plugins)==null?void 0:c.browsertab)==null?void 0:d.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_e(typeof((m=(h=e==null?void 0:e.cordova)==null?void 0:h.InAppBrowser)==null?void 0:m.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function FW(n){const e=UW(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function UW(n){if(ro(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BW=20;class HW extends o4{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function GW(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:zW(),postBody:null,tenantId:n.tenantId,error:Kn(n,"no-auth-event")}}function jW(n,e){return Wb()._set(Kb(n),e)}async function mD(n){const e=await Wb()._get(Kb(n));return e&&await Wb()._remove(Kb(n)),e}function qW(n,e){var r,i;const t=WW(e);if(t.includes("/__/auth/callback")){const s=Dv(t),o=s.firebaseError?$W(decodeURIComponent(s.firebaseError)):null,a=(i=(r=o==null?void 0:o.code)==null?void 0:r.split("auth/"))==null?void 0:i[1],c=a?Kn(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function zW(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<BW;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Wb(){return Qi(yN)}function Kb(n){return Kd("authEvent",n.config.apiKey,n.name)}function $W(n){try{return JSON.parse(n)}catch{return null}}function WW(n){const e=Dv(n),t=e.link?decodeURIComponent(e.link):void 0,r=Dv(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Dv(i).link||i||r||t||n}function Dv(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Gf(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=500;class QW{constructor(){this._redirectPersistence=nh,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Gx,this._overrideRedirectResult=xN}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new HW(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Ir(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){VW(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),j$(),await this._originValidation(e);const o=GW(e,r,i);await jW(e,o);const a=await DW(e,o,t),c=await LW(a);return OW(e,s,c)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=MW(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ih(),o=setTimeout(async()=>{await mD(e),t.onEvent(gD())},KW),a=async h=>{clearTimeout(o);const m=await mD(e);let _=null;m&&(h!=null&&h.url)&&(_=qW(m,h.url)),t.onEvent(_||gD())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=i,d=`${s.packageName.toLowerCase()}://`;ih().handleOpenURL=async h=>{if(h.toLowerCase().startsWith(d)&&a({url:h}),typeof c=="function")try{c(h)}catch(m){console.error(m)}}}}const JW=QW;function gD(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Kn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YW(n,e){Tn(n)._logFramework(e)}var XW="@firebase/auth-compat",ZW="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eK=1e3;function Fy(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function tK(){return Fy()==="http:"||Fy()==="https:"}function u4(n=xn()){return!!((Fy()==="file:"||Fy()==="ionic:"||Fy()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function nK(){return kx()||Nx()}function rK(){return rF()&&(document==null?void 0:document.documentMode)===11}function iK(n=xn()){return/Edge\/\d+/.test(n)}function sK(n=xn()){return rK()||iK(n)}function d4(){try{const n=self.localStorage,e=yw();if(n)return n.setItem(e,"1"),n.removeItem(e),sK()?eh():!0}catch{return IN()&&eh()}return!1}function IN(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function qA(){return(tK()||nF()||u4())&&!nK()&&d4()&&!IN()}function h4(){return u4()&&typeof document<"u"}async function oK(){return h4()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},eK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function aK(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi={LOCAL:"local",NONE:"none",SESSION:"session"},ey=_e,f4="persistence";function lK(n,e){if(ey(Object.values(Wi).includes(e),n,"invalid-persistence-type"),kx()){ey(e!==Wi.SESSION,n,"unsupported-persistence-type");return}if(Nx()){ey(e===Wi.NONE,n,"unsupported-persistence-type");return}if(IN()){ey(e===Wi.NONE||e===Wi.LOCAL&&eh(),n,"unsupported-persistence-type");return}ey(e===Wi.NONE||d4(),n,"unsupported-persistence-type")}async function Qb(n){await n._initializationPromise;const e=p4(),t=Kd(f4,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function cK(n,e){const t=p4();if(!t)return[];const r=Kd(f4,n,e);switch(t.getItem(r)){case Wi.NONE:return[nm];case Wi.LOCAL:return[f0,nh];case Wi.SESSION:return[nh];default:return[]}}function p4(){var n;try{return((n=aK())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uK=_e;class Oc{constructor(){this.browserResolver=Qi(AW),this.cordovaResolver=Qi(JW),this.underlyingResolver=null,this._redirectPersistence=nh,this._completeRedirectFn=Gx,this._overrideRedirectResult=xN}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return h4()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return uK(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await oK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(n){return n.unwrap()}function dK(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hK(n){return g4(n)}function fK(n,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new pK(n,i$(n,e))}else if(t){const i=g4(e),s=e;i&&(s.credential=i,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function g4(n){const{_tokenResponse:e}=n instanceof Vr?n.customData:n;if(!e)return null;if(!(n instanceof Vr)&&"temporaryProof"in e&&"phoneNumber"in e)return rh.credentialFromResult(n);const t=e.providerId;if(!t||t===Xg.PASSWORD)return null;let r;switch(t){case Xg.GOOGLE:r=zo;break;case Xg.FACEBOOK:r=qo;break;case Xg.GITHUB:r=$o;break;case Xg.TWITTER:r=Wo;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?rm._create(t,a):da._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Zf(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof Vr?r.credentialFromError(n):r.credentialFromResult(n)}function mi(n,e){return e.catch(t=>{throw t instanceof Vr&&fK(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:hK(t),additionalUserInfo:r$(t),user:jx.getOrCreate(i)}})}async function Jb(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>mi(n,t.confirm(r))}}class pK{constructor(e,t){this.resolver=t,this.auth=dK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return mi(m4(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jx=class Ey{constructor(e){this._delegate=e,this.multiFactor=a$(e)}static getOrCreate(e){return Ey.USER_MAP.has(e)||Ey.USER_MAP.set(e,new Ey(e)),Ey.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return mi(this.auth,zF(this._delegate,e))}async linkWithPhoneNumber(e,t){return Jb(this.auth,k$(this._delegate,e,t))}async linkWithPopup(e){return mi(this.auth,U$(this._delegate,e,Oc))}async linkWithRedirect(e){return await Qb(Tn(this.auth)),K$(this._delegate,e,Oc)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return mi(this.auth,$F(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Jb(this.auth,P$(this._delegate,e,t))}reauthenticateWithPopup(e){return mi(this.auth,F$(this._delegate,e,Oc))}async reauthenticateWithRedirect(e){return await Qb(Tn(this.auth)),$$(this._delegate,e,Oc)}sendEmailVerification(e){return $z(this._delegate,e)}async unlink(e){return await Rz(this._delegate,e),this}updateEmail(e){return Jz(this._delegate,e)}updatePassword(e){return Yz(this._delegate,e)}updatePhoneNumber(e){return R$(this._delegate,e)}updateProfile(e){return Qz(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Wz(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};jx.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty=_e;class Yb{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;ty(r,"invalid-api-key",{appName:e.name}),ty(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Oc:void 0;this._delegate=t.initialize({options:{persistence:mK(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(Eq),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?jx.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){cz(this._delegate,e,t)}applyActionCode(e){return Vz(this._delegate,e)}checkActionCode(e){return WF(this._delegate,e)}confirmPasswordReset(e,t){return Oz(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return mi(this._delegate,Uz(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return zz(this._delegate,e)}isSignInWithEmailLink(e){return Gz(this._delegate,e)}async getRedirectResult(){ty(qA(),this._delegate,"operation-not-supported-in-this-environment");const e=await J$(this._delegate,Oc);return e?mi(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){YW(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:o}=yD(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:o}=yD(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return Hz(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Lz(this._delegate,e,t||void 0)}async setPersistence(e){lK(this._delegate,e);let t;switch(e){case Wi.SESSION:t=nh;break;case Wi.LOCAL:t=await Qi(f0)._isAvailable()?f0:yN;break;case Wi.NONE:t=nm;break;default:return Ir("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return mi(this._delegate,Pz(this._delegate))}signInWithCredential(e){return mi(this._delegate,Vx(this._delegate,e))}signInWithCustomToken(e){return mi(this._delegate,Mz(this._delegate,e))}signInWithEmailAndPassword(e,t){return mi(this._delegate,Bz(this._delegate,e,t))}signInWithEmailLink(e,t){return mi(this._delegate,jz(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Jb(this._delegate,N$(this._delegate,e,t))}async signInWithPopup(e){return ty(qA(),this._delegate,"operation-not-supported-in-this-environment"),mi(this._delegate,V$(this._delegate,e,Oc))}async signInWithRedirect(e){return ty(qA(),this._delegate,"operation-not-supported-in-this-environment"),await Qb(this._delegate),q$(this._delegate,e,Oc)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return Fz(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Yb.Persistence=Wi;function yD(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:o=>i(o&&jx.getOrCreate(o)),error:e,complete:t}}function mK(n,e){const t=cK(n,e);if(typeof self<"u"&&!t.includes(f0)&&t.push(f0),typeof window<"u")for(const r of[yN,nh])t.includes(r)||t.push(r);return t.includes(nm)||t.push(nm),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{static credential(e,t){return rh.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new rh(m4(Mn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}AN.PHONE_SIGN_IN_METHOD=rh.PHONE_SIGN_IN_METHOD;AN.PROVIDER_ID=rh.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK=_e;class yK{constructor(e,t,r=Mn.app()){var i;gK((i=r.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new C$(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wK="auth-compat";function _K(n){n.INTERNAL.registerComponent(new qn(wK,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Yb(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Tf.EMAIL_SIGNIN,PASSWORD_RESET:Tf.PASSWORD_RESET,RECOVER_EMAIL:Tf.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Tf.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Tf.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Tf.VERIFY_EMAIL}},EmailAuthProvider:gu,FacebookAuthProvider:qo,GithubAuthProvider:$o,GoogleAuthProvider:zo,OAuthProvider:Zf,SAMLAuthProvider:fE,PhoneAuthProvider:AN,PhoneMultiFactorGenerator:c4,RecaptchaVerifier:yK,TwitterAuthProvider:Wo,Auth:Yb,AuthCredential:jm,Error:Vr}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(XW,ZW)}_K(Mn);var wD={};const _D="@firebase/database",vD="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let y4="";function w4(n){y4=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vK{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Wn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:a0(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Yi(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new vK(e)}}catch{}return new EK},vd=_4("localStorage"),Xb=_4("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=new Bm("@firebase/database"),v4=(function(){let n=1;return function(){return n++}})(),E4=function(n){const e=ZG(n),t=new JG;t.update(e);const r=t.digest();return WS.encodeByteArray(r)},_w=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=_w.apply(null,r):typeof r=="object"?e+=Wn(r):e+=r,e+=" "}return e};let Jd=null,ED=!0;const x4=function(n,e){Ie(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(tp.logLevel=wt.VERBOSE,Jd=tp.log.bind(tp),e&&Xb.set("logging_enabled",!0)):typeof n=="function"?Jd=n:(Jd=null,Xb.remove("logging_enabled"))},lr=function(...n){if(ED===!0&&(ED=!1,Jd===null&&Xb.get("logging_enabled")===!0&&x4(!0)),Jd){const e=_w.apply(null,n);Jd(e)}},vw=function(n){return function(...e){lr(n,...e)}},Zb=function(...n){const e="FIREBASE INTERNAL ERROR: "+_w(...n);tp.error(e)},ha=function(...n){const e=`FIREBASE FATAL ERROR: ${_w(...n)}`;throw tp.error(e),new Error(e)},Fr=function(...n){const e="FIREBASE WARNING: "+_w(...n);tp.warn(e)},xK=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Fr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},qx=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},TK=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Zc="[MIN_NAME]",pl="[MAX_NAME]",kh=function(n,e){if(n===e)return 0;if(n===Zc||e===pl)return-1;if(e===Zc||n===pl)return 1;{const t=xD(n),r=xD(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},IK=function(n,e){return n===e?0:n<e?-1:1},ny=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Wn(e))},bN=function(n){if(typeof n!="object"||n===null)return Wn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Wn(e[r]),t+=":",t+=bN(n[e[r]]);return t+="}",t},T4=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function dr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const I4=function(n){Ie(!qx(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const d=[];for(c=t;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const h=d.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(h.substr(c,8),2).toString(16);_.length===1&&(_="0"+_),m=m+_}return m.toLowerCase()},AK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},bK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function CK(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const SK=new RegExp("^-?(0*)\\d{1,10}$"),NK=-2147483648,kK=2147483647,xD=function(n){if(SK.test(n)){const e=Number(n);if(e>=NK&&e<=kK)return e}return null},zm=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Fr("Exception was thrown by user callback.",t),e},Math.floor(0))}},PK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Uy=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RK{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,ln(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Fr(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DK{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(lr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Fr(e)}}class np{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}np.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="5",A4="v",b4="s",C4="r",S4="f",N4=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,k4="ls",P4="p",eC="ac",R4="websocket",D4="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1,d=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vd.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function MK(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function L4(n,e,t){Ie(typeof e=="string","typeof type must == string"),Ie(typeof t=="object","typeof params must == object");let r;if(e===R4)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===D4)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);MK(n)&&(t.ns=n.namespace);const i=[];return dr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(){this.counters_={}}incrementCounter(e,t=1){Yi(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return RG(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA={},$A={};function SN(n){const e=n.toString();return zA[e]||(zA[e]=new LK),zA[e]}function OK(n,e){const t=n.toString();return $A[t]||($A[t]=e()),$A[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VK{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&zm(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="start",FK="close",UK="pLPCommand",BK="pRTLPCB",O4="id",V4="pw",F4="ser",HK="cb",GK="seg",jK="ts",qK="d",zK="dframe",U4=1870,B4=30,$K=U4-B4,WK=25e3,KK=3e4;class Vc{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vw(e),this.stats_=SN(t),this.urlFn=c=>(this.appCheckToken&&(c[eC]=this.appCheckToken),L4(t,D4,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new VK(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(KK)),TK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new NN((...s)=>{const[o,a,c,d,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===TD)this.id=a,this.password=c;else if(o===FK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[TD]="t",r[F4]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[HK]=this.scriptTagHolder.uniqueCallbackIdentifier),r[A4]=CN,this.transportSessionId&&(r[b4]=this.transportSessionId),this.lastSessionId&&(r[k4]=this.lastSessionId),this.applicationId&&(r[P4]=this.applicationId),this.appCheckToken&&(r[eC]=this.appCheckToken),typeof location<"u"&&location.hostname&&N4.test(location.hostname)&&(r[C4]=S4);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Vc.forceAllow_=!0}static forceDisallow(){Vc.forceDisallow_=!0}static isAvailable(){return Vc.forceAllow_?!0:!Vc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!AK()&&!bK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Wn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=Z5(t),i=T4(r,$K);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[zK]="t",r[O4]=e,r[V4]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Wn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class NN{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=v4(),window[UK+this.uniqueCallbackIdentifier]=e,window[BK+this.uniqueCallbackIdentifier]=t,this.myIFrame=NN.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){lr("frame writing exception"),a.stack&&lr(a.stack),lr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||lr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[O4]=this.myID,e[V4]=this.myPW,e[F4]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+B4+r.length<=U4;){const o=this.pendingSegs.shift();r=r+"&"+GK+i+"="+o.seg+"&"+jK+i+"="+o.ts+"&"+qK+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(WK)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{lr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QK=16384,JK=45e3;let yE=null;typeof MozWebSocket<"u"?yE=MozWebSocket:typeof WebSocket<"u"&&(yE=WebSocket);class ys{constructor(e,t,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vw(this.connId),this.stats_=SN(t),this.connURL=ys.connectionURL_(t,o,a,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[A4]=CN,typeof location<"u"&&location.hostname&&N4.test(location.hostname)&&(o[C4]=S4),t&&(o[b4]=t),r&&(o[k4]=r),i&&(o[eC]=i),s&&(o[P4]=s),L4(e,R4,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vd.set("previous_websocket_failure",!0);try{let r;GG(),this.mySock=new yE(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){ys.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&yE!==null&&!ys.forceDisallow_}static previouslyFailed(){return vd.isInMemoryStorage||vd.get("previous_websocket_failure")===!0}markConnectionHealthy(){vd.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=a0(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Ie(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Wn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=T4(t,QK);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(JK))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ys.responsesRequiredToBeHealthy=2;ys.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{static get ALL_TRANSPORTS(){return[Vc,ys]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=ys&&ys.isAvailable();let r=t&&!ys.previouslyFailed();if(e.webSocketOnly&&(t||Fr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ys];else{const i=this.transports_=[];for(const s of im.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);im.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}im.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=6e4,XK=5e3,ZK=10*1024,eQ=100*1024,WA="t",ID="d",tQ="s",AD="r",nQ="e",bD="o",CD="a",SD="n",ND="p",rQ="h";class iQ{constructor(e,t,r,i,s,o,a,c,d,h){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vw("c:"+this.id+":"),this.transportManager_=new im(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Uy(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>eQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ZK?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(WA in e){const t=e[WA];t===CD?this.upgradeIfSecondaryHealthy_():t===AD?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===bD&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ny("t",e),r=ny("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ND,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:CD,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:SD,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ny("t",e),r=ny("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ny(WA,e);if(ID in e){const r=e[ID];if(t===rQ){const i={...r};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===SD){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===tQ?this.onConnectionShutdown_(r):t===AD?this.onReset_(r):t===nQ?Zb("Server Error: "+r):t===bD?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zb("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),CN!==r&&Fr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Uy(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(YK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Uy(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(XK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ND,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e){this.allowedEvents_=e,this.listeners_={},Ie(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){Ie(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE extends G4{static getInstance(){return new wE}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ZS()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Ie(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=32,PD=768;class Vt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function kt(){return new Vt("")}function ft(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function eu(n){return n.pieces_.length-n.pieceNum_}function Wt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Vt(n.pieces_,e)}function kN(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function sQ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function p0(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function j4(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Vt(e,0)}function hn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Vt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Vt(t,0)}function pt(n){return n.pieceNum_>=n.pieces_.length}function Xr(n,e){const t=ft(n),r=ft(e);if(t===null)return e;if(t===r)return Xr(Wt(n),Wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function oQ(n,e){const t=p0(n,0),r=p0(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=kh(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function PN(n,e){if(eu(n)!==eu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function ws(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(eu(n)>eu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class aQ{constructor(e,t){this.errorPrefix_=t,this.parts_=p0(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Px(this.parts_[r]);q4(this)}}function lQ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Px(e),q4(n)}function cQ(n){const e=n.parts_.pop();n.byteLength_-=Px(e),n.parts_.length>0&&(n.byteLength_-=1)}function q4(n){if(n.byteLength_>PD)throw new Error(n.errorPrefix_+"has a key path longer than "+PD+" bytes ("+n.byteLength_+").");if(n.parts_.length>kD)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+kD+") or object contains a cycle "+rd(n))}function rd(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN extends G4{static getInstance(){return new RN}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return Ie(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry=1e3,uQ=300*1e3,RD=30*1e3,dQ=1.3,hQ=3e4,fQ="server_kill",DD=3;class al extends H4{constructor(e,t,r,i,s,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=al.nextPersistentConnectionId_++,this.log_=vw("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ry,this.maxReconnectDelay_=uQ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");RN.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&wE.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Wn(s)),Ie(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new wi,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),Ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ie(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const c=a.d,d=a.s;al.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),d!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Yi(e,"w")){const r=th(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Fr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||QG(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RD)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=KG(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),Ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Wn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Zb("Unrecognized action received from server: "+Wn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Ie(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ry,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ry,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>hQ&&(this.reconnectDelay_=ry),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*dQ)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+al.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},d=function(m){Ie(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(m)};this.realtime_={close:c,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,_]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?lr("getToken() completed but was canceled"):(lr("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,a=new iQ(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,x=>{Fr(x+" ("+this.repoInfo_.toString()+")"),this.interrupt(fQ)},s))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&Fr(m),c())}}}interrupt(e){lr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){lr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],lE(this.interruptReasons_)&&(this.reconnectDelay_=ry,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>bN(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new Vt(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){lr("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=DD&&(this.reconnectDelay_=RD,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){lr("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=DD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+y4.replace(/\./g,"-")]=1,ZS()?e["framework.cordova"]=1:kx()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=wE.getInstance().currentlyOnline();return lE(this.interruptReasons_)&&e}}al.nextPersistentConnectionId_=0;al.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new _t(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new _t(Zc,e),i=new _t(Zc,t);return this.compare(r,i)!==0}minPost(){return _t.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cv;class z4 extends zx{static get __EMPTY_NODE(){return cv}static set __EMPTY_NODE(e){cv=e}compare(e,t){return kh(e.name,t.name)}isDefinedOn(e){throw Um("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return _t.MIN}maxPost(){return new _t(pl,cv)}makePost(e,t){return Ie(typeof e=="string","KeyIndex indexValue must always be a string."),new _t(e,cv)}toString(){return".key"}}const sa=new z4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uv=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},qi=class xy{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??xy.RED,this.left=i??Xo.EMPTY_NODE,this.right=s??Xo.EMPTY_NODE}copy(e,t,r,i,s){return new xy(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Xo.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Xo.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,xy.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,xy.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};qi.RED=!0;qi.BLACK=!1;class pQ{copy(e,t,r,i,s){return this}insert(e,t,r){return new qi(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Xo=class Mv{constructor(e,t=Mv.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Mv(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,qi.BLACK,null,null))}remove(e){return new Mv(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qi.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new uv(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new uv(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new uv(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new uv(this.root_,null,this.comparator_,!0,e)}};Xo.EMPTY_NODE=new pQ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mQ(n,e){return kh(n.name,e.name)}function DN(n,e){return kh(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tC;function gQ(n){tC=n}const $4=function(n){return typeof n=="number"?"number:"+I4(n):"string:"+n},W4=function(n){if(n.isLeafNode()){const e=n.val();Ie(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Yi(e,".sv"),"Priority must be a string or number.")}else Ie(n===tC||n.isEmpty(),"priority of unexpected type.");Ie(n===tC||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MD;class nr{static set __childrenNodeConstructor(e){MD=e}static get __childrenNodeConstructor(){return MD}constructor(e,t=nr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Ie(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),W4(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new nr(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:nr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pt(e)?this:ft(e)===".priority"?this.priorityNode_:nr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:nr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=ft(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(Ie(r!==".priority"||eu(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,nr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$4(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=I4(this.value_):e+=this.value_,this.lazyHash_=E4(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===nr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof nr.__childrenNodeConstructor?-1:(Ie(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=nr.VALUE_TYPE_ORDER.indexOf(t),s=nr.VALUE_TYPE_ORDER.indexOf(r);return Ie(i>=0,"Unknown leaf type: "+t),Ie(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}nr.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K4,Q4;function yQ(n){K4=n}function wQ(n){Q4=n}class _Q extends zx{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?kh(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return _t.MIN}maxPost(){return new _t(pl,new nr("[PRIORITY-POST]",Q4))}makePost(e,t){const r=K4(e);return new _t(t,new nr("[PRIORITY-POST]",r))}toString(){return".priority"}}const Yt=new _Q;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vQ=Math.log(2);class EQ{constructor(e){const t=s=>parseInt(Math.log(s)/vQ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const _E=function(n,e,t,r){n.sort(e);const i=function(c,d){const h=d-c;let m,_;if(h===0)return null;if(h===1)return m=n[c],_=t?t(m):m,new qi(_,m.node,qi.BLACK,null,null);{const x=parseInt(h/2,10)+c,b=i(c,x),A=i(x+1,d);return m=n[x],_=t?t(m):m,new qi(_,m.node,qi.BLACK,b,A)}},s=function(c){let d=null,h=null,m=n.length;const _=function(b,A){const N=m-b,F=m;m-=b;const B=i(N+1,F),O=n[N],q=t?t(O):O;x(new qi(q,O.node,A,null,B))},x=function(b){d?(d.left=b,d=b):(h=b,d=b)};for(let b=0;b<c.count;++b){const A=c.nextBitIsOne(),N=Math.pow(2,c.count-(b+1));A?_(N,qi.BLACK):(_(N,qi.BLACK),_(N,qi.RED))}return h},o=new EQ(n.length),a=s(o);return new Xo(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KA;const If={};class nl{static get Default(){return Ie(If&&Yt,"ChildrenNode.ts has not been loaded"),KA=KA||new nl({".priority":If},{".priority":Yt}),KA}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=th(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Xo?t:null}hasIndex(e){return Yi(this.indexSet_,e.toString())}addIndex(e,t){Ie(e!==sa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(_t.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=_E(r,e.getCompare()):a=If;const c=e.toString(),d={...this.indexSet_};d[c]=e;const h={...this.indexes_};return h[c]=a,new nl(h,d)}addToIndexes(e,t){const r=cE(this.indexes_,(i,s)=>{const o=th(this.indexSet_,s);if(Ie(o,"Missing index implementation for "+s),i===If)if(o.isDefinedOn(e.node)){const a=[],c=t.getIterator(_t.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&a.push(d),d=c.getNext();return a.push(e),_E(a,o.getCompare())}else return If;else{const a=t.get(e.name);let c=i;return a&&(c=c.remove(new _t(e.name,a))),c.insert(e,e.node)}});return new nl(r,this.indexSet_)}removeFromIndexes(e,t){const r=cE(this.indexes_,i=>{if(i===If)return i;{const s=t.get(e.name);return s?i.remove(new _t(e.name,s)):i}});return new nl(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iy;class Je{static get EMPTY_NODE(){return iy||(iy=new Je(new Xo(DN),null,nl.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&W4(this.priorityNode_),this.children_.isEmpty()&&Ie(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||iy}updatePriority(e){return this.children_.isEmpty()?this:new Je(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?iy:t}}getChild(e){const t=ft(e);return t===null?this:this.getImmediateChild(t).getChild(Wt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Ie(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new _t(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?iy:this.priorityNode_;return new Je(i,o,s)}}updateChild(e,t){const r=ft(e);if(r===null)return t;{Ie(ft(e)!==".priority"||eu(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Wt(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Yt,(o,a)=>{t[o]=a.val(e),r++,s&&Je.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+$4(this.getPriority().val())+":"),this.forEachChild(Yt,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":E4(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new _t(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new _t(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new _t(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,_t.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,_t.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ew?-1:0}withIndex(e){if(e===sa||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Je(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===sa||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Yt),i=t.getIterator(Yt);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===sa?null:this.indexMap_.get(e.toString())}}Je.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xQ extends Je{constructor(){super(new Xo(DN),Je.EMPTY_NODE,nl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Je.EMPTY_NODE}isEmpty(){return!1}}const Ew=new xQ;Object.defineProperties(_t,{MIN:{value:new _t(Zc,Je.EMPTY_NODE)},MAX:{value:new _t(pl,Ew)}});z4.__EMPTY_NODE=Je.EMPTY_NODE;nr.__childrenNodeConstructor=Je;gQ(Ew);wQ(Ew);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TQ=!0;function vn(n,e=null){if(n===null)return Je.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),Ie(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new nr(t,vn(e))}if(!(n instanceof Array)&&TQ){const t=[];let r=!1;if(dr(n,(o,a)=>{if(o.substring(0,1)!=="."){const c=vn(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new _t(o,c)))}}),t.length===0)return Je.EMPTY_NODE;const s=_E(t,mQ,o=>o.name,DN);if(r){const o=_E(t,Yt.getCompare());return new Je(s,vn(e),new nl({".priority":o},{".priority":Yt}))}else return new Je(s,vn(e),nl.Default)}else{let t=Je.EMPTY_NODE;return dr(n,(r,i)=>{if(Yi(n,r)&&r.substring(0,1)!=="."){const s=vn(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(vn(e))}}yQ(vn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN extends zx{constructor(e){super(),this.indexPath_=e,Ie(!pt(e)&&ft(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?kh(e.name,t.name):s}makePost(e,t){const r=vn(e),i=Je.EMPTY_NODE.updateChild(this.indexPath_,r);return new _t(t,i)}maxPost(){const e=Je.EMPTY_NODE.updateChild(this.indexPath_,Ew);return new _t(pl,e)}toString(){return p0(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ extends zx{compare(e,t){const r=e.node.compareTo(t.node);return r===0?kh(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return _t.MIN}maxPost(){return _t.MAX}makePost(e,t){const r=vn(e);return new _t(t,r)}toString(){return".value"}}const LN=new IQ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J4(n){return{type:"value",snapshotNode:n}}function sm(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function m0(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function g0(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function AQ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){Ie(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(m0(t,a)):Ie(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(sm(t,r)):o.trackChildChange(g0(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Yt,(i,s)=>{t.hasChild(i)||r.trackChildChange(m0(i,s))}),t.isLeafNode()||t.forEachChild(Yt,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(g0(i,s,o))}else r.trackChildChange(sm(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Je.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.indexedFilter_=new ON(e.getIndex()),this.index_=e.getIndex(),this.startPost_=y0.getStartPost_(e),this.endPost_=y0.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new _t(t,r))||(r=Je.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Je.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Je.EMPTY_NODE);const s=this;return t.forEachChild(Yt,(o,a)=>{s.matches(new _t(o,a))||(i=i.updateImmediateChild(o,Je.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bQ{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new y0(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new _t(t,r))||(r=Je.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Je.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Je.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Je.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Je.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const m=this.index_.getCompare();o=(_,x)=>m(x,_)}else o=this.index_.getCompare();const a=e;Ie(a.numChildren()===this.limit_,"");const c=new _t(t,r),d=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(a.hasChild(t)){const m=a.getImmediateChild(t);let _=i.getChildAfterChild(this.index_,d,this.reverse_);for(;_!=null&&(_.name===t||a.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const x=_==null?1:o(_,c);if(h&&!r.isEmpty()&&x>=0)return s!=null&&s.trackChildChange(g0(t,r,m)),a.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(m0(t,m));const A=a.updateImmediateChild(t,Je.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(s!=null&&s.trackChildChange(sm(_.name,_.node)),A.updateImmediateChild(_.name,_.node)):A}}else return r.isEmpty()?e:h&&o(d,c)>=0?(s!=null&&(s.trackChildChange(m0(d.name,d.node)),s.trackChildChange(sm(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(d.name,Je.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Yt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Ie(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ie(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Zc}hasEnd(){return this.endSet_}getIndexEndValue(){return Ie(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ie(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:pl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Ie(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Yt}copy(){const e=new $x;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function CQ(n){return n.loadsAllData()?new ON(n.getIndex()):n.hasLimit()?new bQ(n):new y0(n)}function SQ(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function NQ(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function nC(n,e,t){const r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function kQ(n,e,t){let r;return n.index_===sa||t?r=nC(n,e,t):r=nC(n,e,pl),r.startAfterSet_=!0,r}function rC(n,e,t){const r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function PQ(n,e,t){let r;return n.index_===sa||t?r=rC(n,e,t):r=rC(n,e,Zc),r.endBeforeSet_=!0,r}function Wx(n,e){const t=n.copy();return t.index_=e,t}function LD(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Yt?t="$priority":n.index_===LN?t="$value":n.index_===sa?t="$key":(Ie(n.index_ instanceof MN,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Wn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Wn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Wn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Wn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Wn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function OD(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Yt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE extends H4{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Ie(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=vw("p:rest:"),this.listens_={}}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=vE.getListenId_(e,r),a={};this.listens_[o]=a;const c=LD(e._queryParams);this.restRequest_(s+".json",c,(d,h)=>{let m=h;if(d===404&&(m=null,d=null),d===null&&this.onDataUpdate_(s,m,!1,r),th(this.listens_,o)===a){let _;d?d===401?_="permission_denied":_="rest_error:"+d:_="ok",i(_,null)}})}unlisten(e,t){const r=vE.getListenId_(e,t);delete this.listens_[r]}get(e){const t=LD(e._queryParams),r=e._path.toString(),i=new wi;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Sh(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=a0(a.responseText)}catch{Fr("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Fr("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RQ{constructor(){this.rootNode_=Je.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(){return{value:null,children:new Map}}function $m(n,e,t){if(pt(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=ft(e);n.children.has(r)||n.children.set(r,EE());const i=n.children.get(r);e=Wt(e),$m(i,e,t)}}function iC(n,e){if(pt(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Yt,(r,i)=>{$m(n,new Vt(r),i)}),iC(n,e)}}else if(n.children.size>0){const t=ft(e);return e=Wt(e),n.children.has(t)&&iC(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function sC(n,e,t){n.value!==null?t(e,n.value):DQ(n,(r,i)=>{const s=new Vt(e.toString()+"/"+r);sC(i,s,t)})}function DQ(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MQ{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&dr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=10*1e3,LQ=30*1e3,OQ=300*1e3;class VQ{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new MQ(e);const r=VD+(LQ-VD)*Math.random();Uy(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;dr(e,(i,s)=>{s>0&&Yi(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Uy(this.reportStats_.bind(this),Math.floor(Math.random()*2*OQ))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zs;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Zs||(Zs={}));function VN(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function FN(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function UN(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Zs.ACK_USER_WRITE,this.source=VN()}operationForChild(e){if(pt(this.path)){if(this.affectedTree.value!=null)return Ie(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Vt(e));return new xE(kt(),t,this.revert)}}else return Ie(ft(this.path)===e,"operationForChild called for unrelated child."),new xE(Wt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,t){this.source=e,this.path=t,this.type=Zs.LISTEN_COMPLETE}operationForChild(e){return pt(this.path)?new w0(this.source,kt()):new w0(this.source,Wt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Zs.OVERWRITE}operationForChild(e){return pt(this.path)?new sh(this.source,kt(),this.snap.getImmediateChild(e)):new sh(this.source,Wt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Zs.MERGE}operationForChild(e){if(pt(this.path)){const t=this.children.subtree(new Vt(e));return t.isEmpty()?null:t.value?new sh(this.source,kt(),t.value):new om(this.source,kt(),t)}else return Ie(ft(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new om(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ft(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FQ{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function UQ(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(AQ(o.childName,o.snapshotNode))}),sy(n,i,"child_removed",e,r,t),sy(n,i,"child_added",e,r,t),sy(n,i,"child_moved",s,r,t),sy(n,i,"child_changed",e,r,t),sy(n,i,"value",e,r,t),i}function sy(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,c)=>HQ(n,a,c)),o.forEach(a=>{const c=BQ(n,a,s);i.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(c,n.query_))})})}function BQ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function HQ(n,e,t){if(e.childName==null||t.childName==null)throw Um("Should only compare child_ events.");const r=new _t(e.childName,e.snapshotNode),i=new _t(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n,e){return{eventCache:n,serverCache:e}}function By(n,e,t,r){return Kx(new tu(e,t,r),n.serverCache)}function Y4(n,e,t,r){return Kx(n.eventCache,new tu(e,t,r))}function TE(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function oh(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QA;const GQ=()=>(QA||(QA=new Xo(IK)),QA);class Qt{static fromObject(e){let t=new Qt(null);return dr(e,(r,i)=>{t=t.set(new Vt(r),i)}),t}constructor(e,t=GQ()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:kt(),value:this.value};if(pt(e))return null;{const r=ft(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Wt(e),t);return s!=null?{path:hn(new Vt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pt(e))return this;{const t=ft(e),r=this.children.get(t);return r!==null?r.subtree(Wt(e)):new Qt(null)}}set(e,t){if(pt(e))return new Qt(t,this.children);{const r=ft(e),s=(this.children.get(r)||new Qt(null)).set(Wt(e),t),o=this.children.insert(r,s);return new Qt(this.value,o)}}remove(e){if(pt(e))return this.children.isEmpty()?new Qt(null):new Qt(null,this.children);{const t=ft(e),r=this.children.get(t);if(r){const i=r.remove(Wt(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new Qt(null):new Qt(this.value,s)}else return this}}get(e){if(pt(e))return this.value;{const t=ft(e),r=this.children.get(t);return r?r.get(Wt(e)):null}}setTree(e,t){if(pt(e))return t;{const r=ft(e),s=(this.children.get(r)||new Qt(null)).setTree(Wt(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Qt(this.value,o)}}fold(e){return this.fold_(kt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(hn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,kt(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(pt(e))return null;{const s=ft(e),o=this.children.get(s);return o?o.findOnPath_(Wt(e),hn(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,kt(),t)}foreachOnPath_(e,t,r){if(pt(e))return this;{this.value&&r(t,this.value);const i=ft(e),s=this.children.get(i);return s?s.foreachOnPath_(Wt(e),hn(t,i),r):new Qt(null)}}foreach(e){this.foreach_(kt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(hn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.writeTree_=e}static empty(){return new eo(new Qt(null))}}function Hy(n,e,t){if(pt(e))return new eo(new Qt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Xr(i,e);return s=s.updateChild(o,t),new eo(n.writeTree_.set(i,s))}else{const i=new Qt(t),s=n.writeTree_.setTree(e,i);return new eo(s)}}}function oC(n,e,t){let r=n;return dr(t,(i,s)=>{r=Hy(r,hn(e,i),s)}),r}function FD(n,e){if(pt(e))return eo.empty();{const t=n.writeTree_.setTree(e,new Qt(null));return new eo(t)}}function aC(n,e){return Ph(n,e)!=null}function Ph(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Xr(t.path,e)):null}function UD(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Yt,(r,i)=>{e.push(new _t(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new _t(r,i.value))}),e}function qc(n,e){if(pt(e))return n;{const t=Ph(n,e);return t!=null?new eo(new Qt(t)):new eo(n.writeTree_.subtree(e))}}function lC(n){return n.writeTree_.isEmpty()}function am(n,e){return X4(kt(),n.writeTree_,e)}function X4(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(Ie(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=X4(hn(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(hn(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(n,e){return n3(e,n)}function jQ(n,e,t,r,i){Ie(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Hy(n.visibleWrites,e,t)),n.lastWriteId=r}function qQ(n,e,t,r){Ie(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=oC(n.visibleWrites,e,t),n.lastWriteId=r}function zQ(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function $Q(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);Ie(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&WQ(a,r.path)?i=!1:ws(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return KQ(n),!0;if(r.snap)n.visibleWrites=FD(n.visibleWrites,r.path);else{const a=r.children;dr(a,c=>{n.visibleWrites=FD(n.visibleWrites,hn(r.path,c))})}return!0}else return!1}function WQ(n,e){if(n.snap)return ws(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ws(hn(n.path,t),e))return!0;return!1}function KQ(n){n.visibleWrites=Z4(n.allWrites,QQ,kt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function QQ(n){return n.visible}function Z4(n,e,t){let r=eo.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)ws(t,o)?(a=Xr(t,o),r=Hy(r,a,s.snap)):ws(o,t)&&(a=Xr(o,t),r=Hy(r,kt(),s.snap.getChild(a)));else if(s.children){if(ws(t,o))a=Xr(t,o),r=oC(r,a,s.children);else if(ws(o,t))if(a=Xr(o,t),pt(a))r=oC(r,kt(),s.children);else{const c=th(s.children,ft(a));if(c){const d=c.getChild(Wt(a));r=Hy(r,kt(),d)}}}else throw Um("WriteRecord should have .snap or .children")}}return r}function e3(n,e,t,r,i){if(!r&&!i){const s=Ph(n.visibleWrites,e);if(s!=null)return s;{const o=qc(n.visibleWrites,e);if(lC(o))return t;if(t==null&&!aC(o,kt()))return null;{const a=t||Je.EMPTY_NODE;return am(o,a)}}}else{const s=qc(n.visibleWrites,e);if(!i&&lC(s))return t;if(!i&&t==null&&!aC(s,kt()))return null;{const o=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(ws(d.path,e)||ws(e,d.path))},a=Z4(n.allWrites,o,e),c=t||Je.EMPTY_NODE;return am(a,c)}}}function JQ(n,e,t){let r=Je.EMPTY_NODE;const i=Ph(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Yt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=qc(n.visibleWrites,e);return t.forEachChild(Yt,(o,a)=>{const c=am(qc(s,new Vt(o)),a);r=r.updateImmediateChild(o,c)}),UD(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=qc(n.visibleWrites,e);return UD(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function YQ(n,e,t,r,i){Ie(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=hn(e,t);if(aC(n.visibleWrites,s))return null;{const o=qc(n.visibleWrites,s);return lC(o)?i.getChild(t):am(o,i.getChild(t))}}function XQ(n,e,t,r){const i=hn(e,t),s=Ph(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=qc(n.visibleWrites,i);return am(o,r.getNode().getImmediateChild(t))}else return null}function ZQ(n,e){return Ph(n.visibleWrites,e)}function eJ(n,e,t,r,i,s,o){let a;const c=qc(n.visibleWrites,e),d=Ph(c,kt());if(d!=null)a=d;else if(t!=null)a=am(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],m=o.getCompare(),_=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let x=_.getNext();for(;x&&h.length<i;)m(x,r)!==0&&h.push(x),x=_.getNext();return h}else return[]}function tJ(){return{visibleWrites:eo.empty(),allWrites:[],lastWriteId:-1}}function IE(n,e,t,r){return e3(n.writeTree,n.treePath,e,t,r)}function BN(n,e){return JQ(n.writeTree,n.treePath,e)}function BD(n,e,t,r){return YQ(n.writeTree,n.treePath,e,t,r)}function AE(n,e){return ZQ(n.writeTree,hn(n.treePath,e))}function nJ(n,e,t,r,i,s){return eJ(n.writeTree,n.treePath,e,t,r,i,s)}function HN(n,e,t){return XQ(n.writeTree,n.treePath,e,t)}function t3(n,e){return n3(hn(n.treePath,e),n.writeTree)}function n3(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rJ{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;Ie(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Ie(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,g0(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,m0(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,sm(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,g0(r,e.snapshotNode,i.oldSnap));else throw Um("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iJ{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const r3=new iJ;class GN{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new tu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return HN(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:oh(this.viewCache_),s=nJ(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sJ(n){return{filter:n}}function oJ(n,e){Ie(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Ie(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function aJ(n,e,t,r,i){const s=new rJ;let o,a;if(t.type===Zs.OVERWRITE){const d=t;d.source.fromUser?o=cC(n,e,d.path,d.snap,r,i,s):(Ie(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!pt(d.path),o=bE(n,e,d.path,d.snap,r,i,a,s))}else if(t.type===Zs.MERGE){const d=t;d.source.fromUser?o=cJ(n,e,d.path,d.children,r,i,s):(Ie(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),o=uC(n,e,d.path,d.children,r,i,a,s))}else if(t.type===Zs.ACK_USER_WRITE){const d=t;d.revert?o=hJ(n,e,d.path,r,i,s):o=uJ(n,e,d.path,d.affectedTree,r,i,s)}else if(t.type===Zs.LISTEN_COMPLETE)o=dJ(n,e,t.path,r,s);else throw Um("Unknown operation type: "+t.type);const c=s.getChanges();return lJ(e,o,c),{viewCache:o,changes:c}}function lJ(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=TE(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(J4(TE(e)))}}function i3(n,e,t,r,i,s){const o=e.eventCache;if(AE(r,t)!=null)return e;{let a,c;if(pt(t))if(Ie(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=oh(e),h=d instanceof Je?d:Je.EMPTY_NODE,m=BN(r,h);a=n.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const d=IE(r,oh(e));a=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=ft(t);if(d===".priority"){Ie(eu(t)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const m=BD(r,t,h,c);m!=null?a=n.filter.updatePriority(h,m):a=o.getNode()}else{const h=Wt(t);let m;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const _=BD(r,t,o.getNode(),c);_!=null?m=o.getNode().getImmediateChild(d).updateChild(h,_):m=o.getNode().getImmediateChild(d)}else m=HN(r,d,e.serverCache);m!=null?a=n.filter.updateChild(o.getNode(),d,m,h,i,s):a=o.getNode()}}return By(e,a,o.isFullyInitialized()||pt(t),n.filter.filtersNodes())}}function bE(n,e,t,r,i,s,o,a){const c=e.serverCache;let d;const h=o?n.filter:n.filter.getIndexedFilter();if(pt(t))d=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){const x=c.getNode().updateChild(t,r);d=h.updateFullNode(c.getNode(),x,null)}else{const x=ft(t);if(!c.isCompleteForPath(t)&&eu(t)>1)return e;const b=Wt(t),N=c.getNode().getImmediateChild(x).updateChild(b,r);x===".priority"?d=h.updatePriority(c.getNode(),N):d=h.updateChild(c.getNode(),x,N,b,r3,null)}const m=Y4(e,d,c.isFullyInitialized()||pt(t),h.filtersNodes()),_=new GN(i,m,s);return i3(n,m,t,i,_,a)}function cC(n,e,t,r,i,s,o){const a=e.eventCache;let c,d;const h=new GN(i,e,s);if(pt(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=By(e,d,!0,n.filter.filtersNodes());else{const m=ft(t);if(m===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),c=By(e,d,a.isFullyInitialized(),a.isFiltered());else{const _=Wt(t),x=a.getNode().getImmediateChild(m);let b;if(pt(_))b=r;else{const A=h.getCompleteChild(m);A!=null?kN(_)===".priority"&&A.getChild(j4(_)).isEmpty()?b=A:b=A.updateChild(_,r):b=Je.EMPTY_NODE}if(x.equals(b))c=e;else{const A=n.filter.updateChild(a.getNode(),m,b,_,h,o);c=By(e,A,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function HD(n,e){return n.eventCache.isCompleteForChild(e)}function cJ(n,e,t,r,i,s,o){let a=e;return r.foreach((c,d)=>{const h=hn(t,c);HD(e,ft(h))&&(a=cC(n,a,h,d,i,s,o))}),r.foreach((c,d)=>{const h=hn(t,c);HD(e,ft(h))||(a=cC(n,a,h,d,i,s,o))}),a}function GD(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function uC(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;pt(t)?d=r:d=new Qt(null).setTree(t,r);const h=e.serverCache.getNode();return d.children.inorderTraversal((m,_)=>{if(h.hasChild(m)){const x=e.serverCache.getNode().getImmediateChild(m),b=GD(n,x,_);c=bE(n,c,new Vt(m),b,i,s,o,a)}}),d.children.inorderTraversal((m,_)=>{const x=!e.serverCache.isCompleteForChild(m)&&_.value===null;if(!h.hasChild(m)&&!x){const b=e.serverCache.getNode().getImmediateChild(m),A=GD(n,b,_);c=bE(n,c,new Vt(m),A,i,s,o,a)}}),c}function uJ(n,e,t,r,i,s,o){if(AE(i,t)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(pt(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return bE(n,e,t,c.getNode().getChild(t),i,s,a,o);if(pt(t)){let d=new Qt(null);return c.getNode().forEachChild(sa,(h,m)=>{d=d.set(new Vt(h),m)}),uC(n,e,t,d,i,s,a,o)}else return e}else{let d=new Qt(null);return r.foreach((h,m)=>{const _=hn(t,h);c.isCompleteForPath(_)&&(d=d.set(h,c.getNode().getChild(_)))}),uC(n,e,t,d,i,s,a,o)}}function dJ(n,e,t,r,i){const s=e.serverCache,o=Y4(e,s.getNode(),s.isFullyInitialized()||pt(t),s.isFiltered());return i3(n,o,t,r,r3,i)}function hJ(n,e,t,r,i,s){let o;if(AE(r,t)!=null)return e;{const a=new GN(r,e,i),c=e.eventCache.getNode();let d;if(pt(t)||ft(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=IE(r,oh(e));else{const m=e.serverCache.getNode();Ie(m instanceof Je,"serverChildren would be complete if leaf node"),h=BN(r,m)}h=h,d=n.filter.updateFullNode(c,h,s)}else{const h=ft(t);let m=HN(r,h,e.serverCache);m==null&&e.serverCache.isCompleteForChild(h)&&(m=c.getImmediateChild(h)),m!=null?d=n.filter.updateChild(c,h,m,Wt(t),a,s):e.eventCache.getNode().hasChild(h)?d=n.filter.updateChild(c,h,Je.EMPTY_NODE,Wt(t),a,s):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=IE(r,oh(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||AE(r,kt())!=null,By(e,d,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fJ{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new ON(r.getIndex()),s=CQ(r);this.processor_=sJ(s);const o=t.serverCache,a=t.eventCache,c=i.updateFullNode(Je.EMPTY_NODE,o.getNode(),null),d=s.updateFullNode(Je.EMPTY_NODE,a.getNode(),null),h=new tu(c,o.isFullyInitialized(),i.filtersNodes()),m=new tu(d,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Kx(m,h),this.eventGenerator_=new FQ(this.query_)}get query(){return this.query_}}function pJ(n){return n.viewCache_.serverCache.getNode()}function mJ(n){return TE(n.viewCache_)}function gJ(n,e){const t=oh(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!pt(e)&&!t.getImmediateChild(ft(e)).isEmpty())?t.getChild(e):null}function jD(n){return n.eventRegistrations_.length===0}function yJ(n,e){n.eventRegistrations_.push(e)}function qD(n,e,t){const r=[];if(t){Ie(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function zD(n,e,t,r){e.type===Zs.MERGE&&e.source.queryId!==null&&(Ie(oh(n.viewCache_),"We should always have a full cache before handling merges"),Ie(TE(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=aJ(n.processor_,i,e,t,r);return oJ(n.processor_,s.viewCache),Ie(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,s3(n,s.changes,s.viewCache.eventCache.getNode(),null)}function wJ(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Yt,(s,o)=>{r.push(sm(s,o))}),t.isFullyInitialized()&&r.push(J4(t.getNode())),s3(n,r,t.getNode(),e)}function s3(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return UQ(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CE;class o3{constructor(){this.views=new Map}}function _J(n){Ie(!CE,"__referenceConstructor has already been defined"),CE=n}function vJ(){return Ie(CE,"Reference.ts has not been loaded"),CE}function EJ(n){return n.views.size===0}function jN(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return Ie(s!=null,"SyncTree gave us an op for an invalid query."),zD(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(zD(o,e,t,r));return s}}function a3(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=IE(t,i?r:null),c=!1;a?c=!0:r instanceof Je?(a=BN(t,r),c=!1):(a=Je.EMPTY_NODE,c=!1);const d=Kx(new tu(a,c,!1),new tu(r,i,!1));return new fJ(e,d)}return o}function xJ(n,e,t,r,i,s){const o=a3(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),yJ(o,t),wJ(o,t)}function TJ(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const a=nu(n);if(i==="default")for(const[c,d]of n.views.entries())o=o.concat(qD(d,t,r)),jD(d)&&(n.views.delete(c),d.query._queryParams.loadsAllData()||s.push(d.query));else{const c=n.views.get(i);c&&(o=o.concat(qD(c,t,r)),jD(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!nu(n)&&s.push(new(vJ())(e._repo,e._path)),{removed:s,events:o}}function l3(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function zc(n,e){let t=null;for(const r of n.views.values())t=t||gJ(r,e);return t}function c3(n,e){if(e._queryParams.loadsAllData())return Jx(n);{const r=e._queryIdentifier;return n.views.get(r)}}function u3(n,e){return c3(n,e)!=null}function nu(n){return Jx(n)!=null}function Jx(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SE;function IJ(n){Ie(!SE,"__referenceConstructor has already been defined"),SE=n}function AJ(){return Ie(SE,"Reference.ts has not been loaded"),SE}let bJ=1;class $D{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qt(null),this.pendingWriteTree_=tJ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function qN(n,e,t,r,i){return jQ(n.pendingWriteTree_,e,t,r,i),i?Wm(n,new sh(VN(),e,t)):[]}function CJ(n,e,t,r){qQ(n.pendingWriteTree_,e,t,r);const i=Qt.fromObject(t);return Wm(n,new om(VN(),e,i))}function Fc(n,e,t=!1){const r=zQ(n.pendingWriteTree_,e);if($Q(n.pendingWriteTree_,e)){let s=new Qt(null);return r.snap!=null?s=s.set(kt(),!0):dr(r.children,o=>{s=s.set(new Vt(o),!0)}),Wm(n,new xE(r.path,s,t))}else return[]}function xw(n,e,t){return Wm(n,new sh(FN(),e,t))}function SJ(n,e,t){const r=Qt.fromObject(t);return Wm(n,new om(FN(),e,r))}function NJ(n,e){return Wm(n,new w0(FN(),e))}function kJ(n,e,t){const r=zN(n,t);if(r){const i=$N(r),s=i.path,o=i.queryId,a=Xr(s,e),c=new w0(UN(o),a);return WN(n,s,c)}else return[]}function NE(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||u3(o,e))){const c=TJ(o,e,t,r);EJ(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const d=c.removed;if(a=c.events,!i){const h=d.findIndex(_=>_._queryParams.loadsAllData())!==-1,m=n.syncPointTree_.findOnPath(s,(_,x)=>nu(x));if(h&&!m){const _=n.syncPointTree_.subtree(s);if(!_.isEmpty()){const x=DJ(_);for(let b=0;b<x.length;++b){const A=x[b],N=A.query,F=p3(n,A);n.listenProvider_.startListening(Gy(N),_0(n,N),F.hashFn,F.onComplete)}}}!m&&d.length>0&&!r&&(h?n.listenProvider_.stopListening(Gy(e),null):d.forEach(_=>{const x=n.queryToTagMap.get(Xx(_));n.listenProvider_.stopListening(Gy(_),x)}))}MJ(n,d)}return a}function d3(n,e,t,r){const i=zN(n,r);if(i!=null){const s=$N(i),o=s.path,a=s.queryId,c=Xr(o,e),d=new sh(UN(a),c,t);return WN(n,o,d)}else return[]}function PJ(n,e,t,r){const i=zN(n,r);if(i){const s=$N(i),o=s.path,a=s.queryId,c=Xr(o,e),d=Qt.fromObject(t),h=new om(UN(a),c,d);return WN(n,o,h)}else return[]}function dC(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(_,x)=>{const b=Xr(_,i);s=s||zc(x,b),o=o||nu(x)});let a=n.syncPointTree_.get(i);a?(o=o||nu(a),s=s||zc(a,kt())):(a=new o3,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=Je.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((x,b)=>{const A=zc(b,kt());A&&(s=s.updateImmediateChild(x,A))}));const d=u3(a,e);if(!d&&!e._queryParams.loadsAllData()){const _=Xx(e);Ie(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const x=LJ();n.queryToTagMap.set(_,x),n.tagToQueryMap.set(x,_)}const h=Qx(n.pendingWriteTree_,i);let m=xJ(a,e,t,h,s,c);if(!d&&!o&&!r){const _=c3(a,e);m=m.concat(OJ(n,e,_))}return m}function Yx(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const c=Xr(o,e),d=zc(a,c);if(d)return d});return e3(i,e,s,t,!0)}function RJ(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(d,h)=>{const m=Xr(d,t);r=r||zc(h,m)});let i=n.syncPointTree_.get(t);i?r=r||zc(i,kt()):(i=new o3,n.syncPointTree_=n.syncPointTree_.set(t,i));const s=r!=null,o=s?new tu(r,!0,!1):null,a=Qx(n.pendingWriteTree_,e._path),c=a3(i,e,a,s?o.getNode():Je.EMPTY_NODE,s);return mJ(c)}function Wm(n,e){return h3(e,n.syncPointTree_,null,Qx(n.pendingWriteTree_,kt()))}function h3(n,e,t,r){if(pt(n.path))return f3(n,e,t,r);{const i=e.get(kt());t==null&&i!=null&&(t=zc(i,kt()));let s=[];const o=ft(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){const d=t?t.getImmediateChild(o):null,h=t3(r,o);s=s.concat(h3(a,c,d,h))}return i&&(s=s.concat(jN(i,n,r,t))),s}}function f3(n,e,t,r){const i=e.get(kt());t==null&&i!=null&&(t=zc(i,kt()));let s=[];return e.children.inorderTraversal((o,a)=>{const c=t?t.getImmediateChild(o):null,d=t3(r,o),h=n.operationForChild(o);h&&(s=s.concat(f3(h,a,c,d)))}),i&&(s=s.concat(jN(i,n,r,t))),s}function p3(n,e){const t=e.query,r=_0(n,t);return{hashFn:()=>(pJ(e)||Je.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?kJ(n,t._path,r):NJ(n,t._path);{const s=CK(i,t);return NE(n,t,null,s)}}}}function _0(n,e){const t=Xx(e);return n.queryToTagMap.get(t)}function Xx(n){return n._path.toString()+"$"+n._queryIdentifier}function zN(n,e){return n.tagToQueryMap.get(e)}function $N(n){const e=n.indexOf("$");return Ie(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Vt(n.substr(0,e))}}function WN(n,e,t){const r=n.syncPointTree_.get(e);Ie(r,"Missing sync point for query tag that we're tracking");const i=Qx(n.pendingWriteTree_,e);return jN(r,t,i,null)}function DJ(n){return n.fold((e,t,r)=>{if(t&&nu(t))return[Jx(t)];{let i=[];return t&&(i=l3(t)),dr(r,(s,o)=>{i=i.concat(o)}),i}})}function Gy(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(AJ())(n._repo,n._path):n}function MJ(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=Xx(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function LJ(){return bJ++}function OJ(n,e,t){const r=e._path,i=_0(n,e),s=p3(n,t),o=n.listenProvider_.startListening(Gy(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)Ie(!nu(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((d,h,m)=>{if(!pt(d)&&h&&nu(h))return[Jx(h).query];{let _=[];return h&&(_=_.concat(l3(h).map(x=>x.query))),dr(m,(x,b)=>{_=_.concat(b)}),_}});for(let d=0;d<c.length;++d){const h=c[d];n.listenProvider_.stopListening(Gy(h),_0(n,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new KN(t)}node(){return this.node_}}class QN{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=hn(this.path_,e);return new QN(this.syncTree_,t)}node(){return Yx(this.syncTree_,this.path_)}}const VJ=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},WD=function(n,e,t){if(!n||typeof n!="object")return n;if(Ie(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return FJ(n[".sv"],e,t);if(typeof n[".sv"]=="object")return UJ(n[".sv"],e);Ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},FJ=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:Ie(!1,"Unexpected server value: "+n)}},UJ=function(n,e,t){n.hasOwnProperty("increment")||Ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&Ie(!1,"Unexpected increment value: "+r);const i=e.node();if(Ie(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},m3=function(n,e,t,r){return YN(e,new QN(t,n),r)},JN=function(n,e,t){return YN(n,new KN(e),t)};function YN(n,e,t){const r=n.getPriority().val(),i=WD(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=WD(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new nr(a,vn(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new nr(i))),o.forEachChild(Yt,(a,c)=>{const d=YN(c,e.getImmediateChild(a),t);d!==c&&(s=s.updateImmediateChild(a,d))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Zx(n,e){let t=e instanceof Vt?e:new Vt(e),r=n,i=ft(t);for(;i!==null;){const s=th(r.node.children,i)||{children:{},childCount:0};r=new XN(i,r,s),t=Wt(t),i=ft(t)}return r}function Rh(n){return n.node.value}function ZN(n,e){n.node.value=e,hC(n)}function g3(n){return n.node.childCount>0}function BJ(n){return Rh(n)===void 0&&!g3(n)}function eT(n,e){dr(n.node.children,(t,r)=>{e(new XN(t,n,r))})}function y3(n,e,t,r){t&&e(n),eT(n,i=>{y3(i,e,!0)})}function HJ(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Tw(n){return new Vt(n.parent===null?n.name:Tw(n.parent)+"/"+n.name)}function hC(n){n.parent!==null&&GJ(n.parent,n.name,n)}function GJ(n,e,t){const r=BJ(t),i=Yi(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,hC(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,hC(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jJ=/[\[\].#$\/\u0000-\u001F\u007F]/,qJ=/[\[\].#$\u0000-\u001F\u007F]/,JA=10*1024*1024,tT=function(n){return typeof n=="string"&&n.length!==0&&!jJ.test(n)},w3=function(n){return typeof n=="string"&&n.length!==0&&!qJ.test(n)},zJ=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),w3(n)},v0=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!qx(n)||n&&typeof n=="object"&&Yi(n,".sv")},fa=function(n,e,t,r){r&&e===void 0||Iw(xi(n,"value"),e,t)},Iw=function(n,e,t){const r=t instanceof Vt?new aQ(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+rd(r));if(typeof e=="function")throw new Error(n+"contains a function "+rd(r)+" with contents = "+e.toString());if(qx(e))throw new Error(n+"contains "+e.toString()+" "+rd(r));if(typeof e=="string"&&e.length>JA/3&&Px(e)>JA)throw new Error(n+"contains a string greater than "+JA+" utf8 bytes "+rd(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(dr(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!tT(o)))throw new Error(n+" contains an invalid key ("+o+") "+rd(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);lQ(r,o),Iw(n,a,r),cQ(r)}),i&&s)throw new Error(n+' contains ".value" child '+rd(r)+" in addition to actual children.")}},$J=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=p0(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!tT(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(oQ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&ws(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},_3=function(n,e,t,r){const i=xi(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];dr(e,(o,a)=>{const c=new Vt(o);if(Iw(i,a,hn(t,c)),kN(c)===".priority"&&!v0(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),$J(i,s)},e1=function(n,e,t){if(qx(e))throw new Error(xi(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!v0(e))throw new Error(xi(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Aw=function(n,e,t,r){if(t!==void 0&&!tT(t))throw new Error(xi(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},E0=function(n,e,t,r){if(!w3(t))throw new Error(xi(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},WJ=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),E0(n,e,t)},_s=function(n,e){if(ft(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},v3=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!tT(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!zJ(t))throw new Error(xi(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KJ{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function nT(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!PN(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function E3(n,e,t){nT(n,t),x3(n,r=>PN(r,e))}function Xi(n,e,t){nT(n,t),x3(n,r=>ws(r,e)||ws(e,r))}function x3(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(QJ(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function QJ(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Jd&&lr("event: "+t.toString()),zm(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3="repo_interrupt",JJ=25;class YJ{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new KJ,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=EE(),this.transactionQueueTree_=new XN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function XJ(n,e,t){if(n.stats_=SN(n.repoInfo_),n.forceRestClient_||PK())n.server_=new vE(n.repoInfo_,(r,i,s,o)=>{KD(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>QD(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Wn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new al(n.repoInfo_,e,(r,i,s,o)=>{KD(n,r,i,s,o)},r=>{QD(n,r)},r=>{ZJ(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=OK(n.repoInfo_,()=>new VQ(n.stats_,n.server_)),n.infoData_=new RQ,n.infoSyncTree_=new $D({startListening:(r,i,s,o)=>{let a=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=xw(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),t1(n,"connected",!1),n.serverSyncTree_=new $D({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{const d=o(a,c);Xi(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function I3(n){const t=n.infoData_.getNode(new Vt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function bw(n){return VJ({timestamp:I3(n)})}function KD(n,e,t,r,i){n.dataUpdateCount++;const s=new Vt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=cE(t,d=>vn(d));o=PJ(n.serverSyncTree_,s,c,i)}else{const c=vn(t);o=d3(n.serverSyncTree_,s,c,i)}else if(r){const c=cE(t,d=>vn(d));o=SJ(n.serverSyncTree_,s,c)}else{const c=vn(t);o=xw(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=lm(n,s)),Xi(n.eventQueue_,a,o)}function QD(n,e){t1(n,"connected",e),e===!1&&nY(n)}function ZJ(n,e){dr(e,(t,r)=>{t1(n,t,r)})}function t1(n,e,t){const r=new Vt("/.info/"+e),i=vn(t);n.infoData_.updateSnapshot(r,i);const s=xw(n.infoSyncTree_,r,i);Xi(n.eventQueue_,r,s)}function rT(n){return n.nextWriteId_++}function eY(n,e,t){const r=RJ(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{const s=vn(i).withIndex(e._queryParams.getIndex());dC(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=xw(n.serverSyncTree_,e._path,s);else{const a=_0(n.serverSyncTree_,e);o=d3(n.serverSyncTree_,e._path,s,a)}return Xi(n.eventQueue_,e._path,o),NE(n.serverSyncTree_,e,t,null,!0),s},i=>(Km(n,"get for query "+Wn(e)+" failed: "+i),Promise.reject(new Error(i))))}function n1(n,e,t,r,i){Km(n,"set",{path:e.toString(),value:t,priority:r});const s=bw(n),o=vn(t,r),a=Yx(n.serverSyncTree_,e),c=JN(o,a,s),d=rT(n),h=qN(n.serverSyncTree_,e,c,d,!0);nT(n.eventQueue_,h),n.server_.put(e.toString(),o.val(!0),(_,x)=>{const b=_==="ok";b||Fr("set at "+e+" failed: "+_);const A=Fc(n.serverSyncTree_,d,!b);Xi(n.eventQueue_,e,A),ru(n,i,_,x)});const m=i1(n,e);lm(n,m),Xi(n.eventQueue_,m,[])}function tY(n,e,t,r){Km(n,"update",{path:e.toString(),value:t});let i=!0;const s=bw(n),o={};if(dr(t,(a,c)=>{i=!1,o[a]=m3(hn(e,a),vn(c),n.serverSyncTree_,s)}),i)lr("update() called with empty data.  Don't do anything."),ru(n,r,"ok",void 0);else{const a=rT(n),c=CJ(n.serverSyncTree_,e,o,a);nT(n.eventQueue_,c),n.server_.merge(e.toString(),t,(d,h)=>{const m=d==="ok";m||Fr("update at "+e+" failed: "+d);const _=Fc(n.serverSyncTree_,a,!m),x=_.length>0?lm(n,e):e;Xi(n.eventQueue_,x,_),ru(n,r,d,h)}),dr(t,d=>{const h=i1(n,hn(e,d));lm(n,h)}),Xi(n.eventQueue_,e,[])}}function nY(n){Km(n,"onDisconnectEvents");const e=bw(n),t=EE();sC(n.onDisconnect_,kt(),(i,s)=>{const o=m3(i,s,n.serverSyncTree_,e);$m(t,i,o)});let r=[];sC(t,kt(),(i,s)=>{r=r.concat(xw(n.serverSyncTree_,i,s));const o=i1(n,i);lm(n,o)}),n.onDisconnect_=EE(),Xi(n.eventQueue_,kt(),r)}function rY(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&iC(n.onDisconnect_,e),ru(n,t,r,i)})}function JD(n,e,t,r){const i=vn(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&$m(n.onDisconnect_,e,i),ru(n,r,s,o)})}function iY(n,e,t,r,i){const s=vn(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&$m(n.onDisconnect_,e,s),ru(n,i,o,a)})}function sY(n,e,t,r){if(lE(t)){lr("onDisconnect().update() called with empty data.  Don't do anything."),ru(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&dr(t,(o,a)=>{const c=vn(a);$m(n.onDisconnect_,hn(e,o),c)}),ru(n,r,i,s)})}function oY(n,e,t){let r;ft(e._path)===".info"?r=dC(n.infoSyncTree_,e,t):r=dC(n.serverSyncTree_,e,t),E3(n.eventQueue_,e._path,r)}function fC(n,e,t){let r;ft(e._path)===".info"?r=NE(n.infoSyncTree_,e,t):r=NE(n.serverSyncTree_,e,t),E3(n.eventQueue_,e._path,r)}function A3(n){n.persistentConnection_&&n.persistentConnection_.interrupt(T3)}function aY(n){n.persistentConnection_&&n.persistentConnection_.resume(T3)}function Km(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),lr(t,...e)}function ru(n,e,t,r){e&&zm(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function lY(n,e,t,r,i,s){Km(n,"transaction on "+e);const o={path:e,update:t,onComplete:r,status:null,order:v4(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=r1(n,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Iw("transaction failed: Data returned ",c,o.path),o.status=0;const d=Zx(n.transactionQueueTree_,e),h=Rh(d)||[];h.push(o),ZN(d,h);let m;typeof c=="object"&&c!==null&&Yi(c,".priority")?(m=th(c,".priority"),Ie(v0(m),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):m=(Yx(n.serverSyncTree_,e)||Je.EMPTY_NODE).getPriority().val();const _=bw(n),x=vn(c,m),b=JN(x,a,_);o.currentOutputSnapshotRaw=x,o.currentOutputSnapshotResolved=b,o.currentWriteId=rT(n);const A=qN(n.serverSyncTree_,e,b,o.currentWriteId,o.applyLocally);Xi(n.eventQueue_,e,A),iT(n,n.transactionQueueTree_)}}function r1(n,e,t){return Yx(n.serverSyncTree_,e,t)||Je.EMPTY_NODE}function iT(n,e=n.transactionQueueTree_){if(e||sT(n,e),Rh(e)){const t=C3(n,e);Ie(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&cY(n,Tw(e),t)}else g3(e)&&eT(e,t=>{iT(n,t)})}function cY(n,e,t){const r=t.map(d=>d.currentWriteId),i=r1(n,e,r);let s=i;const o=i.hash();for(let d=0;d<t.length;d++){const h=t[d];Ie(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const m=Xr(e,h.path);s=s.updateChild(m,h.currentOutputSnapshotRaw)}const a=s.val(!0),c=e;n.server_.put(c.toString(),a,d=>{Km(n,"transaction put response",{path:c.toString(),status:d});let h=[];if(d==="ok"){const m=[];for(let _=0;_<t.length;_++)t[_].status=2,h=h.concat(Fc(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&m.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();sT(n,Zx(n.transactionQueueTree_,e)),iT(n,n.transactionQueueTree_),Xi(n.eventQueue_,e,h);for(let _=0;_<m.length;_++)zm(m[_])}else{if(d==="datastale")for(let m=0;m<t.length;m++)t[m].status===3?t[m].status=4:t[m].status=0;else{Fr("transaction at "+c.toString()+" failed: "+d);for(let m=0;m<t.length;m++)t[m].status=4,t[m].abortReason=d}lm(n,e)}},o)}function lm(n,e){const t=b3(n,e),r=Tw(t),i=C3(n,t);return uY(n,i,r),r}function uY(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],d=Xr(t,c.path);let h=!1,m;if(Ie(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,m=c.abortReason,i=i.concat(Fc(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=JJ)h=!0,m="maxretry",i=i.concat(Fc(n.serverSyncTree_,c.currentWriteId,!0));else{const _=r1(n,c.path,o);c.currentInputSnapshot=_;const x=e[a].update(_.val());if(x!==void 0){Iw("transaction failed: Data returned ",x,c.path);let b=vn(x);typeof x=="object"&&x!=null&&Yi(x,".priority")||(b=b.updatePriority(_.getPriority()));const N=c.currentWriteId,F=bw(n),B=JN(b,_,F);c.currentOutputSnapshotRaw=b,c.currentOutputSnapshotResolved=B,c.currentWriteId=rT(n),o.splice(o.indexOf(N),1),i=i.concat(qN(n.serverSyncTree_,c.path,B,c.currentWriteId,c.applyLocally)),i=i.concat(Fc(n.serverSyncTree_,N,!0))}else h=!0,m="nodata",i=i.concat(Fc(n.serverSyncTree_,c.currentWriteId,!0))}Xi(n.eventQueue_,t,i),i=[],h&&(e[a].status=2,(function(_){setTimeout(_,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(m==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(m),!1,null))))}sT(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)zm(r[a]);iT(n,n.transactionQueueTree_)}function b3(n,e){let t,r=n.transactionQueueTree_;for(t=ft(e);t!==null&&Rh(r)===void 0;)r=Zx(r,t),e=Wt(e),t=ft(e);return r}function C3(n,e){const t=[];return S3(n,e,t),t.sort((r,i)=>r.order-i.order),t}function S3(n,e,t){const r=Rh(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);eT(e,i=>{S3(n,i,t)})}function sT(n,e){const t=Rh(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,ZN(e,t.length>0?t:void 0)}eT(e,r=>{sT(n,r)})}function i1(n,e){const t=Tw(b3(n,e)),r=Zx(n.transactionQueueTree_,e);return HJ(r,i=>{YA(n,i)}),YA(n,r),y3(r,i=>{YA(n,i)}),t}function YA(n,e){const t=Rh(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(Ie(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(Ie(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Fc(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ZN(e,void 0):t.length=s+1,Xi(n.eventQueue_,Tw(e),i);for(let o=0;o<r.length;o++)zm(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dY(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function hY(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Fr(`Invalid query segment '${t}' in query '${n}'`)}return e}const pC=function(n,e){const t=fY(n),r=t.namespace;t.domain==="firebase.com"&&ha(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ha("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||xK();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new M4(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Vt(t.pathString)}},fY=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(a=n.substring(0,d-1),n=n.substring(d+2));let h=n.indexOf("/");h===-1&&(h=n.length);let m=n.indexOf("?");m===-1&&(m=n.length),e=n.substring(0,Math.min(h,m)),h<m&&(i=dY(n.substring(h,m)));const _=hY(n.substring(Math.min(n.length,m)));d=e.indexOf(":"),d>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const x=e.slice(0,d);if(x.toLowerCase()==="localhost")t="localhost";else if(x.split(".").length<=2)t=x;else{const b=e.indexOf(".");r=e.substring(0,b).toLowerCase(),t=e.substring(b+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",pY=(function(){let n=0;const e=[];return function(t){const r=t===n;n=t;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=YD.charAt(t%64),t=Math.floor(t/64);Ie(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=YD.charAt(e[i]);return Ie(o.length===20,"nextPushId: Length should be 20."),o}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Wn(this.snapshot.exportVal())}}class k3{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Ie(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mY=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new wi;return rY(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){_s("OnDisconnect.remove",this._path);const e=new wi;return JD(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){_s("OnDisconnect.set",this._path),fa("OnDisconnect.set",e,this._path,!1);const t=new wi;return JD(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){_s("OnDisconnect.setWithPriority",this._path),fa("OnDisconnect.setWithPriority",e,this._path,!1),e1("OnDisconnect.setWithPriority",t);const r=new wi;return iY(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){_s("OnDisconnect.update",this._path),_3("OnDisconnect.update",e,this._path);const t=new wi;return sY(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return pt(this._path)?null:kN(this._path)}get ref(){return new As(this._repo,this._path)}get _queryIdentifier(){const e=OD(this._queryParams),t=bN(e);return t==="{}"?"default":t}get _queryObject(){return OD(this._queryParams)}isEqual(e){if(e=Fe(e),!(e instanceof bi))return!1;const t=this._repo===e._repo,r=PN(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+sQ(this._path)}}function oT(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function yu(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===sa){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Zc)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==pl)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Yt){if(e!=null&&!v0(e)||t!=null&&!v0(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ie(n.getIndex()instanceof MN||n.getIndex()===LN,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function aT(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class As extends bi{constructor(e,t){super(e,t,new $x,!1)}get parent(){const e=j4(this._path);return e===null?null:new As(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let lT=class mC{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Vt(e),r=ah(this.ref,e);return new mC(this._node.getChild(t),r,Yt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new mC(i,ah(this.ref,r),Yt)))}hasChild(e){const t=new Vt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function P3(n,e){return n=Fe(n),n._checkNotDeleted("ref"),e!==void 0?ah(n._root,e):n._root}function XD(n,e){n=Fe(n),n._checkNotDeleted("refFromURL");const t=pC(e,n._repo.repoInfo_.nodeAdmin);v3("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ha("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),P3(n,t.path.toString())}function ah(n,e){return n=Fe(n),ft(n._path)===null?WJ("child","path",e):E0("child","path",e),new As(n._repo,hn(n._path,e))}function gY(n,e){n=Fe(n),_s("push",n._path),fa("push",e,n._path,!0);const t=I3(n._repo),r=pY(t),i=ah(n,r),s=ah(n,r);let o;return e!=null?o=o1(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function yY(n){return _s("remove",n._path),o1(n,null)}function o1(n,e){n=Fe(n),_s("set",n._path),fa("set",e,n._path,!1);const t=new wi;return n1(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function wY(n,e){n=Fe(n),_s("setPriority",n._path),e1("setPriority",e);const t=new wi;return n1(n._repo,hn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function _Y(n,e,t){if(_s("setWithPriority",n._path),fa("setWithPriority",e,n._path,!1),e1("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new wi;return n1(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function vY(n,e){_3("update",e,n._path);const t=new wi;return tY(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function EY(n){n=Fe(n);const e=new s1(()=>{}),t=new Cw(e);return eY(n._repo,n,t).then(r=>new lT(r,new As(n._repo,n._path),n._queryParams.getIndex()))}class Cw{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new N3("value",this,new lT(e.snapshotNode,new As(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new k3(this,e,t):null}matches(e){return e instanceof Cw?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class cT{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new k3(this,e,t):null}createEvent(e,t){Ie(e.childName!=null,"Child events should have a childName.");const r=ah(new As(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new N3(e.type,this,new lT(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof cT?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Sw(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const c=t,d=(h,m)=>{fC(n._repo,n,a),c(h,m)};d.userCallback=t.userCallback,d.context=t.context,t=d}const o=new s1(t,s||void 0),a=e==="value"?new Cw(o):new cT(e,o);return oY(n._repo,n,a),()=>fC(n._repo,n,a)}function gC(n,e,t,r){return Sw(n,"value",e,t,r)}function ZD(n,e,t,r){return Sw(n,"child_added",e,t,r)}function eM(n,e,t,r){return Sw(n,"child_changed",e,t,r)}function tM(n,e,t,r){return Sw(n,"child_moved",e,t,r)}function nM(n,e,t,r){return Sw(n,"child_removed",e,t,r)}function rM(n,e,t){let r=null;const i=t?new s1(t):null;e==="value"?r=new Cw(i):e&&(r=new cT(e,i)),fC(n._repo,n,r)}let oo=class{},R3=class extends oo{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){fa("endAt",this._value,e._path,!0);const t=rC(e._queryParams,this._value,this._key);if(aT(t),yu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}};function xY(n,e){return Aw("endAt","key",e),new R3(n,e)}class TY extends oo{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){fa("endBefore",this._value,e._path,!1);const t=PQ(e._queryParams,this._value,this._key);if(aT(t),yu(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function IY(n,e){return Aw("endBefore","key",e),new TY(n,e)}let D3=class extends oo{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){fa("startAt",this._value,e._path,!0);const t=nC(e._queryParams,this._value,this._key);if(aT(t),yu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}};function AY(n=null,e){return Aw("startAt","key",e),new D3(n,e)}class bY extends oo{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){fa("startAfter",this._value,e._path,!1);const t=kQ(e._queryParams,this._value,this._key);if(aT(t),yu(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function CY(n,e){return Aw("startAfter","key",e),new bY(n,e)}class SY extends oo{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,SQ(e._queryParams,this._limit),e._orderByCalled)}}function NY(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new SY(n)}class kY extends oo{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,NQ(e._queryParams,this._limit),e._orderByCalled)}}function PY(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new kY(n)}class RY extends oo{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){oT(e,"orderByChild");const t=new Vt(this._path);if(pt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new MN(t),i=Wx(e._queryParams,r);return yu(i),new bi(e._repo,e._path,i,!0)}}function DY(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return E0("orderByChild","path",n),new RY(n)}class MY extends oo{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){oT(e,"orderByKey");const t=Wx(e._queryParams,sa);return yu(t),new bi(e._repo,e._path,t,!0)}}function LY(){return new MY}class OY extends oo{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){oT(e,"orderByPriority");const t=Wx(e._queryParams,Yt);return yu(t),new bi(e._repo,e._path,t,!0)}}function VY(){return new OY}class FY extends oo{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){oT(e,"orderByValue");const t=Wx(e._queryParams,LN);return yu(t),new bi(e._repo,e._path,t,!0)}}function UY(){return new FY}class BY extends oo{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(fa("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new R3(this._value,this._key)._apply(new D3(this._value,this._key)._apply(e))}}function HY(n,e){return Aw("equalTo","key",e),new BY(n,e)}function Bs(n,...e){let t=Fe(n);for(const r of e)t=r._apply(t);return t}_J(As);IJ(As);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GY="FIREBASE_DATABASE_EMULATOR_HOST",yC={};let jY=!1;function qY(n,e,t,r){const i=e.lastIndexOf(":"),s=e.substring(0,i),o=mu(s);n.repoInfo_=new M4(e,o,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function M3(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ha("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),lr("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=pC(s,i),a=o.repoInfo,c,d;typeof process<"u"&&wD&&(d=wD[GY]),d?(c=!0,s=`http://${d}?ns=${a.namespace}`,o=pC(s,i),a=o.repoInfo):c=!o.repoInfo.secure;const h=i&&c?new np(np.OWNER):new DK(n.name,n.options,e);v3("Invalid Firebase Database URL",o),pt(o.path)||ha("Database URL must point to the root of a Firebase Database (not including a child path).");const m=$Y(a,n,h,new RK(n,t));return new WY(m,n)}function zY(n,e){const t=yC[e];(!t||t[n.key]!==n)&&ha(`Database ${e}(${n.repoInfo_}) has already been deleted.`),A3(n),delete t[n.key]}function $Y(n,e,t,r){let i=yC[e.name];i||(i={},yC[e.name]=i);let s=i[n.toURLString()];return s&&ha("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new YJ(n,jY,t,r),i[n.toURLString()]=s,s}let WY=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(XJ(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new As(this._repo,kt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(zY(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ha("Cannot call "+e+" on a deleted database.")}};function L3(){im.IS_TRANSPORT_INITIALIZED&&Fr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function KY(){L3(),Vc.forceDisallow()}function QY(){L3(),ys.forceDisallow(),Vc.forceAllow()}function JY(n,e,t,r={}){n=Fe(n),n._checkNotDeleted("useEmulator");const i=`${e}:${t}`,s=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&dl(r,s.repoInfo_.emulatorOptions))return;ha("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&ha('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new np(np.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:eF(r.mockUserToken,n.app.options.projectId);o=new np(a)}mu(e)&&(YS(e),XS("Database",!0)),qY(s,i,r,o)}function YY(n){n=Fe(n),n._checkNotDeleted("goOffline"),A3(n._repo)}function XY(n){n=Fe(n),n._checkNotDeleted("goOnline"),aY(n._repo)}function ZY(n,e){x4(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eX(n){w4(vl),Ii(new qn("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return M3(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Er(_D,vD,n),Er(_D,vD,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tX={".sv":"timestamp"};function nX(){return tX}function rX(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iX=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function sX(n,e,t){if(n=Fe(n),_s("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=(t==null?void 0:t.applyLocally)??!0,i=new wi,s=(a,c,d)=>{let h=null;a?i.reject(a):(h=new lT(d,new As(n._repo,n._path),Yt),i.resolve(new iX(c,h)))},o=gC(n,()=>{});return lY(n._repo,n._path,e,s,o,r),i.promise}al.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};al.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};eX();const oX="@firebase/database-compat",aX="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lX=new Bm("@firebase/database-compat"),O3=function(n){const e="FIREBASE WARNING: "+n;lX.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX=function(n,e,t,r){if(t!==void 0&&typeof t!="boolean")throw new Error(xi(n,e)+"must be a boolean.")},uX=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(xi(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dX{constructor(e){this._delegate=e}cancel(e){Ze("OnDisconnect.cancel",0,1,arguments.length),sr("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){Ze("OnDisconnect.remove",0,1,arguments.length),sr("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){Ze("OnDisconnect.set",1,2,arguments.length),sr("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){Ze("OnDisconnect.setWithPriority",2,3,arguments.length),sr("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(Ze("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,O3("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}sr("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hX{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Ze("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t){this._database=e,this._delegate=t}val(){return Ze("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Ze("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Ze("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Ze("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Ze("DataSnapshot.child",0,1,arguments.length),e=String(e),E0("DataSnapshot.child","path",e),new $c(this._database,this._delegate.child(e))}hasChild(e){return Ze("DataSnapshot.hasChild",1,1,arguments.length),E0("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return Ze("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Ze("DataSnapshot.forEach",1,1,arguments.length),sr("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new $c(this._database,t)))}hasChildren(){return Ze("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Ze("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Ze("DataSnapshot.ref",0,0,arguments.length),new Ki(this._database,this._delegate.ref)}get ref(){return this.getRef()}}let V3=class zr{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var c;Ze("Query.on",2,4,arguments.length),sr("Query.on","callback",t,!1);const s=zr.getCancelAndContextArgs_("Query.on",r,i),o=(d,h)=>{t.call(s.context,new $c(this.database,d),h)};o.userCallback=t,o.context=s.context;const a=(c=s.cancel)==null?void 0:c.bind(s.context);switch(e){case"value":return gC(this._delegate,o,a),t;case"child_added":return ZD(this._delegate,o,a),t;case"child_removed":return nM(this._delegate,o,a),t;case"child_changed":return eM(this._delegate,o,a),t;case"child_moved":return tM(this._delegate,o,a),t;default:throw new Error(xi("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(Ze("Query.off",0,3,arguments.length),uX("Query.off",e),sr("Query.off","callback",t,!0),B2("Query.off","context",r),t){const i=()=>{};i.userCallback=t,i.context=r,rM(this._delegate,e,i)}else rM(this._delegate,e)}get(){return EY(this._delegate).then(e=>new $c(this.database,e))}once(e,t,r,i){Ze("Query.once",1,4,arguments.length),sr("Query.once","callback",t,!0);const s=zr.getCancelAndContextArgs_("Query.once",r,i),o=new wi,a=(d,h)=>{const m=new $c(this.database,d);t&&t.call(s.context,m,h),o.resolve(m)};a.userCallback=t,a.context=s.context;const c=d=>{s.cancel&&s.cancel.call(s.context,d),o.reject(d)};switch(e){case"value":gC(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":ZD(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":nM(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":eM(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":tM(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(xi("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return Ze("Query.limitToFirst",1,1,arguments.length),new zr(this.database,Bs(this._delegate,NY(e)))}limitToLast(e){return Ze("Query.limitToLast",1,1,arguments.length),new zr(this.database,Bs(this._delegate,PY(e)))}orderByChild(e){return Ze("Query.orderByChild",1,1,arguments.length),new zr(this.database,Bs(this._delegate,DY(e)))}orderByKey(){return Ze("Query.orderByKey",0,0,arguments.length),new zr(this.database,Bs(this._delegate,LY()))}orderByPriority(){return Ze("Query.orderByPriority",0,0,arguments.length),new zr(this.database,Bs(this._delegate,VY()))}orderByValue(){return Ze("Query.orderByValue",0,0,arguments.length),new zr(this.database,Bs(this._delegate,UY()))}startAt(e=null,t){return Ze("Query.startAt",0,2,arguments.length),new zr(this.database,Bs(this._delegate,AY(e,t)))}startAfter(e=null,t){return Ze("Query.startAfter",0,2,arguments.length),new zr(this.database,Bs(this._delegate,CY(e,t)))}endAt(e=null,t){return Ze("Query.endAt",0,2,arguments.length),new zr(this.database,Bs(this._delegate,xY(e,t)))}endBefore(e=null,t){return Ze("Query.endBefore",0,2,arguments.length),new zr(this.database,Bs(this._delegate,IY(e,t)))}equalTo(e,t){return Ze("Query.equalTo",1,2,arguments.length),new zr(this.database,Bs(this._delegate,HY(e,t)))}toString(){return Ze("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Ze("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Ze("Query.isEqual",1,1,arguments.length),!(e instanceof zr)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,sr(e,"cancel",i.cancel,!0),i.context=r,B2(e,"context",i.context);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(xi(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Ki(this.database,new As(this._delegate._repo,this._delegate._path))}};class Ki extends V3{constructor(e,t){super(e,new bi(t._repo,t._path,new $x,!1)),this.database=e,this._delegate=t}getKey(){return Ze("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Ze("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Ki(this.database,ah(this._delegate,e))}getParent(){Ze("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ki(this.database,e):null}getRoot(){return Ze("Reference.root",0,0,arguments.length),new Ki(this.database,this._delegate.root)}set(e,t){Ze("Reference.set",1,2,arguments.length),sr("Reference.set","onComplete",t,!0);const r=o1(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(Ze("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,O3("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_s("Reference.update",this._delegate._path),sr("Reference.update","onComplete",t,!0);const r=vY(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){Ze("Reference.setWithPriority",2,3,arguments.length),sr("Reference.setWithPriority","onComplete",r,!0);const i=_Y(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){Ze("Reference.remove",0,1,arguments.length),sr("Reference.remove","onComplete",e,!0);const t=yY(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){Ze("Reference.transaction",1,3,arguments.length),sr("Reference.transaction","transactionUpdate",e,!1),sr("Reference.transaction","onComplete",t,!0),cX("Reference.transaction","applyLocally",r);const i=sX(this._delegate,e,{applyLocally:r}).then(s=>new hX(s.committed,new $c(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){Ze("Reference.setPriority",1,2,arguments.length),sr("Reference.setPriority","onComplete",t,!0);const r=wY(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){Ze("Reference.push",0,2,arguments.length),sr("Reference.push","onComplete",t,!0);const r=gY(this._delegate,e),i=r.then(o=>new Ki(this.database,o));t&&i.then(()=>t(null),o=>t(o));const s=new Ki(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return _s("Reference.onDisconnect",this._delegate._path),new dX(new mY(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:KY,forceLongPolling:QY}}useEmulator(e,t,r={}){JY(this._delegate,e,t,r)}ref(e){if(Ze("database.ref",0,1,arguments.length),e instanceof Ki){const t=XD(this._delegate,e.toString());return new Ki(this,t)}else{const t=P3(this._delegate,e);return new Ki(this,t)}}refFromURL(e){Ze("database.refFromURL",1,1,arguments.length);const r=XD(this._delegate,e);return new Ki(this,r)}goOffline(){return Ze("database.goOffline",0,0,arguments.length),YY(this._delegate)}goOnline(){return Ze("database.goOnline",0,0,arguments.length),XY(this._delegate)}}x0.ServerValue={TIMESTAMP:nX(),increment:n=>rX(n)};function fX({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){w4(t);const a=new eN("database-standalone"),c=new Bb("auth-internal",a);c.setComponent(new qn("auth-internal",()=>r,"PRIVATE"));let d;return i&&(d=new Bb("app-check-internal",a),d.setComponent(new qn("app-check-internal",()=>i,"PRIVATE"))),{instance:new x0(M3(n,c,d,e,o),n),namespace:s}}var pX=Object.freeze({__proto__:null,initStandalone:fX});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mX=x0.ServerValue;function gX(n){n.INTERNAL.registerComponent(new qn("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new x0(i,r)},"PUBLIC").setServiceProps({Reference:Ki,Query:V3,Database:x0,DataSnapshot:$c,enableLogging:ZY,INTERNAL:pX,ServerValue:mX}).setMultipleInstances(!0)),n.registerVersion(oX,aX)}gX(Mn);var iM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wc,F3;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,k){function R(){}R.prototype=k.prototype,D.F=k.prototype,D.prototype=new R,D.prototype.constructor=D,D.D=function(U,M,j){for(var V=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)V[Ee-2]=arguments[Ee];return k.prototype[M].apply(U,V)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,k,R){R||(R=0);const U=Array(16);if(typeof k=="string")for(var M=0;M<16;++M)U[M]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(M=0;M<16;++M)U[M]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=D.g[0],R=D.g[1],M=D.g[2];let j=D.g[3],V;V=k+(j^R&(M^j))+U[0]+3614090360&4294967295,k=R+(V<<7&4294967295|V>>>25),V=j+(M^k&(R^M))+U[1]+3905402710&4294967295,j=k+(V<<12&4294967295|V>>>20),V=M+(R^j&(k^R))+U[2]+606105819&4294967295,M=j+(V<<17&4294967295|V>>>15),V=R+(k^M&(j^k))+U[3]+3250441966&4294967295,R=M+(V<<22&4294967295|V>>>10),V=k+(j^R&(M^j))+U[4]+4118548399&4294967295,k=R+(V<<7&4294967295|V>>>25),V=j+(M^k&(R^M))+U[5]+1200080426&4294967295,j=k+(V<<12&4294967295|V>>>20),V=M+(R^j&(k^R))+U[6]+2821735955&4294967295,M=j+(V<<17&4294967295|V>>>15),V=R+(k^M&(j^k))+U[7]+4249261313&4294967295,R=M+(V<<22&4294967295|V>>>10),V=k+(j^R&(M^j))+U[8]+1770035416&4294967295,k=R+(V<<7&4294967295|V>>>25),V=j+(M^k&(R^M))+U[9]+2336552879&4294967295,j=k+(V<<12&4294967295|V>>>20),V=M+(R^j&(k^R))+U[10]+4294925233&4294967295,M=j+(V<<17&4294967295|V>>>15),V=R+(k^M&(j^k))+U[11]+2304563134&4294967295,R=M+(V<<22&4294967295|V>>>10),V=k+(j^R&(M^j))+U[12]+1804603682&4294967295,k=R+(V<<7&4294967295|V>>>25),V=j+(M^k&(R^M))+U[13]+4254626195&4294967295,j=k+(V<<12&4294967295|V>>>20),V=M+(R^j&(k^R))+U[14]+2792965006&4294967295,M=j+(V<<17&4294967295|V>>>15),V=R+(k^M&(j^k))+U[15]+1236535329&4294967295,R=M+(V<<22&4294967295|V>>>10),V=k+(M^j&(R^M))+U[1]+4129170786&4294967295,k=R+(V<<5&4294967295|V>>>27),V=j+(R^M&(k^R))+U[6]+3225465664&4294967295,j=k+(V<<9&4294967295|V>>>23),V=M+(k^R&(j^k))+U[11]+643717713&4294967295,M=j+(V<<14&4294967295|V>>>18),V=R+(j^k&(M^j))+U[0]+3921069994&4294967295,R=M+(V<<20&4294967295|V>>>12),V=k+(M^j&(R^M))+U[5]+3593408605&4294967295,k=R+(V<<5&4294967295|V>>>27),V=j+(R^M&(k^R))+U[10]+38016083&4294967295,j=k+(V<<9&4294967295|V>>>23),V=M+(k^R&(j^k))+U[15]+3634488961&4294967295,M=j+(V<<14&4294967295|V>>>18),V=R+(j^k&(M^j))+U[4]+3889429448&4294967295,R=M+(V<<20&4294967295|V>>>12),V=k+(M^j&(R^M))+U[9]+568446438&4294967295,k=R+(V<<5&4294967295|V>>>27),V=j+(R^M&(k^R))+U[14]+3275163606&4294967295,j=k+(V<<9&4294967295|V>>>23),V=M+(k^R&(j^k))+U[3]+4107603335&4294967295,M=j+(V<<14&4294967295|V>>>18),V=R+(j^k&(M^j))+U[8]+1163531501&4294967295,R=M+(V<<20&4294967295|V>>>12),V=k+(M^j&(R^M))+U[13]+2850285829&4294967295,k=R+(V<<5&4294967295|V>>>27),V=j+(R^M&(k^R))+U[2]+4243563512&4294967295,j=k+(V<<9&4294967295|V>>>23),V=M+(k^R&(j^k))+U[7]+1735328473&4294967295,M=j+(V<<14&4294967295|V>>>18),V=R+(j^k&(M^j))+U[12]+2368359562&4294967295,R=M+(V<<20&4294967295|V>>>12),V=k+(R^M^j)+U[5]+4294588738&4294967295,k=R+(V<<4&4294967295|V>>>28),V=j+(k^R^M)+U[8]+2272392833&4294967295,j=k+(V<<11&4294967295|V>>>21),V=M+(j^k^R)+U[11]+1839030562&4294967295,M=j+(V<<16&4294967295|V>>>16),V=R+(M^j^k)+U[14]+4259657740&4294967295,R=M+(V<<23&4294967295|V>>>9),V=k+(R^M^j)+U[1]+2763975236&4294967295,k=R+(V<<4&4294967295|V>>>28),V=j+(k^R^M)+U[4]+1272893353&4294967295,j=k+(V<<11&4294967295|V>>>21),V=M+(j^k^R)+U[7]+4139469664&4294967295,M=j+(V<<16&4294967295|V>>>16),V=R+(M^j^k)+U[10]+3200236656&4294967295,R=M+(V<<23&4294967295|V>>>9),V=k+(R^M^j)+U[13]+681279174&4294967295,k=R+(V<<4&4294967295|V>>>28),V=j+(k^R^M)+U[0]+3936430074&4294967295,j=k+(V<<11&4294967295|V>>>21),V=M+(j^k^R)+U[3]+3572445317&4294967295,M=j+(V<<16&4294967295|V>>>16),V=R+(M^j^k)+U[6]+76029189&4294967295,R=M+(V<<23&4294967295|V>>>9),V=k+(R^M^j)+U[9]+3654602809&4294967295,k=R+(V<<4&4294967295|V>>>28),V=j+(k^R^M)+U[12]+3873151461&4294967295,j=k+(V<<11&4294967295|V>>>21),V=M+(j^k^R)+U[15]+530742520&4294967295,M=j+(V<<16&4294967295|V>>>16),V=R+(M^j^k)+U[2]+3299628645&4294967295,R=M+(V<<23&4294967295|V>>>9),V=k+(M^(R|~j))+U[0]+4096336452&4294967295,k=R+(V<<6&4294967295|V>>>26),V=j+(R^(k|~M))+U[7]+1126891415&4294967295,j=k+(V<<10&4294967295|V>>>22),V=M+(k^(j|~R))+U[14]+2878612391&4294967295,M=j+(V<<15&4294967295|V>>>17),V=R+(j^(M|~k))+U[5]+4237533241&4294967295,R=M+(V<<21&4294967295|V>>>11),V=k+(M^(R|~j))+U[12]+1700485571&4294967295,k=R+(V<<6&4294967295|V>>>26),V=j+(R^(k|~M))+U[3]+2399980690&4294967295,j=k+(V<<10&4294967295|V>>>22),V=M+(k^(j|~R))+U[10]+4293915773&4294967295,M=j+(V<<15&4294967295|V>>>17),V=R+(j^(M|~k))+U[1]+2240044497&4294967295,R=M+(V<<21&4294967295|V>>>11),V=k+(M^(R|~j))+U[8]+1873313359&4294967295,k=R+(V<<6&4294967295|V>>>26),V=j+(R^(k|~M))+U[15]+4264355552&4294967295,j=k+(V<<10&4294967295|V>>>22),V=M+(k^(j|~R))+U[6]+2734768916&4294967295,M=j+(V<<15&4294967295|V>>>17),V=R+(j^(M|~k))+U[13]+1309151649&4294967295,R=M+(V<<21&4294967295|V>>>11),V=k+(M^(R|~j))+U[4]+4149444226&4294967295,k=R+(V<<6&4294967295|V>>>26),V=j+(R^(k|~M))+U[11]+3174756917&4294967295,j=k+(V<<10&4294967295|V>>>22),V=M+(k^(j|~R))+U[2]+718787259&4294967295,M=j+(V<<15&4294967295|V>>>17),V=R+(j^(M|~k))+U[9]+3951481745&4294967295,D.g[0]=D.g[0]+k&4294967295,D.g[1]=D.g[1]+(M+(V<<21&4294967295|V>>>11))&4294967295,D.g[2]=D.g[2]+M&4294967295,D.g[3]=D.g[3]+j&4294967295}r.prototype.v=function(D,k){k===void 0&&(k=D.length);const R=k-this.blockSize,U=this.C;let M=this.h,j=0;for(;j<k;){if(M==0)for(;j<=R;)i(this,D,j),j+=this.blockSize;if(typeof D=="string"){for(;j<k;)if(U[M++]=D.charCodeAt(j++),M==this.blockSize){i(this,U),M=0;break}}else for(;j<k;)if(U[M++]=D[j++],M==this.blockSize){i(this,U),M=0;break}}this.h=M,this.o+=k},r.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var k=1;k<D.length-8;++k)D[k]=0;k=this.o*8;for(var R=D.length-8;R<D.length;++R)D[R]=k&255,k/=256;for(this.v(D),D=Array(16),k=0,R=0;R<4;++R)for(let U=0;U<32;U+=8)D[k++]=this.g[R]>>>U&255;return D};function s(D,k){var R=a;return Object.prototype.hasOwnProperty.call(R,D)?R[D]:R[D]=k(D)}function o(D,k){this.h=k;const R=[];let U=!0;for(let M=D.length-1;M>=0;M--){const j=D[M]|0;U&&j==k||(R[M]=j,U=!1)}this.g=R}var a={};function c(D){return-128<=D&&D<128?s(D,function(k){return new o([k|0],k<0?-1:0)}):new o([D|0],D<0?-1:0)}function d(D){if(isNaN(D)||!isFinite(D))return m;if(D<0)return N(d(-D));const k=[];let R=1;for(let U=0;D>=R;U++)k[U]=D/R|0,R*=4294967296;return new o(k,0)}function h(D,k){if(D.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(D.charAt(0)=="-")return N(h(D.substring(1),k));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(k,8));let U=m;for(let j=0;j<D.length;j+=8){var M=Math.min(8,D.length-j);const V=parseInt(D.substring(j,j+M),k);M<8?(M=d(Math.pow(k,M)),U=U.j(M).add(d(V))):(U=U.j(R),U=U.add(d(V)))}return U}var m=c(0),_=c(1),x=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-N(this).m();let D=0,k=1;for(let R=0;R<this.g.length;R++){const U=this.i(R);D+=(U>=0?U:4294967296+U)*k,k*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(b(this))return"0";if(A(this))return"-"+N(this).toString(D);const k=d(Math.pow(D,6));var R=this;let U="";for(;;){const M=q(R,k).g;R=F(R,M.j(k));let j=((R.g.length>0?R.g[0]:R.h)>>>0).toString(D);if(R=M,b(R))return j+U;for(;j.length<6;)j="0"+j;U=j+U}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function b(D){if(D.h!=0)return!1;for(let k=0;k<D.g.length;k++)if(D.g[k]!=0)return!1;return!0}function A(D){return D.h==-1}n.l=function(D){return D=F(this,D),A(D)?-1:b(D)?0:1};function N(D){const k=D.g.length,R=[];for(let U=0;U<k;U++)R[U]=~D.g[U];return new o(R,~D.h).add(_)}n.abs=function(){return A(this)?N(this):this},n.add=function(D){const k=Math.max(this.g.length,D.g.length),R=[];let U=0;for(let M=0;M<=k;M++){let j=U+(this.i(M)&65535)+(D.i(M)&65535),V=(j>>>16)+(this.i(M)>>>16)+(D.i(M)>>>16);U=V>>>16,j&=65535,V&=65535,R[M]=V<<16|j}return new o(R,R[R.length-1]&-2147483648?-1:0)};function F(D,k){return D.add(N(k))}n.j=function(D){if(b(this)||b(D))return m;if(A(this))return A(D)?N(this).j(N(D)):N(N(this).j(D));if(A(D))return N(this.j(N(D)));if(this.l(x)<0&&D.l(x)<0)return d(this.m()*D.m());const k=this.g.length+D.g.length,R=[];for(var U=0;U<2*k;U++)R[U]=0;for(U=0;U<this.g.length;U++)for(let M=0;M<D.g.length;M++){const j=this.i(U)>>>16,V=this.i(U)&65535,Ee=D.i(M)>>>16,le=D.i(M)&65535;R[2*U+2*M]+=V*le,B(R,2*U+2*M),R[2*U+2*M+1]+=j*le,B(R,2*U+2*M+1),R[2*U+2*M+1]+=V*Ee,B(R,2*U+2*M+1),R[2*U+2*M+2]+=j*Ee,B(R,2*U+2*M+2)}for(D=0;D<k;D++)R[D]=R[2*D+1]<<16|R[2*D];for(D=k;D<2*k;D++)R[D]=0;return new o(R,0)};function B(D,k){for(;(D[k]&65535)!=D[k];)D[k+1]+=D[k]>>>16,D[k]&=65535,k++}function O(D,k){this.g=D,this.h=k}function q(D,k){if(b(k))throw Error("division by zero");if(b(D))return new O(m,m);if(A(D))return k=q(N(D),k),new O(N(k.g),N(k.h));if(A(k))return k=q(D,N(k)),new O(N(k.g),k.h);if(D.g.length>30){if(A(D)||A(k))throw Error("slowDivide_ only works with positive integers.");for(var R=_,U=k;U.l(D)<=0;)R=W(R),U=W(U);var M=$(R,1),j=$(U,1);for(U=$(U,2),R=$(R,2);!b(U);){var V=j.add(U);V.l(D)<=0&&(M=M.add(R),j=V),U=$(U,1),R=$(R,1)}return k=F(D,M.j(k)),new O(M,k)}for(M=m;D.l(k)>=0;){for(R=Math.max(1,Math.floor(D.m()/k.m())),U=Math.ceil(Math.log(R)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),j=d(R),V=j.j(k);A(V)||V.l(D)>0;)R-=U,j=d(R),V=j.j(k);b(j)&&(j=_),M=M.add(j),D=F(D,V)}return new O(M,D)}n.B=function(D){return q(this,D).h},n.and=function(D){const k=Math.max(this.g.length,D.g.length),R=[];for(let U=0;U<k;U++)R[U]=this.i(U)&D.i(U);return new o(R,this.h&D.h)},n.or=function(D){const k=Math.max(this.g.length,D.g.length),R=[];for(let U=0;U<k;U++)R[U]=this.i(U)|D.i(U);return new o(R,this.h|D.h)},n.xor=function(D){const k=Math.max(this.g.length,D.g.length),R=[];for(let U=0;U<k;U++)R[U]=this.i(U)^D.i(U);return new o(R,this.h^D.h)};function W(D){const k=D.g.length+1,R=[];for(let U=0;U<k;U++)R[U]=D.i(U)<<1|D.i(U-1)>>>31;return new o(R,D.h)}function $(D,k){const R=k>>5;k%=32;const U=D.g.length-R,M=[];for(let j=0;j<U;j++)M[j]=k>0?D.i(j+R)>>>k|D.i(j+R+1)<<32-k:D.i(j+R);return new o(M,D.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,F3=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Wc=o}).apply(typeof iM<"u"?iM:typeof self<"u"?self:typeof window<"u"?window:{});var dv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var U3,Ty,B3,Lv,wC,H3,G3,j3;(function(){var n,e=Object.defineProperty;function t(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof dv=="object"&&dv];for(var I=0;I<w.length;++I){var C=w[I];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=t(this);function i(w,I){if(I)e:{var C=r;w=w.split(".");for(var L=0;L<w.length-1;L++){var te=w[L];if(!(te in C))break e;C=C[te]}w=w[w.length-1],L=C[w],I=I(L),I!=L&&I!=null&&e(C,w,{configurable:!0,writable:!0,value:I})}}i("Symbol.dispose",function(w){return w||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(w){return w||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(w){return w||function(I){var C=[],L;for(L in I)Object.prototype.hasOwnProperty.call(I,L)&&C.push([L,I[L]]);return C}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(w){var I=typeof w;return I=="object"&&w!=null||I=="function"}function c(w,I,C){return w.call.apply(w.bind,arguments)}function d(w,I,C){return d=c,d.apply(null,arguments)}function h(w,I){var C=Array.prototype.slice.call(arguments,1);return function(){var L=C.slice();return L.push.apply(L,arguments),w.apply(this,L)}}function m(w,I){function C(){}C.prototype=I.prototype,w.Z=I.prototype,w.prototype=new C,w.prototype.constructor=w,w.Ob=function(L,te,ae){for(var Ce=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)Ce[ot-2]=arguments[ot];return I.prototype[te].apply(L,Ce)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?w=>w&&AsyncContext.Snapshot.wrap(w):w=>w;function x(w){const I=w.length;if(I>0){const C=Array(I);for(let L=0;L<I;L++)C[L]=w[L];return C}return[]}function b(w,I){for(let L=1;L<arguments.length;L++){const te=arguments[L];var C=typeof te;if(C=C!="object"?C:te?Array.isArray(te)?"array":C:"null",C=="array"||C=="object"&&typeof te.length=="number"){C=w.length||0;const ae=te.length||0;w.length=C+ae;for(let Ce=0;Ce<ae;Ce++)w[C+Ce]=te[Ce]}else w.push(te)}}class A{constructor(I,C){this.i=I,this.j=C,this.h=0,this.g=null}get(){let I;return this.h>0?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function N(w){o.setTimeout(()=>{throw w},0)}function F(){var w=D;let I=null;return w.g&&(I=w.g,w.g=w.g.next,w.g||(w.h=null),I.next=null),I}class B{constructor(){this.h=this.g=null}add(I,C){const L=O.get();L.set(I,C),this.h?this.h.next=L:this.g=L,this.h=L}}var O=new A(()=>new q,w=>w.reset());class q{constructor(){this.next=this.g=this.h=null}set(I,C){this.h=I,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let W,$=!1,D=new B,k=()=>{const w=Promise.resolve(void 0);W=()=>{w.then(R)}};function R(){for(var w;w=F();){try{w.h.call(w.g)}catch(C){N(C)}var I=O;I.j(w),I.h<100&&(I.h++,w.next=I.g,I.g=w)}$=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(w,I){this.type=w,this.g=this.target=I,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var w=!1,I=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const C=()=>{};o.addEventListener("test",C,I),o.removeEventListener("test",C,I)}catch{}return w})();function V(w){return/^[\s\xa0]*$/.test(w)}function Ee(w,I){M.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w&&this.init(w,I)}m(Ee,M),Ee.prototype.init=function(w,I){const C=this.type=w.type,L=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;this.target=w.target||w.srcElement,this.g=I,I=w.relatedTarget,I||(C=="mouseover"?I=w.fromElement:C=="mouseout"&&(I=w.toElement)),this.relatedTarget=I,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=w.pointerType,this.state=w.state,this.i=w,w.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var le="closure_listenable_"+(Math.random()*1e6|0),pe=0;function be(w,I,C,L,te){this.listener=w,this.proxy=null,this.src=I,this.type=C,this.capture=!!L,this.ha=te,this.key=++pe,this.da=this.fa=!1}function de(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function xe(w,I,C){for(const L in w)I.call(C,w[L],L,w)}function ne(w,I){for(const C in w)I.call(void 0,w[C],C,w)}function z(w){const I={};for(const C in w)I[C]=w[C];return I}const ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pe(w,I){let C,L;for(let te=1;te<arguments.length;te++){L=arguments[te];for(C in L)w[C]=L[C];for(let ae=0;ae<ce.length;ae++)C=ce[ae],Object.prototype.hasOwnProperty.call(L,C)&&(w[C]=L[C])}}function Re(w){this.src=w,this.g={},this.h=0}Re.prototype.add=function(w,I,C,L,te){const ae=w.toString();w=this.g[ae],w||(w=this.g[ae]=[],this.h++);const Ce=Xe(w,I,L,te);return Ce>-1?(I=w[Ce],C||(I.fa=!1)):(I=new be(I,this.src,ae,!!L,te),I.fa=C,w.push(I)),I};function Ye(w,I){const C=I.type;if(C in w.g){var L=w.g[C],te=Array.prototype.indexOf.call(L,I,void 0),ae;(ae=te>=0)&&Array.prototype.splice.call(L,te,1),ae&&(de(I),w.g[C].length==0&&(delete w.g[C],w.h--))}}function Xe(w,I,C,L){for(let te=0;te<w.length;++te){const ae=w[te];if(!ae.da&&ae.listener==I&&ae.capture==!!C&&ae.ha==L)return te}return-1}var et="closure_lm_"+(Math.random()*1e6|0),Ne={};function Te(w,I,C,L,te){if(Array.isArray(I)){for(let ae=0;ae<I.length;ae++)Te(w,I[ae],C,L,te);return null}return C=co(C),w&&w[le]?w.J(I,C,a(L)?!!L.capture:!1,te):Ve(w,I,C,!1,L,te)}function Ve(w,I,C,L,te,ae){if(!I)throw Error("Invalid event type");const Ce=a(te)?!!te.capture:!!te;let ot=tn(w);if(ot||(w[et]=ot=new Re(w)),C=ot.add(I,C,L,Ce,ae),C.proxy)return C;if(L=it(),C.proxy=L,L.src=w,L.listener=C,w.addEventListener)j||(te=Ce),te===void 0&&(te=!1),w.addEventListener(I.toString(),L,te);else if(w.attachEvent)w.attachEvent(mt(I.toString()),L);else if(w.addListener&&w.removeListener)w.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return C}function it(){function w(C){return I.call(w.src,w.listener,C)}const I=zt;return w}function st(w,I,C,L,te){if(Array.isArray(I))for(var ae=0;ae<I.length;ae++)st(w,I[ae],C,L,te);else L=a(L)?!!L.capture:!!L,C=co(C),w&&w[le]?(w=w.i,ae=String(I).toString(),ae in w.g&&(I=w.g[ae],C=Xe(I,C,L,te),C>-1&&(de(I[C]),Array.prototype.splice.call(I,C,1),I.length==0&&(delete w.g[ae],w.h--)))):w&&(w=tn(w))&&(I=w.g[I.toString()],w=-1,I&&(w=Xe(I,C,L,te)),(C=w>-1?I[w]:null)&&lt(C))}function lt(w){if(typeof w!="number"&&w&&!w.da){var I=w.src;if(I&&I[le])Ye(I.i,w);else{var C=w.type,L=w.proxy;I.removeEventListener?I.removeEventListener(C,L,w.capture):I.detachEvent?I.detachEvent(mt(C),L):I.addListener&&I.removeListener&&I.removeListener(L),(C=tn(I))?(Ye(C,w),C.h==0&&(C.src=null,I[et]=null)):de(w)}}}function mt(w){return w in Ne?Ne[w]:Ne[w]="on"+w}function zt(w,I){if(w.da)w=!0;else{I=new Ee(I,this);const C=w.listener,L=w.ha||w.src;w.fa&&lt(w),w=C.call(L,I)}return w}function tn(w){return w=w[et],w instanceof Re?w:null}var Gr="__closure_events_fn_"+(Math.random()*1e9>>>0);function co(w){return typeof w=="function"?w:(w[Gr]||(w[Gr]=function(I){return w.handleEvent(I)}),w[Gr])}function gn(){U.call(this),this.i=new Re(this),this.M=this,this.G=null}m(gn,U),gn.prototype[le]=!0,gn.prototype.removeEventListener=function(w,I,C,L){st(this,w,I,C,L)};function yn(w,I){var C,L=w.G;if(L)for(C=[];L;L=L.G)C.push(L);if(w=w.M,L=I.type||I,typeof I=="string")I=new M(I,w);else if(I instanceof M)I.target=I.target||w;else{var te=I;I=new M(L,w),Pe(I,te)}te=!0;let ae,Ce;if(C)for(Ce=C.length-1;Ce>=0;Ce--)ae=I.g=C[Ce],te=si(ae,L,!0,I)&&te;if(ae=I.g=w,te=si(ae,L,!0,I)&&te,te=si(ae,L,!1,I)&&te,C)for(Ce=0;Ce<C.length;Ce++)ae=I.g=C[Ce],te=si(ae,L,!1,I)&&te}gn.prototype.N=function(){if(gn.Z.N.call(this),this.i){var w=this.i;for(const I in w.g){const C=w.g[I];for(let L=0;L<C.length;L++)de(C[L]);delete w.g[I],w.h--}}this.G=null},gn.prototype.J=function(w,I,C,L){return this.i.add(String(w),I,!1,C,L)},gn.prototype.K=function(w,I,C,L){return this.i.add(String(w),I,!0,C,L)};function si(w,I,C,L){if(I=w.i.g[String(I)],!I)return!0;I=I.concat();let te=!0;for(let ae=0;ae<I.length;++ae){const Ce=I[ae];if(Ce&&!Ce.da&&Ce.capture==C){const ot=Ce.listener,Nn=Ce.ha||Ce.src;Ce.fa&&Ye(w.i,Ce),te=ot.call(Nn,L)!==!1&&te}}return te&&!L.defaultPrevented}function kl(w,I){if(typeof w!="function")if(w&&typeof w.handleEvent=="function")w=d(w.handleEvent,w);else throw Error("Invalid listener argument");return Number(I)>2147483647?-1:o.setTimeout(w,I||0)}function Pl(w){w.g=kl(()=>{w.g=null,w.i&&(w.i=!1,Pl(w))},w.l);const I=w.h;w.h=null,w.m.apply(null,I)}class Au extends U{constructor(I,C){super(),this.m=I,this.l=C,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:Pl(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bs(w){U.call(this),this.h=w,this.g={}}m(bs,U);var Rl=[];function _a(w){xe(w.g,function(I,C){this.g.hasOwnProperty(C)&&lt(I)},w),w.g={}}bs.prototype.N=function(){bs.Z.N.call(this),_a(this)},bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cs=o.JSON.stringify,bu=o.JSON.parse,uo=class{stringify(w){return o.JSON.stringify(w,void 0)}parse(w){return o.JSON.parse(w,void 0)}};function ho(){}function va(){}var fo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Dl(){M.call(this,"d")}m(Dl,M);function Cu(){M.call(this,"c")}m(Cu,M);var Ci={},Ml=null;function Ss(){return Ml=Ml||new gn}Ci.Ia="serverreachability";function Ll(w){M.call(this,Ci.Ia,w)}m(Ll,M);function Ns(w){const I=Ss();yn(I,new Ll(I))}Ci.STAT_EVENT="statevent";function ks(w,I){M.call(this,Ci.STAT_EVENT,w),this.stat=I}m(ks,M);function ue(w){const I=Ss();yn(I,new ks(I,w))}Ci.Ja="timingevent";function tt(w,I){M.call(this,Ci.Ja,w),this.size=I}m(tt,M);function xt(w,I){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){w()},I)}function Jn(){this.g=!0}Jn.prototype.ua=function(){this.g=!1};function Ol(w,I,C,L,te,ae){w.info(function(){if(w.g)if(ae){var Ce="",ot=ae.split("&");for(let Ft=0;Ft<ot.length;Ft++){var Nn=ot[Ft].split("=");if(Nn.length>1){const Vn=Nn[0];Nn=Nn[1];const Mi=Vn.split("_");Ce=Mi.length>=2&&Mi[1]=="type"?Ce+(Vn+"="+Nn+"&"):Ce+(Vn+"=redacted&")}}}else Ce=null;else Ce=ae;return"XMLHTTP REQ ("+L+") [attempt "+te+"]: "+I+`
`+C+`
`+Ce})}function Si(w,I,C,L,te,ae,Ce){w.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+te+"]: "+I+`
`+C+`
`+ae+" "+Ce})}function oi(w,I,C,L){w.info(function(){return"XMLHTTP TEXT ("+I+"): "+Ps(w,C)+(L?" "+L:"")})}function lg(w,I){w.info(function(){return"TIMEOUT: "+I})}Jn.prototype.info=function(){};function Ps(w,I){if(!w.g)return I;if(!I)return null;try{const ae=JSON.parse(I);if(ae){for(w=0;w<ae.length;w++)if(Array.isArray(ae[w])){var C=ae[w];if(!(C.length<2)){var L=C[1];if(Array.isArray(L)&&!(L.length<1)){var te=L[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Ce=1;Ce<L.length;Ce++)L[Ce]=""}}}}return Cs(ae)}catch{return I}}var Vl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Zw;function Ea(){}m(Ea,ho),Ea.prototype.g=function(){return new XMLHttpRequest},Zw=new Ea;function po(w){return encodeURIComponent(String(w))}function Hh(w){var I=1;w=w.split(":");const C=[];for(;I>0&&w.length;)C.push(w.shift()),I--;return w.length&&C.push(w.join(":")),C}function es(w,I,C,L){this.j=w,this.i=I,this.l=C,this.S=L||1,this.V=new bs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new e_}function e_(){this.i=null,this.g="",this.h=!1}var t_={},cg={};function Rs(w,I,C){w.M=1,w.A=Ta(ts(I)),w.u=C,w.R=!0,ug(w,null)}function ug(w,I){w.F=Date.now(),Su(w),w.B=ts(w.A);var C=w.B,L=w.S;Array.isArray(L)||(L=[String(L)]),vg(C.i,"t",L),w.C=0,C=w.j.L,w.h=new e_,w.g=d_(w.j,C?I:null,!w.u),w.P>0&&(w.O=new Au(d(w.Y,w,w.g),w.P)),I=w.V,C=w.g,L=w.ba;var te="readystatechange";Array.isArray(te)||(te&&(Rl[0]=te.toString()),te=Rl);for(let ae=0;ae<te.length;ae++){const Ce=Te(C,te[ae],L||I.handleEvent,!1,I.h||I);if(!Ce)break;I.g[Ce.key]=Ce}I=w.J?z(w.J):{},w.u?(w.v||(w.v="POST"),I["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.B,w.v,w.u,I)):(w.v="GET",w.g.ea(w.B,w.v,null,I)),Ns(),Ol(w.i,w.v,w.B,w.l,w.S,w.u)}es.prototype.ba=function(w){w=w.target;const I=this.O;I&&Eo(w)==3?I.j():this.Y(w)},es.prototype.Y=function(w){try{if(w==this.g)e:{const ot=Eo(this.g),Nn=this.g.ya(),Ft=this.g.ca();if(!(ot<3)&&(ot!=3||this.g&&(this.h.h||this.g.la()||c_(this.g)))){this.K||ot!=4||Nn==7||(Nn==8||Ft<=0?Ns(3):Ns(2)),Gh(this);var I=this.g.ca();this.X=I;var C=n_(this);if(this.o=I==200,Si(this.i,this.v,this.B,this.l,this.S,ot,I),this.o){if(this.U&&!this.L){t:{if(this.g){var L,te=this.g;if((L=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(L)){var ae=L;break t}}ae=null}if(w=ae)oi(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,nn(this,w);else{this.o=!1,this.m=3,ue(12),xa(this),Nu(this);break e}}if(this.R){w=!0;let Vn;for(;!this.K&&this.C<C.length;)if(Vn=i_(this,C),Vn==cg){ot==4&&(this.m=4,ue(14),w=!1),oi(this.i,this.l,null,"[Incomplete Response]");break}else if(Vn==t_){this.m=4,ue(15),oi(this.i,this.l,C,"[Invalid Chunk]"),w=!1;break}else oi(this.i,this.l,Vn,null),nn(this,Vn);if(r_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||C.length!=0||this.h.h||(this.m=1,ue(16),w=!1),this.o=this.o&&w,!w)oi(this.i,this.l,C,"[Invalid Chunked Response]"),xa(this),Nu(this);else if(C.length>0&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.aa&&!Ce.P&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Fu(Ce),Ce.P=!0,ue(11))}}else oi(this.i,this.l,C,null),nn(this,C);ot==4&&xa(this),this.o&&!this.K&&(ot==4?Xh(this.j,this):(this.o=!1,Su(this)))}else xg(this.g),I==400&&C.indexOf("Unknown SID")>0?(this.m=3,ue(12)):(this.m=0,ue(13)),xa(this),Nu(this)}}}catch{}finally{}};function n_(w){if(!r_(w))return w.g.la();const I=c_(w.g);if(I==="")return"";let C="";const L=I.length,te=Eo(w.g)==4;if(!w.h.i){if(typeof TextDecoder>"u")return xa(w),Nu(w),"";w.h.i=new o.TextDecoder}for(let ae=0;ae<L;ae++)w.h.h=!0,C+=w.h.i.decode(I[ae],{stream:!(te&&ae==L-1)});return I.length=0,w.h.g+=C,w.C=0,w.h.g}function r_(w){return w.g?w.v=="GET"&&w.M!=2&&w.j.Aa:!1}function i_(w,I){var C=w.C,L=I.indexOf(`
`,C);return L==-1?cg:(C=Number(I.substring(C,L)),isNaN(C)?t_:(L+=1,L+C>I.length?cg:(I=I.slice(L,L+C),w.C=L+C,I)))}es.prototype.cancel=function(){this.K=!0,xa(this)};function Su(w){w.T=Date.now()+w.H,dg(w,w.H)}function dg(w,I){if(w.D!=null)throw Error("WatchDog timer not null");w.D=xt(d(w.aa,w),I)}function Gh(w){w.D&&(o.clearTimeout(w.D),w.D=null)}es.prototype.aa=function(){this.D=null;const w=Date.now();w-this.T>=0?(lg(this.i,this.B),this.M!=2&&(Ns(),ue(17)),xa(this),this.m=2,Nu(this)):dg(this,this.T-w)};function Nu(w){w.j.I==0||w.K||Xh(w.j,w)}function xa(w){Gh(w);var I=w.O;I&&typeof I.dispose=="function"&&I.dispose(),w.O=null,_a(w.V),w.g&&(I=w.g,w.g=null,I.abort(),I.dispose())}function nn(w,I){try{var C=w.j;if(C.I!=0&&(C.g==w||fg(C.h,w))){if(!w.L&&fg(C.h,w)&&C.I==3){try{var L=C.Ba.g.parse(I)}catch{L=null}if(Array.isArray(L)&&L.length==3){var te=L;if(te[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<w.F)Yh(C),Ri(C);else break e;Io(C),ue(18)}}else C.xa=te[1],0<C.xa-C.K&&te[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=xt(d(C.Va,C),6e3));ku(C.h)<=1&&C.ta&&(C.ta=void 0)}else Di(C,11)}else if((w.L||C.g==w)&&Yh(C),!V(I))for(te=C.Ba.g.parse(I),I=0;I<te.length;I++){let Ft=te[I];const Vn=Ft[0];if(!(Vn<=C.K))if(C.K=Vn,Ft=Ft[1],C.I==2)if(Ft[0]=="c"){C.M=Ft[1],C.ba=Ft[2];const Mi=Ft[3];Mi!=null&&(C.ka=Mi,C.j.info("VER="+C.ka));const Sa=Ft[4];Sa!=null&&(C.za=Sa,C.j.info("SVER="+C.za));const Ao=Ft[5];Ao!=null&&typeof Ao=="number"&&Ao>0&&(L=1.5*Ao,C.O=L,C.j.info("backChannelRequestTimeoutMs_="+L)),L=C;const bo=w.g;if(bo){const tf=bo.g?bo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tf){var ae=L.h;ae.g||tf.indexOf("spdy")==-1&&tf.indexOf("quic")==-1&&tf.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(qh(ae,ae.h),ae.h=null))}if(L.G){const Ag=bo.g?bo.g.getResponseHeader("X-HTTP-Session-Id"):null;Ag&&(L.wa=Ag,Dt(L.J,L.G,Ag))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-w.F,C.j.info("Handshake RTT: "+C.T+"ms")),L=C;var Ce=w;if(L.na=Ig(L,L.L?L.ba:null,L.W),Ce.L){Pu(L.h,Ce);var ot=Ce,Nn=L.O;Nn&&(ot.H=Nn),ot.D&&(Gh(ot),Su(ot)),L.g=Ce}else Ar(L);C.i.length>0&&Ca(C)}else Ft[0]!="stop"&&Ft[0]!="close"||Di(C,7);else C.I==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?Di(C,7):Qh(C):Ft[0]!="noop"&&C.l&&C.l.qa(Ft),C.A=0)}}Ns(4)}catch{}}var sI=class{constructor(w,I){this.g=w,this.map=I}};function jh(w){this.l=w||10,o.PerformanceNavigationTiming?(w=o.performance.getEntriesByType("navigation"),w=w.length>0&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function hg(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function ku(w){return w.h?1:w.g?w.g.size:0}function fg(w,I){return w.h?w.h==I:w.g?w.g.has(I):!1}function qh(w,I){w.g?w.g.add(I):w.h=I}function Pu(w,I){w.h&&w.h==I?w.h=null:w.g&&w.g.has(I)&&w.g.delete(I)}jh.prototype.cancel=function(){if(this.i=Ni(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Ni(w){if(w.h!=null)return w.i.concat(w.h.G);if(w.g!=null&&w.g.size!==0){let I=w.i;for(const C of w.g.values())I=I.concat(C.G);return I}return x(w.i)}var s_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ki(w,I){if(w){w=w.split("&");for(let C=0;C<w.length;C++){const L=w[C].indexOf("=");let te,ae=null;L>=0?(te=w[C].substring(0,L),ae=w[C].substring(L+1)):te=w[C],I(te,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function mo(w){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let I;w instanceof mo?(this.l=w.l,Ru(this,w.j),this.o=w.o,this.g=w.g,go(this,w.u),this.h=w.h,Ul(this,Eg(w.i)),this.m=w.m):w&&(I=String(w).match(s_))?(this.l=!1,Ru(this,I[1]||"",!0),this.o=Du(I[2]||""),this.g=Du(I[3]||"",!0),go(this,I[4]),this.h=Du(I[5]||"",!0),Ul(this,I[6]||"",!0),this.m=Du(I[7]||"")):(this.l=!1,this.i=new Tt(null,this.l))}mo.prototype.toString=function(){const w=[];var I=this.j;I&&w.push(Mu(I,mg,!0),":");var C=this.g;return(C||I=="file")&&(w.push("//"),(I=this.o)&&w.push(Mu(I,mg,!0),"@"),w.push(po(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&w.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&w.push("/"),w.push(Mu(C,C.charAt(0)=="/"?Lu:gg,!0))),(C=this.i.toString())&&w.push("?",C),(C=this.m)&&w.push("#",Mu(C,yg)),w.join("")},mo.prototype.resolve=function(w){const I=ts(this);let C=!!w.j;C?Ru(I,w.j):C=!!w.o,C?I.o=w.o:C=!!w.g,C?I.g=w.g:C=w.u!=null;var L=w.h;if(C)go(I,w.u);else if(C=!!w.h){if(L.charAt(0)!="/")if(this.g&&!this.h)L="/"+L;else{var te=I.h.lastIndexOf("/");te!=-1&&(L=I.h.slice(0,te+1)+L)}if(te=L,te==".."||te==".")L="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){L=te.lastIndexOf("/",0)==0,te=te.split("/");const ae=[];for(let Ce=0;Ce<te.length;){const ot=te[Ce++];ot=="."?L&&Ce==te.length&&ae.push(""):ot==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),L&&Ce==te.length&&ae.push("")):(ae.push(ot),L=!0)}L=ae.join("/")}else L=te}return C?I.h=L:C=w.i.toString()!=="",C?Ul(I,Eg(w.i)):C=!!w.m,C&&(I.m=w.m),I};function ts(w){return new mo(w)}function Ru(w,I,C){w.j=C?Du(I,!0):I,w.j&&(w.j=w.j.replace(/:$/,""))}function go(w,I){if(I){if(I=Number(I),isNaN(I)||I<0)throw Error("Bad port number "+I);w.u=I}else w.u=null}function Ul(w,I,C){I instanceof Tt?(w.i=I,$h(w.i,w.l)):(C||(I=Mu(I,oI)),w.i=new Tt(I,w.l))}function Dt(w,I,C){w.i.set(I,C)}function Ta(w){return Dt(w,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),w}function Du(w,I){return w?I?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Mu(w,I,C){return typeof w=="string"?(w=encodeURI(w).replace(I,pg),C&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function pg(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var mg=/[#\/\?@]/g,gg=/[#\?:]/g,Lu=/[#\?]/g,oI=/[#\?@]/g,yg=/#/g;function Tt(w,I){this.h=this.g=null,this.i=w||null,this.j=!!I}function yo(w){w.g||(w.g=new Map,w.h=0,w.i&&ki(w.i,function(I,C){w.add(decodeURIComponent(I.replace(/\+/g," ")),C)}))}n=Tt.prototype,n.add=function(w,I){yo(this),this.i=null,w=wo(this,w);let C=this.g.get(w);return C||this.g.set(w,C=[]),C.push(I),this.h+=1,this};function wg(w,I){yo(w),I=wo(w,I),w.g.has(I)&&(w.i=null,w.h-=w.g.get(I).length,w.g.delete(I))}function zh(w,I){return yo(w),I=wo(w,I),w.g.has(I)}n.forEach=function(w,I){yo(this),this.g.forEach(function(C,L){C.forEach(function(te){w.call(I,te,L,this)},this)},this)};function _g(w,I){yo(w);let C=[];if(typeof I=="string")zh(w,I)&&(C=C.concat(w.g.get(wo(w,I))));else for(w=Array.from(w.g.values()),I=0;I<w.length;I++)C=C.concat(w[I]);return C}n.set=function(w,I){return yo(this),this.i=null,w=wo(this,w),zh(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[I]),this.h+=1,this},n.get=function(w,I){return w?(w=_g(this,w),w.length>0?String(w[0]):I):I};function vg(w,I,C){wg(w,I),C.length>0&&(w.i=null,w.g.set(wo(w,I),x(C)),w.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],I=Array.from(this.g.keys());for(let L=0;L<I.length;L++){var C=I[L];const te=po(C);C=_g(this,C);for(let ae=0;ae<C.length;ae++){let Ce=te;C[ae]!==""&&(Ce+="="+po(C[ae])),w.push(Ce)}}return this.i=w.join("&")};function Eg(w){const I=new Tt;return I.i=w.i,w.g&&(I.g=new Map(w.g),I.h=w.h),I}function wo(w,I){return I=String(I),w.j&&(I=I.toLowerCase()),I}function $h(w,I){I&&!w.j&&(yo(w),w.i=null,w.g.forEach(function(C,L){const te=L.toLowerCase();L!=te&&(wg(this,L),vg(this,te,C))},w)),w.j=I}function _o(w,I){const C=new Jn;if(o.Image){const L=new Image;L.onload=h(hr,C,"TestLoadImage: loaded",!0,I,L),L.onerror=h(hr,C,"TestLoadImage: error",!1,I,L),L.onabort=h(hr,C,"TestLoadImage: abort",!1,I,L),L.ontimeout=h(hr,C,"TestLoadImage: timeout",!1,I,L),o.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=w}else I(!1)}function vo(w,I){const C=new Jn,L=new AbortController,te=setTimeout(()=>{L.abort(),hr(C,"TestPingServer: timeout",!1,I)},1e4);fetch(w,{signal:L.signal}).then(ae=>{clearTimeout(te),ae.ok?hr(C,"TestPingServer: ok",!0,I):hr(C,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(te),hr(C,"TestPingServer: error",!1,I)})}function hr(w,I,C,L,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),L(C)}catch{}}function Ou(){this.g=new uo}function Ia(w){this.i=w.Sb||null,this.h=w.ab||!1}m(Ia,ho),Ia.prototype.g=function(){return new Pi(this.i,this.h)};function Pi(w,I){gn.call(this),this.H=w,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Pi,gn),n=Pi.prototype,n.open=function(w,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=w,this.D=I,this.readyState=1,Ds(this)},n.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const I={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};w&&(I.body=w),(this.H||o).fetch(new Request(this.D,I)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Bl(this)),this.readyState=0},n.Pa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,Ds(this)),this.g&&(this.readyState=3,Ds(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;o_(this)}else w.text().then(this.Oa.bind(this),this.ga.bind(this))};function o_(w){w.j.read().then(w.Ma.bind(w)).catch(w.ga.bind(w))}n.Ma=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var I=w.value?w.value:new Uint8Array(0);(I=this.B.decode(I,{stream:!w.done}))&&(this.response=this.responseText+=I)}w.done?Bl(this):Ds(this),this.readyState==3&&o_(this)}},n.Oa=function(w){this.g&&(this.response=this.responseText=w,Bl(this))},n.Na=function(w){this.g&&(this.response=w,Bl(this))},n.ga=function(){this.g&&Bl(this)};function Bl(w){w.readyState=4,w.l=null,w.j=null,w.B=null,Ds(w)}n.setRequestHeader=function(w,I){this.A.append(w,I)},n.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],I=this.h.entries();for(var C=I.next();!C.done;)C=C.value,w.push(C[0]+": "+C[1]),C=I.next();return w.join(`\r
`)};function Ds(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(Pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function a_(w){let I="";return xe(w,function(C,L){I+=L,I+=":",I+=C,I+=`\r
`}),I}function Wh(w,I,C){e:{for(L in C){var L=!1;break e}L=!0}L||(C=a_(C),typeof w=="string"?C!=null&&po(C):Dt(w,I,C))}function $t(w){gn.call(this),this.headers=new Map,this.L=w||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m($t,gn);var l_=/^https?$/i,aI=["POST","PUT"];n=$t.prototype,n.Fa=function(w){this.H=w},n.ea=function(w,I,C,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);I=I?I.toUpperCase():"GET",this.D=w,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Zw.g(),this.g.onreadystatechange=_(d(this.Ca,this));try{this.B=!0,this.g.open(I,String(w),!0),this.B=!1}catch(ae){Hl(this,ae);return}if(w=C||"",C=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var te in L)C.set(te,L[te]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ae of L.keys())C.set(ae,L.get(ae));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(C.keys()).find(ae=>ae.toLowerCase()=="content-type"),te=o.FormData&&w instanceof o.FormData,!(Array.prototype.indexOf.call(aI,I,void 0)>=0)||L||te||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ce]of C)this.g.setRequestHeader(ae,Ce);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(w),this.v=!1}catch(ae){Hl(this,ae)}};function Hl(w,I){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=I,w.o=5,Gl(w),ba(w)}function Gl(w){w.A||(w.A=!0,yn(w,"complete"),yn(w,"error"))}n.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=w||7,yn(this,"complete"),yn(this,"abort"),ba(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ba(this,!0)),$t.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Aa(this):this.Xa())},n.Xa=function(){Aa(this)};function Aa(w){if(w.h&&typeof s<"u"){if(w.v&&Eo(w)==4)setTimeout(w.Ca.bind(w),0);else if(yn(w,"readystatechange"),Eo(w)==4){w.h=!1;try{const ae=w.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var C;if(!(C=I)){var L;if(L=ae===0){let Ce=String(w.D).match(s_)[1]||null;!Ce&&o.self&&o.self.location&&(Ce=o.self.location.protocol.slice(0,-1)),L=!l_.test(Ce?Ce.toLowerCase():"")}C=L}if(C)yn(w,"complete"),yn(w,"success");else{w.o=6;try{var te=Eo(w)>2?w.g.statusText:""}catch{te=""}w.l=te+" ["+w.ca()+"]",Gl(w)}}finally{ba(w)}}}}function ba(w,I){if(w.g){w.m&&(clearTimeout(w.m),w.m=null);const C=w.g;w.g=null,I||yn(w,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Eo(w){return w.g?w.g.readyState:0}n.ca=function(){try{return Eo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(w){if(this.g){var I=this.g.responseText;return w&&I.indexOf(w)==0&&(I=I.substring(w.length)),bu(I)}};function c_(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.F){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function xg(w){const I={};w=(w.g&&Eo(w)>=2&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<w.length;L++){if(V(w[L]))continue;var C=Hh(w[L]);const te=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ae=I[te]||[];I[te]=ae,ae.push(C)}ne(I,function(L){return L.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function xo(w,I,C){return C&&C.internalChannelParams&&C.internalChannelParams[w]||I}function Kh(w){this.za=0,this.i=[],this.j=new Jn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=xo("failFast",!1,w),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=xo("baseRetryDelayMs",5e3,w),this.Za=xo("retryDelaySeedMs",1e4,w),this.Ta=xo("forwardChannelMaxRetries",2,w),this.va=xo("forwardChannelRequestTimeoutMs",2e4,w),this.ma=w&&w.xmlHttpFactory||void 0,this.Ua=w&&w.Rb||void 0,this.Aa=w&&w.useFetchStreams||!1,this.O=void 0,this.L=w&&w.supportsCrossDomainXhr||!1,this.M="",this.h=new jh(w&&w.concurrentRequestLimit),this.Ba=new Ou,this.S=w&&w.fastHandshake||!1,this.R=w&&w.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=w&&w.Pb||!1,w&&w.ua&&this.j.ua(),w&&w.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&w&&w.detectBufferingProxy||!1,this.ia=void 0,w&&w.longPollingTimeout&&w.longPollingTimeout>0&&(this.ia=w.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Kh.prototype,n.ka=8,n.I=1,n.connect=function(w,I,C,L){ue(0),this.W=w,this.H=I||{},C&&L!==void 0&&(this.H.OSID=C,this.H.OAID=L),this.F=this.X,this.J=Ig(this,null,this.W),Ca(this)};function Qh(w){if(Jh(w),w.I==3){var I=w.V++,C=ts(w.J);if(Dt(C,"SID",w.M),Dt(C,"RID",I),Dt(C,"TYPE","terminate"),To(w,C),I=new es(w,w.j,I),I.M=2,I.A=Ta(ts(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(I.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=I.A,C=!0),C||(I.g=d_(I.j,null),I.g.ea(I.A)),I.F=Date.now(),Su(I)}Uu(w)}function Ri(w){w.g&&(Fu(w),w.g.cancel(),w.g=null)}function Jh(w){Ri(w),w.v&&(o.clearTimeout(w.v),w.v=null),Yh(w),w.h.cancel(),w.m&&(typeof w.m=="number"&&o.clearTimeout(w.m),w.m=null)}function Ca(w){if(!hg(w.h)&&!w.m){w.m=!0;var I=w.Ea;W||k(),$||(W(),$=!0),D.add(I,w),w.D=0}}function u_(w,I){return ku(w.h)>=w.h.j-(w.m?1:0)?!1:w.m?(w.i=I.G.concat(w.i),!0):w.I==1||w.I==2||w.D>=(w.Sa?0:w.Ta)?!1:(w.m=xt(d(w.Ea,w,I),Zh(w,w.D)),w.D++,!0)}n.Ea=function(w){if(this.m)if(this.m=null,this.I==1){if(!w){this.V=Math.floor(Math.random()*1e5),w=this.V++;const te=new es(this,this.j,w);let ae=this.o;if(this.U&&(ae?(ae=z(ae),Pe(ae,this.U)):ae=this.U),this.u!==null||this.R||(te.J=ae,ae=null),this.S)e:{for(var I=0,C=0;C<this.i.length;C++){t:{var L=this.i[C];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(I+=L,I>4096){I=C;break e}if(I===4096||C===this.i.length-1){I=C+1;break e}}I=1e3}else I=1e3;I=Tg(this,te,I),C=ts(this.J),Dt(C,"RID",w),Dt(C,"CVER",22),this.G&&Dt(C,"X-HTTP-Session-Id",this.G),To(this,C),ae&&(this.R?I="headers="+po(a_(ae))+"&"+I:this.u&&Wh(C,this.u,ae)),qh(this.h,te),this.Ra&&Dt(C,"TYPE","init"),this.S?(Dt(C,"$req",I),Dt(C,"SID","null"),te.U=!0,Rs(te,C,null)):Rs(te,C,I),this.I=2}}else this.I==3&&(w?Vu(this,w):this.i.length==0||hg(this.h)||Vu(this))};function Vu(w,I){var C;I?C=I.l:C=w.V++;const L=ts(w.J);Dt(L,"SID",w.M),Dt(L,"RID",C),Dt(L,"AID",w.K),To(w,L),w.u&&w.o&&Wh(L,w.u,w.o),C=new es(w,w.j,C,w.D+1),w.u===null&&(C.J=w.o),I&&(w.i=I.G.concat(w.i)),I=Tg(w,C,1e3),C.H=Math.round(w.va*.5)+Math.round(w.va*.5*Math.random()),qh(w.h,C),Rs(C,L,I)}function To(w,I){w.H&&xe(w.H,function(C,L){Dt(I,L,C)}),w.l&&xe({},function(C,L){Dt(I,L,C)})}function Tg(w,I,C){C=Math.min(w.i.length,C);const L=w.l?d(w.l.Ka,w.l,w):null;e:{var te=w.i;let ot=-1;for(;;){const Nn=["count="+C];ot==-1?C>0?(ot=te[0].g,Nn.push("ofs="+ot)):ot=0:Nn.push("ofs="+ot);let Ft=!0;for(let Vn=0;Vn<C;Vn++){var ae=te[Vn].g;const Mi=te[Vn].map;if(ae-=ot,ae<0)ot=Math.max(0,te[Vn].g-100),Ft=!1;else try{ae="req"+ae+"_"||"";try{var Ce=Mi instanceof Map?Mi:Object.entries(Mi);for(const[Sa,Ao]of Ce){let bo=Ao;a(Ao)&&(bo=Cs(Ao)),Nn.push(ae+Sa+"="+encodeURIComponent(bo))}}catch(Sa){throw Nn.push(ae+"type="+encodeURIComponent("_badmap")),Sa}}catch{L&&L(Mi)}}if(Ft){Ce=Nn.join("&");break e}}Ce=void 0}return w=w.i.splice(0,C),I.G=w,Ce}function Ar(w){if(!w.g&&!w.v){w.Y=1;var I=w.Da;W||k(),$||(W(),$=!0),D.add(I,w),w.A=0}}function Io(w){return w.g||w.v||w.A>=3?!1:(w.Y++,w.v=xt(d(w.Da,w),Zh(w,w.A)),w.A++,!0)}n.Da=function(){if(this.v=null,jl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var w=4*this.T;this.j.info("BP detection timer enabled: "+w),this.B=xt(d(this.Wa,this),w)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ue(10),Ri(this),jl(this))};function Fu(w){w.B!=null&&(o.clearTimeout(w.B),w.B=null)}function jl(w){w.g=new es(w,w.j,"rpc",w.Y),w.u===null&&(w.g.J=w.o),w.g.P=0;var I=ts(w.na);Dt(I,"RID","rpc"),Dt(I,"SID",w.M),Dt(I,"AID",w.K),Dt(I,"CI",w.F?"0":"1"),!w.F&&w.ia&&Dt(I,"TO",w.ia),Dt(I,"TYPE","xmlhttp"),To(w,I),w.u&&w.o&&Wh(I,w.u,w.o),w.O&&(w.g.H=w.O);var C=w.g;w=w.ba,C.M=1,C.A=Ta(ts(I)),C.u=null,C.R=!0,ug(C,w)}n.Va=function(){this.C!=null&&(this.C=null,Ri(this),Io(this),ue(19))};function Yh(w){w.C!=null&&(o.clearTimeout(w.C),w.C=null)}function Xh(w,I){var C=null;if(w.g==I){Yh(w),Fu(w),w.g=null;var L=2}else if(fg(w.h,I))C=I.G,Pu(w.h,I),L=1;else return;if(w.I!=0){if(I.o)if(L==1){C=I.u?I.u.length:0,I=Date.now()-I.F;var te=w.D;L=Ss(),yn(L,new tt(L,C)),Ca(w)}else Ar(w);else if(te=I.m,te==3||te==0&&I.X>0||!(L==1&&u_(w,I)||L==2&&Io(w)))switch(C&&C.length>0&&(I=w.h,I.i=I.i.concat(C)),te){case 1:Di(w,5);break;case 4:Di(w,10);break;case 3:Di(w,6);break;default:Di(w,2)}}}function Zh(w,I){let C=w.Qa+Math.floor(Math.random()*w.Za);return w.isActive()||(C*=2),C*I}function Di(w,I){if(w.j.info("Error code "+I),I==2){var C=d(w.bb,w),L=w.Ua;const te=!L;L=new mo(L||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ru(L,"https"),Ta(L),te?_o(L.toString(),C):vo(L.toString(),C)}else ue(2);w.I=0,w.l&&w.l.pa(I),Uu(w),Jh(w)}n.bb=function(w){w?(this.j.info("Successfully pinged google.com"),ue(2)):(this.j.info("Failed to ping google.com"),ue(1))};function Uu(w){if(w.I=0,w.ja=[],w.l){const I=Ni(w.h);(I.length!=0||w.i.length!=0)&&(b(w.ja,I),b(w.ja,w.i),w.h.i.length=0,x(w.i),w.i.length=0),w.l.oa()}}function Ig(w,I,C){var L=C instanceof mo?ts(C):new mo(C);if(L.g!="")I&&(L.g=I+"."+L.g),go(L,L.u);else{var te=o.location;L=te.protocol,I=I?I+"."+te.hostname:te.hostname,te=+te.port;const ae=new mo(null);L&&Ru(ae,L),I&&(ae.g=I),te&&go(ae,te),C&&(ae.h=C),L=ae}return C=w.G,I=w.wa,C&&I&&Dt(L,C,I),Dt(L,"VER",w.ka),To(w,L),L}function d_(w,I,C){if(I&&!w.L)throw Error("Can't create secondary domain capable XhrIo object.");return I=w.Aa&&!w.ma?new $t(new Ia({ab:C})):new $t(w.ma),I.Fa(w.L),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function h_(){}n=h_.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ef(){}ef.prototype.g=function(w,I){return new fr(w,I)};function fr(w,I){gn.call(this),this.g=new Kh(I),this.l=w,this.h=I&&I.messageUrlParams||null,w=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(w?w["X-WebChannel-Content-Type"]=I.messageContentType:w={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.sa&&(w?w["X-WebChannel-Client-Profile"]=I.sa:w={"X-WebChannel-Client-Profile":I.sa}),this.g.U=w,(w=I&&I.Qb)&&!V(w)&&(this.g.u=w),this.A=I&&I.supportsCrossDomainXhr||!1,this.v=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!V(I)&&(this.g.G=I,w=this.h,w!==null&&I in w&&(w=this.h,I in w&&delete w[I])),this.j=new ql(this)}m(fr,gn),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){Qh(this.g)},fr.prototype.o=function(w){var I=this.g;if(typeof w=="string"){var C={};C.__data__=w,w=C}else this.v&&(C={},C.__data__=Cs(w),w=C);I.i.push(new sI(I.Ya++,w)),I.I==3&&Ca(I)},fr.prototype.N=function(){this.g.l=null,delete this.j,Qh(this.g),delete this.g,fr.Z.N.call(this)};function f_(w){Dl.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var I=w.__sm__;if(I){e:{for(const C in I){w=C;break e}w=void 0}(this.i=w)&&(w=this.i,I=I!==null&&w in I?I[w]:void 0),this.data=I}else this.data=w}m(f_,Dl);function p_(){Cu.call(this),this.status=1}m(p_,Cu);function ql(w){this.g=w}m(ql,h_),ql.prototype.ra=function(){yn(this.g,"a")},ql.prototype.qa=function(w){yn(this.g,new f_(w))},ql.prototype.pa=function(w){yn(this.g,new p_)},ql.prototype.oa=function(){yn(this.g,"b")},ef.prototype.createWebChannel=ef.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,j3=function(){return new ef},G3=function(){return Ss()},H3=Ci,wC={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Vl.NO_ERROR=0,Vl.TIMEOUT=8,Vl.HTTP_ERROR=6,Lv=Vl,Fl.COMPLETE="complete",B3=Fl,va.EventType=fo,fo.OPEN="a",fo.CLOSE="b",fo.ERROR="c",fo.MESSAGE="d",gn.prototype.listen=gn.prototype.J,Ty=va,$t.prototype.listenOnce=$t.prototype.K,$t.prototype.getLastError=$t.prototype.Ha,$t.prototype.getLastErrorCode=$t.prototype.ya,$t.prototype.getStatus=$t.prototype.ca,$t.prototype.getResponseJson=$t.prototype.La,$t.prototype.getResponseText=$t.prototype.la,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Fa,U3=$t}).apply(typeof dv<"u"?dv:typeof self<"u"?self:typeof window<"u"?window:{});const sM="@firebase/firestore",oM="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qm="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=new Bm("@firebase/firestore");function Df(){return iu.logLevel}function yX(n){iu.setLogLevel(n)}function ge(n,...e){if(iu.logLevel<=wt.DEBUG){const t=e.map(a1);iu.debug(`Firestore (${Qm}): ${n}`,...t)}}function Dn(n,...e){if(iu.logLevel<=wt.ERROR){const t=e.map(a1);iu.error(`Firestore (${Qm}): ${n}`,...t)}}function pa(n,...e){if(iu.logLevel<=wt.WARN){const t=e.map(a1);iu.warn(`Firestore (${Qm}): ${n}`,...t)}}function a1(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,q3(n,r,t)}function q3(n,e,t){let r=`FIRESTORE (${Qm}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Dn(r),new Error(r)}function je(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||q3(e,i,r)}function wX(n,e){n||Le(57014,e)}function ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends Vr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _X{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class vX{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class EX{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){je(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new xr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new xr,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},a=c=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new xr)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(je(typeof r.accessToken=="string",31837,{l:r}),new z3(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class xX{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=or.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class TX{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new xX(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class aM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IX{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ln(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){je(this.o===void 0,3512);const r=s=>{s.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new aM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new aM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AX(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=AX(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function rt(n,e){return n<e?-1:n>e?1:0}function _C(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return XA(i)===XA(s)?rt(i,s):XA(i)?1:-1}return rt(n.length,e.length)}const bX=55296,CX=57343;function XA(n){const e=n.charCodeAt(0);return e>=bX&&e<=CX}function cm(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function $3(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM="__name__";class Do{constructor(e,t,r){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Le(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Do.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Do?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Do.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return rt(e.length,t.length)}static compareSegments(e,t){const r=Do.isNumericId(e),i=Do.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Do.extractNumericId(e).compare(Do.extractNumericId(t)):_C(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wc.fromString(e.substring(4,e.length-2))}}class vt extends Do{construct(e,t,r){return new vt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new fe(oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new vt(t)}static emptyPath(){return new vt([])}}const SX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fn extends Do{construct(e,t,r){return new fn(e,t,r)}static isValidIdentifier(e){return SX.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===lM}static keyField(){return new fn([lM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new fe(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new fe(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new fe(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new fe(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fn(t)}static emptyPath(){return new fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(vt.fromString(e))}static fromName(e){return new Se(vt.fromString(e).popFirst(5))}static empty(){return new Se(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new vt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(n,e,t){if(!t)throw new fe(oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function W3(n,e,t,r){if(e===!0&&r===!0)throw new fe(oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function cM(n){if(!Se.isDocumentKey(n))throw new fe(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function uM(n){if(Se.isDocumentKey(n))throw new fe(oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function K3(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function uT(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function Pt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fe(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uT(n);throw new fe(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Q3(n,e){if(e<=0)throw new fe(oe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Nw(n,e){if(!K3(n))throw new fe(oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new fe(oe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=-62135596800,hM=1e6;class Lt{static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*hM);return new Lt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<dM)throw new fe(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hM}_compareTo(e){return this.seconds===e.seconds?rt(this.nanoseconds,e.nanoseconds):rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nw(e,Lt._jsonSchema))return new Lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Lt._jsonSchemaVersion="firestore/timestamp/1.0",Lt._jsonSchema={type:Gn("string",Lt._jsonSchemaVersion),seconds:Gn("number"),nanoseconds:Gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{static fromTimestamp(e){return new $e(e)}static min(){return new $e(new Lt(0,0))}static max(){return new $e(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=-1;class kE{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function vC(n){return n.fields.find((e=>e.kind===2))}function id(n){return n.fields.filter((e=>e.kind!==2))}kE.UNKNOWN_ID=-1;class Ov{constructor(e,t){this.fieldPath=e,this.kind=t}}class T0{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new T0(0,Zi.min())}}function J3(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=$e.fromTimestamp(r===1e9?new Lt(t+1,0):new Lt(t,r));return new Zi(i,Se.empty(),e)}function Y3(n){return new Zi(n.readTime,n.key,um)}class Zi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zi($e.min(),Se.empty(),um)}static max(){return new Zi($e.max(),Se.empty(),um)}}function u1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(n.documentKey,e.documentKey),t!==0?t:rt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Z3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wu(n){if(n.code!==oe.FAILED_PRECONDITION||n.message!==X3)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,r)=>{t(e)}))}static reject(e){return new Z(((t,r)=>{r(e)}))}static waitFor(e){return new Z(((t,r)=>{let i=0,s=0,o=!1;e.forEach((a=>{++i,a.next((()=>{++s,o&&s===i&&t()}),(c=>r(c)))})),o=!0,s===i&&t()}))}static or(e){let t=Z.resolve(!1);for(const r of e)t=t.next((i=>i?Z.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new Z(((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const d=c;t(e[d]).next((h=>{o[d]=h,++a,a===s&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new Z(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="SimpleDb";class dT{static open(e,t,r,i){try{return new dT(t,e.transaction(i,r))}catch(s){throw new jy(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new xr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new jy(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=d1(r.target.error);this.S.reject(new jy(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ge(zi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new kX(t)}}class oa{static delete(e){return ge(zi,"Removing database:",e),ld(KS().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!eh())return!1;if(oa.F())return!0;const e=xn(),t=oa.M(e),r=0<t&&t<10,i=eU(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,oa.M(xn())===12.2&&Dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ge(zi,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new jy(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new fe(oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new fe(oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new jy(e,o))},i.onupgradeneeded=s=>{ge(zi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{ge(zi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=dT.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next((d=>(a.C(),d))).catch((d=>(a.abort(d),Z.reject(d)))).toPromise();return c.catch((()=>{})),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(ge(zi,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eU(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class NX{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ld(this.U.delete())}}class jy extends fe{constructor(e,t){super(oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function _u(n){return n.name==="IndexedDbTransactionError"}class kX{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(ge(zi,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(ge(zi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ld(r)}add(e){return ge(zi,"ADD",this.store.name,e,e),ld(this.store.add(e))}get(e){return ld(this.store.get(e)).next((t=>(t===void 0&&(t=null),ge(zi,"GET",this.store.name,e,t),t)))}delete(e){return ge(zi,"DELETE",this.store.name,e),ld(this.store.delete(e))}count(){return ge(zi,"COUNT",this.store.name),ld(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new Z(((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(r),o=[];return this.H(s,((a,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new Z(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){ge(zi,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,o,a)=>a.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new Z(((r,i)=>{t.onerror=s=>{const o=d1(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():r()})):r()}}))}H(e,t){const r=[];return new Z(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const c=new NX(a),d=t(a.primaryKey,a.value,c);if(d instanceof Z){const h=d.catch((m=>(c.done(),Z.reject(m))));r.push(h)}c.isDone?i():c.G===null?a.continue():a.continue(c.G)}})).next((()=>Z.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ld(n){return new Z(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=d1(r.target.error);t(i)}}))}let fM=!1;function d1(n){const e=oa.M(xn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new fe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fM||(fM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const qy="IndexBackfiller";class PX{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ge(qy,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ge(qy,`Documents written: ${t}`)}catch(t){_u(t)?ge(qy,"Ignoring IndexedDB error during index backfill: ",t):await wu(t)}await this.re(6e4)}))}}class RX{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return Z.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return ge(qy,`Processing collection: ${o}`),this.oe(e,o,i).next((a=>{i-=a,r.add(o)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((a=>(ge(qy,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const o=Y3(s);u1(o,r)>0&&(r=o)})),new Zi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_i.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function kw(n){return n==null}function I0(n){return n===0&&1/n==-1/0}function tU(n){return typeof n=="number"&&Number.isInteger(n)&&!I0(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE="";function Ur(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pM(e)),e=DX(n.get(t),e);return pM(e)}function DX(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case PE:t+="";break;default:t+=s}}return t}function pM(n){return n+PE+""}function Zo(n){const e=n.length;if(je(e>=2,64408,{path:n}),e===2)return je(n.charAt(0)===PE&&n.charAt(1)==="",56145,{path:n}),vt.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf(PE,s);switch((o<0||o>t)&&Le(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Le(61167,{path:n})}s=o+2}return new vt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="remoteDocuments",Pw="owner",Af="owner",A0="mutationQueues",MX="userId",Qs="mutations",mM="batchId",Ed="userMutationsIndex",gM=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(n,e){return[n,Ur(e)]}function nU(n,e,t){return[n,Ur(e),t]}const LX={},dm="documentMutations",RE="remoteDocumentsV14",OX=["prefixPath","collectionGroup","readTime","documentId"],Fv="documentKeyIndex",VX=["prefixPath","collectionGroup","documentId"],rU="collectionGroupIndex",FX=["collectionGroup","readTime","prefixPath","documentId"],b0="remoteDocumentGlobal",EC="remoteDocumentGlobalKey",hm="targets",iU="queryTargetsIndex",UX=["canonicalId","targetId"],fm="targetDocuments",BX=["targetId","path"],h1="documentTargetsIndex",HX=["path","targetId"],DE="targetGlobalKey",Yd="targetGlobal",C0="collectionParents",GX=["collectionId","parent"],pm="clientMetadata",jX="clientId",hT="bundles",qX="bundleId",fT="namedQueries",zX="name",f1="indexConfiguration",$X="indexId",xC="collectionGroupIndex",WX="collectionGroup",zy="indexState",KX=["indexId","uid"],sU="sequenceNumberIndex",QX=["uid","sequenceNumber"],$y="indexEntries",JX=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oU="documentKeyIndex",YX=["indexId","uid","orderedDocumentKey"],pT="documentOverlays",XX=["userId","collectionPath","documentId"],TC="collectionPathOverlayIndex",ZX=["userId","collectionPath","largestBatchId"],aU="collectionGroupOverlayIndex",eZ=["userId","collectionGroup","largestBatchId"],p1="globals",tZ="name",lU=[A0,Qs,dm,sd,hm,Pw,Yd,fm,pm,b0,C0,hT,fT],nZ=[...lU,pT],cU=[A0,Qs,dm,RE,hm,Pw,Yd,fm,pm,b0,C0,hT,fT,pT],uU=cU,m1=[...uU,f1,zy,$y],rZ=m1,dU=[...m1,p1],iZ=dU;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends Z3{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qn(n,e){const t=ke(n);return oa.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function hU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t){this.comparator=e,this.root=t||yr.EMPTY}insert(e,t){return new en(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(e){return new en(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hv(this.root,e,this.comparator,!1)}getReverseIterator(){return new hv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hv(this.root,e,this.comparator,!0)}}class hv{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??yr.RED,this.left=i??yr.EMPTY,this.right=s??yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new yr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return yr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return yr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new yr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wM(this.data.getIterator())}getIteratorFrom(e){return new wM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ht(this.comparator);return t.data=e,t}}class wM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function bf(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.fields=e,e.sort(fn.comparator)}static empty(){return new vi([])}unionWith(e){let t=new Ht(fn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new vi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cm(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sZ(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fU("Invalid base64 string: "+s):s}})(e);return new bn(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new bn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bn.EMPTY_BYTE_STRING=new bn("");const oZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ml(n){if(je(!!n,39018),typeof n=="string"){let e=0;const t=oZ.exec(n);if(je(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dn(n.seconds),nanos:dn(n.nanos)}}function dn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gl(n){return typeof n=="string"?bn.fromBase64String(n):bn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU="server_timestamp",mU="__type__",gU="__previous_value__",yU="__local_write_time__";function mT(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[mU])==null?void 0:r.stringValue)===pU}function gT(n){const e=n.mapValue.fields[gU];return mT(e)?gT(e):e}function S0(n){const e=ml(n.mapValue.fields[yU].timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aZ{constructor(e,t,r,i,s,o,a,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}}const AC="(default)";class su{constructor(e,t){this.projectId=e,this.database=t||AC}static empty(){return new su("","")}get isDefaultDatabase(){return this.database===AC}isEqual(e){return e instanceof su&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1="__type__",wU="__max__",Uc={mapValue:{fields:{__type__:{stringValue:wU}}}},y1="__vector__",mm="value",Uv={nullValue:"NULL_VALUE"};function ou(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?mT(n)?4:_U(n)?9007199254740991:yT(n)?10:11:Le(28295,{value:n})}function ma(n,e){if(n===e)return!0;const t=ou(n);if(t!==ou(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return S0(n).isEqual(S0(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ml(i.timestampValue),a=ml(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return gl(i.bytesValue).isEqual(gl(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return dn(i.geoPointValue.latitude)===dn(s.geoPointValue.latitude)&&dn(i.geoPointValue.longitude)===dn(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return dn(i.integerValue)===dn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=dn(i.doubleValue),a=dn(s.doubleValue);return o===a?I0(o)===I0(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return cm(n.arrayValue.values||[],e.arrayValue.values||[],ma);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(yM(o)!==yM(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!ma(o[c],a[c])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function N0(n,e){return(n.values||[]).find((t=>ma(t,e)))!==void 0}function au(n,e){if(n===e)return 0;const t=ou(n),r=ou(e);if(t!==r)return rt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return rt(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=dn(s.integerValue||s.doubleValue),c=dn(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return _M(n.timestampValue,e.timestampValue);case 4:return _M(S0(n),S0(e));case 5:return _C(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=gl(s),c=gl(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=rt(a[d],c[d]);if(h!==0)return h}return rt(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=rt(dn(s.latitude),dn(o.latitude));return a!==0?a:rt(dn(s.longitude),dn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return vM(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var _,x,b,A;const a=s.fields||{},c=o.fields||{},d=(_=a[mm])==null?void 0:_.arrayValue,h=(x=c[mm])==null?void 0:x.arrayValue,m=rt(((b=d==null?void 0:d.values)==null?void 0:b.length)||0,((A=h==null?void 0:h.values)==null?void 0:A.length)||0);return m!==0?m:vM(d,h)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Uc.mapValue&&o===Uc.mapValue)return 0;if(s===Uc.mapValue)return 1;if(o===Uc.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const _=_C(c[m],h[m]);if(_!==0)return _;const x=au(a[c[m]],d[h[m]]);if(x!==0)return x}return rt(c.length,h.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function _M(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return rt(n,e);const t=ml(n),r=ml(e),i=rt(t.seconds,r.seconds);return i!==0?i:rt(t.nanos,r.nanos)}function vM(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=au(t[i],r[i]);if(s)return s}return rt(t.length,r.length)}function gm(n){return bC(n)}function bC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ml(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return gl(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Se.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=bC(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${bC(t.fields[o])}`;return i+"}"})(n.mapValue):Le(61005,{value:n})}function Bv(n){switch(ou(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gT(n);return e?16+Bv(e):16;case 5:return 2*n.stringValue.length;case 6:return gl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Bv(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return vu(r.fields,((s,o)=>{i+=s.length+Bv(o)})),i})(n.mapValue);default:throw Le(13486,{value:n})}}function lh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function CC(n){return!!n&&"integerValue"in n}function k0(n){return!!n&&"arrayValue"in n}function EM(n){return!!n&&"nullValue"in n}function xM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hv(n){return!!n&&"mapValue"in n}function yT(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[g1])==null?void 0:r.stringValue)===y1}function Wy(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return vu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Wy(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wy(n.arrayValue.values[t]);return e}return{...n}}function _U(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===wU}const vU={mapValue:{fields:{[g1]:{stringValue:y1},[mm]:{arrayValue:{}}}}};function lZ(n){return"nullValue"in n?Uv:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?lh(su.empty(),Se.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?yT(n)?vU:{mapValue:{}}:Le(35942,{value:n})}function cZ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?lh(su.empty(),Se.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?vU:"mapValue"in n?yT(n)?{mapValue:{}}:Uc:Le(61959,{value:n})}function TM(n,e){const t=au(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function IM(n,e){const t=au(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.value=e}static empty(){return new _r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Hv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wy(t)}setAll(e){let t=fn.emptyPath(),r={},i=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Wy(o):i.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Hv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ma(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Hv(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){vu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new _r(Wy(this.value))}}function EU(n){const e=[];return vu(n.fields,((t,r)=>{const i=new fn([t]);if(Hv(r)){const s=EU(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new vi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new an(e,0,$e.min(),$e.min(),$e.min(),_r.empty(),0)}static newFoundDocument(e,t,r,i){return new an(e,1,t,$e.min(),r,i,0)}static newNoDocument(e,t){return new an(e,2,t,$e.min(),$e.min(),_r.empty(),0)}static newUnknownDocument(e,t){return new an(e,3,t,$e.min(),$e.min(),_r.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_r.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_r.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof an&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new an(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,t){this.position=e,this.inclusive=t}}function AM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Se.comparator(Se.fromName(o.referenceValue),t.key):r=au(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function bM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ma(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,t="asc"){this.field=e,this.dir=t}}function uZ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{}class Et extends xU{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new dZ(e,t,r):t==="array-contains"?new pZ(e,r):t==="in"?new SU(e,r):t==="not-in"?new mZ(e,r):t==="array-contains-any"?new gZ(e,r):new Et(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hZ(e,r):new fZ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(au(t,this.value)):t!==null&&ou(this.value)===ou(t)&&this.matchesComparison(au(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bt extends xU{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Bt(e,t)}matches(e){return ym(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ym(n){return n.op==="and"}function SC(n){return n.op==="or"}function w1(n){return TU(n)&&ym(n)}function TU(n){for(const e of n.filters)if(e instanceof Bt)return!1;return!0}function NC(n){if(n instanceof Et)return n.field.canonicalString()+n.op.toString()+gm(n.value);if(w1(n))return n.filters.map((e=>NC(e))).join(",");{const e=n.filters.map((t=>NC(t))).join(",");return`${n.op}(${e})`}}function IU(n,e){return n instanceof Et?(function(r,i){return i instanceof Et&&r.op===i.op&&r.field.isEqual(i.field)&&ma(r.value,i.value)})(n,e):n instanceof Bt?(function(r,i){return i instanceof Bt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,a)=>s&&IU(o,i.filters[a])),!0):!1})(n,e):void Le(19439)}function AU(n,e){const t=n.filters.concat(e);return Bt.create(t,n.op)}function bU(n){return n instanceof Et?(function(t){return`${t.field.canonicalString()} ${t.op} ${gm(t.value)}`})(n):n instanceof Bt?(function(t){return t.op.toString()+" {"+t.getFilters().map(bU).join(" ,")+"}"})(n):"Filter"}class dZ extends Et{constructor(e,t,r){super(e,t,r),this.key=Se.fromName(r.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class hZ extends Et{constructor(e,t){super(e,"in",t),this.keys=CU("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class fZ extends Et{constructor(e,t){super(e,"not-in",t),this.keys=CU("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function CU(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>Se.fromName(r.referenceValue)))}class pZ extends Et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return k0(t)&&N0(t.arrayValue,this.value)}}class SU extends Et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&N0(this.value.arrayValue,t)}}class mZ extends Et{constructor(e,t){super(e,"not-in",t)}matches(e){if(N0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!N0(this.value.arrayValue,t)}}class gZ extends Et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!k0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>N0(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yZ{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function kC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new yZ(n,e,t,r,i,s,o)}function ch(n){const e=ke(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>NC(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),kw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>gm(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>gm(r))).join(",")),e.Te=t}return e.Te}function Rw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uZ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!IU(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bM(n.startAt,e.startAt)&&bM(n.endAt,e.endAt)}function ME(n){return Se.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function LE(n,e){return n.filters.filter((t=>t instanceof Et&&t.field.isEqual(e)))}function CM(n,e,t){let r=Uv,i=!0;for(const s of LE(n,e)){let o=Uv,a=!0;switch(s.op){case"<":case"<=":o=lZ(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Uv}TM({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];TM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function SM(n,e,t){let r=Uc,i=!0;for(const s of LE(n,e)){let o=Uc,a=!0;switch(s.op){case">=":case">":o=cZ(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Uc}IM({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];IM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function NU(n,e,t,r,i,s,o,a){return new Tl(n,e,t,r,i,s,o,a)}function Jm(n){return new Tl(n)}function NM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _1(n){return n.collectionGroup!==null}function rp(n){const e=ke(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ht(fn.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((d=>{d.isInequality()&&(a=a.add(d.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new P0(s,r))})),t.has(fn.keyField().canonicalString())||e.Ie.push(new P0(fn.keyField(),r))}return e.Ie}function ni(n){const e=ke(n);return e.Ee||(e.Ee=wZ(e,rp(n))),e.Ee}function wZ(n,e){if(n.limitType==="F")return kC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new P0(i.field,s)}));const t=n.endAt?new lu(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new lu(n.startAt.position,n.startAt.inclusive):null;return kC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function PC(n,e){const t=n.filters.concat([e]);return new Tl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function OE(n,e,t){return new Tl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Dw(n,e){return Rw(ni(n),ni(e))&&n.limitType===e.limitType}function kU(n){return`${ch(ni(n))}|lt:${n.limitType}`}function Mf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>bU(i))).join(", ")}]`),kw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>gm(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>gm(i))).join(",")),`Target(${r})`})(ni(n))}; limitType=${n.limitType})`}function Mw(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of rp(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){const d=AM(o,a,c);return o.inclusive?d<=0:d<0})(r.startAt,rp(r),i)||r.endAt&&!(function(o,a,c){const d=AM(o,a,c);return o.inclusive?d>=0:d>0})(r.endAt,rp(r),i))})(n,e)}function PU(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function RU(n){return(e,t)=>{let r=!1;for(const i of rp(n)){const s=_Z(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function _Z(n,e,t){const r=n.field.isKeyField()?Se.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),d=a.data.field(s);return c!==null&&d!==null?au(c,d):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Le(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return hU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vZ=new en(Se.comparator);function Ei(){return vZ}const DU=new en(Se.comparator);function Iy(...n){let e=DU;for(const t of n)e=e.insert(t.key,t);return e}function MU(n){let e=DU;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ea(){return Ky()}function LU(){return Ky()}function Ky(){return new Il((n=>n.toString()),((n,e)=>n.isEqual(e)))}const EZ=new en(Se.comparator),xZ=new Ht(Se.comparator);function ct(...n){let e=xZ;for(const t of n)e=e.add(t);return e}const TZ=new Ht(rt);function v1(){return TZ}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:I0(e)?"-0":e}}function OU(n){return{integerValue:""+n}}function VU(n,e){return tU(e)?OU(e):E1(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(){this._=void 0}}function IZ(n,e,t){return n instanceof wm?(function(i,s){const o={fields:{[mU]:{stringValue:pU},[yU]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&mT(s)&&(s=gT(s)),s&&(o.fields[gU]=s),{mapValue:o}})(t,e):n instanceof uh?UU(n,e):n instanceof dh?BU(n,e):(function(i,s){const o=FU(i,s),a=kM(o)+kM(i.Ae);return CC(o)&&CC(i.Ae)?OU(a):E1(i.serializer,a)})(n,e)}function AZ(n,e,t){return n instanceof uh?UU(n,e):n instanceof dh?BU(n,e):t}function FU(n,e){return n instanceof _m?(function(r){return CC(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class wm extends wT{}class uh extends wT{constructor(e){super(),this.elements=e}}function UU(n,e){const t=HU(e);for(const r of n.elements)t.some((i=>ma(i,r)))||t.push(r);return{arrayValue:{values:t}}}class dh extends wT{constructor(e){super(),this.elements=e}}function BU(n,e){let t=HU(e);for(const r of n.elements)t=t.filter((i=>!ma(i,r)));return{arrayValue:{values:t}}}class _m extends wT{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kM(n){return dn(n.integerValue||n.doubleValue)}function HU(n){return k0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,t){this.field=e,this.transform=t}}function bZ(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof uh&&i instanceof uh||r instanceof dh&&i instanceof dh?cm(r.elements,i.elements,ma):r instanceof _m&&i instanceof _m?ma(r.Ae,i.Ae):r instanceof wm&&i instanceof wm})(n.transform,e.transform)}class CZ{constructor(e,t){this.version=e,this.transformResults=t}}class pn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gv(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _T{}function GU(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xm(n.key,pn.none()):new Ym(n.key,n.data,pn.none());{const t=n.data,r=_r.empty();let i=new Ht(fn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Al(n.key,r,new vi(i.toArray()),pn.none())}}function SZ(n,e,t){n instanceof Ym?(function(i,s,o){const a=i.value.clone(),c=RM(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Al?(function(i,s,o){if(!Gv(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=RM(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(jU(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Qy(n,e,t,r){return n instanceof Ym?(function(s,o,a,c){if(!Gv(s.precondition,o))return a;const d=s.value.clone(),h=DM(s.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Al?(function(s,o,a,c){if(!Gv(s.precondition,o))return a;const d=DM(s.fieldTransforms,c,o),h=o.data;return h.setAll(jU(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(s,o,a){return Gv(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function NZ(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=FU(r.transform,i||null);s!=null&&(t===null&&(t=_r.empty()),t.set(r.field,s))}return t||null}function PM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cm(r,i,((s,o)=>bZ(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ym extends _T{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Al extends _T{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function jU(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function RM(n,e,t){const r=new Map;je(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,AZ(o,a,t[i]))}return r}function DM(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,IZ(s,o,e))}return r}class Xm extends _T{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class x1 extends _T{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&SZ(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Qy(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Qy(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=LU();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=GU(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument($e.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ct())}isEqual(e){return this.batchId===e.batchId&&cm(this.mutations,e.mutations,((t,r)=>PM(t,r)))&&cm(this.baseMutations,e.baseMutations,((t,r)=>PM(t,r)))}}class I1{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return EZ})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new I1(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kZ{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Un,bt;function qU(n){switch(n){case oe.OK:return Le(64938);case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function zU(n){if(n===void 0)return Dn("GRPC error has no .code"),oe.UNKNOWN;switch(n){case Un.OK:return oe.OK;case Un.CANCELLED:return oe.CANCELLED;case Un.UNKNOWN:return oe.UNKNOWN;case Un.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Un.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Un.INTERNAL:return oe.INTERNAL;case Un.UNAVAILABLE:return oe.UNAVAILABLE;case Un.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Un.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Un.NOT_FOUND:return oe.NOT_FOUND;case Un.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Un.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Un.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Un.ABORTED:return oe.ABORTED;case Un.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Un.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Un.DATA_LOSS:return oe.DATA_LOSS;default:return Le(39323,{code:n})}}(bt=Un||(Un={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PZ=new Wc([4294967295,4294967295],0);function MM(n){const e=$U().encode(n),t=new F3;return t.update(e),new Uint8Array(t.digest())}function LM(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wc([t,r],0),new Wc([i,s],0)]}class b1{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ay(`Invalid padding: ${t}`);if(r<0)throw new Ay(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ay(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ay(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Wc.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Wc.fromNumber(r)));return i.compare(PZ)===1&&(i=new Wc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=MM(e),[r,i]=LM(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new b1(s,i,t);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=MM(e),[r,i]=LM(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ay extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Vw.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ow($e.min(),i,new en(rt),Ei(),ct())}}class Vw{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Vw(r,t,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class WU{constructor(e,t){this.targetId=e,this.Ce=t}}class KU{constructor(e,t,r=bn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class OM{constructor(){this.ve=0,this.Fe=VM(),this.Me=bn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ct(),t=ct(),r=ct();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Le(38017,{changeType:s})}})),new Vw(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=VM()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class RZ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ei(),this.Je=fv(),this.He=fv(),this.Ye=new en(rt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(ME(s))if(r===0){const o=new Se(s.path);this.et(t,o,an.newNoDocument(o,$e.min()))}else je(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=gl(r).toUint8Array()}catch(c){if(c instanceof fU)return pa("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new b1(o,i,s)}catch(c){return pa(c instanceof Ay?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&ME(a.target)){const c=new Se(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,an.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let r=ct();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new Ow(e,t,this.Ye,this.je,r);return this.je=Ei(),this.Je=fv(),this.He=fv(),this.Ye=new en(rt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new OM,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ht(rt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ht(rt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new OM),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fv(){return new en(Se.comparator)}function VM(){return new en(Se.comparator)}const DZ={asc:"ASCENDING",desc:"DESCENDING"},MZ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LZ={and:"AND",or:"OR"};class OZ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function RC(n,e){return n.useProto3Json||kw(e)?e:{value:e}}function vm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QU(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function VZ(n,e){return vm(n,e.toTimestamp())}function Ln(n){return je(!!n,49232),$e.fromTimestamp((function(t){const r=ml(t);return new Lt(r.seconds,r.nanos)})(n))}function C1(n,e){return DC(n,e).canonicalString()}function DC(n,e){const t=(function(i){return new vt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function JU(n){const e=vt.fromString(n);return je(oB(e),10190,{key:e.toString()}),e}function R0(n,e){return C1(n.databaseId,e.path)}function aa(n,e){const t=JU(e);if(t.get(1)!==n.databaseId.projectId)throw new fe(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new fe(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Se(ZU(t))}function YU(n,e){return C1(n.databaseId,e)}function XU(n){const e=JU(n);return e.length===4?vt.emptyPath():ZU(e)}function MC(n){return new vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ZU(n){return je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function FM(n,e,t){return{name:R0(n,e),fields:t.value.mapValue.fields}}function eB(n,e,t){const r=aa(n,e.name),i=Ln(e.updateTime),s=e.createTime?Ln(e.createTime):$e.min(),o=new _r({mapValue:{fields:e.fields}}),a=an.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function FZ(n,e){return"found"in e?(function(r,i){je(!!i.found,43571),i.found.name,i.found.updateTime;const s=aa(r,i.found.name),o=Ln(i.found.updateTime),a=i.found.createTime?Ln(i.found.createTime):$e.min(),c=new _r({mapValue:{fields:i.found.fields}});return an.newFoundDocument(s,o,a,c)})(n,e):"missing"in e?(function(r,i){je(!!i.missing,3894),je(!!i.readTime,22933);const s=aa(r,i.missing),o=Ln(i.readTime);return an.newNoDocument(s,o)})(n,e):Le(7234,{result:e})}function UZ(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Le(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,h){return d.useProto3Json?(je(h===void 0||typeof h=="string",58123),bn.fromBase64String(h||"")):(je(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),bn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(d){const h=d.code===void 0?oe.UNKNOWN:zU(d.code);return new fe(h,d.message||"")})(o);t=new KU(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=aa(n,r.document.name),s=Ln(r.document.updateTime),o=r.document.createTime?Ln(r.document.createTime):$e.min(),a=new _r({mapValue:{fields:r.document.fields}}),c=an.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];t=new jv(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=aa(n,r.document),s=r.readTime?Ln(r.readTime):$e.min(),o=an.newNoDocument(i,s),a=r.removedTargetIds||[];t=new jv([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=aa(n,r.document),s=r.removedTargetIds||[];t=new jv([],s,i,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new kZ(i,s),a=r.targetId;t=new WU(a,o)}}return t}function D0(n,e){let t;if(e instanceof Ym)t={update:FM(n,e.key,e.value)};else if(e instanceof Xm)t={delete:R0(n,e.key)};else if(e instanceof Al)t={update:FM(n,e.key,e.data),updateMask:zZ(e.fieldMask)};else{if(!(e instanceof x1))return Le(16599,{Vt:e.type});t={verify:R0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const a=o.transform;if(a instanceof wm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof uh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof dh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _m)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Le(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:VZ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Le(27497)})(n,e.precondition)),t}function LC(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?pn.updateTime(Ln(s.updateTime)):s.exists!==void 0?pn.exists(s.exists):pn.none()})(e.currentDocument):pn.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,a){let c=null;if("setToServerValue"in a)je(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new wm;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new uh(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new dh(h)}else"increment"in a?c=new _m(o,a.increment):Le(16584,{proto:a});const d=fn.fromServerFormat(a.fieldPath);return new Lw(d,c)})(n,i))):[];if(e.update){e.update.name;const i=aa(n,e.update.name),s=new _r({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const d=c.fieldPaths||[];return new vi(d.map((h=>fn.fromServerFormat(h))))})(e.updateMask);return new Al(i,s,o,t,r)}return new Ym(i,s,t,r)}if(e.delete){const i=aa(n,e.delete);return new Xm(i,t)}if(e.verify){const i=aa(n,e.verify);return new x1(i,t)}return Le(1463,{proto:e})}function BZ(n,e){return n&&n.length>0?(je(e!==void 0,14353),n.map((t=>(function(i,s){let o=i.updateTime?Ln(i.updateTime):Ln(s);return o.isEqual($e.min())&&(o=Ln(s)),new CZ(o,i.transformResults||[])})(t,e)))):[]}function tB(n,e){return{documents:[YU(n,e.path)]}}function nB(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=YU(n,i);const s=(function(d){if(d.length!==0)return sB(Bt.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(d){if(d.length!==0)return d.map((h=>(function(_){return{field:Lf(_.field),direction:GZ(_.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=RC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function rB(n){let e=XU(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){je(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(m){const _=iB(m);return _ instanceof Bt&&w1(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((_=>(function(b){return new P0(Of(b.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(b.direction))})(_)))})(t.orderBy));let a=null;t.limit&&(a=(function(m){let _;return _=typeof m=="object"?m.value:m,kw(_)?null:_})(t.limit));let c=null;t.startAt&&(c=(function(m){const _=!!m.before,x=m.values||[];return new lu(x,_)})(t.startAt));let d=null;return t.endAt&&(d=(function(m){const _=!m.before,x=m.values||[];return new lu(x,_)})(t.endAt)),NU(e,i,o,s,a,"F",c,d)}function HZ(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function iB(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Of(t.unaryFilter.field);return Et.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Of(t.unaryFilter.field);return Et.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Of(t.unaryFilter.field);return Et.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Of(t.unaryFilter.field);return Et.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Et.create(Of(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Bt.create(t.compositeFilter.filters.map((r=>iB(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function GZ(n){return DZ[n]}function jZ(n){return MZ[n]}function qZ(n){return LZ[n]}function Lf(n){return{fieldPath:n.canonicalString()}}function Of(n){return fn.fromServerFormat(n.fieldPath)}function sB(n){return n instanceof Et?(function(t){if(t.op==="=="){if(xM(t.value))return{unaryFilter:{field:Lf(t.field),op:"IS_NAN"}};if(EM(t.value))return{unaryFilter:{field:Lf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xM(t.value))return{unaryFilter:{field:Lf(t.field),op:"IS_NOT_NAN"}};if(EM(t.value))return{unaryFilter:{field:Lf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lf(t.field),op:jZ(t.op),value:t.value}}})(n):n instanceof Bt?(function(t){const r=t.getFilters().map((i=>sB(i)));return r.length===1?r[0]:{compositeFilter:{op:qZ(t.op),filters:r}}})(n):Le(54877,{filter:n})}function zZ(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function oB(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,t,r,i,s=$e.min(),o=$e.min(),a=bn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new rl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e){this.yt=e}}function $Z(n,e){let t;if(e.document)t=eB(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Se.fromSegments(e.noDocument.path),i=fh(e.noDocument.readTime);t=an.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const r=Se.fromSegments(e.unknownDocument.path),i=fh(e.unknownDocument.version);t=an.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Lt(i[0],i[1]);return $e.fromTimestamp(s)})(e.readTime)),t}function UM(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:VE(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:R0(s,o.key),fields:o.data.value.mapValue.fields,updateTime:vm(s,o.version.toTimestamp()),createTime:vm(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:hh(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:hh(e.version)}}return r}function VE(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function hh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fh(n){const e=new Lt(n.seconds,n.nanoseconds);return $e.fromTimestamp(e)}function cd(n,e){const t=(e.baseMutations||[]).map((s=>LC(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>LC(n.yt,s))),i=Lt.fromMillis(e.localWriteTimeMs);return new T1(e.batchId,i,t,r)}function by(n){const e=fh(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?fh(n.lastLimboFreeSnapshotVersion):$e.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return je(o===1,1966,{count:o}),ni(Jm(XU(s.documents[0])))})(n.query):(function(s){return ni(rB(s))})(n.query),new rl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,bn.fromBase64String(n.resumeToken))}function lB(n,e){const t=hh(e.snapshotVersion),r=hh(e.lastLimboFreeSnapshotVersion);let i;i=ME(e.target)?tB(n.yt,e.target):nB(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ch(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function S1(n){const e=rB({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?OE(e,e.limit,"L"):e}function ZA(n,e){return new A1(e.largestBatchId,LC(n.yt,e.overlayMutation))}function BM(n,e){const t=e.path.lastSegment();return[n,Ur(e.path.popLast()),t]}function HM(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:hh(r.readTime),documentKey:Ur(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WZ{getBundleMetadata(e,t){return GM(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:fh(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return GM(e).put((function(i){return{bundleId:i.id,createTime:hh(Ln(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return jM(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:S1(s.bundledQuery),readTime:fh(s.readTime)}})(r)}))}saveNamedQuery(e,t){return jM(e).put((function(i){return{name:i.name,readTime:hh(Ln(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function GM(n){return Qn(n,hT)}function jM(n){return Qn(n,fT)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new vT(e,r)}getOverlay(e,t){return oy(e).get(BM(this.userId,t)).next((r=>r?ZA(this.serializer,r):null))}getOverlays(e,t){const r=ea();return Z.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,o)=>{const a=new A1(t,o);i.push(this.St(e,a))})),Z.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Ur(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(oy(e).Z(TC,a))})),Z.waitFor(s)}getOverlaysForCollection(e,t,r){const i=ea(),s=Ur(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return oy(e).J(TC,o).next((a=>{for(const c of a){const d=ZA(this.serializer,c);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=ea();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return oy(e).ee({index:aU,range:a},((c,d,h)=>{const m=ZA(this.serializer,d);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):h.done()})).next((()=>s))}St(e,t){return oy(e).put((function(i,s,o){const[a,c,d]=BM(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:D0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function oy(n){return Qn(n,pT)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KZ{bt(e){return Qn(e,p1)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?bn.fromUint8Array(r):bn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(dn(e.integerValue));else if("doubleValue"in e){const r=dn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),I0(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=ml(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(gl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?_U(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):yT(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Le(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){var o,a;const r=e.fields||{};this.Ft(t,53);const i=mm,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(t,15),t.Mt(dn(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Se.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ud.Kt=new ud;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=255;function QZ(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function qM(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=QZ(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class JZ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=qM(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=qM(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Cf),this.sn(255)}_n(){this.an(Cf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Cf?(this.sn(Cf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Cf?(this.an(Cf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class YZ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class XZ{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ay{constructor(){this.cn=new JZ,this.ln=new YZ(this.cn),this.hn=new XZ(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new dd(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:qv(this.En),directionalValue:qv(this.dn),orderedDocumentKey:qv(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function oc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=zM(n.En,e.En),t!==0?t:(t=zM(n.dn,e.dn),t!==0?t:Se.comparator(n.In,e.In)))}function zM(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function qv(n){return sF()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function $M(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class WM{constructor(e){this.mn=new Ht(((t,r)=>fn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=vC(e);if(t!==void 0&&!this.wn(t))return!1;const r=id(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const c=r[s];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ht(fn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ov(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ov(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ov(r.field,r.dir==="asc"?0:1)));return new kE(kE.UNKNOWN_ID,this.collectionId,t,T0.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cB(n){var t,r;if(je(n instanceof Et||n instanceof Bt,20012),n instanceof Et){if(n instanceof SU){const i=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((s=>Et.create(n.field,"==",s))))||[];return Bt.create(i,"or")}return n}const e=n.filters.map((i=>cB(i)));return Bt.create(e,n.op)}function ZZ(n){if(n.getFilters().length===0)return[];const e=FC(cB(n));return je(uB(e),7391),OC(e)||VC(e)?[e]:e.getFilters()}function OC(n){return n instanceof Et}function VC(n){return n instanceof Bt&&w1(n)}function uB(n){return OC(n)||VC(n)||(function(t){if(t instanceof Bt&&SC(t)){for(const r of t.getFilters())if(!OC(r)&&!VC(r))return!1;return!0}return!1})(n)}function FC(n){if(je(n instanceof Et||n instanceof Bt,34018),n instanceof Et)return n;if(n.filters.length===1)return FC(n.filters[0]);const e=n.filters.map((r=>FC(r)));let t=Bt.create(e,n.op);return t=FE(t),uB(t)?t:(je(t instanceof Bt,64498),je(ym(t),40251),je(t.filters.length>1,57927),t.filters.reduce(((r,i)=>N1(r,i))))}function N1(n,e){let t;return je(n instanceof Et||n instanceof Bt,38388),je(e instanceof Et||e instanceof Bt,25473),t=n instanceof Et?e instanceof Et?(function(i,s){return Bt.create([i,s],"and")})(n,e):KM(n,e):e instanceof Et?KM(e,n):(function(i,s){if(je(i.filters.length>0&&s.filters.length>0,48005),ym(i)&&ym(s))return AU(i,s.getFilters());const o=SC(i)?i:s,a=SC(i)?s:i,c=o.filters.map((d=>N1(d,a)));return Bt.create(c,"or")})(n,e),FE(t)}function KM(n,e){if(ym(e))return AU(e,n.getFilters());{const t=e.filters.map((r=>N1(n,r)));return Bt.create(t,"or")}}function FE(n){if(je(n instanceof Et||n instanceof Bt,11850),n instanceof Et)return n;const e=n.getFilters();if(e.length===1)return FE(e[0]);if(TU(n))return n;const t=e.map((i=>FE(i))),r=[];return t.forEach((i=>{i instanceof Et?r.push(i):i instanceof Bt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Bt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eee{constructor(){this.Cn=new k1}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Zi.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Zi.min())}updateCollectionGroup(e,t,r){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class k1{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ht(vt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ht(vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM="IndexedDbIndexManager",pv=new Uint8Array(0);class tee{constructor(e,t){this.databaseId=t,this.vn=new k1,this.Fn=new Il((r=>ch(r)),((r,i)=>Rw(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Ur(i)};return JM(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[$3(t),""],!1,!0);return JM(e).J(i).next((s=>{for(const o of s){if(o.collectionId!==t)break;r.push(Zo(o.parent))}return r}))}addFieldIndex(e,t){const r=ly(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=Nf(e);return s.next((a=>{o.put(HM(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=ly(e),i=Nf(e),s=Sf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ly(e),r=Sf(e),i=Nf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new WM(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Sf(e);let i=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{i&&(i=!!a),s.set(o,a)})))).next((()=>{if(i){let o=ct();const a=[];return Z.forEach(s,((c,d)=>{ge(QM,`Using index ${(function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map((q=>`${q.fieldPath}:${q.kind}`)).join(",")}`})(c)} to execute ${ch(t)}`);const h=(function(O,q){const W=vC(q);if(W===void 0)return null;for(const $ of LE(O,W.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null})(d,c),m=(function(O,q){const W=new Map;for(const $ of id(q))for(const D of LE(O,$.fieldPath))switch(D.op){case"==":case"in":W.set($.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return W.set($.fieldPath.canonicalString(),D.value),Array.from(W.values())}return null})(d,c),_=(function(O,q){const W=[];let $=!0;for(const D of id(q)){const k=D.kind===0?CM(O,D.fieldPath,O.startAt):SM(O,D.fieldPath,O.startAt);W.push(k.value),$&&($=k.inclusive)}return new lu(W,$)})(d,c),x=(function(O,q){const W=[];let $=!0;for(const D of id(q)){const k=D.kind===0?SM(O,D.fieldPath,O.endAt):CM(O,D.fieldPath,O.endAt);W.push(k.value),$&&($=k.inclusive)}return new lu(W,$)})(d,c),b=this.On(c,d,_),A=this.On(c,d,x),N=this.Nn(c,d,m),F=this.Bn(c.indexId,h,b,_.inclusive,A,x.inclusive,N);return Z.forEach(F,(B=>r.Y(B,t.limit).next((O=>{O.forEach((q=>{const W=Se.fromSegments(q.documentKey);o.has(W)||(o=o.add(W),a.push(W))}))}))))})).next((()=>a))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=ZZ(Bt.create(e.filters,"and")).map((r=>kC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,o,a){const c=(t!=null?t.length:1)*Math.max(r.length,s.length),d=c/(t!=null?t.length:1),h=[];for(let m=0;m<c;++m){const _=t?this.Ln(t[m/d]):pv,x=this.kn(e,_,r[m%d],i),b=this.qn(e,_,s[m%d],o),A=a.map((N=>this.kn(e,_,N,!0)));h.push(...this.createRange(x,b,A))}return h}kn(e,t,r,i){const s=new dd(e,Se.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new dd(e,Se.empty(),t,r);return i?s.An():s}xn(e,t){const r=new WM(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return Z.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(c){let d=new Ht(fn.comparator),h=!1;for(const m of c.filters)for(const _ of m.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?h=!0:d=d.add(_.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new ay;for(const i of id(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);ud.Kt.Dt(s,o)}return r.un()}Ln(e){const t=new ay;return ud.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new ay;return ud.Kt.Dt(lh(this.databaseId,t),r.Pn((function(s){const o=id(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new ay);let s=0;for(const o of id(e)){const a=r[s++];for(const c of i)if(this.Un(t,o.fieldPath)&&k0(a))i=this.Kn(i,o,a);else{const d=c.Pn(o.kind);ud.Kt.Dt(a,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const c=new ay;c.seed(a.un()),ud.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof Et&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=ly(e),i=Nf(e);return(t?r.J(xC,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const o=[];return Z.forEach(s,(a=>i.get([a.indexId,this.uid]).next((c=>{o.push((function(h,m){const _=m?new T0(m.sequenceNumber,new Zi(fh(m.readTime),new Se(Zo(m.documentKey)),m.largestBatchId)):T0.empty(),x=h.fields.map((([b,A])=>new Ov(fn.fromServerFormat(b),A)));return new kE(h.indexId,h.collectionGroup,x,_)})(a,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:rt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=ly(e),s=Nf(e);return this.Gn(e).next((o=>i.J(xC,IDBKeyRange.bound(t,t)).next((a=>Z.forEach(a,(c=>s.put(HM(c.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return Z.forEach(t,((i,s)=>{const o=r.get(i.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((a=>(r.set(i.collectionGroup,a),Z.forEach(a,(c=>this.zn(e,i,c).next((d=>{const h=this.jn(s,c);return d.isEqual(h)?Z.resolve():this.Jn(e,s,c,d,h)})))))))}))}Hn(e,t,r,i){return Sf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Sf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Sf(e);let s=new Ht(oc);return i.ee({index:oU,range:IDBKeyRange.only([r.indexId,this.uid,qv(this.$n(r,t))])},((o,a)=>{s=s.add(new dd(r.indexId,t,$M(a.arrayValue),$M(a.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Ht(oc);const i=this.Qn(t,e);if(i==null)return r;const s=vC(t);if(s!=null){const o=e.data.field(s.fieldPath);if(k0(o))for(const a of o.arrayValue.values||[])r=r.add(new dd(t.indexId,e.key,this.Ln(a),i))}else r=r.add(new dd(t.indexId,e.key,pv,i));return r}Jn(e,t,r,i,s){ge(QM,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,d,h,m,_){const x=c.getIterator(),b=d.getIterator();let A=bf(x),N=bf(b);for(;A||N;){let F=!1,B=!1;if(A&&N){const O=h(A,N);O<0?B=!0:O>0&&(F=!0)}else A!=null?B=!0:F=!0;F?(m(N),N=bf(b)):B?(_(A),A=bf(x)):(A=bf(x),N=bf(b))}})(i,s,oc,(a=>{o.push(this.Hn(e,t,r,a))}),(a=>{o.push(this.Yn(e,t,r,a))})),Z.waitFor(o)}Gn(e){let t=1;return Nf(e).ee({index:sU,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,a)=>oc(o,a))).filter(((o,a,c)=>!a||oc(o,c[a-1])!==0));const i=[];i.push(e);for(const o of r){const a=oc(o,e),c=oc(o,t);if(a===0)i[0]=e.An();else if(a>0&&c<0)i.push(o),i.push(o.An());else if(c>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,pv,Se.empty()),c=i[o+1].Vn(this.uid,pv,Se.empty());s.push(IDBKeyRange.bound(a,c))}return s}Zn(e,t){return oc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(YM)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Le(44426))))).next(YM)}}function JM(n){return Qn(n,C0)}function Sf(n){return Qn(n,$y)}function ly(n){return Qn(n,f1)}function Nf(n){return Qn(n,zy)}function YM(n){je(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;u1(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zi(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dB=41943040;class Mr{static withCacheSize(e){return new Mr(e,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(n,e,t){const r=n.store(Qs),i=n.store(dm),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=r.ee({range:o},((h,m,_)=>(a++,_.delete())));s.push(c.next((()=>{je(a===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const m=nU(e,h.key.path,t.batchId);s.push(i.delete(m)),d.push(h.key)}return Z.waitFor(s).next((()=>d))}function UE(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Le(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(dB,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class ET{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){je(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ET(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ac(e).ee({index:Ed,range:r},((i,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Vf(e),o=ac(e);return o.add({}).next((a=>{je(typeof a=="number",49019);const c=new T1(a,t,r,i),d=(function(x,b,A){const N=A.baseMutations.map((B=>D0(x.yt,B))),F=A.mutations.map((B=>D0(x.yt,B)));return{userId:b,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:N,mutations:F}})(this.serializer,this.userId,c),h=[];let m=new Ht(((_,x)=>rt(_.canonicalString(),x.canonicalString())));for(const _ of i){const x=nU(this.userId,_.key.path,a);m=m.add(_.key.path.popLast()),h.push(o.put(d)),h.push(s.put(x,LX))}return m.forEach((_=>{h.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[a]=c.keys()})),Z.waitFor(h).next((()=>c))}))}lookupMutationBatch(e,t){return ac(e).get(t).next((r=>r?(je(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),cd(this.serializer,r)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ac(e).ee({index:Ed,range:i},((o,a,c)=>{a.userId===this.userId&&(je(a.batchId>=r,47524,{tr:r}),s=cd(this.serializer,a)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Kc;return ac(e).ee({index:Ed,range:t,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Kc],[this.userId,Number.POSITIVE_INFINITY]);return ac(e).J(Ed,t).next((r=>r.map((i=>cd(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Vv(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Vf(e).ee({range:i},((o,a,c)=>{const[d,h,m]=o,_=Zo(h);if(d===this.userId&&t.path.isEqual(_))return ac(e).get(m).next((x=>{if(!x)throw Le(61480,{nr:o,batchId:m});je(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),s.push(cd(this.serializer,x))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ht(rt);const i=[];return t.forEach((s=>{const o=Vv(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Vf(e).ee({range:a},((d,h,m)=>{const[_,x,b]=d,A=Zo(x);_===this.userId&&s.path.isEqual(A)?r=r.add(b):m.done()}));i.push(c)})),Z.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Vv(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ht(rt);return Vf(e).ee({range:o},((c,d,h)=>{const[m,_,x]=c,b=Zo(_);m===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(x)):h.done()})).next((()=>this.rr(e,a)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(ac(e).get(s).next((o=>{if(o===null)throw Le(35274,{batchId:s});je(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(cd(this.serializer,o))})))})),Z.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return hB(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Vf(e).ee({range:r},((s,o,a)=>{if(s[0]===this.userId){const c=Zo(s[1]);i.push(c)}else a.done()})).next((()=>{je(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return fB(e,this.userId,t)}_r(e){return pB(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Kc,lastStreamToken:""}))}}function fB(n,e,t){const r=Vv(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Vf(n).ee({range:s,X:!0},((a,c,d)=>{const[h,m,_]=a;h===e&&m===i&&(o=!0),d.done()})).next((()=>o))}function ac(n){return Qn(n,Qs)}function Vf(n){return Qn(n,dm)}function pB(n){return Qn(n,A0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ph(0)}static cr(){return new ph(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nee{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new ph(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>$e.fromTimestamp(new Lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>kf(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(je(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return kf(e).ee(((o,a)=>{const c=by(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))})).next((()=>Z.waitFor(s))).next((()=>i))}forEachTarget(e,t){return kf(e).ee(((r,i)=>{const s=by(i);t(s)}))}lr(e){return ZM(e).get(DE).next((t=>(je(t!==null,2888),t)))}hr(e,t){return ZM(e).put(DE,t)}Pr(e,t){return kf(e).put(lB(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=ch(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return kf(e).ee({range:i,index:iU},((o,a,c)=>{const d=by(a);Rw(t,d.target)&&(s=d,c.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=yc(e);return t.forEach((o=>{const a=Ur(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))})),Z.waitFor(i)}removeMatchingKeys(e,t,r){const i=yc(e);return Z.forEach(t,(s=>{const o=Ur(s.path);return Z.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=yc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=yc(e);let s=ct();return i.ee({range:r,X:!0},((o,a,c)=>{const d=Zo(o[1]),h=new Se(d);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=Ur(t.path),i=IDBKeyRange.bound([r],[$3(r)],!1,!0);let s=0;return yc(e).ee({index:h1,X:!0,range:i},(([o,a],c,d)=>{o!==0&&(s++,d.done())})).next((()=>s>0))}At(e,t){return kf(e).get(t).next((r=>r?by(r):null))}}function kf(n){return Qn(n,hm)}function ZM(n){return Qn(n,Yd)}function yc(n){return Qn(n,fm)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL="LruGarbageCollector",ree=1048576;function tL([n,e],[t,r]){const i=rt(n,t);return i===0?rt(e,r):i}class iee{constructor(e){this.Ir=e,this.buffer=new Ht(tL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();tL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mB{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ge(eL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_u(t)?ge(eL,"Ignoring IndexedDB error during garbage collection: ",t):await wu(t)}await this.Vr(3e5)}))}}class see{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(_i.ce);const r=new iee(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(XM)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),XM):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i)))).next((m=>(r=m,a=Date.now(),this.removeTargets(e,r,t)))).next((m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(d=Date.now(),Df()<=wt.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m}))))}}function gB(n,e){return new see(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oee{constructor(e,t){this.db=e,this.garbageCollector=gB(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return mv(e,r)}removeReference(e,t,r){return mv(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return mv(e,t)}br(e,t){return(function(i,s){let o=!1;return pB(i).te((a=>fB(i,a,s).next((c=>(c&&(o=!0),Z.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const c=this.br(e,o).next((d=>{if(!d)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,$e.min()),yc(e).delete((function(m){return[0,Ur(m.path)]})(o)))))}));i.push(c)}})).next((()=>Z.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return mv(e,t)}Sr(e,t){const r=yc(e);let i,s=_i.ce;return r.ee({index:h1},(([o,a],{path:c,sequenceNumber:d})=>{o===0?(s!==_i.ce&&t(new Se(Zo(i)),s),s=d,i=c):s=_i.ce})).next((()=>{s!==_i.ce&&t(new Se(Zo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function mv(n,e){return yc(n).put((function(r,i){return{targetId:0,path:Ur(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(){this.changes=new Il((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,an.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aee{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Xu(e).put(r)}removeEntry(e,t,r){return Xu(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],VE(o),a[a.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=an.newInvalidDocument(t);return Xu(e).ee({index:Fv,range:IDBKeyRange.only(cy(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:an.newInvalidDocument(t)};return Xu(e).ee({index:Fv,range:IDBKeyRange.only(cy(t))},((i,s)=>{r={document:this.Cr(t,s),size:UE(s)}})).next((()=>r))}getEntries(e,t){let r=Ei();return this.Fr(e,t,((i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=Ei(),i=new en(Se.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,UE(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return Z.resolve();let i=new Ht(iL);t.forEach((c=>i=i.add(c)));const s=IDBKeyRange.bound(cy(i.first()),cy(i.last())),o=i.getIterator();let a=o.getNext();return Xu(e).ee({index:Fv,range:s},((c,d,h)=>{const m=Se.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&iL(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(cy(a)):h.done()})).next((()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),VE(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xu(e).J(IDBKeyRange.bound(a,c,!0)).next((d=>{s==null||s.incrementDocumentReadCount(d.length);let h=Ei();for(const m of d){const _=this.Cr(Se.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);_.isFoundDocument()&&(Mw(t,_)||i.has(_.key))&&(h=h.insert(_.key,_))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=Ei();const o=rL(t,r),a=rL(t,Zi.max());return Xu(e).ee({index:rU,range:IDBKeyRange.bound(o,a,!0)},((c,d,h)=>{const m=this.Cr(Se.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(m.key,m),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new lee(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return nL(e).get(EC).next((t=>(je(!!t,20021),t)))}Dr(e,t){return nL(e).put(EC,t)}Cr(e,t){if(t){const r=$Z(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual($e.min())))return r}return an.newInvalidDocument(e)}}function wB(n){return new aee(n)}class lee extends yB{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Il((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Ht(((s,o)=>rt(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=UM(this.Nr.serializer,o);i=i.add(s.path.popLast());const d=UE(c);r+=d-a.size,t.push(this.Nr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){const c=UM(this.Nr.serializer,o.convertToNoDocument($e.min()));t.push(this.Nr.addEntry(e,s,c))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function nL(n){return Qn(n,b0)}function Xu(n){return Qn(n,RE)}function cy(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rL(n,e){const t=e.documentKey.path.toArray();return[n,VE(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function iL(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=rt(t[s],r[s]),i)return i;return i=rt(t.length,r.length),i||(i=rt(t[t.length-2],r[r.length-2]),i||rt(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cee{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _B{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Qy(r.mutation,i,vi.empty(),Lt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,ct()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=ct()){const i=ea();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let o=Iy();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=ea();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ct())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,r,i){let s=Ei();const o=Ky(),a=(function(){return Ky()})();return t.forEach(((c,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Al)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Qy(h.mutation,d,h.mutation.getFieldMask(),Lt.now())):o.set(d.key,vi.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>a.set(d,new cee(h,o.get(d)??null)))),a)))}recalculateAndSaveOverlays(e,t){const r=Ky();let i=new en(((o,a)=>o-a)),s=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const d=t.get(c);if(d===null)return;let h=r.get(c)||vi.empty();h=a.applyToLocalView(d,h),r.set(c,h);const m=(i.get(a.batchId)||ct()).add(c);i=i.insert(a.batchId,m)}))})).next((()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,m=LU();h.forEach((_=>{if(!s.has(_)){const x=GU(t.get(_),r.get(_));x!==null&&m.set(_,x),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return Z.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return Se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):Z.resolve(ea());let a=um,c=s;return o.next((d=>Z.forEach(d,((h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(h)?Z.resolve():this.remoteDocumentCache.getEntry(e,h).next((_=>{c=c.insert(h,_)}))))).next((()=>this.populateOverlays(e,d,s))).next((()=>this.computeViews(e,c,d,ct()))).next((h=>({batchId:a,changes:MU(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next((r=>{let i=Iy();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Iy();return this.indexManager.getCollectionParents(e,s).next((a=>Z.forEach(a,(c=>{const d=(function(m,_){return new Tl(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((m,_)=>{o=o.insert(m,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((o=>{s.forEach(((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,an.newInvalidDocument(h)))}));let a=Iy();return o.forEach(((c,d)=>{const h=s.get(c);h!==void 0&&Qy(h.mutation,d,vi.empty(),Lt.now()),Mw(t,d)&&(a=a.insert(c,d))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uee{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ln(i.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:S1(i.bundledQuery),readTime:Ln(i.readTime)}})(t)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dee{constructor(){this.overlays=new en(Se.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ea();return Z.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),Z.resolve()}getOverlaysForCollection(e,t,r){const i=ea(),s=t.length+1,o=new Se(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Z.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new en(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=ea(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=ea(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((d,h)=>a.set(d,h))),!(a.size()>=i)););return Z.resolve(a)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new A1(t,r));let s=this.qr.get(t);s===void 0&&(s=ct(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hee{constructor(){this.sessionToken=bn.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(){this.Qr=new Ht(rr.$r),this.Ur=new Ht(rr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new rr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new rr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new Se(new vt([])),r=new rr(t,e),i=new rr(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Se(new vt([])),r=new rr(t,e),i=new rr(t,e+1);let s=ct();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new rr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class rr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Se.comparator(e.key,t.key)||rt(e.Yr,t.Yr)}static Kr(e,t){return rt(e.Yr,t.Yr)||Se.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fee{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ht(rr.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new T1(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new rr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?Kc:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new rr(t,0),i=new rr(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{const a=this.Xr(o.Yr);s.push(a)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ht(rt);return t.forEach((i=>{const s=new rr(i,0),o=new rr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{r=r.add(a.Yr)}))})),Z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Se.isDocumentKey(s)||(s=s.child(""));const o=new rr(new Se(s),0);let a=new Ht(rt);return this.Zr.forEachWhile((c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(c.Yr)),!0)}),o),Z.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){je(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return Z.forEach(t.mutations,(i=>{const s=new rr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new rr(t,0),i=this.Zr.firstAfterOrEqual(r);return Z.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pee{constructor(e){this.ri=e,this.docs=(function(){return new en(Se.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Z.resolve(r?r.document.mutableCopy():an.newInvalidDocument(t))}getEntries(e,t){let r=Ei();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():an.newInvalidDocument(i))})),Z.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ei();const o=t.path,a=new Se(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||u1(Y3(h),r)<=0||(i.has(h.key)||Mw(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Le(9500)}ii(e,t){return Z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new mee(this)}getSize(e){return Z.resolve(this.size)}}class mee extends yB{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gee{constructor(e){this.persistence=e,this.si=new Il((t=>ch(t)),Rw),this.lastRemoteSnapshotVersion=$e.min(),this.highestTargetId=0,this.oi=0,this._i=new P1,this.targetCount=0,this.ai=ph.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ph(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),Z.waitFor(s).next((()=>i))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Z.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Z.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Z.resolve(r)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,t){this.ui={},this.overlays={},this.ci=new _i(0),this.li=!1,this.li=!0,this.hi=new hee,this.referenceDelegate=e(this),this.Pi=new gee(this),this.indexManager=new eee,this.remoteDocumentCache=(function(i){return new pee(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new aB(t),this.Ii=new uee(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dee,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new fee(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ge("MemoryPersistence","Starting transaction:",e);const i=new yee(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class yee extends Z3{constructor(e){super(),this.currentSequenceNumber=e}}class xT{constructor(e){this.persistence=e,this.Ri=new P1,this.Vi=null}static mi(e){return new xT(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Z.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(r=>{const i=Se.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,$e.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class BE{constructor(e,t){this.persistence=e,this.pi=new Il((r=>Ur(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=gB(this,t)}static mi(e,t){return new BE(e,t)}Ei(){}di(e){return Z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return Z.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?Z.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((a=>{a||(r++,s.removeEntry(o,$e.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Z.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Z.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Z.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bv(e.data.value)),t}br(e,t,r){return Z.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return Z.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wee{constructor(e){this.serializer=e}k(e,t,r,i){const s=new dT("createOrUpgrade",t);r<1&&i>=1&&((function(c){c.createObjectStore(Pw)})(e),(function(c){c.createObjectStore(A0,{keyPath:MX}),c.createObjectStore(Qs,{keyPath:mM,autoIncrement:!0}).createIndex(Ed,gM,{unique:!0}),c.createObjectStore(dm)})(e),sL(e),(function(c){c.createObjectStore(sd)})(e));let o=Z.resolve();return r<3&&i>=3&&(r!==0&&((function(c){c.deleteObjectStore(fm),c.deleteObjectStore(hm),c.deleteObjectStore(Yd)})(e),sL(e)),o=o.next((()=>(function(c){const d=c.store(Yd),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:$e.min().toTimestamp(),targetCount:0};return d.put(DE,h)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(c,d){return d.store(Qs).J().next((m=>{c.deleteObjectStore(Qs),c.createObjectStore(Qs,{keyPath:mM,autoIncrement:!0}).createIndex(Ed,gM,{unique:!0});const _=d.store(Qs),x=m.map((b=>_.put(b)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(pm,{keyPath:jX})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(c){c.createObjectStore(b0)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(hT,{keyPath:qX})})(e),(function(c){c.createObjectStore(fT,{keyPath:zX})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(c){const d=c.createObjectStore(pT,{keyPath:XX});d.createIndex(TC,ZX,{unique:!1}),d.createIndex(aU,eZ,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(c){const d=c.createObjectStore(RE,{keyPath:OX});d.createIndex(Fv,VX),d.createIndex(rU,FX)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(sd)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(c){c.createObjectStore(f1,{keyPath:$X,autoIncrement:!0}).createIndex(xC,WX,{unique:!1}),c.createObjectStore(zy,{keyPath:KX}).createIndex(sU,QX,{unique:!1}),c.createObjectStore($y,{keyPath:JX}).createIndex(oU,YX,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(zy).clear()})).next((()=>{t.objectStore($y).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(p1,{keyPath:tZ})})(e)}))),r<18&&i>=18&&sF()&&(o=o.next((()=>{t.objectStore(zy).clear()})).next((()=>{t.objectStore($y).clear()}))),o}wi(e){let t=0;return e.store(sd).ee(((r,i)=>{t+=UE(i)})).next((()=>{const r={byteSize:t};return e.store(b0).put(EC,r)}))}yi(e){const t=e.store(A0),r=e.store(Qs);return t.J().next((i=>Z.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,Kc],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ed,o).next((a=>Z.forEach(a,(c=>{je(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=cd(this.serializer,c);return hB(e,s.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(fm),r=e.store(sd);return e.store(Yd).get(DE).next((i=>{const s=[];return r.ee(((o,a)=>{const c=new vt(o),d=(function(m){return[0,Ur(m)]})(c);s.push(t.get(d).next((h=>h?Z.resolve():(m=>t.put({targetId:0,path:Ur(m),sequenceNumber:i.highestListenSequenceNumber}))(c))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(C0,{keyPath:GX});const r=t.store(C0),i=new k1,s=o=>{if(i.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ur(c)})}};return t.store(sd).ee({X:!0},((o,a)=>{const c=new vt(o);return s(c.popLast())})).next((()=>t.store(dm).ee({X:!0},(([o,a,c],d)=>{const h=Zo(a);return s(h.popLast())}))))}Di(e){const t=e.store(hm);return t.ee(((r,i)=>{const s=by(i),o=lB(this.serializer,s);return t.put(o)}))}Ci(e,t){const r=t.store(sd),i=[];return r.ee(((s,o)=>{const a=t.store(RE),c=(function(m){return m.document?new Se(vt.fromString(m.document.name).popFirst(5)):m.noDocument?Se.fromSegments(m.noDocument.path):m.unknownDocument?Se.fromSegments(m.unknownDocument.path):Le(36783)})(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(d))})).next((()=>Z.waitFor(i)))}Fi(e,t){const r=t.store(Qs),i=wB(this.serializer),s=new R1(xT.mi,this.serializer.yt);return r.J().next((o=>{const a=new Map;return o.forEach((c=>{let d=a.get(c.userId)??ct();cd(this.serializer,c).keys().forEach((h=>d=d.add(h))),a.set(c.userId,d)})),Z.forEach(a,((c,d)=>{const h=new or(d),m=vT.wt(this.serializer,h),_=s.getIndexManager(h),x=ET.wt(h,this.serializer,_,s.referenceDelegate);return new _B(i,x,m,_).recalculateAndSaveOverlaysForDocumentKeys(new IC(t,_i.ce),c).next()}))}))}}function sL(n){n.createObjectStore(fm,{keyPath:BX}).createIndex(h1,HX,{unique:!0}),n.createObjectStore(hm,{keyPath:"targetId"}).createIndex(iU,UX,{unique:!0}),n.createObjectStore(Yd)}const lc="IndexedDbPersistence",eb=18e5,tb=5e3,nb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vB="main";class D1{constructor(e,t,r,i,s,o,a,c,d,h,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=d,this.Oi=h,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!D1.v())throw new fe(oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oee(this,i),this.$i=t+vB,this.serializer=new aB(c),this.Ui=new oa(this.$i,this.Ni,new wee(this.serializer)),this.hi=new KZ,this.Pi=new nee(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wB(this.serializer),this.Ii=new WZ,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Dn(lc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new fe(oe.FAILED_PRECONDITION,nb);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new _i(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>gv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(_u(e))return ge(lc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ge(lc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return uy(e).get(Af).next((t=>Z.resolve(this.es(t))))}ts(e){return gv(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,eb)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Qn(t,pm);return r.J().next((i=>{const s=this.ss(i,eb),o=i.filter((a=>s.indexOf(a)===-1));return Z.forEach(o,(a=>r.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):uy(e).get(Af).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,tb)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new fe(oe.FAILED_PRECONDITION,nb);return!1}}return!(!this.networkEnabled||!this.inForeground)||gv(e).J().next((r=>this.ss(r,tb).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ge(lc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pw,pm],(e=>{const t=new IC(e,_i.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>gv(e).J().next((t=>this.ss(t,eb).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ET.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new tee(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vT.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){ge(lc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?iZ:c===17?dU:c===16?rZ:c===15?m1:c===14?uU:c===13?cU:c===12?nZ:c===11?lU:void Le(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,s,(a=>(o=new IC(a,this.ci?this.ci.next():_i.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw Dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new fe(oe.FAILED_PRECONDITION,X3);return r(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>r(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return uy(e).get(Af).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,tb)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new fe(oe.FAILED_PRECONDITION,nb)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return uy(e).put(Af,t)}static v(){return oa.v()}Zi(e){const t=uy(e);return t.get(Af).next((r=>this.es(r)?(ge(lc,"Releasing primary lease."),t.delete(Af)):Z.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Dn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;iF()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const r=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ge(lc,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Dn(lc,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Dn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function uy(n){return Qn(n,Pw)}function gv(n){return Qn(n,pm)}function M1(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=ct(),i=ct();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new L1(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ee{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EB{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return iF()?8:eU(xn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new _ee;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Df()<=wt.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",Mf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Df()<=wt.DEBUG&&ge("QueryEngine","Query:",Mf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Df()<=wt.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",Mf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ni(t))):Z.resolve())}ys(e,t){if(NM(t))return Z.resolve(null);let r=ni(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=OE(t,null,"F"),r=ni(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=ct(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((c=>{const d=this.Ds(t,a);return this.Cs(t,d,o,c.readTime)?this.ys(e,OE(t,null,"F")):this.vs(e,d,t,c)}))))})))))}ws(e,t,r,i){return NM(t)||i.isEqual($e.min())?Z.resolve(null):this.ps.getDocuments(e,r).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,r,i)?Z.resolve(null):(Df()<=wt.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mf(t)),this.vs(e,o,t,J3(i,um)).next((a=>a)))}))}Ds(e,t){let r=new Ht(RU(e));return t.forEach(((i,s)=>{Mw(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Df()<=wt.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",Mf(t)),this.ps.getDocumentsMatchingQuery(e,t,Zi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="LocalStore",vee=3e8;class Eee{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new en(rt),this.xs=new Il((s=>ch(s)),Rw),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _B(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function xB(n,e,t,r){return new Eee(n,e,t,r)}async function TB(n,e){const t=ke(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],a=[];let c=ct();for(const d of i){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of s){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:a})))}))}))}function xee(n,e){const t=ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,d,h){const m=d.batch,_=m.keys();let x=Z.resolve();return _.forEach((b=>{x=x.next((()=>h.getEntry(c,b))).next((A=>{const N=d.docVersions.get(b);je(N!==null,48541),A.version.compareTo(N)<0&&(m.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),h.addEntry(A)))}))})),x.next((()=>a.mutationQueue.removeMutationBatch(c,m)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=ct();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function IB(n){const e=ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Tee(n,e){const t=ke(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const a=[];e.targetChanges.forEach(((h,m)=>{const _=i.get(m);if(!_)return;a.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,m))));let x=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(bn.EMPTY_BYTE_STRING,$e.min()).withLastLimboFreeSnapshotVersion($e.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),i=i.insert(m,x),(function(A,N,F){return A.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=vee?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(_,x,h)&&a.push(t.Pi.updateTargetData(s,x))}));let c=Ei(),d=ct();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),a.push(AB(s,o,e.documentUpdates).next((h=>{c=h.ks,d=h.qs}))),!r.isEqual($e.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((m=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));a.push(h)}return Z.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,d))).next((()=>c))})).then((s=>(t.Ms=i,s)))}function AB(n,e,t){let r=ct(),i=ct();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let o=Ei();return t.forEach(((a,c)=>{const d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual($e.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):ge(O1,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)})),{ks:o,qs:i}}))}function Iee(n,e){const t=ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Kc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Em(n,e){const t=ke(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,Z.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new rl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function xm(n,e,t){const r=ke(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!_u(o))throw o;ge(O1,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function HE(n,e,t){const r=ke(n);let i=$e.min(),s=ct();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,d,h){const m=ke(c),_=m.xs.get(h);return _!==void 0?Z.resolve(m.Ms.get(_)):m.Pi.getTargetData(d,h)})(r,o,ni(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:$e.min(),t?s:ct()))).next((a=>(SB(r,PU(e),a),{documents:a,Qs:s})))))}function bB(n,e){const t=ke(n),r=ke(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(s=>r.At(s,e).next((o=>o?o.target:null))))}function CB(n,e){const t=ke(n),r=t.Os.get(e)||$e.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,J3(r,um),Number.MAX_SAFE_INTEGER))).then((i=>(SB(t,e,i),i)))}function SB(n,e,t){let r=n.Os.get(e)||$e.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}async function Aee(n,e,t,r){const i=ke(n);let s=ct(),o=Ei();for(const d of t){const h=e.$s(d.metadata.name);d.document&&(s=s.add(h));const m=e.Us(d);m.setReadTime(e.Ks(d.metadata.readTime)),o=o.insert(h,m)}const a=i.Ns.newChangeBuffer({trackRemovals:!0}),c=await Em(i,(function(h){return ni(Jm(vt.fromString(`__bundle__/docs/${h}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(d=>AB(d,a,o).next((h=>(a.apply(d),h))).next((h=>i.Pi.removeMatchingKeysForTargetId(d,c.targetId).next((()=>i.Pi.addMatchingKeys(d,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(d,h.ks,h.qs))).next((()=>h.ks))))))}async function bee(n,e,t=ct()){const r=await Em(n,ni(S1(e.bundledQuery))),i=ke(n);return i.persistence.runTransaction("Save named query","readwrite",(s=>{const o=Ln(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ii.saveNamedQuery(s,e);const a=r.withResumeToken(bn.EMPTY_BYTE_STRING,o);return i.Ms=i.Ms.insert(a.targetId,a),i.Pi.updateTargetData(s,a).next((()=>i.Pi.removeMatchingKeysForTargetId(s,r.targetId))).next((()=>i.Pi.addMatchingKeys(s,t,r.targetId))).next((()=>i.Ii.saveNamedQuery(s,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB="firestore_clients";function oL(n,e){return`${NB}_${n}_${e}`}const kB="firestore_mutations";function aL(n,e,t){let r=`${kB}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const PB="firestore_targets";function rb(n,e){return`${PB}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo="SharedClientState";class GE{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ws(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new fe(i.error.code,i.error.message))),o?new GE(e,t,i.state,s):(Dn(jo,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Jy{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new fe(r.error.code,r.error.message))),s?new Jy(e,r.state,i):(Dn(jo,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class jE{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=v1();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=tU(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new jE(e,s):(Dn(jo,`Failed to parse client data for instance '${e}': ${t}`),null)}}class V1{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new V1(t.clientId,t.onlineState):(Dn(jo,`Failed to parse online state: ${e}`),null)}}class UC{constructor(){this.activeTargetIds=v1()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ib{constructor(e,t,r,i,s){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new en(rt),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.eo=oL(this.persistenceKey,this.Js),this.no=(function(c){return`firestore_sequence_number_${c}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new UC),this.ro=new RegExp(`^${NB}_${o}_([^_]*)$`),this.io=new RegExp(`^${kB}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${PB}_${o}_(\\d+)$`),this.oo=(function(c){return`firestore_online_state_${c}`})(this.persistenceKey),this._o=(function(c){return`firestore_bundle_loaded_v2_${c}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem(oL(this.persistenceKey,r));if(i){const s=jE.Ws(r,i);s&&(this.Zs=this.Zs.insert(s.clientId,s))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(rb(this.persistenceKey,e));if(i){const s=Jy.Ws(e,i);s&&(r=s.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(rb(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.Po(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ge(jo,"READ",e,t),t}setItem(e,t){ge(jo,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ge(jo,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ge(jo,"EVENT",t.key,t.newValue),t.key===this.eo)return void Dn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(s){let o=_i.ce;if(s!=null)try{const a=JSON.parse(s);je(typeof a=="number",30636,{So:s}),o=a}catch(a){Dn(jo,"Failed to read sequence number from WebStorage",a)}return o})(t.newValue);r!==_i.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const i=new GE(this.currentUser,e,t,r),s=aL(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Gs())}Po(e){const t=aL(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const i=rb(this.persistenceKey,e),s=new Jy(e,t,r);this.setItem(i,s.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return jE.Ws(r,t)}fo(e,t){const r=this.io.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return GE.Ws(new or(s),i,t)}yo(e,t){const r=this.so.exec(e),i=Number(r[1]);return Jy.Ws(i,t)}uo(e){return V1.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ge(jo,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),s=this.lo(r),o=[],a=[];return s.forEach((c=>{i.has(c)||o.push(c)})),i.forEach((c=>{s.has(c)||a.push(c)})),this.syncEngine.Fo(o,a).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=v1();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class RB{constructor(){this.Mo=new UC,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new UC,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cee{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="ConnectivityMonitor";class cL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ge(lL,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ge(lL,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yv=null;function BC(){return yv===null?yv=(function(){return 268435456+Math.round(2147483648*Math.random())})():yv++,"0x"+yv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb="RestConnection",See={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Nee{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===AC?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const o=BC(),a=this.zo(e,t.toUriEncodedString());ge(sb,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,s);const{host:d}=new URL(a),h=mu(d);return this.Jo(e,a,c,r,h).then((m=>(ge(sb,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw pa(sb,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m}))}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Qm})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=See[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kee{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="WebChannelConnection";class Pee extends Nee{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const o=BC();return new Promise(((a,c)=>{const d=new U3;d.setWithCredentials(!0),d.listenOnce(B3.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Lv.NO_ERROR:const m=d.getResponseJson();ge(kr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Lv.TIMEOUT:ge(kr,`RPC '${e}' ${o} timed out`),c(new fe(oe.DEADLINE_EXCEEDED,"Request time out"));break;case Lv.HTTP_ERROR:const _=d.getStatus();if(ge(kr,`RPC '${e}' ${o} failed with status:`,_,"response text:",d.getResponseText()),_>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const b=x==null?void 0:x.error;if(b&&b.status&&b.message){const A=(function(F){const B=F.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(B)>=0?B:oe.UNKNOWN})(b.status);c(new fe(A,b.message))}else c(new fe(oe.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new fe(oe.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ge(kr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);ge(kr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=BC(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=j3(),a=G3(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const h=s.join("");ge(kr,`Creating RPC '${e}' stream ${i}: ${h}`,c);const m=o.createWebChannel(h,c);this.I_(m);let _=!1,x=!1;const b=new kee({Yo:N=>{x?ge(kr,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(_||(ge(kr,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),ge(kr,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},Zo:()=>m.close()}),A=(N,F,B)=>{N.listen(F,(O=>{try{B(O)}catch(q){setTimeout((()=>{throw q}),0)}}))};return A(m,Ty.EventType.OPEN,(()=>{x||(ge(kr,`RPC '${e}' stream ${i} transport opened.`),b.o_())})),A(m,Ty.EventType.CLOSE,(()=>{x||(x=!0,ge(kr,`RPC '${e}' stream ${i} transport closed`),b.a_(),this.E_(m))})),A(m,Ty.EventType.ERROR,(N=>{x||(x=!0,pa(kr,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),b.a_(new fe(oe.UNAVAILABLE,"The operation could not be completed")))})),A(m,Ty.EventType.MESSAGE,(N=>{var F;if(!x){const B=N.data[0];je(!!B,16349);const O=B,q=(O==null?void 0:O.error)||((F=O[0])==null?void 0:F.error);if(q){ge(kr,`RPC '${e}' stream ${i} received error:`,q);const W=q.status;let $=(function(R){const U=Un[R];if(U!==void 0)return zU(U)})(W),D=q.message;$===void 0&&($=oe.INTERNAL,D="Unknown error status: "+W+" with message "+q.message),x=!0,b.a_(new fe($,D)),m.close()}else ge(kr,`RPC '${e}' stream ${i} received:`,B),b.u_(B)}})),A(a,H3.STAT_EVENT,(N=>{N.stat===wC.PROXY?ge(kr,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===wC.NOPROXY&&ge(kr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{b.__()}),0),b}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(){return typeof window<"u"?window:null}function zv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(n){return new OZ(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&ge("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL="PersistentStream";class MB{constructor(e,t,r,i,s,o,a,c){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new F1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===oe.RESOURCE_EXHAUSTED?(Dn(t.toString()),Dn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new fe(oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ge(uL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ge(uL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ree extends MB{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=UZ(this.serializer,e),r=(function(s){if(!("targetChange"in s))return $e.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?$e.min():o.readTime?Ln(o.readTime):$e.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=MC(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=ME(c)?{documents:tB(s,c)}:{query:nB(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=QU(s,o.resumeToken);const d=RC(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo($e.min())>0){a.readTime=vm(s,o.snapshotVersion.toTimestamp());const d=RC(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a})(this.serializer,e);const r=HZ(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=MC(this.serializer),t.removeTarget=e,this.q_(t)}}class Dee extends MB{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=BZ(e.writeResults,e.commitTime),r=Ln(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=MC(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>D0(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mee{}class Lee extends Mee{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new fe(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,DC(t,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(oe.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,DC(t,r),i,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new fe(oe.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Oee{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Dn(t),this.aa=!1):ge("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="RemoteStore";class Vee{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Eu(this)&&(ge(mh,"Restarting streams for network reachability change."),await(async function(c){const d=ke(c);d.Ea.add(4),await Zm(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Uw(d)})(this))}))})),this.Ra=new Oee(r,i)}}async function Uw(n){if(Eu(n))for(const e of n.da)await e(!0)}async function Zm(n){for(const e of n.da)await e(!1)}function TT(n,e){const t=ke(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),H1(t)?B1(t):tg(t).O_()&&U1(t,e))}function Tm(n,e){const t=ke(n),r=tg(t);t.Ia.delete(e),r.O_()&&LB(t,e),t.Ia.size===0&&(r.O_()?r.L_():Eu(t)&&t.Ra.set("Unknown"))}function U1(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($e.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tg(n).Y_(e)}function LB(n,e){n.Va.Ue(e),tg(n).Z_(e)}function B1(n){n.Va=new RZ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),tg(n).start(),n.Ra.ua()}function H1(n){return Eu(n)&&!tg(n).x_()&&n.Ia.size>0}function Eu(n){return ke(n).Ea.size===0}function OB(n){n.Va=void 0}async function Fee(n){n.Ra.set("Online")}async function Uee(n){n.Ia.forEach(((e,t)=>{U1(n,e)}))}async function Bee(n,e){OB(n),H1(n)?(n.Ra.ha(e),B1(n)):n.Ra.set("Unknown")}async function Hee(n,e,t){if(n.Ra.set("Online"),e instanceof KU&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(n,e)}catch(r){ge(mh,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qE(n,r)}else if(e instanceof jv?n.Va.Ze(e):e instanceof WU?n.Va.st(e):n.Va.tt(e),!t.isEqual($e.min()))try{const r=await IB(n.localStore);t.compareTo(r)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,d)=>{const h=s.Ia.get(c);if(!h)return;s.Ia.set(c,h.withResumeToken(bn.EMPTY_BYTE_STRING,h.snapshotVersion)),LB(s,c);const m=new rl(h.target,c,d,h.sequenceNumber);U1(s,m)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){ge(mh,"Failed to raise snapshot:",r),await qE(n,r)}}async function qE(n,e,t){if(!_u(e))throw e;n.Ea.add(1),await Zm(n),n.Ra.set("Offline"),t||(t=()=>IB(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ge(mh,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Uw(n)}))}function VB(n,e){return e().catch((t=>qE(n,t,e)))}async function eg(n){const e=ke(n),t=cu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Kc;for(;Gee(e);)try{const i=await Iee(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,jee(e,i)}catch(i){await qE(e,i)}FB(e)&&UB(e)}function Gee(n){return Eu(n)&&n.Ta.length<10}function jee(n,e){n.Ta.push(e);const t=cu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function FB(n){return Eu(n)&&!cu(n).x_()&&n.Ta.length>0}function UB(n){cu(n).start()}async function qee(n){cu(n).ra()}async function zee(n){const e=cu(n);for(const t of n.Ta)e.ea(t.mutations)}async function $ee(n,e,t){const r=n.Ta.shift(),i=I1.from(r,e,t);await VB(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await eg(n)}async function Wee(n,e){e&&cu(n).X_&&await(async function(r,i){if((function(o){return qU(o)&&o!==oe.ABORTED})(i.code)){const s=r.Ta.shift();cu(r).B_(),await VB(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await eg(r)}})(n,e),FB(n)&&UB(n)}async function dL(n,e){const t=ke(n);t.asyncQueue.verifyOperationInProgress(),ge(mh,"RemoteStore received new credentials");const r=Eu(t);t.Ea.add(3),await Zm(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Uw(t)}async function HC(n,e){const t=ke(n);e?(t.Ea.delete(2),await Uw(t)):e||(t.Ea.add(2),await Zm(t),t.Ra.set("Unknown"))}function tg(n){return n.ma||(n.ma=(function(t,r,i){const s=ke(t);return s.sa(),new Ree(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Fee.bind(null,n),t_:Uee.bind(null,n),r_:Bee.bind(null,n),H_:Hee.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),H1(n)?B1(n):n.Ra.set("Unknown")):(await n.ma.stop(),OB(n))}))),n.ma}function cu(n){return n.fa||(n.fa=(function(t,r,i){const s=ke(t);return s.sa(),new Dee(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:qee.bind(null,n),r_:Wee.bind(null,n),ta:zee.bind(null,n),na:$ee.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await eg(n)):(await n.fa.stop(),n.Ta.length>0&&(ge(mh,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new xr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new G1(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ng(n,e){if(Dn("AsyncQueue",`${e}: ${n}`),_u(n))return new fe(oe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{static emptySet(e){return new ip(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Se.comparator(t.key,r.key):(t,r)=>Se.comparator(t.key,r.key),this.keyedMap=Iy(),this.sortedSet=new en(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ip)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ip;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.ga=new en(Se.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Im{constructor(e,t,r,i,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Im(e,t,ip.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Dw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kee{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Qee{constructor(){this.queries=fL(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ke(t),s=i.queries;i.queries=fL(),s.forEach(((o,a)=>{for(const c of a.Sa)c.onError(r)}))})(this,new fe(oe.ABORTED,"Firestore shutting down"))}}function fL(){return new Il((n=>kU(n)),Dw)}async function j1(n,e){const t=ke(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new Kee,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=ng(o,`Initialization of query '${Mf(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&z1(t)}async function q1(n,e){const t=ke(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Jee(n,e){const t=ke(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&z1(t)}function Yee(n,e,t){const r=ke(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function z1(n){n.Ca.forEach((e=>{e.next()}))}var GC,pL;(pL=GC||(GC={})).Ma="default",pL.Cache="cache";class $1{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Im(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Im.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==GC.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xee{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.serializer=e}$s(e){return aa(this.serializer,e)}Us(e){return e.metadata.exists?eB(this.serializer,e.document,!1):an.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Ln(e)}}class Zee{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=BB(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=vt.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new mL(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.$s(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||ct()).add(s);t.set(o,a)}}return t}async ja(e){const t=await Aee(e,new mL(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const i of this.Ka)await bee(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function BB(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e){this.key=e}}class GB{constructor(e){this.key=e}}class jB{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ct(),this.mutatedKeys=ct(),this.eu=RU(e),this.tu=new ip(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new hL,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,m)=>{const _=i.get(h),x=Mw(this.query,m)?m:null,b=!!_&&this.mutatedKeys.has(_.key),A=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let N=!1;_&&x?_.data.isEqual(x.data)?b!==A&&(r.track({type:3,doc:x}),N=!0):this.su(_,x)||(r.track({type:2,doc:x}),N=!0,(c&&this.eu(x,c)>0||d&&this.eu(x,d)<0)&&(a=!0)):!_&&x?(r.track({type:0,doc:x}),N=!0):_&&!x&&(r.track({type:1,doc:_}),N=!0,(c||d)&&(a=!0)),N&&(x?(o=o.add(x),s=A?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,m)=>(function(x,b){const A=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:N})}};return A(x)-A(b)})(h.type,m.type)||this.eu(h.doc,m.doc))),this.ou(r),i=i??!1;const a=t&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,d=c!==this.Za;return this.Za=c,o.length!==0||d?{snapshot:new Im(this.query,e.tu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ct(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new GB(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new HB(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=ct();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Im.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const xu="SyncEngine";class ete{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class tte{constructor(e){this.key=e,this.hu=!1}}class nte{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Il((a=>kU(a)),Dw),this.Iu=new Map,this.Eu=new Set,this.du=new en(Se.comparator),this.Au=new Map,this.Ru=new P1,this.Vu={},this.mu=new Map,this.fu=ph.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function rte(n,e,t=!0){const r=IT(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await qB(r,e,t,!0),i}async function ite(n,e){const t=IT(n);await qB(t,e,!0,!1)}async function qB(n,e,t,r){const i=await Em(n.localStore,ni(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await W1(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&TT(n.remoteStore,i),a}async function W1(n,e,t,r,i){n.pu=(m,_,x)=>(async function(A,N,F,B){let O=N.view.ru(F);O.Cs&&(O=await HE(A.localStore,N.query,!1).then((({documents:D})=>N.view.ru(D,O))));const q=B&&B.targetChanges.get(N.targetId),W=B&&B.targetMismatches.get(N.targetId)!=null,$=N.view.applyChanges(O,A.isPrimaryClient,q,W);return jC(A,N.targetId,$.au),$.snapshot})(n,m,_,x);const s=await HE(n.localStore,e,!0),o=new jB(e,s.Qs),a=o.ru(s.documents),c=Vw.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(a,n.isPrimaryClient,c);jC(n,t,d.au);const h=new ete(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function ste(n,e,t){const r=ke(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!Dw(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xm(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Tm(r.remoteStore,i.targetId),Am(r,i.targetId)})).catch(wu)):(Am(r,i.targetId),await xm(r.localStore,i.targetId,!0))}async function ote(n,e){const t=ke(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Tm(t.remoteStore,r.targetId))}async function ate(n,e,t){const r=Y1(n);try{const i=await(function(o,a){const c=ke(o),d=Lt.now(),h=a.reduce(((x,b)=>x.add(b.key)),ct());let m,_;return c.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let b=Ei(),A=ct();return c.Ns.getEntries(x,h).next((N=>{b=N,b.forEach(((F,B)=>{B.isValidDocument()||(A=A.add(F))}))})).next((()=>c.localDocuments.getOverlayedDocuments(x,b))).next((N=>{m=N;const F=[];for(const B of a){const O=NZ(B,m.get(B.key).overlayedDocument);O!=null&&F.push(new Al(B.key,O,EU(O.value.mapValue),pn.exists(!0)))}return c.mutationQueue.addMutationBatch(x,d,F,a)})).next((N=>{_=N;const F=N.applyToLocalDocumentSet(m,A);return c.documentOverlayCache.saveOverlays(x,N.batchId,F)}))})).then((()=>({batchId:_.batchId,changes:MU(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let d=o.Vu[o.currentUser.toKey()];d||(d=new en(rt)),d=d.insert(a,c),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await bl(r,i.changes),await eg(r.remoteStore)}catch(i){const s=ng(i,"Failed to persist write");t.reject(s)}}async function zB(n,e){const t=ke(n);try{const r=await Tee(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=t.Au.get(s);o&&(je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?je(o.hu,14607):i.removedDocuments.size>0&&(je(o.hu,42227),o.hu=!1))})),await bl(t,r,e)}catch(r){await wu(r)}}function gL(n,e,t){const r=ke(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(o,a){const c=ke(o);c.onlineState=a;let d=!1;c.queries.forEach(((h,m)=>{for(const _ of m.Sa)_.va(a)&&(d=!0)})),d&&z1(c)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function lte(n,e,t){const r=ke(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new en(Se.comparator);o=o.insert(s,an.newNoDocument(s,$e.min()));const a=ct().add(s),c=new Ow($e.min(),new Map,new en(rt),o,a);await zB(r,c),r.du=r.du.remove(s),r.Au.delete(e),J1(r)}else await xm(r.localStore,e,!1).then((()=>Am(r,e,t))).catch(wu)}async function cte(n,e){const t=ke(n),r=e.batch.batchId;try{const i=await xee(t.localStore,e);Q1(t,r,null),K1(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await bl(t,i)}catch(i){await wu(i)}}async function ute(n,e,t){const r=ke(n);try{const i=await(function(o,a){const c=ke(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next((m=>(je(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m)))).next((()=>c.mutationQueue.performConsistencyCheck(d))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>c.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);Q1(r,e,t),K1(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await bl(r,i)}catch(i){await wu(i)}}async function dte(n,e){const t=ke(n);Eu(t.remoteStore)||ge(xu,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(o){const a=ke(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c)))})(t.localStore);if(r===Kc)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=ng(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function K1(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Q1(n,e,t){const r=ke(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Am(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||$B(n,r)}))}function $B(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Tm(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),J1(n))}function jC(n,e,t){for(const r of t)r instanceof HB?(n.Ru.addReference(r.key,e),hte(n,r)):r instanceof GB?(ge(xu,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||$B(n,r.key)):Le(19791,{wu:r})}function hte(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ge(xu,"New document in limbo: "+t),n.Eu.add(r),J1(n))}function J1(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Se(vt.fromString(e)),r=n.fu.next();n.Au.set(r,new tte(t)),n.du=n.du.insert(t,r),TT(n.remoteStore,new rl(ni(Jm(t.path)),r,"TargetPurposeLimboResolution",_i.ce))}}async function bl(n,e,t){const r=ke(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,c)=>{o.push(r.pu(c,e,t).then((d=>{var h;if((d||t)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=t==null?void 0:t.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){i.push(d);const m=L1.As(c.targetId,d);s.push(m)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(c,d){const h=ke(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>Z.forEach(d,(_=>Z.forEach(_.Es,(x=>h.persistence.referenceDelegate.addReference(m,_.targetId,x))).next((()=>Z.forEach(_.ds,(x=>h.persistence.referenceDelegate.removeReference(m,_.targetId,x)))))))))}catch(m){if(!_u(m))throw m;ge(O1,"Failed to update sequence numbers: "+m)}for(const m of d){const _=m.targetId;if(!m.fromCache){const x=h.Ms.get(_),b=x.snapshotVersion,A=x.withLastLimboFreeSnapshotVersion(b);h.Ms=h.Ms.insert(_,A)}}})(r.localStore,s))}async function fte(n,e){const t=ke(n);if(!t.currentUser.isEqual(e)){ge(xu,"User change. New user:",e.toKey());const r=await TB(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((c=>{c.reject(new fe(oe.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bl(t,r.Ls)}}function pte(n,e){const t=ke(n),r=t.Au.get(e);if(r&&r.hu)return ct().add(r.key);{let i=ct();const s=t.Iu.get(e);if(!s)return i;for(const o of s){const a=t.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}async function mte(n,e){const t=ke(n),r=await HE(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&jC(t,e.targetId,i.au),i}async function gte(n,e){const t=ke(n);return CB(t.localStore,e).then((r=>bl(t,r)))}async function yte(n,e,t,r){const i=ke(n),s=await(function(a,c){const d=ke(a),h=ke(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",(m=>h.er(m,c).next((_=>_?d.localDocuments.getDocuments(m,_):Z.resolve(null)))))})(i.localStore,e);s!==null?(t==="pending"?await eg(i.remoteStore):t==="acknowledged"||t==="rejected"?(Q1(i,e,r||null),K1(i,e),(function(a,c){ke(ke(a).mutationQueue).ir(c)})(i.localStore,e)):Le(6720,"Unknown batchState",{Su:t}),await bl(i,s)):ge(xu,"Cannot apply mutation batch with id: "+e)}async function wte(n,e){const t=ke(n);if(IT(t),Y1(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await yL(t,r.toArray());t.gu=!0,await HC(t.remoteStore,!0);for(const s of i)TT(t.remoteStore,s)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then((()=>(Am(t,o),xm(t.localStore,o,!0)))),Tm(t.remoteStore,o)})),await i,await yL(t,r),(function(o){const a=ke(o);a.Au.forEach(((c,d)=>{Tm(a.remoteStore,d)})),a.Ru.Jr(),a.Au=new Map,a.du=new en(Se.comparator)})(t),t.gu=!1,await HC(t.remoteStore,!1)}}async function yL(n,e,t){const r=ke(n),i=[],s=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await Em(r.localStore,ni(c[0]));for(const d of c){const h=r.Tu.get(d),m=await mte(r,h);m.snapshot&&s.push(m.snapshot)}}else{const d=await bB(r.localStore,o);a=await Em(r.localStore,d),await W1(r,WB(d),o,!1,a.resumeToken)}i.push(a)}return r.Pu.H_(s),i}function WB(n){return NU(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function _te(n){return(function(t){return ke(ke(t).persistence).Ts()})(ke(n).localStore)}async function vte(n,e,t,r){const i=ke(n);if(i.gu)return void ge(xu,"Ignoring unexpected query state notification.");const s=i.Iu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await CB(i.localStore,PU(s[0])),a=Ow.createSynthesizedRemoteEventForCurrentChange(e,t==="current",bn.EMPTY_BYTE_STRING);await bl(i,o,a);break}case"rejected":await xm(i.localStore,e,!0),Am(i,e,r);break;default:Le(64155,t)}}async function Ete(n,e,t){const r=IT(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){ge(xu,"Adding an already active target "+i);continue}const s=await bB(r.localStore,i),o=await Em(r.localStore,s);await W1(r,WB(s),o.targetId,!1,o.resumeToken),TT(r.remoteStore,o)}for(const i of t)r.Iu.has(i)&&await xm(r.localStore,i,!1).then((()=>{Tm(r.remoteStore,i),Am(r,i)})).catch(wu)}}function IT(n){const e=ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=zB.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pte.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lte.bind(null,e),e.Pu.H_=Jee.bind(null,e.eventManager),e.Pu.yu=Yee.bind(null,e.eventManager),e}function Y1(n){const e=ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cte.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ute.bind(null,e),e}function xte(n,e,t){const r=ke(n);(async function(s,o,a){try{const c=await o.getMetadata();if(await(function(x,b){const A=ke(x),N=Ln(b.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",(F=>A.Ii.getBundleMetadata(F,b.id))).then((F=>!!F&&F.createTime.compareTo(N)>=0))})(s.localStore,c))return await o.close(),a._completeWith((function(x){return{taskState:"Success",documentsLoaded:x.totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}})(c)),Promise.resolve(new Set);a._updateProgress(BB(c));const d=new Zee(c,o.serializer);let h=await o.bu();for(;h;){const _=await d.Ga(h);_&&a._updateProgress(_),h=await o.bu()}const m=await d.ja(s.localStore);return await bl(s,m.Ha,void 0),await(function(x,b){const A=ke(x);return A.persistence.runTransaction("Save bundle","readwrite",(N=>A.Ii.saveBundleMetadata(N,b)))})(s.localStore,c),a._completeWith(m.progress),Promise.resolve(m.Ja)}catch(c){return pa(xu,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class M0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fw(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xB(this.persistence,new EB,e.initialUser,this.serializer)}Cu(e){return new R1(xT.mi,this.serializer)}Du(e){return new RB}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}M0.provider={build:()=>new M0};class Tte extends M0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){je(this.persistence.referenceDelegate instanceof BE,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new mB(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new R1((r=>BE.mi(r,t)),this.serializer)}}class KB extends M0{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Y1(this.xu.syncEngine),await eg(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return xB(this.persistence,new EB,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new mB(r,e.asyncQueue,t)}Mu(e,t){const r=new RX(t,this.persistence);return new PX(e.asyncQueue,r)}Cu(e){const t=M1(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new D1(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,DB(),zv(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new RB}}class Ite extends KB{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof ib&&(this.sharedClientState.syncEngine={Co:yte.bind(null,t),vo:vte.bind(null,t),Fo:Ete.bind(null,t),Ts:_te.bind(null,t),Do:gte.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await wte(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=DB();if(!ib.v(t))throw new fe(oe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=M1(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ib(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class L0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fte.bind(null,this.syncEngine),await HC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Qee})()}createDatastore(e){const t=Fw(e.databaseInfo.databaseId),r=(function(s){return new Pee(s)})(e.databaseInfo);return(function(s,o,a,c){return new Lee(s,o,a,c)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,o,a){return new Vee(r,i,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>gL(this.syncEngine,t,0)),(function(){return cL.v()?new cL:new Cee})())}createSyncEngine(e,t){return(function(i,s,o,a,c,d,h){const m=new nte(i,s,o,a,c,d);return h&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const s=ke(i);ge(mh,"RemoteStore shutting down."),s.Ea.add(5),await Zm(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}L0.provider={build:()=>new L0};function wL(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Dn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ate{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new xr,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(r);return new Xee(JSON.parse(i),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bte{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(oe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,s){const o=ke(i),a={documents:s.map((m=>R0(o.serializer,m)))},c=await o.Ho("BatchGetDocuments",o.serializer.databaseId,vt.emptyPath(),a,s.length),d=new Map;c.forEach((m=>{const _=FZ(o.serializer,m);d.set(_.key.toString(),_)}));const h=[];return s.forEach((m=>{const _=d.get(m.toString());je(!!_,55234,{key:m}),h.push(_)})),h})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=Se.fromPath(r);this.mutations.push(new x1(i,this.precondition(i)))})),await(async function(r,i){const s=ke(r),o={writes:i.map((a=>D0(s.serializer,a)))};await s.Go("Commit",s.serializer.databaseId,vt.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Le(50498,{Gu:e.constructor.name});t=$e.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new fe(oe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual($e.min())?pn.exists(!1):pn.updateTime(t):pn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual($e.min()))throw new fe(oe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return pn.updateTime(t)}return pn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cte{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new F1(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new bte(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Yu(i)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!kw(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!qU(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu="FirestoreClient";class Ste{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=or.UNAUTHENTICATED,this.clientId=l1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{ge(uu,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(ge(uu,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ng(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function ob(n,e){n.asyncQueue.verifyOperationInProgress(),ge(uu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await TB(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function _L(n,e){n.asyncQueue.verifyOperationInProgress();const t=await X1(n);ge(uu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>dL(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>dL(e.remoteStore,i))),n._onlineComponents=e}async function X1(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(uu,"Using user provided OfflineComponentProvider");try{await ob(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===oe.FAILED_PRECONDITION||i.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;pa("Error using user provided cache. Falling back to memory cache: "+t),await ob(n,new M0)}}else ge(uu,"Using default OfflineComponentProvider"),await ob(n,new Tte(void 0));return n._offlineComponents}async function bT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(uu,"Using user provided OnlineComponentProvider"),await _L(n,n._uninitializedComponentsProvider._online)):(ge(uu,"Using default OnlineComponentProvider"),await _L(n,new L0))),n._onlineComponents}function QB(n){return X1(n).then((e=>e.persistence))}function Z1(n){return X1(n).then((e=>e.localStore))}function JB(n){return bT(n).then((e=>e.remoteStore))}function ek(n){return bT(n).then((e=>e.syncEngine))}function Nte(n){return bT(n).then((e=>e.datastore))}async function bm(n){const e=await bT(n),t=e.eventManager;return t.onListen=rte.bind(null,e.syncEngine),t.onUnlisten=ste.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ite.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ote.bind(null,e.syncEngine),t}function kte(n){return n.asyncQueue.enqueue((async()=>{const e=await QB(n),t=await JB(n);return e.setNetworkEnabled(!0),(function(i){const s=ke(i);return s.Ea.delete(0),Uw(s)})(t)}))}function Pte(n){return n.asyncQueue.enqueue((async()=>{const e=await QB(n),t=await JB(n);return e.setNetworkEnabled(!1),(async function(i){const s=ke(i);s.Ea.add(0),await Zm(s),s.Ra.set("Offline")})(t)}))}function Rte(n,e){const t=new xr;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const a=await(function(d,h){const m=ke(d);return m.persistence.runTransaction("read document","readonly",(_=>m.localDocuments.getDocument(_,h)))})(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new fe(oe.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=ng(a,`Failed to get document '${s} from cache`);o.reject(c)}})(await Z1(n),e,t))),t.promise}function YB(n,e,t={}){const r=new xr;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,d){const h=new AT({next:_=>{h.Nu(),o.enqueueAndForget((()=>q1(s,m)));const x=_.docs.has(a);!x&&_.fromCache?d.reject(new fe(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&_.fromCache&&c&&c.source==="server"?d.reject(new fe(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),m=new $1(Jm(a.path),h,{includeMetadataChanges:!0,qa:!0});return j1(s,m)})(await bm(n),n.asyncQueue,e,t,r))),r.promise}function Dte(n,e){const t=new xr;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const a=await HE(i,s,!0),c=new jB(s,a.Qs),d=c.ru(a.documents),h=c.applyChanges(d,!1);o.resolve(h.snapshot)}catch(a){const c=ng(a,`Failed to execute query '${s} against cache`);o.reject(c)}})(await Z1(n),e,t))),t.promise}function XB(n,e,t={}){const r=new xr;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,d){const h=new AT({next:_=>{h.Nu(),o.enqueueAndForget((()=>q1(s,m))),_.fromCache&&c.source==="server"?d.reject(new fe(oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),m=new $1(a,h,{includeMetadataChanges:!0,qa:!0});return j1(s,m)})(await bm(n),n.asyncQueue,e,t,r))),r.promise}function Mte(n,e){const t=new AT(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,s){ke(i).Ca.add(s),s.next()})(await bm(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,s){ke(i).Ca.delete(s)})(await bm(n),t)))}}function Lte(n,e,t,r){const i=(function(o,a){let c;return c=typeof o=="string"?$U().encode(o):o,(function(h,m){return new Ate(h,m)})((function(h,m){if(h instanceof Uint8Array)return wL(h,m);if(h instanceof ArrayBuffer)return wL(new Uint8Array(h),m);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(c),a)})(t,Fw(e));n.asyncQueue.enqueueAndForget((async()=>{xte(await ek(n),i,r)}))}function Ote(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const s=ke(r);return s.persistence.runTransaction("Get named query","readonly",(o=>s.Ii.getNamedQuery(o,i)))})(await Z1(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6="firestore.googleapis.com",EL=!0;class xL{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new fe(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=e6,this.ssl=EL}else this.host=e.host,this.ssl=e.ssl??EL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dB;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ree)throw new fe(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZB(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new fe(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new fe(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new fe(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new _X;switch(r.type){case"firstParty":return new TX(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new fe(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=vL.get(t);r&&(ge("ComponentProvider","Removing Datastore"),vL.delete(t),r.terminate())})(this),Promise.resolve()}}function Vte(n,e,t,r={}){var d;n=Pt(n,Bw);const i=mu(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;i&&(YS(`https://${a}`),XS("Firestore",!0)),s.host!==e6&&s.host!==a&&pa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:i,emulatorOptions:r};if(!dl(c,o)&&(n._setSettings(c),r.mockUserToken)){let h,m;if(typeof r.mockUserToken=="string")h=r.mockUserToken,m=or.MOCK_USER;else{h=eF(r.mockUserToken,(d=n._app)==null?void 0:d.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new fe(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new or(_)}n._authCredentials=new vX(new z3(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ii=class t6{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t6(this.firestore,e,this._query)}},Zt=class Cy{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cy(this.firestore,e,this._key)}toJSON(){return{type:Cy._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Nw(t,Cy._jsonSchema))return new Cy(e,r||null,new Se(vt.fromString(t.referencePath)))}};Zt._jsonSchemaVersion="firestore/documentReference/1.0",Zt._jsonSchema={type:Gn("string",Zt._jsonSchemaVersion),referencePath:Gn("string")};let Qc=class n6 extends ii{constructor(e,t,r){super(e,t,Jm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new Se(e))}withConverter(e){return new n6(this.firestore,e,this._path)}};function r6(n,e,...t){if(n=Fe(n),c1("collection","path",e),n instanceof Bw){const r=vt.fromString(e,...t);return uM(r),new Qc(n,null,r)}{if(!(n instanceof Zt||n instanceof Qc))throw new fe(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(vt.fromString(e,...t));return uM(r),new Qc(n.firestore,null,r)}}function Fte(n,e){if(n=Pt(n,Bw),c1("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new fe(oe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ii(n,null,(function(r){return new Tl(vt.emptyPath(),r)})(e))}function zE(n,e,...t){if(n=Fe(n),arguments.length===1&&(e=l1.newId()),c1("doc","path",e),n instanceof Bw){const r=vt.fromString(e,...t);return cM(r),new Zt(n,null,new Se(r))}{if(!(n instanceof Zt||n instanceof Qc))throw new fe(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(vt.fromString(e,...t));return cM(r),new Zt(n.firestore,n instanceof Qc?n.converter:null,new Se(r))}}function i6(n,e){return n=Fe(n),e=Fe(e),(n instanceof Zt||n instanceof Qc)&&(e instanceof Zt||e instanceof Qc)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function s6(n,e){return n=Fe(n),e=Fe(e),n instanceof ii&&e instanceof ii&&n.firestore===e.firestore&&Dw(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="AsyncQueue";class IL{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new F1(this,"async_queue_retry"),this._c=()=>{const r=zv();r&&ge(TL,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=zv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=zv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new xr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_u(e))throw e;ge(TL,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Dn("INTERNAL UNHANDLED ERROR: ",AL(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=G1.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Le(47125,{Pc:AL(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function AL(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}class Ute{constructor(){this._progressObserver={},this._taskCompletionResolver=new xr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bte=-1;let On=class extends Bw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new IL,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new IL(e),this._firestoreClient=void 0,await e}}};function Hr(n){if(n._terminated)throw new fe(oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||o6(n),n._firestoreClient}function o6(n){var r,i,s;const e=n._freezeSettings(),t=(function(a,c,d,h){return new aZ(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,ZB(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Ste(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}})(n._componentsProvider))}function Hte(n,e){pa("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return a6(n,L0.provider,{build:r=>new KB(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function Gte(n){pa("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();a6(n,L0.provider,{build:t=>new Ite(t,e.cacheSizeBytes)})}function a6(n,e,t){if((n=Pt(n,On))._firestoreClient||n._terminated)throw new fe(oe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new fe(oe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},o6(n)}function jte(n){if(n._initialized&&!n._terminated)throw new fe(oe.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new xr;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!oa.v())return Promise.resolve();const i=r+vB;await oa.delete(i)})(M1(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function qte(n){return(function(t){const r=new xr;return t.asyncQueue.enqueueAndForget((async()=>dte(await ek(t),r))),r.promise})(Hr(n=Pt(n,On)))}function zte(n){return kte(Hr(n=Pt(n,On)))}function $te(n){return Pte(Hr(n=Pt(n,On)))}function Wte(n,e){const t=Hr(n=Pt(n,On)),r=new Ute;return Lte(t,n._databaseId,e,r),r}function Kte(n,e){return Ote(Hr(n=Pt(n,On)),e).then((t=>t?new ii(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Lr(bn.fromBase64String(e))}catch(t){throw new fe(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Lr(bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Lr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nw(e,Lr._jsonSchema))return Lr.fromBase64String(e.bytes)}}Lr._jsonSchemaVersion="firestore/bytes/1.0",Lr._jsonSchema={type:Gn("string",Lr._jsonSchemaVersion),bytes:Gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let du=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dh=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rt(this._lat,e._lat)||rt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:to._jsonSchemaVersion}}static fromJSON(e){if(Nw(e,to._jsonSchema))return new to(e.latitude,e.longitude)}}to._jsonSchemaVersion="firestore/geoPoint/1.0",to._jsonSchema={type:Gn("string",to._jsonSchemaVersion),latitude:Gn("number"),longitude:Gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:la._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nw(e,la._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new la(e.vectorValues);throw new fe(oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}la._jsonSchemaVersion="firestore/vectorValue/1.0",la._jsonSchema={type:Gn("string",la._jsonSchemaVersion),vectorValues:Gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qte=/^__.*__$/;class Jte{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Al(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ym(e,this.data,t,this.fieldTransforms)}}class l6{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Al(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function c6(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class CT{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new CT({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $E(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(c6(this.Ac)&&Qte.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Yte{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Fw(e)}Cc(e,t,r,i=!1){return new CT({Ac:e,methodName:t,Dc:r,path:fn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mh(n){const e=n._freezeSettings(),t=Fw(n._databaseId);return new Yte(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ST(n,e,t,r,i,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);ak("Data must be an object, but it was:",o,r);const a=h6(r,o);let c,d;if(s.merge)c=new vi(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const m of s.mergeFields){const _=zC(e,m,t);if(!o.contains(_))throw new fe(oe.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);p6(h,_)||h.push(_)}c=new vi(h),d=o.fieldTransforms.filter((m=>c.covers(m.field)))}else c=null,d=o.fieldTransforms;return new Jte(new _r(a),c,d)}class Hw extends Dh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hw}}function u6(n,e,t){return new CT({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class tk extends Dh{_toFieldTransform(e){return new Lw(e.path,new wm)}isEqual(e){return e instanceof tk}}class nk extends Dh{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=u6(this,e,!0),r=this.vc.map((s=>Lh(s,t))),i=new uh(r);return new Lw(e.path,i)}isEqual(e){return e instanceof nk&&dl(this.vc,e.vc)}}class rk extends Dh{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=u6(this,e,!0),r=this.vc.map((s=>Lh(s,t))),i=new dh(r);return new Lw(e.path,i)}isEqual(e){return e instanceof rk&&dl(this.vc,e.vc)}}class ik extends Dh{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new _m(e.serializer,VU(e.serializer,this.Fc));return new Lw(e.path,t)}isEqual(e){return e instanceof ik&&this.Fc===e.Fc}}function sk(n,e,t,r){const i=n.Cc(1,e,t);ak("Data must be an object, but it was:",i,r);const s=[],o=_r.empty();vu(r,((c,d)=>{const h=lk(e,c,t);d=Fe(d);const m=i.yc(h);if(d instanceof Hw)s.push(h);else{const _=Lh(d,m);_!=null&&(s.push(h),o.set(h,_))}}));const a=new vi(s);return new l6(o,a,i.fieldTransforms)}function ok(n,e,t,r,i,s){const o=n.Cc(1,e,t),a=[zC(e,r,t)],c=[i];if(s.length%2!=0)throw new fe(oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)a.push(zC(e,s[_])),c.push(s[_+1]);const d=[],h=_r.empty();for(let _=a.length-1;_>=0;--_)if(!p6(d,a[_])){const x=a[_];let b=c[_];b=Fe(b);const A=o.yc(x);if(b instanceof Hw)d.push(x);else{const N=Lh(b,A);N!=null&&(d.push(x),h.set(x,N))}}const m=new vi(d);return new l6(h,m,o.fieldTransforms)}function d6(n,e,t,r=!1){return Lh(t,n.Cc(r?4:3,e))}function Lh(n,e){if(f6(n=Fe(n)))return ak("Unsupported field value:",e,n),h6(n,e);if(n instanceof Dh)return(function(r,i){if(!c6(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const a of r){let c=Lh(a,i.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VU(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Lt.fromDate(r);return{timestampValue:vm(i.serializer,s)}}if(r instanceof Lt){const s=new Lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vm(i.serializer,s)}}if(r instanceof to)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Lr)return{bytesValue:QU(i.serializer,r._byteString)};if(r instanceof Zt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:C1(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof la)return(function(o,a){return{mapValue:{fields:{[g1]:{stringValue:y1},[mm]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return E1(a.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${uT(r)}`)})(n,e)}function h6(n,e){const t={};return hU(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vu(n,((r,i)=>{const s=Lh(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function f6(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Lt||n instanceof to||n instanceof Lr||n instanceof Zt||n instanceof Dh||n instanceof la)}function ak(n,e,t){if(!f6(t)||!K3(t)){const r=uT(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function zC(n,e,t){if((e=Fe(e))instanceof du)return e._internalPath;if(typeof e=="string")return lk(n,e);throw $E("Field path arguments must be of type string or ",n,!1,void 0,t)}const Xte=new RegExp("[~\\*/\\[\\]]");function lk(n,e,t){if(e.search(Xte)>=0)throw $E(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new du(...e.split("."))._internalPath}catch{throw $E(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $E(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new fe(oe.INVALID_ARGUMENT,a+n+c)}function p6(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Zte(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(NT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Zte extends O0{data(){return super.data()}}function NT(n,e){return typeof e=="string"?lk(n,e):e instanceof du?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new fe(oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ck{}class Gw extends ck{}function cc(n,e,...t){let r=[];e instanceof ck&&r.push(e),r=r.concat(t),(function(s){const o=s.filter((c=>c instanceof uk)).length,a=s.filter((c=>c instanceof kT)).length;if(o>1||o>0&&a>0)throw new fe(oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class kT extends Gw{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new kT(e,t,r)}_apply(e){const t=this._parse(e);return y6(e._query,t),new ii(e.firestore,e.converter,PC(e._query,t))}_parse(e){const t=Mh(e.firestore);return(function(s,o,a,c,d,h,m){let _;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new fe(oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){CL(m,h);const b=[];for(const A of m)b.push(bL(c,s,A));_={arrayValue:{values:b}}}else _=bL(c,s,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||CL(m,h),_=d6(a,o,m,h==="in"||h==="not-in");return Et.create(d,h,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ene(n,e,t){const r=e,i=NT("where",n);return kT._create(i,r,t)}class uk extends ck{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uk(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Bt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i;const a=s.getFlattenedFilters();for(const c of a)y6(o,c),o=PC(o,c)})(e._query,t),new ii(e.firestore,e.converter,PC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class dk extends Gw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dk(e,t)}_apply(e){const t=(function(i,s,o){if(i.startAt!==null)throw new fe(oe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new fe(oe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new P0(s,o)})(e._query,this._field,this._direction);return new ii(e.firestore,e.converter,(function(i,s){const o=i.explicitOrderBy.concat([s]);return new Tl(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function tne(n,e="asc"){const t=e,r=NT("orderBy",n);return dk._create(r,t)}class PT extends Gw{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new PT(e,t,r)}_apply(e){return new ii(e.firestore,e.converter,OE(e._query,this._limit,this._limitType))}}function nne(n){return Q3("limit",n),PT._create("limit",n,"F")}function rne(n){return Q3("limitToLast",n),PT._create("limitToLast",n,"L")}class RT extends Gw{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new RT(e,t,r)}_apply(e){const t=g6(e,this.type,this._docOrFields,this._inclusive);return new ii(e.firestore,e.converter,(function(i,s){return new Tl(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)})(e._query,t))}}function ine(...n){return RT._create("startAt",n,!0)}function sne(...n){return RT._create("startAfter",n,!1)}class DT extends Gw{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new DT(e,t,r)}_apply(e){const t=g6(e,this.type,this._docOrFields,this._inclusive);return new ii(e.firestore,e.converter,(function(i,s){return new Tl(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)})(e._query,t))}}function one(...n){return DT._create("endBefore",n,!1)}function ane(...n){return DT._create("endAt",n,!0)}function g6(n,e,t,r){if(t[0]=Fe(t[0]),t[0]instanceof O0)return(function(s,o,a,c,d){if(!c)throw new fe(oe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const m of rp(s))if(m.field.isKeyField())h.push(lh(o,c.key));else{const _=c.data.field(m.field);if(mT(_))throw new fe(oe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(_===null){const x=m.field.canonicalString();throw new fe(oe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}h.push(_)}return new lu(h,d)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Mh(n.firestore);return(function(o,a,c,d,h,m){const _=o.explicitOrderBy;if(h.length>_.length)throw new fe(oe.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let b=0;b<h.length;b++){const A=h[b];if(_[b].field.isKeyField()){if(typeof A!="string")throw new fe(oe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof A}`);if(!_1(o)&&A.indexOf("/")!==-1)throw new fe(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${A}' contains a slash.`);const N=o.path.child(vt.fromString(A));if(!Se.isDocumentKey(N))throw new fe(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const F=new Se(N);x.push(lh(a,F))}else{const N=d6(c,d,A);x.push(N)}}return new lu(x,m)})(n._query,n.firestore._databaseId,i,e,t,r)}}function bL(n,e,t){if(typeof(t=Fe(t))=="string"){if(t==="")throw new fe(oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_1(e)&&t.indexOf("/")!==-1)throw new fe(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(vt.fromString(t));if(!Se.isDocumentKey(r))throw new fe(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lh(n,new Se(r))}if(t instanceof Zt)return lh(n,t._key);throw new fe(oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uT(t)}.`)}function CL(n,e){if(!Array.isArray(n)||n.length===0)throw new fe(oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function y6(n,e){const t=(function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new fe(oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class hk{convertValue(e,t="none"){switch(ou(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return vu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){var r,i,s;const t=(s=(i=(r=e.fields)==null?void 0:r[mm].arrayValue)==null?void 0:i.values)==null?void 0:s.map((o=>dn(o.doubleValue)));return new la(t)}convertGeoPoint(e){return new to(dn(e.latitude),dn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=gT(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(S0(e));default:return null}}convertTimestamp(e){const t=ml(e);return new Lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=vt.fromString(e);je(oB(r),9688,{name:e});const i=new su(r.get(1),r.get(3)),s=new Se(r.popFirst(5));return i.isEqual(t)||Dn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class lne extends hk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}class xd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Es=class w6 extends O0{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Yy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(NT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=w6._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Es._jsonSchemaVersion="firestore/documentSnapshot/1.0",Es._jsonSchema={type:Gn("string",Es._jsonSchemaVersion),bundleSource:Gn("string","DocumentSnapshot"),bundleName:Gn("string"),bundle:Gn("string")};let Yy=class extends Es{data(e={}){return super.data(e)}},no=class _6{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new xd(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Yy(this._firestore,this._userDataWriter,r.key,r,new xd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((a=>{const c=new Yy(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xd(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new Yy(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xd(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:cne(a.type),doc:c,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fe(oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_6._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=l1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function cne(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}function v6(n,e){return n instanceof Es&&e instanceof Es?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof no&&e instanceof no&&n._firestore===e._firestore&&s6(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function une(n){n=Pt(n,Zt);const e=Pt(n.firestore,On);return YB(Hr(e),n._key).then((t=>fk(e,n,t)))}no._jsonSchemaVersion="firestore/querySnapshot/1.0",no._jsonSchema={type:Gn("string",no._jsonSchemaVersion),bundleSource:Gn("string","QuerySnapshot"),bundleName:Gn("string"),bundle:Gn("string")};class Oh extends hk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}function dne(n){n=Pt(n,Zt);const e=Pt(n.firestore,On),t=Hr(e),r=new Oh(e);return Rte(t,n._key).then((i=>new Es(e,r,n._key,i,new xd(i!==null&&i.hasLocalMutations,!0),n.converter)))}function hne(n){n=Pt(n,Zt);const e=Pt(n.firestore,On);return YB(Hr(e),n._key,{source:"server"}).then((t=>fk(e,n,t)))}function fne(n){n=Pt(n,ii);const e=Pt(n.firestore,On),t=Hr(e),r=new Oh(e);return m6(n._query),XB(t,n._query).then((i=>new no(e,r,n,i)))}function pne(n){n=Pt(n,ii);const e=Pt(n.firestore,On),t=Hr(e),r=new Oh(e);return Dte(t,n._query).then((i=>new no(e,r,n,i)))}function mne(n){n=Pt(n,ii);const e=Pt(n.firestore,On),t=Hr(e),r=new Oh(e);return XB(t,n._query,{source:"server"}).then((i=>new no(e,r,n,i)))}function SL(n,e,t){n=Pt(n,Zt);const r=Pt(n.firestore,On),i=MT(n.converter,e,t);return jw(r,[ST(Mh(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,pn.none())])}function NL(n,e,t,...r){n=Pt(n,Zt);const i=Pt(n.firestore,On),s=Mh(i);let o;return o=typeof(e=Fe(e))=="string"||e instanceof du?ok(s,"updateDoc",n._key,e,t,r):sk(s,"updateDoc",n._key,e),jw(i,[o.toMutation(n._key,pn.exists(!0))])}function gne(n){return jw(Pt(n.firestore,On),[new Xm(n._key,pn.none())])}function yne(n,e){const t=Pt(n.firestore,On),r=zE(n),i=MT(n.converter,e);return jw(t,[ST(Mh(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,pn.exists(!1))]).then((()=>r))}function E6(n,...e){var c,d,h;n=Fe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||qC(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(qC(e[r])){const m=e[r];e[r]=(c=m.next)==null?void 0:c.bind(m),e[r+1]=(d=m.error)==null?void 0:d.bind(m),e[r+2]=(h=m.complete)==null?void 0:h.bind(m)}let s,o,a;if(n instanceof Zt)o=Pt(n.firestore,On),a=Jm(n._key.path),s={next:m=>{e[r]&&e[r](fk(o,n,m))},error:e[r+1],complete:e[r+2]};else{const m=Pt(n,ii);o=Pt(m.firestore,On),a=m._query;const _=new Oh(o);s={next:x=>{e[r]&&e[r](new no(o,_,m,x))},error:e[r+1],complete:e[r+2]},m6(n._query)}return(function(_,x,b,A){const N=new AT(A),F=new $1(x,N,b);return _.asyncQueue.enqueueAndForget((async()=>j1(await bm(_),F))),()=>{N.Nu(),_.asyncQueue.enqueueAndForget((async()=>q1(await bm(_),F)))}})(Hr(o),a,i,s)}function wne(n,e){return Mte(Hr(n=Pt(n,On)),qC(e)?e:{next:e})}function jw(n,e){return(function(r,i){const s=new xr;return r.asyncQueue.enqueueAndForget((async()=>ate(await ek(r),i,s))),s.promise})(Hr(n),e)}function fk(n,e,t){const r=t.docs.get(e._key),i=new Oh(n);return new Es(n,i,e._key,r,new xd(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ne={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vne=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Mh(e)}set(e,t,r){this._verifyNotCommitted();const i=Bc(e,this._firestore),s=MT(i.converter,t,r),o=ST(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,pn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Bc(e,this._firestore);let o;return o=typeof(t=Fe(t))=="string"||t instanceof du?ok(this._dataReader,"WriteBatch.update",s._key,t,r,i):sk(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,pn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Bc(e,this._firestore);return this._mutations=this._mutations.concat(new Xm(t._key,pn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new fe(oe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Bc(n,e){if((n=Fe(n)).firestore!==e)throw new fe(oe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ene=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Mh(e)}get(e){const t=Bc(e,this._firestore),r=new lne(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return Le(24041);const s=i[0];if(s.isFoundDocument())return new O0(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new O0(this._firestore,r,t._key,null,t.converter);throw Le(18433,{doc:s})}))}set(e,t,r){const i=Bc(e,this._firestore),s=MT(i.converter,t,r),o=ST(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){const s=Bc(e,this._firestore);let o;return o=typeof(t=Fe(t))=="string"||t instanceof du?ok(this._dataReader,"Transaction.update",s._key,t,r,i):sk(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=Bc(e,this._firestore);return this._transaction.delete(t._key),this}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xne=class extends Ene{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Bc(e,this._firestore),r=new Oh(this._firestore);return super.get(e).then((i=>new Es(this._firestore,r,t._key,i._document,new xd(!1,!1),t.converter)))}};function Tne(n,e,t){n=Pt(n,On);const r={..._ne,...t};return(function(s){if(s.maxAttempts<1)throw new fe(oe.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(s,o,a){const c=new xr;return s.asyncQueue.enqueueAndForget((async()=>{const d=await Nte(s);new Cte(s.asyncQueue,d,a,o,c).ju()})),c.promise})(Hr(n),(i=>e(new xne(n,i))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ine(){return new Hw("deleteField")}function Ane(){return new tk("serverTimestamp")}function bne(...n){return new nk("arrayUnion",n)}function Cne(...n){return new rk("arrayRemove",n)}function Sne(n){return new ik("increment",n)}(function(e,t=!0){(function(i){Qm=i})(vl),Ii(new qn("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new On(new EX(r.getProvider("auth-internal")),new IX(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new fe(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new su(d.options.projectId,h)})(o,i),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Er(sM,oM,e),Er(sM,oM,"esm2020")})();const Nne="@firebase/firestore-compat",kne="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new fe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(){if(typeof Uint8Array>"u")throw new fe("unimplemented","Uint8Arrays are not available in this environment.")}function PL(){if(!sZ())throw new fe("unimplemented","Blobs are unavailable in Firestore in this environment.")}let x6=class $C{constructor(e){this._delegate=e}static fromBase64String(e){return PL(),new $C(Lr.fromBase64String(e))}static fromUint8Array(e){return kL(),new $C(Lr.fromUint8Array(e))}toBase64(){return PL(),this._delegate.toBase64()}toUint8Array(){return kL(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n){return Pne(n,["next","error","complete"])}function Pne(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rne{enableIndexedDbPersistence(e,t){return Hte(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Gte(e._delegate)}clearIndexedDbPersistence(e){return jte(e._delegate)}}class T6{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof su||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&pa("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){Vte(this._delegate,e,t,r)}enableNetwork(){return zte(this._delegate)}disableNetwork(){return $te(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,W3("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return qte(this._delegate)}onSnapshotsInSync(e){return wne(this._delegate,e)}get app(){if(!this._appCompat)throw new fe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Cm(this,r6(this._delegate,e))}catch(t){throw Jr(t,"collection()","Firestore.collection()")}}doc(e){try{return new vs(this,zE(this._delegate,e))}catch(t){throw Jr(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Kr(this,Fte(this._delegate,e))}catch(t){throw Jr(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Tne(this._delegate,t=>e(new I6(this,t)))}batch(){return Hr(this._delegate),new A6(new vne(this._delegate,e=>jw(this._delegate,e)))}loadBundle(e){return Wte(this._delegate,e)}namedQuery(e){return Kte(this._delegate,e).then(t=>t?new Kr(this,t):null)}}class LT extends hk{constructor(e){super(),this.firestore=e}convertBytes(e){return new x6(new Lr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return vs.forKey(t,this.firestore,null)}}function Dne(n){yX(n)}let I6=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new LT(e)}get(e){const t=Td(e);return this._delegate.get(t).then(r=>new V0(this._firestore,new Es(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Td(e);return r?(pk("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Td(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Td(e);return this._delegate.delete(t),this}};class A6{constructor(e){this._delegate=e}set(e,t,r){const i=Td(e);return r?(pk("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Td(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Td(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class gh{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Yy(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new F0(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=gh.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new gh(e,new LT(e),t),i.set(t,s)),s}}gh.INSTANCES=new WeakMap;class vs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new LT(e)}static forPath(e,t,r){if(e.length%2!==0)throw new fe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new vs(t,new Zt(t._delegate,r,new Se(e)))}static forKey(e,t,r){return new vs(t,new Zt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Cm(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Cm(this.firestore,r6(this._delegate,e))}catch(t){throw Jr(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Fe(e),e instanceof Zt?i6(this._delegate,e):!1}set(e,t){t=pk("DocumentReference.set",t);try{return t?SL(this._delegate,e,t):SL(this._delegate,e)}catch(r){throw Jr(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?NL(this._delegate,e):NL(this._delegate,e,t,...r)}catch(i){throw Jr(i,"updateDoc()","DocumentReference.update()")}}delete(){return gne(this._delegate)}onSnapshot(...e){const t=b6(e),r=C6(e,i=>new V0(this.firestore,new Es(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return E6(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=dne(this._delegate):(e==null?void 0:e.source)==="server"?t=hne(this._delegate):t=une(this._delegate),t.then(r=>new V0(this.firestore,new Es(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new vs(this.firestore,e?this._delegate.withConverter(gh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Jr(n,e,t){return n.message=n.message.replace(e,t),n}function b6(n){for(const e of n)if(typeof e=="object"&&!WC(e))return e;return{}}function C6(n,e){var r,i;let t;return WC(n[0])?t=n[0]:WC(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:s=>{t.next&&t.next(e(s))},error:(r=t.error)==null?void 0:r.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class V0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new vs(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return v6(this._delegate,e._delegate)}}class F0 extends V0{data(e){const t=this._delegate.data(e);return this._delegate._converter||wX(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Kr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new LT(e)}where(e,t,r){try{return new Kr(this.firestore,cc(this._delegate,ene(e,t,r)))}catch(i){throw Jr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Kr(this.firestore,cc(this._delegate,tne(e,t)))}catch(r){throw Jr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Kr(this.firestore,cc(this._delegate,nne(e)))}catch(t){throw Jr(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Kr(this.firestore,cc(this._delegate,rne(e)))}catch(t){throw Jr(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Kr(this.firestore,cc(this._delegate,ine(...e)))}catch(t){throw Jr(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Kr(this.firestore,cc(this._delegate,sne(...e)))}catch(t){throw Jr(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Kr(this.firestore,cc(this._delegate,one(...e)))}catch(t){throw Jr(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Kr(this.firestore,cc(this._delegate,ane(...e)))}catch(t){throw Jr(t,"endAt()","Query.endAt()")}}isEqual(e){return s6(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=pne(this._delegate):(e==null?void 0:e.source)==="server"?t=mne(this._delegate):t=fne(this._delegate),t.then(r=>new KC(this.firestore,new no(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=b6(e),r=C6(e,i=>new KC(this.firestore,new no(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return E6(this._delegate,t,r)}withConverter(e){return new Kr(this.firestore,e?this._delegate.withConverter(gh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Mne{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new F0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class KC{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Kr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new F0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Mne(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new F0(this._firestore,r))})}isEqual(e){return v6(this._delegate,e._delegate)}}class Cm extends Kr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new vs(this.firestore,e):null}doc(e){try{return e===void 0?new vs(this.firestore,zE(this._delegate)):new vs(this.firestore,zE(this._delegate,e))}catch(t){throw Jr(t,"doc()","CollectionReference.doc()")}}add(e){return yne(this._delegate,e).then(t=>new vs(this.firestore,t))}isEqual(e){return i6(this._delegate,e._delegate)}withConverter(e){return new Cm(this.firestore,e?this._delegate.withConverter(gh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Td(n){return Pt(n,Zt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(...e){this._delegate=new du(...e)}static documentId(){return new mk(fn.keyField().canonicalString())}isEqual(e){return e=Fe(e),e instanceof du?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{static serverTimestamp(){const e=Ane();return e._methodName="FieldValue.serverTimestamp",new hd(e)}static delete(){const e=Ine();return e._methodName="FieldValue.delete",new hd(e)}static arrayUnion(...e){const t=bne(...e);return t._methodName="FieldValue.arrayUnion",new hd(t)}static arrayRemove(...e){const t=Cne(...e);return t._methodName="FieldValue.arrayRemove",new hd(t)}static increment(e){const t=Sne(e);return t._methodName="FieldValue.increment",new hd(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lne={Firestore:T6,GeoPoint:to,Timestamp:Lt,Blob:x6,Transaction:I6,WriteBatch:A6,DocumentReference:vs,DocumentSnapshot:V0,Query:Kr,QueryDocumentSnapshot:F0,QuerySnapshot:KC,CollectionReference:Cm,FieldPath:mk,FieldValue:hd,setLogLevel:Dne,CACHE_SIZE_UNLIMITED:Bte};function One(n,e){n.INTERNAL.registerComponent(new qn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...Lne}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vne(n){One(n,(e,t)=>new T6(e,t,new Rne)),n.registerVersion(Nne,kne)}Vne(Mn);const S6="@firebase/installations",gk="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=1e4,k6=`w:${gk}`,P6="FIS_v2",Fne="https://firebaseinstallations.googleapis.com/v1",Une=3600*1e3,Bne="installations",Hne="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gne={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},yh=new ya(Bne,Hne,Gne);function R6(n){return n instanceof Vr&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6({projectId:n}){return`${Fne}/projects/${n}/installations`}function M6(n){return{token:n.token,requestStatus:2,expiresIn:qne(n.expiresIn),creationTime:Date.now()}}async function L6(n,e){const r=(await e.json()).error;return yh.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function O6({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function jne(n,{refreshToken:e}){const t=O6(n);return t.append("Authorization",zne(e)),t}async function V6(n){const e=await n();return e.status>=500&&e.status<600?n():e}function qne(n){return Number(n.replace("s","000"))}function zne(n){return`${P6} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $ne({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=D6(n),i=O6(n),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={fid:t,authVersion:P6,appId:n.appId,sdkVersion:k6},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await V6(()=>fetch(r,a));if(c.ok){const d=await c.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:M6(d.authToken)}}else throw await L6("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F6(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wne(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kne=/^[cdef][\w-]{21}$/,QC="";function Qne(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Jne(n);return Kne.test(t)?t:QC}catch{return QC}}function Jne(n){return Wne(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=new Map;function B6(n,e){const t=OT(n);H6(t,e),Yne(t,e)}function H6(n,e){const t=U6.get(n);if(t)for(const r of t)r(e)}function Yne(n,e){const t=Xne();t&&t.postMessage({key:n,fid:e}),Zne()}let Id=null;function Xne(){return!Id&&"BroadcastChannel"in self&&(Id=new BroadcastChannel("[Firebase] FID Change"),Id.onmessage=n=>{H6(n.data.key,n.data.fid)}),Id}function Zne(){U6.size===0&&Id&&(Id.close(),Id=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ere="firebase-installations-database",tre=1,wh="firebase-installations-store";let ab=null;function yk(){return ab||(ab=Hm(ere,tre,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(wh)}}})),ab}async function WE(n,e){const t=OT(n),i=(await yk()).transaction(wh,"readwrite"),s=i.objectStore(wh),o=await s.get(t);return await s.put(e,t),await i.done,(!o||o.fid!==e.fid)&&B6(n,e.fid),e}async function G6(n){const e=OT(n),r=(await yk()).transaction(wh,"readwrite");await r.objectStore(wh).delete(e),await r.done}async function VT(n,e){const t=OT(n),i=(await yk()).transaction(wh,"readwrite"),s=i.objectStore(wh),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await i.done,a&&(!o||o.fid!==a.fid)&&B6(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wk(n){let e;const t=await VT(n.appConfig,r=>{const i=nre(r),s=rre(n,i);return e=s.registrationPromise,s.installationEntry});return t.fid===QC?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function nre(n){const e=n||{fid:Qne(),registrationStatus:0};return j6(e)}function rre(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(yh.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=ire(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:sre(n)}:{installationEntry:e}}async function ire(n,e){try{const t=await $ne(n,e);return WE(n.appConfig,t)}catch(t){throw R6(t)&&t.customData.serverCode===409?await G6(n.appConfig):await WE(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function sre(n){let e=await RL(n.appConfig);for(;e.registrationStatus===1;)await F6(100),e=await RL(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await wk(n);return r||t}return e}function RL(n){return VT(n,e=>{if(!e)throw yh.create("installation-not-found");return j6(e)})}function j6(n){return ore(n)?{fid:n.fid,registrationStatus:0}:n}function ore(n){return n.registrationStatus===1&&n.registrationTime+N6<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function are({appConfig:n,heartbeatServiceProvider:e},t){const r=lre(n,t),i=jne(n,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={installation:{sdkVersion:k6,appId:n.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await V6(()=>fetch(r,a));if(c.ok){const d=await c.json();return M6(d)}else throw await L6("Generate Auth Token",c)}function lre(n,{fid:e}){return`${D6(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _k(n,e=!1){let t;const r=await VT(n.appConfig,s=>{if(!q6(s))throw yh.create("not-registered");const o=s.authToken;if(!e&&dre(o))return s;if(o.requestStatus===1)return t=cre(n,e),s;{if(!navigator.onLine)throw yh.create("app-offline");const a=fre(s);return t=ure(n,a),a}});return t?await t:r.authToken}async function cre(n,e){let t=await DL(n.appConfig);for(;t.authToken.requestStatus===1;)await F6(100),t=await DL(n.appConfig);const r=t.authToken;return r.requestStatus===0?_k(n,e):r}function DL(n){return VT(n,e=>{if(!q6(e))throw yh.create("not-registered");const t=e.authToken;return pre(t)?{...e,authToken:{requestStatus:0}}:e})}async function ure(n,e){try{const t=await are(n,e),r={...e,authToken:t};return await WE(n.appConfig,r),t}catch(t){if(R6(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await G6(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await WE(n.appConfig,r)}throw t}}function q6(n){return n!==void 0&&n.registrationStatus===2}function dre(n){return n.requestStatus===2&&!hre(n)}function hre(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Une}function fre(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function pre(n){return n.requestStatus===1&&n.requestTime+N6<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mre(n){const e=n,{installationEntry:t,registrationPromise:r}=await wk(e);return r?r.catch(console.error):_k(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gre(n,e=!1){const t=n;return await yre(t),(await _k(t,e)).token}async function yre(n){const{registrationPromise:e}=await wk(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wre(n){if(!n||!n.options)throw lb("App Configuration");if(!n.name)throw lb("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw lb(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function lb(n){return yh.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6="installations",_re="installations-internal",vre=n=>{const e=n.getProvider("app").getImmediate(),t=wre(e),r=Rx(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Ere=n=>{const e=n.getProvider("app").getImmediate(),t=Rx(e,z6).getImmediate();return{getId:()=>mre(t),getToken:i=>gre(t,i)}};function xre(){Ii(new qn(z6,vre,"PUBLIC")),Ii(new qn(_re,Ere,"PRIVATE"))}xre();Er(S6,gk);Er(S6,gk,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tre="/firebase-messaging-sw.js",Ire="/firebase-cloud-messaging-push-scope",$6="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Are="https://fcmregistrations.googleapis.com/v1",W6="google.c.a.c_id",bre="google.c.a.c_l",Cre="google.c.a.ts",Sre="google.c.a.e",ML=1e4;var LL;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(LL||(LL={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var U0;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(U0||(U0={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Nre(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="fcm_token_details_db",kre=5,OL="fcm_token_object_Store";async function Pre(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(cb))return null;let e=null;return(await Hm(cb,kre,{upgrade:async(r,i,s,o)=>{if(i<2||!r.objectStoreNames.contains(OL))return;const a=o.objectStore(OL),c=await a.index("fcmSenderId").get(n);if(await a.clear(),!!c){if(i===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Fa(d.vapidKey)}}}else if(i===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fa(d.auth),p256dh:Fa(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fa(d.vapidKey)}}}else if(i===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fa(d.auth),p256dh:Fa(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fa(d.vapidKey)}}}}}})).close(),await Jf(cb),await Jf("fcm_vapid_details_db"),await Jf("undefined"),Rre(e)?e:null}function Rre(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dre="firebase-messaging-database",Mre=1,_h="firebase-messaging-store";let ub=null;function vk(){return ub||(ub=Hm(Dre,Mre,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(_h)}}})),ub}async function K6(n){const e=xk(n),r=await(await vk()).transaction(_h).objectStore(_h).get(e);if(r)return r;{const i=await Pre(n.appConfig.senderId);if(i)return await Ek(n,i),i}}async function Ek(n,e){const t=xk(n),i=(await vk()).transaction(_h,"readwrite");return await i.objectStore(_h).put(e,t),await i.done,e}async function Lre(n){const e=xk(n),r=(await vk()).transaction(_h,"readwrite");await r.objectStore(_h).delete(e),await r.done}function xk({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ore={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ri=new ya("messaging","Messaging",Ore);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vre(n,e){const t=await Ik(n),r=J6(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(Tk(n.appConfig),i)).json()}catch(o){throw ri.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw ri.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw ri.create("token-subscribe-no-token");return s.token}async function Fre(n,e){const t=await Ik(n),r=J6(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${Tk(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw ri.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw ri.create("token-update-failed",{errorInfo:o})}if(!s.token)throw ri.create("token-update-no-token");return s.token}async function Q6(n,e){const r={method:"DELETE",headers:await Ik(n)};try{const s=await(await fetch(`${Tk(n.appConfig)}/${e}`,r)).json();if(s.error){const o=s.error.message;throw ri.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw ri.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function Tk({projectId:n}){return`${Are}/projects/${n}/registrations`}async function Ik({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function J6({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==$6&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ure=10080*60*1e3;async function Bre(n){const e=await jre(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Fa(e.getKey("auth")),p256dh:Fa(e.getKey("p256dh"))},r=await K6(n.firebaseDependencies);if(r){if(qre(r.subscriptionOptions,t))return Date.now()>=r.createTime+Ure?Gre(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await Q6(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return VL(n.firebaseDependencies,t)}else return VL(n.firebaseDependencies,t)}async function Hre(n){const e=await K6(n.firebaseDependencies);e&&(await Q6(n.firebaseDependencies,e.token),await Lre(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function Gre(n,e){try{const t=await Fre(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await Ek(n.firebaseDependencies,r),t}catch(t){throw t}}async function VL(n,e){const r={token:await Vre(n,e),createTime:Date.now(),subscriptionOptions:e};return await Ek(n,r),r.token}async function jre(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Nre(e)})}function qre(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FL(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return zre(e,n),$re(e,n),Wre(e,n),e}function zre(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const s=e.notification.icon;s&&(n.notification.icon=s)}function $re(n,e){e.data&&(n.data=e.data)}function Wre(n,e){var i,s,o,a;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((s=e.fcmOptions)==null?void 0:s.link)??((o=e.notification)==null?void 0:o.click_action);t&&(n.fcmOptions.link=t);const r=(a=e.fcmOptions)==null?void 0:a.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kre(n){return typeof n=="object"&&!!n&&W6 in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qre(n){if(!n||!n.options)throw db("App Configuration Object");if(!n.name)throw db("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw db(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function db(n){return ri.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jre=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=Qre(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y6(n){try{n.swRegistration=await navigator.serviceWorker.register(Tre,{scope:Ire}),n.swRegistration.update().catch(()=>{}),await Yre(n.swRegistration)}catch(e){throw ri.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function Yre(n){return new Promise((e,t)=>{const r=setTimeout(()=>t(new Error(`Service worker not registered after ${ML} ms`)),ML),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=s=>{var o;((o=s.target)==null?void 0:o.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xre(n,e){if(!e&&!n.swRegistration&&await Y6(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw ri.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zre(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=$6)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X6(n,e){if(!navigator)throw ri.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw ri.create("permission-blocked");return await Zre(n,e==null?void 0:e.vapidKey),await Xre(n,e==null?void 0:e.serviceWorkerRegistration),Bre(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eie(n,e,t){const r=tie(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[W6],message_name:t[bre],message_time:t[Cre],message_device_time:Math.floor(Date.now()/1e3)})}function tie(n){switch(n){case U0.NOTIFICATION_CLICKED:return"notification_open";case U0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nie(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===U0.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(FL(t)):n.onMessageHandler.next(FL(t)));const r=t.data;Kre(r)&&r[Sre]==="1"&&await eie(n,t.messageType,r)}const UL="@firebase/messaging",BL="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rie=n=>{const e=new Jre(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>nie(e,t)),e},iie=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>X6(e,r)}};function sie(){Ii(new qn("messaging",rie,"PUBLIC")),Ii(new qn("messaging-internal",iie,"PRIVATE")),Er(UL,BL),Er(UL,BL,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oie(n){if(!navigator)throw ri.create("only-available-in-window");return n.swRegistration||await Y6(n),Hre(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aie(n,e){if(!navigator)throw ri.create("only-available-in-window");return n.onMessageHandler=e,()=>{n.onMessageHandler=null}}async function lie(n,e){return n=Fe(n),X6(n,e)}function cie(n){return n=Fe(n),oie(n)}function uie(n,e){return n=Fe(n),aie(n,e)}sie();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",die="https://fcmregistrations.googleapis.com/v1",e8="FCM_MSG",hie="google.c.a.c_id",fie=3,pie=1;var KE;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(KE||(KE={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var QE;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(QE||(QE={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function mie(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="fcm_token_details_db",gie=5,HL="fcm_token_object_Store";async function yie(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(hb))return null;let e=null;return(await Hm(hb,gie,{upgrade:async(r,i,s,o)=>{if(i<2||!r.objectStoreNames.contains(HL))return;const a=o.objectStore(HL),c=await a.index("fcmSenderId").get(n);if(await a.clear(),!!c){if(i===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Ua(d.vapidKey)}}}else if(i===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ua(d.auth),p256dh:Ua(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ua(d.vapidKey)}}}else if(i===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ua(d.auth),p256dh:Ua(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ua(d.vapidKey)}}}}}})).close(),await Jf(hb),await Jf("fcm_vapid_details_db"),await Jf("undefined"),wie(e)?e:null}function wie(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ie="firebase-messaging-database",vie=1,vh="firebase-messaging-store";let fb=null;function Ak(){return fb||(fb=Hm(_ie,vie,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(vh)}}})),fb}async function bk(n){const e=Sk(n),r=await(await Ak()).transaction(vh).objectStore(vh).get(e);if(r)return r;{const i=await yie(n.appConfig.senderId);if(i)return await Ck(n,i),i}}async function Ck(n,e){const t=Sk(n),i=(await Ak()).transaction(vh,"readwrite");return await i.objectStore(vh).put(e,t),await i.done,e}async function Eie(n){const e=Sk(n),r=(await Ak()).transaction(vh,"readwrite");await r.objectStore(vh).delete(e),await r.done}function Sk({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xie={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ca=new ya("messaging","Messaging",xie);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tie(n,e){const t=await kk(n),r=n8(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(Nk(n.appConfig),i)).json()}catch(o){throw ca.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw ca.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw ca.create("token-subscribe-no-token");return s.token}async function Iie(n,e){const t=await kk(n),r=n8(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${Nk(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw ca.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw ca.create("token-update-failed",{errorInfo:o})}if(!s.token)throw ca.create("token-update-no-token");return s.token}async function t8(n,e){const r={method:"DELETE",headers:await kk(n)};try{const s=await(await fetch(`${Nk(n.appConfig)}/${e}`,r)).json();if(s.error){const o=s.error.message;throw ca.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw ca.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function Nk({projectId:n}){return`${die}/projects/${n}/registrations`}async function kk({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function n8({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==Z6&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aie=10080*60*1e3;async function bie(n){const e=await Sie(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Ua(e.getKey("auth")),p256dh:Ua(e.getKey("p256dh"))},r=await bk(n.firebaseDependencies);if(r){if(Nie(r.subscriptionOptions,t))return Date.now()>=r.createTime+Aie?Cie(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await t8(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return jL(n.firebaseDependencies,t)}else return jL(n.firebaseDependencies,t)}async function GL(n){const e=await bk(n.firebaseDependencies);e&&(await t8(n.firebaseDependencies,e.token),await Eie(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function Cie(n,e){try{const t=await Iie(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await Ck(n.firebaseDependencies,r),t}catch(t){throw t}}async function jL(n,e){const r={token:await Tie(n,e),createTime:Date.now(),subscriptionOptions:e};return await Ck(n,r),r.token}async function Sie(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:mie(e)})}function Nie(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kie(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return Pie(e,n),Rie(e,n),Die(e,n),e}function Pie(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const s=e.notification.icon;s&&(n.notification.icon=s)}function Rie(n,e){e.data&&(n.data=e.data)}function Die(n,e){var i,s,o,a;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((s=e.fcmOptions)==null?void 0:s.link)??((o=e.notification)==null?void 0:o.click_action);t&&(n.fcmOptions.link=t);const r=(a=e.fcmOptions)==null?void 0:a.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mie(n){return typeof n=="object"&&!!n&&hie in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lie(n){return new Promise(e=>{setTimeout(e,n)})}async function Oie(n,e){const t=Vie(e,await n.firebaseDependencies.installations.getId());Fie(n,t,e.productId)}function Vie(n,e){var r,i;const t={};return n.from&&(t.project_number=n.from),n.fcmMessageId&&(t.message_id=n.fcmMessageId),t.instance_id=e,n.notification?t.message_type=KE.DISPLAY_NOTIFICATION.toString():t.message_type=KE.DATA_MESSAGE.toString(),t.sdk_platform=fie.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),n.collapse_key&&(t.collapse_key=n.collapse_key),t.event=pie.toString(),(r=n.fcmOptions)!=null&&r.analytics_label&&(t.analytics_label=(i=n.fcmOptions)==null?void 0:i.analytics_label),t}function Fie(n,e,t){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(r.compliance_data=Uie(t)),n.logEvents.push(r)}function Uie(n){return{privacy_context:{prequest:{origin_associated_product_id:n}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bie(n,e){var i;const{newSubscription:t}=n;if(!t){await GL(e);return}const r=await bk(e.firebaseDependencies);await GL(e),e.vapidKey=((i=r==null?void 0:r.subscriptionOptions)==null?void 0:i.vapidKey)??Z6,await bie(e)}async function Hie(n,e){const t=qie(n);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await Oie(e,t);const r=await r8();if($ie(r))return Wie(r,t);if(t.notification&&await Kie(jie(t)),!!e&&e.onBackgroundMessageHandler){const i=kie(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(i):e.onBackgroundMessageHandler.next(i)}}async function Gie(n){var o,a;const e=(a=(o=n.notification)==null?void 0:o.data)==null?void 0:a[e8];if(e){if(n.action)return}else return;n.stopImmediatePropagation(),n.notification.close();const t=Qie(e);if(!t)return;const r=new URL(t,self.location.href),i=new URL(self.location.origin);if(r.host!==i.host)return;let s=await zie(r);if(s?s=await s.focus():(s=await self.clients.openWindow(t),await Lie(3e3)),!!s)return e.messageType=QE.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,s.postMessage(e)}function jie(n){const e={...n.notification};return e.data={[e8]:n},e}function qie({data:n}){if(!n)return null;try{return n.json()}catch{return null}}async function zie(n){const e=await r8();for(const t of e){const r=new URL(t.url,self.location.href);if(n.host===r.host)return t}return null}function $ie(n){return n.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function Wie(n,e){e.isFirebaseMessaging=!0,e.messageType=QE.PUSH_RECEIVED;for(const t of n)t.postMessage(e)}function r8(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Kie(n){const{actions:e}=n,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(n.title??"",n)}function Qie(n){var t,r;const e=((t=n.fcmOptions)==null?void 0:t.link)??((r=n.notification)==null?void 0:r.click_action);return e||(Mie(n.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jie(n){if(!n||!n.options)throw pb("App Configuration Object");if(!n.name)throw pb("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw pb(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function pb(n){return ca.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yie{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=Jie(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xie=n=>{const e=new Yie(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(Hie(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(Bie(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(Gie(t))}),e};function Zie(){Ii(new qn("messaging-sw",Xie,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ese(n,e){if(self.document!==void 0)throw ca.create("only-available-in-sw");return n.onBackgroundMessageHandler=e,()=>{n.onBackgroundMessageHandler=null}}function tse(n,e){return n=Fe(n),ese(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zie();const nse="@firebase/messaging-compat",rse="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ise(){return self&&"ServiceWorkerGlobalScope"in self?ose():sse()}function sse(){return typeof window<"u"&&eh()&&qG()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function ose(){return eh()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class qL{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return lie(this._delegate,e)}async deleteToken(){return cie(this._delegate)}onMessage(e){return uie(this._delegate,e)}onBackgroundMessage(e){return tse(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ase=n=>self&&"ServiceWorkerGlobalScope"in self?new qL(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging-sw").getImmediate()):new qL(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging").getImmediate()),lse={isSupported:ise};function cse(){Mn.INTERNAL.registerComponent(new qn("messaging-compat",ase,"PUBLIC").setServiceProps(lse))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cse();Mn.registerVersion(nse,rse);const use={apiKey:"AIzaSyAsAmByLvLqfFAKPiAeen0UJWdjT9MnTxQ",authDomain:"antamvieclam.firebaseapp.com",projectId:"antamvieclam",storageBucket:"antamvieclam.appspot.com",messagingSenderId:"221272132411",appId:"1:221272132411:web:83f7ab86a08823f3c8451e",measurementId:"G-2PT3C0KQWB",databaseURL:"https://antamvieclam-default-rtdb.asia-southeast1.firebasedatabase.app"};Mn.apps.length?Mn.app():Mn.initializeApp(use);const dy=Mn.auth(),at=Mn.firestore(),zL=Mn.messaging(),JE=Mn.database(),ga=Mn.firestore.FieldValue.serverTimestamp,dse=Mn.firestore.FieldValue.arrayUnion,Pk=Mn.firestore.FieldValue.increment,hse="BC0S6kKANv-QpY1c-5rXw1Xg_WfH3Z7T6t_g8C6Z4-F8r4w8S9tQ8n7w6X3Z7f7b5t3b3Y5F-E1d0D9k8H",fse=async n=>{if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}if(Notification.permission==="granted")await $L(n);else if(Notification.permission!=="denied"){console.log("Requesting notification permission...");try{await Notification.requestPermission()==="granted"?(console.log("Notification permission granted."),await $L(n)):console.log("Notification permission denied.")}catch(e){console.error("An error occurred while requesting permission:",e)}}else console.log("Notification permission previously denied.")},$L=async n=>{try{const e=await zL.getToken({vapidKey:hse});e?(await at.collection("users").doc(n).update({fcmTokens:dse(e)}),console.log("FCM token saved for user."),zL.onMessage(r=>{console.log("Foreground message received. ",r)})):console.log("No registration token available. Request permission to generate one.")}catch(e){console.error("An error occurred while retrieving token:",e)}},Rk=async(n,e,t,r)=>{try{await at.collection("notifications").add({userId:n,type:e,message:t,link:r,isRead:!1,createdAt:ga()})}catch(i){console.error("Error creating notification:",i)}},pse=(n,e)=>at.collection("notifications").where("userId","==",n).onSnapshot(s=>{const o=[];s.forEach(a=>{var h;const c=a.data(),d=(h=c.createdAt)!=null&&h.toDate?c.createdAt.toDate().toISOString():new Date().toISOString();o.push({id:a.id,...c,createdAt:d})}),o.sort((a,c)=>new Date(c.createdAt).getTime()-new Date(a.createdAt).getTime()),e(o)},s=>{console.error("Error fetching notifications:",s),e([])}),mse=async n=>{await at.collection("notifications").doc(n).update({isRead:!0})},gse=async(n,e)=>{const t=e.filter(i=>!i.isRead);if(t.length===0)return;const r=at.batch();t.forEach(i=>{const s=at.collection("notifications").doc(i.id);r.update(s,{isRead:!0})}),await r.commit()},i8={isOnline:!1,lastSeen:Mn.database.ServerValue.TIMESTAMP},yse={isOnline:!0,lastSeen:Mn.database.ServerValue.TIMESTAMP},wse=async n=>{try{await JE.ref(`/users/${n}/status`).set(i8)}catch(e){console.error("Error setting user offline:",e)}},_se=n=>{const e=JE.ref(`/users/${n}/status`),t=JE.ref(".info/connected"),r=t.on("value",i=>{i.val()!==!1&&e.onDisconnect().set(i8).then(()=>{e.set(yse).catch(s=>console.warn("Presence set online failed",s.code))}).catch(s=>console.warn("Presence onDisconnect failed",s.code))});return()=>{t.off("value",r)}},s8=Y.createContext(void 0),wa=()=>{const n=Y.useContext(s8);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},vse=({children:n})=>{const[e,t]=Y.useState(null),[r,i]=Y.useState(null),[s,o]=Y.useState(!0),a=async b=>{var F;if(!b){i(null);return}const N=await at.collection("users").doc(b.uid).get();if(N.exists){const B=N.data(),O=(F=B.createdAt)!=null&&F.toDate?B.createdAt.toDate().toISOString():new Date().toISOString(),q={uid:B.uid,email:B.email,userType:B.userType,createdAt:O,fullName:B.fullName,phoneNumber:B.phoneNumber,address:B.address,profileImageUrl:B.profileImageUrl,fcmTokens:B.fcmTokens||[],bio:B.bio||"",skills:B.skills||[],workHistory:B.workHistory||[],cvUrl:B.cvUrl||null,cvName:B.cvName||null,walletAddress:B.walletAddress||null};i(q)}else console.log("No such user document!"),i(null)},c=Y.useCallback(async()=>{e&&await a(e)},[e]),d=async(b,A,N)=>{const F=await dy.createUserWithEmailAndPassword(b,A),{user:B}=F;if(!B)throw new Error("User creation failed.");return await at.collection("users").doc(B.uid).set({uid:B.uid,email:B.email,userType:N,createdAt:ga(),fullName:null,phoneNumber:null,address:null,profileImageUrl:null,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}),F},h=(b,A)=>dy.signInWithEmailAndPassword(b,A),m=async()=>{try{if(e&&await wse(e.uid),await dy.signOut(),"serviceWorker"in navigator)try{const b=await navigator.serviceWorker.getRegistrations();for(const A of b)await A.unregister()}catch(b){console.warn("Could not unregister service workers:",b)}localStorage.clear(),sessionStorage.clear(),window.location.reload()}catch(b){console.error("Logout error:",b),window.location.reload()}},_=async()=>{const b=new Mn.auth.GoogleAuthProvider;try{await dy.signInWithPopup(b)}catch(A){throw console.error("Error with Google Sign-in Popup:",A),A}};Y.useEffect(()=>{let b;const A=dy.onAuthStateChanged(async N=>{b&&(b(),b=void 0),t(N),N?(await a(N),await fse(N.uid),b=_se(N.uid)):i(null),o(!1)});return()=>{A(),b&&b()}},[]);const x={currentUser:e,currentUserData:r,loading:s,signup:d,login:h,logout:m,loginWithGoogle:_,refetchUserData:c};return p.jsx(s8.Provider,{value:x,children:!s&&n})},Ese=async n=>{const{workerId:e,employerId:t}=n,r=[e,t].sort(),i=r.join("_"),s=at.collection("conversations").doc(i);if(!(await s.get()).exists){const a={[e]:{fullName:n.workerName,profileImageUrl:n.workerProfileImageUrl||null},[t]:{fullName:n.employerName,profileImageUrl:n.employerProfileImageUrl||null}},c={[e]:0,[t]:0};await s.set({id:i,participants:r,participantInfo:a,lastMessage:`Bt u tr chuyn v cng vic: ${n.jobTitle}`,lastMessageTimestamp:ga(),unreadCounts:c})}return i},o8=(n,e)=>at.collection("conversations").where("participants","array-contains",n).onSnapshot(s=>{const o=[];s.forEach(a=>{var h;const c=a.data(),d=(h=c.lastMessageTimestamp)!=null&&h.toDate?c.lastMessageTimestamp.toDate().toISOString():new Date().toISOString();o.push({id:a.id,...c,lastMessageTimestamp:d})}),o.sort((a,c)=>new Date(c.lastMessageTimestamp||0).getTime()-new Date(a.lastMessageTimestamp||0).getTime()),e(o)},s=>{console.error("Error fetching conversations:",s),e([])}),xse=(n,e)=>at.collection("conversations").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(s=>{const o=[];s.forEach(a=>{var h;const c=a.data(),d=(h=c.timestamp)!=null&&h.toDate?c.timestamp.toDate().toISOString():new Date().toISOString();o.push({id:a.id,conversationId:n,...c,timestamp:d})}),e(o)},s=>{console.error("Error fetching messages:",s),e([])}),Tse=async(n,e,t,r)=>{if(!r.trim())return;await at.collection("conversations").doc(n).collection("messages").add({senderId:e,text:r,timestamp:ga(),status:"sent",deleted:!1});const s=at.collection("conversations").doc(n),o=await s.get();if(o.exists){const c=o.data().participants.find(d=>d!==e);if(c){const d={lastMessage:r,lastMessageTimestamp:ga(),[`unreadCounts.${c}`]:Pk(1)};await s.update(d)}}},Ise=async(n,e)=>{const t=at.collection("conversations").doc(n);try{await t.update({[`unreadCounts.${e}`]:0})}catch(r){console.error("Error marking conversation as read:",r)}},Ase=async(n,e)=>{const r=at.collection("conversations").doc(n).collection("messages").where("senderId","!=",e).where("status","==","sent");try{const i=await r.get();if(i.empty)return;const s=at.batch();i.forEach(o=>{s.update(o.ref,{status:"read"})}),await s.commit()}catch(i){console.error("Error marking messages as read:",i)}},bse=async(n,e,t,r)=>{if(t!==r)throw new Error("You can only delete your own messages.");await at.collection("conversations").doc(n).collection("messages").doc(e).update({text:"Tin nhn ny  c thu hi.",deleted:!0})},Cse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M10 2a2 2 0 00-2 2v1h4V4a2 2 0 00-2-2zM4 7v1h12V7a1 1 0 00-1-1H5a1 1 0 00-1 1zm0 3v7a1 1 0 001 1h10a1 1 0 001-1v-7H4z",clipRule:"evenodd"})}),Sse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M12.016 2.002c-5.523 0-9.984 4.47-9.984 9.998 0 3.803 2.12 7.126 5.234 8.786a.75.75 0 00.98-.103l.055-.065a.75.75 0 00-.03-1.06l-1.29-1.29a.75.75 0 01-.217-.53v-3.384a3.75 3.75 0 016.48-2.457.75.75 0 001.353-.646A3.75 3.75 0 0118 9.75v3.384a.75.75 0 01-.217.53l-1.29 1.29a.75.75 0 00-.03 1.06l.055.065a.75.75 0 00.98.103c3.113-1.66 5.234-4.983 5.234-8.786C22 6.472 17.539 2.002 12.016 2.002zM8.982 13.24a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l4.5-4.5a.75.75 0 00-1.06-1.06L10.5 14.94l-1.518-1.518z",clipRule:"evenodd"})}),Nse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})}),kse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.774.182 1.584.279 2.417.279 5.352 0 9.75-4.348 9.75-9.75S17.352 2.25 12 2.25 2.25 6.598 2.25 12c0 1.752.47 3.419 1.305 4.804l-1.125 4.498a.75.75 0 00.916.916l4.498-1.125zM8.25 12a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H9a.75.75 0 01-.75-.75zm3.75 0a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H12.75a.75.75 0 01-.75-.75zm3-1.5a.75.75 0 000 1.5h.01a.75.75 0 000-1.5H15z",clipRule:"evenodd"})}),Pse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",clipRule:"evenodd"})}),Rse=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:p.jsx("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 01.721.544l.813 2.846a3.75 3.75 0 002.576 2.576l2.846.813a.75.75 0 010 1.442l-2.846.813a3.75 3.75 0 00-2.576 2.576l-.813 2.846a.75.75 0 01-1.442 0l-.813-2.846a3.75 3.75 0 00-2.576-2.576l-2.846-.813a.75.75 0 010-1.442l2.846-.813a3.75 3.75 0 002.576-2.576l.813-2.846A.75.75 0 019 4.5zM18 1.5a.75.75 0 01.728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 010 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 01-1.456 0l-.258-1.036a2.625 2.625 0 00-1.91-1.91l-1.036-.258a.75.75 0 010-1.456l1.036-.258a2.625 2.625 0 001.91-1.91l.258-1.036A.75.75 0 0118 1.5zM16.5 15a.75.75 0 01.712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 010 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 01-1.422 0l-.395-1.183a1.5 1.5 0 00-.948-.948l-1.183-.395a.75.75 0 010-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0116.5 15z",clipRule:"evenodd"})}),Dse=({icon:n,activeIcon:e,label:t,isActive:r,onClick:i,hasUnread:s=!1})=>p.jsxs("button",{onClick:i,className:`relative flex flex-col items-center justify-center space-y-1 w-full p-2 rounded-lg transition-colors duration-200 ${r?"text-indigo-600 bg-indigo-50":"text-gray-500 hover:bg-gray-100"}`,children:[r?e:n,p.jsx("span",{className:"text-[10px] font-medium text-center leading-tight",children:t}),s&&p.jsx("span",{className:"absolute top-1 right-3 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),Mse=({label:n,isActive:e,onClick:t,hasUnread:r=!1})=>p.jsxs("button",{onClick:t,className:`relative px-3 py-2 rounded-md text-sm transition-colors duration-200 ${e?"text-indigo-600 font-semibold":"text-gray-600 hover:text-indigo-600 font-medium"}`,children:[n,e&&p.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-5 h-0.5 bg-indigo-600 rounded-full"}),r&&p.jsx("span",{className:"absolute top-1 right-0 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),Lse=({activeView:n,setActiveView:e,onPostJobClick:t,onNotificationNavigate:r})=>{const{currentUser:i,currentUserData:s,logout:o}=wa(),[a,c]=Y.useState([]),[d,h]=Y.useState(!1),[m,_]=Y.useState(0),x=a.filter(B=>!B.isRead).length;Y.useEffect(()=>{if(i){const B=pse(i.uid,c),O=o8(i.uid,q=>{const W=q.reduce(($,D)=>{var k;return $+(((k=D.unreadCounts)==null?void 0:k[i.uid])||0)},0);_(W)});return()=>{B(),O()}}},[i]);const b=async()=>{try{await o()}catch(B){console.error("Failed to log out",B)}},A=B=>{mse(B.id),r(B.link),h(!1)},N=()=>{i&&gse(i.uid,a)};let F=[{view:tr.Jobs,label:"Tm Vic",icon:p.jsx(Ts,{className:"w-6 h-6"}),activeIcon:p.jsx(Cse,{className:"w-6 h-6"})},{view:tr.Insurance,label:"Bo Him",icon:p.jsx(ia,{className:"w-6 h-6"}),activeIcon:p.jsx(Sse,{className:"w-6 h-6"})},{view:tr.Messaging,label:"Tin Nhn",icon:p.jsx(Sx,{className:"w-6 h-6"}),activeIcon:p.jsx(Nse,{className:"w-6 h-6"}),hasUnread:m>0},{view:tr.Chatbot,label:"Hi p",icon:p.jsx(AG,{className:"w-6 h-6"}),activeIcon:p.jsx(kse,{className:"w-6 h-6"})},{view:tr.Profile,label:"H S",icon:p.jsx(Fb,{className:"w-6 h-6"}),activeIcon:p.jsx(Pse,{className:"w-6 h-6"})}];return(s==null?void 0:s.userType)===Jt.Worker&&F.splice(1,0,{view:tr.Recommendations,label:"Gi  AI",icon:p.jsx(gc,{className:"w-6 h-6"}),activeIcon:p.jsx(Rse,{className:"w-6 h-6"})}),p.jsxs(p.Fragment,{children:[p.jsx("header",{className:"hidden md:block sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-200",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex items-center justify-between h-20",children:[p.jsxs("div",{className:"flex items-center space-x-10",children:[p.jsxs("button",{onClick:()=>e(tr.Jobs),className:"flex items-center flex-shrink-0 group",children:[p.jsx(ia,{className:"h-8 w-8 text-indigo-600 group-hover:animate-pulse"}),p.jsx("h1",{className:"ml-3 text-2xl font-bold text-gray-800",children:"An Tm Vic Lm"})]}),p.jsx("nav",{className:"flex items-baseline space-x-2 lg:space-x-4",children:F.map(B=>p.jsx(Mse,{label:B.label,isActive:n===B.view,onClick:()=>e(B.view),hasUnread:B.hasUnread},B.view))})]}),i&&s&&p.jsxs("div",{className:"flex items-center space-x-4",children:[s.userType===Jt.Employer&&p.jsxs("button",{onClick:t,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[p.jsx(Ub,{className:"w-5 h-5 mr-2"}),"ng tin"]}),p.jsx("div",{className:"relative",children:p.jsxs("button",{onClick:()=>h(B=>!B),className:"p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Thng bo",children:[p.jsx(bG,{}),x>0&&p.jsx("span",{className:"absolute top-1 right-1 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]})}),p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsxs("span",{className:"text-sm text-gray-600 text-right hidden lg:block",children:["Cho, ",p.jsx("span",{className:"font-semibold",children:s.fullName||i.email})]}),s.profileImageUrl?p.jsx("img",{src:s.profileImageUrl,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover"}):p.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:p.jsx(Fb,{className:"w-6 h-6 text-gray-500"})})]}),p.jsx("button",{onClick:b,className:"text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors",children:"ng xut"})]})]})})}),p.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.05)]",children:p.jsx("div",{className:"max-w-7xl mx-auto px-2",children:p.jsx("nav",{className:`grid grid-cols-${F.length} gap-1 h-full items-center p-1.5`,children:F.map(B=>p.jsx(Dse,{icon:B.icon,activeIcon:B.activeIcon,label:B.label,isActive:n===B.view,onClick:()=>e(B.view),hasUnread:B.hasUnread},B.view))})})}),i&&(s==null?void 0:s.userType)===Jt.Employer&&p.jsx("div",{className:"md:hidden fixed bottom-20 right-4 z-50",children:p.jsx("button",{onClick:t,className:"bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"ng tin tuyn dng mi",children:p.jsx(Ub,{className:"w-8 h-8"})})}),d&&p.jsx(SG,{notifications:a,onNotificationClick:A,onMarkAllAsRead:N,onClose:()=>h(!1)})]})},Ose=n=>{if(typeof n=="string")return n;try{return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n)}catch{return`${n} VN`}},a8=(n,e)=>{if(n==="Tha thun")return"Tha thun";const t=Ose(n);switch(e){case"THEO GI":return`${t}/gi`;case"THEO NGY":return`${t}/ngy`;case"THEO THNG":return`${t}/thng`;default:return t}},YE=n=>{if(!n||typeof n!="string")return null;try{const e=n.match(/\[\s*(-?\d+\.?\d*)\s*\s*N,\s*(-?\d+\.?\d*)\s*\s*E\s*\]/);if(e&&e.length===3){const t=parseFloat(e[1]),r=parseFloat(e[2]);if(!isNaN(t)&&!isNaN(r))return{lat:t,lng:r}}return null}catch(e){return console.error("Error parsing location string:",n,e),null}},l8=(n,e,t,r)=>{const s=(t-n)*(Math.PI/180),o=(r-e)*(Math.PI/180),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n*(Math.PI/180))*Math.cos(t*(Math.PI/180))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))},Dk=(n,e="post")=>{const t=new Date,r=new Date(n),i=Math.floor((t.getTime()-r.getTime())/1e3);if(i<5)return e==="presence"?"vi giy trc":"va xong";if(i<60)return`${i} giy trc`;const s=Math.floor(i/60);if(s<60)return`${s} pht trc`;const o=Math.floor(s/60);if(o<24)return`${o} gi trc`;const a=Math.floor(o/24);return a===1?"hm qua":a<7?`${a} ngy trc`:new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)},JC=({className:n="w-5 h-5"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Hc=({className:n="w-8 h-8"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-3.96 0-7.25 3.29-7.25 7.353 0 4.434 5.333 11.235 6.75 12.83a.75.75 0 001.002 0c1.417-1.595 6.75-8.396 6.75-12.83C19.25 5.543 15.96 2.25 12 2.25zM12 12a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z",clipRule:"evenodd"})}),FT=({className:n="w-5 h-5"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Vse=({className:n="w-5 h-5"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})}),Fse=({job:n,onClick:e,applicantCount:t})=>{const r=n.status==="CLOSED",i=s=>{s.stopPropagation();const o="nguyenduyphuc0119@gmail.com",a=encodeURIComponent(`Bo co tin tuyn dng: ${n.title}`),c=encodeURIComponent(`Knh gi Ban qun tr An Tm Vic Lm,

Ti mun bo co tin tuyn dng sau v ni dung khng chnh xc hoc khng ph hp:

- ID Cng vic: ${n.id}
- Tiu : ${n.title}
- Nh tuyn dng: ${n.employerName}

L do bo co:
(Vui lng nhp l do ca bn ti y)

Trn trng.`);window.location.href=`mailto:${o}?subject=${a}&body=${c}`};return p.jsxs("div",{onClick:e,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&e()},className:`bg-white p-5 rounded-xl border border-gray-200 flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-5 transition-all duration-300 ${r?"opacity-60":"hover:shadow-lg hover:border-indigo-300 cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transform hover:-translate-y-1"}`,role:"button",tabIndex:0,"aria-label":`Xem chi tit cng vic ${n.title} ti ${n.employerName}`,children:[n.employerProfileUrl?p.jsx("img",{src:n.employerProfileUrl,alt:`${n.employerName} logo`,className:"w-20 h-20 rounded-lg object-cover flex-shrink-0"}):p.jsx("div",{className:"w-20 h-20 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0",children:p.jsx(Ts,{className:"w-10 h-10 text-gray-400"})}),p.jsxs("div",{className:"flex-grow flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{className:"flex-grow",children:[p.jsx("h3",{className:"font-bold text-lg text-gray-800",children:n.title}),p.jsx("p",{className:"text-sm text-gray-600",children:n.employerName})]}),p.jsxs("div",{className:"flex items-center text-xs text-gray-500 flex-shrink-0 ml-4 pt-1",title:`ng vo ${new Date(n.createdAt).toLocaleString("vi-VN")}`,children:[p.jsx(FT,{className:"w-4 h-4 mr-1"}),p.jsx("span",{children:Dk(n.createdAt)})]})]}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.addressString}),p.jsxs("div",{className:"mt-3 flex items-center justify-between pt-3 border-t border-gray-100 sm:mt-auto flex-wrap gap-y-2",children:[p.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[p.jsx("span",{className:"text-sm font-semibold text-green-700 bg-green-100 px-3 py-1 rounded-full",children:a8(n.payRate,n.payType)}),n.distance!==void 0&&p.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`Khong cch c tnh ${n.distance.toFixed(1)} km`,children:[p.jsx(Hc,{className:"w-4 h-4 mr-1 text-gray-500"}),p.jsxs("span",{children:[n.distance.toFixed(1)," km"]})]}),t>0&&p.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`${t} ngi  ng tuyn`,children:[p.jsx(JC,{className:"w-4 h-4 mr-1 text-gray-500"}),p.jsx("span",{children:t})]}),n.jobType&&p.jsx("span",{className:"text-xs text-indigo-700 font-medium bg-indigo-100 px-3 py-1 rounded-full",children:n.jobType}),r?p.jsx("span",{className:"text-xs font-medium text-gray-700 bg-gray-200 px-3 py-1 rounded-full",children:" ng"}):p.jsx("span",{className:"text-xs font-medium text-green-700 bg-green-100 px-3 py-1 rounded-full",children:"ang tuyn"})]}),p.jsxs("button",{onClick:i,className:"flex items-center text-xs font-medium text-gray-400 hover:text-red-500 transition-colors p-1 rounded",title:"Bo co tin tuyn dng ny","aria-label":"Bo co tin tuyn dng",children:[p.jsx(Vse,{className:"w-4 h-4 mr-1"}),"Bo xu"]})]})]})]})},Ff={points:250,pointsGoal:1e3,pointsRewardVND:5e5,autoDeductEnabled:!0,autoDeductAccumulatedThisMonth:15e4,pensionBookTotal:45e5,latestTxHash:"0x71C...9A23",csrScore:850,welfareFundBalance:25e5,workersSupportedThisMonth:12},Use=`
BN L TR L AI CA NN TNG "AN TM VIC LM".

MC TIU CA NN TNG:
"An Tm Vic Lm" l mt h sinh thi an sinh s s dng Blockchain  minh bch ha thu nhp v bo him cho lao ng t do ti Vit Nam.
1.  **Vic lm:** Gip ngi lao ng tm vic thi v an ton.
2.  **An sinh (Blockchain):** T ng trch lp qu hu tr (BHXH) vo Smart Contract mi khi nhn lng, m bo tin khng b tht thot.

I TNG:
- **Ngi Lao ng (NL):** Cn vic lm, mun tch ly nhng ngi th tc. H c "S Hu Tr Blockchain".
- **Nh Tuyn Dng (NTD):** Cn ngi lm, mun xy dng hnh nh "Doanh nghip v cng ng" (CSR). H c "Qu Thng An Sinh".

CHC NNG CHNH:
-   **Tm vic & Tuyn dng:** Kt ni nhu cu.
-   **Smart Contract Escrow:** Hp ng thng minh gi tin lng, t ng chia 90% lng v v NL v trch 5-10% vo v BHXH khi hon thnh cng vic.
-   **Hi p (Chatbot):** Gii p thc mc v BHXH, cch s dng v, v quy trnh nhn lng.

HY S DNG BI CNH DI Y  TR LI CU HI CA NGI DNG MT CCH CHNH XC NHT.
`.trim(),Sm=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),$v=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-4.5 0V6.75a.75.75 0 01.75-.75h3.75a.75.75 0 01.75.75v3.75M13.5 6l5.25 5.25"})}),c8=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"})}),Bse="6.16.0";function Hse(n,e,t){const r=e.split("|").map(s=>s.trim());for(let s=0;s<r.length;s++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${t}`,i.value=n,i}async function Qr(n){const e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,i,s)=>(r[e[s]]=i,r),{})}function Qe(n,e,t){for(let r in e){let i=e[r];const s=t?t[r]:null;s&&Hse(i,s,r),Object.defineProperty(n,r,{enumerable:!0,value:i,writable:!1})}}function jf(n,e){if(n==null)return"null";if(e==null&&(e=new Set),typeof n=="object"){if(e.has(n))return"[Circular]";e.add(n)}if(Array.isArray(n))return"[ "+n.map(t=>jf(t,e)).join(", ")+" ]";if(n instanceof Uint8Array){const t="0123456789abcdef";let r="0x";for(let i=0;i<n.length;i++)r+=t[n[i]>>4],r+=t[n[i]&15];return r}if(typeof n=="object"&&typeof n.toJSON=="function")return jf(n.toJSON(),e);switch(typeof n){case"boolean":case"number":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"string":return JSON.stringify(n);case"object":{const t=Object.keys(n);return t.sort(),"{ "+t.map(r=>`${jf(r,e)}: ${jf(n[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function vr(n,e){return n&&n.code===e}function Mk(n){return vr(n,"CALL_EXCEPTION")}function un(n,e,t){let r=n;{const s=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${jf(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];s.push(o+"="+jf(a))}}s.push(`code=${e}`),s.push(`version=${Bse}`),s.length&&(n+=" ("+s.join(", ")+")")}let i;switch(e){case"INVALID_ARGUMENT":i=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(n);break;default:i=new Error(n)}return Qe(i,{code:e}),t&&Object.assign(i,t),i.shortMessage==null&&Qe(i,{shortMessage:r}),i}function he(n,e,t,r){if(!n)throw un(e,t,r)}function Q(n,e,t,r){he(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function u8(n,e,t){t==null&&(t=""),t&&(t=": "+t),he(n>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),he(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");n.push(e)}catch{}return n},[]);function qw(n,e,t){if(t==null&&(t=""),n!==e){let r=t,i="new";t&&(r+=".",i+=" "+t),he(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:i})}}function d8(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.length%2===0&&n.match(/^0x[0-9a-f]*$/i)){const r=new Uint8Array((n.length-2)/2);let i=2;for(let s=0;s<r.length;s++)r[s]=parseInt(n.substring(i,i+2),16),i+=2;return r}Q(!1,"invalid BytesLike value",e||"value",n)}function ht(n,e){return d8(n,e,!1)}function Yr(n,e){return d8(n,e,!0)}function Xt(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function Lk(n){return Xt(n,!0)||n instanceof Uint8Array}const WL="0123456789abcdef";function Me(n){const e=ht(n);let t="0x";for(let r=0;r<e.length;r++){const i=e[r];t+=WL[(i&240)>>4]+WL[i&15]}return t}function mn(n){return"0x"+n.map(e=>Me(e).substring(2)).join("")}function sp(n){return Xt(n,!0)?(n.length-2)/2:ht(n).length}function An(n,e,t){const r=ht(n);return t!=null&&t>r.length&&he(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),Me(r.slice(e??0,t??r.length))}function h8(n,e,t){const r=ht(n);he(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),t?i.set(r,e-r.length):i.set(r,0),Me(i)}function yl(n,e){return h8(n,e,!0)}function Gse(n,e){return h8(n,e,!1)}const zw=BigInt(0),Ys=BigInt(1),qf=9007199254740991;function XE(n,e){const t=UT(n,"value"),r=BigInt(ut(e,"width"));if(he(t>>r===zw,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-Ys){const i=(Ys<<r)-Ys;return-((~t&i)+Ys)}return t}function f8(n,e){let t=He(n,"value");const r=BigInt(ut(e,"width")),i=Ys<<r-Ys;if(t<zw){t=-t,he(t<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});const s=(Ys<<r)-Ys;return(~t&s)+Ys}else he(t<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function Ad(n,e){const t=UT(n,"value"),r=BigInt(ut(e,"bits"));return t&(Ys<<r)-Ys}function He(n,e){switch(typeof n){case"bigint":return n;case"number":return Q(Number.isInteger(n),"underflow",e||"value",n),Q(n>=-qf&&n<=qf,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){Q(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}Q(!1,"invalid BigNumberish value",e||"value",n)}function UT(n,e){const t=He(n,e);return he(t>=zw,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}const KL="0123456789abcdef";function BT(n){if(n instanceof Uint8Array){let e="0x0";for(const t of n)e+=KL[t>>4],e+=KL[t&15];return BigInt(e)}return He(n)}function ut(n,e){switch(typeof n){case"bigint":return Q(n>=-qf&&n<=qf,"overflow",e||"value",n),Number(n);case"number":return Q(Number.isInteger(n),"underflow",e||"value",n),Q(n>=-qf&&n<=qf,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return ut(BigInt(n),e)}catch(t){Q(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}Q(!1,"invalid numeric value",e||"value",n)}function jse(n){return ut(BT(n))}function hu(n,e){const t=UT(n,"value");let r=t.toString(16);if(e==null)r.length%2&&(r="0"+r);else{const i=ut(e,"width");if(i===0&&t===zw)return"0x";for(he(i*2>=r.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<i*2;)r="0"+r}return"0x"+r}function jn(n,e){const t=UT(n,"value");if(t===zw)return new Uint8Array(0);let r=t.toString(16);r.length%2&&(r="0"+r);const i=new Uint8Array(r.length/2);for(let s=0;s<i.length;s++){const o=s*2;i[s]=parseInt(r.substring(o,o+2),16)}return i}function Js(n){let e=Me(Lk(n)?n:jn(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const QL="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const JL=BigInt(58);function qse(n){const e=ht(n);let t=BT(e),r="";for(;t;)r=QL[Number(t%JL)]+r,t/=JL;for(let i=0;i<e.length&&!e[i];i++)r=QL[0]+r;return r}function zse(n){n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return ht(e)}function $se(n){const e=ht(n);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var fp;class p8{constructor(e,t,r){X(this,"filter");X(this,"emitter");se(this,fp);H(this,fp,t),Qe(this,{emitter:e,filter:r})}async removeListener(){S(this,fp)!=null&&await this.emitter.off(this.filter,S(this,fp))}}fp=new WeakMap;function Wse(n,e,t,r,i){Q(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function m8(n,e,t,r,i){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let s=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)s++;return s}return n==="OVERRUN"?t.length-e-1:0}function Kse(n,e,t,r,i){return n==="OVERLONG"?(Q(typeof i=="number","invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),m8(n,e,t))}const Qse=Object.freeze({error:Wse,ignore:m8,replace:Kse});function Jse(n,e){e==null&&(e=Qse.error);const t=ht(n,"bytes"),r=[];let i=0;for(;i<t.length;){const s=t[i++];if(s>>7===0){r.push(s);continue}let o=null,a=null;if((s&224)===192)o=1,a=127;else if((s&240)===224)o=2,a=2047;else if((s&248)===240)o=3,a=65535;else{(s&192)===128?i+=e("UNEXPECTED_CONTINUE",i-1,t,r):i+=e("BAD_PREFIX",i-1,t,r);continue}if(i-1+o>=t.length){i+=e("OVERRUN",i-1,t,r);continue}let c=s&(1<<8-o-1)-1;for(let d=0;d<o;d++){let h=t[i];if((h&192)!=128){i+=e("MISSING_CONTINUE",i,t,r),c=null;break}c=c<<6|h&63,i++}if(c!==null){if(c>1114111){i+=e("OUT_OF_RANGE",i-1-o,t,r,c);continue}if(c>=55296&&c<=57343){i+=e("UTF16_SURROGATE",i-1-o,t,r,c);continue}if(c<=a){i+=e("OVERLONG",i-1-o,t,r,c);continue}r.push(c)}}return r}function ll(n,e){Q(typeof n=="string","invalid string value","str",n);let t=[];for(let r=0;r<n.length;r++){const i=n.charCodeAt(r);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){r++;const s=n.charCodeAt(r);Q(r<n.length&&(s&64512)===56320,"invalid surrogate pair","str",n);const o=65536+((i&1023)<<10)+(s&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return new Uint8Array(t)}function Yse(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function ZE(n,e){return Yse(Jse(n,e))}function g8(n){async function e(t,r){he(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const i=t.url.split(":")[0].toLowerCase();he(i==="http"||i==="https",`unsupported protocol ${i}`,"UNSUPPORTED_OPERATION",{info:{protocol:i},operation:"request"}),he(i==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let s=null;const o=new AbortController,a=setTimeout(()=>{s=un("request timeout","TIMEOUT"),o.abort()},t.timeout);r&&r.addListener(()=>{s=un("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},n,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let d;try{d=await fetch(t.url,c)}catch(x){throw clearTimeout(a),s||x}clearTimeout(a);const h={};d.headers.forEach((x,b)=>{h[b.toLowerCase()]=x});const m=await d.arrayBuffer(),_=m==null?null:new Uint8Array(m);return{statusCode:d.status,statusMessage:d.statusText,headers:h,body:_}}return e}const Xse=12,Zse=250;let YL=g8();const eoe=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),toe=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let mb=!1;async function y8(n,e){try{const t=n.match(eoe);if(!t)throw new Error("invalid data");return new Jc(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?zse(t[3]):roe(t[3]))}catch{return new Jc(599,"BAD REQUEST (invalid data: URI)",{},null,new fu(n))}}function w8(n){async function e(t,r){try{const i=t.match(toe);if(!i)throw new Error("invalid link");return new fu(`${n}${i[2]}`)}catch{return new Jc(599,"BAD REQUEST (invalid IPFS URI)",{},null,new fu(t))}}return e}const wv={data:y8,ipfs:w8("https://gateway.ipfs.io/ipfs/")},_8=new WeakMap;var Nd,wc;class noe{constructor(e){se(this,Nd);se(this,wc);H(this,Nd,[]),H(this,wc,!1),_8.set(e,()=>{if(!S(this,wc)){H(this,wc,!0);for(const t of S(this,Nd))setTimeout(()=>{t()},0);H(this,Nd,[])}})}addListener(e){he(!S(this,wc),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),S(this,Nd).push(e)}get cancelled(){return S(this,wc)}checkSignal(){he(!this.cancelled,"cancelled","CANCELLED",{})}}Nd=new WeakMap,wc=new WeakMap;function _v(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var pp,mp,js,ja,gp,yp,er,Bi,qa,kd,Pd,Rd,Mo,qs,_c,Dd,Sy;const Ex=class Ex{constructor(e){se(this,Dd);se(this,pp);se(this,mp);se(this,js);se(this,ja);se(this,gp);se(this,yp);se(this,er);se(this,Bi);se(this,qa);se(this,kd);se(this,Pd);se(this,Rd);se(this,Mo);se(this,qs);se(this,_c);H(this,yp,String(e)),H(this,pp,!1),H(this,mp,!0),H(this,js,{}),H(this,ja,""),H(this,gp,3e5),H(this,qs,{slotInterval:Zse,maxAttempts:Xse}),H(this,_c,null)}get url(){return S(this,yp)}set url(e){H(this,yp,String(e))}get body(){return S(this,er)==null?null:new Uint8Array(S(this,er))}set body(e){if(e==null)H(this,er,void 0),H(this,Bi,void 0);else if(typeof e=="string")H(this,er,ll(e)),H(this,Bi,"text/plain");else if(e instanceof Uint8Array)H(this,er,e),H(this,Bi,"application/octet-stream");else if(typeof e=="object")H(this,er,ll(JSON.stringify(e))),H(this,Bi,"application/json");else throw new Error("invalid body")}hasBody(){return S(this,er)!=null}get method(){return S(this,ja)?S(this,ja):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),H(this,ja,String(e).toUpperCase())}get headers(){const e=Object.assign({},S(this,js));return S(this,qa)&&(e.authorization=`Basic ${$se(ll(S(this,qa)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&S(this,Bi)&&(e["content-type"]=S(this,Bi)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){S(this,js)[String(e).toLowerCase()]=String(t)}clearHeaders(){H(this,js,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return S(this,qa)||null}setCredentials(e,t){Q(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),H(this,qa,`${e}:${t}`)}get allowGzip(){return S(this,mp)}set allowGzip(e){H(this,mp,!!e)}get allowInsecureAuthentication(){return!!S(this,pp)}set allowInsecureAuthentication(e){H(this,pp,!!e)}get timeout(){return S(this,gp)}set timeout(e){Q(e>=0,"timeout must be non-zero","timeout",e),H(this,gp,e)}get preflightFunc(){return S(this,kd)||null}set preflightFunc(e){H(this,kd,e)}get processFunc(){return S(this,Pd)||null}set processFunc(e){H(this,Pd,e)}get retryFunc(){return S(this,Rd)||null}set retryFunc(e){H(this,Rd,e)}get getUrlFunc(){return S(this,_c)||YL}set getUrlFunc(e){H(this,_c,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${S(this,er)?Me(S(this,er)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(S(this,qs).slotInterval=e.slotInterval),e.maxAttempts!=null&&(S(this,qs).maxAttempts=e.maxAttempts)}send(){return he(S(this,Mo)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),H(this,Mo,new noe(this)),we(this,Dd,Sy).call(this,0,XL()+this.timeout,0,this,new Jc(0,"",{},null,this))}cancel(){he(S(this,Mo)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=_8.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();he(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const i=new Ex(e);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,H(i,js,Object.assign({},S(this,js))),S(this,er)&&H(i,er,new Uint8Array(S(this,er))),H(i,Bi,S(this,Bi)),i}clone(){const e=new Ex(this.url);return H(e,ja,S(this,ja)),S(this,er)&&H(e,er,S(this,er)),H(e,Bi,S(this,Bi)),H(e,js,Object.assign({},S(this,js))),H(e,qa,S(this,qa)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),H(e,kd,S(this,kd)),H(e,Pd,S(this,Pd)),H(e,Rd,S(this,Rd)),H(e,qs,Object.assign({},S(this,qs))),H(e,_c,S(this,_c)),e}static lockConfig(){mb=!0}static getGateway(e){return wv[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(mb)throw new Error("gateways locked");wv[e]=t}static registerGetUrl(e){if(mb)throw new Error("gateways locked");YL=e}static createGetUrlFunc(e){return g8(e)}static createDataGateway(){return y8}static createIpfsGatewayFunc(e){return w8(e)}};pp=new WeakMap,mp=new WeakMap,js=new WeakMap,ja=new WeakMap,gp=new WeakMap,yp=new WeakMap,er=new WeakMap,Bi=new WeakMap,qa=new WeakMap,kd=new WeakMap,Pd=new WeakMap,Rd=new WeakMap,Mo=new WeakMap,qs=new WeakMap,_c=new WeakMap,Dd=new WeakSet,Sy=async function(e,t,r,i,s){var h,m,_;if(e>=S(this,qs).maxAttempts)return s.makeServerError("exceeded maximum retry limit");he(XL()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),r>0&&await ioe(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in wv){const x=await wv[a](o.url,_v(S(i,Mo)));if(x instanceof Jc){let b=x;if(this.processFunc){_v(S(i,Mo));try{b=await this.processFunc(o,b)}catch(A){(A.throttle==null||typeof A.stall!="number")&&b.makeServerError("error in post-processing function",A).assertOk()}}return b}o=x}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,_v(S(i,Mo)));let d=new Jc(c.statusCode,c.statusMessage,c.headers,c.body,i);if(d.statusCode===301||d.statusCode===302){try{const x=d.headers.location||"";return we(h=o.redirect(x),Dd,Sy).call(h,e+1,t,0,i,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,d,e))){const x=d.headers["retry-after"];let b=S(this,qs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof x=="string"&&x.match(/^[1-9][0-9]*$/)&&(b=parseInt(x)),we(m=o.clone(),Dd,Sy).call(m,e+1,t,b,i,d)}if(this.processFunc){_v(S(i,Mo));try{d=await this.processFunc(o,d)}catch(x){(x.throttle==null||typeof x.stall!="number")&&d.makeServerError("error in post-processing function",x).assertOk();let b=S(this,qs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return x.stall>=0&&(b=x.stall),we(_=o.clone(),Dd,Sy).call(_,e+1,t,b,i,d)}}return d};let fu=Ex;var ew,tw,nw,Hi,wp,Md;const gP=class gP{constructor(e,t,r,i,s){se(this,ew);se(this,tw);se(this,nw);se(this,Hi);se(this,wp);se(this,Md);H(this,ew,e),H(this,tw,t),H(this,nw,Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{})),H(this,Hi,i==null?null:new Uint8Array(i)),H(this,wp,s||null),H(this,Md,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${S(this,Hi)?Me(S(this,Hi)):"null"}>`}get statusCode(){return S(this,ew)}get statusMessage(){return S(this,tw)}get headers(){return Object.assign({},S(this,nw))}get body(){return S(this,Hi)==null?null:new Uint8Array(S(this,Hi))}get bodyText(){try{return S(this,Hi)==null?"":ZE(S(this,Hi))}catch{he(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{he(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const i=new gP(599,r,this.headers,this.body,S(this,wp)||void 0);return H(i,Md,{message:e,error:t}),i}throwThrottleError(e,t){t==null?t=-1:Q(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const r=new Error(e||"throttling requests");throw Qe(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return S(this,Hi)!=null}get request(){return S(this,wp)}ok(){return S(this,Md).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=S(this,Md);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let i=null;try{S(this,Hi)&&(i=ZE(S(this,Hi)))}catch{}he(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};ew=new WeakMap,tw=new WeakMap,nw=new WeakMap,Hi=new WeakMap,wp=new WeakMap,Md=new WeakMap;let Jc=gP;function XL(){return new Date().getTime()}function roe(n){return ll(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function ioe(n){return new Promise(e=>setTimeout(e,n))}const soe=BigInt(-1),Hs=BigInt(0),zf=BigInt(1),ooe=BigInt(5),Pf={};let op="0000";for(;op.length<80;)op+=op;function Zu(n){let e=op;for(;e.length<n;)e+=e;return BigInt("1"+e.substring(0,n))}function hy(n,e,t){const r=BigInt(e.width);if(e.signed){const i=zf<<r-zf;he(t==null||n>=-i&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n>Hs?n=XE(Ad(n,r),r):n=-XE(Ad(-n,r),r)}else{const i=zf<<r;he(t==null||n>=0&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n=(n%i+i)%i&i-zf}return n}function gb(n){typeof n=="number"&&(n=`fixed128x${n}`);let e=!0,t=128,r=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")e=!1;else{const s=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);Q(s,"invalid fixed format","format",n),e=s[1]!=="u",t=parseInt(s[2]),r=parseInt(s[3])}}else if(n){const s=n,o=(a,c,d)=>s[a]==null?d:(Q(typeof s[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,s[a]),s[a]);e=o("signed","boolean",e),t=o("width","number",t),r=o("decimals","number",r)}Q(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),Q(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const i=(e?"":"u")+"fixed"+String(t)+"x"+String(r);return{signed:e,width:t,decimals:r,name:i}}function aoe(n,e){let t="";n<Hs&&(t="-",n*=soe);let r=n.toString();if(e===0)return t+r;for(;r.length<=e;)r=op+r;const i=r.length-e;for(r=r.substring(0,i)+"."+r.substring(i);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return t+r}var zs,Gt,$r,Mt,od,Va,YC,XC,ZC,eS;const mc=class mc{constructor(e,t,r){se(this,Mt);X(this,"format");se(this,zs);se(this,Gt);se(this,$r);X(this,"_value");qw(e,Pf,"FixedNumber"),H(this,Gt,t),H(this,zs,r);const i=aoe(t,r.decimals);Qe(this,{format:r.name,_value:i}),H(this,$r,Zu(r.decimals))}get signed(){return S(this,zs).signed}get width(){return S(this,zs).width}get decimals(){return S(this,zs).decimals}get value(){return S(this,Gt)}addUnsafe(e){return we(this,Mt,YC).call(this,e)}add(e){return we(this,Mt,YC).call(this,e,"add")}subUnsafe(e){return we(this,Mt,XC).call(this,e)}sub(e){return we(this,Mt,XC).call(this,e,"sub")}mulUnsafe(e){return we(this,Mt,ZC).call(this,e)}mul(e){return we(this,Mt,ZC).call(this,e,"mul")}mulSignal(e){we(this,Mt,od).call(this,e);const t=S(this,Gt)*S(e,Gt);return he(t%S(this,$r)===Hs,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),we(this,Mt,Va).call(this,t/S(this,$r),"mulSignal")}divUnsafe(e){return we(this,Mt,eS).call(this,e)}div(e){return we(this,Mt,eS).call(this,e,"div")}divSignal(e){he(S(e,Gt)!==Hs,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),we(this,Mt,od).call(this,e);const t=S(this,Gt)*S(this,$r);return he(t%S(e,Gt)===Hs,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),we(this,Mt,Va).call(this,t/S(e,Gt),"divSignal")}cmp(e){let t=this.value,r=e.value;const i=this.decimals-e.decimals;return i>0?r*=Zu(i):i<0&&(t*=Zu(-i)),t<r?-1:t>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=S(this,Gt);return S(this,Gt)<Hs&&(e-=S(this,$r)-zf),e=S(this,Gt)/S(this,$r)*S(this,$r),we(this,Mt,Va).call(this,e,"floor")}ceiling(){let e=S(this,Gt);return S(this,Gt)>Hs&&(e+=S(this,$r)-zf),e=S(this,Gt)/S(this,$r)*S(this,$r),we(this,Mt,Va).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,r=ooe*Zu(t-1);let i=this.value+r;const s=Zu(t);return i=i/s*s,hy(i,S(this,zs),"round"),new mc(Pf,i,S(this,zs))}isZero(){return S(this,Gt)===Hs}isNegative(){return S(this,Gt)<Hs}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return mc.fromString(this.toString(),e)}static fromValue(e,t,r){const i=t==null?0:ut(t),s=gb(r);let o=He(e,"value");const a=i-s.decimals;if(a>0){const c=Zu(a);he(o%c===Hs,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Zu(-a));return hy(o,s,"fromValue"),new mc(Pf,o,s)}static fromString(e,t){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);Q(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const i=gb(t);let s=r[2]||"0",o=r[3]||"";for(;o.length<i.decimals;)o+=op;he(o.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,i.decimals);const a=BigInt(r[1]+s+o);return hy(a,i,"fromString"),new mc(Pf,a,i)}static fromBytes(e,t){let r=BT(ht(e,"value"));const i=gb(t);return i.signed&&(r=XE(r,i.width)),hy(r,i,"fromBytes"),new mc(Pf,r,i)}};zs=new WeakMap,Gt=new WeakMap,$r=new WeakMap,Mt=new WeakSet,od=function(e){Q(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Va=function(e,t){return e=hy(e,S(this,zs),t),new mc(Pf,e,S(this,zs))},YC=function(e,t){return we(this,Mt,od).call(this,e),we(this,Mt,Va).call(this,S(this,Gt)+S(e,Gt),t)},XC=function(e,t){return we(this,Mt,od).call(this,e),we(this,Mt,Va).call(this,S(this,Gt)-S(e,Gt),t)},ZC=function(e,t){return we(this,Mt,od).call(this,e),we(this,Mt,Va).call(this,S(this,Gt)*S(e,Gt)/S(this,$r),t)},eS=function(e,t){return he(S(e,Gt)!==Hs,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),we(this,Mt,od).call(this,e),we(this,Mt,Va).call(this,S(this,Gt)*S(this,$r)/S(e,Gt),t)};let ex=mc;function loe(n){let e=n.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function ZL(n,e,t){let r=0;for(let i=0;i<t;i++)r=r*256+n[e+i];return r}function eO(n,e,t,r){const i=[];for(;t<e+1+r;){const s=v8(n,t);i.push(s.result),t+=s.consumed,he(t<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:n,length:r,offset:e})}return{consumed:1+r,result:i}}function v8(n,e){he(n.length!==0,"data too short","BUFFER_OVERRUN",{buffer:n,length:0,offset:1});const t=r=>{he(r<=n.length,"data short segment too short","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r})};if(n[e]>=248){const r=n[e]-247;t(e+1+r);const i=ZL(n,e+1,r);return t(e+1+r+i),eO(n,e,e+1+r,r+i)}else if(n[e]>=192){const r=n[e]-192;return t(e+1+r),eO(n,e,e+1,r)}else if(n[e]>=184){const r=n[e]-183;t(e+1+r);const i=ZL(n,e+1,r);t(e+1+r+i);const s=Me(n.slice(e+1+r,e+1+r+i));return{consumed:1+r+i,result:s}}else if(n[e]>=128){const r=n[e]-128;t(e+1+r);const i=Me(n.slice(e+1,e+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:loe(n[e])}}function $w(n){const e=ht(n,"data"),t=v8(e,0);return Q(t.consumed===e.length,"unexpected junk after rlp payload","data",n),t.result}function tO(n){const e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function E8(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(s){r=r.concat(E8(s))}),r.length<=55)return r.unshift(192+r.length),r;const i=tO(r.length);return i.unshift(247+i.length),i.concat(r)}const e=Array.prototype.slice.call(ht(n,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=tO(e.length);return t.unshift(183+t.length),t.concat(e)}const nO="0123456789abcdef";function cl(n){let e="0x";for(const t of E8(n))e+=nO[t>>4],e+=nO[t&15];return e}function coe(n,e){let t=18;return t=ut(e,"unit"),ex.fromValue(n,t,{decimals:t,width:512}).toString()}function uoe(n,e){Q(typeof n=="string","value must be a string","value",n);let t=18;return t=ut(e,"unit"),ex.fromString(n,{decimals:t,width:512}).value}function x8(n){return coe(n,18)}function doe(n){return uoe(n,18)}const Zr=32,tS=new Uint8Array(Zr),hoe=["then"],vv={},T8=new WeakMap;function fd(n){return T8.get(n)}function rO(n,e){T8.set(n,e)}function fy(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}function nS(n,e,t){return n.indexOf(null)>=0?e.map((r,i)=>r instanceof Nm?nS(fd(r),r,t):r):n.reduce((r,i,s)=>{let o=e.getValue(i);return i in r||(t&&o instanceof Nm&&(o=nS(fd(o),o,t)),r[i]=o),r},{})}var _p;const Wf=class Wf extends Array{constructor(...t){const r=t[0];let i=t[1],s=(t[2]||[]).slice(),o=!0;r!==vv&&(i=t,s=[],o=!1);super(i.length);se(this,_p);i.forEach((d,h)=>{this[h]=d});const a=s.reduce((d,h)=>(typeof h=="string"&&d.set(h,(d.get(h)||0)+1),d),new Map);if(rO(this,Object.freeze(i.map((d,h)=>{const m=s[h];return m!=null&&a.get(m)===1?m:null}))),H(this,_p,[]),S(this,_p)==null&&S(this,_p),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(d,h,m)=>{if(typeof h=="string"){if(h.match(/^[0-9]+$/)){const x=ut(h,"%index");if(x<0||x>=this.length)throw new RangeError("out of result range");const b=d[x];return b instanceof Error&&fy(`index ${x}`,b),b}if(hoe.indexOf(h)>=0)return Reflect.get(d,h,m);const _=d[h];if(_ instanceof Function)return function(...x){return _.apply(this===m?d:this,x)};if(!(h in d))return d.getValue.apply(this===m?d:this,[h])}return Reflect.get(d,h,m)}});return rO(c,fd(this)),c}toArray(t){const r=[];return this.forEach((i,s)=>{i instanceof Error&&fy(`index ${s}`,i),t&&i instanceof Wf&&(i=i.toArray(t)),r.push(i)}),r}toObject(t){const r=fd(this);return r.reduce((i,s,o)=>(he(s!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),nS(r,this,t)),{})}slice(t,r){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const i=fd(this),s=[],o=[];for(let a=t;a<r;a++)s.push(this[a]),o.push(i[a]);return new Wf(vv,s,o)}filter(t,r){const i=fd(this),s=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&fy(`index ${a}`,c),t.call(r,c,a,this)&&(s.push(c),o.push(i[a]))}return new Wf(vv,s,o)}map(t,r){const i=[];for(let s=0;s<this.length;s++){const o=this[s];o instanceof Error&&fy(`index ${s}`,o),i.push(t.call(r,o,s,this))}return i}getValue(t){const r=fd(this).indexOf(t);if(r===-1)return;const i=this[r];return i instanceof Error&&fy(`property ${JSON.stringify(t)}`,i.error),i}static fromItems(t,r){return new Wf(vv,t,r)}};_p=new WeakMap;let Nm=Wf;function iO(n){let e=jn(n);return he(e.length<=Zr,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Zr,offset:e.length}),e.length!==Zr&&(e=Yr(mn([tS.slice(e.length%Zr),e]))),e}class Cl{constructor(e,t,r,i){X(this,"name");X(this,"type");X(this,"localName");X(this,"dynamic");Qe(this,{name:e,type:t,localName:r,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){Q(!1,e,this.localName,t)}}var za,Ld,vp,Wv;class rS{constructor(){se(this,vp);se(this,za);se(this,Ld);H(this,za,[]),H(this,Ld,0)}get data(){return mn(S(this,za))}get length(){return S(this,Ld)}appendWriter(e){return we(this,vp,Wv).call(this,Yr(e.data))}writeBytes(e){let t=Yr(e);const r=t.length%Zr;return r&&(t=Yr(mn([t,tS.slice(r)]))),we(this,vp,Wv).call(this,t)}writeValue(e){return we(this,vp,Wv).call(this,iO(e))}writeUpdatableValue(){const e=S(this,za).length;return S(this,za).push(tS),H(this,Ld,S(this,Ld)+Zr),t=>{S(this,za)[e]=iO(t)}}}za=new WeakMap,Ld=new WeakMap,vp=new WeakSet,Wv=function(e){return S(this,za).push(e),H(this,Ld,S(this,Ld)+e.length),e.length};var fi,Gi,Od,Vd,vc,bh,sS,I8;const yP=class yP{constructor(e,t,r){se(this,bh);X(this,"allowLoose");se(this,fi);se(this,Gi);se(this,Od);se(this,Vd);se(this,vc);Qe(this,{allowLoose:!!t}),H(this,fi,Yr(e)),H(this,Od,0),H(this,Vd,null),H(this,vc,r??1024),H(this,Gi,0)}get data(){return Me(S(this,fi))}get dataLength(){return S(this,fi).length}get consumed(){return S(this,Gi)}get bytes(){return new Uint8Array(S(this,fi))}subReader(e){const t=new yP(S(this,fi).slice(S(this,Gi)+e),this.allowLoose,S(this,vc));return H(t,Vd,this),t}readBytes(e,t){let r=we(this,bh,I8).call(this,0,e,!!t);return we(this,bh,sS).call(this,e),H(this,Gi,S(this,Gi)+r.length),r.slice(0,e)}readValue(){return BT(this.readBytes(Zr))}readIndex(){return jse(this.readBytes(Zr))}};fi=new WeakMap,Gi=new WeakMap,Od=new WeakMap,Vd=new WeakMap,vc=new WeakMap,bh=new WeakSet,sS=function(e){var t;if(S(this,Vd))return we(t=S(this,Vd),bh,sS).call(t,e);H(this,Od,S(this,Od)+e),he(S(this,vc)<1||S(this,Od)<=S(this,vc)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${S(this,vc)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Yr(S(this,fi)),offset:S(this,Gi),length:e,info:{bytesRead:S(this,Od),dataLength:this.dataLength}})},I8=function(e,t,r){let i=Math.ceil(t/Zr)*Zr;return S(this,Gi)+i>S(this,fi).length&&(this.allowLoose&&r&&S(this,Gi)+t<=S(this,fi).length?i=t:he(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Yr(S(this,fi)),length:S(this,fi).length,offset:S(this,Gi)+i})),S(this,fi).slice(S(this,Gi),S(this,Gi)+i)};let iS=yP;function tx(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function Ok(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function foe(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");tx(n.outputLen),tx(n.blockLen)}function km(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function A8(n,e){Ok(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const yb=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const b8=n=>n instanceof Uint8Array,poe=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),wb=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Po=(n,e)=>n<<32-e|n>>>e,moe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!moe)throw new Error("Non little-endian hardware is not supported");function goe(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function HT(n){if(typeof n=="string"&&(n=goe(n)),!b8(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function yoe(...n){const e=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let t=0;return n.forEach(r=>{if(!b8(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class Vk{clone(){return this._cloneInto()}}function Fk(n){const e=r=>n().update(HT(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function woe(n=32){if(yb&&typeof yb.getRandomValues=="function")return yb.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class C8 extends Vk{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,foe(e);const r=HT(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return km(this),this.iHash.update(e),this}digestInto(e){km(this),Ok(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const S8=(n,e,t)=>new C8(n,e).update(t).digest();S8.create=(n,e)=>new C8(n,e);function _oe(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,d=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+d,a,r)}class N8 extends Vk{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=wb(this.buffer)}update(e){km(this);const{view:t,buffer:r,blockLen:i}=this;e=HT(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=wb(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){km(this),A8(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let m=o;m<i;m++)t[m]=0;_oe(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=wb(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=c/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<d;m++)a.setUint32(4*m,h[m],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%t&&e.buffer.set(r),e}}const voe=(n,e,t)=>n&e^~n&t,Eoe=(n,e,t)=>n&e^n&t^e&t,xoe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),uc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),dc=new Uint32Array(64);class Toe extends N8{constructor(){super(64,32,8,!1),this.A=uc[0]|0,this.B=uc[1]|0,this.C=uc[2]|0,this.D=uc[3]|0,this.E=uc[4]|0,this.F=uc[5]|0,this.G=uc[6]|0,this.H=uc[7]|0}get(){const{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,t,r,i,s,o,a,c]}set(e,t,r,i,s,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let m=0;m<16;m++,t+=4)dc[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){const _=dc[m-15],x=dc[m-2],b=Po(_,7)^Po(_,18)^_>>>3,A=Po(x,17)^Po(x,19)^x>>>10;dc[m]=A+dc[m-7]+b+dc[m-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:d,H:h}=this;for(let m=0;m<64;m++){const _=Po(a,6)^Po(a,11)^Po(a,25),x=h+_+voe(a,c,d)+xoe[m]+dc[m]|0,A=(Po(r,2)^Po(r,13)^Po(r,22))+Eoe(r,i,s)|0;h=d,d=c,c=a,a=o+x|0,o=s,s=i,i=r,r=x+A|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(r,i,s,o,a,c,d,h)}roundClean(){dc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const k8=Fk(()=>new Toe),Ev=BigInt(2**32-1),oS=BigInt(32);function P8(n,e=!1){return e?{h:Number(n&Ev),l:Number(n>>oS&Ev)}:{h:Number(n>>oS&Ev)|0,l:Number(n&Ev)|0}}function R8(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:s,l:o}=P8(n[i],e);[t[i],r[i]]=[s,o]}return[t,r]}const Ioe=(n,e)=>BigInt(n>>>0)<<oS|BigInt(e>>>0),Aoe=(n,e,t)=>n>>>t,boe=(n,e,t)=>n<<32-t|e>>>t,Coe=(n,e,t)=>n>>>t|e<<32-t,Soe=(n,e,t)=>n<<32-t|e>>>t,Noe=(n,e,t)=>n<<64-t|e>>>t-32,koe=(n,e,t)=>n>>>t-32|e<<64-t,Poe=(n,e)=>e,Roe=(n,e)=>n,D8=(n,e,t)=>n<<t|e>>>32-t,M8=(n,e,t)=>e<<t|n>>>32-t,L8=(n,e,t)=>e<<t-32|n>>>64-t,O8=(n,e,t)=>n<<t-32|e>>>64-t;function Doe(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}const Moe=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),Loe=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Ooe=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),Voe=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Foe=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),Uoe=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0,dt={fromBig:P8,split:R8,toBig:Ioe,shrSH:Aoe,shrSL:boe,rotrSH:Coe,rotrSL:Soe,rotrBH:Noe,rotrBL:koe,rotr32H:Poe,rotr32L:Roe,rotlSH:D8,rotlSL:M8,rotlBH:L8,rotlBL:O8,add:Doe,add3L:Moe,add3H:Loe,add4L:Ooe,add4H:Voe,add5H:Uoe,add5L:Foe},[Boe,Hoe]=dt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),hc=new Uint32Array(80),fc=new Uint32Array(80);class Goe extends N8{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:d,El:h,Fh:m,Fl:_,Gh:x,Gl:b,Hh:A,Hl:N}=this;return[e,t,r,i,s,o,a,c,d,h,m,_,x,b,A,N]}set(e,t,r,i,s,o,a,c,d,h,m,_,x,b,A,N){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=d|0,this.El=h|0,this.Fh=m|0,this.Fl=_|0,this.Gh=x|0,this.Gl=b|0,this.Hh=A|0,this.Hl=N|0}process(e,t){for(let O=0;O<16;O++,t+=4)hc[O]=e.getUint32(t),fc[O]=e.getUint32(t+=4);for(let O=16;O<80;O++){const q=hc[O-15]|0,W=fc[O-15]|0,$=dt.rotrSH(q,W,1)^dt.rotrSH(q,W,8)^dt.shrSH(q,W,7),D=dt.rotrSL(q,W,1)^dt.rotrSL(q,W,8)^dt.shrSL(q,W,7),k=hc[O-2]|0,R=fc[O-2]|0,U=dt.rotrSH(k,R,19)^dt.rotrBH(k,R,61)^dt.shrSH(k,R,6),M=dt.rotrSL(k,R,19)^dt.rotrBL(k,R,61)^dt.shrSL(k,R,6),j=dt.add4L(D,M,fc[O-7],fc[O-16]),V=dt.add4H(j,$,U,hc[O-7],hc[O-16]);hc[O]=V|0,fc[O]=j|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:d,Dl:h,Eh:m,El:_,Fh:x,Fl:b,Gh:A,Gl:N,Hh:F,Hl:B}=this;for(let O=0;O<80;O++){const q=dt.rotrSH(m,_,14)^dt.rotrSH(m,_,18)^dt.rotrBH(m,_,41),W=dt.rotrSL(m,_,14)^dt.rotrSL(m,_,18)^dt.rotrBL(m,_,41),$=m&x^~m&A,D=_&b^~_&N,k=dt.add5L(B,W,D,Hoe[O],fc[O]),R=dt.add5H(k,F,q,$,Boe[O],hc[O]),U=k|0,M=dt.rotrSH(r,i,28)^dt.rotrBH(r,i,34)^dt.rotrBH(r,i,39),j=dt.rotrSL(r,i,28)^dt.rotrBL(r,i,34)^dt.rotrBL(r,i,39),V=r&s^r&a^s&a,Ee=i&o^i&c^o&c;F=A|0,B=N|0,A=x|0,N=b|0,x=m|0,b=_|0,{h:m,l:_}=dt.add(d|0,h|0,R|0,U|0),d=a|0,h=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const le=dt.add3L(U,j,Ee);r=dt.add3H(le,R,M,V),i=le|0}({h:r,l:i}=dt.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=dt.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=dt.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:d,l:h}=dt.add(this.Dh|0,this.Dl|0,d|0,h|0),{h:m,l:_}=dt.add(this.Eh|0,this.El|0,m|0,_|0),{h:x,l:b}=dt.add(this.Fh|0,this.Fl|0,x|0,b|0),{h:A,l:N}=dt.add(this.Gh|0,this.Gl|0,A|0,N|0),{h:F,l:B}=dt.add(this.Hh|0,this.Hl|0,F|0,B|0),this.set(r,i,s,o,a,c,d,h,m,_,x,b,A,N,F,B)}roundClean(){hc.fill(0),fc.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const joe=Fk(()=>new Goe);function qoe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const sO=qoe();sO.crypto||sO.msCrypto;function zoe(n){switch(n){case"sha256":return k8.create();case"sha512":return joe.create()}Q(!1,"invalid hashing algorithm name","algorithm",n)}const[V8,F8,U8]=[[],[],[]],$oe=BigInt(0),py=BigInt(1),Woe=BigInt(2),Koe=BigInt(7),Qoe=BigInt(256),Joe=BigInt(113);for(let n=0,e=py,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],V8.push(2*(5*r+t)),F8.push((n+1)*(n+2)/2%64);let i=$oe;for(let s=0;s<7;s++)e=(e<<py^(e>>Koe)*Joe)%Qoe,e&Woe&&(i^=py<<(py<<BigInt(s))-py);U8.push(i)}const[Yoe,Xoe]=R8(U8,!0),oO=(n,e,t)=>t>32?L8(n,e,t):D8(n,e,t),aO=(n,e,t)=>t>32?O8(n,e,t):M8(n,e,t);function Zoe(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,d=t[c],h=t[c+1],m=oO(d,h,1)^t[a],_=aO(d,h,1)^t[a+1];for(let x=0;x<50;x+=10)n[o+x]^=m,n[o+x+1]^=_}let i=n[2],s=n[3];for(let o=0;o<24;o++){const a=F8[o],c=oO(i,s,a),d=aO(i,s,a),h=V8[o];i=n[h],s=n[h+1],n[h]=c,n[h+1]=d}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=Yoe[r],n[1]^=Xoe[r]}t.fill(0)}class Uk extends Vk{constructor(e,t,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,tx(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=poe(this.state)}keccak(){Zoe(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){km(this);const{blockLen:t,state:r}=this;e=HT(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){km(this,!1),Ok(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return tx(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(A8(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Uk(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const eae=(n,e,t)=>Fk(()=>new Uk(e,n,t)),tae=eae(1,136,256/8);let B8=!1;const H8=function(n){return tae(n)};let G8=H8;function Hn(n){const e=ht(n,"data");return Me(G8(e))}Hn._=H8;Hn.lock=function(){B8=!0};Hn.register=function(n){if(B8)throw new TypeError("keccak256 is locked");G8=n};Object.freeze(Hn);const j8=function(n){return zoe("sha256").update(n).digest()};let q8=j8,z8=!1;function rg(n){const e=ht(n,"data");return Me(q8(e))}rg._=j8;rg.lock=function(){z8=!0};rg.register=function(n){if(z8)throw new Error("sha256 is locked");q8=n};Object.freeze(rg);Object.freeze(rg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $8=BigInt(0),GT=BigInt(1),nae=BigInt(2),jT=n=>n instanceof Uint8Array,rae=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Pm(n){if(!jT(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=rae[n[t]];return e}function W8(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function Bk(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function Rm(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const i=r*2,s=n.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function Xd(n){return Bk(Pm(n))}function Hk(n){if(!jT(n))throw new Error("Uint8Array expected");return Bk(Pm(Uint8Array.from(n).reverse()))}function Dm(n,e){return Rm(n.toString(16).padStart(e*2,"0"))}function Gk(n,e){return Dm(n,e).reverse()}function iae(n){return Rm(W8(n))}function Gs(n,e,t){let r;if(typeof e=="string")try{r=Rm(e)}catch(s){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${s}`)}else if(jT(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function B0(...n){const e=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let t=0;return n.forEach(r=>{if(!jT(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function sae(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function oae(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function aae(n){let e;for(e=0;n>$8;n>>=GT,e+=1);return e}function lae(n,e){return n>>BigInt(e)&GT}const cae=(n,e,t)=>n|(t?GT:$8)<<BigInt(e),jk=n=>(nae<<BigInt(n-1))-GT,_b=n=>new Uint8Array(n),lO=n=>Uint8Array.from(n);function K8(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=_b(n),i=_b(n),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...m)=>t(i,r,...m),c=(m=_b())=>{i=a(lO([0]),m),r=a(),m.length!==0&&(i=a(lO([1]),m),r=a())},d=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let m=0;const _=[];for(;m<e;){r=a();const x=r.slice();_.push(x),m+=r.length}return B0(..._)};return(m,_)=>{o(),c(m);let x;for(;!(x=_(d()));)c();return o(),x}}const uae={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Ww(n,e,t={}){const r=(i,s,o)=>{const a=uae[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);const c=n[i];if(!(o&&c===void 0)&&!a(c,n))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(const[i,s]of Object.entries(e))r(i,s,!1);for(const[i,s]of Object.entries(t))r(i,s,!0);return n}const dae=Object.freeze(Object.defineProperty({__proto__:null,bitGet:lae,bitLen:aae,bitMask:jk,bitSet:cae,bytesToHex:Pm,bytesToNumberBE:Xd,bytesToNumberLE:Hk,concatBytes:B0,createHmacDrbg:K8,ensureBytes:Gs,equalBytes:sae,hexToBytes:Rm,hexToNumber:Bk,numberToBytesBE:Dm,numberToBytesLE:Gk,numberToHexUnpadded:W8,numberToVarBytesBE:iae,utf8ToBytes:oae,validateObject:Ww},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cr=BigInt(0),Rn=BigInt(1),pd=BigInt(2),hae=BigInt(3),aS=BigInt(4),cO=BigInt(5),uO=BigInt(8);BigInt(9);BigInt(16);function gi(n,e){const t=n%e;return t>=cr?t:e+t}function fae(n,e,t){if(t<=cr||e<cr)throw new Error("Expected power/modulo > 0");if(t===Rn)return cr;let r=Rn;for(;e>cr;)e&Rn&&(r=r*n%t),n=n*n%t,e>>=Rn;return r}function ls(n,e,t){let r=n;for(;e-- >cr;)r*=r,r%=t;return r}function lS(n,e){if(n===cr||e<=cr)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=gi(n,e),r=e,i=cr,s=Rn;for(;t!==cr;){const a=r/t,c=r%t,d=i-s*a;r=t,t=c,i=s,s=d}if(r!==Rn)throw new Error("invert: does not exist");return gi(i,e)}function pae(n){const e=(n-Rn)/pd;let t,r,i;for(t=n-Rn,r=0;t%pd===cr;t/=pd,r++);for(i=pd;i<n&&fae(i,e,n)!==n-Rn;i++);if(r===1){const o=(n+Rn)/aS;return function(c,d){const h=c.pow(d,o);if(!c.eql(c.sqr(h),d))throw new Error("Cannot find square root");return h}}const s=(t+Rn)/pd;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=r,h=a.pow(a.mul(a.ONE,i),t),m=a.pow(c,s),_=a.pow(c,t);for(;!a.eql(_,a.ONE);){if(a.eql(_,a.ZERO))return a.ZERO;let x=1;for(let A=a.sqr(_);x<d&&!a.eql(A,a.ONE);x++)A=a.sqr(A);const b=a.pow(h,Rn<<BigInt(d-x-1));h=a.sqr(b),m=a.mul(m,b),_=a.mul(_,h),d=x}return m}}function mae(n){if(n%aS===hae){const e=(n+Rn)/aS;return function(r,i){const s=r.pow(i,e);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(n%uO===cO){const e=(n-cO)/uO;return function(r,i){const s=r.mul(i,pd),o=r.pow(s,e),a=r.mul(i,o),c=r.mul(r.mul(a,pd),o),d=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(d),i))throw new Error("Cannot find square root");return d}}return pae(n)}const gae=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function yae(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=gae.reduce((r,i)=>(r[i]="function",r),e);return Ww(n,t)}function wae(n,e,t){if(t<cr)throw new Error("Expected power > 0");if(t===cr)return n.ONE;if(t===Rn)return e;let r=n.ONE,i=e;for(;t>cr;)t&Rn&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Rn;return r}function _ae(n,e){const t=new Array(e.length),r=e.reduce((s,o,a)=>n.is0(o)?s:(t[a]=s,n.mul(s,o)),n.ONE),i=n.inv(r);return e.reduceRight((s,o,a)=>n.is0(o)?s:(t[a]=n.mul(s,t[a]),n.mul(s,o)),i),t}function Q8(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function vae(n,e,t=!1,r={}){if(n<=cr)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:s}=Q8(n,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=mae(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:s,MASK:jk(i),ZERO:cr,ONE:Rn,create:c=>gi(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return cr<=c&&c<n},is0:c=>c===cr,isOdd:c=>(c&Rn)===Rn,neg:c=>gi(-c,n),eql:(c,d)=>c===d,sqr:c=>gi(c*c,n),add:(c,d)=>gi(c+d,n),sub:(c,d)=>gi(c-d,n),mul:(c,d)=>gi(c*d,n),pow:(c,d)=>wae(a,c,d),div:(c,d)=>gi(c*lS(d,n),n),sqrN:c=>c*c,addN:(c,d)=>c+d,subN:(c,d)=>c-d,mulN:(c,d)=>c*d,inv:c=>lS(c,n),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>_ae(a,c),cmov:(c,d,h)=>h?d:c,toBytes:c=>t?Gk(c,s):Dm(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return t?Hk(c):Xd(c)}});return Object.freeze(a)}function J8(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function Y8(n){const e=J8(n);return e+Math.ceil(e/2)}function Eae(n,e,t=!1){const r=n.length,i=J8(e),s=Y8(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=t?Xd(n):Hk(n),a=gi(o,e-Rn)+Rn;return t?Gk(a,i):Dm(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xae=BigInt(0),vb=BigInt(1);function Tae(n,e){const t=(i,s)=>{const o=s.negate();return i?o:s},r=i=>{const s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:t,unsafeLadder(i,s){let o=n.ZERO,a=i;for(;s>xae;)s&vb&&(o=o.add(a)),a=a.double(),s>>=vb;return o},precomputeWindow(i,s){const{windows:o,windowSize:a}=r(s),c=[];let d=i,h=d;for(let m=0;m<o;m++){h=d,c.push(h);for(let _=1;_<a;_++)h=h.add(d),c.push(h);d=h.double()}return c},wNAF(i,s,o){const{windows:a,windowSize:c}=r(i);let d=n.ZERO,h=n.BASE;const m=BigInt(2**i-1),_=2**i,x=BigInt(i);for(let b=0;b<a;b++){const A=b*c;let N=Number(o&m);o>>=x,N>c&&(N-=_,o+=vb);const F=A,B=A+Math.abs(N)-1,O=b%2!==0,q=N<0;N===0?h=h.add(t(O,s[F])):d=d.add(t(q,s[B]))}return{p:d,f:h}},wNAFCached(i,s,o,a){const c=i._WINDOW_SIZE||1;let d=s.get(i);return d||(d=this.precomputeWindow(i,c),c!==1&&s.set(i,a(d))),this.wNAF(c,d,o)}}}function X8(n){return yae(n.Fp),Ww(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Q8(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Iae(n){const e=X8(n);Ww(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Aae,hexToBytes:bae}=dae,bd={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=bd;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Aae(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=bd,t=typeof n=="string"?bae(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=bd._parseInt(t.subarray(2)),{d:o,l:a}=bd._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(n){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,t=d=>{const h=d.toString(16);return h.length&1?`0${h}`:h},r=e(t(n.s)),i=e(t(n.r)),s=r.length/2,o=i.length/2,a=t(s),c=t(o);return`30${t(o+s+4)}02${c}${i}02${a}${r}`}},el=BigInt(0),gs=BigInt(1);BigInt(2);const dO=BigInt(3);BigInt(4);function Cae(n){const e=Iae(n),{Fp:t}=e,r=e.toBytes||((b,A,N)=>{const F=A.toAffine();return B0(Uint8Array.from([4]),t.toBytes(F.x),t.toBytes(F.y))}),i=e.fromBytes||(b=>{const A=b.subarray(1),N=t.fromBytes(A.subarray(0,t.BYTES)),F=t.fromBytes(A.subarray(t.BYTES,2*t.BYTES));return{x:N,y:F}});function s(b){const{a:A,b:N}=e,F=t.sqr(b),B=t.mul(F,b);return t.add(t.add(B,t.mul(b,A)),N)}if(!t.eql(t.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&el<b&&b<e.n}function a(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(b){const{allowedPrivateKeyLengths:A,nByteLength:N,wrapPrivateKey:F,n:B}=e;if(A&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Pm(b)),typeof b!="string"||!A.includes(b.length))throw new Error("Invalid key");b=b.padStart(N*2,"0")}let O;try{O=typeof b=="bigint"?b:Xd(Gs("private key",b,N))}catch{throw new Error(`private key must be ${N} bytes, hex or bigint, not ${typeof b}`)}return F&&(O=gi(O,B)),a(O),O}const d=new Map;function h(b){if(!(b instanceof m))throw new Error("ProjectivePoint expected")}class m{constructor(A,N,F){if(this.px=A,this.py=N,this.pz=F,A==null||!t.isValid(A))throw new Error("x required");if(N==null||!t.isValid(N))throw new Error("y required");if(F==null||!t.isValid(F))throw new Error("z required")}static fromAffine(A){const{x:N,y:F}=A||{};if(!A||!t.isValid(N)||!t.isValid(F))throw new Error("invalid affine point");if(A instanceof m)throw new Error("projective point not allowed");const B=O=>t.eql(O,t.ZERO);return B(N)&&B(F)?m.ZERO:new m(N,F,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(A){const N=t.invertBatch(A.map(F=>F.pz));return A.map((F,B)=>F.toAffine(N[B])).map(m.fromAffine)}static fromHex(A){const N=m.fromAffine(i(Gs("pointHex",A)));return N.assertValidity(),N}static fromPrivateKey(A){return m.BASE.multiply(c(A))}_setWindowSize(A){this._WINDOW_SIZE=A,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:A,y:N}=this.toAffine();if(!t.isValid(A)||!t.isValid(N))throw new Error("bad point: x or y not FE");const F=t.sqr(N),B=s(A);if(!t.eql(F,B))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:A}=this.toAffine();if(t.isOdd)return!t.isOdd(A);throw new Error("Field doesn't support isOdd")}equals(A){h(A);const{px:N,py:F,pz:B}=this,{px:O,py:q,pz:W}=A,$=t.eql(t.mul(N,W),t.mul(O,B)),D=t.eql(t.mul(F,W),t.mul(q,B));return $&&D}negate(){return new m(this.px,t.neg(this.py),this.pz)}double(){const{a:A,b:N}=e,F=t.mul(N,dO),{px:B,py:O,pz:q}=this;let W=t.ZERO,$=t.ZERO,D=t.ZERO,k=t.mul(B,B),R=t.mul(O,O),U=t.mul(q,q),M=t.mul(B,O);return M=t.add(M,M),D=t.mul(B,q),D=t.add(D,D),W=t.mul(A,D),$=t.mul(F,U),$=t.add(W,$),W=t.sub(R,$),$=t.add(R,$),$=t.mul(W,$),W=t.mul(M,W),D=t.mul(F,D),U=t.mul(A,U),M=t.sub(k,U),M=t.mul(A,M),M=t.add(M,D),D=t.add(k,k),k=t.add(D,k),k=t.add(k,U),k=t.mul(k,M),$=t.add($,k),U=t.mul(O,q),U=t.add(U,U),k=t.mul(U,M),W=t.sub(W,k),D=t.mul(U,R),D=t.add(D,D),D=t.add(D,D),new m(W,$,D)}add(A){h(A);const{px:N,py:F,pz:B}=this,{px:O,py:q,pz:W}=A;let $=t.ZERO,D=t.ZERO,k=t.ZERO;const R=e.a,U=t.mul(e.b,dO);let M=t.mul(N,O),j=t.mul(F,q),V=t.mul(B,W),Ee=t.add(N,F),le=t.add(O,q);Ee=t.mul(Ee,le),le=t.add(M,j),Ee=t.sub(Ee,le),le=t.add(N,B);let pe=t.add(O,W);return le=t.mul(le,pe),pe=t.add(M,V),le=t.sub(le,pe),pe=t.add(F,B),$=t.add(q,W),pe=t.mul(pe,$),$=t.add(j,V),pe=t.sub(pe,$),k=t.mul(R,le),$=t.mul(U,V),k=t.add($,k),$=t.sub(j,k),k=t.add(j,k),D=t.mul($,k),j=t.add(M,M),j=t.add(j,M),V=t.mul(R,V),le=t.mul(U,le),j=t.add(j,V),V=t.sub(M,V),V=t.mul(R,V),le=t.add(le,V),M=t.mul(j,le),D=t.add(D,M),M=t.mul(pe,le),$=t.mul(Ee,$),$=t.sub($,M),M=t.mul(Ee,j),k=t.mul(pe,k),k=t.add(k,M),new m($,D,k)}subtract(A){return this.add(A.negate())}is0(){return this.equals(m.ZERO)}wNAF(A){return x.wNAFCached(this,d,A,N=>{const F=t.invertBatch(N.map(B=>B.pz));return N.map((B,O)=>B.toAffine(F[O])).map(m.fromAffine)})}multiplyUnsafe(A){const N=m.ZERO;if(A===el)return N;if(a(A),A===gs)return this;const{endo:F}=e;if(!F)return x.unsafeLadder(this,A);let{k1neg:B,k1:O,k2neg:q,k2:W}=F.splitScalar(A),$=N,D=N,k=this;for(;O>el||W>el;)O&gs&&($=$.add(k)),W&gs&&(D=D.add(k)),k=k.double(),O>>=gs,W>>=gs;return B&&($=$.negate()),q&&(D=D.negate()),D=new m(t.mul(D.px,F.beta),D.py,D.pz),$.add(D)}multiply(A){a(A);let N=A,F,B;const{endo:O}=e;if(O){const{k1neg:q,k1:W,k2neg:$,k2:D}=O.splitScalar(N);let{p:k,f:R}=this.wNAF(W),{p:U,f:M}=this.wNAF(D);k=x.constTimeNegate(q,k),U=x.constTimeNegate($,U),U=new m(t.mul(U.px,O.beta),U.py,U.pz),F=k.add(U),B=R.add(M)}else{const{p:q,f:W}=this.wNAF(N);F=q,B=W}return m.normalizeZ([F,B])[0]}multiplyAndAddUnsafe(A,N,F){const B=m.BASE,O=(W,$)=>$===el||$===gs||!W.equals(B)?W.multiplyUnsafe($):W.multiply($),q=O(this,N).add(O(A,F));return q.is0()?void 0:q}toAffine(A){const{px:N,py:F,pz:B}=this,O=this.is0();A==null&&(A=O?t.ONE:t.inv(B));const q=t.mul(N,A),W=t.mul(F,A),$=t.mul(B,A);if(O)return{x:t.ZERO,y:t.ZERO};if(!t.eql($,t.ONE))throw new Error("invZ was invalid");return{x:q,y:W}}isTorsionFree(){const{h:A,isTorsionFree:N}=e;if(A===gs)return!0;if(N)return N(m,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:A,clearCofactor:N}=e;return A===gs?this:N?N(m,this):this.multiplyUnsafe(e.h)}toRawBytes(A=!0){return this.assertValidity(),r(m,this,A)}toHex(A=!0){return Pm(this.toRawBytes(A))}}m.BASE=new m(e.Gx,e.Gy,t.ONE),m.ZERO=new m(t.ZERO,t.ONE,t.ZERO);const _=e.nBitLength,x=Tae(m,e.endo?Math.ceil(_/2):_);return{CURVE:e,ProjectivePoint:m,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function Sae(n){const e=X8(n);return Ww(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Nae(n){const e=Sae(n),{Fp:t,n:r}=e,i=t.BYTES+1,s=2*t.BYTES+1;function o(le){return el<le&&le<t.ORDER}function a(le){return gi(le,r)}function c(le){return lS(le,r)}const{ProjectivePoint:d,normPrivateKeyToScalar:h,weierstrassEquation:m,isWithinCurveOrder:_}=Cae({...e,toBytes(le,pe,be){const de=pe.toAffine(),xe=t.toBytes(de.x),ne=B0;return be?ne(Uint8Array.from([pe.hasEvenY()?2:3]),xe):ne(Uint8Array.from([4]),xe,t.toBytes(de.y))},fromBytes(le){const pe=le.length,be=le[0],de=le.subarray(1);if(pe===i&&(be===2||be===3)){const xe=Xd(de);if(!o(xe))throw new Error("Point is not on curve");const ne=m(xe);let z=t.sqrt(ne);const ce=(z&gs)===gs;return(be&1)===1!==ce&&(z=t.neg(z)),{x:xe,y:z}}else if(pe===s&&be===4){const xe=t.fromBytes(de.subarray(0,t.BYTES)),ne=t.fromBytes(de.subarray(t.BYTES,2*t.BYTES));return{x:xe,y:ne}}else throw new Error(`Point of length ${pe} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),x=le=>Pm(Dm(le,e.nByteLength));function b(le){const pe=r>>gs;return le>pe}function A(le){return b(le)?a(-le):le}const N=(le,pe,be)=>Xd(le.slice(pe,be));class F{constructor(pe,be,de){this.r=pe,this.s=be,this.recovery=de,this.assertValidity()}static fromCompact(pe){const be=e.nByteLength;return pe=Gs("compactSignature",pe,be*2),new F(N(pe,0,be),N(pe,be,2*be))}static fromDER(pe){const{r:be,s:de}=bd.toSig(Gs("DER",pe));return new F(be,de)}assertValidity(){if(!_(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!_(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(pe){return new F(this.r,this.s,pe)}recoverPublicKey(pe){const{r:be,s:de,recovery:xe}=this,ne=D(Gs("msgHash",pe));if(xe==null||![0,1,2,3].includes(xe))throw new Error("recovery id invalid");const z=xe===2||xe===3?be+e.n:be;if(z>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const ce=(xe&1)===0?"02":"03",Pe=d.fromHex(ce+x(z)),Re=c(z),Ye=a(-ne*Re),Xe=a(de*Re),et=d.BASE.multiplyAndAddUnsafe(Pe,Ye,Xe);if(!et)throw new Error("point at infinify");return et.assertValidity(),et}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new F(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Rm(this.toDERHex())}toDERHex(){return bd.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Rm(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}const B={isValidPrivateKey(le){try{return h(le),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const le=Y8(e.n);return Eae(e.randomBytes(le),e.n)},precompute(le=8,pe=d.BASE){return pe._setWindowSize(le),pe.multiply(BigInt(3)),pe}};function O(le,pe=!0){return d.fromPrivateKey(le).toRawBytes(pe)}function q(le){const pe=le instanceof Uint8Array,be=typeof le=="string",de=(pe||be)&&le.length;return pe?de===i||de===s:be?de===2*i||de===2*s:le instanceof d}function W(le,pe,be=!0){if(q(le))throw new Error("first arg must be private key");if(!q(pe))throw new Error("second arg must be public key");return d.fromHex(pe).multiply(h(le)).toRawBytes(be)}const $=e.bits2int||function(le){const pe=Xd(le),be=le.length*8-e.nBitLength;return be>0?pe>>BigInt(be):pe},D=e.bits2int_modN||function(le){return a($(le))},k=jk(e.nBitLength);function R(le){if(typeof le!="bigint")throw new Error("bigint expected");if(!(el<=le&&le<k))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Dm(le,e.nByteLength)}function U(le,pe,be=M){if(["recovered","canonical"].some(Te=>Te in be))throw new Error("sign() legacy options not supported");const{hash:de,randomBytes:xe}=e;let{lowS:ne,prehash:z,extraEntropy:ce}=be;ne==null&&(ne=!0),le=Gs("msgHash",le),z&&(le=Gs("prehashed msgHash",de(le)));const Pe=D(le),Re=h(pe),Ye=[R(Re),R(Pe)];if(ce!=null){const Te=ce===!0?xe(t.BYTES):ce;Ye.push(Gs("extraEntropy",Te))}const Xe=B0(...Ye),et=Pe;function Ne(Te){const Ve=$(Te);if(!_(Ve))return;const it=c(Ve),st=d.BASE.multiply(Ve).toAffine(),lt=a(st.x);if(lt===el)return;const mt=a(it*a(et+lt*Re));if(mt===el)return;let zt=(st.x===lt?0:2)|Number(st.y&gs),tn=mt;return ne&&b(mt)&&(tn=A(mt),zt^=1),new F(lt,tn,zt)}return{seed:Xe,k2sig:Ne}}const M={lowS:e.lowS,prehash:!1},j={lowS:e.lowS,prehash:!1};function V(le,pe,be=M){const{seed:de,k2sig:xe}=U(le,pe,be),ne=e;return K8(ne.hash.outputLen,ne.nByteLength,ne.hmac)(de,xe)}d.BASE._setWindowSize(8);function Ee(le,pe,be,de=j){var st;const xe=le;if(pe=Gs("msgHash",pe),be=Gs("publicKey",be),"strict"in de)throw new Error("options.strict was renamed to lowS");const{lowS:ne,prehash:z}=de;let ce,Pe;try{if(typeof xe=="string"||xe instanceof Uint8Array)try{ce=F.fromDER(xe)}catch(lt){if(!(lt instanceof bd.Err))throw lt;ce=F.fromCompact(xe)}else if(typeof xe=="object"&&typeof xe.r=="bigint"&&typeof xe.s=="bigint"){const{r:lt,s:mt}=xe;ce=new F(lt,mt)}else throw new Error("PARSE");Pe=d.fromHex(be)}catch(lt){if(lt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(ne&&ce.hasHighS())return!1;z&&(pe=e.hash(pe));const{r:Re,s:Ye}=ce,Xe=D(pe),et=c(Ye),Ne=a(Xe*et),Te=a(Re*et),Ve=(st=d.BASE.multiplyAndAddUnsafe(Pe,Ne,Te))==null?void 0:st.toAffine();return Ve?a(Ve.x)===Re:!1}return{CURVE:e,getPublicKey:O,getSharedSecret:W,sign:V,verify:Ee,ProjectivePoint:d,Signature:F,utils:B}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function kae(n){return{hash:n,hmac:(e,...t)=>S8(n,e,yoe(...t)),randomBytes:woe}}function Pae(n,e){const t=r=>Nae({...n,...kae(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Z8=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),hO=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Rae=BigInt(1),cS=BigInt(2),fO=(n,e)=>(n+e/cS)/e;function Dae(n){const e=Z8,t=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),d=n*n*n%e,h=d*d*n%e,m=ls(h,t,e)*h%e,_=ls(m,t,e)*h%e,x=ls(_,cS,e)*d%e,b=ls(x,i,e)*x%e,A=ls(b,s,e)*b%e,N=ls(A,a,e)*A%e,F=ls(N,c,e)*N%e,B=ls(F,a,e)*A%e,O=ls(B,t,e)*h%e,q=ls(O,o,e)*b%e,W=ls(q,r,e)*d%e,$=ls(W,cS,e);if(!uS.eql(uS.sqr($),n))throw new Error("Cannot find square root");return $}const uS=vae(Z8,void 0,void 0,{sqrt:Dae}),pc=Pae({a:BigInt(0),b:BigInt(7),Fp:uS,n:hO,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=hO,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Rae*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),a=fO(s*n,e),c=fO(-r*n,e);let d=gi(n-a*t-c*i,e),h=gi(-a*r-c*s,e);const m=d>o,_=h>o;if(m&&(d=e-d),_&&(h=e-h),d>o||h>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:m,k1:d,k2neg:_,k2:h}}}},k8);BigInt(0);pc.ProjectivePoint;const H0="0x0000000000000000000000000000000000000000",pO="0x0000000000000000000000000000000000000000000000000000000000000000",mO=BigInt(0),gO=BigInt(1),dS=BigInt(2),yO=BigInt(27),wO=BigInt(28),xv=BigInt(35),e9=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Mae=e9/dS,Lae=Symbol.for("nodejs.util.inspect.custom"),ed={};function Eb(n){return yl(jn(n),32)}var Ep,Lo,xp,Ec;const cs=class cs{constructor(e,t,r,i){se(this,Ep);se(this,Lo);se(this,xp);se(this,Ec);qw(e,ed,"Signature"),H(this,Ep,t),H(this,Lo,r),H(this,xp,i),H(this,Ec,null)}get r(){return S(this,Ep)}set r(e){Q(sp(e)===32,"invalid r","value",e),H(this,Ep,Me(e))}get s(){return Q(parseInt(S(this,Lo).substring(0,3))<8,"non-canonical s; use ._s","s",S(this,Lo)),S(this,Lo)}set s(e){Q(sp(e)===32,"invalid s","value",e),H(this,Lo,Me(e))}get _s(){return S(this,Lo)}isValid(){return BigInt(S(this,Lo))<=Mae}get v(){return S(this,xp)}set v(e){const t=ut(e,"value");Q(t===27||t===28,"invalid v","v",e),H(this,xp,t)}get networkV(){return S(this,Ec)}get legacyChainId(){const e=this.networkV;return e==null?null:cs.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=ht(this.s);return this.yParity&&(e[0]|=128),Me(e)}get compactSerialized(){return mn([this.r,this.yParityAndS])}get serialized(){return mn([this.r,this.s,this.yParity?"0x1c":"0x1b"])}getCanonical(){if(this.isValid())return this;const e=e9-BigInt(this._s),t=55-this.v,r=new cs(ed,this.r,Eb(e),t);return this.networkV&&H(r,Ec,this.networkV),r}clone(){const e=new cs(ed,this.r,this._s,this.v);return this.networkV&&H(e,Ec,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}[Lae](){return this.toString()}toString(){return this.isValid()?`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v} }`:`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v}, valid: false }`}static getChainId(e){const t=He(e,"v");return t==yO||t==wO?mO:(Q(t>=xv,"invalid EIP-155 v","v",e),(t-xv)/dS)}static getChainIdV(e,t){return He(e)*dS+BigInt(35+t-27)}static getNormalizedV(e){const t=He(e);return t===mO||t===yO?27:t===gO||t===wO?28:(Q(t>=xv,"invalid v","v",e),t&gO?27:28)}static from(e){function t(d,h){Q(d,h,"signature",e)}if(e==null)return new cs(ed,pO,pO,27);if(typeof e=="string"){const d=ht(e,"signature");if(d.length===64){const h=Me(d.slice(0,32)),m=d.slice(32,64),_=m[0]&128?28:27;return m[0]&=127,new cs(ed,h,Me(m),_)}if(d.length===65){const h=Me(d.slice(0,32)),m=Me(d.slice(32,64)),_=cs.getNormalizedV(d[64]);return new cs(ed,h,m,_)}t(!1,"invalid raw signature length")}if(e instanceof cs)return e.clone();const r=e.r;t(r!=null,"missing r");const i=Eb(r),s=(function(d,h){if(d!=null)return Eb(d);if(h!=null){t(Xt(h,32),"invalid yParityAndS");const m=ht(h);return m[0]&=127,Me(m)}t(!1,"missing s")})(e.s,e.yParityAndS),{networkV:o,v:a}=(function(d,h,m){if(d!=null){const _=He(d);return{networkV:_>=xv?_:void 0,v:cs.getNormalizedV(_)}}if(h!=null)return t(Xt(h,32),"invalid yParityAndS"),{v:ht(h)[0]&128?28:27};if(m!=null){switch(ut(m,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),c=new cs(ed,i,s,a);return o&&H(c,Ec,o),t(e.yParity==null||ut(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Ep=new WeakMap,Lo=new WeakMap,xp=new WeakMap,Ec=new WeakMap;let Ti=cs;var $a;const md=class md{constructor(e){se(this,$a);Q(sp(e)===32,"invalid private key","privateKey","[REDACTED]"),H(this,$a,Me(e))}get privateKey(){return S(this,$a)}get publicKey(){return md.computePublicKey(S(this,$a))}get compressedPublicKey(){return md.computePublicKey(S(this,$a),!0)}sign(e){Q(sp(e)===32,"invalid digest length","digest",e);const t=pc.sign(Yr(e),Yr(S(this,$a)),{lowS:!0});return Ti.from({r:hu(t.r,32),s:hu(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=md.computePublicKey(e);return Me(pc.getSharedSecret(Yr(S(this,$a)),ht(t),!1))}static computePublicKey(e,t){let r=ht(e,"key");if(r.length===32){const s=pc.getPublicKey(r,!!t);return Me(s)}if(r.length===64){const s=new Uint8Array(65);s[0]=4,s.set(r,1),r=s}const i=pc.ProjectivePoint.fromHex(r);return Me(i.toRawBytes(t))}static recoverPublicKey(e,t){Q(sp(e)===32,"invalid digest length","digest",e);const r=Ti.from(t);let i=pc.Signature.fromCompact(Yr(mn([r.r,r.s])));i=i.addRecoveryBit(r.yParity);const s=i.recoverPublicKey(Yr(e));return Q(s!=null,"invalid signature for digest","signature",t),"0x"+s.toHex(!1)}static addPoints(e,t,r){const i=pc.ProjectivePoint.fromHex(md.computePublicKey(e).substring(2)),s=pc.ProjectivePoint.fromHex(md.computePublicKey(t).substring(2));return"0x"+i.add(s).toHex(!!r)}};$a=new WeakMap;let G0=md;const Oae=BigInt(0),Vae=BigInt(36);function _O(n){n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const r=ht(Hn(t));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(r[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const qk={};for(let n=0;n<10;n++)qk[String(n)]=String(n);for(let n=0;n<26;n++)qk[String.fromCharCode(65+n)]=String(10+n);const vO=15;function Fae(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>qk[r]).join("");for(;e.length>=vO;){let r=e.substring(0,vO);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const Uae=(function(){const n={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n})();function Bae(n){n=n.toLowerCase();let e=Oae;for(let t=0;t<n.length;t++)e=e*Vae+Uae[n[t]];return e}function Ot(n){if(Q(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);const e=_O(n);return Q(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){Q(n.substring(2,4)===Fae(n),"bad icap checksum","address",n);let e=Bae(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return _O("0x"+e)}Q(!1,"invalid address","address",n)}function Hae(n){const e=Ot(n.from);let r=He(n.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Ot(An(Hn(cl([e,r])),12))}function t9(n){return n&&typeof n.getAddress=="function"}async function xb(n,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(he(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),Q(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),Ot(t)}function ei(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?Ot(n):(he(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),xb(n,e.resolveName(n)));if(t9(n))return xb(n,n.getAddress());if(n&&typeof n.then=="function")return xb(n,n);Q(!1,"unsupported addressable value","target",n)}const Ba={};function Be(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new Br(Ba,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function Nt(n,e){return new Br(Ba,`bytes${e||""}`,n,{size:e})}const EO=Symbol.for("_ethers_typed");var Fd;const Ha=class Ha{constructor(e,t,r,i){X(this,"type");X(this,"value");se(this,Fd);X(this,"_typedSymbol");i==null&&(i=null),qw(Ba,e,"Typed"),Qe(this,{_typedSymbol:EO,type:t,value:r}),H(this,Fd,i),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return S(this,Fd)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return S(this,Fd)===!0?-1:S(this,Fd)===!1?this.value.length:null}static from(e,t){return new Ha(Ba,e,t)}static uint8(e){return Be(e,8)}static uint16(e){return Be(e,16)}static uint24(e){return Be(e,24)}static uint32(e){return Be(e,32)}static uint40(e){return Be(e,40)}static uint48(e){return Be(e,48)}static uint56(e){return Be(e,56)}static uint64(e){return Be(e,64)}static uint72(e){return Be(e,72)}static uint80(e){return Be(e,80)}static uint88(e){return Be(e,88)}static uint96(e){return Be(e,96)}static uint104(e){return Be(e,104)}static uint112(e){return Be(e,112)}static uint120(e){return Be(e,120)}static uint128(e){return Be(e,128)}static uint136(e){return Be(e,136)}static uint144(e){return Be(e,144)}static uint152(e){return Be(e,152)}static uint160(e){return Be(e,160)}static uint168(e){return Be(e,168)}static uint176(e){return Be(e,176)}static uint184(e){return Be(e,184)}static uint192(e){return Be(e,192)}static uint200(e){return Be(e,200)}static uint208(e){return Be(e,208)}static uint216(e){return Be(e,216)}static uint224(e){return Be(e,224)}static uint232(e){return Be(e,232)}static uint240(e){return Be(e,240)}static uint248(e){return Be(e,248)}static uint256(e){return Be(e,256)}static uint(e){return Be(e,256)}static int8(e){return Be(e,-8)}static int16(e){return Be(e,-16)}static int24(e){return Be(e,-24)}static int32(e){return Be(e,-32)}static int40(e){return Be(e,-40)}static int48(e){return Be(e,-48)}static int56(e){return Be(e,-56)}static int64(e){return Be(e,-64)}static int72(e){return Be(e,-72)}static int80(e){return Be(e,-80)}static int88(e){return Be(e,-88)}static int96(e){return Be(e,-96)}static int104(e){return Be(e,-104)}static int112(e){return Be(e,-112)}static int120(e){return Be(e,-120)}static int128(e){return Be(e,-128)}static int136(e){return Be(e,-136)}static int144(e){return Be(e,-144)}static int152(e){return Be(e,-152)}static int160(e){return Be(e,-160)}static int168(e){return Be(e,-168)}static int176(e){return Be(e,-176)}static int184(e){return Be(e,-184)}static int192(e){return Be(e,-192)}static int200(e){return Be(e,-200)}static int208(e){return Be(e,-208)}static int216(e){return Be(e,-216)}static int224(e){return Be(e,-224)}static int232(e){return Be(e,-232)}static int240(e){return Be(e,-240)}static int248(e){return Be(e,-248)}static int256(e){return Be(e,-256)}static int(e){return Be(e,-256)}static bytes1(e){return Nt(e,1)}static bytes2(e){return Nt(e,2)}static bytes3(e){return Nt(e,3)}static bytes4(e){return Nt(e,4)}static bytes5(e){return Nt(e,5)}static bytes6(e){return Nt(e,6)}static bytes7(e){return Nt(e,7)}static bytes8(e){return Nt(e,8)}static bytes9(e){return Nt(e,9)}static bytes10(e){return Nt(e,10)}static bytes11(e){return Nt(e,11)}static bytes12(e){return Nt(e,12)}static bytes13(e){return Nt(e,13)}static bytes14(e){return Nt(e,14)}static bytes15(e){return Nt(e,15)}static bytes16(e){return Nt(e,16)}static bytes17(e){return Nt(e,17)}static bytes18(e){return Nt(e,18)}static bytes19(e){return Nt(e,19)}static bytes20(e){return Nt(e,20)}static bytes21(e){return Nt(e,21)}static bytes22(e){return Nt(e,22)}static bytes23(e){return Nt(e,23)}static bytes24(e){return Nt(e,24)}static bytes25(e){return Nt(e,25)}static bytes26(e){return Nt(e,26)}static bytes27(e){return Nt(e,27)}static bytes28(e){return Nt(e,28)}static bytes29(e){return Nt(e,29)}static bytes30(e){return Nt(e,30)}static bytes31(e){return Nt(e,31)}static bytes32(e){return Nt(e,32)}static address(e){return new Ha(Ba,"address",e)}static bool(e){return new Ha(Ba,"bool",!!e)}static bytes(e){return new Ha(Ba,"bytes",e)}static string(e){return new Ha(Ba,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new Ha(Ba,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===EO}static dereference(e,t){if(Ha.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Fd=new WeakMap;let Br=Ha;class Gae extends Cl{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=Br.dereference(t,"string");try{r=Ot(r)}catch(i){return this._throwError(i.message,t)}return e.writeValue(r)}decode(e){return Ot(hu(e.readValue(),20))}}class jae extends Cl{constructor(t){super(t.name,t.type,"_",t.dynamic);X(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}function n9(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let c={};r=e.map(d=>{const h=d.localName;return he(h,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),he(!c[h],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),c[h]=!0,t[h]})}else Q(!1,"invalid tuple value","tuple",t);Q(e.length===r.length,"types/value length mismatch","tuple",t);let i=new rS,s=new rS,o=[];e.forEach((c,d)=>{let h=r[d];if(c.dynamic){let m=s.length;c.encode(s,h);let _=i.writeUpdatableValue();o.push(x=>{_(x+m)})}else c.encode(i,h)}),o.forEach(c=>{c(i.length)});let a=n.appendWriter(i);return a+=n.appendWriter(s),a}function r9(n,e){let t=[],r=[],i=n.subReader(0);return e.forEach(s=>{let o=null;if(s.dynamic){let a=n.readIndex(),c=i.subReader(a);try{o=s.decode(c)}catch(d){if(vr(d,"BUFFER_OVERRUN"))throw d;o=d,o.baseType=s.name,o.name=s.localName,o.type=s.type}}else try{o=s.decode(n)}catch(a){if(vr(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=s.name,o.name=s.localName,o.type=s.type}if(o==null)throw new Error("investigate");t.push(o),r.push(s.localName||null)}),Nm.fromItems(t,r)}class qae extends Cl{constructor(t,r,i){const s=t.type+"["+(r>=0?r:"")+"]",o=r===-1||t.dynamic;super("array",s,i,o);X(this,"coder");X(this,"length");Qe(this,{coder:t,length:r})}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let i=0;i<this.length;i++)r.push(t);return r}encode(t,r){const i=Br.dereference(r,"array");Array.isArray(i)||this._throwError("expected array value",i);let s=this.length;s===-1&&(s=i.length,t.writeValue(i.length)),u8(i.length,s,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<i.length;a++)o.push(this.coder);return n9(t,o,i)}decode(t){let r=this.length;r===-1&&(r=t.readIndex(),he(r*Zr<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:r*Zr,length:t.dataLength}));let i=[];for(let s=0;s<r;s++)i.push(new jae(this.coder));return r9(t,i)}}class zae extends Cl{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const r=Br.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class i9 extends Cl{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Yr(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class $ae extends i9{constructor(e){super("bytes",e)}decode(e){return Me(super.decode(e))}}class Wae extends Cl{constructor(t,r){let i="bytes"+String(t);super(i,i,r,!1);X(this,"size");Qe(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let i=Yr(Br.dereference(r,this.type));return i.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(i)}decode(t){return Me(t.readBytes(this.size))}}const Kae=new Uint8Array([]);class Qae extends Cl{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(Kae)}decode(e){return e.readBytes(0),null}}const Jae=BigInt(0),Yae=BigInt(1),Xae=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Zae extends Cl{constructor(t,r,i){const s=(r?"int":"uint")+t*8;super(s,s,i,!1);X(this,"size");X(this,"signed");Qe(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,r){let i=He(Br.dereference(r,this.type)),s=Ad(Xae,Zr*8);if(this.signed){let o=Ad(s,this.size*8-1);(i>o||i<-(o+Yae))&&this._throwError("value out-of-bounds",r),i=f8(i,8*Zr)}else(i<Jae||i>Ad(s,this.size*8))&&this._throwError("value out-of-bounds",r);return t.writeValue(i)}decode(t){let r=Ad(t.readValue(),this.size*8);return this.signed&&(r=XE(r,this.size*8)),r}}class ele extends i9{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,ll(Br.dereference(t,"string")))}decode(e){return ZE(super.decode(e))}}class Tv extends Cl{constructor(t,r){let i=!1;const s=[];t.forEach(a=>{a.dynamic&&(i=!0),s.push(a.type)});const o="tuple("+s.join(",")+")";super("tuple",o,r,i);X(this,"coders");Qe(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(i=>{t.push(i.defaultValue())});const r=this.coders.reduce((i,s)=>{const o=s.localName;return o&&(i[o]||(i[o]=0),i[o]++),i},{});return this.coders.forEach((i,s)=>{let o=i.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[s]))}),Object.freeze(t)}encode(t,r){const i=Br.dereference(r,"tuple");return n9(t,this.coders,i)}decode(t){return r9(t,this.coders)}}function Tb(n,e){return{address:Ot(n),storageKeys:e.map((t,r)=>(Q(Xt(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function Vh(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(Q(t.length===2,"invalid slot set",`value[${r}]`,t),Tb(t[0],t[1])):(Q(t!=null&&typeof t=="object","invalid address-slot set","value",n),Tb(t.address,t.storageKeys)));Q(n!=null&&typeof n=="object","invalid access list","value",n);const e=Object.keys(n).map(t=>{const r=n[t].reduce((i,s)=>(i[s]=!0,i),{});return Tb(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function s9(n){return{address:Ot(n.address),nonce:He(n.nonce!=null?n.nonce:0),chainId:He(n.chainId!=null?n.chainId:0),signature:Ti.from(n.signature)}}function tle(n){let e;return typeof n=="string"?e=G0.computePublicKey(n,!1):e=n.publicKey,Ot(Hn("0x"+e.substring(4)).substring(26))}function nle(n,e){return tle(G0.recoverPublicKey(n,e))}const ar=BigInt(0),rle=BigInt(2),ile=BigInt(27),sle=BigInt(28),ole=BigInt(35),ale=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),lle=Symbol.for("nodejs.util.inspect.custom"),Ib=4096*32,Kv=128;function cle(n){return{blobToKzgCommitment:r=>{if("computeBlobProof"in n){if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return ht(n.blobToKzgCommitment(Me(r)))}else if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return ht(n.blobToKzgCommitment(r));if("blobToKZGCommitment"in n&&typeof n.blobToKZGCommitment=="function")return ht(n.blobToKZGCommitment(Me(r)));Q(!1,"unsupported KZG library","kzg",n)},computeBlobKzgProof:(r,i)=>{if("computeBlobProof"in n&&typeof n.computeBlobProof=="function")return ht(n.computeBlobProof(Me(r),Me(i)));if("computeBlobKzgProof"in n&&typeof n.computeBlobKzgProof=="function")return n.computeBlobKzgProof(r,i);if("computeBlobKZGProof"in n&&typeof n.computeBlobKZGProof=="function")return ht(n.computeBlobKZGProof(Me(r),Me(i)));Q(!1,"unsupported KZG library","kzg",n)}}}function xO(n,e){let t=n.toString(16);for(;t.length<2;)t="0"+t;return t+=rg(e).substring(4),"0x"+t}function ig(n){return n==="0x"?null:Ot(n)}function qT(n,e){try{return Vh(n)}catch(t){Q(!1,t.message,e,n)}}function ule(n,e){try{if(!Array.isArray(n))throw new Error("authorizationList: invalid array");const t=[];for(let r=0;r<n.length;r++){const i=n[r];if(!Array.isArray(i))throw new Error(`authorization[${r}]: invalid array`);if(i.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!i[1])throw new Error(`authorization[${r}]: null address`);t.push({address:ig(i[1]),nonce:jt(i[2],"nonce"),chainId:jt(i[0],"chainId"),signature:Ti.from({yParity:Fh(i[3],"yParity"),r:yl(i[4],32),s:yl(i[5],32)})})}return t}catch(t){Q(!1,t.message,e,n)}}function Fh(n,e){return n==="0x"?0:ut(n,e)}function jt(n,e){if(n==="0x")return ar;const t=He(n,e);return Q(t<=ale,"value exceeds uint size",e,t),t}function At(n,e){const t=He(n,"value"),r=jn(t);return Q(r.length<=32,"value too large",`tx.${e}`,t),r}function zT(n){return Vh(n).map(e=>[e.address,e.storageKeys])}function dle(n){return n.map(e=>[At(e.chainId,"chainId"),e.address,At(e.nonce,"nonce"),At(e.signature.yParity,"yParity"),jn(e.signature.r),jn(e.signature._s)])}function hle(n,e){Q(Array.isArray(n),`invalid ${e}`,"value",n);for(let t=0;t<n.length;t++)Q(Xt(n[t],32),"invalid ${ param } hash",`value[${t}]`,n[t]);return n}function fle(n){const e=$w(n);Q(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",n);const t={type:0,nonce:Fh(e[0],"nonce"),gasPrice:jt(e[1],"gasPrice"),gasLimit:jt(e[2],"gasLimit"),to:ig(e[3]),value:jt(e[4],"value"),data:Me(e[5]),chainId:ar};if(e.length===6)return t;const r=jt(e[6],"v"),i=jt(e[7],"r"),s=jt(e[8],"s");if(i===ar&&s===ar)t.chainId=r;else{let o=(r-ole)/rle;o<ar&&(o=ar),t.chainId=o,Q(o!==ar||r===ile||r===sle,"non-canonical legacy v","v",e[6]),t.signature=Ti.from({r:yl(e[7],32),s:yl(e[8],32),v:r})}return t}function ple(n,e){const t=[At(n.nonce,"nonce"),At(n.gasPrice||0,"gasPrice"),At(n.gasLimit,"gasLimit"),n.to||"0x",At(n.value,"value"),n.data];let r=ar;if(n.chainId!=ar)r=He(n.chainId,"tx.chainId"),Q(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(n.signature){const s=n.signature.legacyChainId;s!=null&&(r=s)}if(!e)return r!==ar&&(t.push(jn(r)),t.push("0x"),t.push("0x")),cl(t);let i=BigInt(27+e.yParity);return r!==ar?i=Ti.getChainIdV(r,e.v):BigInt(e.v)!==i&&Q(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(jn(i)),t.push(jn(e.r)),t.push(jn(e._s)),cl(t)}function $T(n,e){let t;try{if(t=Fh(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{Q(!1,"invalid yParity","yParity",e[0])}const r=yl(e[1],32),i=yl(e[2],32),s=Ti.from({r,s:i,yParity:t});n.signature=s}function mle(n){const e=$w(ht(n).slice(1));Q(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Me(n));const t={type:2,chainId:jt(e[0],"chainId"),nonce:Fh(e[1],"nonce"),maxPriorityFeePerGas:jt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:jt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:jt(e[4],"gasLimit"),to:ig(e[5]),value:jt(e[6],"value"),data:Me(e[7]),accessList:qT(e[8],"accessList")};return e.length===9||$T(t,e.slice(9)),t}function gle(n,e){const t=[At(n.chainId,"chainId"),At(n.nonce,"nonce"),At(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),At(n.maxFeePerGas||0,"maxFeePerGas"),At(n.gasLimit,"gasLimit"),n.to||"0x",At(n.value,"value"),n.data,zT(n.accessList||[])];return e&&(t.push(At(e.yParity,"yParity")),t.push(jn(e.r)),t.push(jn(e.s))),mn(["0x02",cl(t)])}function yle(n){const e=$w(ht(n).slice(1));Q(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Me(n));const t={type:1,chainId:jt(e[0],"chainId"),nonce:Fh(e[1],"nonce"),gasPrice:jt(e[2],"gasPrice"),gasLimit:jt(e[3],"gasLimit"),to:ig(e[4]),value:jt(e[5],"value"),data:Me(e[6]),accessList:qT(e[7],"accessList")};return e.length===8||$T(t,e.slice(8)),t}function wle(n,e){const t=[At(n.chainId,"chainId"),At(n.nonce,"nonce"),At(n.gasPrice||0,"gasPrice"),At(n.gasLimit,"gasLimit"),n.to||"0x",At(n.value,"value"),n.data,zT(n.accessList||[])];return e&&(t.push(At(e.yParity,"recoveryParam")),t.push(jn(e.r)),t.push(jn(e.s))),mn(["0x01",cl(t)])}function _le(n){let e=$w(ht(n).slice(1)),t="3",r=null,i=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const o=e[1],a=e[2],c=e[3];Q(Array.isArray(o),"invalid network format: blobs not an array","fields[1]",o),Q(Array.isArray(a),"invalid network format: commitments not an array","fields[2]",a),Q(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),Q(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),Q(o.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let d=0;d<e[1].length;d++)i.push({data:o[d],commitment:a[d],proof:c[d]});e=e[0]}else if(e.length===5&&Array.isArray(e[0])){t="3 (EIP-7594 network format)",r=ut(e[1]);const o=e[2],a=e[3],c=e[4];Q(r===1,`unsupported EIP-7594 network format version: ${r}`,"fields[1]",r),Q(Array.isArray(o),"invalid EIP-7594 network format: blobs not an array","fields[2]",o),Q(Array.isArray(a),"invalid EIP-7594 network format: commitments not an array","fields[3]",a),Q(Array.isArray(c),"invalid EIP-7594 network format: proofs not an array","fields[4]",c),Q(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),Q(o.length*Kv===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let d=0;d<o.length;d++){const h=[];for(let m=0;m<Kv;m++)h.push(c[d*Kv+m]);i.push({data:o[d],commitment:a[d],proof:mn(h)})}e=e[0]}Q(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Me(n));const s={type:3,chainId:jt(e[0],"chainId"),nonce:Fh(e[1],"nonce"),maxPriorityFeePerGas:jt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:jt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:jt(e[4],"gasLimit"),to:ig(e[5]),value:jt(e[6],"value"),data:Me(e[7]),accessList:qT(e[8],"accessList"),maxFeePerBlobGas:jt(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10],blobWrapperVersion:r};i&&(s.blobs=i),Q(s.to!=null,`invalid address for transaction type: ${t}`,"data",n),Q(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",n);for(let o=0;o<s.blobVersionedHashes.length;o++)Q(Xt(s.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",n);return e.length===11||$T(s,e.slice(11)),s}function vle(n,e,t){const r=[At(n.chainId,"chainId"),At(n.nonce,"nonce"),At(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),At(n.maxFeePerGas||0,"maxFeePerGas"),At(n.gasLimit,"gasLimit"),n.to||H0,At(n.value,"value"),n.data,zT(n.accessList||[]),At(n.maxFeePerBlobGas||0,"maxFeePerBlobGas"),hle(n.blobVersionedHashes||[],"blobVersionedHashes")];if(e&&(r.push(At(e.yParity,"yParity")),r.push(jn(e.r)),r.push(jn(e.s)),t)){if(n.blobWrapperVersion!=null){const i=jn(n.blobWrapperVersion),s=[];for(const{proof:o}of t){const a=ht(o),c=a.length/Kv;for(let d=0;d<a.length;d+=c)s.push(a.subarray(d,d+c))}return mn(["0x03",cl([r,i,t.map(o=>o.data),t.map(o=>o.commitment),s])])}return mn(["0x03",cl([r,t.map(i=>i.data),t.map(i=>i.commitment),t.map(i=>i.proof)])])}return mn(["0x03",cl(r)])}function Ele(n){const e=$w(ht(n).slice(1));Q(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",Me(n));const t={type:4,chainId:jt(e[0],"chainId"),nonce:Fh(e[1],"nonce"),maxPriorityFeePerGas:jt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:jt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:jt(e[4],"gasLimit"),to:ig(e[5]),value:jt(e[6],"value"),data:Me(e[7]),accessList:qT(e[8],"accessList"),authorizationList:ule(e[9],"authorizationList")};return e.length===10||$T(t,e.slice(10)),t}function xle(n,e){const t=[At(n.chainId,"chainId"),At(n.nonce,"nonce"),At(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),At(n.maxFeePerGas||0,"maxFeePerGas"),At(n.gasLimit,"gasLimit"),n.to||"0x",At(n.value,"value"),n.data,zT(n.accessList||[]),dle(n.authorizationList||[])];return e&&(t.push(At(e.yParity,"yParity")),t.push(jn(e.r)),t.push(jn(e.s))),mn(["0x04",cl(t)])}var $s,Tp,Ip,Ap,bp,Cp,Sp,Np,kp,Pp,Rp,Dp,Ud,xc,Oo,Tc,Mp,Lp,Op,Qv;const Ro=class Ro{constructor(){se(this,Op);se(this,$s);se(this,Tp);se(this,Ip);se(this,Ap);se(this,bp);se(this,Cp);se(this,Sp);se(this,Np);se(this,kp);se(this,Pp);se(this,Rp);se(this,Dp);se(this,Ud);se(this,xc);se(this,Oo);se(this,Tc);se(this,Mp);se(this,Lp);H(this,$s,null),H(this,Tp,null),H(this,Ap,0),H(this,bp,ar),H(this,Cp,null),H(this,Sp,null),H(this,Np,null),H(this,Ip,"0x"),H(this,kp,ar),H(this,Pp,ar),H(this,Rp,null),H(this,Dp,null),H(this,Ud,null),H(this,xc,null),H(this,Oo,null),H(this,Tc,null),H(this,Mp,null),H(this,Lp,null)}get type(){return S(this,$s)}set type(e){switch(e){case null:H(this,$s,null);break;case 0:case"legacy":H(this,$s,0);break;case 1:case"berlin":case"eip-2930":H(this,$s,1);break;case 2:case"london":case"eip-1559":H(this,$s,2);break;case 3:case"cancun":case"eip-4844":H(this,$s,3);break;case 4:case"pectra":case"eip-7702":H(this,$s,4);break;default:Q(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=S(this,Tp);return e==null&&this.type===3?H0:e}set to(e){H(this,Tp,e==null?null:Ot(e))}get nonce(){return S(this,Ap)}set nonce(e){H(this,Ap,ut(e,"value"))}get gasLimit(){return S(this,bp)}set gasLimit(e){H(this,bp,He(e))}get gasPrice(){const e=S(this,Cp);return e==null&&(this.type===0||this.type===1)?ar:e}set gasPrice(e){H(this,Cp,e==null?null:He(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=S(this,Sp);return e??(this.type===2||this.type===3?ar:null)}set maxPriorityFeePerGas(e){H(this,Sp,e==null?null:He(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=S(this,Np);return e??(this.type===2||this.type===3?ar:null)}set maxFeePerGas(e){H(this,Np,e==null?null:He(e,"maxFeePerGas"))}get data(){return S(this,Ip)}set data(e){H(this,Ip,Me(e))}get value(){return S(this,kp)}set value(e){H(this,kp,He(e,"value"))}get chainId(){return S(this,Pp)}set chainId(e){H(this,Pp,He(e))}get signature(){return S(this,Rp)||null}set signature(e){H(this,Rp,e==null?null:Ti.from(e))}isValid(){const e=this.signature;if(e&&!e.isValid())return!1;const t=this.authorizationList;if(t){for(const r of t)if(!r.signature.isValid())return!1}return!0}get accessList(){const e=S(this,Dp)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){H(this,Dp,e==null?null:Vh(e))}get authorizationList(){const e=S(this,Mp)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){H(this,Mp,e==null?null:e.map(t=>s9(t)))}get maxFeePerBlobGas(){const e=S(this,Ud);return e==null&&this.type===3?ar:e}set maxFeePerBlobGas(e){H(this,Ud,e==null?null:He(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=S(this,xc);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){Q(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)Q(Xt(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}H(this,xc,e)}get blobs(){return S(this,Tc)==null?null:S(this,Tc).map(e=>Object.assign({},e))}set blobs(e){if(e==null){H(this,Tc,null);return}const t=[],r=[];for(let i=0;i<e.length;i++){const s=e[i];if(Lk(s)){he(S(this,Oo),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=ht(s);if(Q(o.length<=Ib,"blob is too large",`blobs[${i}]`,s),o.length!==Ib){const d=new Uint8Array(Ib);d.set(o),o=d}const a=S(this,Oo).blobToKzgCommitment(o),c=Me(S(this,Oo).computeBlobKzgProof(o,a));t.push({data:Me(o),commitment:Me(a),proof:c}),r.push(xO(1,a))}else{const o=Me(s.data),a=Me(s.commitment),c=Me(s.proof);t.push({data:o,commitment:a,proof:c}),r.push(xO(1,a))}}H(this,Tc,t),H(this,xc,r)}get kzg(){return S(this,Oo)}set kzg(e){e==null?H(this,Oo,null):H(this,Oo,cle(e))}get blobWrapperVersion(){return S(this,Lp)}set blobWrapperVersion(e){H(this,Lp,e)}get hash(){return this.signature==null?null:Hn(we(this,Op,Qv).call(this,!0,!1))}get unsignedHash(){return Hn(this.unsignedSerialized)}get from(){return this.signature==null?null:nle(this.unsignedHash,this.signature.getCanonical())}get fromPublicKey(){return this.signature==null?null:G0.recoverPublicKey(this.unsignedHash,this.signature.getCanonical())}isSigned(){return this.signature!=null}get serialized(){return we(this,Op,Qv).call(this,!0,!0)}get unsignedSerialized(){return we(this,Op,Qv).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,i=S(this,Ud)!=null||S(this,xc);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&he(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),he(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),he(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const s=[];return this.type!=null?s.push(this.type):this.authorizationList&&this.authorizationList.length?s.push(4):t?s.push(2):e?(s.push(1),r||s.push(0)):r?(s.push(1),s.push(2)):(i&&this.to||(s.push(0),s.push(1),s.push(2)),s.push(3)),s.sort(),s}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ro.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}[lle](){return this.toString()}toString(){const e=[],t=i=>{let s=this[i];typeof s=="string"&&(s=JSON.stringify(s)),e.push(`${i}: ${s}`)};this.type&&t("type"),t("to"),t("data"),t("nonce"),t("gasLimit"),t("value"),this.chainId!=null&&t("chainId"),this.signature&&(t("from"),e.push(`signature: ${this.signature.toString()}`));const r=this.authorizationList;if(r){const i=[];for(const s of r){const o=[];o.push(`address: ${JSON.stringify(s.address)}`),s.nonce!=null&&o.push(`nonce: ${s.nonce}`),s.chainId!=null&&o.push(`chainId: ${s.chainId}`),s.signature&&o.push(`signature: ${s.signature.toString()}`),i.push(`Authorization { ${o.join(", ")} }`)}e.push(`authorizations: [ ${i.join(", ")} ]`)}return`Transaction { ${e.join(", ")} }`}static from(e){if(e==null)return new Ro;if(typeof e=="string"){const r=ht(e);if(r[0]>=127)return Ro.from(fle(r));switch(r[0]){case 1:return Ro.from(yle(r));case 2:return Ro.from(mle(r));case 3:return Ro.from(_le(r));case 4:return Ro.from(Ele(r))}he(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Ro;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Ti.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobWrapperVersion!=null&&(t.blobWrapperVersion=e.blobWrapperVersion),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(Q(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),Q(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(Q(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),Q(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};$s=new WeakMap,Tp=new WeakMap,Ip=new WeakMap,Ap=new WeakMap,bp=new WeakMap,Cp=new WeakMap,Sp=new WeakMap,Np=new WeakMap,kp=new WeakMap,Pp=new WeakMap,Rp=new WeakMap,Dp=new WeakMap,Ud=new WeakMap,xc=new WeakMap,Oo=new WeakMap,Tc=new WeakMap,Mp=new WeakMap,Lp=new WeakMap,Op=new WeakSet,Qv=function(e,t){he(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return ple(this,r);case 1:return wle(this,r);case 2:return gle(this,r);case 3:return vle(this,r,t?this.blobs:null);case 4:return xle(this,r)}he(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let nx=Ro;function Eh(n){return Hn(ll(n))}var Tle="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const TO=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),IO=4;function Ile(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),i=1,s=[0,1];for(let W=1;W<r;W++)s.push(i+=t());let o=t(),a=e;e+=o;let c=0,d=0;function h(){return c==0&&(d=d<<8|n[e++],c=8),d>>--c&1}const m=31,_=2**m,x=_>>>1,b=x>>1,A=_-1;let N=0;for(let W=0;W<m;W++)N=N<<1|h();let F=[],B=0,O=_;for(;;){let W=Math.floor(((N-B+1)*i-1)/O),$=0,D=r;for(;D-$>1;){let U=$+D>>>1;W<s[U]?D=U:$=U}if($==0)break;F.push($);let k=B+Math.floor(O*s[$]/i),R=B+Math.floor(O*s[$+1]/i)-1;for(;((k^R)&x)==0;)N=N<<1&A|h(),k=k<<1&A,R=R<<1&A|1;for(;k&~R&b;)N=N&x|N<<1&A>>>1|h(),k=k<<1^x,R=(R^x)<<1|x|1;B=k,O=1+R-k}let q=r-4;return F.map(W=>{switch(W-q){case 3:return q+65792+(n[a++]<<16|n[a++]<<8|n[a++]);case 2:return q+256+(n[a++]<<8|n[a++]);case 1:return q+n[a++];default:return W-1}})}function Ale(n){let e=0;return()=>n[e++]}function o9(n){return Ale(Ile(ble(n)))}function ble(n){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((i,s)=>e[i.charCodeAt(0)]=s);let t=n.length,r=new Uint8Array(6*t>>3);for(let i=0,s=0,o=0,a=0;i<t;i++)a=a<<6|e[n.charCodeAt(i)],o+=6,o>=8&&(r[s++]=a>>(o-=8));return r}function Cle(n){return n&1?~n>>1:n>>1}function Sle(n,e){let t=Array(n);for(let r=0,i=0;r<n;r++)t[r]=i+=Cle(e());return t}function j0(n,e=0){let t=[];for(;;){let r=n(),i=n();if(!i)break;e+=r;for(let s=0;s<i;s++)t.push(e+s);e+=i+1}return t}function a9(n){return q0(()=>{let e=j0(n);if(e.length)return e})}function l9(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(Nle(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(kle(t,n))}return e.flat()}function q0(n){let e=[];for(;;){let t=n(e.length);if(!t)break;e.push(t)}return e}function c9(n,e,t){let r=Array(n).fill().map(()=>[]);for(let i=0;i<e;i++)Sle(n,t).forEach((s,o)=>r[o].push(s));return r}function Nle(n,e){let t=1+e(),r=e(),i=q0(e);return c9(i.length,1+n,e).flatMap((o,a)=>{let[c,...d]=o;return Array(i[a]).fill().map((h,m)=>{let _=m*r;return[c+m*t,d.map(x=>x+_)]})})}function kle(n,e){let t=1+e();return c9(t,1+n,e).map(i=>[i[0],i.slice(1)])}function Ple(n){let e=[],t=j0(n);return i(r([]),[]),e;function r(s){let o=n(),a=q0(()=>{let c=j0(n).map(d=>t[d]);if(c.length)return r(c)});return{S:o,B:a,Q:s}}function i({S:s,B:o},a,c){if(!(s&4&&c===a[a.length-1])){s&2&&(c=a[a.length-1]),s&1&&e.push(a);for(let d of o)for(let h of d.Q)i(d,[...a,h],c)}}}function Rle(n){return n.toString(16).toUpperCase().padStart(2,"0")}function u9(n){return`{${Rle(n)}}`}function Dle(n){let e=[];for(let t=0,r=n.length;t<r;){let i=n.codePointAt(t);t+=i<65536?1:2,e.push(i)}return e}function Mm(n){let t=n.length;if(t<4096)return String.fromCodePoint(...n);let r=[];for(let i=0;i<t;)r.push(String.fromCodePoint(...n.slice(i,i+=4096)));return r.join("")}function Mle(n,e){let t=n.length,r=t-e.length;for(let i=0;r==0&&i<t;i++)r=n[i]-e[i];return r}var Lle="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const z0=44032,rx=4352,ix=4449,sx=4519,d9=19,h9=21,Lm=28,ox=h9*Lm,Ole=d9*ox,Vle=z0+Ole,Fle=rx+d9,Ule=ix+h9,Ble=sx+Lm;function Ny(n){return n>>24&255}function f9(n){return n&16777215}let hS,AO,fS,Jv;function Hle(){let n=o9(Lle);hS=new Map(a9(n).flatMap((e,t)=>e.map(r=>[r,t+1<<24]))),AO=new Set(j0(n)),fS=new Map,Jv=new Map;for(let[e,t]of l9(n)){if(!AO.has(e)&&t.length==2){let[r,i]=t,s=Jv.get(r);s||(s=new Map,Jv.set(r,s)),s.set(i,e)}fS.set(e,t.reverse())}}function p9(n){return n>=z0&&n<Vle}function Gle(n,e){if(n>=rx&&n<Fle&&e>=ix&&e<Ule)return z0+(n-rx)*ox+(e-ix)*Lm;if(p9(n)&&e>sx&&e<Ble&&(n-z0)%Lm==0)return n+(e-sx);{let t=Jv.get(n);return t&&(t=t.get(e),t)?t:-1}}function m9(n){hS||Hle();let e=[],t=[],r=!1;function i(s){let o=hS.get(s);o&&(r=!0,s|=o),e.push(s)}for(let s of n)for(;;){if(s<128)e.push(s);else if(p9(s)){let o=s-z0,a=o/ox|0,c=o%ox/Lm|0,d=o%Lm;i(rx+a),i(ix+c),d>0&&i(sx+d)}else{let o=fS.get(s);o?t.push(...o):i(s)}if(!t.length)break;s=t.pop()}if(r&&e.length>1){let s=Ny(e[0]);for(let o=1;o<e.length;o++){let a=Ny(e[o]);if(a==0||s<=a){s=a;continue}let c=o-1;for(;;){let d=e[c+1];if(e[c+1]=e[c],e[c]=d,!c||(s=Ny(e[--c]),s<=a))break}s=Ny(e[o])}}return e}function jle(n){let e=[],t=[],r=-1,i=0;for(let s of n){let o=Ny(s),a=f9(s);if(r==-1)o==0?r=a:e.push(a);else if(i>0&&i>=o)o==0?(e.push(r,...t),t.length=0,r=a):t.push(a),i=o;else{let c=Gle(r,a);c>=0?r=c:i==0&&o==0?(e.push(r),r=a):(t.push(a),i=o)}}return r>=0&&e.push(r,...t),e}function g9(n){return m9(n).map(f9)}function qle(n){return jle(m9(n))}const bO=45,y9=".",w9=65039,_9=1,ax=n=>Array.from(n);function $0(n,e){return n.P.has(e)||n.Q.has(e)}class zle extends Array{get is_emoji(){return!0}}let pS,v9,Cd,mS,E9,ap,Ab,Uf,ad,CO,gS;function zk(){if(pS)return;let n=o9(Tle);const e=()=>j0(n),t=()=>new Set(e()),r=(h,m)=>m.forEach(_=>h.add(_));pS=new Map(l9(n)),v9=t(),Cd=e(),mS=new Set(e().map(h=>Cd[h])),Cd=new Set(Cd),E9=t(),t();let i=a9(n),s=n();const o=()=>{let h=new Set;return e().forEach(m=>r(h,i[m])),r(h,e()),h};ap=q0(h=>{let m=q0(n).map(_=>_+96);if(m.length){let _=h>=s;m[0]-=32,m=Mm(m),_&&(m=`Restricted[${m}]`);let x=o(),b=o(),A=!n();return{N:m,P:x,Q:b,M:A,R:_}}}),Ab=t(),Uf=new Map;let a=e().concat(ax(Ab)).sort((h,m)=>h-m);a.forEach((h,m)=>{let _=n(),x=a[m]=_?a[m-_]:{V:[],M:new Map};x.V.push(h),Ab.has(h)||Uf.set(h,x)});for(let{V:h,M:m}of new Set(Uf.values())){let _=[];for(let b of h){let A=ap.filter(F=>$0(F,b)),N=_.find(({G:F})=>A.some(B=>F.has(B)));N||(N={G:new Set,V:[]},_.push(N)),N.V.push(b),r(N.G,A)}let x=_.flatMap(b=>ax(b.G));for(let{G:b,V:A}of _){let N=new Set(x.filter(F=>!b.has(F)));for(let F of A)m.set(F,N)}}ad=new Set;let c=new Set;const d=h=>ad.has(h)?c.add(h):ad.add(h);for(let h of ap){for(let m of h.P)d(m);for(let m of h.Q)d(m)}for(let h of ad)!Uf.has(h)&&!c.has(h)&&Uf.set(h,_9);r(ad,g9(ad)),CO=Ple(n).map(h=>zle.from(h)).sort(Mle),gS=new Map;for(let h of CO){let m=[gS];for(let _ of h){let x=m.map(b=>{let A=b.get(_);return A||(A=new Map,b.set(_,A)),A});_===w9?m.push(...x):m=x}for(let _ of m)_.V=h}}function $k(n){return(x9(n)?"":`${Wk(WT([n]))} `)+u9(n)}function Wk(n){return`"${n}"`}function $le(n){if(n.length>=4&&n[2]==bO&&n[3]==bO)throw new Error(`invalid label extension: "${Mm(n.slice(0,4))}"`)}function Wle(n){for(let t=n.lastIndexOf(95);t>0;)if(n[--t]!==95)throw new Error("underscore allowed only at start")}function Kle(n){let e=n[0],t=TO.get(e);if(t)throw Xy(`leading ${t}`);let r=n.length,i=-1;for(let s=1;s<r;s++){e=n[s];let o=TO.get(e);if(o){if(i==s)throw Xy(`${t} + ${o}`);i=s+1,t=o}}if(i==r)throw Xy(`trailing ${t}`)}function WT(n,e=1/0,t=u9){let r=[];Qle(n[0])&&r.push(""),n.length>e&&(e>>=1,n=[...n.slice(0,e),8230,...n.slice(-e)]);let i=0,s=n.length;for(let o=0;o<s;o++){let a=n[o];x9(a)&&(r.push(Mm(n.slice(i,o))),r.push(t(a)),i=o+1)}return r.push(Mm(n.slice(i,s))),r.join("")}function Qle(n){return zk(),Cd.has(n)}function x9(n){return zk(),E9.has(n)}function Jle(n){return ece(Yle(n,qle,rce))}function Yle(n,e,t){if(!n)return[];zk();let r=0;return n.split(y9).map(i=>{let s=Dle(i),o={input:s,offset:r};r+=s.length+1;try{let a=o.tokens=nce(s,e,t),c=a.length,d;if(!c)throw new Error("empty label");let h=o.output=a.flat();if(Wle(h),!(o.emoji=c>1||a[0].is_emoji)&&h.every(_=>_<128))$le(h),d="ASCII";else{let _=a.flatMap(x=>x.is_emoji?[]:x);if(!_.length)d="Emoji";else{if(Cd.has(h[0]))throw Xy("leading combining mark");for(let A=1;A<c;A++){let N=a[A];if(!N.is_emoji&&Cd.has(N[0]))throw Xy(`emoji + combining mark: "${Mm(a[A-1])} + ${WT([N[0]])}"`)}Kle(h);let x=ax(new Set(_)),[b]=Zle(x);tce(b,_),Xle(b,x),d=b.N}}o.type=d}catch(a){o.error=a}return o})}function Xle(n,e){let t,r=[];for(let i of e){let s=Uf.get(i);if(s===_9)return;if(s){let o=s.M.get(i);if(t=t?t.filter(a=>o.has(a)):ax(o),!t.length)return}else r.push(i)}if(t){for(let i of t)if(r.every(s=>$0(i,s)))throw new Error(`whole-script confusable: ${n.N}/${i.N}`)}}function Zle(n){let e=ap;for(let t of n){let r=e.filter(i=>$0(i,t));if(!r.length)throw ap.some(i=>$0(i,t))?I9(e[0],t):T9(t);if(e=r,r.length==1)break}return e}function ece(n){return n.map(({input:e,error:t,output:r})=>{if(t){let i=t.message;throw new Error(n.length==1?i:`Invalid label ${Wk(WT(e,63))}: ${i}`)}return Mm(r)}).join(y9)}function T9(n){return new Error(`disallowed character: ${$k(n)}`)}function I9(n,e){let t=$k(e),r=ap.find(i=>i.P.has(e));return r&&(t=`${r.N} ${t}`),new Error(`illegal mixture: ${n.N} + ${t}`)}function Xy(n){return new Error(`illegal placement: ${n}`)}function tce(n,e){for(let t of e)if(!$0(n,t))throw I9(n,t);if(n.M){let t=g9(e);for(let r=1,i=t.length;r<i;r++)if(mS.has(t[r])){let s=r+1;for(let o;s<i&&mS.has(o=t[s]);s++)for(let a=r;a<s;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${$k(o)}`);if(s-r>IO)throw new Error(`excessive non-spacing marks: ${Wk(WT(t.slice(r-1,s)))} (${s-r}/${IO})`);r=s}}}function nce(n,e,t){let r=[],i=[];for(n=n.slice().reverse();n.length;){let s=ice(n);if(s)i.length&&(r.push(e(i)),i=[]),r.push(t(s));else{let o=n.pop();if(ad.has(o))i.push(o);else{let a=pS.get(o);if(a)i.push(...a);else if(!v9.has(o))throw T9(o)}}}return i.length&&r.push(e(i)),r}function rce(n){return n.filter(e=>e!=w9)}function ice(n,e){let t=gS,r,i=n.length;for(;i&&(t=t.get(n[--i]),!!t);){let{V:s}=t;s&&(r=s,n.length=i)}return r}const A9=new Uint8Array(32);A9.fill(0);function SO(n){return Q(n.length!==0,"invalid ENS name; empty component","comp",n),n}function b9(n){const e=ll(sce(n)),t=[];if(n.length===0)return t;let r=0;for(let i=0;i<e.length;i++)e[i]===46&&(t.push(SO(e.slice(r,i))),r=i+1);return Q(r<e.length,"invalid ENS name; empty component","name",n),t.push(SO(e.slice(r))),t}function sce(n){try{if(n.length===0)throw new Error("empty label");return Jle(n)}catch(e){Q(!1,`invalid ENS name (${e.message})`,"name",n)}}function yS(n){Q(typeof n=="string","invalid ENS name; not a string","name",n),Q(n.length,"invalid ENS name (empty label)","name",n);let e=A9;const t=b9(n);for(;t.length;)e=Hn(mn([e,Hn(t.pop())]));return Me(e)}function oce(n,e){const t=e;return Q(t<=255,"DNS encoded label cannot exceed 255","length",t),Me(mn(b9(n).map(r=>{Q(r.length<=t,`label ${JSON.stringify(n)} exceeds ${t} bytes`,"name",n);const i=new Uint8Array(r.length+1);return i.set(r,1),i[0]=i.length-1,i})))+"00"}const C9=new Uint8Array(32);C9.fill(0);const ace=BigInt(-1),S9=BigInt(0),N9=BigInt(1),lce=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function cce(n){const e=ht(n),t=e.length%32;return t?mn([e,C9.slice(t)]):Me(e)}const uce=hu(N9,32),dce=hu(S9,32),NO={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},bb=["name","version","chainId","verifyingContract","salt"];function kO(n){return function(e){return Q(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const hce={name:kO("name"),version:kO("version"),chainId:function(n){const e=He(n,"domain.chainId");return Q(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):Js(e)},verifyingContract:function(n){try{return Ot(n).toLowerCase()}catch{}Q(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){const e=ht(n,"domain.salt");return Q(e.length===32,'invalid domain value "salt"',"domain.salt",n),Me(e)}};function Cb(n){{const e=n.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",r=parseInt(e[2]);Q(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",n);const i=Ad(lce,t?r-1:r),s=t?(i+N9)*ace:S9;return function(o){const a=He(o,"value");return Q(a>=s&&a<=i,`value out-of-bounds for ${n}`,"value",a),hu(t?f8(a,256):a,32)}}}{const e=n.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return Q(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",n),function(r){const i=ht(r);return Q(i.length===t,`invalid length for ${n}`,"value",r),cce(r)}}}switch(n){case"address":return function(e){return yl(Ot(e),32)};case"bool":return function(e){return e?uce:dce};case"bytes":return function(e){return Hn(e)};case"string":return function(e){return Eh(e)}}return null}function PO(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}function Iv(n){const e=n.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:n}}var rw,Wa,Vp,xx,k9;const us=class us{constructor(e){se(this,xx);X(this,"primaryType");se(this,rw);se(this,Wa);se(this,Vp);H(this,Wa,new Map),H(this,Vp,new Map);const t=new Map,r=new Map,i=new Map,s={};Object.keys(e).forEach(c=>{s[c]=e[c].map(({name:d,type:h})=>{let{base:m,index:_}=Iv(h);return m==="int"&&!e.int&&(m="int256"),m==="uint"&&!e.uint&&(m="uint256"),{name:d,type:m+(_||"")}}),t.set(c,new Set),r.set(c,[]),i.set(c,new Set)}),H(this,rw,JSON.stringify(s));for(const c in s){const d=new Set;for(const h of s[c]){Q(!d.has(h.name),`duplicate variable name ${JSON.stringify(h.name)} in ${JSON.stringify(c)}`,"types",e),d.add(h.name);const m=Iv(h.type).base;Q(m!==c,`circular type reference to ${JSON.stringify(m)}`,"types",e),!Cb(m)&&(Q(r.has(m),`unknown type ${JSON.stringify(m)}`,"types",e),r.get(m).push(c),t.get(c).add(m))}}const o=Array.from(r.keys()).filter(c=>r.get(c).length===0);Q(o.length!==0,"missing primary type","types",e),Q(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),Qe(this,{primaryType:o[0]});function a(c,d){Q(!d.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),d.add(c);for(const h of t.get(c))if(r.has(h)){a(h,d);for(const m of d)i.get(m).add(h)}d.delete(c)}a(this.primaryType,new Set);for(const[c,d]of i){const h=Array.from(d);h.sort(),S(this,Wa).set(c,PO(c,s[c])+h.map(m=>PO(m,s[m])).join(""))}}get types(){return JSON.parse(S(this,rw))}getEncoder(e){let t=S(this,Vp).get(e);return t||(t=we(this,xx,k9).call(this,e),S(this,Vp).set(e,t)),t}encodeType(e){const t=S(this,Wa).get(e);return Q(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Hn(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(Cb(e))return r(e,t);const i=Iv(e).array;if(i)return Q(i.count===-1||i.count===t.length,`array length mismatch; expected length ${i.count}`,"value",t),t.map(o=>this._visit(i.prefix,o,r));const s=this.types[e];if(s)return s.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],r),o),{});Q(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new us(e)}static getPrimaryType(e){return us.from(e).primaryType}static hashStruct(e,t,r){return us.from(t).hashStruct(e,r)}static hashDomain(e){const t=[];for(const r in e){if(e[r]==null)continue;const i=NO[r];Q(i,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:i})}return t.sort((r,i)=>bb.indexOf(r.name)-bb.indexOf(i.name)),us.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return mn(["0x1901",us.hashDomain(e),us.from(t).hash(r)])}static hash(e,t,r){return Hn(us.encode(e,t,r))}static async resolveNames(e,t,r,i){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const s={};e.verifyingContract&&!Xt(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");const o=us.from(t);o.visit(r,(a,c)=>(a==="address"&&!Xt(c,20)&&(s[c]="0x"),c));for(const a in s)s[a]=await i(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),r=o.visit(r,(a,c)=>a==="address"&&s[c]?s[c]:c),{domain:e,value:r}}static getPayload(e,t,r){us.hashDomain(e);const i={},s=[];bb.forEach(c=>{const d=e[c];d!=null&&(i[c]=hce[c](d),s.push({name:c,type:NO[c]}))});const o=us.from(t);t=o.types;const a=Object.assign({},t);return Q(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=s,o.encode(r),{types:a,domain:i,primaryType:o.primaryType,message:o.visit(r,(c,d)=>{if(c.match(/^bytes(\d*)/))return Me(ht(d));if(c.match(/^u?int/))return He(d).toString();switch(c){case"address":return d.toLowerCase();case"bool":return!!d;case"string":return Q(typeof d=="string","invalid string","value",d),d}Q(!1,"unsupported type","type",c)})}}};rw=new WeakMap,Wa=new WeakMap,Vp=new WeakMap,xx=new WeakSet,k9=function(e){{const i=Cb(e);if(i)return i}const t=Iv(e).array;if(t){const i=t.prefix,s=this.getEncoder(i);return o=>{Q(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(s);return S(this,Wa).has(i)&&(a=a.map(Hn)),Hn(mn(a))}}const r=this.types[e];if(r){const i=Eh(S(this,Wa).get(e));return s=>{const o=r.map(({name:a,type:c})=>{const d=this.getEncoder(c)(s[a]);return S(this,Wa).has(c)?Hn(d):d});return o.unshift(i),mn(o)}}Q(!1,`unknown type: ${e}`,"type",e)};let lx=us;function ti(n){const e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}const fce="external public payable override",pce=ti(fce.split(" ")),P9="constant external internal payable private public pure view override",mce=ti(P9.split(" ")),R9="constructor error event fallback function receive struct",D9=ti(R9.split(" ")),M9="calldata memory storage payable indexed",gce=ti(M9.split(" ")),yce="tuple returns",wce=[R9,M9,yce,P9].join(" "),_ce=ti(wce.split(" ")),vce={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Ece=new RegExp("^(\\s*)"),xce=new RegExp("^([0-9]+)"),Tce=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),L9=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),O9=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var gr,Ws,iw,wS;const Tx=class Tx{constructor(e){se(this,iw);se(this,gr);se(this,Ws);H(this,gr,0),H(this,Ws,e.slice())}get offset(){return S(this,gr)}get length(){return S(this,Ws).length-S(this,gr)}clone(){return new Tx(S(this,Ws))}reset(){H(this,gr,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=we(this,iw,wS).call(this,S(this,gr)+1,e.match+1);return H(this,gr,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;S(this,gr)<e.match-1;){const r=this.peek().linkNext;t.push(we(this,iw,wS).call(this,S(this,gr)+1,r)),H(this,gr,r)}return H(this,gr,e.match+1),t}peek(){if(S(this,gr)>=S(this,Ws).length)throw new Error("out-of-bounds");return S(this,Ws)[S(this,gr)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Jg(this,gr)._++,e}toString(){const e=[];for(let t=S(this,gr);t<S(this,Ws).length;t++){const r=S(this,Ws)[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};gr=new WeakMap,Ws=new WeakMap,iw=new WeakSet,wS=function(e=0,t=0){return new Tx(S(this,Ws).slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let io=Tx;function Tu(n){const e=[],t=o=>{const a=s<n.length?JSON.stringify(n[s]):"$EOI";throw new Error(`invalid token ${a} at ${s}: ${o}`)};let r=[],i=[],s=0;for(;s<n.length;){let o=n.substring(s),a=o.match(Ece);a&&(s+=a[1].length,o=n.substring(s));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(c);let d=vce[o[0]]||"";if(d){if(c.type=d,c.text=o[0],s++,d==="OPEN_PAREN")r.push(e.length-1),i.push(e.length-1);else if(d=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1;else if(d==="COMMA")c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1,i.push(e.length-1);else if(d==="OPEN_BRACKET")c.type="BRACKET";else if(d==="CLOSE_BRACKET"){let h=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const m=e.pop().text;h=m+h,e[e.length-1].value=ut(m)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=h}continue}if(a=o.match(Tce),a){if(c.text=a[1],s+=c.text.length,_ce.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(O9)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(xce),a){c.text=a[1],c.type="NUMBER",s+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${s}`)}return new io(e.map(o=>Object.freeze(o)))}function RO(n,e){let t=[];for(const r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function KT(n,e){if(e.peekKeyword(D9)){const t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function wl(n,e){const t=new Set;for(;;){const r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function V9(n){let e=wl(n,mce);return RO(e,ti("constant payable nonpayable".split(" "))),RO(e,ti("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function ul(n,e){return n.popParams().map(t=>Tr.from(t,e))}function F9(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return He(n.pop().text);throw new Error("invalid gas")}return null}function xh(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}const Ice=new RegExp(/^(.*)\[([0-9]*)\]$/);function DO(n){const e=n.match(O9);if(Q(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){const t=parseInt(e[2]);Q(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){const t=parseInt(e[3]);Q(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}const En={},Ai=Symbol.for("_ethers_internal"),MO="_ParamTypeInternal",LO="_ErrorInternal",OO="_EventInternal",VO="_ConstructorInternal",FO="_FallbackInternal",UO="_FunctionInternal",BO="_StructInternal";var Fp,Yv;const ds=class ds{constructor(e,t,r,i,s,o,a,c){se(this,Fp);X(this,"name");X(this,"type");X(this,"baseType");X(this,"indexed");X(this,"components");X(this,"arrayLength");X(this,"arrayChildren");if(qw(e,En,"ParamType"),Object.defineProperty(this,Ai,{value:MO}),o&&(o=Object.freeze(o.slice())),i==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(i==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");Qe(this,{name:t,type:r,baseType:i,indexed:s,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const s=JSON.parse(this.arrayChildren.format("json"));return s.name=r,s.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(s)}const i={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(i)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(i=>r.arrayChildren.walk(i,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((i,s)=>r.components[s].walk(i,t))}return t(this.type,e)}async walkAsync(e,t){const r=[],i=[e];return we(this,Fp,Yv).call(this,r,e,t,s=>{i[0]=s}),r.length&&await Promise.all(r),i[0]}static from(e,t){if(ds.isParamType(e))return e;if(typeof e=="string")try{return ds.from(Tu(e),t)}catch{Q(!1,"invalid param type","obj",e)}else if(e instanceof io){let a="",c="",d=null;wl(e,ti(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",d=e.popParams().map(A=>ds.from(A)),a=`tuple(${d.map(A=>A.format()).join(",")})`):(a=DO(e.popType("TYPE")),c=a);let h=null,m=null;for(;e.length&&e.peekType("BRACKET");){const A=e.pop();h=new ds(En,"",a,c,null,d,m,h),m=A.value,a+=A.text,c="array",d=null}let _=null;if(wl(e,gce).has("indexed")){if(!t)throw new Error("");_=!0}const b=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new ds(En,b,a,c,_,d,m,h)}const r=e.name;Q(!r||typeof r=="string"&&r.match(L9),"invalid name","obj.name",r);let i=e.indexed;i!=null&&(Q(t,"parameter cannot be indexed","obj.indexed",e.indexed),i=!!i);let s=e.type,o=s.match(Ice);if(o){const a=parseInt(o[2]||"-1"),c=ds.from({type:o[1],components:e.components});return new ds(En,r||"",s,"array",i,null,a,c)}if(s==="tuple"||s.startsWith("tuple(")||s.startsWith("(")){const a=e.components!=null?e.components.map(d=>ds.from(d)):null;return new ds(En,r||"",s,"tuple",i,a,null,null)}return s=DO(e.type),new ds(En,r||"",s,s,i,null,null,null)}static isParamType(e){return e&&e[Ai]===MO}};Fp=new WeakSet,Yv=function(e,t,r,i){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,d)=>{var h;we(h=o,Fp,Yv).call(h,e,c,r,m=>{a[d]=m})}),i(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,d)=>{var h;we(h=o[d],Fp,Yv).call(h,e,c,r,m=>{a[d]=m})}),i(a);return}const s=r(this.type,t);s.then?e.push((async function(){i(await s)})()):i(s)};let Tr=ds;class Th{constructor(e,t,r){X(this,"type");X(this,"inputs");qw(e,En,"Fragment"),r=Object.freeze(r.slice()),Qe(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{Th.from(JSON.parse(e))}catch{}return Th.from(Tu(e))}if(e instanceof io)switch(e.peekKeyword(D9)){case"constructor":return il.from(e);case"error":return yi.from(e);case"event":return Ko.from(e);case"fallback":case"receive":return Ga.from(e);case"function":return Qo.from(e);case"struct":return Zd.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return il.from(e);case"error":return yi.from(e);case"event":return Ko.from(e);case"fallback":case"receive":return Ga.from(e);case"function":return Qo.from(e);case"struct":return Zd.from(e)}he(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}Q(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return il.isFragment(e)}static isError(e){return yi.isFragment(e)}static isEvent(e){return Ko.isFragment(e)}static isFunction(e){return Qo.isFragment(e)}static isStruct(e){return Zd.isFragment(e)}}class QT extends Th{constructor(t,r,i,s){super(t,r,s);X(this,"name");Q(typeof i=="string"&&i.match(L9),"invalid identifier","name",i),s=Object.freeze(s.slice()),Qe(this,{name:i})}}function W0(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}class yi extends QT{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,Ai,{value:LO})}get selector(){return Eh(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+W0(e,this.inputs)),t.join(" ")}static from(e){if(yi.isFragment(e))return e;if(typeof e=="string")return yi.from(Tu(e));if(e instanceof io){const t=KT("error",e),r=ul(e);return xh(e),new yi(En,t,r)}return new yi(En,e.name,e.inputs?e.inputs.map(Tr.from):[])}static isFragment(e){return e&&e[Ai]===LO}}class Ko extends QT{constructor(t,r,i,s){super(t,"event",r,i);X(this,"anonymous");Object.defineProperty(this,Ai,{value:OO}),Qe(this,{anonymous:s})}get topicHash(){return Eh(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const r=[];return t!=="sighash"&&r.push("event"),r.push(this.name+W0(t,this.inputs)),t!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(t,r){return r=(r||[]).map(s=>Tr.from(s)),new Ko(En,t,r,!1).topicHash}static from(t){if(Ko.isFragment(t))return t;if(typeof t=="string")try{return Ko.from(Tu(t))}catch{Q(!1,"invalid event fragment","obj",t)}else if(t instanceof io){const r=KT("event",t),i=ul(t,!0),s=!!wl(t,ti(["anonymous"])).has("anonymous");return xh(t),new Ko(En,r,i,s)}return new Ko(En,t.name,t.inputs?t.inputs.map(r=>Tr.from(r,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Ai]===OO}}class il extends Th{constructor(t,r,i,s,o){super(t,r,i);X(this,"payable");X(this,"gas");Object.defineProperty(this,Ai,{value:VO}),Qe(this,{payable:s,gas:o})}format(t){if(he(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const r=[`constructor${W0(t,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(t){if(il.isFragment(t))return t;if(typeof t=="string")try{return il.from(Tu(t))}catch{Q(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof io){wl(t,ti(["constructor"]));const r=ul(t),i=!!wl(t,pce).has("payable"),s=F9(t);return xh(t),new il(En,"constructor",r,i,s)}return new il(En,"constructor",t.inputs?t.inputs.map(Tr.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ai]===VO}}class Ga extends Th{constructor(t,r,i){super(t,"fallback",r);X(this,"payable");Object.defineProperty(this,Ai,{value:FO}),Qe(this,{payable:i})}format(t){const r=this.inputs.length===0?"receive":"fallback";if(t==="json"){const i=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:i})}return`${r}()${this.payable?" payable":""}`}static from(t){if(Ga.isFragment(t))return t;if(typeof t=="string")try{return Ga.from(Tu(t))}catch{Q(!1,"invalid fallback fragment","obj",t)}else if(t instanceof io){const r=t.toString(),i=t.peekKeyword(ti(["fallback","receive"]));if(Q(i,"type must be fallback or receive","obj",r),t.popKeyword(ti(["fallback","receive"]))==="receive"){const c=ul(t);return Q(c.length===0,"receive cannot have arguments","obj.inputs",c),wl(t,ti(["payable"])),xh(t),new Ga(En,[],!0)}let o=ul(t);o.length?Q(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[Tr.from("bytes")];const a=V9(t);if(Q(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),wl(t,ti(["returns"])).has("returns")){const c=ul(t);Q(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(d=>d.format("minimal")).join(", "))}return xh(t),new Ga(En,o,a==="payable")}if(t.type==="receive")return new Ga(En,[],!0);if(t.type==="fallback"){const r=[Tr.from("bytes")],i=t.stateMutability==="payable";return new Ga(En,r,i)}Q(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Ai]===FO}}class Qo extends QT{constructor(t,r,i,s,o,a){super(t,"function",r,s);X(this,"constant");X(this,"outputs");X(this,"stateMutability");X(this,"payable");X(this,"gas");Object.defineProperty(this,Ai,{value:UO}),o=Object.freeze(o.slice()),Qe(this,{constant:i==="view"||i==="pure",gas:a,outputs:o,payable:i==="payable",stateMutability:i})}get selector(){return Eh(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t))),outputs:this.outputs.map(i=>JSON.parse(i.format(t)))});const r=[];return t!=="sighash"&&r.push("function"),r.push(this.name+W0(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(W0(t,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(t,r){return r=(r||[]).map(s=>Tr.from(s)),new Qo(En,t,"view",r,[],null).selector}static from(t){if(Qo.isFragment(t))return t;if(typeof t=="string")try{return Qo.from(Tu(t))}catch{Q(!1,"invalid function fragment","obj",t)}else if(t instanceof io){const i=KT("function",t),s=ul(t),o=V9(t);let a=[];wl(t,ti(["returns"])).has("returns")&&(a=ul(t));const c=F9(t);return xh(t),new Qo(En,i,o,s,a,c)}let r=t.stateMutability;return r==null&&(r="payable",typeof t.constant=="boolean"?(r="view",t.constant||(r="payable",typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable")),new Qo(En,t.name,r,t.inputs?t.inputs.map(Tr.from):[],t.outputs?t.outputs.map(Tr.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ai]===UO}}class Zd extends QT{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,Ai,{value:BO})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Zd.from(Tu(e))}catch{Q(!1,"invalid struct fragment","obj",e)}else if(e instanceof io){const t=KT("struct",e),r=ul(e);return xh(e),new Zd(En,t,r)}return new Zd(En,e.name,e.inputs?e.inputs.map(Tr.from):[])}static isFragment(e){return e&&e[Ai]===BO}}const ao=new Map;ao.set(0,"GENERIC_PANIC");ao.set(1,"ASSERT_FALSE");ao.set(17,"OVERFLOW");ao.set(18,"DIVIDE_BY_ZERO");ao.set(33,"ENUM_RANGE_ERROR");ao.set(34,"BAD_STORAGE_DATA");ao.set(49,"STACK_UNDERFLOW");ao.set(50,"ARRAY_RANGE_ERROR");ao.set(65,"OUT_OF_MEMORY");ao.set(81,"UNINITIALIZED_FUNCTION_CALL");const Ace=new RegExp(/^bytes([0-9]*)$/),bce=new RegExp(/^(u?int)([0-9]*)$/);let Sb=null,HO=1024;function Cce(n,e,t,r){let i="missing revert data",s=null;const o=null;let a=null;if(t){i="execution reverted";const d=ht(t);if(t=Me(t),d.length===0)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(d.length%32!==4)i+=" (could not decode reason; invalid data length)";else if(Me(d.slice(0,4))==="0x08c379a0")try{s=r.decode(["string"],d.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch{i+=" (could not decode reason; invalid string data)"}else if(Me(d.slice(0,4))==="0x4e487b71")try{const h=Number(r.decode(["uint256"],d.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[h]},s=`Panic due to ${ao.get(h)||"UNKNOWN"}(${h})`,i+=`: ${s}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const c={to:e.to?Ot(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Ot(e.from)),un(i,"CALL_EXCEPTION",{action:n,data:t,reason:s,transaction:c,invocation:o,revert:a})}var Ic,Bf;const Ix=class Ix{constructor(){se(this,Ic)}getDefaultValue(e){const t=e.map(i=>we(this,Ic,Bf).call(this,Tr.from(i)));return new Tv(t,"_").defaultValue()}encode(e,t){u8(t.length,e.length,"types/values length mismatch");const r=e.map(o=>we(this,Ic,Bf).call(this,Tr.from(o))),i=new Tv(r,"_"),s=new rS;return i.encode(s,t),s.data}decode(e,t,r){const i=e.map(o=>we(this,Ic,Bf).call(this,Tr.from(o)));return new Tv(i,"_").decode(new iS(t,r,HO))}static _setDefaultMaxInflation(e){Q(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),HO=e}static defaultAbiCoder(){return Sb==null&&(Sb=new Ix),Sb}static getBuiltinCallException(e,t,r){return Cce(e,t,r,Ix.defaultAbiCoder())}};Ic=new WeakSet,Bf=function(e){if(e.isArray())return new qae(we(this,Ic,Bf).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Tv(e.components.map(r=>we(this,Ic,Bf).call(this,r)),e.name);switch(e.baseType){case"address":return new Gae(e.name);case"bool":return new zae(e.name);case"string":return new ele(e.name);case"bytes":return new $ae(e.name);case"":return new Qae(e.name)}let t=e.type.match(bce);if(t){let r=parseInt(t[2]||"256");return Q(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new Zae(r/8,t[1]==="int",e.name)}if(t=e.type.match(Ace),t){let r=parseInt(t[1]);return Q(r!==0&&r<=32,"invalid bytes length","param",e),new Wae(r,e.name)}Q(!1,"invalid type","type",e.type)};let K0=Ix;class Sce{constructor(e,t,r){X(this,"fragment");X(this,"name");X(this,"signature");X(this,"topic");X(this,"args");const i=e.name,s=e.format();Qe(this,{fragment:e,name:i,signature:s,topic:t,args:r})}}class Nce{constructor(e,t,r,i){X(this,"fragment");X(this,"name");X(this,"args");X(this,"signature");X(this,"selector");X(this,"value");const s=e.name,o=e.format();Qe(this,{fragment:e,name:s,args:r,signature:o,selector:t,value:i})}}class kce{constructor(e,t,r){X(this,"fragment");X(this,"name");X(this,"args");X(this,"signature");X(this,"selector");const i=e.name,s=e.format();Qe(this,{fragment:e,name:i,args:r,signature:s,selector:t})}}class GO{constructor(e){X(this,"hash");X(this,"_isIndexed");Qe(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const jO={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},qO={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&jO[n.toString()]&&(e=jO[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}};var Vo,Fo,Uo,Pr,ua,Xv,Zv;const gd=class gd{constructor(e){se(this,ua);X(this,"fragments");X(this,"deploy");X(this,"fallback");X(this,"receive");se(this,Vo);se(this,Fo);se(this,Uo);se(this,Pr);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,H(this,Uo,new Map),H(this,Vo,new Map),H(this,Fo,new Map);const r=[];for(const o of t)try{r.push(Th.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}Qe(this,{fragments:Object.freeze(r)});let i=null,s=!1;H(this,Pr,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Qe(this,{deploy:o});return;case"fallback":o.inputs.length===0?s=!0:(Q(!i||o.payable!==i.payable,"conflicting fallback fragments",`fragments[${a}]`,o),i=o,s=i.payable);return;case"function":c=S(this,Uo);break;case"event":c=S(this,Fo);break;case"error":c=S(this,Vo);break;default:return}const d=o.format();c.has(d)||c.set(d,o)}),this.deploy||Qe(this,{deploy:il.from("constructor()")}),Qe(this,{fallback:i,receive:s})}format(e){const t=e?"minimal":"full";return this.fragments.map(i=>i.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return K0.defaultAbiCoder()}getFunctionName(e){const t=we(this,ua,Xv).call(this,e,null,!1);return Q(t,"no matching function","key",e),t.name}hasFunction(e){return!!we(this,ua,Xv).call(this,e,null,!1)}getFunction(e,t){return we(this,ua,Xv).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(S(this,Uo).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(S(this,Uo).get(i),r)}}getEventName(e){const t=we(this,ua,Zv).call(this,e,null,!1);return Q(t,"no matching event","key",e),t.name}hasEvent(e){return!!we(this,ua,Zv).call(this,e,null,!1)}getEvent(e,t){return we(this,ua,Zv).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(S(this,Fo).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(S(this,Fo).get(i),r)}}getError(e,t){if(Xt(e)){const i=e.toLowerCase();if(qO[i])return yi.from(qO[i].signature);for(const s of S(this,Vo).values())if(i===s.selector)return s;return null}if(e.indexOf("(")===-1){const i=[];for(const[s,o]of S(this,Vo))s.split("(")[0]===e&&i.push(o);if(i.length===0)return e==="Error"?yi.from("error Error(string)"):e==="Panic"?yi.from("error Panic(uint256)"):null;if(i.length>1){const s=i.map(o=>JSON.stringify(o.format())).join(", ");Q(!1,`ambiguous error description (i.e. ${s})`,"name",e)}return i[0]}if(e=yi.from(e).format(),e==="Error(string)")return yi.from("error Error(string)");if(e==="Panic(uint256)")return yi.from("error Panic(uint256)");const r=S(this,Vo).get(e);return r||null}forEachError(e){const t=Array.from(S(this,Vo).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(S(this,Vo).get(i),r)}}_decodeParams(e,t){return S(this,Pr).decode(e,t)}_encodeParams(e,t){return S(this,Pr).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);Q(r,"unknown error","fragment",e),e=r}return Q(An(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,An(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);Q(r,"unknown error","fragment",e),e=r}return mn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);Q(r,"unknown function","fragment",e),e=r}return Q(An(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,An(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);Q(r,"unknown function","fragment",e),e=r}return mn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const s=this.getFunction(e);Q(s,"unknown function","fragment",e),e=s}let r="invalid length for result data";const i=Yr(t);if(i.length%32===0)try{return S(this,Pr).decode(e.outputs,i)}catch{r="could not decode result data"}he(!1,r,"BAD_DATA",{value:Me(i),info:{method:e.name,signature:e.format()}})}makeError(e,t){const r=ht(e,"data"),i=K0.getBuiltinCallException("call",t,r);if(i.message.startsWith("execution reverted (unknown custom error)")){const a=Me(r.slice(0,4)),c=this.getError(a);if(c)try{const d=S(this,Pr).decode(c.inputs,r.slice(4));i.revert={name:c.name,signature:c.format(),args:d},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch{i.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(i.invocation={method:o.name,signature:o.signature,args:o.args}),i}encodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);Q(r,"unknown function","fragment",e),e=r}return Me(S(this,Pr).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const s=this.getEvent(e);Q(s,"unknown event","eventFragment",e),e=s}he(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const i=(s,o)=>s.type==="string"?Eh(o):s.type==="bytes"?Hn(Me(o)):(s.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":s.type.match(/^u?int/)?o=hu(o):s.type.match(/^bytes/)?o=Gse(o,32):s.type==="address"&&S(this,Pr).encode(["address"],[o]),yl(Me(o),32));for(t.forEach((s,o)=>{const a=e.inputs[o];if(!a.indexed){Q(s==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,s);return}s==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?Q(!1,"filtering with tuples or arrays not supported","contract."+a.name,s):Array.isArray(s)?r.push(s.map(c=>i(a,c))):r.push(i(a,s))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);Q(o,"unknown event","eventFragment",e),e=o}const r=[],i=[],s=[];return e.anonymous||r.push(e.topicHash),Q(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")r.push(Eh(c));else if(o.type==="bytes")r.push(Hn(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(S(this,Pr).encode([o.type],[c]))}else i.push(o),s.push(c)}),{data:S(this,Pr).encode(i,s),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){const x=this.getEvent(e);Q(x,"unknown event","eventFragment",e),e=x}if(r!=null&&!e.anonymous){const x=e.topicHash;Q(Xt(r[0],32)&&r[0].toLowerCase()===x,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const i=[],s=[],o=[];e.inputs.forEach((x,b)=>{x.indexed?x.type==="string"||x.type==="bytes"||x.baseType==="tuple"||x.baseType==="array"?(i.push(Tr.from({type:"bytes32",name:x.name})),o.push(!0)):(i.push(x),o.push(!1)):(s.push(x),o.push(!1))});const a=r!=null?S(this,Pr).decode(i,mn(r)):null,c=S(this,Pr).decode(s,t,!0),d=[],h=[];let m=0,_=0;return e.inputs.forEach((x,b)=>{let A=null;if(x.indexed)if(a==null)A=new GO(null);else if(o[b])A=new GO(a[_++]);else try{A=a[_++]}catch(N){A=N}else try{A=c[m++]}catch(N){A=N}d.push(A),h.push(x.name||null)}),Nm.fromItems(d,h)}parseTransaction(e){const t=ht(e.data,"tx.data"),r=He(e.value!=null?e.value:0,"tx.value"),i=this.getFunction(Me(t.slice(0,4)));if(!i)return null;const s=S(this,Pr).decode(i.inputs,t.slice(4));return new Nce(i,i.selector,s,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Sce(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Me(e),r=this.getError(An(t,0,4));if(!r)return null;const i=S(this,Pr).decode(r.inputs,An(t,4));return new kce(r,r.selector,i)}static from(e){return e instanceof gd?e:typeof e=="string"?new gd(JSON.parse(e)):typeof e.formatJson=="function"?new gd(e.formatJson()):typeof e.format=="function"?new gd(e.format("json")):new gd(e)}};Vo=new WeakMap,Fo=new WeakMap,Uo=new WeakMap,Pr=new WeakMap,ua=new WeakSet,Xv=function(e,t,r){if(Xt(e)){const s=e.toLowerCase();for(const o of S(this,Uo).values())if(s===o.selector)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of S(this,Uo))o.split("(")[0]===e&&s.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;Br.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let d=s.length-1;d>=0;d--){const h=s[d].inputs.length;h!==a&&(!c||h!==a-1)&&s.splice(d,1)}for(let d=s.length-1;d>=0;d--){const h=s[d].inputs;for(let m=0;m<t.length;m++)if(Br.isTyped(t[m])){if(m>=h.length){if(t[m].type==="overrides")continue;s.splice(d,1);break}if(t[m].type!==h[m].baseType){s.splice(d,1);break}}}}if(s.length===1&&t&&t.length!==s[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&s.splice(0,1)}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");Q(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return s[0]}const i=S(this,Uo).get(Qo.from(e).format());return i||null},Zv=function(e,t,r){if(Xt(e)){const s=e.toLowerCase();for(const o of S(this,Fo).values())if(s===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of S(this,Fo))o.split("(")[0]===e&&s.push(a);if(t){for(let o=s.length-1;o>=0;o--)s[o].inputs.length<t.length&&s.splice(o,1);for(let o=s.length-1;o>=0;o--){const a=s[o].inputs;for(let c=0;c<t.length;c++)if(Br.isTyped(t[c])&&t[c].type!==a[c].baseType){s.splice(o,1);break}}}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");Q(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return s[0]}const i=S(this,Fo).get(Ko.from(e).format());return i||null};let _S=gd;const U9=BigInt(0);function lp(n){return n??null}function Pn(n){return n==null?null:n.toString()}class zO{constructor(e,t,r){X(this,"gasPrice");X(this,"maxFeePerGas");X(this,"maxPriorityFeePerGas");Qe(this,{gasPrice:lp(e),maxFeePerGas:lp(t),maxPriorityFeePerGas:lp(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:Pn(e),maxFeePerGas:Pn(t),maxPriorityFeePerGas:Pn(r)}}}function cx(n){const e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=Me(n.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of t)!(i in n)||n[i]==null||(e[i]=He(n[i],`request.${i}`));const r="type,nonce".split(/,/);for(const i of r)!(i in n)||n[i]==null||(e[i]=ut(n[i],`request.${i}`));return n.accessList&&(e.accessList=Vh(n.accessList)),n.authorizationList&&(e.authorizationList=n.authorizationList.slice()),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobWrapperVersion"in n&&(e.blobWrapperVersion=n.blobWrapperVersion),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(i=>Lk(i)?Me(i):Object.assign({},i))),e}var Ka;class Pce{constructor(e,t){X(this,"provider");X(this,"number");X(this,"hash");X(this,"timestamp");X(this,"parentHash");X(this,"parentBeaconBlockRoot");X(this,"nonce");X(this,"difficulty");X(this,"gasLimit");X(this,"gasUsed");X(this,"stateRoot");X(this,"receiptsRoot");X(this,"blobGasUsed");X(this,"excessBlobGas");X(this,"miner");X(this,"prevRandao");X(this,"extraData");X(this,"baseFeePerGas");se(this,Ka);H(this,Ka,e.transactions.map(r=>typeof r!="string"?new Q0(r,t):r)),Qe(this,{provider:t,hash:lp(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:lp(e.prevRandao),extraData:e.extraData,baseFeePerGas:lp(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return S(this,Ka).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=S(this,Ka).slice();return e.length===0?[]:(he(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:r,gasLimit:i,gasUsed:s,hash:o,miner:a,prevRandao:c,nonce:d,number:h,parentHash:m,parentBeaconBlockRoot:_,stateRoot:x,receiptsRoot:b,timestamp:A,transactions:N}=this;return{_type:"Block",baseFeePerGas:Pn(e),difficulty:Pn(t),extraData:r,gasLimit:Pn(i),gasUsed:Pn(s),blobGasUsed:Pn(this.blobGasUsed),excessBlobGas:Pn(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:d,number:h,parentHash:m,timestamp:A,parentBeaconBlockRoot:_,stateRoot:x,receiptsRoot:b,transactions:N}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return S(this,Ka).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=S(this,Ka)[e];else{const r=e.toLowerCase();for(const i of S(this,Ka))if(typeof i=="string"){if(i!==r)continue;t=i;break}else{if(i.hash!==r)continue;t=i;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const r of t)if(r.hash===e)return r;Q(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return Rce(this)}}Ka=new WeakMap;class Kw{constructor(e,t){X(this,"provider");X(this,"transactionHash");X(this,"blockHash");X(this,"blockNumber");X(this,"removed");X(this,"address");X(this,"data");X(this,"topics");X(this,"index");X(this,"transactionIndex");this.provider=t;const r=Object.freeze(e.topics.slice());Qe(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return he(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return he(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return he(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return Dce(this)}}var sw;class B9{constructor(e,t){X(this,"provider");X(this,"to");X(this,"from");X(this,"contractAddress");X(this,"hash");X(this,"index");X(this,"blockHash");X(this,"blockNumber");X(this,"logsBloom");X(this,"gasUsed");X(this,"blobGasUsed");X(this,"cumulativeGasUsed");X(this,"gasPrice");X(this,"blobGasPrice");X(this,"type");X(this,"status");X(this,"root");se(this,sw);H(this,sw,Object.freeze(e.logs.map(i=>new Kw(i,t))));let r=U9;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),Qe(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return S(this,sw)}toJSON(){const{to:e,from:t,contractAddress:r,hash:i,index:s,blockHash:o,blockNumber:a,logsBloom:c,logs:d,status:h,root:m}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:Pn(this.cumulativeGasUsed),from:t,gasPrice:Pn(this.gasPrice),blobGasUsed:Pn(this.blobGasUsed),blobGasPrice:Pn(this.blobGasPrice),gasUsed:Pn(this.gasUsed),hash:i,index:s,logs:d,logsBloom:c,root:m,status:h,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return G9(this)}reorderedEvent(e){return he(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),H9(this,e)}}sw=new WeakMap;var Ac;const wP=class wP{constructor(e,t){X(this,"provider");X(this,"blockNumber");X(this,"blockHash");X(this,"index");X(this,"hash");X(this,"type");X(this,"to");X(this,"from");X(this,"nonce");X(this,"gasLimit");X(this,"gasPrice");X(this,"maxPriorityFeePerGas");X(this,"maxFeePerGas");X(this,"maxFeePerBlobGas");X(this,"data");X(this,"value");X(this,"chainId");X(this,"signature");X(this,"accessList");X(this,"blobVersionedHashes");X(this,"authorizationList");se(this,Ac);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,H(this,Ac,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:r,hash:i,type:s,to:o,from:a,nonce:c,data:d,signature:h,accessList:m,blobVersionedHashes:_}=this;return{_type:"TransactionResponse",accessList:m,blockNumber:e,blockHash:t,blobVersionedHashes:_,chainId:Pn(this.chainId),data:d,from:a,gasLimit:Pn(this.gasLimit),gasPrice:Pn(this.gasPrice),hash:i,maxFeePerGas:Pn(this.maxFeePerGas),maxPriorityFeePerGas:Pn(this.maxPriorityFeePerGas),maxFeePerBlobGas:Pn(this.maxFeePerBlobGas),nonce:c,signature:h,to:o,index:r,type:s,value:Pn(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:r}=await Qr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const r=e??1,i=t??0;let s=S(this,Ac),o=-1,a=s===-1;const c=async()=>{if(a)return null;const{blockNumber:_,nonce:x}=await Qr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(x<this.nonce){s=_;return}if(a)return null;const b=await this.getTransaction();if(!(b&&b.blockNumber!=null))for(o===-1&&(o=s-3,o<S(this,Ac)&&(o=S(this,Ac)));o<=_;){if(a)return null;const A=await this.provider.getBlock(o,!0);if(A==null)return;for(const N of A)if(N===this.hash)return;for(let N=0;N<A.length;N++){const F=await A.getTransaction(N);if(F.from===this.from&&F.nonce===this.nonce){if(a)return null;const B=await this.provider.getTransactionReceipt(F.hash);if(B==null||_-B.blockNumber+1<r)return;let O="replaced";F.data===this.data&&F.to===this.to&&F.value===this.value?O="repriced":F.data==="0x"&&F.from===F.to&&F.value===U9&&(O="cancelled"),he(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:O==="replaced"||O==="cancelled",reason:O,replacement:F.replaceableTransaction(s),hash:F.hash,receipt:B})}}o++}},d=_=>{if(_==null||_.status!==0)return _;he(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:_.to,from:_.from,data:""},receipt:_})},h=await this.provider.getTransactionReceipt(this.hash);if(r===0)return d(h);if(h){if(r===1||await h.confirmations()>=r)return d(h)}else if(await c(),r===0)return null;return await new Promise((_,x)=>{const b=[],A=()=>{b.forEach(F=>F())};if(b.push(()=>{a=!0}),i>0){const F=setTimeout(()=>{A(),x(un("wait for transaction timeout","TIMEOUT"))},i);b.push(()=>{clearTimeout(F)})}const N=async F=>{if(await F.confirmations()>=r){A();try{_(d(F))}catch(B){x(B)}}};if(b.push(()=>{this.provider.off(this.hash,N)}),this.provider.on(this.hash,N),s>=0){const F=async()=>{try{await c()}catch(B){if(vr(B,"TRANSACTION_REPLACED")){A(),x(B);return}}a||this.provider.once("block",F)};b.push(()=>{this.provider.off("block",F)}),this.provider.once("block",F)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return he(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),G9(this)}reorderedEvent(e){return he(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),he(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),H9(this,e)}replaceableTransaction(e){Q(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new wP(this,this.provider);return H(t,Ac,e),t}};Ac=new WeakMap;let Q0=wP;function Rce(n){return{orphan:"drop-block",hash:n.hash,number:n.number}}function H9(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function G9(n){return{orphan:"drop-transaction",tx:n}}function Dce(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}class Kk extends Kw{constructor(t,r,i){super(t,t.provider);X(this,"interface");X(this,"fragment");X(this,"args");const s=r.decodeEventLog(i,t.data,t.topics);Qe(this,{args:s,fragment:i,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class j9 extends Kw{constructor(t,r){super(t,t.provider);X(this,"error");Qe(this,{error:r})}}var Up;class Mce extends B9{constructor(t,r,i){super(i,r);se(this,Up);H(this,Up,t)}get logs(){return super.logs.map(t=>{const r=t.topics.length?S(this,Up).getEvent(t.topics[0]):null;if(r)try{return new Kk(t,S(this,Up),r)}catch(i){return new j9(t,i)}return t})}}Up=new WeakMap;var ow;class Qk extends Q0{constructor(t,r,i){super(i,r);se(this,ow);H(this,ow,t)}async wait(t,r){const i=await super.wait(t,r);return i==null?null:new Mce(S(this,ow),this.provider,i)}}ow=new WeakMap;class q9 extends p8{constructor(t,r,i,s){super(t,r,i);X(this,"log");Qe(this,{log:s})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Lce extends q9{constructor(e,t,r,i,s){super(e,t,r,new Kk(s,e.interface,i));const o=e.interface.decodeEventLog(i,this.log.data,this.log.topics);Qe(this,{args:o,fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const $O=BigInt(0);function z9(n){return n&&typeof n.call=="function"}function $9(n){return n&&typeof n.estimateGas=="function"}function JT(n){return n&&typeof n.resolveName=="function"}function W9(n){return n&&typeof n.sendTransaction=="function"}function K9(n){if(n!=null){if(JT(n))return n;if(n.provider)return n.provider}}var aw;class Oce{constructor(e,t,r){se(this,aw);X(this,"fragment");if(Qe(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");const i=Ih(e.runner,"resolveName"),s=JT(i)?i:null;H(this,aw,(async function(){const o=await Promise.all(t.inputs.map((a,c)=>r[c]==null?null:a.walkAsync(r[c],(h,m)=>h==="address"?Array.isArray(m)?Promise.all(m.map(_=>ei(_,s))):ei(m,s):m)));return e.interface.encodeFilterTopics(t,o)})())}getTopicFilter(){return S(this,aw)}}aw=new WeakMap;function Ih(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function Sd(n){return n==null?null:n.provider||null}async function Q9(n,e){const t=Br.dereference(n,"overrides");Q(typeof t=="object","invalid overrides parameter","overrides",n);const r=cx(t);return Q(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),Q(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Vce(n,e,t){const r=Ih(n,"resolveName"),i=JT(r)?r:null;return await Promise.all(e.map((s,o)=>s.walkAsync(t[o],(a,c)=>(c=Br.dereference(c,a),a==="address"?ei(c,i):c))))}function Fce(n){const e=async function(o){const a=await Q9(o,["data"]);a.to=await n.getAddress(),a.from&&(a.from=await ei(a.from,K9(n.runner)));const c=n.interface,d=He(a.value||$O,"overrides.value")===$O,h=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!h&&!d&&Q(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),Q(c.fallback||h,"cannot send data to receive-only contract","overrides.data",a.data);const m=c.receive||c.fallback&&c.fallback.payable;return Q(m||d,"cannot send value to non-payable fallback","overrides.value",a.value),Q(c.fallback||h,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Ih(n.runner,"call");he(z9(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(d){throw Mk(d)&&d.data?n.interface.makeError(d.data,c):d}},r=async function(o){const a=n.runner;he(W9(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),d=Sd(n.runner);return new Qk(n.interface,d,c)},i=async function(o){const a=Ih(n.runner,"estimateGas");return he($9(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},s=async o=>await r(o);return Qe(s,{_contract:n,estimateGas:i,populateTransaction:e,send:r,staticCall:t}),s}function Uce(n,e){const t=function(...d){const h=n.interface.getFunction(e,d);return he(h,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),h},r=async function(...d){const h=t(...d);let m={};if(h.inputs.length+1===d.length&&(m=await Q9(d.pop()),m.from&&(m.from=await ei(m.from,K9(n.runner)))),h.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const _=await Vce(n.runner,h.inputs,d);return Object.assign({},m,await Qr({to:n.getAddress(),data:n.interface.encodeFunctionData(h,_)}))},i=async function(...d){const h=await a(...d);return h.length===1?h[0]:h},s=async function(...d){const h=n.runner;he(W9(h),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const m=await h.sendTransaction(await r(...d)),_=Sd(n.runner);return new Qk(n.interface,_,m)},o=async function(...d){const h=Ih(n.runner,"estimateGas");return he($9(h),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await h.estimateGas(await r(...d))},a=async function(...d){const h=Ih(n.runner,"call");he(z9(h),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const m=await r(...d);let _="0x";try{_=await h.call(m)}catch(b){throw Mk(b)&&b.data?n.interface.makeError(b.data,m):b}const x=t(...d);return n.interface.decodeFunctionResult(x,_)},c=async(...d)=>t(...d).constant?await i(...d):await s(...d);return Qe(c,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:o,populateTransaction:r,send:s,staticCall:i,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=n.interface.getFunction(e);return he(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),c}function Bce(n,e){const t=function(...i){const s=n.interface.getEvent(e,i);return he(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:i}}),s},r=function(...i){return new Oce(n,t(...i),i)};return Qe(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const i=n.interface.getEvent(e);return he(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),i}}),r}const ux=Symbol.for("_ethersInternal_contract"),J9=new WeakMap;function Hce(n,e){J9.set(n[ux],e)}function Ui(n){return J9.get(n[ux])}function Gce(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function Jk(n,e){let t,r=null;if(Array.isArray(e)){const s=function(o){if(Xt(o,32))return o;const a=n.interface.getEvent(o);return Q(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(s):s(o))}else e==="*"?t=[null]:typeof e=="string"?Xt(e,32)?t=[e]:(r=n.interface.getEvent(e),Q(r,"unknown fragment","event",e),t=[r.topicHash]):Gce(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):Q(!1,"unknown event name","event",e);t=t.map(s=>{if(s==null)return null;if(Array.isArray(s)){const o=Array.from(new Set(s.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return s.toLowerCase()});const i=t.map(s=>s==null?"null":Array.isArray(s)?s.join("|"):s).join("&");return{fragment:r,tag:i,topics:t}}async function ky(n,e){const{subs:t}=Ui(n);return t.get((await Jk(n,e)).tag)||null}async function WO(n,e,t){const r=Sd(n.runner);he(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:s,topics:o}=await Jk(n,t),{addr:a,subs:c}=Ui(n);let d=c.get(s);if(!d){const m={address:a||n,topics:o},_=N=>{let F=i;if(F==null)try{F=n.interface.getEvent(N.topics[0])}catch{}if(F){const B=F,O=i?n.interface.decodeEventLog(i,N.data,N.topics):[];ES(n,t,O,q=>new Lce(n,q,t,B,N))}else ES(n,t,[],B=>new q9(n,B,t,N))};let x=[];d={tag:s,listeners:[],start:()=>{x.length||x.push(r.on(m,_))},stop:async()=>{if(x.length==0)return;let N=x;x=[],await Promise.all(N),r.off(m,_)}},c.set(s,d)}return d}let vS=Promise.resolve();async function jce(n,e,t,r){await vS;const i=await ky(n,e);if(!i)return!1;const s=i.listeners.length;return i.listeners=i.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);r&&c.push(r(a?null:o));try{o.call(n,...c)}catch{}return!a}),i.listeners.length===0&&(i.stop(),Ui(n).subs.delete(i.tag)),s>0}async function ES(n,e,t,r){try{await vS}catch{}const i=jce(n,e,t,r);return vS=i,await i}const Av=["then"];var W5;W5=ux;const i0=class i0{constructor(e,t,r,i){X(this,"target");X(this,"interface");X(this,"runner");X(this,"filters");X(this,W5);X(this,"fallback");Q(typeof e=="string"||t9(e),"invalid value for Contract target","target",e),r==null&&(r=null);const s=_S.from(t);Qe(this,{target:e,runner:r,interface:s}),Object.defineProperty(this,ux,{value:{}});let o,a=null,c=null;if(i){const m=Sd(r);c=new Qk(this.interface,m,i)}let d=new Map;if(typeof e=="string")if(Xt(e))a=e,o=Promise.resolve(e);else{const m=Ih(r,"resolveName");if(!JT(m))throw un("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=m.resolveName(e).then(_=>{if(_==null)throw un("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ui(this).addr=_,_})}else o=e.getAddress().then(m=>{if(m==null)throw new Error("TODO");return Ui(this).addr=m,m});Hce(this,{addrPromise:o,addr:a,deployTx:c,subs:d});const h=new Proxy({},{get:(m,_,x)=>{if(typeof _=="symbol"||Av.indexOf(_)>=0)return Reflect.get(m,_,x);try{return this.getEvent(_)}catch(b){if(!vr(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(m,_)=>Av.indexOf(_)>=0?Reflect.has(m,_):Reflect.has(m,_)||this.interface.hasEvent(String(_))});return Qe(this,{filters:h}),Qe(this,{fallback:s.receive||s.fallback?Fce(this):null}),new Proxy(this,{get:(m,_,x)=>{if(typeof _=="symbol"||_ in m||Av.indexOf(_)>=0)return Reflect.get(m,_,x);try{return m.getFunction(_)}catch(b){if(!vr(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(m,_)=>typeof _=="symbol"||_ in m||Av.indexOf(_)>=0?Reflect.has(m,_):m.interface.hasFunction(_)})}connect(e){return new i0(this.target,this.interface,e)}attach(e){return new i0(e,this.interface,this.runner)}async getAddress(){return await Ui(this).addrPromise}async getDeployedCode(){const e=Sd(this.runner);he(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=Sd(this.runner);return he(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((i,s)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return i(this);r.once("block",o)}catch(a){s(a)}};o()})}deploymentTransaction(){return Ui(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Uce(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),Bce(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");const{addr:i,addrPromise:s}=Ui(this),o=i||await s,{fragment:a,topics:c}=await Jk(this,e),d={address:o,topics:c,fromBlock:t,toBlock:r},h=Sd(this.runner);return he(h,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await h.getLogs(d)).map(m=>{let _=a;if(_==null)try{_=this.interface.getEvent(m.topics[0])}catch{}if(_)try{return new Kk(m,this.interface,_)}catch(x){return new j9(m,x)}return new Kw(m,h)})}async on(e,t){const r=await WO(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){const r=await WO(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await ES(this,e,t,null)}async listenerCount(e){if(e){const i=await ky(this,e);return i?i.listeners.length:0}const{subs:t}=Ui(this);let r=0;for(const{listeners:i}of t.values())r+=i.length;return r}async listeners(e){if(e){const i=await ky(this,e);return i?i.listeners.map(({listener:s})=>s):[]}const{subs:t}=Ui(this);let r=[];for(const{listeners:i}of t.values())r=r.concat(i.map(({listener:s})=>s));return r}async off(e,t){const r=await ky(this,e);if(!r)return this;if(t){const i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(t==null||r.listeners.length===0)&&(r.stop(),Ui(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const t=await ky(this,e);if(!t)return this;t.stop(),Ui(this).subs.delete(t.tag)}else{const{subs:t}=Ui(this);for(const{tag:r,stop:i}of t.values())i(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends i0{constructor(i,s=null){super(i,e,s)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};let xS=i0;function qce(){return xS}class Zy extends qce(){}function Nb(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):Q(!1,"unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}class zce{constructor(e){X(this,"name");Qe(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const Y9=new RegExp("^(ipfs)://(.*)$","i"),KO=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Y9,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var bc,Bd,Cc,Hf,Ax,X9;const Kf=class Kf{constructor(e,t,r){se(this,Cc);X(this,"provider");X(this,"address");X(this,"name");se(this,bc);se(this,Bd);Qe(this,{provider:e,address:t,name:r}),H(this,bc,null),H(this,Bd,new Zy(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return S(this,bc)==null&&H(this,bc,(async()=>{try{return await S(this,Bd).supportsInterface("0x9061b923")}catch(e){if(vr(e,"CALL_EXCEPTION"))return!1;throw H(this,bc,null),e}})()),await S(this,bc)}async getAddress(e){if(e==null&&(e=60),e===60)try{const s=await we(this,Cc,Hf).call(this,"addr(bytes32)");return s==null||s===H0?null:s}catch(s){if(vr(s,"CALL_EXCEPTION"))return null;throw s}if(e>=0&&e<2147483648){let s=e+2147483648;const o=await we(this,Cc,Hf).call(this,"addr(bytes32,uint)",[s]);if(Xt(o,20))return Ot(o)}let t=null;for(const s of this.provider.plugins)if(s instanceof zce&&s.supportsCoinType(e)){t=s;break}if(t==null)return null;const r=await we(this,Cc,Hf).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const i=await t.decodeAddress(e,r);if(i!=null)return i;he(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const t=await we(this,Cc,Hf).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await we(this,Cc,Hf).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const i=t[1]==="e3010170"?"ipfs":"ipns",s=parseInt(t[4],16);if(t[5].length===s*2)return`${i}://${qse("0x"+t[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;he(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let r=0;r<KO.length;r++){const i=t.match(KO[r]);if(i==null)continue;const s=i[1].toLowerCase();switch(s){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Nb(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=s==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:s,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(i[2]||"").split("/");if(c.length!==2)return e.push({type:`!${s}caip`,value:i[2]||""}),{url:null,linkage:e};const d=c[1],h=new Zy(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(s==="erc721"){const A=await h.ownerOf(d);if(a!==A)return e.push({type:"!owner",value:A}),{url:null,linkage:e};e.push({type:"owner",value:A})}else if(s==="erc1155"){const A=await h.balanceOf(a,d);if(!A)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:A.toString()})}let m=await h[o](d);if(m==null||m==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:m}),s==="erc1155"&&(m=m.replace("{id}",hu(d,32).substring(2)),e.push({type:"metadata-url-expanded",value:m})),m.match(/^ipfs:/i)&&(m=Nb(m)),e.push({type:"metadata-url",value:m});let _={};const x=await new fu(m).send();x.assertOk();try{_=x.bodyJson}catch{try{e.push({type:"!metadata",value:x.bodyText})}catch{const F=x.body;return F&&e.push({type:"!metadata",value:Me(F)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!_)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(_)});let b=_.image;if(typeof b!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!b.match(/^(https:\/\/|data:)/i)){if(b.match(Y9)==null)return e.push({type:"!imageUrl-ipfs",value:b}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:b}),b=Nb(b)}return e.push({type:"url",value:b}),{linkage:e,url:b}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),r=t.getPlugin("org.ethers.plugins.network.Ens");return he(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),r.address}static async fromName(e,t){var i;let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;const s=await we(i=Kf,Ax,X9).call(i,e,r);if(s!=null){const o=new Kf(e,s,t);return r!==t&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};bc=new WeakMap,Bd=new WeakMap,Cc=new WeakSet,Hf=async function(e,t){t=(t||[]).slice();const r=S(this,Bd).interface;t.unshift(yS(this.name));let i=null;await this.supportsWildcard()&&(i=r.getFunction(e),he(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[oce(this.name,255),r.encodeFunctionData(i,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const s=await S(this,Bd)[e](...t);return i?r.decodeFunctionResult(i,s)[0]:s}catch(s){if(!vr(s,"CALL_EXCEPTION"))throw s}return null},Ax=new WeakSet,X9=async function(e,t){const r=await Kf.getEnsAddress(e);try{const s=await new Zy(r,["function resolver(bytes32) view returns (address)"],e).resolver(yS(t),{enableCcipRead:!0});return s===H0?null:s}catch(i){throw i}return null},se(Kf,Ax);let dx=Kf;const QO=BigInt(0);function It(n,e){return(function(t){return t==null?e:n(t)})}function J0(n,e){return(t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))})}function Qw(n,e){return(t=>{const r={};for(const i in n){let s=i;if(e&&i in e&&!(s in t)){for(const o of e[i])if(o in t){s=o;break}}try{const o=n[i](t[s]);o!==void 0&&(r[i]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";he(!1,`invalid value for value.${i} (${a})`,"BAD_DATA",{value:t})}}return r})}function $ce(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}Q(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function Om(n){return Q(Xt(n,!0),"invalid data","value",n),n}function wr(n){return Q(Xt(n,32),"invalid hash","value",n),n}const Wce=Qw({address:Ot,blockHash:wr,blockNumber:ut,data:Om,index:ut,removed:It($ce,!1),topics:J0(wr),transactionHash:wr,transactionIndex:ut},{index:["logIndex"]});function Kce(n){return Wce(n)}const Qce=Qw({hash:It(wr),parentHash:wr,parentBeaconBlockRoot:It(wr,null),number:ut,timestamp:ut,nonce:It(Om),difficulty:He,gasLimit:He,gasUsed:He,stateRoot:It(wr,null),receiptsRoot:It(wr,null),blobGasUsed:It(He,null),excessBlobGas:It(He,null),miner:It(Ot),prevRandao:It(wr,null),extraData:Om,baseFeePerGas:It(He)},{prevRandao:["mixHash"]});function Jce(n){const e=Qce(n);return e.transactions=n.transactions.map(t=>typeof t=="string"?t:Z9(t)),e}const Yce=Qw({transactionIndex:ut,blockNumber:ut,transactionHash:wr,address:Ot,topics:J0(wr),data:Om,index:ut,blockHash:wr},{index:["logIndex"]});function Xce(n){return Yce(n)}const Zce=Qw({to:It(Ot,null),from:It(Ot,null),contractAddress:It(Ot,null),index:ut,root:It(Me),gasUsed:He,blobGasUsed:It(He,null),logsBloom:It(Om),blockHash:wr,hash:wr,logs:J0(Xce),blockNumber:ut,cumulativeGasUsed:He,effectiveGasPrice:It(He),blobGasPrice:It(He,null),status:It(ut),type:It(ut,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function eue(n){return Zce(n)}function Z9(n){n.to&&He(n.to)===QO&&(n.to="0x0000000000000000000000000000000000000000");const e=Qw({hash:wr,index:It(ut,void 0),type:t=>t==="0x"||t==null?0:ut(t),accessList:It(Vh,null),blobVersionedHashes:It(J0(wr,!0),null),authorizationList:It(J0(t=>{let r;if(t.signature)r=t.signature;else{let i=t.yParity;i==="0x1b"?i=0:i==="0x1c"&&(i=1),r=Object.assign({},t,{yParity:i})}return{address:Ot(t.address),chainId:He(t.chainId),nonce:He(t.nonce),signature:Ti.from(r)}},!1),null),blockHash:It(wr,null),blockNumber:It(ut,null),transactionIndex:It(ut,null),from:Ot,gasPrice:It(He),maxPriorityFeePerGas:It(He),maxFeePerGas:It(He),maxFeePerBlobGas:It(He,null),gasLimit:He,to:It(Ot,null),value:He,nonce:ut,data:Om,creates:It(Ot,null),chainId:It(He,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(n);if(e.to==null&&e.creates==null&&(e.creates=Hae(e)),(n.type===1||n.type===2)&&n.accessList==null&&(e.accessList=[]),n.signature?e.signature=Ti.from(n.signature):e.signature=Ti.from(n),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&He(e.blockHash)===QO&&(e.blockHash=null),e}const tue="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Jw{constructor(e){X(this,"name");Qe(this,{name:e})}clone(){return new Jw(this.name)}}class YT extends Jw{constructor(t,r){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);X(this,"effectiveBlock");X(this,"txBase");X(this,"txCreate");X(this,"txDataZero");X(this,"txDataNonzero");X(this,"txAccessListStorageKey");X(this,"txAccessListAddress");const i={effectiveBlock:t};function s(o,a){let c=(r||{})[o];c==null&&(c=a),Q(typeof c=="number",`invalud value for ${o}`,"costs",r),i[o]=c}s("txBase",21e3),s("txCreate",32e3),s("txDataZero",4),s("txDataNonzero",16),s("txAccessListStorageKey",1900),s("txAccessListAddress",2400),Qe(this,i)}clone(){return new YT(this.effectiveBlock,this)}}class XT extends Jw{constructor(t,r){super("org.ethers.plugins.network.Ens");X(this,"address");X(this,"targetNetwork");Qe(this,{address:t||tue,targetNetwork:r??1})}clone(){return new XT(this.address,this.targetNetwork)}}var lw,cw;class nue extends Jw{constructor(t,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");se(this,lw);se(this,cw);H(this,lw,t),H(this,cw,r)}get url(){return S(this,lw)}get processFunc(){return S(this,cw)}clone(){return this}}lw=new WeakMap,cw=new WeakMap;const kb=new Map;var Bp,Hp,Sc;const Qf=class Qf{constructor(e,t){se(this,Bp);se(this,Hp);se(this,Sc);H(this,Bp,e),H(this,Hp,He(t)),H(this,Sc,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return S(this,Bp)}set name(e){H(this,Bp,e)}get chainId(){return S(this,Hp)}set chainId(e){H(this,Hp,He(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===He(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===He(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===He(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(S(this,Sc).values())}attachPlugin(e){if(S(this,Sc).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return S(this,Sc).set(e.name,e.clone()),this}getPlugin(e){return S(this,Sc).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new Qf(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new YT;let r=t.txBase;if(e.to==null&&(r+=t.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)e.data.substring(i,i+2)==="00"?r+=t.txDataZero:r+=t.txDataNonzero;if(e.accessList){const i=Vh(e.accessList);for(const s in i)r+=t.txAccessListAddress+t.txAccessListStorageKey*i[s].storageKeys.length}return r}static from(e){if(rue(),e==null)return Qf.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=kb.get(e);if(t)return t();if(typeof e=="bigint")return new Qf("unknown",e);Q(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){Q(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new Qf(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new XT(e.ensAddress,e.ensNetwork)),t}Q(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const r=kb.get(e);r&&Q(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),kb.set(e,t)}};Bp=new WeakMap,Hp=new WeakMap,Sc=new WeakMap;let ta=Qf;function JO(n,e){const t=String(n);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${n}`);const r=t.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${n}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let i=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||i++,r[1]=i.toString()}return BigInt(r[0]+r[1])}function YO(n){return new nue(n,async(e,t,r)=>{r.setHeader("User-Agent","ethers");let i;try{const[s,o]=await Promise.all([r.send(),e()]);i=s;const a=i.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:JO(a.maxFee,9),maxPriorityFeePerGas:JO(a.maxPriorityFee,9)}}catch(s){he(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:i,error:s})}})}let XO=!1;function rue(){if(XO)return;XO=!0;function n(e,t,r){const i=function(){const s=new ta(e,t);return r.ensNetwork!=null&&s.attachPlugin(new XT(null,r.ensNetwork)),s.attachPlugin(new YT),(r.plugins||[]).forEach(o=>{s.attachPlugin(o)}),s};ta.register(e,i),ta.register(t,i),r.altNames&&r.altNames.forEach(s=>{ta.register(s,i)})}n("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),n("ropsten",3,{ensNetwork:3}),n("rinkeby",4,{ensNetwork:4}),n("goerli",5,{ensNetwork:5}),n("kovan",42,{ensNetwork:42}),n("sepolia",11155111,{ensNetwork:11155111}),n("holesky",17e3,{ensNetwork:17e3}),n("classic",61,{}),n("classicKotti",6,{}),n("arbitrum",42161,{ensNetwork:1}),n("arbitrum-goerli",421613,{}),n("arbitrum-sepolia",421614,{}),n("base",8453,{ensNetwork:1}),n("base-goerli",84531,{}),n("base-sepolia",84532,{}),n("bnb",56,{ensNetwork:1}),n("bnbt",97,{}),n("filecoin",314,{}),n("filecoin-calibration",314159,{}),n("linea",59144,{ensNetwork:1}),n("linea-goerli",59140,{}),n("linea-sepolia",59141,{}),n("matic",137,{ensNetwork:1,plugins:[YO("https://gasstation.polygon.technology/v2")]}),n("matic-amoy",80002,{}),n("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[YO("https://gasstation-testnet.polygon.technology/v2")]}),n("optimism",10,{ensNetwork:1,plugins:[]}),n("optimism-goerli",420,{}),n("optimism-sepolia",11155420,{}),n("xdai",100,{ensNetwork:1})}function TS(n){return JSON.parse(JSON.stringify(n))}var Qa,hs,Nc,Bo,Gp,eE;class iue{constructor(e){se(this,Gp);se(this,Qa);se(this,hs);se(this,Nc);se(this,Bo);H(this,Qa,e),H(this,hs,null),H(this,Nc,4e3),H(this,Bo,-2)}get pollingInterval(){return S(this,Nc)}set pollingInterval(e){H(this,Nc,e)}start(){S(this,hs)||(H(this,hs,S(this,Qa)._setTimeout(we(this,Gp,eE).bind(this),S(this,Nc))),we(this,Gp,eE).call(this))}stop(){S(this,hs)&&(S(this,Qa)._clearTimeout(S(this,hs)),H(this,hs,null))}pause(e){this.stop(),e&&H(this,Bo,-2)}resume(){this.start()}}Qa=new WeakMap,hs=new WeakMap,Nc=new WeakMap,Bo=new WeakMap,Gp=new WeakSet,eE=async function(){try{const e=await S(this,Qa).getBlockNumber();if(S(this,Bo)===-2){H(this,Bo,e);return}if(e!==S(this,Bo)){for(let t=S(this,Bo)+1;t<=e;t++){if(S(this,hs)==null)return;await S(this,Qa).emit("block",t)}H(this,Bo,e)}}catch{}S(this,hs)!=null&&H(this,hs,S(this,Qa)._setTimeout(we(this,Gp,eE).bind(this),S(this,Nc)))};var Hd,Gd,kc;class Yk{constructor(e){se(this,Hd);se(this,Gd);se(this,kc);H(this,Hd,e),H(this,kc,!1),H(this,Gd,t=>{this._poll(t,S(this,Hd))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){S(this,kc)||(H(this,kc,!0),S(this,Gd).call(this,-2),S(this,Hd).on("block",S(this,Gd)))}stop(){S(this,kc)&&(H(this,kc,!1),S(this,Hd).off("block",S(this,Gd)))}pause(e){this.stop()}resume(){this.start()}}Hd=new WeakMap,Gd=new WeakMap,kc=new WeakMap;var jp,Ja;class sue extends Yk{constructor(t,r){super(t);se(this,jp);se(this,Ja);H(this,jp,r),H(this,Ja,-2)}pause(t){t&&H(this,Ja,-2),super.pause(t)}async _poll(t,r){const i=await r.getBlock(S(this,jp));i!=null&&(S(this,Ja)===-2?H(this,Ja,i.number):i.number>S(this,Ja)&&(r.emit(S(this,jp),i.number),H(this,Ja,i.number)))}}jp=new WeakMap,Ja=new WeakMap;var bx;class oue extends Yk{constructor(t,r){super(t);se(this,bx);H(this,bx,TS(r))}async _poll(t,r){throw new Error("@TODO")}}bx=new WeakMap;var qp;class aue extends Yk{constructor(t,r){super(t);se(this,qp);H(this,qp,r)}async _poll(t,r){const i=await r.getTransactionReceipt(S(this,qp));i&&r.emit(S(this,qp),i)}}qp=new WeakMap;var Ya,zp,$p,Pc,fs,Cx,e7;class Xk{constructor(e,t){se(this,Cx);se(this,Ya);se(this,zp);se(this,$p);se(this,Pc);se(this,fs);H(this,Ya,e),H(this,zp,TS(t)),H(this,$p,we(this,Cx,e7).bind(this)),H(this,Pc,!1),H(this,fs,-2)}start(){S(this,Pc)||(H(this,Pc,!0),S(this,fs)===-2&&S(this,Ya).getBlockNumber().then(e=>{H(this,fs,e)}),S(this,Ya).on("block",S(this,$p)))}stop(){S(this,Pc)&&(H(this,Pc,!1),S(this,Ya).off("block",S(this,$p)))}pause(e){this.stop(),e&&H(this,fs,-2)}resume(){this.start()}}Ya=new WeakMap,zp=new WeakMap,$p=new WeakMap,Pc=new WeakMap,fs=new WeakMap,Cx=new WeakSet,e7=async function(e){if(S(this,fs)===-2)return;const t=TS(S(this,zp));t.fromBlock=S(this,fs)+1,t.toBlock=e;const r=await S(this,Ya).getLogs(t);if(r.length===0){S(this,fs)<e-60&&H(this,fs,e-60);return}for(const i of r)S(this,Ya).emit(S(this,zp),i),H(this,fs,i.blockNumber)};const lue=BigInt(2),cue=10;function bv(n){return n&&typeof n.then=="function"}function tE(n,e){return n+":"+JSON.stringify(e,(t,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const i=Object.keys(r);return i.sort(),i.reduce((s,o)=>(s[o]=r[o],s),{})}return r})}class t7{constructor(e){X(this,"name");Qe(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function uue(n){return JSON.parse(JSON.stringify(n))}function IS(n){return n=Array.from(new Set(n).values()),n.sort(),n}async function Pb(n,e){if(n==null)throw new Error("invalid event");if(Array.isArray(n)&&(n={topics:n}),typeof n=="string")switch(n){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:n,tag:n}}if(Xt(n,32)){const t=n.toLowerCase();return{type:"transaction",tag:tE("tx",{hash:t}),hash:t}}if(n.orphan){const t=n;return{type:"orphan",tag:tE("orphan",t),filter:uue(t)}}if(n.address||n.topics){const t=n,r={topics:(t.topics||[]).map(i=>i==null?null:Array.isArray(i)?IS(i.map(s=>s.toLowerCase())):i.toLowerCase())};if(t.address){const i=[],s=[],o=a=>{Xt(a)?i.push(a):s.push((async()=>{i.push(await ei(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),s.length&&await Promise.all(s),r.address=IS(i.map(a=>a.toLowerCase()))}return{filter:r,tag:tE("event",r),type:"event"}}Q(!1,"unknown ProviderEvent","event",n)}function Rb(){return new Date().getTime()}const due={cacheTimeout:250,pollingInterval:4e3};var Rr,Rc,Dr,Wp,ji,jd,Dc,Xa,uw,ps,Kp,Qp,yt,Fi,AS,bS,Py,CS,Ry,nE;class hue{constructor(e,t){se(this,yt);se(this,Rr);se(this,Rc);se(this,Dr);se(this,Wp);se(this,ji);se(this,jd);se(this,Dc);se(this,Xa);se(this,uw);se(this,ps);se(this,Kp);se(this,Qp);if(H(this,Qp,Object.assign({},due,t||{})),e==="any")H(this,jd,!0),H(this,ji,null);else if(e){const r=ta.from(e);H(this,jd,!1),H(this,ji,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else H(this,jd,!1),H(this,ji,null);H(this,Xa,-1),H(this,Dc,new Map),H(this,Rr,new Map),H(this,Rc,new Map),H(this,Dr,null),H(this,Wp,!1),H(this,uw,1),H(this,ps,new Map),H(this,Kp,!1)}get pollingInterval(){return S(this,Qp).pollingInterval}get provider(){return this}get plugins(){return Array.from(S(this,Rc).values())}attachPlugin(e){if(S(this,Rc).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return S(this,Rc).set(e.name,e.connect(this)),this}getPlugin(e){return S(this,Rc).get(e)||null}get disableCcipRead(){return S(this,Kp)}set disableCcipRead(e){H(this,Kp,!!e)}async ccipReadFetch(e,t,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const i=e.to.toLowerCase(),s=t.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const c=r[a],d=c.replace("{sender}",i).replace("{data}",s),h=new fu(d);c.indexOf("{data}")===-1&&(h.body={data:s,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:h,index:a,urls:r});let m="unknown error",_;try{_=await h.send()}catch(x){o.push(x.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:{error:x}});continue}try{const x=_.bodyJson;if(x.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:h,result:x}),x.data;x.message&&(m=x.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:x})}catch{}he(_.statusCode<400||_.statusCode>=500,`response not found during CCIP fetch: ${m}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:m}}),o.push(m)}he(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,t){return new Pce(Jce(e),this)}_wrapLog(e,t){return new Kw(Kce(e),this)}_wrapTransactionReceipt(e,t){return new B9(eue(e),this)}_wrapTransactionResponse(e,t){return new Q0(Z9(e),this)}_detectNetwork(){he(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){he(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=ut(await we(this,yt,Fi).call(this,{method:"getBlockNumber"}),"%response");return S(this,Xa)>=0&&H(this,Xa,e),e}_getAddress(e){return ei(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Xt(e))return Xt(e,32)?e:Js(e);if(typeof e=="bigint"&&(e=ut(e,"blockTag")),typeof e=="number")return e>=0?Js(e):S(this,Xa)>=0?Js(S(this,Xa)+e):this.getBlockNumber().then(t=>Js(t+e));Q(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?IS(c.map(d=>d.toLowerCase())):c.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,i=(c,d,h)=>{let m;switch(c.length){case 0:break;case 1:m=c[0];break;default:c.sort(),m=c}if(r&&(d!=null||h!=null))throw new Error("invalid filter");const _={};return m&&(_.address=m),t.length&&(_.topics=t),d&&(_.fromBlock=d),h&&(_.toBlock=h),r&&(_.blockHash=r),_};let s=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)s.push(this._getAddress(c));else s.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),s.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(s),o,a]).then(c=>i(c[0],c[1],c[2])):i(s,o,a)}_getTransactionRequest(e){const t=cx(e),r=[];if(["to","from"].forEach(i=>{if(t[i]==null)return;const s=ei(t[i],this);bv(s)?r.push((async function(){t[i]=await s})()):t[i]=s}),t.blockTag!=null){const i=this._getBlockTag(t.blockTag);bv(i)?r.push((async function(){t.blockTag=await i})()):t.blockTag=i}return r.length?(async function(){return await Promise.all(r),t})():t}async getNetwork(){if(S(this,ji)==null){const i=(async()=>{try{const s=await this._detectNetwork();return this.emit("network",s,null),s}catch(s){throw S(this,ji)===i&&H(this,ji,null),s}})();return H(this,ji,i),(await i).clone()}const e=S(this,ji),[t,r]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==r.chainId&&(S(this,jd)?(this.emit("network",r,t),S(this,ji)===e&&H(this,ji,Promise.resolve(r))):he(!1,`network changed: ${t.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:i,gasPrice:s,priorityFee:o}=await Qr({_block:we(this,yt,CS).call(this,"latest",!1),gasPrice:(async()=>{try{const h=await we(this,yt,Fi).call(this,{method:"getGasPrice"});return He(h,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const h=await we(this,yt,Fi).call(this,{method:"getPriorityFee"});return He(h,"%response")}catch{}return null})()});let a=null,c=null;const d=this._wrapBlock(i,e);return d&&d.baseFeePerGas&&(c=o??BigInt("1000000000"),a=d.baseFeePerGas*lue+c),new zO(s,a,c)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const i=new fu(r.url),s=await r.processFunc(t,this,i);return new zO(s.gasPrice,s.maxFeePerGas,s.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return bv(t)&&(t=await t),He(await we(this,yt,Fi).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:r}=await Qr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await we(this,yt,bS).call(this,we(this,yt,AS).call(this,t,r,e.enableCcipRead?0:-1))}async getBalance(e,t){return He(await we(this,yt,Py).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return ut(await we(this,yt,Py).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Me(await we(this,yt,Py).call(this,{method:"getCode"},e,t))}async getStorage(e,t,r){const i=He(t,"position");return Me(await we(this,yt,Py).call(this,{method:"getStorage",position:i},e,r))}async broadcastTransaction(e){const{blockNumber:t,hash:r,network:i}=await Qr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),s=nx.from(e);if(s.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(s,i).replaceableTransaction(t)}async getBlock(e,t){const{network:r,params:i}=await Qr({network:this.getNetwork(),params:we(this,yt,CS).call(this,e,!!t)});return i==null?null:this._wrapBlock(i,r)}async getTransaction(e){const{network:t,params:r}=await Qr({network:this.getNetwork(),params:we(this,yt,Fi).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,t)}async getTransactionReceipt(e){const{network:t,params:r}=await Qr({network:this.getNetwork(),params:we(this,yt,Fi).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const i=await we(this,yt,Fi).call(this,{method:"getTransaction",hash:e});if(i==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=i.gasPrice}return this._wrapTransactionReceipt(r,t)}async getTransactionResult(e){const{result:t}=await Qr({network:this.getNetwork(),result:we(this,yt,Fi).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Me(t)}async getLogs(e){let t=this._getFilter(e);bv(t)&&(t=await t);const{network:r,params:i}=await Qr({network:this.getNetwork(),params:we(this,yt,Fi).call(this,{method:"getLogs",filter:t})});return i.map(s=>this._wrapLog(s,r))}_getProvider(e){he(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await dx.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Ot(e);const t=yS(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await dx.getEnsAddress(this),s=await new Zy(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(s==null||s===H0)return null;const a=await new Zy(s,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(r){if(vr(r,"BAD_DATA")&&r.value==="0x"||vr(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,t,r){const i=t??1;return i===0?this.getTransactionReceipt(e):new Promise(async(s,o)=>{let a=null;const c=(async d=>{try{const h=await this.getTransactionReceipt(e);if(h!=null&&d-h.blockNumber+1>=i){s(h),a&&(clearTimeout(a),a=null);return}}catch(h){console.log("EEE",h)}this.once("block",c)});r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(un("timeout","TIMEOUT",{reason:"timeout"})))},r)),c(await this.getBlockNumber())})}async waitForBlock(e){he(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=S(this,ps).get(e);t&&(t.timer&&clearTimeout(t.timer),S(this,ps).delete(e))}_setTimeout(e,t){t==null&&(t=0);const r=Jg(this,uw)._++,i=()=>{S(this,ps).delete(r),e()};if(this.paused)S(this,ps).set(r,{timer:null,func:i,time:t});else{const s=setTimeout(i,t);S(this,ps).set(r,{timer:s,func:i,time:Rb()})}return r}_forEachSubscriber(e){for(const t of S(this,Rr).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new t7(e.type);case"block":{const t=new iue(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new sue(this,e.type);case"event":return new Xk(this,e.filter);case"transaction":return new aue(this,e.hash);case"orphan":return new oue(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const r of S(this,Rr).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=t,r.started&&t.start(),S(this,Dr)!=null&&t.pause(S(this,Dr));break}}async on(e,t){const r=await we(this,yt,nE).call(this,e);return r.listeners.push({listener:t,once:!1}),r.started||(r.subscriber.start(),r.started=!0,S(this,Dr)!=null&&r.subscriber.pause(S(this,Dr))),this}async once(e,t){const r=await we(this,yt,nE).call(this,e);return r.listeners.push({listener:t,once:!0}),r.started||(r.subscriber.start(),r.started=!0,S(this,Dr)!=null&&r.subscriber.pause(S(this,Dr))),this}async emit(e,...t){const r=await we(this,yt,Ry).call(this,e,t);if(!r||r.listeners.length===0)return!1;const i=r.listeners.length;return r.listeners=r.listeners.filter(({listener:s,once:o})=>{const a=new p8(this,o?null:s,e);try{s.call(this,...t,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),S(this,Rr).delete(r.tag)),i>0}async listenerCount(e){if(e){const r=await we(this,yt,Ry).call(this,e);return r?r.listeners.length:0}let t=0;for(const{listeners:r}of S(this,Rr).values())t+=r.length;return t}async listeners(e){if(e){const r=await we(this,yt,Ry).call(this,e);return r?r.listeners.map(({listener:i})=>i):[]}let t=[];for(const{listeners:r}of S(this,Rr).values())t=t.concat(r.map(({listener:i})=>i));return t}async off(e,t){const r=await we(this,yt,Ry).call(this,e);if(!r)return this;if(t){const i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(!t||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),S(this,Rr).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:r,subscriber:i}=await we(this,yt,nE).call(this,e);r&&i.stop(),S(this,Rr).delete(t)}else for(const[t,{started:r,subscriber:i}]of S(this,Rr))r&&i.stop(),S(this,Rr).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return S(this,Wp)}destroy(){this.removeAllListeners();for(const e of S(this,ps).keys())this._clearTimeout(e);H(this,Wp,!0)}get paused(){return S(this,Dr)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(H(this,Xa,-1),S(this,Dr)!=null){if(S(this,Dr)==!!e)return;he(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),H(this,Dr,!!e);for(const t of S(this,ps).values())t.timer&&clearTimeout(t.timer),t.time=Rb()-t.time}resume(){if(S(this,Dr)!=null){this._forEachSubscriber(e=>e.resume()),H(this,Dr,null);for(const e of S(this,ps).values()){let t=e.time;t<0&&(t=0),e.time=Rb(),setTimeout(e.func,t)}}}}Rr=new WeakMap,Rc=new WeakMap,Dr=new WeakMap,Wp=new WeakMap,ji=new WeakMap,jd=new WeakMap,Dc=new WeakMap,Xa=new WeakMap,uw=new WeakMap,ps=new WeakMap,Kp=new WeakMap,Qp=new WeakMap,yt=new WeakSet,Fi=async function(e){const t=S(this,Qp).cacheTimeout;if(t<0)return await this._perform(e);const r=tE(e.method,e);let i=S(this,Dc).get(r);return i||(i=this._perform(e),S(this,Dc).set(r,i),setTimeout(()=>{S(this,Dc).get(r)===i&&S(this,Dc).delete(r)},t)),await i},AS=async function(e,t,r){he(r<cue,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const i=cx(e);try{return Me(await this._perform({method:"call",transaction:i,blockTag:t}))}catch(s){if(!this.disableCcipRead&&Mk(s)&&s.data&&r>=0&&t==="latest"&&i.to!=null&&An(s.data,0,4)==="0x556f1830"){const o=s.data,a=await ei(i.to,this);let c;try{c=yue(An(s.data,4))}catch(m){he(!1,m.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:o}})}he(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const d=await this.ccipReadFetch(i,c.calldata,c.urls);he(d!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:s.data,errorArgs:c.errorArgs}});const h={to:a,data:mn([c.selector,gue([d,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:h});try{const m=await we(this,yt,AS).call(this,h,t,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},h),result:m}),m}catch(m){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},h),error:m}),m}}throw s}},bS=async function(e){const{value:t}=await Qr({network:this.getNetwork(),value:e});return t},Py=async function(e,t,r){let i=this._getAddress(t),s=this._getBlockTag(r);return(typeof i!="string"||typeof s!="string")&&([i,s]=await Promise.all([i,s])),await we(this,yt,bS).call(this,we(this,yt,Fi).call(this,Object.assign(e,{address:i,blockTag:s})))},CS=async function(e,t){if(Xt(e,32))return await we(this,yt,Fi).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await we(this,yt,Fi).call(this,{method:"getBlock",blockTag:r,includeTransactions:t})},Ry=async function(e,t){let r=await Pb(e,this);return r.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(r=await Pb({orphan:"drop-log",log:t[0]},this)),S(this,Rr).get(r.tag)||null},nE=async function(e){const t=await Pb(e,this),r=t.tag;let i=S(this,Rr).get(r);return i||(i={subscriber:this._getSubscriber(t),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},S(this,Rr).set(r,i)),i};function fue(n,e){try{const t=SS(n,e);if(t)return ZE(t)}catch{}return null}function SS(n,e){if(n==="0x")return null;try{const t=ut(An(n,e,e+32)),r=ut(An(n,t,t+32));return An(n,t+32,t+32+r)}catch{}return null}function ZO(n){const e=jn(n);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function pue(n){if(n.length%32===0)return n;const e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}const mue=new Uint8Array([]);function gue(n){const e=[];let t=0;for(let r=0;r<n.length;r++)e.push(mue),t+=32;for(let r=0;r<n.length;r++){const i=ht(n[r]);e[r]=ZO(t),e.push(ZO(i.length)),e.push(pue(i)),t+=32+Math.ceil(i.length/32)*32}return mn(e)}const eV="0x0000000000000000000000000000000000000000000000000000000000000000";function yue(n){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};he(sp(n)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=An(n,0,32);he(An(t,0,12)===An(eV,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=An(t,12);try{const r=[],i=ut(An(n,32,64)),s=ut(An(n,i,i+32)),o=An(n,i+32);for(let a=0;a<s;a++){const c=fue(o,a*32);if(c==null)throw new Error("abort");r.push(c)}e.urls=r}catch{he(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=SS(n,64);if(r==null)throw new Error("abort");e.calldata=r}catch{he(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}he(An(n,100,128)===An(eV,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=An(n,96,100);try{const r=SS(n,128);if(r==null)throw new Error("abort");e.extraData=r}catch{he(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function td(n,e){if(n.provider)return n.provider;he(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function tV(n,e){let t=cx(e);if(t.to!=null&&(t.to=ei(t.to,n)),t.from!=null){const r=t.from;t.from=Promise.all([n.getAddress(),ei(r,n)]).then(([i,s])=>(Q(i.toLowerCase()===s.toLowerCase(),"transaction from mismatch","tx.from",s),i))}else t.from=n.getAddress();return await Qr(t)}class wue{constructor(e){X(this,"provider");Qe(this,{provider:e||null})}async getNonce(e){return td(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await tV(this,e)}async populateTransaction(e){const t=td(this,"populateTransaction"),r=await tV(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const i=await this.provider.getNetwork();if(r.chainId!=null){const o=He(r.chainId);Q(o===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=i.chainId;const s=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||s)?Q(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&s&&Q(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await t.getFeeData();he(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(he(!s,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):he(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Qr(r)}async populateAuthorization(e){const t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await td(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return td(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return td(this,"call").call(await this.populateCall(e))}async resolveName(e){return await td(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=td(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const i=nx.from(r);return await t.broadcastTransaction(await this.signTransaction(i))}authorize(e){he(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function _ue(n){return JSON.parse(JSON.stringify(n))}var Wr,Ho,qd,Mc,zd,Jp,pu,NS,kS;class n7{constructor(e){se(this,pu);se(this,Wr);se(this,Ho);se(this,qd);se(this,Mc);se(this,zd);se(this,Jp);H(this,Wr,e),H(this,Ho,null),H(this,qd,we(this,pu,NS).bind(this)),H(this,Mc,!1),H(this,zd,null),H(this,Jp,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){S(this,Mc)||(H(this,Mc,!0),we(this,pu,NS).call(this,-2))}stop(){S(this,Mc)&&(H(this,Mc,!1),H(this,Jp,!0),we(this,pu,kS).call(this),S(this,Wr).off("block",S(this,qd)))}pause(e){e&&we(this,pu,kS).call(this),S(this,Wr).off("block",S(this,qd))}resume(){this.start()}}Wr=new WeakMap,Ho=new WeakMap,qd=new WeakMap,Mc=new WeakMap,zd=new WeakMap,Jp=new WeakMap,pu=new WeakSet,NS=async function(e){try{S(this,Ho)==null&&H(this,Ho,this._subscribe(S(this,Wr)));let t=null;try{t=await S(this,Ho)}catch(s){if(!vr(s,"UNSUPPORTED_OPERATION")||s.operation!=="eth_newFilter")throw s}if(t==null){H(this,Ho,null),S(this,Wr)._recoverSubscriber(this,this._recover(S(this,Wr)));return}const r=await S(this,Wr).getNetwork();if(S(this,zd)||H(this,zd,r),S(this,zd).chainId!==r.chainId)throw new Error("chaid changed");if(S(this,Jp))return;const i=await S(this,Wr).send("eth_getFilterChanges",[t]);await this._emitResults(S(this,Wr),i)}catch(t){console.log("@TODO",t)}S(this,Wr).once("block",S(this,qd))},kS=function(){const e=S(this,Ho);e&&(H(this,Ho,null),e.then(t=>{S(this,Wr).destroyed||S(this,Wr).send("eth_uninstallFilter",[t])}))};var $d;class vue extends n7{constructor(t,r){super(t);se(this,$d);H(this,$d,_ue(r))}_recover(t){return new Xk(t,S(this,$d))}async _subscribe(t){return await t.send("eth_newFilter",[S(this,$d)])}async _emitResults(t,r){for(const i of r)t.emit(S(this,$d),t._wrapLog(i,t._network))}}$d=new WeakMap;class Eue extends n7{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const r of t)e.emit("pending",r)}}const xue="bigint,boolean,function,number,string,symbol".split(/,/g);function rE(n){if(n==null||xue.indexOf(typeof n)>=0||typeof n.getAddress=="function")return n;if(Array.isArray(n))return n.map(rE);if(typeof n=="object")return Object.keys(n).reduce((e,t)=>(e[t]=n[t],e),{});throw new Error(`should not happen: ${n} (${typeof n})`)}function Tue(n){return new Promise(e=>{setTimeout(e,n)})}function Rf(n){return n&&n.toLowerCase()}function nV(n){return n&&typeof n.pollingInterval=="number"}const r7={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Db extends wue{constructor(t,r){super(t);X(this,"address");r=Ot(r),Qe(this,{address:r})}connect(t){he(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const r=rE(t),i=[];if(r.from){const o=r.from;i.push((async()=>{const a=await ei(o,this.provider);Q(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&i.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;i.push((async()=>{r.to=await ei(o,this.provider)})())}i.length&&await Promise.all(i);const s=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[s])}async sendTransaction(t){const r=await this.provider.getBlockNumber(),i=await this.sendUncheckedTransaction(t);return await new Promise((s,o)=>{const a=[1e3,100];let c=0;const d=async()=>{try{const h=await this.provider.getTransaction(i);if(h!=null){s(h.replaceableTransaction(r));return}}catch(h){if(vr(h,"CANCELLED")||vr(h,"BAD_DATA")||vr(h,"NETWORK_ERROR")||vr(h,"UNSUPPORTED_OPERATION")){h.info==null&&(h.info={}),h.info.sendTransactionHash=i,o(h);return}if(vr(h,"INVALID_ARGUMENT")&&(c++,h.info==null&&(h.info={}),h.info.sendTransactionHash=i,c>10)){o(h);return}this.provider.emit("error",un("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:h}))}this.provider._setTimeout(()=>{d()},a.pop()||4e3)};d()})}async signTransaction(t){const r=rE(t);if(r.from){const s=await ei(r.from,this.provider);Q(s!=null&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=s}else r.from=this.address;const i=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[i])}async signMessage(t){const r=typeof t=="string"?ll(t):t;return await this.provider.send("personal_sign",[Me(r),this.address.toLowerCase()])}async signTypedData(t,r,i){const s=rE(i),o=await lx.resolveNames(t,r,s,async a=>{const c=await ei(a);return Q(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(lx.getPayload(o.domain,r,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const r=typeof t=="string"?ll(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Me(r)])}}var Wd,Yp,Za,Go,Ks,ms,pi,dw,PS;class Iue extends hue{constructor(t,r){super(t,r);se(this,dw);se(this,Wd);se(this,Yp);se(this,Za);se(this,Go);se(this,Ks);se(this,ms);se(this,pi);H(this,Yp,1),H(this,Wd,Object.assign({},r7,r||{})),H(this,Za,[]),H(this,Go,null),H(this,ms,null),H(this,pi,null);{let s=null;const o=new Promise(a=>{s=a});H(this,Ks,{promise:o,resolve:s})}const i=this._getOption("staticNetwork");typeof i=="boolean"?(Q(!i||t!=="any","staticNetwork cannot be used on special network 'any'","options",r),i&&t!=null&&H(this,ms,ta.from(t))):i&&(Q(t==null||i.matches(t),"staticNetwork MUST match network object","options",r),H(this,ms,i))}_getOption(t){return S(this,Wd)[t]}get _network(){return he(S(this,ms),"network is not available yet","NETWORK_ERROR"),S(this,ms)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let i=t.transaction;if(i&&i.type!=null&&He(i.type)&&i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null){const s=await this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},i,{type:void 0})}))}}const r=this.getRpcRequest(t);return r!=null?await this.send(r.method,r.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(S(this,ms))return S(this,ms)}else return t;return S(this,pi)?await S(this,pi):this.ready?(H(this,pi,(async()=>{try{const r=ta.from(He(await this.send("eth_chainId",[])));return H(this,pi,null),r}catch(r){throw H(this,pi,null),r}})()),await S(this,pi)):(H(this,pi,(async()=>{const r={id:Jg(this,Yp)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let i;try{i=(await this._send(r))[0],H(this,pi,null)}catch(s){throw H(this,pi,null),this.emit("debug",{action:"receiveRpcError",error:s}),s}if(this.emit("debug",{action:"receiveRpcResult",result:i}),"result"in i)return ta.from(He(i.result));throw this.getRpcError(r,i)})()),await S(this,pi))}_start(){S(this,Ks)==null||S(this,Ks).resolve==null||(S(this,Ks).resolve(),H(this,Ks,null),(async()=>{for(;S(this,ms)==null&&!this.destroyed;)try{H(this,ms,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",un("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await Tue(1e3)}we(this,dw,PS).call(this)})())}async _waitUntilReady(){if(S(this,Ks)!=null)return await S(this,Ks).promise}_getSubscriber(t){return t.type==="pending"?new Eue(this):t.type==="event"?this._getOption("polling")?new Xk(this,t.filter):new vue(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new t7("orphan"):super._getSubscriber(t)}get ready(){return S(this,Ks)==null}getRpcTransaction(t){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(i=>{if(t[i]==null)return;let s=i;i==="gasLimit"&&(s="gas"),r[s]=Js(He(t[i],`tx.${i}`))}),["from","to","data"].forEach(i=>{t[i]!=null&&(r[i]=Me(t[i]))}),t.accessList&&(r.accessList=Vh(t.accessList)),t.blobVersionedHashes&&(r.blobVersionedHashes=t.blobVersionedHashes.map(i=>i.toLowerCase())),t.authorizationList&&(r.authorizationList=t.authorizationList.map(i=>{const s=s9(i);return{address:s.address,nonce:Js(s.nonce),chainId:Js(s.chainId),yParity:Js(s.signature.yParity),r:Js(s.signature.r),s:Js(s.signature.s)}})),r}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Rf(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Rf(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Rf(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Rf(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Rf):t.filter.address=Rf(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,r){const{method:i}=t,{error:s}=r;if(i==="eth_estimateGas"&&s.message){const c=s.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return un("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:s}});if(c.match(/nonce/i)&&c.match(/too low/i))return un("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:s}})}if(i==="eth_call"||i==="eth_estimateGas"){const c=RS(s),d=K0.getBuiltinCallException(i==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return d.info={error:s,payload:t},d}const o=JSON.stringify(bue(s));if(typeof s.message=="string"&&s.message.match(/user denied|ethers-user-denied/i))return un("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[i]||"unknown",reason:"rejected",info:{payload:t,error:s}});if(i==="eth_sendRawTransaction"||i==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return un("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:s}});if(o.match(/nonce/i)&&o.match(/too low/i))return un("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:s}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return un("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:s}});if(o.match(/only replay-protected/i))return un("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:i,info:{transaction:c,info:{error:s}}})}let a=!!o.match(/the method .* does not exist/i);return a||s&&s.details&&s.details.startsWith("Unauthorized method:")&&(a=!0),a?un("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:s,payload:t}}):un("could not coalesce error","UNKNOWN_ERROR",{error:s,payload:t})}send(t,r){if(this.destroyed)return Promise.reject(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const i=Jg(this,Yp)._++,s=new Promise((o,a)=>{S(this,Za).push({resolve:o,reject:a,payload:{method:t,params:r,id:i,jsonrpc:"2.0"}})});return we(this,dw,PS).call(this),s}async getSigner(t){t==null&&(t=0);const r=this.send("eth_accounts",[]);if(typeof t=="number"){const s=await r;if(t>=s.length)throw new Error("no such account");return new Db(this,s[t])}const{accounts:i}=await Qr({network:this.getNetwork(),accounts:r});t=Ot(t);for(const s of i)if(Ot(s)===t)return new Db(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new Db(this,r))}destroy(){S(this,Go)&&(clearTimeout(S(this,Go)),H(this,Go,null));for(const{payload:t,reject:r}of S(this,Za))r(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));H(this,Za,[]),super.destroy()}}Wd=new WeakMap,Yp=new WeakMap,Za=new WeakMap,Go=new WeakMap,Ks=new WeakMap,ms=new WeakMap,pi=new WeakMap,dw=new WeakSet,PS=function(){if(S(this,Go))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");H(this,Go,setTimeout(()=>{H(this,Go,null);const r=S(this,Za);for(H(this,Za,[]);r.length;){const i=[r.shift()];for(;r.length&&i.length!==S(this,Wd).batchMaxCount;)if(i.push(r.shift()),JSON.stringify(i.map(o=>o.payload)).length>S(this,Wd).batchMaxSize){r.unshift(i.pop());break}(async()=>{const s=i.length===1?i[0].payload:i.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:s});try{const o=await this._send(s);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:d}of i){if(this.destroyed){c(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:d.method}));continue}const h=o.filter(m=>m.id===d.id)[0];if(h==null){const m=un("missing response for request","BAD_DATA",{value:o,info:{payload:d}});this.emit("error",m),c(m);continue}if("error"in h){c(this.getRpcError(d,h));continue}a(h.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of i)a(o)}})()}},t))};var Lc;class Aue extends Iue{constructor(t,r){super(t,r);se(this,Lc);let i=this._getOption("pollingInterval");i==null&&(i=r7.pollingInterval),H(this,Lc,i)}_getSubscriber(t){const r=super._getSubscriber(t);return nV(r)&&(r.pollingInterval=S(this,Lc)),r}get pollingInterval(){return S(this,Lc)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");H(this,Lc,t),this._forEachSubscriber(r=>{nV(r)&&(r.pollingInterval=S(this,Lc))})}}Lc=new WeakMap;function RS(n){if(n==null)return null;if(typeof n.message=="string"&&n.message.match(/revert/i)&&Xt(n.data))return{message:n.message,data:n.data};if(typeof n=="object"){for(const e in n){const t=RS(n[e]);if(t)return t}return null}if(typeof n=="string")try{return RS(JSON.parse(n))}catch{}return null}function DS(n,e){if(n!=null){if(typeof n.message=="string"&&e.push(n.message),typeof n=="object")for(const t in n)DS(n[t],e);if(typeof n=="string")try{return DS(JSON.parse(n),e)}catch{}}}function bue(n){const e=[];return DS(n,e),e}var Xp,Zp;const yd=class yd extends Aue{constructor(t,r,i){const s=Object.assign({},i??{},{batchMaxCount:1});Q(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(r,s);se(this,Xp);se(this,Zp);H(this,Zp,null),i&&i.providerInfo&&H(this,Zp,i.providerInfo),H(this,Xp,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const d=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:d}),d}catch(d){const h=new Error(d.message);throw h.code=d.code,h.data=d.data,h.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:h}),h}})}get providerInfo(){return S(this,Zp)}async send(t,r){return await this._start(),await super.send(t,r)}async _send(t){Q(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const r=await S(this,Xp).call(this,t.method,t.params||[]);return[{id:t.id,result:r}]}catch(r){return[{id:t.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(t,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(t,r)}async hasSigner(t){t==null&&(t=0);const r=await this.send("eth_accounts",[]);return typeof t=="number"?r.length>t:(t=t.toLowerCase(),r.filter(i=>i.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await S(this,Xp).call(this,"eth_requestAccounts",[])}catch(r){const i=r.payload;throw this.getRpcError(i,{id:i.id,error:r})}return await super.getSigner(t)}static async discover(t){if(t==null&&(t={}),t.provider)return new yd(t.provider);const r=t.window?t.window:typeof window<"u"?window:null;if(r==null)return null;const i=t.anyProvider;if(i&&r.ethereum)return new yd(r.ethereum);if(!("addEventListener"in r&&"dispatchEvent"in r&&"removeEventListener"in r))return null;const s=t.timeout?t.timeout:300;return s===0?null:await new Promise((o,a)=>{let c=[];const d=_=>{c.push(_.detail),i&&h()},h=()=>{if(clearTimeout(m),c.length)if(t&&t.filter){const _=t.filter(c.map(x=>Object.assign({},x.info)));if(_==null)o(null);else if(_ instanceof yd)o(_);else{let x=null;if(_.uuid&&(x=c.filter(A=>_.uuid===A.info.uuid)[0]),x){const{provider:b,info:A}=x;o(new yd(b,void 0,{providerInfo:A}))}else a(un("filter returned unknown info","UNSUPPORTED_OPERATION",{value:_}))}}else{const{provider:_,info:x}=c[0];o(new yd(_,void 0,{providerInfo:x}))}else o(null);r.removeEventListener("eip6963:announceProvider",d)},m=setTimeout(()=>{h()},s);r.addEventListener("eip6963:announceProvider",d),r.dispatchEvent(new Event("eip6963:requestProvider"))})}};Xp=new WeakMap,Zp=new WeakMap;let Y0=yd;const i7="0x742d35Cc6634C0532925a3b844Bc454e4438f44e",s7="0x13882",Cue={chainId:s7,chainName:"Polygon Amoy Testnet",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:["https://rpc-amoy.polygon.technology/"],blockExplorerUrls:["https://amoy.polygonscan.com/"]},Sue=async()=>{if(!window.ethereum)throw new Error("Vui lng ci t MetaMask  s dng tnh nng ny!");try{const n=new Y0(window.ethereum);await n.send("eth_requestAccounts",[]);try{await n.send("wallet_switchEthereumChain",[{chainId:s7}])}catch(o){if(o.code===4902)try{await n.send("wallet_addEthereumChain",[Cue])}catch(a){throw console.error("User rejected adding network:",a),new Error("Bn cn thm mng Polygon Amoy  s dng tnh nng ny.")}else throw console.error("Failed to switch network:",o),o}const t=await(await n.getSigner()).getAddress(),r=await n.getBalance(t),i=x8(r),s=await n.getNetwork();return console.log(" [Blockchain] Connected:",t),console.log(" [Blockchain] Balance:",i,"POL"),{address:t,balance:i,chainId:s.chainId.toString(),isConnected:!0}}catch(n){throw console.error(" Connect wallet error:",n),n}},rV=async n=>{if(!window.ethereum)return"0";try{const t=await new Y0(window.ethereum).getBalance(n);return x8(t)}catch(e){return console.error("Error fetching balance:",e),"0"}},Nue=async(n,e)=>{if(!window.ethereum)throw new Error("No crypto wallet found");const r=await new Y0(window.ethereum).getSigner(),i=e||i7;console.log(` [Blockchain] Initiating transaction: Sending ${n} POL to ${i}`);const s=await r.sendTransaction({to:i,value:doe(n)});return console.log(" [Blockchain] Transaction sent, waiting for confirmation...",s.hash),await s.wait(),console.log(" [Blockchain] Transaction confirmed:",s.hash),s.hash},my=n=>n?`${n.substring(0,6)}...${n.substring(n.length-4)}`:"",kue=({onClose:n,walletConnected:e=!1,onTransactionSuccess:t,recipientAddress:r,title:i})=>{const[s,o]=Y.useState("crypto"),[a,c]=Y.useState(""),[d,h]=Y.useState(r||i7),[m,_]=Y.useState(!1),[x,b]=Y.useState("");Y.useEffect(()=>{r&&h(r)},[r]);const A=r!==void 0,N=i||(A?"Thanh ton lng":"Np tin vo qu"),F="https://dichvucong.baohiemxahoi.gov.vn/#/index?login=1&url=%2Fthanh-toan-bhxh-dien-tu%2Fngan-hang-lien-ket&queryUrl=",B=async()=>{const q=a.replace(",",".");if(!q||parseFloat(q)<=0||isNaN(parseFloat(q))){b("Vui lng nhp s lng hp l.");return}if(!d||d.length<40){b("a ch v nhn khng hp l.");return}_(!0),b("");try{const W=await Nue(q,d);t&&t(W,q)}catch(W){console.error(W),b(W.message||"Giao dch tht bi. Hy m bo bn c  MATIC/POL trn mng testnet.")}finally{_(!1)}},O=q=>{c(q.target.value)};return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[70] flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:n,"aria-modal":"true",role:"dialog",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:q=>q.stopPropagation(),children:[p.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"ng",children:p.jsx(Sm,{className:"w-6 h-6"})}),p.jsxs("div",{className:"p-6",children:[p.jsx("h2",{className:"text-xl font-bold text-gray-800 text-center mb-6",children:N}),!A&&p.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg mb-6",children:[p.jsx("button",{onClick:()=>o("crypto"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="crypto"?"bg-white shadow text-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:"Blockchain (Testnet)"}),p.jsx("button",{onClick:()=>o("traditional"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="traditional"?"bg-white shadow text-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:"Cng Dch V Cng"})]}),s==="crypto"||A?p.jsxs("div",{className:"text-center space-y-4",children:[p.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 animate-pulse ${A?"bg-green-100":"bg-indigo-100"}`,children:A?p.jsx(so,{className:"w-8 h-8 text-green-600"}):p.jsx(c8,{className:"w-8 h-8 text-indigo-600"})}),e?p.jsxs(p.Fragment,{children:[p.jsx("p",{className:"text-sm text-gray-600",children:A?"Chuyn tin lng trc tip qua Smart Contract.":"Np tin vo Smart Contract trn mng Polygon Amoy."}),p.jsxs("div",{className:"text-left",children:[p.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase",children:A?"a ch V Nhn Vin (Ngi nhn)":"a ch Smart Contract (Qu)"}),p.jsx("input",{type:"text",value:d,onChange:q=>h(q.target.value),className:"w-full p-2 border border-gray-300 rounded-lg text-xs font-mono text-gray-600 bg-gray-50 focus:ring-1 focus:ring-indigo-500 outline-none",placeholder:A?"H thng s t in nu NV  lin kt v...":"0x..."}),A&&!d&&p.jsx("p",{className:"text-[10px] text-orange-500 mt-1 italic font-medium",children:"* Nhn vin ny cha lin kt v. Vui lng hi a ch v ca h v nhp th cng."}),A&&d&&p.jsx("p",{className:"text-[10px] text-green-600 mt-1 italic font-medium flex items-center",children:"  t ng in v ca nhn vin"})]}),p.jsxs("div",{className:"text-left",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S lng (MATIC/POL)"}),p.jsx("input",{type:"text",inputMode:"decimal",value:a,onChange:O,placeholder:"0.01",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none font-mono text-lg font-bold text-indigo-700"})]}),x&&p.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded",children:x}),p.jsx("button",{onClick:B,disabled:m,className:`w-full text-white font-bold py-3 px-4 rounded-lg transition-colors duration-300 shadow-sm disabled:bg-gray-400 flex justify-center items-center ${A?"bg-green-600 hover:bg-green-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:m?p.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Xc nhn giao dch"})]}):p.jsx("div",{className:"bg-yellow-50 text-yellow-800 p-3 rounded-lg text-sm",children:"Vui lng kt ni v MetaMask  mn hnh chnh trc khi thc hin giao dch."})]}):p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(ia,{className:"w-8 h-8 text-gray-600"})}),p.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Chuyn hng n trang web chnh thc ca Bo him X hi Vit Nam."}),p.jsxs("a",{href:F,target:"_blank",rel:"noopener noreferrer",className:"w-full inline-flex items-center justify-center bg-gray-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-gray-900 transition-colors shadow-sm",children:["Tip tc",p.jsx($v,{className:"w-5 h-5 ml-2"})]})]})]})]})})},o7=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),iV=({className:n="w-6 h-6"})=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 01-3 0m3 0h1.5M15.75 18.75a1.5 1.5 0 01-3 0m3 0h1.5m-9-1.5H5.625c-.621 0-1.125-.504-1.125-1.125V11.25c0-.621.504-1.125 1.125-1.125h12.75c.621 0 1.125.504 1.125 1.125v4.875c0 .621-.504 1.125-1.125 1.125H12M5.25 12.75v-1.5m13.5 1.5v-1.5"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 12.75h13.5m-13.5 0a3 3 0 003 3h7.5a3 3 0 003-3"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 9.75h13.5"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 4.5l-2.25 2.25"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 4.5l2.25 2.25"})]}),sV=({className:n="w-6 h-6"})=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.5c0 1.242-1.008 2.25-2.25 2.25S16.5 17.742 16.5 16.5 17.508 14.25 18.75 14.25 21 15.258 21 16.5z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5c0 1.242-1.008 2.25-2.25 2.25S3 17.742 3 16.5 4.008 14.25 5.25 14.25 7.5 15.258 7.5 16.5z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5h9"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 16.5v-4.5a1.5 1.5 0 011.5-1.5h1.5v-1.5H12a3 3 0 00-3 3v4.5"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9l2.25 3h3.75"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 6.75l-.75-1.5"})]}),e0=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),Zk=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),a7=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172v-.938a.75.75 0 0 1 .75-.75h.996c2.123 0 4.017 1.482 4.49 3.555.228 1.002-.132 2.05-.884 2.628-.88.679-1.99.98-3.097.802Zm-9.014 0a7.453 7.453 0 0 0 .982-3.172v-.938a.75.75 0 0 0-.75-.75h-.996C5.035 9 3.14 10.482 2.668 12.555c-.228 1.002.132 2.05.884 2.628.88.679 1.99.98 3.097.802ZM7.5 15.375c0-1.035.727-2.041 1.75-2.435L9.697 4.05a.75.75 0 0 1 1.08-.445l.84.42a.75.75 0 0 0 .672 0l.84-.42a.75.75 0 0 1 1.08.445l.446 8.89c1.024.394 1.751 1.4 1.751 2.435v2.25H7.5v-2.25Z"})}),iE=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),l7=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21V11.25m0-1.01V8.25m0 5.25v5.25m0-5.25H4.5m7.5 0H19.5M3.75 11.25h16.5M4.5 21h15M3 11.25a.75.75 0 01.75-.75h16.5a.75.75 0 01.75.75v9a.75.75 0 01-.75.75H3.75a.75.75 0 01-.75-.75v-9z"})}),oV=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955a.75.75 0 011.06 0l8.955 8.955a.75.75 0 01-1.06 1.06l-1.72-1.72V21a.75.75 0 01-.75.75H5.25a.75.75 0 01-.75-.75V11.34l-1.72 1.72a.75.75 0 01-1.06-1.06z"})}),X0=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Pue=async(n,e,t="",r="")=>{if(e.userType!=="WORKER")throw new Error("Only workers can apply for jobs.");if(!e.fullName)throw new Error("Worker must have a full name to apply.");const i=`${n.id}_${e.uid}`,s=at.collection("applications").doc(i);if((await s.get()).exists)throw new Error("You have already applied for this job.");const a={jobId:n.id,jobTitle:n.title,workerId:e.uid,workerName:e.fullName,workerProfileImageUrl:e.profileImageUrl||null,employerId:n.employerId,employerName:n.employerName,employerProfileImageUrl:n.employerProfileUrl||null,applicationDate:ga(),status:"pending",cvUrl:e.cvUrl||null,cvName:e.cvName||null,introduction:t,contactPhoneNumber:r||e.phoneNumber||"",performanceScore:50},c=at.batch();c.set(s,a);const d=at.collection("jobs").doc(n.id);c.update(d,{applicantCount:Pk(1)}),await c.commit(),await Rk(n.employerId,Jo.NEW_APPLICATION,`${e.fullName} va ng tuyn vo cng vic: "${n.title}"`,"/profile")},Rue=async(n,e)=>{const t=`${n}_${e}`;return(await at.collection("applications").doc(t).get()).exists},c7=(n,e)=>at.collection("applications").where("employerId","==",n).onSnapshot(s=>{const o=[];s.forEach(a=>{var m;const c=a.data(),d=(m=c.applicationDate)!=null&&m.toDate?c.applicationDate.toDate().toISOString():new Date().toISOString(),h={id:a.id,jobId:c.jobId,jobTitle:c.jobTitle,workerId:c.workerId,workerName:c.workerName,employerName:c.employerName||"Khng r",workerProfileImageUrl:c.workerProfileImageUrl,employerId:c.employerId,employerProfileImageUrl:c.employerProfileImageUrl,applicationDate:d,status:c.status,cvUrl:c.cvUrl||null,cvName:c.cvName||null,introduction:c.introduction||"",contactPhoneNumber:c.contactPhoneNumber||"",performanceScore:c.performanceScore||50,contractUrl:c.contractUrl||null};o.push(h)}),o.sort((a,c)=>new Date(c.applicationDate).getTime()-new Date(a.applicationDate).getTime()),e(o)},s=>{console.error("Error fetching employer applications: ",s),e([])}),u7=(n,e)=>at.collection("applications").where("workerId","==",n).onSnapshot(s=>{const o=[];s.forEach(a=>{var m;const c=a.data(),d=(m=c.applicationDate)!=null&&m.toDate?c.applicationDate.toDate().toISOString():new Date().toISOString(),h={id:a.id,jobId:c.jobId,jobTitle:c.jobTitle,workerId:c.workerId,workerName:c.workerName,employerName:c.employerName||"Khng r",workerProfileImageUrl:c.workerProfileImageUrl,employerId:c.employerId,employerProfileImageUrl:c.employerProfileImageUrl,applicationDate:d,status:c.status,cvUrl:c.cvUrl||null,cvName:c.cvName||null,introduction:c.introduction||"",contactPhoneNumber:c.contactPhoneNumber||"",performanceScore:c.performanceScore||50,contractUrl:c.contractUrl||null};o.push(h)}),o.sort((a,c)=>new Date(c.applicationDate).getTime()-new Date(a.applicationDate).getTime()),e(o)},s=>{console.error("Error fetching worker applications: ",s),e([])}),d7=async(n,e)=>{await at.collection("applications").doc(n.id).update({status:e});let r=Jo.APPLICATION_ACCEPTED,i="",s="/profile";switch(e){case"accepted":i=`Chc mng! H s ca bn cho cng vic "${n.jobTitle}"  c duyt s b. Nh tuyn dng s lin h sm.`;break;case"rejected":r=Jo.APPLICATION_REJECTED,i=`Rt tic, n ng tuyn ca bn cho cng vic "${n.jobTitle}" cha ph hp lc ny.`;break;case"hired":i=`TUYT VI! Bn  c tuyn dng chnh thc cho cng vic "${n.jobTitle}". Kim tra s BHXH ngay!`,s="/insurance";break;case"terminated":r=Jo.APPLICATION_REJECTED,i=`Hp ng cng vic "${n.jobTitle}"  kt thc.`;break}await Rk(n.workerId,r,i,s),e==="hired"&&await Vm(n.id,"HIRED","Bt u lm vic","Cho mng nhn vin mi!")},Vm=async(n,e,t,r="",i)=>{const s=at.collection("applications").doc(n).collection("logs"),o={type:e,title:t,description:r,date:ga()};i!=null&&(o.amount=i),await s.add(o)},aV=async n=>(await at.collection("applications").doc(n).collection("logs").orderBy("date","desc").get()).docs.map(r=>{var s;const i=r.data();return{id:r.id,type:i.type,title:i.title,description:i.description,amount:i.amount,date:(s=i.date)!=null&&s.toDate?i.date.toDate().toISOString():new Date().toISOString()}}),Due=async(n,e)=>{await at.collection("applications").doc(n).update({performanceScore:Pk(e)})},Mue=async(n,e)=>{await at.collection("applications").doc(n).update({contractUrl:e})},Lue=async(n,e="Hon thnh cng vic hoc thi vic")=>{await d7(n,"terminated"),await Vm(n.id,"TERMINATION","Chm dt hp ng",e)},h7=async n=>{var e;if(!n)return null;try{const r=await at.collection("users").doc(n).get();if(r.exists){const i=r.data(),s=(e=i.createdAt)!=null&&e.toDate?i.createdAt.toDate().toISOString():new Date().toISOString();return{uid:i.uid,email:i.email,userType:i.userType,createdAt:s,fullName:i.fullName||"Ngi dng n danh",phoneNumber:i.phoneNumber,address:i.address,profileImageUrl:i.profileImageUrl,bio:i.bio||"",skills:i.skills||[],workHistory:i.workHistory||[],walletAddress:i.walletAddress||null}}else return console.log("No such user document!"),null}catch(t){throw console.error("Error fetching user profile:",t),t}},lV=async(n,e)=>{try{await at.collection("users").doc(n).update({walletAddress:e})}catch(t){throw console.error("Error updating user wallet:",t),t}},ir=({fullScreen:n=!1,message:e})=>{const t=n?"fixed inset-0 flex flex-col items-center justify-center bg-gray-50 z-50":"flex flex-col items-center justify-center";return p.jsxs("div",{className:t,children:[p.jsx("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-indigo-500"}),e&&p.jsx("p",{className:"mt-4 text-lg font-semibold text-gray-700",children:e})]})},Z0=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),Oue="diutnceax",Vue="ansinhso_unsigned_preset",hx=async n=>{var r;const e=new FormData;e.append("file",n),e.append("upload_preset",Vue);const t="auto";try{const i=await fetch(`https://api.cloudinary.com/v1_1/${Oue}/${t}/upload`,{method:"POST",body:e});if(!i.ok){const a=await i.json(),c=((r=a==null?void 0:a.error)==null?void 0:r.message)||"Upload to Cloudinary failed";throw console.error("Cloudinary error response:",a),new Error(`Li Cloudinary: ${c}`)}const s=await i.json();return s.secure_url?s.secure_url.trim():""}catch(i){throw console.error("Error uploading file to Cloudinary:",i),i}},Mb=({active:n,onClick:e,label:t})=>p.jsx("button",{onClick:e,className:`flex-1 py-2 text-sm font-semibold border-b-2 transition-colors ${n?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:t}),Fue=({employee:n,onClose:e,onPay:t})=>{const[r,i]=Y.useState("overview"),[s,o]=Y.useState([]),[a,c]=Y.useState(!1),[d,h]=Y.useState(n.performanceScore||50),[m,_]=Y.useState(null),[x,b]=Y.useState(""),[A,N]=Y.useState(""),[F,B]=Y.useState(n.contractUrl||""),[O,q]=Y.useState(!1),[W,$]=Y.useState(!1),D=Y.useRef(null);Y.useEffect(()=>{(async()=>{c(!0);try{const le=await aV(n.id);o(le)}catch(le){console.error("Failed to fetch logs",le)}finally{c(!1)}})()},[n.id]);const k=(Ee,le)=>{_({value:Ee,type:le}),b("")},R=async()=>{if(!m||!x.trim()){alert("Vui lng nhp l do cp nht im.");return}$(!0);const{value:Ee,type:le}=m;try{await Due(n.id,Ee),h(de=>Math.min(100,Math.max(0,de+Ee)));const pe=`${x}`;await Vm(n.id,Ee>0?"BONUS":"PENALTY",le,pe);const be=await aV(n.id);o(be),_(null),b("")}catch(pe){console.error(pe),alert("C li xy ra khi cp nht im.")}finally{$(!1)}},U=async Ee=>{if(Ee.preventDefault(),Ee.stopPropagation(),!!A.trim()){$(!0);try{await Lue(n,A),e()}catch(le){console.error("Termination error:",le),alert(`Li: ${le.message||"Khng th chm dt hp ng. Vui lng kim tra quyn truy cp."}`)}finally{$(!1)}}},M=async Ee=>{var pe;const le=(pe=Ee.target.files)==null?void 0:pe[0];if(le){$(!0);try{const be=await hx(le);B(be)}catch(be){console.error(be),alert("Li ti file ln.")}finally{$(!1)}}},j=async()=>{if(F.trim()){$(!0);try{await Mue(n.id,F),await Vm(n.id,"HIRED","Cp nht hp ng"," cp nht lin kt hp ng lao ng."),q(!1),alert(" lu hp ng thnh cng.")}catch(Ee){console.error(Ee),alert("Li lu hp ng.")}finally{$(!1)}}},V=n.status==="terminated";return p.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex justify-center items-center p-4 animate-fade-in",onClick:e,children:p.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",onClick:Ee=>Ee.stopPropagation(),children:[p.jsxs("div",{className:`p-6 text-white flex justify-between items-start ${V?"bg-gray-800":"bg-indigo-600"}`,children:[p.jsxs("div",{className:"flex items-center gap-4",children:[n.workerProfileImageUrl?p.jsx("img",{src:n.workerProfileImageUrl,className:"w-16 h-16 rounded-full border-2 border-white object-cover",alt:""}):p.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center border-2 border-white",children:p.jsx(so,{className:"w-8 h-8 text-white"})}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-xl font-bold",children:n.workerName}),p.jsx("p",{className:"text-white/80 text-sm",children:n.jobTitle}),p.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[V?p.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded border border-red-400 font-bold",children:" thi vic"}):p.jsx("span",{className:"bg-green-400/20 text-green-100 text-xs px-2 py-0.5 rounded border border-green-400/30",children:"Nhn vin chnh thc"}),p.jsxs("span",{className:"text-xs text-white/80 flex items-center",children:[p.jsx(FT,{className:"w-3 h-3 mr-1"}),"T: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]})]})]}),p.jsx("button",{onClick:e,className:"text-white/70 hover:text-white transition-colors",type:"button",children:p.jsx(Sm,{className:"w-6 h-6"})})]}),p.jsxs("div",{className:"flex border-b border-gray-200 px-6",children:[p.jsx(Mb,{active:r==="overview",onClick:()=>i("overview"),label:"Tng quan & Thao tc"}),p.jsx(Mb,{active:r==="history",onClick:()=>i("history"),label:"Lch s hot ng"}),p.jsx(Mb,{active:r==="settings",onClick:()=>i("settings"),label:"Ci t"})]}),p.jsxs("div",{className:"p-6 overflow-y-auto bg-gray-50 flex-grow relative",children:[m&&p.jsx("div",{className:"absolute inset-0 bg-white/95 z-10 flex flex-col items-center justify-center p-8 animate-fade-in",children:p.jsxs("div",{className:"w-full max-w-sm text-center",children:[p.jsxs("h4",{className:"text-xl font-bold text-gray-800 mb-2",children:["Xc nhn ",m.value>0?"cng":"tr"," im"]}),p.jsxs("p",{className:"text-gray-500 mb-4",children:["Bn ang ",m.value>0?"thng":"pht"," ",p.jsxs("span",{className:"font-bold text-indigo-600",children:[Math.abs(m.value)," im"]})," cho nhn vin."]}),p.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-indigo-500 outline-none text-gray-900",placeholder:"Nhp l do c th (Bt buc)...",rows:3,value:x,onChange:Ee=>b(Ee.target.value),autoFocus:!0}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{onClick:()=>_(null),className:"flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300",children:"Hy"}),p.jsx("button",{onClick:R,disabled:W||!x.trim(),className:"flex-1 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 disabled:bg-indigo-400",children:W?"ang lu...":"Xc nhn"})]})]})}),r==="overview"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-200 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"font-bold text-gray-700 flex items-center gap-2",children:[p.jsx(a7,{className:"w-5 h-5 text-yellow-500"}),"im Tn Nhim"]}),p.jsx("p",{className:"text-sm text-gray-500",children:"im cng cao, nhn vin cng uy tn."})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("span",{className:`text-3xl font-bold ${d>=80?"text-green-600":d>=50?"text-yellow-600":"text-red-600"}`,children:d}),p.jsx("span",{className:"text-gray-400 text-sm",children:"/100"})]})]}),p.jsxs("div",{className:`grid grid-cols-2 gap-4 ${V?"opacity-50 pointer-events-none grayscale":""}`,children:[p.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 hover:border-indigo-300 transition-colors",children:[p.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Thng im (+)"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>k(5,"Thng nng sut"),disabled:W,className:"flex-1 bg-green-50 text-green-700 py-2 rounded-lg text-sm font-semibold hover:bg-green-100 border border-green-200",children:"+5"}),p.jsx("button",{onClick:()=>k(10,"Thng xut sc"),disabled:W,className:"flex-1 bg-green-50 text-green-700 py-2 rounded-lg text-sm font-semibold hover:bg-green-100 border border-green-200",children:"+10"})]})]}),p.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 hover:border-red-300 transition-colors",children:[p.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Tr im (-)"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>k(-5,"i mun"),disabled:W,className:"flex-1 bg-red-50 text-red-700 py-2 rounded-lg text-sm font-semibold hover:bg-red-100 border border-red-200",children:"-5"}),p.jsx("button",{onClick:()=>k(-10,"Vi phm quy nh"),disabled:W,className:"flex-1 bg-red-50 text-red-700 py-2 rounded-lg text-sm font-semibold hover:bg-red-100 border border-red-200",children:"-10"})]})]})]}),p.jsxs("div",{className:`bg-indigo-50 p-4 rounded-xl border border-indigo-100 flex items-center justify-between ${V?"opacity-50 pointer-events-none":""}`,children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-indigo-900",children:"Thanh ton lng"}),p.jsx("p",{className:"text-xs text-indigo-700",children:"T ng trch qu & ghi log Blockchain"})]}),p.jsx("button",{onClick:()=>t(0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-indigo-700 shadow-md transition-all",children:"Thanh ton ngay"})]}),V&&p.jsx("p",{className:"text-center text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-100",children:"Nhn vin ny  ngh vic. Khng th thc hin thao tc."})]}),r==="history"&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"font-bold text-gray-700 mb-2",children:"Nht k hot ng"}),a?p.jsx(ir,{}):s.length>0?p.jsx("div",{className:"relative border-l-2 border-gray-200 ml-3 space-y-6 pl-6 py-2",children:s.map(Ee=>p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:`absolute -left-[31px] w-4 h-4 rounded-full border-2 border-white shadow-sm ${Ee.type==="PAYMENT"?"bg-green-500":Ee.type==="BONUS"?"bg-yellow-500":Ee.type==="PENALTY"?"bg-red-500":Ee.type==="TERMINATION"?"bg-gray-800":"bg-gray-400"}`}),p.jsxs("div",{children:[p.jsx("p",{className:"text-xs text-gray-400",children:new Date(Ee.date).toLocaleString("vi-VN")}),p.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:Ee.title}),p.jsx("p",{className:"text-sm text-gray-600",children:Ee.description}),Ee.amount&&p.jsxs("span",{className:"inline-block mt-1 text-xs font-mono font-bold bg-gray-100 px-2 py-0.5 rounded",children:[Ee.amount>0?"+":"",Ee.amount]})]})]},Ee.id))}):p.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"Cha c lch s hot ng."})]}),r==="settings"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsxs("h4",{className:"font-bold text-gray-800 flex items-center",children:[p.jsx(Z0,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Hp ng lao ng"]}),!O&&F&&!V&&p.jsx("button",{onClick:()=>q(!0),className:"text-xs text-indigo-600 font-semibold hover:underline",children:"Chnh sa"})]}),(!F||O)&&!V?p.jsxs("div",{className:"space-y-3",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Dn ng dn (Link Google Drive) hoc ti file PDF ln."}),p.jsx("input",{type:"text",value:F,onChange:Ee=>B(Ee.target.value),placeholder:"https://drive.google.com/...",className:"w-full p-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-indigo-500 outline-none text-gray-900"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>{var Ee;return(Ee=D.current)==null?void 0:Ee.click()},disabled:W,className:"flex-1 py-2 bg-gray-100 text-gray-700 text-xs font-bold rounded hover:bg-gray-200",children:W?"ang ti ln...":"Ti file PDF ln"}),p.jsx("input",{type:"file",ref:D,onChange:M,className:"hidden",accept:"application/pdf"}),p.jsx("button",{onClick:j,disabled:W||!F,className:"flex-1 py-2 bg-indigo-600 text-white text-xs font-bold rounded hover:bg-indigo-700 disabled:bg-indigo-400",children:"Lu hp ng"})]})]}):p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200 flex items-center justify-between",children:[p.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[200px]",children:F||"Cha c hp ng"}),F&&p.jsx("a",{href:F,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 text-xs font-bold hover:underline",children:"Xem hp ng"})]})]}),V?p.jsxs("div",{className:"bg-gray-100 p-6 rounded-xl border border-gray-200 text-center",children:[p.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:p.jsx(Sm,{className:"w-6 h-6 text-gray-400"})}),p.jsx("h4",{className:"font-bold text-gray-700",children:"Hp ng  chm dt"}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Nhn vin ny khng cn trong danh sch hot ng."})]}):p.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-200",children:[p.jsx("h4",{className:"font-bold text-red-800 mb-2",children:"Vng nguy him"}),p.jsx("p",{className:"text-sm text-red-600 mb-4",children:"Chm dt hp ng s xa nhn vin khi danh sch qun l hin ti. Hnh ng ny cng s c ghi li."}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("input",{type:"text",value:A,onChange:Ee=>N(Ee.target.value),placeholder:"Nhp l do chm dt (VD: Ht hn hp ng)...",className:"w-full p-2 border border-red-300 rounded text-sm focus:ring-2 focus:ring-red-500 outline-none bg-white text-gray-900 placeholder-gray-900"}),p.jsx("button",{type:"button",onClick:U,disabled:W||!A.trim(),className:`w-full font-bold py-2 px-4 rounded-lg transition-colors shadow-sm ${W||!A.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:W?"ang x l...":"Xc nhn Chm dt hp ng"})]})]})]})]})]})})},cV=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 0 0-2.25-2.25H15a3 3 0 1 1-6 0H5.25A2.25 2.25 0 0 0 3 12m18 0v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 9m18 0V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v3"})}),Uue=[{title:"BH xe my bt buc",description:"Bo v trch nhim dn s ca bn khi tham gia giao thng.",link:"https://motor-civil.globalcare.vn/293f4359&skip-password=1?token=2306244fxozgmotc",icon:p.jsx(sV,{className:"w-7 h-7 text-gray-700"})},{title:"BH  t bt buc",description:"Yn tm vng li vi bo him trch nhim dn s cho  t.",link:"https://oto-civil.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:p.jsx(iV,{className:"w-7 h-7 text-gray-700"})},{title:"BH vt cht  t",description:"Bo v ton din cho x yu trc mi ri ro va chm, h hng.",link:"https://phydam.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:p.jsx(iV,{className:"w-7 h-7 text-gray-700"})},{title:"BH sc khe",description:"Chm sc sc khe ton din cho bn v gia nh.",link:"https://globalcare.vn/products-hub?code=health&token=2306244fxozgmotc",icon:p.jsx(e0,{className:"w-7 h-7 text-red-500"})},{title:"BH an ninh mng",description:"Bo v bn khi cc ri ro v tn cng trn khng gian mng.",link:"https://globalcare.vn/bao-hiem-an-ninh-mang?token=2306244fxozgmotc",icon:p.jsx(Zk,{className:"w-7 h-7 text-blue-600"})},{title:"BH ton din h kinh doanh",description:"An tm kinh doanh vi gii php bo v ti sn v hot ng.",link:"https://globalcare.vn/bao-hiem-toan-dien-ho-kinh-doanh-ca-the?token=2306244fxozgmotc",icon:p.jsx(l7,{className:"w-7 h-7 text-yellow-600"})},{title:"BH cu h xe my 24/7",description:"H tr kp thi mi lc, mi ni khi xe bn gp s c.",link:"https://globalcare.vn/dich-vu-cuu-ho-xe-may?token=2306244fxozgmotc",icon:p.jsx(sV,{className:"w-7 h-7 text-gray-700"})},{title:"BH bnh him ngho",description:"Ngun ti chnh vng chc gip bn vt qua bnh tt.",link:"https://critical-disease.globalcare.vn/b45306c2?token=2306244fxozgmotc",icon:p.jsx(e0,{className:"w-7 h-7 text-red-500"})},{title:"BH VIB care",description:"Gi chm sc sc khe cao cp vi nhiu quyn li vt tri.",link:"https://vbi-care.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:p.jsx(e0,{className:"w-7 h-7 text-red-500"})},{title:"BH nh t nhn",description:"Bo v t m ca bn trc nhng ri ro chy, n, thin tai.",link:"https://private-home.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:p.jsx(oV,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn Tomato",description:"Gi bo him tai nn c nhn linh hot, chi ph thp.",link:"https://tomato.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:p.jsx(ia,{className:"w-7 h-7 text-indigo-600"})},{title:"BH Home Care",description:"Bo v ton din cho ngi nh v ti sn bn trong.",link:"https://private-home.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:p.jsx(oV,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn c nhn",description:"An tm trc mi ri ro khng lng trc trong cuc sng.",link:"https://personal-accident.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:p.jsx(ia,{className:"w-7 h-7 text-indigo-600"})}],Bue=()=>{const{currentUser:n,currentUserData:e,refetchUserData:t}=wa(),[r,i]=Y.useState(!1),[s,o]=Y.useState({address:null,balance:null,chainId:null,isConnected:!1}),[a,c]=Y.useState(!1),[d,h]=Y.useState(Ff.latestTxHash),[m,_]=Y.useState([]),[x,b]=Y.useState(void 0),[A,N]=Y.useState(void 0),[F,B]=Y.useState(null),[O,q]=Y.useState([]),[W,$]=Y.useState(!1),[D,k]=Y.useState(null),[R,U]=Y.useState("active"),M=Y.useMemo(()=>(e==null?void 0:e.userType)===Jt.Employer?R==="active"?O.filter(ne=>ne.status==="hired"):O.filter(ne=>ne.status==="terminated"):O.filter(ne=>ne.status==="hired"||ne.status==="terminated"),[O,e,R]);Y.useEffect(()=>{(async()=>{if(e!=null&&e.walletAddress)try{const z=await rV(e.walletAddress);o({address:e.walletAddress,balance:z,chainId:"80002",isConnected:!0})}catch(z){console.error("Failed to load wallet balance",z)}})()},[e]),Y.useEffect(()=>{if(e){$(!0);let ne;return e.userType===Jt.Employer?ne=c7(e.uid,z=>{q(z),$(!1)}):ne=u7(e.uid,z=>{q(z),$(!1)}),()=>{ne&&ne()}}},[e]);const j=async()=>{c(!0);try{const ne=await Sue();o(ne),ne.address&&n&&(await lV(n.uid,ne.address),await t())}catch(ne){alert(ne.message||"Li kt ni v")}finally{c(!1)}},V=async()=>{window.confirm("Bn c chc chn mun hy lin kt v ny khng?")&&(n&&(await lV(n.uid,null),await t()),o({address:null,balance:null,chainId:null,isConnected:!1}))},Ee=async(ne,z)=>{h(ne),i(!1),alert(`Giao dch thnh cng! Hash: ${ne}`);const ce={hash:ne,amount:z,type:x?"salary":"deposit",date:new Date,recipient:x};if(_(Pe=>[ce,...Pe]),F&&x){try{const Pe=parseFloat(z);await Vm(F.id,"PAYMENT","Thanh ton lng (Blockchain)",` chuyn ${z} POL qua Smart Contract. Hash: ${my(ne)}`,Pe);const Re=Pe*.1;await Vm(F.id,"PAYMENT","Trch ng BHXH (T ng)",`H thng t ng trch 10% (${Re.toFixed(4)} POL) vo qu an sinh.`,Re)}catch(Pe){console.error("Failed to log payment:",Pe)}B(null),b(void 0),N(void 0)}if(s.address)try{const Pe=await rV(s.address);o(Re=>({...Re,balance:Pe}))}catch{console.error("Failed to update balance")}},le=async(ne,z)=>{let ce="";try{const Pe=await h7(ne.workerId);Pe&&Pe.walletAddress&&(ce=Pe.walletAddress)}catch(Pe){console.error("Failed to fetch worker profile for wallet",Pe)}b(ce),N(`Thanh ton lng cho ${ne.workerName}`),B(ne),i(!0)},pe=()=>{b(void 0),N("Np tin vo qu (Blockchain)"),B(null),i(!0)},be=ne=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(ne),de=()=>p.jsxs("div",{className:"space-y-8",children:[p.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[p.jsx(c8,{className:"w-7 h-7 text-indigo-600"}),"S Hu Tr Blockchain"]}),p.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"An tm tch ly cho tng lai."})]}),s.isConnected?p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-4 py-2 rounded-xl border border-green-200 shadow-sm",children:[p.jsx("div",{className:"w-2.5 h-2.5 bg-green-500 rounded-full animate-pulse"}),p.jsx("span",{className:"text-sm font-mono font-bold",children:my(s.address)})]}),p.jsx("button",{onClick:V,className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"i v / Hy lin kt",children:p.jsx(X0,{className:"w-5 h-5"})})]}):p.jsxs("button",{onClick:j,disabled:a,className:"flex items-center justify-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-xl text-sm font-medium hover:bg-gray-800 transition-colors shadow-lg",children:[p.jsx(cV,{className:"w-4 h-4"}),a?"ang kt ni...":"Kt ni V"]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-blue-700 p-6 rounded-2xl shadow-xl text-white relative overflow-hidden group hover:scale-[1.01] transition-transform duration-300",children:[p.jsxs("div",{className:"relative z-10",children:[p.jsxs("div",{className:"flex items-center justify-between mb-8",children:[p.jsxs("div",{className:"flex items-center gap-2 bg-white/10 px-3 py-1 rounded-full backdrop-blur-sm",children:[p.jsx(ia,{className:"w-5 h-5 text-green-300"}),p.jsx("span",{className:"font-bold text-xs tracking-wider uppercase text-indigo-100",children:"Smart Contract"})]}),p.jsx("img",{src:"https://cryptologos.cc/logos/polygon-matic-logo.png",alt:"Polygon",className:"w-8 h-8 opacity-90 filter brightness-200"})]}),p.jsx("p",{className:"text-indigo-200 font-medium mb-1",children:"Tng ti sn tch ly"}),p.jsx("p",{className:"text-4xl sm:text-5xl font-extrabold tracking-tight drop-shadow-sm",children:s.isConnected&&s.balance?`${parseFloat(s.balance).toFixed(4)} POL`:be(Ff.pensionBookTotal)}),p.jsxs("div",{className:"mt-8 pt-4 border-t border-white/10 flex justify-between items-end",children:[p.jsxs("div",{className:"text-xs",children:[p.jsx("span",{className:"text-indigo-300 block mb-1",children:"Hash giao dch mi nht"}),p.jsxs("span",{className:"text-white font-mono flex items-center gap-1 cursor-pointer hover:underline opacity-90 hover:opacity-100",title:"Xem trn Blockchain Explorer",children:[d?my(d):"Cha c",p.jsx($v,{className:"w-3 h-3"})]})]}),p.jsx("button",{onClick:pe,className:"bg-white text-indigo-700 hover:bg-indigo-50 font-bold py-2 px-4 rounded-lg text-xs shadow-md transition-colors",children:"+ Np thm"})]})]}),p.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-56 h-56 bg-white opacity-10 rounded-full blur-3xl group-hover:opacity-15 transition-opacity"}),p.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-40 h-40 bg-blue-400 opacity-20 rounded-full blur-2xl"})]}),p.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col relative overflow-hidden",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6 z-10",children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[p.jsx(a7,{className:"w-6 h-6 text-yellow-500"}),"Uy tn ngh nghip"]}),p.jsx("span",{className:"text-xs font-semibold text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"SBT Token"})]}),p.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center py-2 z-10",children:[p.jsx("div",{className:"text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-500 to-orange-500 drop-shadow-sm",children:Ff.csrScore}),p.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-sm text-green-700 font-bold bg-green-100 px-4 py-1.5 rounded-full",children:[p.jsx(iE,{className:"w-4 h-4"}),"Rt uy tn"]})]}),p.jsx("div",{className:"mt-auto pt-4 border-t border-gray-100 z-10 text-center",children:p.jsx("p",{className:"text-xs text-gray-500",children:"im s c lu tr vnh vin trn Blockchain."})}),p.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none"})]})]}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(Ts,{className:"w-6 h-6 text-indigo-600"}),"Cng vic hin ti & Lch s"]}),W?p.jsx("div",{className:"p-8",children:p.jsx(ir,{})}):M.length>0?p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:M.map(ne=>p.jsxs("div",{className:`bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-all p-5 flex flex-col ${ne.status==="terminated"?"opacity-80":"hover:border-indigo-300"}`,children:[p.jsxs("div",{className:"flex items-start justify-between mb-3",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[ne.employerProfileImageUrl?p.jsx("img",{src:ne.employerProfileImageUrl,alt:"",className:"w-10 h-10 rounded-lg object-cover bg-gray-100"}):p.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-50 flex items-center justify-center text-indigo-500",children:p.jsx(l7,{className:"w-6 h-6"})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-gray-800 text-sm line-clamp-1",children:ne.jobTitle}),p.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:ne.employerName})]})]}),ne.status==="terminated"?p.jsx("span",{className:"bg-red-100 text-red-700 text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide",children:" ngh"}):p.jsx("span",{className:"bg-green-100 text-green-700 text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide",children:"Chnh thc"})]}),p.jsxs("div",{className:"my-3 space-y-2",children:[p.jsxs("div",{className:"flex items-center justify-between text-sm",children:[p.jsx("span",{className:"text-gray-500",children:"im nh gi:"}),p.jsxs("span",{className:"font-bold text-indigo-600",children:[ne.performanceScore||50,"/100"]})]}),p.jsx("div",{className:"w-full bg-gray-100 rounded-full h-1.5",children:p.jsx("div",{className:"bg-indigo-500 h-1.5 rounded-full transition-all duration-1000",style:{width:`${ne.performanceScore||50}%`}})})]}),p.jsxs("div",{className:"mt-auto pt-4 border-t border-gray-100 flex items-center justify-between text-xs text-gray-500",children:[p.jsxs("span",{children:["Bt u: ",new Date(ne.applicationDate).toLocaleDateString("vi-VN")]}),ne.status==="terminated"?p.jsxs("span",{className:"text-red-600 font-medium flex items-center gap-1",children:[p.jsx(Zk,{className:"w-3 h-3"})," kt thc"]}):p.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-1",children:[p.jsx(iE,{className:"w-3 h-3"}),"ang lm vic"]})]})]},ne.id))}):p.jsxs("div",{className:"bg-gray-50 border border-dashed border-gray-300 rounded-xl p-8 text-center text-gray-500",children:[p.jsx(Ts,{className:"w-10 h-10 mx-auto text-gray-400 mb-2"}),p.jsx("p",{children:"Bn cha c cng vic chnh thc no."})]})]})]}),xe=()=>p.jsxs("div",{className:"space-y-8",children:[p.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[p.jsx(e0,{className:"w-7 h-7 text-red-500"}),"Trch Nhim X Hi (CSR)"]}),p.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Xy dng thng hiu doanh nghip v cng ng."})]}),s.isConnected?p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 text-purple-700 px-4 py-2 rounded-xl border border-purple-200 shadow-sm",children:[p.jsx("div",{className:"w-2.5 h-2.5 bg-purple-500 rounded-full animate-pulse"}),p.jsx("span",{className:"text-sm font-mono font-bold",children:my(s.address)})]}),p.jsx("button",{onClick:V,className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"i v / Hy lin kt",children:p.jsx(X0,{className:"w-5 h-5"})})]}):p.jsxs("button",{onClick:j,disabled:a,className:"flex items-center justify-center gap-2 bg-gray-900 text-white px-5 py-2.5 rounded-xl text-sm font-medium hover:bg-gray-800 transition-colors shadow-lg",children:[p.jsx(cV,{className:"w-4 h-4"}),a?"ang kt ni...":"Kt ni V Qu"]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-yellow-50 p-6 rounded-2xl shadow-sm border border-orange-100 relative overflow-hidden",children:[p.jsxs("div",{className:"flex items-start justify-between relative z-10",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-orange-800 font-bold uppercase text-xs tracking-wider mb-1",children:"Doanh nghip v cng ng"}),p.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Huy Hiu An Sinh"})]}),p.jsx("div",{className:"bg-white p-2 rounded-full shadow-sm",children:p.jsx(iE,{className:"w-8 h-8 text-yellow-500"})})]}),p.jsxs("div",{className:"mt-6 flex items-end gap-2 relative z-10",children:[p.jsx("span",{className:"text-5xl font-extrabold text-orange-600",children:M.length>0?M.length:Ff.workersSupportedThisMonth}),p.jsx("span",{className:"text-gray-600 font-medium mb-1",children:"lao ng"})]}),p.jsx("p",{className:"text-sm text-gray-500 mt-1 relative z-10",children:" c bn h tr ng BHXH trong thng ny."}),p.jsx("div",{className:"mt-6 w-full bg-orange-200 rounded-full h-2 relative z-10",children:p.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"75%"}})}),p.jsx("p",{className:"text-xs text-orange-700 mt-2 font-medium relative z-10",children:"Top 5% Doanh nghip uy tn trn nn tng."})]}),p.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col relative overflow-hidden group",children:[p.jsx("div",{className:"flex items-center justify-between mb-4",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center group-hover:bg-indigo-200 transition-colors",children:p.jsx(gc,{className:"w-6 h-6 text-indigo-600"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-gray-800",children:"Qu Thng An Sinh"}),p.jsx("p",{className:"text-xs text-gray-500",children:s.isConnected?"S d On-chain":"S d kh dng"})]})]})}),p.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[p.jsx("p",{className:"text-3xl font-bold text-gray-900",children:s.isConnected&&s.balance?`${parseFloat(s.balance).toFixed(4)} POL`:be(Ff.welfareFundBalance)}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Smart Contract s t ng trch thng cho nhn vin t v ny."})]}),p.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:p.jsx("button",{onClick:pe,className:"w-full py-2 bg-indigo-50 text-indigo-700 font-bold rounded-lg hover:bg-indigo-100 transition-colors",children:"+ Np tin vo qu (Blockchain)"})})]})]}),s.isConnected&&m.length>0&&p.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[p.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 font-bold text-gray-700 flex items-center gap-2",children:[p.jsx(FT,{className:"w-5 h-5 text-gray-500"}),"Lch s giao dch Blockchain (Phin ny)"]}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full text-sm text-left",children:[p.jsx("thead",{className:"bg-gray-100 text-gray-500 uppercase font-bold text-xs",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3",children:"Loi"}),p.jsx("th",{className:"px-4 py-3",children:"S lng"}),p.jsx("th",{className:"px-4 py-3",children:"Hash"}),p.jsx("th",{className:"px-4 py-3",children:"Thi gian"})]})}),p.jsx("tbody",{className:"divide-y divide-gray-100",children:m.map((ne,z)=>p.jsxs("tr",{className:"hover:bg-gray-50",children:[p.jsx("td",{className:"px-4 py-3",children:ne.type==="deposit"?p.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded font-bold",children:"Np Qu"}):p.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded font-bold",children:"Tr Lng"})}),p.jsxs("td",{className:"px-4 py-3 font-mono font-medium text-gray-900",children:["-",ne.amount," POL"]}),p.jsx("td",{className:"px-4 py-3",children:p.jsxs("a",{href:`https://amoy.polygonscan.com/tx/${ne.hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:underline flex items-center gap-1 font-mono text-xs",children:[my(ne.hash),p.jsx($v,{className:"w-3 h-3"})]})}),p.jsx("td",{className:"px-4 py-3 text-gray-500 text-xs",children:ne.date.toLocaleTimeString()})]},z))})]})})]}),p.jsxs("div",{className:"bg-blue-50 p-5 rounded-xl border border-blue-100 flex gap-4",children:[p.jsx(o7,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-blue-900",children:"Li ch ca Qu An Sinh"}),p.jsxs("p",{className:"text-sm text-blue-800 mt-1 leading-relaxed",children:["Cc tin tuyn dng t doanh nghip c qu thng (Huy hiu CSR) s c ",p.jsx("strong",{children:"AI u tin hin th"})," ln u trang tm kim v tng 40% t l ng tuyn."]})]})]}),p.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[p.jsxs("div",{className:"p-6 border-b border-gray-200 flex flex-col sm:flex-row sm:items-center justify-between gap-4 bg-gray-50/50",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[p.jsx(JC,{className:"w-6 h-6 text-indigo-600"}),"Nhn s"]}),p.jsxs("div",{className:"flex bg-gray-200 p-1 rounded-lg",children:[p.jsx("button",{onClick:()=>U("active"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${R==="active"?"bg-white text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"ang lm vic"}),p.jsx("button",{onClick:()=>U("terminated"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${R==="terminated"?"bg-white text-red-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Lch s /  ngh"})]})]}),p.jsxs("span",{className:`text-xs font-bold px-3 py-1 rounded-full ${R==="active"?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600"}`,children:[M.length," ",R==="active"?"nhn vin":"h s"]})]}),p.jsx("div",{className:"overflow-x-auto",children:W?p.jsx("div",{className:"p-8",children:p.jsx(ir,{})}):M.length>0?p.jsxs("table",{className:"w-full text-left",children:[p.jsx("thead",{className:"bg-gray-50 border-b",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Nhn vin"}),p.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Cng vic"}),p.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"im tn nhim"}),p.jsx("th",{className:"px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right",children:"Qun l"})]})}),p.jsx("tbody",{className:"divide-y divide-gray-100",children:M.map(ne=>p.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group cursor-pointer",onClick:()=>k(ne),children:[p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsxs("div",{className:"flex items-center",children:[ne.workerProfileImageUrl?p.jsx("img",{src:ne.workerProfileImageUrl,alt:"",className:"h-10 w-10 rounded-full object-cover mr-3 border border-gray-200"}):p.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center mr-3 text-gray-500",children:p.jsx(so,{className:"w-6 h-6"})}),p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-bold text-gray-900",children:ne.workerName}),p.jsx("div",{className:"text-xs text-gray-500",children:ne.contactPhoneNumber})]})]})}),p.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[p.jsx("div",{className:"text-sm font-medium text-gray-900",children:ne.jobTitle}),p.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(ne.applicationDate).toLocaleDateString("vi-VN")]})]}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:p.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(ne.performanceScore||50)>=80?"bg-green-100 text-green-800":(ne.performanceScore||50)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ne.performanceScore||50,"/100"]})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:p.jsx("button",{onClick:z=>{z.stopPropagation(),k(ne)},className:"text-white bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg text-xs font-bold shadow-sm transition-colors opacity-90 group-hover:opacity-100",children:"Chi tit / Tr lng"})})]},ne.id))})]}):p.jsxs("div",{className:"p-12 text-center text-gray-500",children:[p.jsx(JC,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),p.jsx("p",{className:"font-medium",children:R==="active"?"Cha c nhn vin chnh thc no.":"Cha c lch s nhn vin ngh vic."}),R==="active"&&p.jsx("p",{className:"text-sm mt-1 text-gray-400",children:"Hy xc nhn tuyn dng trong phn H S  ng vin."})]})})]})]});return p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"space-y-12 animate-fade-in",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Trung tm An Sinh"}),p.jsx("p",{className:"text-lg text-gray-600",children:"H sinh thi bo v tng lai cho ngi lao ng t do."})]}),(e==null?void 0:e.userType)===Jt.Employer?xe():de(),p.jsxs("div",{className:"space-y-6 pt-6 border-t border-gray-200",children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Sn phm Bo him B sung"}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:Uue.map(ne=>p.jsxs("a",{href:ne.link,target:"_blank",rel:"noopener noreferrer",className:"group block p-5 bg-white rounded-xl border border-gray-200 hover:border-indigo-400 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-50 group-hover:bg-indigo-50 flex items-center justify-center transition-colors",children:ne.icon}),p.jsx($v,{className:"w-5 h-5 text-gray-300 group-hover:text-indigo-600 transition-colors"})]}),p.jsx("p",{className:"font-bold text-gray-800 mt-4 group-hover:text-indigo-700 transition-colors",children:ne.title}),p.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:ne.description})]},ne.title))})]})]}),r&&p.jsx(kue,{onClose:()=>i(!1),walletConnected:s.isConnected,onTransactionSuccess:Ee,recipientAddress:x,title:A}),D&&p.jsx(Fue,{employee:D,onClose:()=>k(null),onPay:ne=>{k(null),le(D)}})]})},f7=n=>{const[e,t]=Y.useState({isOnline:!1,statusText:null});return Y.useEffect(()=>{if(!n){t({isOnline:!1,statusText:null});return}const r=JE.ref(`/users/${n}/status`),i=r.on("value",s=>{const o=s.val();if(o!=null&&o.isOnline)t({isOnline:!0,statusText:"ang hot ng"});else if(o!=null&&o.lastSeen&&typeof o.lastSeen=="number")try{const a=new Date(o.lastSeen).toISOString();t({isOnline:!1,statusText:`Hot ng ${Dk(a,"presence")}`})}catch{console.warn("Invalid lastSeen date for user:",n,o.lastSeen),t({isOnline:!1,statusText:"Khng hot ng"})}else t({isOnline:!1,statusText:"Khng hot ng"})},s=>{console.warn("Error reading presence:",s),t({isOnline:!1,statusText:null})});return()=>r.off("value",i)},[n]),e},p7=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.85.064-1.649-.24-2.228-.796a4.425 4.425 0 01-1.16-3.197V8.511c0-.969.616-1.813 1.5-2.097L16.5 6.25l3.75 2.261zM3.75 14.25a2.25 2.25 0 002.25 2.25h3.75V15.75h-3.75a.75.75 0 01-.75-.75V8.25a.75.75 0 01.75-.75h3.75V6.75h-3.75a2.25 2.25 0 00-2.25 2.25v6z"})}),m7=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),Hue=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),Gue=({className:n="w-6 h-6"})=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 12.75l6 6 9-13.5",opacity:"0.5"})]}),jue=({status:n})=>n==="read"?p.jsx(Gue,{className:"w-4 h-4 text-blue-500"}):p.jsx(Hue,{className:"w-4 h-4 text-gray-400"}),que=({convo:n,isActive:e,currentUserId:t,onClick:r})=>{var c;const i=n.participants.find(d=>d!==t),s=i?n.participantInfo[i]:null,{isOnline:o}=f7(i||null),a=((c=n.unreadCounts)==null?void 0:c[t])||0;return p.jsxs("div",{onClick:r,className:`p-4 flex items-center space-x-3 cursor-pointer transition-colors ${e?"bg-indigo-50":"hover:bg-gray-50"}`,children:[p.jsxs("div",{className:"relative flex-shrink-0",children:[s!=null&&s.profileImageUrl?p.jsx("img",{src:s.profileImageUrl,alt:"",className:"w-12 h-12 rounded-full object-cover"}):p.jsx(so,{className:"w-12 h-12"}),o&&p.jsx("span",{className:"w-3.5 h-3.5 bg-green-500 rounded-full absolute bottom-0 right-0 border-2 border-white"})]}),p.jsxs("div",{className:"flex-grow overflow-hidden",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("p",{className:`font-semibold text-gray-800 truncate ${a>0?"font-bold":""}`,children:s==null?void 0:s.fullName}),a>0&&p.jsx("span",{className:"bg-indigo-600 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full flex-shrink-0",children:a})]}),p.jsx("p",{className:`text-sm truncate ${a>0?"text-indigo-700 font-semibold":"text-gray-500"}`,children:n.lastMessage})]})]})},zue=({initialSelectedConversationId:n,clearInitialSelection:e})=>{const{currentUser:t,currentUserData:r}=wa(),[i,s]=Y.useState([]),[o,a]=Y.useState(null),[c,d]=Y.useState([]),[h,m]=Y.useState(""),[_,x]=Y.useState(!0),[b,A]=Y.useState(!1),[N,F]=Y.useState(!1),B=(o==null?void 0:o.participants.find(M=>M!==(t==null?void 0:t.uid)))||null,O=B&&o?o.participantInfo[B]:null,{statusText:q}=f7(B),W=Y.useRef(null);Y.useEffect(()=>{if(!t)return;x(!0);const M=o8(t.uid,j=>{if(s(j),x(!1),n){const V=j.find(Ee=>Ee.id===n);V&&a(V),e()}});return()=>M()},[t,n,e]),Y.useEffect(()=>{if(!o||!t){d([]);return}A(!0),Ise(o.id,t.uid),Ase(o.id,t.uid);const M=xse(o.id,j=>{d(j),A(!1)});return()=>M()},[o,t]),Y.useEffect(()=>{var M;(M=W.current)==null||M.scrollIntoView({behavior:"smooth"})},[c]);const $=async M=>{if(M.preventDefault(),!(!h.trim()||!o||!t||!(r!=null&&r.fullName))){F(!0);try{await Tse(o.id,t.uid,r.fullName,h),m("")}catch(j){console.error("Failed to send message:",j)}finally{F(!1)}}},D=async M=>{if(!(!t||!o||M.senderId!==t.uid)&&window.confirm("Bn c chc mun thu hi tin nhn ny khng?"))try{await bse(o.id,M.id,t.uid,M.senderId)}catch(j){console.error("Failed to delete message:",j),alert(" c li xy ra khi thu hi tin nhn.")}},k=window.innerWidth<768,R=!k||k&&!o,U=!k||k&&o;return p.jsxs("div",{className:"flex h-full bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[R&&p.jsxs("div",{className:`w-full md:w-1/3 border-r border-gray-200 flex flex-col ${!o&&k?"":"hidden md:flex"}`,children:[p.jsx("div",{className:"p-4 border-b border-gray-200",children:p.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tin nhn"})}),p.jsx("div",{className:"flex-grow overflow-y-auto",children:_?p.jsx(ir,{}):i.length>0?i.map(M=>p.jsx(que,{convo:M,isActive:(o==null?void 0:o.id)===M.id,currentUserId:t.uid,onClick:()=>a(M)},M.id)):p.jsx("div",{className:"p-6 text-center text-gray-500",children:p.jsx("p",{children:"Cha c cuc tr chuyn no."})})})]}),U&&p.jsx("div",{className:"w-full md:w-2/3 flex flex-col",children:o?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center space-x-3",children:[k&&p.jsx("button",{onClick:()=>a(null),className:"p-2 rounded-full hover:bg-gray-100",children:p.jsx(m7,{className:"w-5 h-5"})}),p.jsx("div",{className:"relative flex-shrink-0",children:O!=null&&O.profileImageUrl?p.jsx("img",{src:O.profileImageUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):p.jsx(so,{className:"w-10 h-10"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-gray-800",children:O==null?void 0:O.fullName}),q&&p.jsx("p",{className:"text-xs text-gray-500",children:q})]})]}),p.jsxs("div",{className:"flex-grow p-4 space-y-2 overflow-y-auto bg-gray-50",children:[b?p.jsx(ir,{}):c.map(M=>p.jsxs("div",{className:`flex flex-col group ${M.senderId===(t==null?void 0:t.uid)?"items-end":"items-start"}`,children:[p.jsxs("div",{className:`flex items-end gap-2 ${M.senderId===(t==null?void 0:t.uid)?"flex-row-reverse":"flex-row"}`,children:[M.senderId===(t==null?void 0:t.uid)&&!M.deleted&&p.jsx("button",{onClick:()=>D(M),className:"opacity-0 group-hover:opacity-100 transition-opacity text-gray-400 hover:text-red-500 p-1 mb-1",children:p.jsx(X0,{className:"w-4 h-4"})}),p.jsx("div",{className:`max-w-xs md:max-w-md px-4 py-2 rounded-2xl break-words whitespace-pre-wrap ${M.deleted?"bg-transparent text-gray-500 italic":M.senderId===(t==null?void 0:t.uid)?"bg-indigo-600 text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-200"}`,children:p.jsx("p",{className:"text-sm",children:M.text})})]}),!M.deleted&&p.jsxs("div",{className:"flex items-center text-xs text-gray-400 mt-1 px-1",children:[p.jsx("span",{className:"mr-1",children:Dk(M.timestamp)}),M.senderId===(t==null?void 0:t.uid)&&p.jsx(jue,{status:M.status})]})]},M.id)),p.jsx("div",{ref:W})]}),p.jsx("div",{className:"p-4 bg-white border-t border-gray-200",children:p.jsxs("form",{onSubmit:$,className:"flex items-center space-x-3",children:[p.jsx("input",{type:"text",value:h,onChange:M=>m(M.target.value),placeholder:"Nhp tin nhn...",className:"flex-1 p-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500",disabled:N}),p.jsx("button",{type:"submit",disabled:N||!h.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors",children:p.jsx(Sx,{className:"h-6 w-6"})})]})})]}):p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-gray-500 p-4",children:[p.jsx(p7,{className:"w-16 h-16 text-gray-300 mb-4"}),p.jsx("h3",{className:"text-xl font-semibold",children:"Chn mt cuc tr chuyn"}),p.jsx("p",{children:"Bt u lin lc vi nh tuyn dng hoc ngi lao ng ti y."})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let $ue,Wue;function Kue(){return{geminiUrl:$ue,vertexUrl:Wue}}function Que(n,e,t,r){var i,s;if(!(n!=null&&n.baseUrl)){const o=Kue();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:t:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sl{}function De(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function y(n,e,t){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const c=n[a];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];y(h,e.slice(s+1),t[d])}else for(const d of c)y(d,e.slice(s+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const c=n[a];y(c[0],e.slice(s+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[r]=t}function g(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let r=0;r<e.length;r++){if(typeof n!="object"||n===null)return t;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in n){const o=n[s];return Array.isArray(o)?o.map(a=>g(a,e.slice(r+1),t)):t}else return t}else n=n[i]}return n}catch(r){if(r instanceof TypeError)return t;throw r}}function Jue(n,e){for(const[t,r]of Object.entries(e)){const i=t.split("."),s=r.split("."),o=new Set;let a=-1;for(let c=0;c<i.length;c++)if(i[c]==="*"){a=c;break}if(a!==-1&&s.length>a)for(let c=a;c<s.length;c++){const d=s[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&o.add(d)}MS(n,i,s,0,o)}}function MS(n,e,t,r,i){if(r>=e.length||typeof n!="object"||n===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=n;if(o in a&&Array.isArray(a[o]))for(const c of a[o])MS(c,e,t,r+1,i)}else if(s==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,a=Object.keys(o).filter(d=>!d.startsWith("_")&&!i.has(d)),c={};for(const d of a)c[d]=o[d];for(const[d,h]of Object.entries(c)){const m=[];for(const _ of t.slice(r))_==="*"?m.push(d):m.push(_);y(o,m,h)}for(const d of a)delete o[d]}}else{const o=n;s in o&&MS(o[s],e,t,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eP(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yue(n){const e={},t=g(n,["operationName"]);t!=null&&y(e,["operationName"],t);const r=g(n,["resourceName"]);return r!=null&&y(e,["_url","resourceName"],r),e}function Xue(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response","generateVideoResponse"]);return o!=null&&y(e,["response"],ede(o)),e}function Zue(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response"]);return o!=null&&y(e,["response"],tde(o)),e}function ede(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>nde(o))),y(e,["generatedVideos"],s)}const r=g(n,["raiMediaFilteredCount"]);r!=null&&y(e,["raiMediaFilteredCount"],r);const i=g(n,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function tde(n){const e={},t=g(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>rde(o))),y(e,["generatedVideos"],s)}const r=g(n,["raiMediaFilteredCount"]);r!=null&&y(e,["raiMediaFilteredCount"],r);const i=g(n,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function nde(n){const e={},t=g(n,["video"]);return t!=null&&y(e,["video"],cde(t)),e}function rde(n){const e={},t=g(n,["_self"]);return t!=null&&y(e,["video"],ude(t)),e}function ide(n){const e={},t=g(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function sde(n){const e={},t=g(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function ode(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response"]);return o!=null&&y(e,["response"],ade(o)),e}function ade(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["parent"]);r!=null&&y(e,["parent"],r);const i=g(n,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function g7(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response"]);return o!=null&&y(e,["response"],lde(o)),e}function lde(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["parent"]);r!=null&&y(e,["parent"],r);const i=g(n,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function cde(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const r=g(n,["encodedVideo"]);r!=null&&y(e,["videoBytes"],eP(r));const i=g(n,["encoding"]);return i!=null&&y(e,["mimeType"],i),e}function ude(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const r=g(n,["bytesBase64Encoded"]);r!=null&&y(e,["videoBytes"],eP(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uV;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(uV||(uV={}));var dV;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(dV||(dV={}));var hV;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(hV||(hV={}));var Gc;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Gc||(Gc={}));var fV;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(fV||(fV={}));var pV;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(pV||(pV={}));var mV;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(mV||(mV={}));var gV;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(gV||(gV={}));var yV;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(yV||(yV={}));var wV;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(wV||(wV={}));var _V;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(_V||(_V={}));var vV;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(vV||(vV={}));var EV;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(EV||(EV={}));var xV;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(xV||(xV={}));var TV;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(TV||(TV={}));var IV;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(IV||(IV={}));var AV;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(AV||(AV={}));var bV;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(bV||(bV={}));var CV;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(CV||(CV={}));var fx;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(fx||(fx={}));var SV;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(SV||(SV={}));var NV;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(NV||(NV={}));var kV;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(kV||(kV={}));var LS;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(LS||(LS={}));var PV;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(PV||(PV={}));var RV;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(RV||(RV={}));var DV;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(DV||(DV={}));var MV;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(MV||(MV={}));var LV;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(LV||(LV={}));var OV;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(OV||(OV={}));var VV;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(VV||(VV={}));var FV;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(FV||(FV={}));var UV;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(UV||(UV={}));var BV;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(BV||(BV={}));var HV;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(HV||(HV={}));var GV;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(GV||(GV={}));var jV;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(jV||(jV={}));var qV;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(qV||(qV={}));var zV;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(zV||(zV={}));var $V;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})($V||($V={}));var WV;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(WV||(WV={}));var KV;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(KV||(KV={}));var QV;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(QV||(QV={}));var JV;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(JV||(JV={}));var YV;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(YV||(YV={}));var XV;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(XV||(XV={}));var ZV;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(ZV||(ZV={}));var e5;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(e5||(e5={}));var t5;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(t5||(t5={}));var n5;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(n5||(n5={}));var r5;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(r5||(r5={}));var i5;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(i5||(i5={}));var s5;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(s5||(s5={}));var o5;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(o5||(o5={}));var $f;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})($f||($f={}));class OS{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class gy{get text(){var e,t,r,i,s,o,a,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const m=[];for(const _ of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[x,b]of Object.entries(_))x!=="text"&&x!=="thought"&&x!=="thoughtSignature"&&(b!==null||b!==void 0)&&m.push(x);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;h=!0,d+=_.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,r,i,s,o,a,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const m of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[_,x]of Object.entries(m))_!=="inlineData"&&(x!==null||x!==void 0)&&h.push(_);m.inlineData&&typeof m.inlineData.data=="string"&&(d+=atob(m.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,i,s,o,a,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,t,r,i,s,o,a,c,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,i,s,o,a,c,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class a5{}class l5{}class dde{}class hde{}class fde{}class pde{}class c5{}class u5{}class d5{}class mde{}class px{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new px;let i;const s=e;return t?i=Zue(s):i=Xue(s),Object.assign(r,i),r}}class h5{}class f5{}class p5{}class gde{}class yde{}class wde{}class tP{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new tP,s=ode(e);return Object.assign(r,s),r}}class _de{}class vde{}class Ede{}class m5{}class xde{get text(){var e,t,r;let i="",s=!1;const o=[];for(const a of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(a))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,r;let i="";const s=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[a,c]of Object.entries(o))a!=="inlineData"&&c!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Tde{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class nP{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new nP,s=g7(e);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function y7(n,e){const t=Rt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function w7(n){return Array.isArray(n)?n.map(e=>mx(e)):[mx(n)]}function mx(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function _7(n){const e=mx(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function v7(n){const e=mx(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function g5(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function E7(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>g5(e)):[g5(n)]}function VS(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function y5(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function w5(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Or(n){if(n==null)throw new Error("ContentUnion is required");return VS(n)?n:{role:"user",parts:E7(n)}}function rP(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Or(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Or(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Or(t)):[Or(e)]}function xs(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(y5(n)||w5(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Or(n)]}const e=[],t=[],r=VS(n[0]);for(const i of n){const s=VS(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(y5(i)||w5(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return r||e.push({role:"user",parts:E7(t)}),e}function Ide(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.values(Gc).includes(t[0].toUpperCase())?t[0].toUpperCase():Gc.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.values(Gc).includes(r.toUpperCase())?r.toUpperCase():Gc.TYPE_UNSPECIFIED})}}function cp(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=n.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,n=s[1]):s[1].type==="null"&&(e.nullable=!0,n=s[0])),n.type instanceof Array&&Ide(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Gc).includes(a.toUpperCase())?a.toUpperCase():Gc.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=cp(a);else if(r.includes(o)){const c=[];for(const d of a){if(d.type=="null"){e.nullable=!0;continue}c.push(cp(d))}e[o]=c}else if(i.includes(o)){const c={};for(const[d,h]of Object.entries(a))c[d]=cp(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=a}return e}function iP(n){return cp(n)}function sP(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function oP(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function sg(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=cp(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=cp(e.response));return n}function og(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Ade(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function Nl(n,e){if(typeof e!="string")throw new Error("name must be a string");return Ade(n,e,"cachedContents")}function x7(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Iu(n){return eP(n)}function bde(n){return n!=null&&typeof n=="object"&&"name"in n}function Cde(n){return n!=null&&typeof n=="object"&&"video"in n}function Sde(n){return n!=null&&typeof n=="object"&&"uri"in n}function T7(n){var e;let t;if(bde(n)&&(t=n.name),!(Sde(n)&&(t=n.uri,t===void 0))&&!(Cde(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function I7(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function A7(n){for(const e of["models","tunedModels","publisherModels"])if(Nde(n,e))return n[e];return[]}function Nde(n,e){return n!==null&&typeof n=="object"&&e in n}function kde(n,e={}){const t=n,r={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(r.responseJsonSchema=t.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function Pde(n,e={}){const t=[],r=new Set;for(const i of n){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=kde(i,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function b7(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const r=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Rde(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function C7(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const c=o.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function ag(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function S7(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dde(n){const e={},t=g(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const r=g(n,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>fhe(o))),y(e,["inlinedResponses"],s)}const i=g(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["inlinedEmbedContentResponses"],s)}return e}function Mde(n){const e={},t=g(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const r=g(n,["gcsDestination","outputUriPrefix"]);r!=null&&y(e,["gcsUri"],r);const i=g(n,["bigqueryDestination","outputUri"]);return i!=null&&y(e,["bigqueryUri"],i),e}function Lde(n){const e={},t=g(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const r=g(n,["gcsUri"]);r!=null&&y(e,["gcsDestination","outputUriPrefix"],r);const i=g(n,["bigqueryUri"]);if(i!=null&&y(e,["bigqueryDestination","outputUri"],i),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function sE(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata","displayName"]);r!=null&&y(e,["displayName"],r);const i=g(n,["metadata","state"]);i!=null&&y(e,["state"],S7(i));const s=g(n,["metadata","createTime"]);s!=null&&y(e,["createTime"],s);const o=g(n,["metadata","endTime"]);o!=null&&y(e,["endTime"],o);const a=g(n,["metadata","updateTime"]);a!=null&&y(e,["updateTime"],a);const c=g(n,["metadata","model"]);c!=null&&y(e,["model"],c);const d=g(n,["metadata","output"]);return d!=null&&y(e,["dest"],Dde(C7(d))),e}function FS(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["displayName"]);r!=null&&y(e,["displayName"],r);const i=g(n,["state"]);i!=null&&y(e,["state"],S7(i));const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["createTime"]);o!=null&&y(e,["createTime"],o);const a=g(n,["startTime"]);a!=null&&y(e,["startTime"],a);const c=g(n,["endTime"]);c!=null&&y(e,["endTime"],c);const d=g(n,["updateTime"]);d!=null&&y(e,["updateTime"],d);const h=g(n,["model"]);h!=null&&y(e,["model"],h);const m=g(n,["inputConfig"]);m!=null&&y(e,["src"],Ode(m));const _=g(n,["outputConfig"]);_!=null&&y(e,["dest"],Mde(C7(_)));const x=g(n,["completionStats"]);return x!=null&&y(e,["completionStats"],x),e}function Ode(n){const e={},t=g(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const r=g(n,["gcsSource","uris"]);r!=null&&y(e,["gcsUri"],r);const i=g(n,["bigquerySource","inputUri"]);return i!=null&&y(e,["bigqueryUri"],i),e}function Vde(n,e){const t={};if(g(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=g(e,["fileName"]);r!=null&&y(t,["fileName"],r);const i=g(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>hhe(n,o))),y(t,["requests","requests"],s)}return t}function Fde(n){const e={},t=g(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const r=g(n,["gcsUri"]);r!=null&&y(e,["gcsSource","uris"],r);const i=g(n,["bigqueryUri"]);if(i!=null&&y(e,["bigquerySource","inputUri"],i),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Ude(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function Bde(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function Hde(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function Gde(n){const e={},t=g(n,["content"]);t!=null&&y(e,["content"],t);const r=g(n,["citationMetadata"]);r!=null&&y(e,["citationMetadata"],jde(r));const i=g(n,["tokenCount"]);i!=null&&y(e,["tokenCount"],i);const s=g(n,["finishReason"]);s!=null&&y(e,["finishReason"],s);const o=g(n,["avgLogprobs"]);o!=null&&y(e,["avgLogprobs"],o);const a=g(n,["groundingMetadata"]);a!=null&&y(e,["groundingMetadata"],a);const c=g(n,["index"]);c!=null&&y(e,["index"],c);const d=g(n,["logprobsResult"]);d!=null&&y(e,["logprobsResult"],d);const h=g(n,["safetyRatings"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(x=>x)),y(e,["safetyRatings"],_)}const m=g(n,["urlContextMetadata"]);return m!=null&&y(e,["urlContextMetadata"],m),e}function jde(n){const e={},t=g(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),y(e,["citations"],r)}return e}function N7(n){const e={},t=g(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>vhe(s))),y(e,["parts"],i)}const r=g(n,["role"]);return r!=null&&y(e,["role"],r),e}function qde(n,e){const t={},r=g(n,["displayName"]);if(e!==void 0&&r!=null&&y(e,["batch","displayName"],r),g(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function zde(n,e){const t={},r=g(n,["displayName"]);e!==void 0&&r!=null&&y(e,["displayName"],r);const i=g(n,["dest"]);return e!==void 0&&i!=null&&y(e,["outputConfig"],Lde(Rde(i))),t}function _5(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["src"]);i!=null&&y(t,["batch","inputConfig"],Vde(n,b7(n,i)));const s=g(e,["config"]);return s!=null&&qde(s,t),t}function $de(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["model"],Rt(n,r));const i=g(e,["src"]);i!=null&&y(t,["inputConfig"],Fde(b7(n,i)));const s=g(e,["config"]);return s!=null&&zde(s,t),t}function Wde(n,e){const t={},r=g(n,["displayName"]);return e!==void 0&&r!=null&&y(e,["batch","displayName"],r),t}function Kde(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["src"]);i!=null&&y(t,["batch","inputConfig"],the(n,i));const s=g(e,["config"]);return s!=null&&Wde(s,t),t}function Qde(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function Jde(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function Yde(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["name"]);r!=null&&y(e,["name"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);return s!=null&&y(e,["error"],s),e}function Xde(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["name"]);r!=null&&y(e,["name"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);return s!=null&&y(e,["error"],s),e}function Zde(n,e){const t={},r=g(e,["contents"]);if(r!=null){let s=rP(n,r);Array.isArray(s)&&(s=s.map(o=>o)),y(t,["requests[]","request","content"],s)}const i=g(e,["config"]);return i!=null&&(y(t,["_self"],ehe(i,t)),Jue(t,{"requests[].*":"requests[].request.*"})),t}function ehe(n,e){const t={},r=g(n,["taskType"]);e!==void 0&&r!=null&&y(e,["requests[]","taskType"],r);const i=g(n,["title"]);e!==void 0&&i!=null&&y(e,["requests[]","title"],i);const s=g(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&y(e,["requests[]","outputDimensionality"],s),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function the(n,e){const t={},r=g(e,["fileName"]);r!=null&&y(t,["file_name"],r);const i=g(e,["inlinedRequests"]);return i!=null&&y(t,["requests"],Zde(n,i)),t}function nhe(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function rhe(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const r=g(n,["args"]);r!=null&&y(e,["args"],r);const i=g(n,["name"]);if(i!=null&&y(e,["name"],i),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ihe(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const r=g(n,["allowedFunctionNames"]);if(r!=null&&y(e,["allowedFunctionNames"],r),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function she(n,e,t){const r={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],N7(Or(i)));const s=g(e,["temperature"]);s!=null&&y(r,["temperature"],s);const o=g(e,["topP"]);o!=null&&y(r,["topP"],o);const a=g(e,["topK"]);a!=null&&y(r,["topK"],a);const c=g(e,["candidateCount"]);c!=null&&y(r,["candidateCount"],c);const d=g(e,["maxOutputTokens"]);d!=null&&y(r,["maxOutputTokens"],d);const h=g(e,["stopSequences"]);h!=null&&y(r,["stopSequences"],h);const m=g(e,["responseLogprobs"]);m!=null&&y(r,["responseLogprobs"],m);const _=g(e,["logprobs"]);_!=null&&y(r,["logprobs"],_);const x=g(e,["presencePenalty"]);x!=null&&y(r,["presencePenalty"],x);const b=g(e,["frequencyPenalty"]);b!=null&&y(r,["frequencyPenalty"],b);const A=g(e,["seed"]);A!=null&&y(r,["seed"],A);const N=g(e,["responseMimeType"]);N!=null&&y(r,["responseMimeType"],N);const F=g(e,["responseSchema"]);F!=null&&y(r,["responseSchema"],iP(F));const B=g(e,["responseJsonSchema"]);if(B!=null&&y(r,["responseJsonSchema"],B),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const O=g(e,["safetySettings"]);if(t!==void 0&&O!=null){let j=O;Array.isArray(j)&&(j=j.map(V=>Ehe(V))),y(t,["safetySettings"],j)}const q=g(e,["tools"]);if(t!==void 0&&q!=null){let j=og(q);Array.isArray(j)&&(j=j.map(V=>The(sg(V)))),y(t,["tools"],j)}const W=g(e,["toolConfig"]);if(t!==void 0&&W!=null&&y(t,["toolConfig"],xhe(W)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=g(e,["cachedContent"]);t!==void 0&&$!=null&&y(t,["cachedContent"],Nl(n,$));const D=g(e,["responseModalities"]);D!=null&&y(r,["responseModalities"],D);const k=g(e,["mediaResolution"]);k!=null&&y(r,["mediaResolution"],k);const R=g(e,["speechConfig"]);if(R!=null&&y(r,["speechConfig"],sP(R)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=g(e,["thinkingConfig"]);U!=null&&y(r,["thinkingConfig"],U);const M=g(e,["imageConfig"]);return M!=null&&y(r,["imageConfig"],dhe(M)),r}function ohe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Gde(d))),y(e,["candidates"],c)}const i=g(n,["modelVersion"]);i!=null&&y(e,["modelVersion"],i);const s=g(n,["promptFeedback"]);s!=null&&y(e,["promptFeedback"],s);const o=g(n,["responseId"]);o!=null&&y(e,["responseId"],o);const a=g(n,["usageMetadata"]);return a!=null&&y(e,["usageMetadata"],a),e}function ahe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function lhe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],ag(n,r)),t}function che(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function uhe(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function dhe(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const r=g(n,["imageSize"]);if(r!=null&&y(e,["imageSize"],r),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function hhe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["request","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let a=xs(i);Array.isArray(a)&&(a=a.map(c=>N7(c))),y(t,["request","contents"],a)}const s=g(e,["metadata"]);s!=null&&y(t,["metadata"],s);const o=g(e,["config"]);return o!=null&&y(t,["request","generationConfig"],she(n,o,g(t,["request"],{}))),t}function fhe(n){const e={},t=g(n,["response"]);t!=null&&y(e,["response"],ohe(t));const r=g(n,["error"]);return r!=null&&y(e,["error"],r),e}function phe(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);if(e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),g(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function mhe(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);e!==void 0&&i!=null&&y(e,["_query","pageToken"],i);const s=g(n,["filter"]);return e!==void 0&&s!=null&&y(e,["_query","filter"],s),t}function ghe(n){const e={},t=g(n,["config"]);return t!=null&&phe(t,e),e}function yhe(n){const e={},t=g(n,["config"]);return t!=null&&mhe(t,e),e}function whe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>sE(o))),y(e,["batchJobs"],s)}return e}function _he(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>FS(o))),y(e,["batchJobs"],s)}return e}function vhe(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const r=g(n,["codeExecutionResult"]);r!=null&&y(e,["codeExecutionResult"],r);const i=g(n,["executableCode"]);i!=null&&y(e,["executableCode"],i);const s=g(n,["fileData"]);s!=null&&y(e,["fileData"],nhe(s));const o=g(n,["functionCall"]);o!=null&&y(e,["functionCall"],rhe(o));const a=g(n,["functionResponse"]);a!=null&&y(e,["functionResponse"],a);const c=g(n,["inlineData"]);c!=null&&y(e,["inlineData"],Ude(c));const d=g(n,["text"]);d!=null&&y(e,["text"],d);const h=g(n,["thought"]);h!=null&&y(e,["thought"],h);const m=g(n,["thoughtSignature"]);m!=null&&y(e,["thoughtSignature"],m);const _=g(n,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function Ehe(n){const e={},t=g(n,["category"]);if(t!=null&&y(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=g(n,["threshold"]);return r!=null&&y(e,["threshold"],r),e}function xhe(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],ihe(t));const r=g(n,["retrievalConfig"]);return r!=null&&y(e,["retrievalConfig"],r),e}function The(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(m=>m)),y(e,["functionDeclarations"],h)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(n,["googleSearchRetrieval"]);r!=null&&y(e,["googleSearchRetrieval"],r);const i=g(n,["computerUse"]);i!=null&&y(e,["computerUse"],i);const s=g(n,["fileSearch"]);s!=null&&y(e,["fileSearch"],s);const o=g(n,["codeExecution"]);if(o!=null&&y(e,["codeExecution"],o),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(n,["googleMaps"]);a!=null&&y(e,["googleMaps"],che(a));const c=g(n,["googleSearch"]);c!=null&&y(e,["googleSearch"],uhe(c));const d=g(n,["urlContext"]);return d!=null&&y(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var _l;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(_l||(_l={}));class Uh{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ihe extends Sl{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new Uh(_l.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=_5(this.apiClient,e),r=t._url,i=De("{model}:batchGenerateContent",r),a=t.batch.inputConfig.requests,c=a.requests,d=[];for(const h of c){const m=Object.assign({},h);if(m.systemInstruction){const _=m.systemInstruction;delete m.systemInstruction;const x=m.request;x.systemInstruction=_,m.request=x}d.push(m)}return a.requests=d,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const r=t?Object.assign({},t):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=$de(this.apiClient,e);return a=De("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>FS(h))}else{const d=_5(this.apiClient,e);return a=De("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>sE(h))}}async createEmbeddingsInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Kde(this.apiClient,e);return s=De("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>sE(c))}}async get(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=lhe(this.apiClient,e);return a=De("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>FS(h))}else{const d=ahe(this.apiClient,e);return a=De("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>sE(h))}}async cancel(e){var t,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const c=Hde(this.apiClient,e);o=De("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=Bde(this.apiClient,e);o=De("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=yhe(e);return a=De("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=_he(h),_=new m5;return Object.assign(_,m),_})}else{const d=ghe(e);return a=De("batches",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=whe(h),_=new m5;return Object.assign(_,m),_})}}async delete(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Jde(this.apiClient,e);return a=De("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>Xde(h))}else{const d=Qde(this.apiClient,e);return a=De("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>Yde(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ahe(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function v5(n){const e={},t=g(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Khe(s))),y(e,["parts"],i)}const r=g(n,["role"]);return r!=null&&y(e,["role"],r),e}function bhe(n,e){const t={},r=g(n,["ttl"]);e!==void 0&&r!=null&&y(e,["ttl"],r);const i=g(n,["expireTime"]);e!==void 0&&i!=null&&y(e,["expireTime"],i);const s=g(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const o=g(n,["contents"]);if(e!==void 0&&o!=null){let h=xs(o);Array.isArray(h)&&(h=h.map(m=>v5(m))),y(e,["contents"],h)}const a=g(n,["systemInstruction"]);e!==void 0&&a!=null&&y(e,["systemInstruction"],v5(Or(a)));const c=g(n,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(m=>Jhe(m))),y(e,["tools"],h)}const d=g(n,["toolConfig"]);if(e!==void 0&&d!=null&&y(e,["toolConfig"],Qhe(d)),g(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function Che(n,e){const t={},r=g(n,["ttl"]);e!==void 0&&r!=null&&y(e,["ttl"],r);const i=g(n,["expireTime"]);e!==void 0&&i!=null&&y(e,["expireTime"],i);const s=g(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const o=g(n,["contents"]);if(e!==void 0&&o!=null){let m=xs(o);Array.isArray(m)&&(m=m.map(_=>_)),y(e,["contents"],m)}const a=g(n,["systemInstruction"]);e!==void 0&&a!=null&&y(e,["systemInstruction"],Or(a));const c=g(n,["tools"]);if(e!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(_=>Yhe(_))),y(e,["tools"],m)}const d=g(n,["toolConfig"]);e!==void 0&&d!=null&&y(e,["toolConfig"],d);const h=g(n,["kmsKeyName"]);return e!==void 0&&h!=null&&y(e,["encryption_spec","kmsKeyName"],h),t}function She(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["model"],y7(n,r));const i=g(e,["config"]);return i!=null&&bhe(i,t),t}function Nhe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["model"],y7(n,r));const i=g(e,["config"]);return i!=null&&Che(i,t),t}function khe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],Nl(n,r)),t}function Phe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],Nl(n,r)),t}function Rhe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function Dhe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function Mhe(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function Lhe(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const r=g(n,["args"]);r!=null&&y(e,["args"],r);const i=g(n,["name"]);if(i!=null&&y(e,["name"],i),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Ohe(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const r=g(n,["allowedFunctionNames"]);if(r!=null&&y(e,["allowedFunctionNames"],r),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Vhe(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const r=g(n,["name"]);r!=null&&y(e,["name"],r);const i=g(n,["parameters"]);i!=null&&y(e,["parameters"],i);const s=g(n,["parametersJsonSchema"]);s!=null&&y(e,["parametersJsonSchema"],s);const o=g(n,["response"]);o!=null&&y(e,["response"],o);const a=g(n,["responseJsonSchema"]);return a!=null&&y(e,["responseJsonSchema"],a),e}function Fhe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],Nl(n,r)),t}function Uhe(n,e){const t={},r=g(e,["name"]);return r!=null&&y(t,["_url","name"],Nl(n,r)),t}function Bhe(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function Hhe(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function Ghe(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function jhe(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function qhe(n){const e={},t=g(n,["config"]);return t!=null&&Ghe(t,e),e}function zhe(n){const e={},t=g(n,["config"]);return t!=null&&jhe(t,e),e}function $he(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["cachedContents"],s)}return e}function Whe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["cachedContents"],s)}return e}function Khe(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const r=g(n,["codeExecutionResult"]);r!=null&&y(e,["codeExecutionResult"],r);const i=g(n,["executableCode"]);i!=null&&y(e,["executableCode"],i);const s=g(n,["fileData"]);s!=null&&y(e,["fileData"],Mhe(s));const o=g(n,["functionCall"]);o!=null&&y(e,["functionCall"],Lhe(o));const a=g(n,["functionResponse"]);a!=null&&y(e,["functionResponse"],a);const c=g(n,["inlineData"]);c!=null&&y(e,["inlineData"],Ahe(c));const d=g(n,["text"]);d!=null&&y(e,["text"],d);const h=g(n,["thought"]);h!=null&&y(e,["thought"],h);const m=g(n,["thoughtSignature"]);m!=null&&y(e,["thoughtSignature"],m);const _=g(n,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function Qhe(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],Ohe(t));const r=g(n,["retrievalConfig"]);return r!=null&&y(e,["retrievalConfig"],r),e}function Jhe(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(m=>m)),y(e,["functionDeclarations"],h)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(n,["googleSearchRetrieval"]);r!=null&&y(e,["googleSearchRetrieval"],r);const i=g(n,["computerUse"]);i!=null&&y(e,["computerUse"],i);const s=g(n,["fileSearch"]);s!=null&&y(e,["fileSearch"],s);const o=g(n,["codeExecution"]);if(o!=null&&y(e,["codeExecution"],o),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(n,["googleMaps"]);a!=null&&y(e,["googleMaps"],Bhe(a));const c=g(n,["googleSearch"]);c!=null&&y(e,["googleSearch"],Hhe(c));const d=g(n,["urlContext"]);return d!=null&&y(e,["urlContext"],d),e}function Yhe(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(_=>Vhe(_))),y(e,["functionDeclarations"],m)}const r=g(n,["retrieval"]);r!=null&&y(e,["retrieval"],r);const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);if(s!=null&&y(e,["computerUse"],s),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=g(n,["codeExecution"]);o!=null&&y(e,["codeExecution"],o);const a=g(n,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const c=g(n,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(n,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(n,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function Xhe(n,e){const t={},r=g(n,["ttl"]);e!==void 0&&r!=null&&y(e,["ttl"],r);const i=g(n,["expireTime"]);return e!==void 0&&i!=null&&y(e,["expireTime"],i),t}function Zhe(n,e){const t={},r=g(n,["ttl"]);e!==void 0&&r!=null&&y(e,["ttl"],r);const i=g(n,["expireTime"]);return e!==void 0&&i!=null&&y(e,["expireTime"],i),t}function efe(n,e){const t={},r=g(e,["name"]);r!=null&&y(t,["_url","name"],Nl(n,r));const i=g(e,["config"]);return i!=null&&Xhe(i,t),t}function tfe(n,e){const t={},r=g(e,["name"]);r!=null&&y(t,["_url","name"],Nl(n,r));const i=g(e,["config"]);return i!=null&&Zhe(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nfe extends Sl{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Uh(_l.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Nhe(this.apiClient,e);return a=De("cachedContents",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const d=She(this.apiClient,e);return a=De("cachedContents",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async get(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Uhe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const d=Fhe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async delete(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Phe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Dhe(h),_=new f5;return Object.assign(_,m),_})}else{const d=khe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Rhe(h),_=new f5;return Object.assign(_,m),_})}}async update(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=tfe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const d=efe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async listInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=zhe(e);return a=De("cachedContents",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Whe(h),_=new p5;return Object.assign(_,m),_})}else{const d=qhe(e);return a=De("cachedContents",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=$he(h),_=new p5;return Object.assign(_,m),_})}}}function E5(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function on(n){return this instanceof on?(this.v=n,this):new on(n)}function up(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(x){return function(b){return Promise.resolve(b).then(x,m)}}function a(x,b){r[x]&&(i[x]=function(A){return new Promise(function(N,F){s.push([x,A,N,F])>1||c(x,A)})},b&&(i[x]=b(i[x])))}function c(x,b){try{d(r[x](b))}catch(A){_(s[0][3],A)}}function d(x){x.value instanceof on?Promise.resolve(x.value.v).then(h,m):_(s[0][2],x)}function h(x){c("next",x)}function m(x){c("throw",x)}function _(x,b){x(b),s.shift(),s.length&&c(s[0][0],s[0][1])}}function t0(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof E5=="function"?E5(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(d){s({value:d,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rfe(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:k7(t)}function k7(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function ife(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function x5(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let s=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),s&&!k7(n[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class sfe{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new ofe(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ofe{constructor(e,t,r,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),ife(s)}async sendMessage(e){var t;await this.sendPromise;const r=Or(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,o,a;const c=await i,d=(o=(s=c.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let _=[];h!=null&&(_=(a=h.slice(m))!==null&&a!==void 0?a:[]);const x=d?[d]:[];this.recordHistory(r,x,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const r=Or(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const t=e?x5(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,i;return up(this,arguments,function*(){var o,a,c,d;const h=[];try{for(var m=!0,_=t0(e),x;x=yield on(_.next()),o=x.done,!o;m=!0){d=x.value,m=!1;const b=d;if(rfe(b)){const A=(i=(r=b.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;A!==void 0&&h.push(A)}yield yield on(b)}}catch(b){a={error:b}}finally{try{!m&&!o&&(c=_.return)&&(yield on(c.call(_)))}finally{if(a)throw a.error}}this.recordHistory(t,h)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...x5(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZT extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,ZT.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function afe(n){const e={},t=g(n,["file"]);return t!=null&&y(e,["file"],t),e}function lfe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function cfe(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","file"],T7(t)),e}function ufe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function dfe(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","file"],T7(t)),e}function hfe(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function ffe(n){const e={},t=g(n,["config"]);return t!=null&&hfe(t,e),e}function pfe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mfe extends Sl{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Uh(_l.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ffe(e);return s=De("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=pfe(c),h=new _de;return Object.assign(h,d),h})}}async createInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=afe(e);return s=De("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=lfe(c),h=new vde;return Object.assign(h,d),h})}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=dfe(e);return s=De("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cfe(e);return s=De("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=ufe(c),h=new Ede;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oE(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function gfe(n){const e={},t=g(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Rfe(s))),y(e,["parts"],i)}const r=g(n,["role"]);return r!=null&&y(e,["role"],r),e}function yfe(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function wfe(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const r=g(n,["args"]);r!=null&&y(e,["args"],r);const i=g(n,["name"]);if(i!=null&&y(e,["name"],i),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _fe(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const r=g(n,["name"]);r!=null&&y(e,["name"],r);const i=g(n,["parameters"]);i!=null&&y(e,["parameters"],i);const s=g(n,["parametersJsonSchema"]);s!=null&&y(e,["parametersJsonSchema"],s);const o=g(n,["response"]);o!=null&&y(e,["response"],o);const a=g(n,["responseJsonSchema"]);return a!=null&&y(e,["responseJsonSchema"],a),e}function vfe(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const r=g(n,["responseJsonSchema"]);r!=null&&y(e,["responseJsonSchema"],r);const i=g(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const s=g(n,["candidateCount"]);s!=null&&y(e,["candidateCount"],s);const o=g(n,["enableAffectiveDialog"]);o!=null&&y(e,["enableAffectiveDialog"],o);const a=g(n,["frequencyPenalty"]);a!=null&&y(e,["frequencyPenalty"],a);const c=g(n,["logprobs"]);c!=null&&y(e,["logprobs"],c);const d=g(n,["maxOutputTokens"]);d!=null&&y(e,["maxOutputTokens"],d);const h=g(n,["mediaResolution"]);h!=null&&y(e,["mediaResolution"],h);const m=g(n,["presencePenalty"]);m!=null&&y(e,["presencePenalty"],m);const _=g(n,["responseLogprobs"]);_!=null&&y(e,["responseLogprobs"],_);const x=g(n,["responseMimeType"]);x!=null&&y(e,["responseMimeType"],x);const b=g(n,["responseModalities"]);b!=null&&y(e,["responseModalities"],b);const A=g(n,["responseSchema"]);A!=null&&y(e,["responseSchema"],A);const N=g(n,["routingConfig"]);N!=null&&y(e,["routingConfig"],N);const F=g(n,["seed"]);F!=null&&y(e,["seed"],F);const B=g(n,["speechConfig"]);B!=null&&y(e,["speechConfig"],P7(B));const O=g(n,["stopSequences"]);O!=null&&y(e,["stopSequences"],O);const q=g(n,["temperature"]);q!=null&&y(e,["temperature"],q);const W=g(n,["thinkingConfig"]);W!=null&&y(e,["thinkingConfig"],W);const $=g(n,["topK"]);$!=null&&y(e,["topK"],$);const D=g(n,["topP"]);if(D!=null&&y(e,["topP"],D),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Efe(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function xfe(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function Tfe(n,e){const t={},r=g(n,["generationConfig"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig"],r);const i=g(n,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const s=g(n,["temperature"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","temperature"],s);const o=g(n,["topP"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","topP"],o);const a=g(n,["topK"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","topK"],a);const c=g(n,["maxOutputTokens"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","maxOutputTokens"],c);const d=g(n,["mediaResolution"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","mediaResolution"],d);const h=g(n,["seed"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","seed"],h);const m=g(n,["speechConfig"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","speechConfig"],oP(m));const _=g(n,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=g(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const b=g(n,["systemInstruction"]);e!==void 0&&b!=null&&y(e,["setup","systemInstruction"],gfe(Or(b)));const A=g(n,["tools"]);if(e!==void 0&&A!=null){let $=og(A);Array.isArray($)&&($=$.map(D=>Mfe(sg(D)))),y(e,["setup","tools"],$)}const N=g(n,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],Dfe(N));const F=g(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","inputAudioTranscription"],F);const B=g(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&y(e,["setup","outputAudioTranscription"],B);const O=g(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const q=g(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const W=g(n,["proactivity"]);return e!==void 0&&W!=null&&y(e,["setup","proactivity"],W),t}function Ife(n,e){const t={},r=g(n,["generationConfig"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig"],vfe(r));const i=g(n,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const s=g(n,["temperature"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","temperature"],s);const o=g(n,["topP"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","topP"],o);const a=g(n,["topK"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","topK"],a);const c=g(n,["maxOutputTokens"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","maxOutputTokens"],c);const d=g(n,["mediaResolution"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","mediaResolution"],d);const h=g(n,["seed"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","seed"],h);const m=g(n,["speechConfig"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","speechConfig"],P7(oP(m)));const _=g(n,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=g(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const b=g(n,["systemInstruction"]);e!==void 0&&b!=null&&y(e,["setup","systemInstruction"],Or(b));const A=g(n,["tools"]);if(e!==void 0&&A!=null){let $=og(A);Array.isArray($)&&($=$.map(D=>Lfe(sg(D)))),y(e,["setup","tools"],$)}const N=g(n,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],N);const F=g(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","inputAudioTranscription"],F);const B=g(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&y(e,["setup","outputAudioTranscription"],B);const O=g(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const q=g(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const W=g(n,["proactivity"]);return e!==void 0&&W!=null&&y(e,["setup","proactivity"],W),t}function Afe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["setup","model"],Rt(n,r));const i=g(e,["config"]);return i!=null&&y(t,["config"],Tfe(i,t)),t}function bfe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["setup","model"],Rt(n,r));const i=g(e,["config"]);return i!=null&&y(t,["config"],Ife(i,t)),t}function Cfe(n){const e={},t=g(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function Sfe(n){const e={},t=g(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),y(e,["weightedPrompts"],r)}return e}function Nfe(n){const e={},t=g(n,["media"]);if(t!=null){let d=w7(t);Array.isArray(d)&&(d=d.map(h=>oE(h))),y(e,["mediaChunks"],d)}const r=g(n,["audio"]);r!=null&&y(e,["audio"],oE(v7(r)));const i=g(n,["audioStreamEnd"]);i!=null&&y(e,["audioStreamEnd"],i);const s=g(n,["video"]);s!=null&&y(e,["video"],oE(_7(s)));const o=g(n,["text"]);o!=null&&y(e,["text"],o);const a=g(n,["activityStart"]);a!=null&&y(e,["activityStart"],a);const c=g(n,["activityEnd"]);return c!=null&&y(e,["activityEnd"],c),e}function kfe(n){const e={},t=g(n,["media"]);if(t!=null){let d=w7(t);Array.isArray(d)&&(d=d.map(h=>h)),y(e,["mediaChunks"],d)}const r=g(n,["audio"]);r!=null&&y(e,["audio"],v7(r));const i=g(n,["audioStreamEnd"]);i!=null&&y(e,["audioStreamEnd"],i);const s=g(n,["video"]);s!=null&&y(e,["video"],_7(s));const o=g(n,["text"]);o!=null&&y(e,["text"],o);const a=g(n,["activityStart"]);a!=null&&y(e,["activityStart"],a);const c=g(n,["activityEnd"]);return c!=null&&y(e,["activityEnd"],c),e}function Pfe(n){const e={},t=g(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const r=g(n,["serverContent"]);r!=null&&y(e,["serverContent"],r);const i=g(n,["toolCall"]);i!=null&&y(e,["toolCall"],i);const s=g(n,["toolCallCancellation"]);s!=null&&y(e,["toolCallCancellation"],s);const o=g(n,["usageMetadata"]);o!=null&&y(e,["usageMetadata"],Ofe(o));const a=g(n,["goAway"]);a!=null&&y(e,["goAway"],a);const c=g(n,["sessionResumptionUpdate"]);return c!=null&&y(e,["sessionResumptionUpdate"],c),e}function Rfe(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const r=g(n,["codeExecutionResult"]);r!=null&&y(e,["codeExecutionResult"],r);const i=g(n,["executableCode"]);i!=null&&y(e,["executableCode"],i);const s=g(n,["fileData"]);s!=null&&y(e,["fileData"],yfe(s));const o=g(n,["functionCall"]);o!=null&&y(e,["functionCall"],wfe(o));const a=g(n,["functionResponse"]);a!=null&&y(e,["functionResponse"],a);const c=g(n,["inlineData"]);c!=null&&y(e,["inlineData"],oE(c));const d=g(n,["text"]);d!=null&&y(e,["text"],d);const h=g(n,["thought"]);h!=null&&y(e,["thought"],h);const m=g(n,["thoughtSignature"]);m!=null&&y(e,["thoughtSignature"],m);const _=g(n,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function Dfe(n){const e={},t=g(n,["handle"]);if(t!=null&&y(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function P7(n){const e={},t=g(n,["languageCode"]);t!=null&&y(e,["languageCode"],t);const r=g(n,["voiceConfig"]);if(r!=null&&y(e,["voiceConfig"],r),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Mfe(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(m=>m)),y(e,["functionDeclarations"],h)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(n,["googleSearchRetrieval"]);r!=null&&y(e,["googleSearchRetrieval"],r);const i=g(n,["computerUse"]);i!=null&&y(e,["computerUse"],i);const s=g(n,["fileSearch"]);s!=null&&y(e,["fileSearch"],s);const o=g(n,["codeExecution"]);if(o!=null&&y(e,["codeExecution"],o),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(n,["googleMaps"]);a!=null&&y(e,["googleMaps"],Efe(a));const c=g(n,["googleSearch"]);c!=null&&y(e,["googleSearch"],xfe(c));const d=g(n,["urlContext"]);return d!=null&&y(e,["urlContext"],d),e}function Lfe(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(_=>_fe(_))),y(e,["functionDeclarations"],m)}const r=g(n,["retrieval"]);r!=null&&y(e,["retrieval"],r);const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);if(s!=null&&y(e,["computerUse"],s),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=g(n,["codeExecution"]);o!=null&&y(e,["codeExecution"],o);const a=g(n,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const c=g(n,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(n,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(n,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function Ofe(n){const e={},t=g(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const r=g(n,["cachedContentTokenCount"]);r!=null&&y(e,["cachedContentTokenCount"],r);const i=g(n,["candidatesTokenCount"]);i!=null&&y(e,["responseTokenCount"],i);const s=g(n,["toolUsePromptTokenCount"]);s!=null&&y(e,["toolUsePromptTokenCount"],s);const o=g(n,["thoughtsTokenCount"]);o!=null&&y(e,["thoughtsTokenCount"],o);const a=g(n,["totalTokenCount"]);a!=null&&y(e,["totalTokenCount"],a);const c=g(n,["promptTokensDetails"]);if(c!=null){let x=c;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["promptTokensDetails"],x)}const d=g(n,["cacheTokensDetails"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["cacheTokensDetails"],x)}const h=g(n,["candidatesTokensDetails"]);if(h!=null){let x=h;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["responseTokensDetails"],x)}const m=g(n,["toolUsePromptTokensDetails"]);if(m!=null){let x=m;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["toolUsePromptTokensDetails"],x)}const _=g(n,["trafficType"]);return _!=null&&y(e,["trafficType"],_),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vfe(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function Ffe(n){const e={},t=g(n,["content"]);t!=null&&y(e,["content"],t);const r=g(n,["citationMetadata"]);r!=null&&y(e,["citationMetadata"],Ufe(r));const i=g(n,["tokenCount"]);i!=null&&y(e,["tokenCount"],i);const s=g(n,["finishReason"]);s!=null&&y(e,["finishReason"],s);const o=g(n,["avgLogprobs"]);o!=null&&y(e,["avgLogprobs"],o);const a=g(n,["groundingMetadata"]);a!=null&&y(e,["groundingMetadata"],a);const c=g(n,["index"]);c!=null&&y(e,["index"],c);const d=g(n,["logprobsResult"]);d!=null&&y(e,["logprobsResult"],d);const h=g(n,["safetyRatings"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(x=>x)),y(e,["safetyRatings"],_)}const m=g(n,["urlContextMetadata"]);return m!=null&&y(e,["urlContextMetadata"],m),e}function Ufe(n){const e={},t=g(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),y(e,["citations"],r)}return e}function Bfe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let s=xs(i);Array.isArray(s)&&(s=s.map(o=>o)),y(t,["contents"],s)}return t}function Hfe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),y(e,["tokensInfo"],i)}return e}function Gfe(n){const e={},t=g(n,["values"]);t!=null&&y(e,["values"],t);const r=g(n,["statistics"]);return r!=null&&y(e,["statistics"],jfe(r)),e}function jfe(n){const e={},t=g(n,["truncated"]);t!=null&&y(e,["truncated"],t);const r=g(n,["token_count"]);return r!=null&&y(e,["tokenCount"],r),e}function eI(n){const e={},t=g(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Xpe(s))),y(e,["parts"],i)}const r=g(n,["role"]);return r!=null&&y(e,["role"],r),e}function qfe(n){const e={},t=g(n,["controlType"]);t!=null&&y(e,["controlType"],t);const r=g(n,["enableControlImageComputation"]);return r!=null&&y(e,["computeControl"],r),e}function zfe(n){const e={};if(g(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function $fe(n,e){const t={},r=g(n,["systemInstruction"]);e!==void 0&&r!=null&&y(e,["systemInstruction"],Or(r));const i=g(n,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>O7(a))),y(e,["tools"],o)}const s=g(n,["generationConfig"]);return e!==void 0&&s!=null&&y(e,["generationConfig"],Vpe(s)),t}function Wfe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let o=xs(i);Array.isArray(o)&&(o=o.map(a=>eI(a))),y(t,["contents"],o)}const s=g(e,["config"]);return s!=null&&zfe(s),t}function Kfe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let o=xs(i);Array.isArray(o)&&(o=o.map(a=>a)),y(t,["contents"],o)}const s=g(e,["config"]);return s!=null&&$fe(s,t),t}function Qfe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["totalTokens"]);r!=null&&y(e,["totalTokens"],r);const i=g(n,["cachedContentTokenCount"]);return i!=null&&y(e,["cachedContentTokenCount"],i),e}function Jfe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["totalTokens"]);return r!=null&&y(e,["totalTokens"],r),e}function Yfe(n,e){const t={},r=g(e,["model"]);return r!=null&&y(t,["_url","name"],Rt(n,r)),t}function Xfe(n,e){const t={},r=g(e,["model"]);return r!=null&&y(t,["_url","name"],Rt(n,r)),t}function Zfe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function epe(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function tpe(n,e){const t={},r=g(n,["outputGcsUri"]);e!==void 0&&r!=null&&y(e,["parameters","storageUri"],r);const i=g(n,["negativePrompt"]);e!==void 0&&i!=null&&y(e,["parameters","negativePrompt"],i);const s=g(n,["numberOfImages"]);e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s);const o=g(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const a=g(n,["guidanceScale"]);e!==void 0&&a!=null&&y(e,["parameters","guidanceScale"],a);const c=g(n,["seed"]);e!==void 0&&c!=null&&y(e,["parameters","seed"],c);const d=g(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const h=g(n,["personGeneration"]);e!==void 0&&h!=null&&y(e,["parameters","personGeneration"],h);const m=g(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&y(e,["parameters","includeSafetyAttributes"],m);const _=g(n,["includeRaiReason"]);e!==void 0&&_!=null&&y(e,["parameters","includeRaiReason"],_);const x=g(n,["language"]);e!==void 0&&x!=null&&y(e,["parameters","language"],x);const b=g(n,["outputMimeType"]);e!==void 0&&b!=null&&y(e,["parameters","outputOptions","mimeType"],b);const A=g(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","compressionQuality"],A);const N=g(n,["addWatermark"]);e!==void 0&&N!=null&&y(e,["parameters","addWatermark"],N);const F=g(n,["labels"]);e!==void 0&&F!=null&&y(e,["labels"],F);const B=g(n,["editMode"]);e!==void 0&&B!=null&&y(e,["parameters","editMode"],B);const O=g(n,["baseSteps"]);return e!==void 0&&O!=null&&y(e,["parameters","editConfig","baseSteps"],O),t}function npe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const s=g(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>ime(c))),y(t,["instances[0]","referenceImages"],a)}const o=g(e,["config"]);return o!=null&&tpe(o,t),t}function rpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>tI(s))),y(e,["generatedImages"],i)}return e}function ipe(n,e){const t={},r=g(n,["taskType"]);e!==void 0&&r!=null&&y(e,["requests[]","taskType"],r);const i=g(n,["title"]);e!==void 0&&i!=null&&y(e,["requests[]","title"],i);const s=g(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&y(e,["requests[]","outputDimensionality"],s),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function spe(n,e){const t={},r=g(n,["taskType"]);e!==void 0&&r!=null&&y(e,["instances[]","task_type"],r);const i=g(n,["title"]);e!==void 0&&i!=null&&y(e,["instances[]","title"],i);const s=g(n,["outputDimensionality"]);e!==void 0&&s!=null&&y(e,["parameters","outputDimensionality"],s);const o=g(n,["mimeType"]);e!==void 0&&o!=null&&y(e,["instances[]","mimeType"],o);const a=g(n,["autoTruncate"]);return e!==void 0&&a!=null&&y(e,["parameters","autoTruncate"],a),t}function ope(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let a=rP(n,i);Array.isArray(a)&&(a=a.map(c=>c)),y(t,["requests[]","content"],a)}const s=g(e,["config"]);s!=null&&ipe(s,t);const o=g(e,["model"]);return o!==void 0&&y(t,["requests[]","model"],Rt(n,o)),t}function ape(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let o=rP(n,i);Array.isArray(o)&&(o=o.map(a=>a)),y(t,["instances[]","content"],o)}const s=g(e,["config"]);return s!=null&&spe(s,t),t}function lpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["embeddings"],s)}const i=g(n,["metadata"]);return i!=null&&y(e,["metadata"],i),e}function cpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Gfe(o))),y(e,["embeddings"],s)}const i=g(n,["metadata"]);return i!=null&&y(e,["metadata"],i),e}function upe(n){const e={},t=g(n,["endpoint"]);t!=null&&y(e,["name"],t);const r=g(n,["deployedModelId"]);return r!=null&&y(e,["deployedModelId"],r),e}function dpe(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function hpe(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const r=g(n,["args"]);r!=null&&y(e,["args"],r);const i=g(n,["name"]);if(i!=null&&y(e,["name"],i),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function fpe(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const r=g(n,["allowedFunctionNames"]);if(r!=null&&y(e,["allowedFunctionNames"],r),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ppe(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const r=g(n,["name"]);r!=null&&y(e,["name"],r);const i=g(n,["parameters"]);i!=null&&y(e,["parameters"],i);const s=g(n,["parametersJsonSchema"]);s!=null&&y(e,["parametersJsonSchema"],s);const o=g(n,["response"]);o!=null&&y(e,["response"],o);const a=g(n,["responseJsonSchema"]);return a!=null&&y(e,["responseJsonSchema"],a),e}function mpe(n,e,t){const r={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],eI(Or(i)));const s=g(e,["temperature"]);s!=null&&y(r,["temperature"],s);const o=g(e,["topP"]);o!=null&&y(r,["topP"],o);const a=g(e,["topK"]);a!=null&&y(r,["topK"],a);const c=g(e,["candidateCount"]);c!=null&&y(r,["candidateCount"],c);const d=g(e,["maxOutputTokens"]);d!=null&&y(r,["maxOutputTokens"],d);const h=g(e,["stopSequences"]);h!=null&&y(r,["stopSequences"],h);const m=g(e,["responseLogprobs"]);m!=null&&y(r,["responseLogprobs"],m);const _=g(e,["logprobs"]);_!=null&&y(r,["logprobs"],_);const x=g(e,["presencePenalty"]);x!=null&&y(r,["presencePenalty"],x);const b=g(e,["frequencyPenalty"]);b!=null&&y(r,["frequencyPenalty"],b);const A=g(e,["seed"]);A!=null&&y(r,["seed"],A);const N=g(e,["responseMimeType"]);N!=null&&y(r,["responseMimeType"],N);const F=g(e,["responseSchema"]);F!=null&&y(r,["responseSchema"],iP(F));const B=g(e,["responseJsonSchema"]);if(B!=null&&y(r,["responseJsonSchema"],B),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const O=g(e,["safetySettings"]);if(t!==void 0&&O!=null){let j=O;Array.isArray(j)&&(j=j.map(V=>sme(V))),y(t,["safetySettings"],j)}const q=g(e,["tools"]);if(t!==void 0&&q!=null){let j=og(q);Array.isArray(j)&&(j=j.map(V=>hme(sg(V)))),y(t,["tools"],j)}const W=g(e,["toolConfig"]);if(t!==void 0&&W!=null&&y(t,["toolConfig"],dme(W)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=g(e,["cachedContent"]);t!==void 0&&$!=null&&y(t,["cachedContent"],Nl(n,$));const D=g(e,["responseModalities"]);D!=null&&y(r,["responseModalities"],D);const k=g(e,["mediaResolution"]);k!=null&&y(r,["mediaResolution"],k);const R=g(e,["speechConfig"]);if(R!=null&&y(r,["speechConfig"],sP(R)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=g(e,["thinkingConfig"]);U!=null&&y(r,["thinkingConfig"],U);const M=g(e,["imageConfig"]);return M!=null&&y(r,["imageConfig"],Gpe(M)),r}function gpe(n,e,t){const r={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],Or(i));const s=g(e,["temperature"]);s!=null&&y(r,["temperature"],s);const o=g(e,["topP"]);o!=null&&y(r,["topP"],o);const a=g(e,["topK"]);a!=null&&y(r,["topK"],a);const c=g(e,["candidateCount"]);c!=null&&y(r,["candidateCount"],c);const d=g(e,["maxOutputTokens"]);d!=null&&y(r,["maxOutputTokens"],d);const h=g(e,["stopSequences"]);h!=null&&y(r,["stopSequences"],h);const m=g(e,["responseLogprobs"]);m!=null&&y(r,["responseLogprobs"],m);const _=g(e,["logprobs"]);_!=null&&y(r,["logprobs"],_);const x=g(e,["presencePenalty"]);x!=null&&y(r,["presencePenalty"],x);const b=g(e,["frequencyPenalty"]);b!=null&&y(r,["frequencyPenalty"],b);const A=g(e,["seed"]);A!=null&&y(r,["seed"],A);const N=g(e,["responseMimeType"]);N!=null&&y(r,["responseMimeType"],N);const F=g(e,["responseSchema"]);F!=null&&y(r,["responseSchema"],iP(F));const B=g(e,["responseJsonSchema"]);B!=null&&y(r,["responseJsonSchema"],B);const O=g(e,["routingConfig"]);O!=null&&y(r,["routingConfig"],O);const q=g(e,["modelSelectionConfig"]);q!=null&&y(r,["modelConfig"],q);const W=g(e,["safetySettings"]);if(t!==void 0&&W!=null){let pe=W;Array.isArray(pe)&&(pe=pe.map(be=>be)),y(t,["safetySettings"],pe)}const $=g(e,["tools"]);if(t!==void 0&&$!=null){let pe=og($);Array.isArray(pe)&&(pe=pe.map(be=>O7(sg(be)))),y(t,["tools"],pe)}const D=g(e,["toolConfig"]);t!==void 0&&D!=null&&y(t,["toolConfig"],D);const k=g(e,["labels"]);t!==void 0&&k!=null&&y(t,["labels"],k);const R=g(e,["cachedContent"]);t!==void 0&&R!=null&&y(t,["cachedContent"],Nl(n,R));const U=g(e,["responseModalities"]);U!=null&&y(r,["responseModalities"],U);const M=g(e,["mediaResolution"]);M!=null&&y(r,["mediaResolution"],M);const j=g(e,["speechConfig"]);j!=null&&y(r,["speechConfig"],L7(sP(j)));const V=g(e,["audioTimestamp"]);V!=null&&y(r,["audioTimestamp"],V);const Ee=g(e,["thinkingConfig"]);Ee!=null&&y(r,["thinkingConfig"],Ee);const le=g(e,["imageConfig"]);return le!=null&&y(r,["imageConfig"],jpe(le)),r}function T5(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let o=xs(i);Array.isArray(o)&&(o=o.map(a=>eI(a))),y(t,["contents"],o)}const s=g(e,["config"]);return s!=null&&y(t,["generationConfig"],mpe(n,s,t)),t}function I5(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["contents"]);if(i!=null){let o=xs(i);Array.isArray(o)&&(o=o.map(a=>a)),y(t,["contents"],o)}const s=g(e,["config"]);return s!=null&&y(t,["generationConfig"],gpe(n,s,t)),t}function A5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Ffe(d))),y(e,["candidates"],c)}const i=g(n,["modelVersion"]);i!=null&&y(e,["modelVersion"],i);const s=g(n,["promptFeedback"]);s!=null&&y(e,["promptFeedback"],s);const o=g(n,["responseId"]);o!=null&&y(e,["responseId"],o);const a=g(n,["usageMetadata"]);return a!=null&&y(e,["usageMetadata"],a),e}function b5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>h)),y(e,["candidates"],d)}const i=g(n,["createTime"]);i!=null&&y(e,["createTime"],i);const s=g(n,["modelVersion"]);s!=null&&y(e,["modelVersion"],s);const o=g(n,["promptFeedback"]);o!=null&&y(e,["promptFeedback"],o);const a=g(n,["responseId"]);a!=null&&y(e,["responseId"],a);const c=g(n,["usageMetadata"]);return c!=null&&y(e,["usageMetadata"],c),e}function ype(n,e){const t={};if(g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=g(n,["numberOfImages"]);e!==void 0&&r!=null&&y(e,["parameters","sampleCount"],r);const i=g(n,["aspectRatio"]);e!==void 0&&i!=null&&y(e,["parameters","aspectRatio"],i);const s=g(n,["guidanceScale"]);if(e!==void 0&&s!=null&&y(e,["parameters","guidanceScale"],s),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=g(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&y(e,["parameters","safetySetting"],o);const a=g(n,["personGeneration"]);e!==void 0&&a!=null&&y(e,["parameters","personGeneration"],a);const c=g(n,["includeSafetyAttributes"]);e!==void 0&&c!=null&&y(e,["parameters","includeSafetyAttributes"],c);const d=g(n,["includeRaiReason"]);e!==void 0&&d!=null&&y(e,["parameters","includeRaiReason"],d);const h=g(n,["language"]);e!==void 0&&h!=null&&y(e,["parameters","language"],h);const m=g(n,["outputMimeType"]);e!==void 0&&m!=null&&y(e,["parameters","outputOptions","mimeType"],m);const _=g(n,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&y(e,["parameters","outputOptions","compressionQuality"],_),g(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const x=g(n,["imageSize"]);if(e!==void 0&&x!=null&&y(e,["parameters","sampleImageSize"],x),g(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function wpe(n,e){const t={},r=g(n,["outputGcsUri"]);e!==void 0&&r!=null&&y(e,["parameters","storageUri"],r);const i=g(n,["negativePrompt"]);e!==void 0&&i!=null&&y(e,["parameters","negativePrompt"],i);const s=g(n,["numberOfImages"]);e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s);const o=g(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const a=g(n,["guidanceScale"]);e!==void 0&&a!=null&&y(e,["parameters","guidanceScale"],a);const c=g(n,["seed"]);e!==void 0&&c!=null&&y(e,["parameters","seed"],c);const d=g(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const h=g(n,["personGeneration"]);e!==void 0&&h!=null&&y(e,["parameters","personGeneration"],h);const m=g(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&y(e,["parameters","includeSafetyAttributes"],m);const _=g(n,["includeRaiReason"]);e!==void 0&&_!=null&&y(e,["parameters","includeRaiReason"],_);const x=g(n,["language"]);e!==void 0&&x!=null&&y(e,["parameters","language"],x);const b=g(n,["outputMimeType"]);e!==void 0&&b!=null&&y(e,["parameters","outputOptions","mimeType"],b);const A=g(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","compressionQuality"],A);const N=g(n,["addWatermark"]);e!==void 0&&N!=null&&y(e,["parameters","addWatermark"],N);const F=g(n,["labels"]);e!==void 0&&F!=null&&y(e,["labels"],F);const B=g(n,["imageSize"]);e!==void 0&&B!=null&&y(e,["parameters","sampleImageSize"],B);const O=g(n,["enhancePrompt"]);return e!==void 0&&O!=null&&y(e,["parameters","enhancePrompt"],O),t}function _pe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const s=g(e,["config"]);return s!=null&&ype(s,t),t}function vpe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const s=g(e,["config"]);return s!=null&&wpe(s,t),t}function Epe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Dpe(o))),y(e,["generatedImages"],s)}const i=g(n,["positivePromptSafetyAttributes"]);return i!=null&&y(e,["positivePromptSafetyAttributes"],D7(i)),e}function xpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>tI(o))),y(e,["generatedImages"],s)}const i=g(n,["positivePromptSafetyAttributes"]);return i!=null&&y(e,["positivePromptSafetyAttributes"],M7(i)),e}function Tpe(n,e){const t={},r=g(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&y(e,["parameters","sampleCount"],r),g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=g(n,["durationSeconds"]);if(e!==void 0&&i!=null&&y(e,["parameters","durationSeconds"],i),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=g(n,["aspectRatio"]);e!==void 0&&s!=null&&y(e,["parameters","aspectRatio"],s);const o=g(n,["resolution"]);e!==void 0&&o!=null&&y(e,["parameters","resolution"],o);const a=g(n,["personGeneration"]);if(e!==void 0&&a!=null&&y(e,["parameters","personGeneration"],a),g(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=g(n,["negativePrompt"]);e!==void 0&&c!=null&&y(e,["parameters","negativePrompt"],c);const d=g(n,["enhancePrompt"]);if(e!==void 0&&d!=null&&y(e,["parameters","enhancePrompt"],d),g(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=g(n,["lastFrame"]);e!==void 0&&h!=null&&y(e,["instances[0]","lastFrame"],nI(h));const m=g(n,["referenceImages"]);if(e!==void 0&&m!=null){let _=m;Array.isArray(_)&&(_=_.map(x=>Ame(x))),y(e,["instances[0]","referenceImages"],_)}if(g(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Ipe(n,e){const t={},r=g(n,["numberOfVideos"]);e!==void 0&&r!=null&&y(e,["parameters","sampleCount"],r);const i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const s=g(n,["fps"]);e!==void 0&&s!=null&&y(e,["parameters","fps"],s);const o=g(n,["durationSeconds"]);e!==void 0&&o!=null&&y(e,["parameters","durationSeconds"],o);const a=g(n,["seed"]);e!==void 0&&a!=null&&y(e,["parameters","seed"],a);const c=g(n,["aspectRatio"]);e!==void 0&&c!=null&&y(e,["parameters","aspectRatio"],c);const d=g(n,["resolution"]);e!==void 0&&d!=null&&y(e,["parameters","resolution"],d);const h=g(n,["personGeneration"]);e!==void 0&&h!=null&&y(e,["parameters","personGeneration"],h);const m=g(n,["pubsubTopic"]);e!==void 0&&m!=null&&y(e,["parameters","pubsubTopic"],m);const _=g(n,["negativePrompt"]);e!==void 0&&_!=null&&y(e,["parameters","negativePrompt"],_);const x=g(n,["enhancePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","enhancePrompt"],x);const b=g(n,["generateAudio"]);e!==void 0&&b!=null&&y(e,["parameters","generateAudio"],b);const A=g(n,["lastFrame"]);e!==void 0&&A!=null&&y(e,["instances[0]","lastFrame"],lo(A));const N=g(n,["referenceImages"]);if(e!==void 0&&N!=null){let O=N;Array.isArray(O)&&(O=O.map(q=>bme(q))),y(e,["instances[0]","referenceImages"],O)}const F=g(n,["mask"]);e!==void 0&&F!=null&&y(e,["instances[0]","mask"],Ime(F));const B=g(n,["compressionQuality"]);return e!==void 0&&B!=null&&y(e,["parameters","compressionQuality"],B),t}function Ape(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response","generateVideoResponse"]);return o!=null&&y(e,["response"],Npe(o)),e}function bpe(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response"]);return o!=null&&y(e,["response"],kpe(o)),e}function Cpe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const s=g(e,["image"]);s!=null&&y(t,["instances[0]","image"],nI(s));const o=g(e,["video"]);o!=null&&y(t,["instances[0]","video"],V7(o));const a=g(e,["source"]);a!=null&&Ppe(a,t);const c=g(e,["config"]);return c!=null&&Tpe(c,t),t}function Spe(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const s=g(e,["image"]);s!=null&&y(t,["instances[0]","image"],lo(s));const o=g(e,["video"]);o!=null&&y(t,["instances[0]","video"],F7(o));const a=g(e,["source"]);a!=null&&Rpe(a,t);const c=g(e,["config"]);return c!=null&&Ipe(c,t),t}function Npe(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>Lpe(o))),y(e,["generatedVideos"],s)}const r=g(n,["raiMediaFilteredCount"]);r!=null&&y(e,["raiMediaFilteredCount"],r);const i=g(n,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function kpe(n){const e={},t=g(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>Ope(o))),y(e,["generatedVideos"],s)}const r=g(n,["raiMediaFilteredCount"]);r!=null&&y(e,["raiMediaFilteredCount"],r);const i=g(n,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function Ppe(n,e){const t={},r=g(n,["prompt"]);e!==void 0&&r!=null&&y(e,["instances[0]","prompt"],r);const i=g(n,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],nI(i));const s=g(n,["video"]);return e!==void 0&&s!=null&&y(e,["instances[0]","video"],V7(s)),t}function Rpe(n,e){const t={},r=g(n,["prompt"]);e!==void 0&&r!=null&&y(e,["instances[0]","prompt"],r);const i=g(n,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],lo(i));const s=g(n,["video"]);return e!==void 0&&s!=null&&y(e,["instances[0]","video"],F7(s)),t}function Dpe(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["image"],qpe(t));const r=g(n,["raiFilteredReason"]);r!=null&&y(e,["raiFilteredReason"],r);const i=g(n,["_self"]);return i!=null&&y(e,["safetyAttributes"],D7(i)),e}function tI(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["image"],R7(t));const r=g(n,["raiFilteredReason"]);r!=null&&y(e,["raiFilteredReason"],r);const i=g(n,["_self"]);i!=null&&y(e,["safetyAttributes"],M7(i));const s=g(n,["prompt"]);return s!=null&&y(e,["enhancedPrompt"],s),e}function Mpe(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["mask"],R7(t));const r=g(n,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),y(e,["labels"],i)}return e}function Lpe(n){const e={},t=g(n,["video"]);return t!=null&&y(e,["video"],xme(t)),e}function Ope(n){const e={},t=g(n,["_self"]);return t!=null&&y(e,["video"],Tme(t)),e}function Vpe(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const r=g(n,["responseJsonSchema"]);r!=null&&y(e,["responseJsonSchema"],r);const i=g(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const s=g(n,["candidateCount"]);s!=null&&y(e,["candidateCount"],s);const o=g(n,["enableAffectiveDialog"]);o!=null&&y(e,["enableAffectiveDialog"],o);const a=g(n,["frequencyPenalty"]);a!=null&&y(e,["frequencyPenalty"],a);const c=g(n,["logprobs"]);c!=null&&y(e,["logprobs"],c);const d=g(n,["maxOutputTokens"]);d!=null&&y(e,["maxOutputTokens"],d);const h=g(n,["mediaResolution"]);h!=null&&y(e,["mediaResolution"],h);const m=g(n,["presencePenalty"]);m!=null&&y(e,["presencePenalty"],m);const _=g(n,["responseLogprobs"]);_!=null&&y(e,["responseLogprobs"],_);const x=g(n,["responseMimeType"]);x!=null&&y(e,["responseMimeType"],x);const b=g(n,["responseModalities"]);b!=null&&y(e,["responseModalities"],b);const A=g(n,["responseSchema"]);A!=null&&y(e,["responseSchema"],A);const N=g(n,["routingConfig"]);N!=null&&y(e,["routingConfig"],N);const F=g(n,["seed"]);F!=null&&y(e,["seed"],F);const B=g(n,["speechConfig"]);B!=null&&y(e,["speechConfig"],L7(B));const O=g(n,["stopSequences"]);O!=null&&y(e,["stopSequences"],O);const q=g(n,["temperature"]);q!=null&&y(e,["temperature"],q);const W=g(n,["thinkingConfig"]);W!=null&&y(e,["thinkingConfig"],W);const $=g(n,["topK"]);$!=null&&y(e,["topK"],$);const D=g(n,["topP"]);if(D!=null&&y(e,["topP"],D),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Fpe(n,e){const t={},r=g(e,["model"]);return r!=null&&y(t,["_url","name"],Rt(n,r)),t}function Upe(n,e){const t={},r=g(e,["model"]);return r!=null&&y(t,["_url","name"],Rt(n,r)),t}function Bpe(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function Hpe(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function Gpe(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const r=g(n,["imageSize"]);if(r!=null&&y(e,["imageSize"],r),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function jpe(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const r=g(n,["imageSize"]);r!=null&&y(e,["imageSize"],r);const i=g(n,["outputMimeType"]);i!=null&&y(e,["imageOutputOptions","mimeType"],i);const s=g(n,["outputCompressionQuality"]);return s!=null&&y(e,["imageOutputOptions","compressionQuality"],s),e}function qpe(n){const e={},t=g(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Iu(t));const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function R7(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const r=g(n,["bytesBase64Encoded"]);r!=null&&y(e,["imageBytes"],Iu(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function nI(n){const e={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=g(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Iu(t));const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function lo(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const r=g(n,["imageBytes"]);r!=null&&y(e,["bytesBase64Encoded"],Iu(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function zpe(n,e,t){const r={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&y(t,["_query","pageSize"],i);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&y(t,["_query","pageToken"],s);const o=g(e,["filter"]);t!==void 0&&o!=null&&y(t,["_query","filter"],o);const a=g(e,["queryBase"]);return t!==void 0&&a!=null&&y(t,["_url","models_url"],I7(n,a)),r}function $pe(n,e,t){const r={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&y(t,["_query","pageSize"],i);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&y(t,["_query","pageToken"],s);const o=g(e,["filter"]);t!==void 0&&o!=null&&y(t,["_query","filter"],o);const a=g(e,["queryBase"]);return t!==void 0&&a!=null&&y(t,["_url","models_url"],I7(n,a)),r}function Wpe(n,e){const t={},r=g(e,["config"]);return r!=null&&zpe(n,r,t),t}function Kpe(n,e){const t={},r=g(e,["config"]);return r!=null&&$pe(n,r,t),t}function Qpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["_self"]);if(i!=null){let s=A7(i);Array.isArray(s)&&(s=s.map(o=>US(o))),y(e,["models"],s)}return e}function Jpe(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["_self"]);if(i!=null){let s=A7(i);Array.isArray(s)&&(s=s.map(o=>BS(o))),y(e,["models"],s)}return e}function Ype(n){const e={},t=g(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const r=g(n,["segmentationClasses"]);r!=null&&y(e,["maskClasses"],r);const i=g(n,["maskDilation"]);return i!=null&&y(e,["dilation"],i),e}function US(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["displayName"]);r!=null&&y(e,["displayName"],r);const i=g(n,["description"]);i!=null&&y(e,["description"],i);const s=g(n,["version"]);s!=null&&y(e,["version"],s);const o=g(n,["_self"]);o!=null&&y(e,["tunedModelInfo"],fme(o));const a=g(n,["inputTokenLimit"]);a!=null&&y(e,["inputTokenLimit"],a);const c=g(n,["outputTokenLimit"]);c!=null&&y(e,["outputTokenLimit"],c);const d=g(n,["supportedGenerationMethods"]);d!=null&&y(e,["supportedActions"],d);const h=g(n,["temperature"]);h!=null&&y(e,["temperature"],h);const m=g(n,["maxTemperature"]);m!=null&&y(e,["maxTemperature"],m);const _=g(n,["topP"]);_!=null&&y(e,["topP"],_);const x=g(n,["topK"]);x!=null&&y(e,["topK"],x);const b=g(n,["thinking"]);return b!=null&&y(e,["thinking"],b),e}function BS(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["displayName"]);r!=null&&y(e,["displayName"],r);const i=g(n,["description"]);i!=null&&y(e,["description"],i);const s=g(n,["versionId"]);s!=null&&y(e,["version"],s);const o=g(n,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(_=>upe(_))),y(e,["endpoints"],m)}const a=g(n,["labels"]);a!=null&&y(e,["labels"],a);const c=g(n,["_self"]);c!=null&&y(e,["tunedModelInfo"],pme(c));const d=g(n,["defaultCheckpointId"]);d!=null&&y(e,["defaultCheckpointId"],d);const h=g(n,["checkpoints"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(_=>_)),y(e,["checkpoints"],m)}return e}function Xpe(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const r=g(n,["codeExecutionResult"]);r!=null&&y(e,["codeExecutionResult"],r);const i=g(n,["executableCode"]);i!=null&&y(e,["executableCode"],i);const s=g(n,["fileData"]);s!=null&&y(e,["fileData"],dpe(s));const o=g(n,["functionCall"]);o!=null&&y(e,["functionCall"],hpe(o));const a=g(n,["functionResponse"]);a!=null&&y(e,["functionResponse"],a);const c=g(n,["inlineData"]);c!=null&&y(e,["inlineData"],Vfe(c));const d=g(n,["text"]);d!=null&&y(e,["text"],d);const h=g(n,["thought"]);h!=null&&y(e,["thought"],h);const m=g(n,["thoughtSignature"]);m!=null&&y(e,["thoughtSignature"],m);const _=g(n,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function Zpe(n){const e={},t=g(n,["productImage"]);return t!=null&&y(e,["image"],lo(t)),e}function eme(n,e){const t={},r=g(n,["numberOfImages"]);e!==void 0&&r!=null&&y(e,["parameters","sampleCount"],r);const i=g(n,["baseSteps"]);e!==void 0&&i!=null&&y(e,["parameters","baseSteps"],i);const s=g(n,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const o=g(n,["seed"]);e!==void 0&&o!=null&&y(e,["parameters","seed"],o);const a=g(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&y(e,["parameters","safetySetting"],a);const c=g(n,["personGeneration"]);e!==void 0&&c!=null&&y(e,["parameters","personGeneration"],c);const d=g(n,["addWatermark"]);e!==void 0&&d!=null&&y(e,["parameters","addWatermark"],d);const h=g(n,["outputMimeType"]);e!==void 0&&h!=null&&y(e,["parameters","outputOptions","mimeType"],h);const m=g(n,["outputCompressionQuality"]);e!==void 0&&m!=null&&y(e,["parameters","outputOptions","compressionQuality"],m);const _=g(n,["enhancePrompt"]);e!==void 0&&_!=null&&y(e,["parameters","enhancePrompt"],_);const x=g(n,["labels"]);return e!==void 0&&x!=null&&y(e,["labels"],x),t}function tme(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["source"]);i!=null&&rme(i,t);const s=g(e,["config"]);return s!=null&&eme(s,t),t}function nme(n){const e={},t=g(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>tI(i))),y(e,["generatedImages"],r)}return e}function rme(n,e){const t={},r=g(n,["prompt"]);e!==void 0&&r!=null&&y(e,["instances[0]","prompt"],r);const i=g(n,["personImage"]);e!==void 0&&i!=null&&y(e,["instances[0]","personImage","image"],lo(i));const s=g(n,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Zpe(a))),y(e,["instances[0]","productImages"],o)}return t}function ime(n){const e={},t=g(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],lo(t));const r=g(n,["referenceId"]);r!=null&&y(e,["referenceId"],r);const i=g(n,["referenceType"]);i!=null&&y(e,["referenceType"],i);const s=g(n,["maskImageConfig"]);s!=null&&y(e,["maskImageConfig"],Ype(s));const o=g(n,["controlImageConfig"]);o!=null&&y(e,["controlImageConfig"],qfe(o));const a=g(n,["styleImageConfig"]);a!=null&&y(e,["styleImageConfig"],a);const c=g(n,["subjectImageConfig"]);return c!=null&&y(e,["subjectImageConfig"],c),e}function D7(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const r=g(n,["safetyAttributes","scores"]);r!=null&&y(e,["scores"],r);const i=g(n,["contentType"]);return i!=null&&y(e,["contentType"],i),e}function M7(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const r=g(n,["safetyAttributes","scores"]);r!=null&&y(e,["scores"],r);const i=g(n,["contentType"]);return i!=null&&y(e,["contentType"],i),e}function sme(n){const e={},t=g(n,["category"]);if(t!=null&&y(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=g(n,["threshold"]);return r!=null&&y(e,["threshold"],r),e}function ome(n){const e={},t=g(n,["image"]);return t!=null&&y(e,["image"],lo(t)),e}function ame(n,e){const t={},r=g(n,["mode"]);e!==void 0&&r!=null&&y(e,["parameters","mode"],r);const i=g(n,["maxPredictions"]);e!==void 0&&i!=null&&y(e,["parameters","maxPredictions"],i);const s=g(n,["confidenceThreshold"]);e!==void 0&&s!=null&&y(e,["parameters","confidenceThreshold"],s);const o=g(n,["maskDilation"]);e!==void 0&&o!=null&&y(e,["parameters","maskDilation"],o);const a=g(n,["binaryColorThreshold"]);e!==void 0&&a!=null&&y(e,["parameters","binaryColorThreshold"],a);const c=g(n,["labels"]);return e!==void 0&&c!=null&&y(e,["labels"],c),t}function lme(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["source"]);i!=null&&ume(i,t);const s=g(e,["config"]);return s!=null&&ame(s,t),t}function cme(n){const e={},t=g(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>Mpe(i))),y(e,["generatedMasks"],r)}return e}function ume(n,e){const t={},r=g(n,["prompt"]);e!==void 0&&r!=null&&y(e,["instances[0]","prompt"],r);const i=g(n,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],lo(i));const s=g(n,["scribbleImage"]);return e!==void 0&&s!=null&&y(e,["instances[0]","scribble"],ome(s)),t}function L7(n){const e={},t=g(n,["languageCode"]);t!=null&&y(e,["languageCode"],t);const r=g(n,["voiceConfig"]);if(r!=null&&y(e,["voiceConfig"],r),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function dme(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],fpe(t));const r=g(n,["retrievalConfig"]);return r!=null&&y(e,["retrievalConfig"],r),e}function hme(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(m=>m)),y(e,["functionDeclarations"],h)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(n,["googleSearchRetrieval"]);r!=null&&y(e,["googleSearchRetrieval"],r);const i=g(n,["computerUse"]);i!=null&&y(e,["computerUse"],i);const s=g(n,["fileSearch"]);s!=null&&y(e,["fileSearch"],s);const o=g(n,["codeExecution"]);if(o!=null&&y(e,["codeExecution"],o),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(n,["googleMaps"]);a!=null&&y(e,["googleMaps"],Bpe(a));const c=g(n,["googleSearch"]);c!=null&&y(e,["googleSearch"],Hpe(c));const d=g(n,["urlContext"]);return d!=null&&y(e,["urlContext"],d),e}function O7(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(_=>ppe(_))),y(e,["functionDeclarations"],m)}const r=g(n,["retrieval"]);r!=null&&y(e,["retrieval"],r);const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);if(s!=null&&y(e,["computerUse"],s),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=g(n,["codeExecution"]);o!=null&&y(e,["codeExecution"],o);const a=g(n,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const c=g(n,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(n,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(n,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function fme(n){const e={},t=g(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const r=g(n,["createTime"]);r!=null&&y(e,["createTime"],r);const i=g(n,["updateTime"]);return i!=null&&y(e,["updateTime"],i),e}function pme(n){const e={},t=g(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const r=g(n,["createTime"]);r!=null&&y(e,["createTime"],r);const i=g(n,["updateTime"]);return i!=null&&y(e,["updateTime"],i),e}function mme(n,e){const t={},r=g(n,["displayName"]);e!==void 0&&r!=null&&y(e,["displayName"],r);const i=g(n,["description"]);e!==void 0&&i!=null&&y(e,["description"],i);const s=g(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&y(e,["defaultCheckpointId"],s),t}function gme(n,e){const t={},r=g(n,["displayName"]);e!==void 0&&r!=null&&y(e,["displayName"],r);const i=g(n,["description"]);e!==void 0&&i!=null&&y(e,["description"],i);const s=g(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&y(e,["defaultCheckpointId"],s),t}function yme(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","name"],Rt(n,r));const i=g(e,["config"]);return i!=null&&mme(i,t),t}function wme(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["config"]);return i!=null&&gme(i,t),t}function _me(n,e){const t={},r=g(n,["outputGcsUri"]);e!==void 0&&r!=null&&y(e,["parameters","storageUri"],r);const i=g(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&y(e,["parameters","safetySetting"],i);const s=g(n,["personGeneration"]);e!==void 0&&s!=null&&y(e,["parameters","personGeneration"],s);const o=g(n,["includeRaiReason"]);e!==void 0&&o!=null&&y(e,["parameters","includeRaiReason"],o);const a=g(n,["outputMimeType"]);e!==void 0&&a!=null&&y(e,["parameters","outputOptions","mimeType"],a);const c=g(n,["outputCompressionQuality"]);e!==void 0&&c!=null&&y(e,["parameters","outputOptions","compressionQuality"],c);const d=g(n,["enhanceInputImage"]);e!==void 0&&d!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],d);const h=g(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const m=g(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const _=g(n,["numberOfImages"]);e!==void 0&&_!=null&&y(e,["parameters","sampleCount"],_);const x=g(n,["mode"]);return e!==void 0&&x!=null&&y(e,["parameters","mode"],x),t}function vme(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["_url","model"],Rt(n,r));const i=g(e,["image"]);i!=null&&y(t,["instances[0]","image"],lo(i));const s=g(e,["upscaleFactor"]);s!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],s);const o=g(e,["config"]);return o!=null&&_me(o,t),t}function Eme(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>tI(s))),y(e,["generatedImages"],i)}return e}function xme(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const r=g(n,["encodedVideo"]);r!=null&&y(e,["videoBytes"],Iu(r));const i=g(n,["encoding"]);return i!=null&&y(e,["mimeType"],i),e}function Tme(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const r=g(n,["bytesBase64Encoded"]);r!=null&&y(e,["videoBytes"],Iu(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Ime(n){const e={},t=g(n,["image"]);t!=null&&y(e,["_self"],lo(t));const r=g(n,["maskMode"]);return r!=null&&y(e,["maskMode"],r),e}function Ame(n){const e={},t=g(n,["image"]);t!=null&&y(e,["image"],nI(t));const r=g(n,["referenceType"]);return r!=null&&y(e,["referenceType"],r),e}function bme(n){const e={},t=g(n,["image"]);t!=null&&y(e,["image"],lo(t));const r=g(n,["referenceType"]);return r!=null&&y(e,["referenceType"],r),e}function V7(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const r=g(n,["videoBytes"]);r!=null&&y(e,["encodedVideo"],Iu(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["encoding"],i),e}function F7(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const r=g(n,["videoBytes"]);r!=null&&y(e,["bytesBase64Encoded"],Iu(r));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cme="Content-Type",Sme="X-Server-Timeout",Nme="User-Agent",HS="x-goog-api-client",kme="1.30.0",Pme=`google-genai-sdk/${kme}`,Rme="v1beta1",Dme="v1beta",C5=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Mme{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Rme,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Dme,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,i){if(t&&t.timeout||i){const s=new AbortController,o=s.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const a=setTimeout(()=>s.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return t&&t.extraBody!==null&&Lme(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await S5(i),new OS(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await S5(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return up(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:c}=yield on(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(c,{stream:!0});try{const m=JSON.parse(d);if("error"in m){const _=JSON.parse(JSON.stringify(m.error)),x=_.status,b=_.code,A=`got status: ${x}. ${JSON.stringify(m)}`;if(b>=400&&b<600)throw new ZT({message:A,status:b})}}catch(m){if(m.name==="ApiError")throw m}o+=d;let h=o.match(C5);for(;h;){const m=h[1];try{const _=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield on(new OS(_)),o=o.slice(h[0].length),h=o.match(C5)}catch(_){throw new Error(`exception parsing stream chunk ${m}. ${_}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=Pme+" "+this.clientOptions.userAgentExtra;return e[Nme]=t,e[HS]=t,e[Cme]="application/json",e}async getHeadersInternal(e,t){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(Sme,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}getFileName(e){var t;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(t=r.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),r}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const c={file:i},d=this.getFileName(e),h=De("upload/v1beta/files",c._url),m=await this.fetchUploadUrl(h,i.sizeBytes,i.mimeType,d,c,t==null?void 0:t.httpOptions);return s.upload(e,m,this)}async uploadFileToFileSearchStore(e,t,r){var i;const s=this.clientOptions.uploader,o=await s.stat(t),a=String(o.size),c=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(t),m={};r!=null&&r.customMetadata&&(m.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(m.chunkingConfig=r.chunkingConfig);const _=await this.fetchUploadUrl(d,a,c,h,m,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(t,_,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,r,i,s,o){var a;let c={};o?c=o:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const d=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:c});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=d==null?void 0:d.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function S5(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(r);throw t>=400&&t<600?new ZT({message:i,status:t}):new Error(i)}}function Lme(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const s=JSON.parse(n.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))t=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const d=o[c],h=a[c];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?a[c]=r(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),a[c]=d)}return a}const i=r(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ome="mcp_used/unknown";let Vme=!1;function U7(n){for(const e of n)if(Fme(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Vme}function B7(n){var e;const t=(e=n[HS])!==null&&e!==void 0?e:"";n[HS]=(t+` ${Ome}`).trimStart()}function Fme(n){return n!==null&&typeof n=="object"&&n instanceof aP}function Ume(n,e=100){return up(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield on(n.listTools({cursor:r}));for(const o of s.tools)yield yield on(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class aP{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new aP(e,t)}async initialize(){var e,t,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const h of this.mcpClients)try{for(var a=!0,c=(t=void 0,t0(Ume(h))),d;d=await c.next(),e=d.done,!e;a=!0){i=d.value,a=!1;const m=i;o.push(m);const _=m.name;if(s[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);s[_]=h}}catch(m){t={error:m}}finally{try{!a&&!e&&(r=c.return)&&await r.call(c)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),Pde(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);t.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Bme(n,e,t){const r=new Tde;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(r,i),e(r)}class Hme{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=qme(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let d=()=>{};const h=new Promise(O=>{d=O}),m=e.callbacks,_=function(){d({})},x=this.apiClient,b={onopen:_,onmessage:O=>{Bme(x,m.onmessage,O)},onerror:(t=m==null?void 0:m.onerror)!==null&&t!==void 0?t:function(O){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(O){}},A=this.webSocketFactory.create(c,jme(o),b);A.connect(),await h;const B={setup:{model:Rt(this.apiClient,e.model)}};return A.send(JSON.stringify(B)),new Gme(A,this.apiClient)}}class Gme{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Sfe(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Cfe(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl($f.PLAY)}pause(){this.sendPlaybackControl($f.PAUSE)}stop(){this.sendPlaybackControl($f.STOP)}resetContext(){this.sendPlaybackControl($f.RESET_CONTEXT)}close(){this.conn.close()}}function jme(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function qme(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zme="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function $me(n,e,t){const r=new xde;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const s=JSON.parse(i);if(n.isVertexAI()){const o=Pfe(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class Wme{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new Hme(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&U7(e.config.tools)&&B7(m);const _=Yme(m);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,h);else{const R=this.apiClient.getApiKey();let U="BidiGenerateContent",M="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),U="BidiGenerateContentConstrained",M="access_token"),h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${U}?${M}=${R}`}let x=()=>{};const b=new Promise(R=>{x=R}),A=e.callbacks,N=function(){var R;(R=A==null?void 0:A.onopen)===null||R===void 0||R.call(A),x({})},F=this.apiClient,B={onopen:N,onmessage:R=>{$me(F,A.onmessage,R)},onerror:(t=A==null?void 0:A.onerror)!==null&&t!==void 0?t:function(R){},onclose:(r=A==null?void 0:A.onclose)!==null&&r!==void 0?r:function(R){}},O=this.webSocketFactory.create(h,Jme(_),B);O.connect(),await b;let q=Rt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&q.startsWith("publishers/")){const R=this.apiClient.getProject(),U=this.apiClient.getLocation();q=`projects/${R}/locations/${U}/`+q}let W={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[fx.AUDIO]}:e.config.responseModalities=[fx.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const $=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],D=[];for(const R of $)if(this.isCallableTool(R)){const U=R;D.push(await U.tool())}else D.push(R);D.length>0&&(e.config.tools=D);const k={model:q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?W=bfe(this.apiClient,k):W=Afe(this.apiClient,k),delete W.config,O.send(JSON.stringify(W)),new Qme(O,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Kme={turnComplete:!0};class Qme{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=xs(t.turns),e.isVertexAI()||(r=r.map(i=>eI(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(zme)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Kme),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:kfe(e)}:t={realtimeInput:Nfe(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Jme(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function Yme(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const N5=10;function k5(n){var e,t,r;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(dp(o)){i=!0;break}if(!i)return!0;const s=(r=n==null?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function dp(n){return"callTool"in n&&typeof n.callTool=="function"}function Xme(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>dp(i)))!==null&&r!==void 0?r:!1}function P5(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((r,i)=>{if(dp(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&t.push(i)}),t}function R5(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zme extends Sl{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,s,o,a;const c=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Xme(t)||k5(t.config))return await this.generateContentInternal(c);const d=P5(t);if(d.length>0){const A=d.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${A}.`)}let h,m;const _=xs(c.contents),x=(s=(i=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:N5;let b=0;for(;b<x&&(h=await this.generateContentInternal(c),!(!h.functionCalls||h.functionCalls.length===0));){const A=h.candidates[0].content,N=[];for(const F of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(dp(F)){const O=await F.callTool(h.functionCalls);N.push(...O)}b++,m={role:"user",parts:N},c.contents=xs(c.contents),c.contents.push(A),c.contents.push(m),R5(c.config)&&(_.push(A),_.push(m))}return R5(c.config)&&(h.automaticFunctionCallingHistory=_),h},this.generateContentStream=async t=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(t),k5(t.config)){const m=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(m)}const c=P5(t);if(c.length>0){const m=c.map(_=>`tools[${_}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(s=(i=(r=t==null?void 0:t.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,h=(a=(o=t==null?void 0:t.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(d&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=c==null?void 0:c.safetyAttributes:o.push(c);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Uh(_l.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var r,i,s,o,a,c;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=t.video)===null||r===void 0)&&r.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(s=t.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((c=(a=t.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,r,i;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const o=await Promise.all(s.map(async c=>dp(c)?await c.tool():c)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&U7(e.config.tools)){const c=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),B7(d),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return a}async initAfcToolsMap(e){var t,r,i;const s=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(dp(o)){const a=o,c=await a.tool();for(const d of(i=c.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(s.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);s.set(d.name,a)}}return s}async processAfcStream(e){var t,r,i;const s=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:N5;let o=!1,a=0;const c=await this.initAfcToolsMap(e);return(function(d,h,m){var _,x;return up(this,arguments,function*(){for(var b,A,N,F;a<s;){o&&(a++,o=!1);const W=yield on(d.processParamsMaybeAddMcpUsage(m)),$=yield on(d.generateContentStreamInternal(W)),D=[],k=[];try{for(var B=!0,O=(A=void 0,t0($)),q;q=yield on(O.next()),b=q.done,!b;B=!0){F=q.value,B=!1;const R=F;if(yield yield on(R),R.candidates&&(!((_=R.candidates[0])===null||_===void 0)&&_.content)){k.push(R.candidates[0].content);for(const U of(x=R.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<s&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(U.functionCall.name)){const M=yield on(h.get(U.functionCall.name).callTool([U.functionCall]));D.push(...M)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(R){A={error:R}}finally{try{!B&&!b&&(N=O.return)&&(yield on(N.call(O)))}finally{if(A)throw A.error}}if(D.length>0){o=!0;const R=new gy;R.candidates=[{content:{role:"user",parts:D}}],yield yield on(R);const U=[];U.push(...k),U.push({role:"user",parts:D});const M=xs(m.contents).concat(U);m.contents=M}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=I5(this.apiClient,e);return a=De("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=b5(h),_=new gy;return Object.assign(_,m),_})}else{const d=T5(this.apiClient,e);return a=De("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=A5(h),_=new gy;return Object.assign(_,m),_})}}async generateContentStreamInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=I5(this.apiClient,e);return a=De("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return up(this,arguments,function*(){var _,x,b,A;try{for(var N=!0,F=t0(m),B;B=yield on(F.next()),_=B.done,!_;N=!0){A=B.value,N=!1;const O=A,q=b5(yield on(O.json()));q.sdkHttpResponse={headers:O.headers};const W=new gy;Object.assign(W,q),yield yield on(W)}}catch(O){x={error:O}}finally{try{!N&&!_&&(b=F.return)&&(yield on(b.call(F)))}finally{if(x)throw x.error}}})})}else{const d=T5(this.apiClient,e);return a=De("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return up(this,arguments,function*(){var _,x,b,A;try{for(var N=!0,F=t0(m),B;B=yield on(F.next()),_=B.done,!_;N=!0){A=B.value,N=!1;const O=A,q=A5(yield on(O.json()));q.sdkHttpResponse={headers:O.headers};const W=new gy;Object.assign(W,q),yield yield on(W)}}catch(O){x={error:O}}finally{try{!N&&!_&&(b=F.return)&&(yield on(b.call(F)))}finally{if(x)throw x.error}}})})}}async embedContent(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=ape(this.apiClient,e);return a=De("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=cpe(h),_=new a5;return Object.assign(_,m),_})}else{const d=ope(this.apiClient,e);return a=De("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=lpe(h),_=new a5;return Object.assign(_,m),_})}}async generateImagesInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=vpe(this.apiClient,e);return a=De("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=xpe(h),_=new l5;return Object.assign(_,m),_})}else{const d=_pe(this.apiClient,e);return a=De("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Epe(h),_=new l5;return Object.assign(_,m),_})}}async editImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=npe(this.apiClient,e);return s=De("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=rpe(c),h=new dde;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=vme(this.apiClient,e);return s=De("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=Eme(c),h=new hde;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=tme(this.apiClient,e);return s=De("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=nme(c),h=new fde;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=lme(this.apiClient,e);return s=De("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=cme(c),h=new pde;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Upe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>BS(h))}else{const d=Fpe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>US(h))}}async listInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Kpe(this.apiClient,e);return a=De("{models_url}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Jpe(h),_=new c5;return Object.assign(_,m),_})}else{const d=Wpe(this.apiClient,e);return a=De("{models_url}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Qpe(h),_=new c5;return Object.assign(_,m),_})}}async update(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=wme(this.apiClient,e);return a=De("{model}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>BS(h))}else{const d=yme(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>US(h))}}async delete(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Xfe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=epe(h),_=new u5;return Object.assign(_,m),_})}else{const d=Yfe(this.apiClient,e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Zfe(h),_=new u5;return Object.assign(_,m),_})}}async countTokens(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Kfe(this.apiClient,e);return a=De("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Jfe(h),_=new d5;return Object.assign(_,m),_})}else{const d=Wfe(this.apiClient,e);return a=De("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Qfe(h),_=new d5;return Object.assign(_,m),_})}}async computeTokens(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Bfe(this.apiClient,e);return s=De("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=Hfe(c),h=new mde;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Spe(this.apiClient,e);return a=De("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const m=bpe(h),_=new px;return Object.assign(_,m),_})}else{const d=Cpe(this.apiClient,e);return a=De("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const m=Ape(h),_=new px;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ege extends Sl{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=sde(e);return a=De("{operationName}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o}else{const d=ide(e);return a=De("{operationName}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o}}async fetchPredictVideosOperationInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Yue(e);return s=De("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tge(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function nge(n){const e={},t=g(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>dge(s))),y(e,["parts"],i)}const r=g(n,["role"]);return r!=null&&y(e,["role"],r),e}function rge(n,e,t){const r={},i=g(e,["expireTime"]);t!==void 0&&i!=null&&y(t,["expireTime"],i);const s=g(e,["newSessionExpireTime"]);t!==void 0&&s!=null&&y(t,["newSessionExpireTime"],s);const o=g(e,["uses"]);t!==void 0&&o!=null&&y(t,["uses"],o);const a=g(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&y(t,["bidiGenerateContentSetup"],uge(n,a));const c=g(e,["lockAdditionalFields"]);return t!==void 0&&c!=null&&y(t,["fieldMask"],c),r}function ige(n,e){const t={},r=g(e,["config"]);return r!=null&&y(t,["config"],rge(n,r,t)),t}function sge(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const r=g(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function oge(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const r=g(n,["args"]);r!=null&&y(e,["args"],r);const i=g(n,["name"]);if(i!=null&&y(e,["name"],i),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function age(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function lge(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function cge(n,e){const t={},r=g(n,["generationConfig"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig"],r);const i=g(n,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const s=g(n,["temperature"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","temperature"],s);const o=g(n,["topP"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","topP"],o);const a=g(n,["topK"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","topK"],a);const c=g(n,["maxOutputTokens"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","maxOutputTokens"],c);const d=g(n,["mediaResolution"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","mediaResolution"],d);const h=g(n,["seed"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","seed"],h);const m=g(n,["speechConfig"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","speechConfig"],oP(m));const _=g(n,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=g(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const b=g(n,["systemInstruction"]);e!==void 0&&b!=null&&y(e,["setup","systemInstruction"],nge(Or(b)));const A=g(n,["tools"]);if(e!==void 0&&A!=null){let $=og(A);Array.isArray($)&&($=$.map(D=>fge(sg(D)))),y(e,["setup","tools"],$)}const N=g(n,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],hge(N));const F=g(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","inputAudioTranscription"],F);const B=g(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&y(e,["setup","outputAudioTranscription"],B);const O=g(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const q=g(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const W=g(n,["proactivity"]);return e!==void 0&&W!=null&&y(e,["setup","proactivity"],W),t}function uge(n,e){const t={},r=g(e,["model"]);r!=null&&y(t,["setup","model"],Rt(n,r));const i=g(e,["config"]);return i!=null&&y(t,["config"],cge(i,t)),t}function dge(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const r=g(n,["codeExecutionResult"]);r!=null&&y(e,["codeExecutionResult"],r);const i=g(n,["executableCode"]);i!=null&&y(e,["executableCode"],i);const s=g(n,["fileData"]);s!=null&&y(e,["fileData"],sge(s));const o=g(n,["functionCall"]);o!=null&&y(e,["functionCall"],oge(o));const a=g(n,["functionResponse"]);a!=null&&y(e,["functionResponse"],a);const c=g(n,["inlineData"]);c!=null&&y(e,["inlineData"],tge(c));const d=g(n,["text"]);d!=null&&y(e,["text"],d);const h=g(n,["thought"]);h!=null&&y(e,["thought"],h);const m=g(n,["thoughtSignature"]);m!=null&&y(e,["thoughtSignature"],m);const _=g(n,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function hge(n){const e={},t=g(n,["handle"]);if(t!=null&&y(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function fge(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(m=>m)),y(e,["functionDeclarations"],h)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(n,["googleSearchRetrieval"]);r!=null&&y(e,["googleSearchRetrieval"],r);const i=g(n,["computerUse"]);i!=null&&y(e,["computerUse"],i);const s=g(n,["fileSearch"]);s!=null&&y(e,["fileSearch"],s);const o=g(n,["codeExecution"]);if(o!=null&&y(e,["codeExecution"],o),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(n,["googleMaps"]);a!=null&&y(e,["googleMaps"],age(a));const c=g(n,["googleSearch"]);c!=null&&y(e,["googleSearch"],lge(c));const d=g(n,["urlContext"]);return d!=null&&y(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pge(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${t}.${s}`);e.push(...i)}else e.push(t)}return e.join(",")}function mge(n,e){let t=null;const r=n.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(n.bidiGenerateContentSetup=s,t=s):delete n.bidiGenerateContentSetup}else r!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const s=pge(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?n.fieldMask=s:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(d=>o.includes(d)?`generationConfig.${d}`:d));const c=[];s&&c.push(s),a.length>0&&c.push(...a),c.length>0?n.fieldMask=c.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class gge extends Sl{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=ige(this.apiClient,e);s=De("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const c=mge(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yge(n,e){const t={},r=g(n,["displayName"]);return e!==void 0&&r!=null&&y(e,["displayName"],r),t}function wge(n){const e={},t=g(n,["config"]);return t!=null&&yge(t,e),e}function _ge(n,e){const t={},r=g(n,["force"]);return e!==void 0&&r!=null&&y(e,["_query","force"],r),t}function vge(n){const e={},t=g(n,["name"]);t!=null&&y(e,["_url","name"],t);const r=g(n,["config"]);return r!=null&&_ge(r,e),e}function Ege(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function xge(n,e){const t={},r=g(n,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["customMetadata"],s)}const i=g(n,["chunkingConfig"]);return e!==void 0&&i!=null&&y(e,["chunkingConfig"],i),t}function Tge(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const r=g(n,["metadata"]);r!=null&&y(e,["metadata"],r);const i=g(n,["done"]);i!=null&&y(e,["done"],i);const s=g(n,["error"]);s!=null&&y(e,["error"],s);const o=g(n,["response"]);return o!=null&&y(e,["response"],Age(o)),e}function Ige(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const r=g(n,["fileName"]);r!=null&&y(e,["fileName"],r);const i=g(n,["config"]);return i!=null&&xge(i,e),e}function Age(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["parent"]);r!=null&&y(e,["parent"],r);const i=g(n,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function bge(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function Cge(n){const e={},t=g(n,["config"]);return t!=null&&bge(t,e),e}function Sge(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["fileSearchStores"],s)}return e}function Nge(n,e){const t={},r=g(n,["mimeType"]);e!==void 0&&r!=null&&y(e,["mimeType"],r);const i=g(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const s=g(n,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),y(e,["customMetadata"],a)}const o=g(n,["chunkingConfig"]);return e!==void 0&&o!=null&&y(e,["chunkingConfig"],o),t}function kge(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const r=g(n,["config"]);return r!=null&&Nge(r,e),e}function Pge(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rge(n,e){const t={},r=g(n,["force"]);return e!==void 0&&r!=null&&y(e,["_query","force"],r),t}function Dge(n){const e={},t=g(n,["name"]);t!=null&&y(e,["_url","name"],t);const r=g(n,["config"]);return r!=null&&Rge(r,e),e}function Mge(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function Lge(n,e){const t={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&y(e,["_query","pageSize"],r);const i=g(n,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function Oge(n){const e={},t=g(n,["parent"]);t!=null&&y(e,["_url","parent"],t);const r=g(n,["config"]);return r!=null&&Lge(r,e),e}function Vge(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const r=g(n,["nextPageToken"]);r!=null&&y(e,["nextPageToken"],r);const i=g(n,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fge extends Sl{constructor(e){super(),this.apiClient=e,this.list=async t=>new Uh(_l.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:t.parent,config:r.config}),await this.listInternal(t),t)}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Mge(e);return s=De("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Dge(e);i=De("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Oge(e);return s=De("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=Vge(c),h=new gde;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Uge extends Sl{constructor(e,t=new Fge(e)){super(),this.apiClient=e,this.documents=t,this.list=async(r={})=>new Uh(_l.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=wge(e);return s=De("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Ege(e);return s=De("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=vge(e);i=De("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Cge(e);return s=De("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=Sge(c),h=new yde;return Object.assign(h,d),h})}}async uploadToFileSearchStoreInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=kge(e);return s=De("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=Pge(c),h=new wde;return Object.assign(h,d),h})}}async importFile(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Ige(e);return s=De("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=Tge(c),h=new tP;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bge(n,e){const t={},r=g(n,["name"]);return r!=null&&y(t,["_url","name"],r),t}function Hge(n,e){const t={},r=g(n,["name"]);return r!=null&&y(t,["_url","name"],r),t}function Gge(n,e,t){const r={};if(g(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=g(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),g(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=g(n,["epochCount"]);e!==void 0&&s!=null&&y(e,["tuningTask","hyperparameters","epochCount"],s);const o=g(n,["learningRateMultiplier"]);if(o!=null&&y(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),g(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=g(n,["batchSize"]);e!==void 0&&a!=null&&y(e,["tuningTask","hyperparameters","batchSize"],a);const c=g(n,["learningRate"]);if(e!==void 0&&c!=null&&y(e,["tuningTask","hyperparameters","learningRate"],c),g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function jge(n,e,t){const r={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const x=g(n,["validationDataset"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec"],D5(x))}else if(i==="PREFERENCE_TUNING"){const x=g(n,["validationDataset"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec"],D5(x))}const s=g(n,["tunedModelDisplayName"]);e!==void 0&&s!=null&&y(e,["tunedModelDisplayName"],s);const o=g(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);let a=g(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const x=g(n,["epochCount"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],x)}else if(a==="PREFERENCE_TUNING"){const x=g(n,["epochCount"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],x)}let c=g(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const x=g(n,["learningRateMultiplier"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],x)}else if(c==="PREFERENCE_TUNING"){const x=g(n,["learningRateMultiplier"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],x)}let d=g(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const x=g(n,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],x)}else if(d==="PREFERENCE_TUNING"){const x=g(n,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],x)}let h=g(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const x=g(n,["adapterSize"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],x)}else if(h==="PREFERENCE_TUNING"){const x=g(n,["adapterSize"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],x)}if(g(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=g(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const _=g(n,["beta"]);return e!==void 0&&_!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),r}function qge(n,e){const t={},r=g(n,["baseModel"]);r!=null&&y(t,["baseModel"],r);const i=g(n,["preTunedModel"]);i!=null&&y(t,["preTunedModel"],i);const s=g(n,["trainingDataset"]);s!=null&&tye(s);const o=g(n,["config"]);return o!=null&&Gge(o,t),t}function zge(n,e){const t={},r=g(n,["baseModel"]);r!=null&&y(t,["baseModel"],r);const i=g(n,["preTunedModel"]);i!=null&&y(t,["preTunedModel"],i);const s=g(n,["trainingDataset"]);s!=null&&nye(s,t,e);const o=g(n,["config"]);return o!=null&&jge(o,t,e),t}function $ge(n,e){const t={},r=g(n,["name"]);return r!=null&&y(t,["_url","name"],r),t}function Wge(n,e){const t={},r=g(n,["name"]);return r!=null&&y(t,["_url","name"],r),t}function Kge(n,e,t){const r={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);e!==void 0&&s!=null&&y(e,["_query","pageToken"],s);const o=g(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),r}function Qge(n,e,t){const r={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);e!==void 0&&s!=null&&y(e,["_query","pageToken"],s);const o=g(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),r}function Jge(n,e){const t={},r=g(n,["config"]);return r!=null&&Kge(r,t),t}function Yge(n,e){const t={},r=g(n,["config"]);return r!=null&&Qge(r,t),t}function Xge(n,e){const t={},r=g(n,["sdkHttpResponse"]);r!=null&&y(t,["sdkHttpResponse"],r);const i=g(n,["nextPageToken"]);i!=null&&y(t,["nextPageToken"],i);const s=g(n,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>H7(a))),y(t,["tuningJobs"],o)}return t}function Zge(n,e){const t={},r=g(n,["sdkHttpResponse"]);r!=null&&y(t,["sdkHttpResponse"],r);const i=g(n,["nextPageToken"]);i!=null&&y(t,["nextPageToken"],i);const s=g(n,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>GS(a))),y(t,["tuningJobs"],o)}return t}function eye(n,e){const t={},r=g(n,["name"]);r!=null&&y(t,["model"],r);const i=g(n,["name"]);return i!=null&&y(t,["endpoint"],i),t}function tye(n,e){const t={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=g(n,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),y(t,["examples","examples"],i)}return t}function nye(n,e,t){const r={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=g(n,["gcsUri"]);e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=g(n,["gcsUri"]);e!==void 0&&o!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=g(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=g(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=g(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(g(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function H7(n,e){const t={},r=g(n,["sdkHttpResponse"]);r!=null&&y(t,["sdkHttpResponse"],r);const i=g(n,["name"]);i!=null&&y(t,["name"],i);const s=g(n,["state"]);s!=null&&y(t,["state"],x7(s));const o=g(n,["createTime"]);o!=null&&y(t,["createTime"],o);const a=g(n,["tuningTask","startTime"]);a!=null&&y(t,["startTime"],a);const c=g(n,["tuningTask","completeTime"]);c!=null&&y(t,["endTime"],c);const d=g(n,["updateTime"]);d!=null&&y(t,["updateTime"],d);const h=g(n,["description"]);h!=null&&y(t,["description"],h);const m=g(n,["baseModel"]);m!=null&&y(t,["baseModel"],m);const _=g(n,["_self"]);return _!=null&&y(t,["tunedModel"],eye(_)),t}function GS(n,e){const t={},r=g(n,["sdkHttpResponse"]);r!=null&&y(t,["sdkHttpResponse"],r);const i=g(n,["name"]);i!=null&&y(t,["name"],i);const s=g(n,["state"]);s!=null&&y(t,["state"],x7(s));const o=g(n,["createTime"]);o!=null&&y(t,["createTime"],o);const a=g(n,["startTime"]);a!=null&&y(t,["startTime"],a);const c=g(n,["endTime"]);c!=null&&y(t,["endTime"],c);const d=g(n,["updateTime"]);d!=null&&y(t,["updateTime"],d);const h=g(n,["error"]);h!=null&&y(t,["error"],h);const m=g(n,["description"]);m!=null&&y(t,["description"],m);const _=g(n,["baseModel"]);_!=null&&y(t,["baseModel"],_);const x=g(n,["tunedModel"]);x!=null&&y(t,["tunedModel"],x);const b=g(n,["preTunedModel"]);b!=null&&y(t,["preTunedModel"],b);const A=g(n,["supervisedTuningSpec"]);A!=null&&y(t,["supervisedTuningSpec"],A);const N=g(n,["preferenceOptimizationSpec"]);N!=null&&y(t,["preferenceOptimizationSpec"],N);const F=g(n,["tuningDataStats"]);F!=null&&y(t,["tuningDataStats"],F);const B=g(n,["encryptionSpec"]);B!=null&&y(t,["encryptionSpec"],B);const O=g(n,["partnerModelTuningSpec"]);O!=null&&y(t,["partnerModelTuningSpec"],O);const q=g(n,["customBaseModel"]);q!=null&&y(t,["customBaseModel"],q);const W=g(n,["experiment"]);W!=null&&y(t,["experiment"],W);const $=g(n,["labels"]);$!=null&&y(t,["labels"],$);const D=g(n,["outputUri"]);D!=null&&y(t,["outputUri"],D);const k=g(n,["pipelineJob"]);k!=null&&y(t,["pipelineJob"],k);const R=g(n,["serviceAccount"]);R!=null&&y(t,["serviceAccount"],R);const U=g(n,["tunedModelDisplayName"]);U!=null&&y(t,["tunedModelDisplayName"],U);const M=g(n,["veoTuningSpec"]);return M!=null&&y(t,["veoTuningSpec"],M),t}function rye(n,e){const t={},r=g(n,["sdkHttpResponse"]);r!=null&&y(t,["sdkHttpResponse"],r);const i=g(n,["name"]);i!=null&&y(t,["name"],i);const s=g(n,["metadata"]);s!=null&&y(t,["metadata"],s);const o=g(n,["done"]);o!=null&&y(t,["done"],o);const a=g(n,["error"]);return a!=null&&y(t,["error"],a),t}function D5(n,e){const t={},r=g(n,["gcsUri"]);r!=null&&y(t,["validationDatasetUri"],r);const i=g(n,["vertexDatasetResource"]);return i!=null&&y(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iye extends Sl{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Uh(_l.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{var r;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((r=t.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},t),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:LS.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Wge(e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>GS(h))}else{const d=$ge(e);return a=De("{name}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>H7(h))}}async listInternal(e){var t,r,i,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const d=Yge(e);return a=De("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Zge(h),_=new h5;return Object.assign(_,m),_})}else{const d=Jge(e);return a=De("tunedModels",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:h.headers},_})),o.then(h=>{const m=Xge(h),_=new h5;return Object.assign(_,m),_})}}async cancel(e){var t,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const c=Hge(e);o=De("{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=Bge(e);o=De("{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=zge(e,e);return s=De("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>GS(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=qge(e);return s=De("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>rye(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sye{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const oye=1024*1024*8,aye=3,lye=1e3,cye=2,gx="x-goog-upload-status";async function uye(n,e,t){var r;const i=await G7(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[gx])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function dye(n,e,t){var r;const i=await G7(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[gx])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=g7(s),a=new nP;return Object.assign(a,o),a}async function G7(n,e,t){var r,i;let s=0,o=0,a=new OS(new Response),c="upload";for(s=n.size;o<s;){const d=Math.min(oye,s-o),h=n.slice(o,o+d);o+d>=s&&(c+=", finalize");let m=0,_=lye;for(;m<aye&&(a=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(o),"Content-Length":String(d)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[gx]));)m++,await fye(_),_=_*cye;if(o+=d,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[gx])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function hye(n){return{size:n.size,type:n.type}}function fye(n){return new Promise(e=>setTimeout(e,n))}class pye{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uye(e,t,r)}async uploadToFileSearchStore(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dye(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await hye(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mye{create(e,t,r){return new gye(e,t,r)}}class gye{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const M5="x-goog-api-key";class yye{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(M5)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(M5,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wye="gl-node/";class j7{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=Que(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new yye(this.apiKey);this.apiClient=new Mme({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:wye+"web",uploader:new pye,downloader:new sye}),this.models=new Zme(this.apiClient),this.live=new Wme(this.apiClient,i,new mye),this.batches=new Ihe(this.apiClient),this.chats=new sfe(this.models,this.apiClient),this.caches=new nfe(this.apiClient),this.files=new mfe(this.apiClient),this.operations=new ege(this.apiClient),this.authTokens=new gge(this.apiClient),this.tunings=new iye(this.apiClient),this.fileSearchStores=new Uge(this.apiClient)}}const Lb={},L5="https://an-tam-viec-lam-website.vercel.app/api/chat",O5="https://an-tam-viec-lam-website.vercel.app/api/analyze",yx=(Lb==null?void 0:Lb.VITE_GEMINI_API_KEY)||"",_ye=n=>n?n.replace(/```json\n?/g,"").replace(/```\n?/g,"").trim():"",vye=async(n,e,t)=>{var a;console.group(" [GeminiService] Start Chat");const r=`
        ${t.projectContext}

        DI Y L D LIU HIN TI CA NN TNG:
        - Cng vic mu: ${JSON.stringify(t.jobs.slice(0,3))}
        - Bo him: ${JSON.stringify(t.insuranceInfo)}
        
        HY TR LI NGN GN, THN THIN.
    `,s=e.filter((c,d)=>!0).map(c=>({role:c.author===wd.User?"user":"model",parts:[{text:c.text}]})),o=(c,d,h)=>Promise.race([fetch(c,d),new Promise((m,_)=>setTimeout(()=>_(new Error(`Request timed out after ${h}ms`)),h))]);try{console.log(` [Step 1] Th gi Server Chat: ${L5}`);const c=await o(L5,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,history:s,systemInstruction:r})},15e3),d=c.headers.get("content-type");if(c.ok&&d&&d.includes("application/json")){const m=await c.json();if(m.text)return console.log(" [Backend Vercel] Thnh cng!"),console.groupEnd(),m.text}let h=`Backend Status: ${c.status}`;try{const m=await c.json();m.error&&(h+=` - ${m.error}`)}catch{}throw new Error(h)}catch(c){if(console.warn(` [Backend Failed] ${c instanceof Error?c.message:"Unknown error"}. Chuyn sang Client SDK.`),console.log(" [Step 2] Gi trc tip t Client..."),!yx)return console.error(" [Client SDK] Thiu API_KEY trong bin mi trng."),console.groupEnd()," H thng ang bo tr kt ni (Missing Configuration). Vui lng th li sau.";try{const h=await new j7({apiKey:yx}).models.generateContent({model:"gemini-2.5-flash",contents:[...s,{role:"user",parts:[{text:n}]}],config:{systemInstruction:r}});return console.log(" [Client SDK] Thnh cng!"),console.groupEnd(),h.text||"Xin li, ti khng th tr li lc ny."}catch(d){return console.error(" [Critical] C 2 cch u tht bi:",d),console.groupEnd(),(a=d.message)!=null&&a.includes("403")||d.toString().includes("PERMISSION_DENIED")?" Li quyn truy cp API Key. Vui lng kim tra cu hnh Key trn Google Cloud Console (b gii hn Android App nu ang chy Web/Vercel).":" Ti ang gp cht kh khn khi kt ni. Vui lng th li sau t pht."}}},Eye=async(n,e)=>{var s;if(!e.length)return[];console.group(" [GeminiService] Start Analyze Jobs");const t=e.map(o=>{var a;return{id:o.id,title:o.title,description:o.description.substring(0,500),pay:`${o.payRate} ${o.payType}`,distance:`${(a=o.distance)==null?void 0:a.toFixed(1)} km`,type:o.jobType,employer:o.employerName}}),r={name:n.fullName,bio:n.bio,skills:n.skills,history:(s=n.workHistory)==null?void 0:s.map(o=>`${o.title} ti ${o.company}`)},i=`
        Bn l chuyn gia t vn ngh nghip AI. Hy phn tch mc  ph hp ca cc cng vic sau cho ngi dng ny.
        
        NGI DNG: ${JSON.stringify(r)}
        
        DANH SCH CNG VIC: ${JSON.stringify(t)}

        YU CU PHN TCH:
        nh gi tng cng vic da trn khong cch, k nng, mc lng v ri ro.

        OUTPUT JSON FORMAT (BT BUC, KHNG MARKDOWN):
        [
            {
                "jobId": "id_ca_job",
                "matchScore": 85, 
                "reason": "L do ph hp",
                "pros": ["im mnh 1"],
                "cons": ["Ri ro"],
                "environmentAnalysis": "Mi trng"
            }
        ]
    `;try{console.log(` [Step 1] Th gi Server Analyze: ${O5}`);const o=await fetch(O5,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:i})}),a=o.headers.get("content-type");if(o.ok&&a&&a.includes("application/json")){const c=await o.json();return console.log(" [Backend Analyze] Thnh cng!",c.length,"items"),console.groupEnd(),c.sort((d,h)=>h.matchScore-d.matchScore)}throw new Error(`Analyze Server Failed: ${o.status}`)}catch(o){if(console.warn(` [Backend Analyze Failed] ${o instanceof Error?o.message:"Unknown error"}. Chuyn sang Client SDK.`),!yx)return console.error(" [Client SDK] Thiu API_KEY. Khng th phn tch."),console.groupEnd(),[];try{console.log(" [Step 2] Gi trc tip t Client...");const c=await new j7({apiKey:yx}).models.generateContent({model:"gemini-2.5-flash",contents:[{role:"user",parts:[{text:i}]}],config:{responseMimeType:"application/json",temperature:.3}}),d=_ye(c.text||"");if(!d)return console.warn(" Client SDK tr v text rng"),[];const h=JSON.parse(d);return console.log(" [Client SDK] Thnh cng!",h.length,"items"),console.groupEnd(),h.sort((m,_)=>_.matchScore-m.matchScore)}catch(a){return console.error(" Error analyzing jobs (Client SDK):",a),console.groupEnd(),[]}}},lP="ai_conversations",xye=(n,e)=>at.collection("users").doc(n).collection(lP).orderBy("timestamp","asc").onSnapshot(i=>{const s=[];i.forEach(o=>{const a=o.data();s.push({author:a.author,text:a.text})}),e(s)},i=>{console.error("Error fetching AI chat history:",i),e([])}),V5=async(n,e)=>{try{await at.collection("users").doc(n).collection(lP).add({text:e.text,author:e.author,timestamp:ga()})}catch(t){console.error("Error saving AI chat message:",t)}},Tye=async n=>{try{const t=await at.collection("users").doc(n).collection(lP).get(),r=at.batch();t.docs.forEach(i=>{r.delete(i.ref)}),await r.commit()}catch(e){throw console.error("Error clearing AI chat history:",e),e}},q7=({className:n="w-8 h-8"})=>p.jsx("div",{className:`flex items-center justify-center rounded-full bg-indigo-500 text-white ${n}`,children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})})});function cP(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Bh=cP();function z7(n){Bh=n}const $7=/[&<>"']/,Iye=new RegExp($7.source,"g"),W7=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Aye=new RegExp(W7.source,"g"),bye={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},F5=n=>bye[n];function $i(n,e){if(e){if($7.test(n))return n.replace(Iye,F5)}else if(W7.test(n))return n.replace(Aye,F5);return n}const Cye=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Sye(n){return n.replace(Cye,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Nye=/(^|[^\[])\^/g;function qt(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(i,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(Nye,"$1"),t=t.replace(i,o),r},getRegex:()=>new RegExp(t,e)};return r}function U5(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const n0={exec:()=>null};function B5(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let c=!1,d=o;for(;--d>=0&&a[d]==="\\";)c=!c;return c?"|":" |"}),r=t.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function Cv(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function kye(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function H5(n,e,t,r){const i=e.href,s=e.title?$i(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:t,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:s,text:$i(o)}}function Pye(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}class wx{constructor(e){X(this,"options");X(this,"rules");X(this,"lexer");this.options=e||Bh}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Cv(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=Pye(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const i=Cv(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=Cv(r.replace(/^ *>[ \t]?/gm,""),`
`);const i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",c="",d=!1;for(;e;){let h=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let m=t[2].split(`
`,1)[0].replace(/^\t+/,F=>" ".repeat(3*F.length)),_=e.split(`
`,1)[0],x=0;this.options.pedantic?(x=2,c=m.trimStart()):(x=t[2].search(/[^ ]/),x=x>4?1:x,c=m.slice(x),x+=t[1].length);let b=!1;if(!m&&/^ *$/.test(_)&&(a+=_+`
`,e=e.substring(_.length+1),h=!0),!h){const F=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),B=new RegExp(`^ {0,${Math.min(3,x-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),O=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:\`\`\`|~~~)`),q=new RegExp(`^ {0,${Math.min(3,x-1)}}#`);for(;e;){const W=e.split(`
`,1)[0];if(_=W,this.options.pedantic&&(_=_.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),O.test(_)||q.test(_)||F.test(_)||B.test(e))break;if(_.search(/[^ ]/)>=x||!_.trim())c+=`
`+_.slice(x);else{if(b||m.search(/[^ ]/)>=4||O.test(m)||q.test(m)||B.test(m))break;c+=`
`+_}!b&&!_.trim()&&(b=!0),a+=W+`
`,e=e.substring(W.length+1),m=_.slice(x)}}s.loose||(d?s.loose=!0:/\n *\n *$/.test(a)&&(d=!0));let A=null,N;this.options.gfm&&(A=/^\[[ xX]\] /.exec(c),A&&(N=A[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!A,checked:N,loose:!1,text:c,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=c.trimEnd(),s.raw=s.raw.trimEnd();for(let h=0;h<s.items.length;h++)if(this.lexer.state.top=!1,s.items[h].tokens=this.lexer.blockTokens(s.items[h].text,[]),!s.loose){const m=s.items[h].tokens.filter(x=>x.type==="space"),_=m.length>0&&m.some(x=>/\n.*\n/.test(x.raw));s.loose=_}if(s.loose)for(let h=0;h<s.items.length;h++)s.items[h].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:i,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=B5(t[1]),i=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const a of i)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(const a of r)o.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of s)o.rows.push(B5(a,o.header.length).map(c=>({text:c,tokens:this.lexer.inline(c)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:$i(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const o=Cv(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=kye(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),H5(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(/\s+/g," "),s=t[i.toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return H5(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const o=[...i[0]].length-1;let a,c,d=o,h=0;const m=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(m.lastIndex=0,t=t.slice(-1*e.length+o);(i=m.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(c=[...a].length,i[3]||i[4]){d+=c;continue}else if((i[5]||i[6])&&o%3&&!((o+c)%3)){h+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+h);const _=[...i[0]][0].length,x=e.slice(0,o+i.index+_+c);if(Math.min(o,c)%2){const A=x.slice(1,-1);return{type:"em",raw:x,text:A,tokens:this.lexer.inlineTokens(A)}}const b=x.slice(2,-2);return{type:"strong",raw:x,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=$i(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,i;return t[2]==="@"?(r=$i(t[1]),i="mailto:"+r):(r=$i(t[1]),i=r),{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=$i(t[0]),s="mailto:"+i;else{let o;do o=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(o!==t[0]);i=$i(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=$i(t[0]),{type:"text",raw:t[0],text:r}}}}const Rye=/^(?: *(?:\n|$))+/,Dye=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Mye=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Yw=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Lye=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,K7=/(?:[*+-]|\d{1,9}[.)])/,Q7=qt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,K7).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),uP=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Oye=/^[^\n]+/,dP=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Vye=qt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",dP).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Fye=qt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,K7).getRegex(),rI="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hP=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Uye=qt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",hP).replace("tag",rI).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),J7=qt(uP).replace("hr",Yw).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rI).getRegex(),Bye=qt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",J7).getRegex(),fP={blockquote:Bye,code:Dye,def:Vye,fences:Mye,heading:Lye,hr:Yw,html:Uye,lheading:Q7,list:Fye,newline:Rye,paragraph:J7,table:n0,text:Oye},G5=qt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Yw).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rI).getRegex(),Hye={...fP,table:G5,paragraph:qt(uP).replace("hr",Yw).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",G5).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",rI).getRegex()},Gye={...fP,html:qt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hP).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:n0,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:qt(uP).replace("hr",Yw).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Q7).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Y7=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jye=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,X7=/^( {2,}|\\)\n(?!\s*$)/,qye=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Xw="\\p{P}\\p{S}",zye=qt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Xw).getRegex(),$ye=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Wye=qt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Xw).getRegex(),Kye=qt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Xw).getRegex(),Qye=qt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Xw).getRegex(),Jye=qt(/\\([punct])/,"gu").replace(/punct/g,Xw).getRegex(),Yye=qt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Xye=qt(hP).replace("(?:-->|$)","-->").getRegex(),Zye=qt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Xye).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),_x=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,e0e=qt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",_x).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Z7=qt(/^!?\[(label)\]\[(ref)\]/).replace("label",_x).replace("ref",dP).getRegex(),eH=qt(/^!?\[(ref)\](?:\[\])?/).replace("ref",dP).getRegex(),t0e=qt("reflink|nolink(?!\\()","g").replace("reflink",Z7).replace("nolink",eH).getRegex(),pP={_backpedal:n0,anyPunctuation:Jye,autolink:Yye,blockSkip:$ye,br:X7,code:jye,del:n0,emStrongLDelim:Wye,emStrongRDelimAst:Kye,emStrongRDelimUnd:Qye,escape:Y7,link:e0e,nolink:eH,punctuation:zye,reflink:Z7,reflinkSearch:t0e,tag:Zye,text:qye,url:n0},n0e={...pP,link:qt(/^!?\[(label)\]\((.*?)\)/).replace("label",_x).getRegex(),reflink:qt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",_x).getRegex()},jS={...pP,escape:qt(Y7).replace("])","~|])").getRegex(),url:qt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},r0e={...jS,br:qt(X7).replace("{2,}","*").getRegex(),text:qt(jS.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Sv={normal:fP,gfm:Hye,pedantic:Gye},yy={normal:pP,gfm:jS,breaks:r0e,pedantic:n0e};class na{constructor(e){X(this,"tokens");X(this,"options");X(this,"state");X(this,"tokenizer");X(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Bh,this.options.tokenizer=this.options.tokenizer||new wx,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Sv.normal,inline:yy.normal};this.options.pedantic?(t.block=Sv.pedantic,t.inline=yy.pedantic):this.options.gfm&&(t.block=Sv.gfm,this.options.breaks?t.inline=yy.breaks:t.inline=yy.gfm),this.tokenizer.rules=t}static get rules(){return{block:Sv,inline:yy}}static lex(e,t){return new na(t).lex(e)}static lexInline(e,t){return new na(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,c,d)=>c+"    ".repeat(d.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},c),typeof d=="number"&&d>=0&&(a=Math.min(a,d))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,i,s,o=e,a,c,d;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)h.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(c||(d=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(h=>(r=h.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,d)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let h=1/0;const m=e.slice(1);let _;this.options.extensions.startInline.forEach(x=>{_=x.call({lexer:this},m),typeof _=="number"&&_>=0&&(h=Math.min(h,_))}),h<1/0&&h>=0&&(s=e.substring(0,h+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(d=r.raw.slice(-1)),c=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}}class vx{constructor(e){X(this,"options");this.options=e||Bh}code(e,t,r){var s;const i=(s=(t||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+$i(i)+'">'+(r?e:$i(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:$i(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const i=t?"ol":"ul",s=t&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const i=U5(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image(e,t,r){const i=U5(e);if(i===null)return r;e=i;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class mP{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class ra{constructor(e){X(this,"options");X(this,"renderer");X(this,"textRenderer");this.options=e||Bh,this.options.renderer=this.options.renderer||new vx,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new mP}static parse(e,t){return new ra(t).parse(e)}static parseInline(e,t){return new ra(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=a||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Sye(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=s;let a="",c="";for(let h=0;h<o.header.length;h++)c+=this.renderer.tablecell(this.parseInline(o.header[h].tokens),{header:!0,align:o.align[h]});a+=this.renderer.tablerow(c);let d="";for(let h=0;h<o.rows.length;h++){const m=o.rows[h];c="";for(let _=0;_<m.length;_++)c+=this.renderer.tablecell(this.parseInline(m[_].tokens),{header:!1,align:o.align[_]});d+=this.renderer.tablerow(c)}r+=this.renderer.table(a,d);continue}case"blockquote":{const o=s,a=this.parse(o.tokens);r+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,c=o.start,d=o.loose;let h="";for(let m=0;m<o.items.length;m++){const _=o.items[m],x=_.checked,b=_.task;let A="";if(_.task){const N=this.renderer.checkbox(!!x);d?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=N+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=N+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:N+" "}):A+=N+" "}A+=this.parse(_.tokens,d),h+=this.renderer.listitem(A,b,!!x)}r+=this.renderer.list(h,a,c);continue}case"html":{const o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],a+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=t?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{const o=s;r+=t.text(o.text);break}case"html":{const o=s;r+=t.html(o.text);break}case"link":{const o=s;r+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=s;r+=t.image(o.href,o.title,o.text);break}case"strong":{const o=s;r+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=s;r+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=s;r+=t.codespan(o.text);break}case"br":{r+=t.br();break}case"del":{const o=s;r+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=s;r+=t.text(o.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}}class r0{constructor(e){X(this,"options");this.options=e||Bh}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}X(r0,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Ch,qS,tH;class i0e{constructor(...e){se(this,Ch);X(this,"defaults",cP());X(this,"options",this.setOptions);X(this,"parse",we(this,Ch,qS).call(this,na.lex,ra.parse));X(this,"parseInline",we(this,Ch,qS).call(this,na.lexInline,ra.parseInline));X(this,"Parser",ra);X(this,"Renderer",vx);X(this,"TextRenderer",mP);X(this,"Lexer",na);X(this,"Tokenizer",wx);X(this,"Hooks",r0);this.use(...e)}walkTokens(e,t){var i,s;let r=[];for(const o of e)switch(r=r.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const c of a.header)r=r.concat(this.walkTokens(c.tokens,t));for(const c of a.rows)for(const d of c)r=r.concat(this.walkTokens(d.tokens,t));break}case"list":{const a=o;r=r.concat(this.walkTokens(a.items,t));break}default:{const a=o;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(c=>{const d=a[c].flat(1/0);r=r.concat(this.walkTokens(d,t))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];o?t.renderers[s.name]=function(...a){let c=s.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),r.renderer){const s=this.defaults.renderer||new vx(this.defaults);for(const o in r.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const a=o,c=r.renderer[a],d=s[a];s[a]=(...h)=>{let m=c.apply(s,h);return m===!1&&(m=d.apply(s,h)),m||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new wx(this.defaults);for(const o in r.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,c=r.tokenizer[a],d=s[a];s[a]=(...h)=>{let m=c.apply(s,h);return m===!1&&(m=d.apply(s,h)),m}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new r0;for(const o in r.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,c=r.hooks[a],d=s[a];r0.passThroughHooks.has(o)?s[a]=h=>{if(this.defaults.async)return Promise.resolve(c.call(s,h)).then(_=>d.call(s,_));const m=c.call(s,h);return d.call(s,m)}:s[a]=(...h)=>{let m=c.apply(s,h);return m===!1&&(m=d.apply(s,h)),m}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),s&&(c=c.concat(s.call(this,a))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return na.lex(e,t??this.defaults)}parser(e,t){return ra.parse(e,t??this.defaults)}}Ch=new WeakSet,qS=function(e,t){return(r,i)=>{const s={...i},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=we(this,Ch,tH).call(this,!!o.silent,!!o.async);if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let c=e(r,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let d=t(c,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(c){return a(c)}}},tH=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+$i(r.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(r);throw r}};const Ah=new i0e;function Ut(n,e){return Ah.parse(n,e)}Ut.options=Ut.setOptions=function(n){return Ah.setOptions(n),Ut.defaults=Ah.defaults,z7(Ut.defaults),Ut};Ut.getDefaults=cP;Ut.defaults=Bh;Ut.use=function(...n){return Ah.use(...n),Ut.defaults=Ah.defaults,z7(Ut.defaults),Ut};Ut.walkTokens=function(n,e){return Ah.walkTokens(n,e)};Ut.parseInline=Ah.parseInline;Ut.Parser=ra;Ut.parser=ra.parse;Ut.Renderer=vx;Ut.TextRenderer=mP;Ut.Lexer=na;Ut.lexer=na.lex;Ut.Tokenizer=wx;Ut.Hooks=r0;Ut.parse=Ut;Ut.options;Ut.setOptions;Ut.use;Ut.walkTokens;Ut.parseInline;const s0e=Ut;ra.parse;na.lex;const o0e=({content:n})=>{const[e,t]=Y.useState("");return Y.useEffect(()=>{(async()=>{try{const i=await s0e(n);t(i)}catch(i){console.error("Markdown parse error",i),t(n)}})()},[n]),p.jsx("div",{className:"markdown-content text-sm",dangerouslySetInnerHTML:{__html:e}})},a0e=({message:n})=>{const e=n.author===wd.User;return p.jsxs("div",{className:`flex items-start gap-3 ${e?"justify-end":""}`,children:[!e&&p.jsx(q7,{}),p.jsx("div",{className:`max-w-[85%] md:max-w-lg px-4 py-3 rounded-2xl shadow-sm ${e?"bg-blue-500 text-white rounded-br-none":"bg-white border border-gray-100 text-gray-800 rounded-bl-none"}`,children:e?p.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.text}):p.jsx(o0e,{content:n.text})}),e&&p.jsx(so,{})]})},l0e=({allJobs:n})=>{const{currentUser:e}=wa(),[t,r]=Y.useState([]),[i,s]=Y.useState(""),[o,a]=Y.useState(!1),c=Y.useRef(null),d={author:wd.Bot,text:"Xin cho! Ti c th gip g cho bn v cng vic hoc chnh sch bo him x hi?"};Y.useEffect(()=>{if(!e)return;const x=xye(e.uid,b=>{b.length===0?r([d]):r(b)});return()=>x()},[e]);const h=()=>{var x;(x=c.current)==null||x.scrollIntoView({behavior:"smooth"})};Y.useEffect(h,[t,o]);const m=async x=>{if(x.preventDefault(),!i.trim()||o||!e)return;const b=i,A={author:wd.User,text:b};s(""),a(!0);try{await V5(e.uid,A);const N={jobs:n,insuranceInfo:Ff,projectContext:Use},F=[...t,A],B=await vye(b,F,N),O={author:wd.Bot,text:B};await V5(e.uid,O)}catch(N){console.error("Chat error:",N);const F={author:wd.Bot,text:"Xin li, ti ang gp s c kt ni. Vui lng th li sau."};r(B=>[...B,F])}finally{a(!1)}},_=async()=>{e&&window.confirm("Bn c chc mun xa ton b lch s tr chuyn khng?")&&(await Tye(e.uid),r([d]))};return p.jsxs("div",{className:"flex flex-col h-full bg-gray-50 rounded-lg shadow-md overflow-hidden relative",children:[p.jsx("style",{children:`
            .markdown-content ul {
                list-style-type: disc;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content ol {
                list-style-type: decimal;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content li {
                margin-bottom: 0.25em;
                line-height: 1.5;
            }
            .markdown-content p {
                margin-bottom: 0.75em;
                line-height: 1.6;
            }
            .markdown-content p:last-child {
                margin-bottom: 0;
            }
            .markdown-content strong {
                font-weight: 700;
                color: #111827; /* gray-900 */
            }
            .markdown-content em {
                font-style: italic;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3 {
                font-weight: 700;
                margin-top: 1em;
                margin-bottom: 0.5em;
                color: #1f2937; /* gray-800 */
                font-size: 1em; /* Keep text size consistent but bold */
            }
            .markdown-content a {
                color: #2563eb; /* blue-600 */
                text-decoration: underline;
            }
        `}),p.jsxs("div",{className:"px-4 py-3 bg-white border-b flex justify-between items-center shadow-sm z-10",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("span",{className:"relative flex h-3 w-3",children:[p.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),p.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),p.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tr l AI An Tm"})]}),t.length>1&&p.jsx("button",{onClick:_,className:"text-gray-400 hover:text-red-500 transition-colors p-1.5 rounded-full hover:bg-gray-100",title:"Xa lch s tr chuyn",children:p.jsx(X0,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto bg-slate-50",children:[t.map((x,b)=>p.jsx(a0e,{message:x},b)),o&&p.jsxs("div",{className:"flex items-start gap-3 animate-pulse",children:[p.jsx(q7,{}),p.jsx("div",{className:"bg-white border border-gray-100 text-gray-800 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm",children:p.jsxs("div",{className:"flex items-center space-x-1.5",children:[p.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),p.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),p.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce"})]})})]}),p.jsx("div",{ref:c})]}),p.jsx("div",{className:"p-4 bg-white border-t shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:p.jsxs("form",{onSubmit:m,className:"flex items-center space-x-3",children:[p.jsx("input",{type:"text",value:i,onChange:x=>s(x.target.value),placeholder:"Hi v vic lm, bo him...",className:"flex-1 p-3 px-4 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 shadow-sm",disabled:o}),p.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-all duration-300 shadow-md hover:shadow-lg transform active:scale-95",children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]})},c0e=({job:n,onClose:e,onViewOnMap:t})=>{const{currentUser:r,currentUserData:i}=wa(),[s,o]=Y.useState(!1),[a,c]=Y.useState(!1),[d,h]=Y.useState(""),[m,_]=Y.useState(!1),[x,b]=Y.useState(""),[A,N]=Y.useState("");Y.useEffect(()=>{i!=null&&i.phoneNumber&&b(i.phoneNumber)},[i]),Y.useEffect(()=>{const q=$=>{$.key==="Escape"&&e()};return document.body.style.overflow="hidden",window.addEventListener("keydown",q),(async()=>{if(r&&(i==null?void 0:i.userType)==="WORKER"){const $=await Rue(n.id,r.uid);c($)}})(),()=>{window.removeEventListener("keydown",q),document.body.style.overflow="unset"}},[e,n.id,r,i]);const F=()=>{if(!r||!i){h("Bn cn ng nhp  ng tuyn.");return}_(!0)},B=async q=>{if(q.preventDefault(),!(!r||!i)){if(!x.trim()){h("Vui lng nhp s in thoi lin h.");return}o(!0),h("");try{await Pue(n,i,A,x),c(!0),_(!1)}catch(W){console.error("Application failed:",W),h(" c li xy ra khi ng tuyn. Vui lng th li.")}finally{o(!1)}}},O=(i==null?void 0:i.uid)===n.employerId;return p.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center",role:"dialog","aria-modal":"true",children:[p.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:e}),p.jsxs("div",{className:"bg-white w-full md:w-[90%] md:max-w-3xl h-[90vh] md:h-auto md:max-h-[85vh] rounded-t-2xl md:rounded-2xl shadow-2xl flex flex-col relative z-10 animate-slide-up md:animate-fade-in overflow-hidden",onClick:q=>q.stopPropagation(),children:[p.jsx("div",{className:"md:hidden w-full flex justify-center pt-3 pb-1 bg-white cursor-pointer",onClick:e,children:p.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),p.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-start bg-white flex-shrink-0",children:[p.jsxs("div",{className:"flex gap-4 overflow-hidden",children:[n.employerProfileUrl?p.jsx("img",{src:n.employerProfileUrl,alt:"logo",className:"w-14 h-14 rounded-lg object-cover border border-gray-100 flex-shrink-0"}):p.jsx("div",{className:"w-14 h-14 rounded-lg bg-indigo-50 flex items-center justify-center flex-shrink-0",children:p.jsx(Ts,{className:"w-8 h-8 text-indigo-500"})}),p.jsxs("div",{className:"min-w-0",children:[p.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate leading-tight",children:n.title}),p.jsx("p",{className:"text-gray-500 text-sm truncate mt-1",children:n.employerName}),p.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[p.jsx("span",{className:"bg-green-100 text-green-700 text-xs font-bold px-2 py-0.5 rounded-md",children:a8(n.payRate,n.payType)}),p.jsxs("span",{className:"text-gray-400 text-xs flex items-center",children:[p.jsx(FT,{className:"w-3 h-3 mr-1"}),new Date(n.createdAt).toLocaleDateString("vi-VN")]})]})]})]}),p.jsx("button",{onClick:e,className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-500 transition-colors flex-shrink-0 ml-2",children:p.jsx(Sm,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-white",children:[p.jsxs("div",{className:"flex items-start gap-3 mb-6 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[p.jsx(Hc,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"a im lm vic"}),p.jsx("p",{className:"text-sm text-gray-600",children:n.addressString}),p.jsx("button",{onClick:t,className:"text-xs text-indigo-600 font-semibold hover:underline mt-1",children:"Xem trn bn "})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"M t cng vic"}),p.jsx("div",{className:"text-gray-600 leading-relaxed whitespace-pre-wrap text-sm md:text-base",children:n.description})]}),p.jsxs("div",{className:"flex flex-wrap gap-2 mb-8",children:[p.jsx("span",{className:"bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-medium border border-indigo-100",children:n.jobType}),n.payType&&p.jsxs("span",{className:"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium border border-gray-200",children:["Tr lng ",n.payType.toLowerCase()]})]}),m&&!a&&p.jsxs("div",{className:"mb-6 bg-indigo-50 p-5 rounded-xl border border-indigo-100 animate-fade-in",children:[p.jsxs("h3",{className:"font-bold text-indigo-800 mb-4 flex items-center text-lg",children:[p.jsx(Sx,{className:"w-5 h-5 mr-2"}),"Thng tin ng tuyn"]}),p.jsxs("form",{onSubmit:B,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("label",{htmlFor:"contactPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:["S in thoi lin h ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{type:"tel",id:"contactPhone",value:x,onChange:q=>b(q.target.value),className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Nhp s in thoi...",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"introduction",className:"block text-sm font-medium text-gray-700 mb-1",children:"Li nhn (Ty chn)"}),p.jsx("textarea",{id:"introduction",value:A,onChange:q=>N(q.target.value),rows:3,className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none",placeholder:"Gii thiu ngn gn v kinh nghim ca bn..."})]}),d&&p.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded border border-red-100",children:d}),p.jsxs("div",{className:"flex gap-3 pt-2",children:[p.jsx("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 font-semibold flex-1",children:"Hy"}),p.jsx("button",{type:"submit",disabled:s,className:"flex-[2] bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-400 flex items-center justify-center shadow-md",children:s?p.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Gi h s"})]})]})]})]}),!m&&p.jsxs("div",{className:"p-4 bg-white border-t border-gray-100 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] flex-shrink-0",children:[(i==null?void 0:i.userType)==="WORKER"&&!O&&p.jsx("button",{onClick:F,disabled:s||a,className:`flex-1 font-bold py-3 px-4 rounded-xl transition-all duration-300 flex items-center justify-center shadow-md active:scale-95 ${a?"bg-green-100 text-green-700 cursor-default":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:a?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"mr-2",children:""}),"  ng tuyn"]}):"ng tuyn ngay"}),O&&p.jsx("div",{className:"flex-1 bg-gray-100 text-gray-500 font-medium py-3 px-4 rounded-xl text-center text-sm flex items-center justify-center",children:"y l bi ng ca bn"}),p.jsx("button",{onClick:e,className:"px-5 bg-white text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-50 border border-gray-200 transition-colors active:scale-95",children:"ng"})]})]}),p.jsx("style",{children:`
        @keyframes slide-up {
            0% { transform: translateY(100%); }
            100% { transform: translateY(0); }
        }
        .animate-slide-up {
            animation: slide-up 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        /* Override fade-in for desktop to be simpler */
        @media (min-width: 768px) {
            .animate-slide-up {
                animation: fade-in 0.2s ease-out forwards;
            }
        }
    `})]})},u0e=({locations:n,types:e,locationFilter:t,typeFilter:r,onLocationChange:i,onTypeChange:s,onReset:o})=>p.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"location-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"a im"}),p.jsxs("select",{id:"location-filter",value:t,onChange:a=>i(a.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${t?"text-gray-900 font-medium":"text-gray-500"}`,children:[p.jsx("option",{value:"",children:"Tt c a im"}),n.map(a=>p.jsx("option",{value:a,children:a},a))]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"type-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi hnh"}),p.jsxs("select",{id:"type-filter",value:r,onChange:a=>s(a.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${r?"text-gray-900 font-medium":"text-gray-500"}`,children:[p.jsx("option",{value:"",children:"Tt c loi hnh"}),e.map(a=>p.jsx("option",{value:a,children:a},a))]})]}),p.jsx("div",{className:"flex items-end",children:p.jsx("button",{onClick:o,className:"w-full bg-gray-100 text-gray-700 font-semibold py-2.5 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"Xa b lc"})})]})}),d0e=({className:n="w-6 h-6"})=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),h0e=({job:n,onJobSelect:e})=>p.jsxs("div",{className:"p-1 font-sans",children:[p.jsx("h4",{className:"font-bold text-sm text-gray-800",children:n.title}),p.jsx("p",{className:"text-xs text-gray-600 mb-1",children:n.employerName}),p.jsx("button",{onClick:()=>e(n),className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"Xem chi tit"})]}),f0e=({jobs:n,onJobSelect:e,focusedJobId:t,onFocusComplete:r,userLocation:i})=>{const s=Y.useRef(null),o=Y.useRef({map:null,markers:{},userMarker:null,popupRoots:[]});Y.useEffect(()=>{if(o.current.map||!s.current)return;const c=window.L;if(!c){console.error("Th vin Leaflet khng tm thy. Vui lng m bo  ti th vin.");return}const d=c.map(s.current).setView([16.0544,108.2022],6);return d.options.scrollWheelZoom=!0,c.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d),i&&d.setView([i.lat,i.lng],13),o.current.map=d,setTimeout(()=>{o.current.map&&o.current.map.invalidateSize()},400),()=>{o.current.popupRoots.forEach(h=>h.unmount()),o.current.popupRoots=[],o.current.map&&(o.current.map.remove(),o.current.map=null)}},[]),Y.useEffect(()=>{const{map:c}=o.current;c&&i&&c.flyTo([i.lat,i.lng],13)},[i]),Y.useEffect(()=>{const c=window.L,{map:d}=o.current;if(!d||!c||(o.current.popupRoots.forEach(m=>m.unmount()),o.current.popupRoots=[],Object.values(o.current.markers).forEach(m=>m.remove()),o.current.markers={},n.length===0))return;const h=c.latLngBounds([]);n.forEach(m=>{const _=YE(m.location);if(!_)return;const x=document.createElement("div"),b=Q5.createRoot(x);b.render(p.jsx(h0e,{job:m,onJobSelect:e})),o.current.popupRoots.push(b);const A=c.marker([_.lat,_.lng]).addTo(d).bindPopup(x);o.current.markers[m.id]=A,h.extend([_.lat,_.lng])}),h.isValid()&&!t&&(i&&h.extend([i.lat,i.lng]),d.fitBounds(h,{padding:[50,50],maxZoom:14}))},[n,e,t,i]),Y.useEffect(()=>{const{map:c,markers:d}=o.current;if(!c||!t||!d[t])return;const h=d[t],m=n.find(x=>x.id===t),_=m?YE(m.location):null;_&&(c.flyTo([_.lat,_.lng],15,{animate:!0,duration:1}),setTimeout(()=>{h&&typeof h.openPopup=="function"&&h.openPopup()},800)),r()},[t,n,r]),Y.useEffect(()=>{const c=window.L,{map:d}=o.current;if(!(!d||!c)&&(o.current.userMarker&&(o.current.userMarker.remove(),o.current.userMarker=null),i)){const h=c.divIcon({html:'<div class="user-location-marker"></div>',className:"",iconSize:[24,24],iconAnchor:[12,12]}),m=c.marker([i.lat,i.lng],{icon:h}).addTo(d).bindTooltip("V tr ca bn");o.current.userMarker=m}},[i]);const a=()=>{const{map:c}=o.current;c&&i&&c.flyTo([i.lat,i.lng],15)};return p.jsxs("div",{className:"relative",children:[p.jsx("div",{ref:s,className:"w-full h-[600px] rounded-lg shadow-md z-0"}),i&&p.jsx("button",{onClick:a,className:"absolute bottom-5 right-5 z-[1000] bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 transition-colors duration-200","aria-label":"V v tr ca ti",title:"V v tr ca ti",children:p.jsx(d0e,{className:"w-6 h-6 text-gray-700"})}),p.jsx("style",{children:`
          .user-location-marker {
              width: 24px;
              height: 24px;
              background-color: #3b82f6; /* blue-500 */
              border-radius: 50%;
              border: 3px solid white;
              box-shadow: 0 0 10px rgba(0,0,0,0.3);
              position: relative;
          }
          .user-location-marker::after {
              content: '';
              position: absolute;
              top: 50%;
              left: 50%;
              width: 24px;
              height: 24px;
              border-radius: 50%;
              background-color: rgba(59, 130, 246, 0.3);
              transform: translate(-50%, -50%);
              animation: pulse 2s infinite;
          }
          @keyframes pulse {
              0% {
                  transform: translate(-50%, -50%) scale(1);
                  opacity: 0.8;
              }
              100% {
                  transform: translate(-50%, -50%) scale(2.5);
                  opacity: 0;
              }
          }
      `})]})},p0e=Y.memo(f0e),m0e=({className:n="w-5 h-5"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),nH=({className:n="w-5 h-5"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m0 10V7m0 10l-6 3"})}),g0e=n=>at.collection("jobs").where("status","==","OPEN").onSnapshot(i=>{const s=[];i.forEach(o=>{var c;const a=o.data();if(a.title&&a.location){const d=(c=a.createdAt)!=null&&c.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),h={id:o.id,title:a.title,description:a.description||"",employerId:a.employerId,employerName:a.employerName,employerProfileUrl:a.employerProfileUrl,addressString:a.addressString,location:a.location,payRate:a.payRate,payType:a.payType,jobType:a.jobType||"Thi v",status:a.status,createdAt:d,hiredWorkerId:a.hiredWorkerId,applicantCount:a.applicantCount||0};s.push(h)}}),s.sort((o,a)=>new Date(a.createdAt).getTime()-new Date(o.createdAt).getTime()),n(s)},i=>{console.error("Error fetching jobs: ",i),n([])}),y0e=(n,e)=>at.collection("jobs").where("employerId","==",n).onSnapshot(s=>{const o=[];s.forEach(a=>{var m;const c=a.data(),d=(m=c.createdAt)!=null&&m.toDate?c.createdAt.toDate().toISOString():new Date().toISOString(),h={id:a.id,title:c.title,description:c.description,employerId:c.employerId,employerName:c.employerName,employerProfileUrl:c.employerProfileUrl,addressString:c.addressString,location:c.location,payRate:c.payRate,payType:c.payType,jobType:c.jobType,status:c.status,createdAt:d,hiredWorkerId:c.hiredWorkerId,applicantCount:c.applicantCount||0};o.push(h)}),o.sort((a,c)=>new Date(c.createdAt).getTime()-new Date(a.createdAt).getTime()),e(o)},s=>{console.error("Error fetching employer jobs: ",s),e([])}),w0e=async n=>{var e;try{const r=await at.collection("jobs").doc(n).get();if(r.exists){const i=r.data(),s=(e=i==null?void 0:i.createdAt)!=null&&e.toDate?i.createdAt.toDate().toISOString():new Date().toISOString();return{id:r.id,title:i==null?void 0:i.title,description:(i==null?void 0:i.description)||"",employerId:i==null?void 0:i.employerId,employerName:i==null?void 0:i.employerName,employerProfileUrl:i==null?void 0:i.employerProfileUrl,addressString:i==null?void 0:i.addressString,location:i==null?void 0:i.location,payRate:i==null?void 0:i.payRate,payType:i==null?void 0:i.payType,jobType:(i==null?void 0:i.jobType)||"Thi v",status:i==null?void 0:i.status,createdAt:s,hiredWorkerId:i==null?void 0:i.hiredWorkerId,applicantCount:(i==null?void 0:i.applicantCount)||0}}return null}catch(t){return console.error("Error fetching job by ID:",t),null}},_0e=async(n,e)=>{await at.collection("jobs").doc(n).update({status:e})},v0e=async(n,e)=>{var s;const t=(s=e.addressString.split(",").pop())==null?void 0:s.trim();if(!t)return;const i=at.collection("users").where("userType","==","WORKER");try{(await i.get()).forEach(a=>{const c=a.data();c.address&&c.address.includes(t)&&Rk(c.uid,Jo.NEW_JOB_MATCH,`Vic lm mi ti ${t}: "${e.title}"`,`/jobs/${n}`)})}catch(o){console.error("Error notifying workers:",o)}},E0e=async(n,e)=>{if(!e.fullName)throw new Error("Nh tuyn dng phi c h tn y   ng tin.");const r=at.collection("jobs").doc(),{coordinates:i,...s}=n,o=`[${i.lat} N, ${i.lng} E]`,a={...s,id:r.id,employerId:e.uid,employerName:e.fullName,employerProfileUrl:e.profileImageUrl||null,status:"OPEN",hiredWorkerId:null,createdAt:ga(),location:o,applicantCount:0};await r.set(a),await v0e(r.id,n)},j5=({job:n,onStatusChange:e,isUpdating:t,onClick:r})=>{const i=n.status==="CLOSED";return p.jsxs("div",{onClick:()=>r(n),className:"bg-white p-4 rounded-lg border flex items-center justify-between cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-800",children:n.title}),p.jsx("p",{className:"text-sm text-gray-500",children:n.addressString})]}),p.jsx("button",{onClick:s=>{s.stopPropagation(),e(n.id,i?"OPEN":"CLOSED")},disabled:t,className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors disabled:opacity-50 ${i?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:t?"...":i?"M li":"ng"})]})},x0e=({application:n,onStatusUpdate:e,onViewProfile:t,isUpdating:r})=>{const i={pending:{text:"Ch duyt",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" s tuyn",className:"bg-blue-100 text-blue-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"},hired:{text:"Nhn vin chnh thc",className:"bg-green-100 text-green-800"}},s=i[n.status]||i.pending;return p.jsxs("div",{className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-4 flex-grow w-full sm:w-auto",children:[n.workerProfileImageUrl?p.jsx("img",{src:n.workerProfileImageUrl,alt:n.workerName,className:"w-12 h-12 rounded-full object-cover flex-shrink-0"}):p.jsx(so,{className:"w-12 h-12 flex-shrink-0"}),p.jsxs("div",{className:"flex-grow",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:t,className:"font-semibold text-gray-800 hover:text-indigo-600 text-left",children:n.workerName}),n.cvUrl&&p.jsxs("a",{href:n.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded border border-indigo-100 hover:bg-indigo-100",title:"M CV trong tab mi",onClick:o=>o.stopPropagation(),children:[p.jsx(Z0,{className:"w-3 h-3 mr-1"}),"CV"]})]}),p.jsxs("p",{className:"text-sm text-gray-600",children:[" ng tuyn vo: ",p.jsx("span",{className:"font-medium text-indigo-600",children:n.jobTitle})]}),p.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]})]}),p.jsxs("div",{className:"flex flex-col items-end space-y-2 flex-shrink-0 w-full sm:w-auto",children:[n.status==="pending"&&p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:()=>e("accepted"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 hover:bg-blue-200 disabled:opacity-50",children:r?"...":"S tuyn"}),p.jsx("button",{onClick:()=>e("rejected"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 hover:bg-red-200 disabled:opacity-50",children:r?"...":"T chi"})]}),n.status==="accepted"&&p.jsx("button",{onClick:()=>e("hired"),disabled:r,className:"px-4 py-1.5 text-xs font-bold rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 shadow-md disabled:opacity-50 transition-colors",title:"Xc nhn sau khi  phng vn offline thnh cng",children:r?"...":"Xc nhn nhn vin"}),p.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${s.className}`,children:s.text})]})]})},Nv=({application:n,onClick:e})=>{const t={pending:{text:"ang ch",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" s tuyn",className:"bg-blue-100 text-blue-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"},hired:{text:" trng tuyn",className:"bg-green-100 text-green-800"}},r=t[n.status]||t.pending;return p.jsxs("div",{onClick:()=>e(n.jobId),className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-center justify-between gap-3 cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[p.jsxs("div",{className:"flex-grow text-left w-full sm:w-auto",children:[p.jsx("p",{className:"font-semibold text-gray-800",children:n.jobTitle}),p.jsxs("p",{className:"text-sm text-gray-500",children:["Nh tuyn dng: ",p.jsx("span",{className:"font-medium",children:n.employerName})]}),p.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy np n: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]}),p.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:p.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${r.className}`,children:r.text})})]})},T0e=({onViewProfile:n,onJobSelect:e})=>{const{currentUser:t,currentUserData:r,refetchUserData:i,logout:s}=wa(),[o,a]=Y.useState(""),[c,d]=Y.useState(""),[h,m]=Y.useState(""),[_,x]=Y.useState(null),[b,A]=Y.useState(null),[N,F]=Y.useState(""),[B,O]=Y.useState([]),[q,W]=Y.useState(""),[$,D]=Y.useState([]),[k,R]=Y.useState(!1),[U,M]=Y.useState({title:"",company:"",duration:""}),[j,V]=Y.useState(null),[Ee,le]=Y.useState(null),[pe,be]=Y.useState(null),[de,xe]=Y.useState(!1),[ne,z]=Y.useState(""),[ce,Pe]=Y.useState(""),[Re,Ye]=Y.useState([]),[Xe,et]=Y.useState([]),[Ne,Te]=Y.useState(!0),[Ve,it]=Y.useState(!0),[st,lt]=Y.useState(null),[mt,zt]=Y.useState(null),[tn,Gr]=Y.useState([]),[co,gn]=Y.useState(!0),[yn,si]=Y.useState(!1),kl=Y.useRef(null),Pl=Y.useRef(null);Y.useEffect(()=>{if(r){if(a(r.fullName||""),d(r.phoneNumber||""),m(r.address||""),A(r.profileImageUrl||null),F(r.bio||""),O(r.skills||[]),D(r.workHistory||[]),le(r.cvUrl||null),be(r.cvName||null),r.userType===Jt.Employer){Te(!0),it(!0);const ue=y0e(r.uid,xt=>{Ye(xt),Te(!1)}),tt=c7(r.uid,xt=>{et(xt),it(!1)});return()=>{ue(),tt()}}if(r.userType===Jt.Worker){gn(!0);const ue=u7(r.uid,tt=>{Gr(tt),gn(!1)});return()=>ue()}}},[r]);const{openJobs:Au,closedJobs:bs}=Y.useMemo(()=>{const ue=Re.filter(xt=>xt.status==="OPEN"),tt=Re.filter(xt=>xt.status==="CLOSED");return{openJobs:ue,closedJobs:tt}},[Re]),{pendingApplications:Rl,acceptedApplications:_a,rejectedApplications:Cs,hiredApplications:bu}=Y.useMemo(()=>(r==null?void 0:r.userType)!==Jt.Worker?{pendingApplications:[],acceptedApplications:[],rejectedApplications:[],hiredApplications:[]}:{pendingApplications:tn.filter(ue=>ue.status==="pending"),acceptedApplications:tn.filter(ue=>ue.status==="accepted"),rejectedApplications:tn.filter(ue=>ue.status==="rejected"),hiredApplications:tn.filter(ue=>ue.status==="hired")},[tn,r]),uo=async(ue,tt)=>{lt(ue);try{await _0e(ue,tt)}catch(xt){console.error("Failed to update job status:",xt),z("Li cp nht trng thi cng vic.")}finally{lt(null)}},ho=async(ue,tt)=>{const xt=`${ue.jobId}-${ue.id}`;zt(xt);try{await d7(ue,tt)}catch(Jn){console.error("Failed to update application status:",Jn),z("Li cp nht trng thi ng vin.")}finally{zt(null)}},va=async ue=>{si(!0);try{const tt=Re.find(xt=>xt.id===ue);if(tt)e(tt);else{const xt=await w0e(ue);xt?e(xt):alert("Cng vic ny khng cn tn ti hoc  b xa.")}}catch(tt){console.error("Error fetching job details",tt)}finally{si(!1)}},fo=()=>{var ue;(ue=kl.current)==null||ue.click()},Dl=ue=>{var xt;const tt=(xt=ue.target.files)==null?void 0:xt[0];if(tt){x(tt);const Jn=URL.createObjectURL(tt);A(Jn)}},Cu=ue=>{var xt;const tt=(xt=ue.target.files)==null?void 0:xt[0];if(tt){const Jn=tt.name.toLowerCase(),Ol=tt.type||"",Si=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],oi=[".pdf",".doc",".docx"];if(!(Si.some(Ps=>Ol.includes(Ps))||oi.some(Ps=>Jn.endsWith(Ps)))){z("Vui lng ch ti ln file PDF hoc Word.");return}if(tt.size>5*1024*1024){z("File qu ln. Vui lng chn file nh hn 5MB.");return}V(tt),z("")}},Ci=async ue=>{if(ue.preventDefault(),!o){z("Vui lng nhp h v tn ca bn.");return}if(!t){z("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}xe(!0),z(""),Pe("");try{let tt=(r==null?void 0:r.profileImageUrl)||null;_&&(tt=(await hx(_)).trim());let xt=Ee,Jn=pe;j&&(xt=(await hx(j)).trim(),Jn=j.name);const Ol=at.collection("users").doc(t.uid),Si={fullName:o,phoneNumber:c,address:h,profileImageUrl:tt};(r==null?void 0:r.userType)===Jt.Worker&&(Si.bio=N,Si.skills=B,Si.workHistory=$,Si.cvUrl=xt,Si.cvName=Jn),await Ol.update(Si),le(xt),be(Jn),A(tt),await i(),Pe("Cp nht h s thnh cng!"),x(null),V(null)}catch(tt){console.error(tt),tt instanceof Error?z(tt.message):z(" c li xy ra khi cp nht h s. Vui lng th li.")}finally{xe(!1)}},Ml=async()=>{try{await s()}catch(ue){console.error("Failed to log out",ue),z("ng xut tht bi. Vui lng th li.")}},Ss=()=>{q.trim()&&!B.includes(q.trim())&&(O([...B,q.trim()]),W(""))},Ll=ue=>{O(B.filter(tt=>tt!==ue))},Ns=()=>{if(U.title.trim()&&U.company.trim()&&U.duration.trim()){const ue={...U,id:Date.now().toString()};D([...$,ue]),M({title:"",company:"",duration:""}),R(!1)}},ks=ue=>{D($.filter(tt=>tt.id!==ue))};return r?p.jsxs("div",{className:"space-y-8",children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"H s ca bn"}),p.jsx("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-sm p-6 sm:p-8 border border-gray-200 mx-auto",children:p.jsxs("form",{onSubmit:Ci,className:"space-y-6",children:[p.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[p.jsx("input",{type:"file",ref:kl,onChange:Dl,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),p.jsxs("button",{type:"button",onClick:fo,className:"relative w-32 h-32 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed hover:border-indigo-400 transition-all","aria-label":"Thay i nh i din",children:[b||r&&r.profileImageUrl?p.jsx("img",{src:b||r.profileImageUrl,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):p.jsx(so,{className:"w-full h-full text-gray-400 p-8"}),p.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-full flex items-center justify-center transition-opacity",children:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),p.jsx("p",{className:"text-sm text-gray-500",children:"Nhp vo nh  thay i"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),p.jsx("input",{type:"email",id:"email",value:r.email||"",disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-500"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"H v Tn"}),p.jsx("input",{id:"fullName",type:"text",value:o,onChange:ue=>a(ue.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"S in thoi"}),p.jsx("input",{id:"phoneNumber",type:"tel",value:c,onChange:ue=>d(ue.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"a ch"}),p.jsx("input",{id:"address",type:"text",value:h,onChange:ue=>m(ue.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),r.userType===Jt.Worker&&p.jsxs(p.Fragment,{children:[p.jsx("hr",{}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Gii thiu bn thn"}),p.jsx("textarea",{id:"bio",value:N,onChange:ue=>F(ue.target.value),rows:3,placeholder:"Vit mt vi dng v bn thn v kinh nghim ca bn...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s nng lc (CV)"}),p.jsx("input",{type:"file",ref:Pl,onChange:Cu,className:"hidden",accept:".pdf,.doc,.docx"}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("button",{type:"button",onClick:()=>{var ue;return(ue=Pl.current)==null?void 0:ue.click()},className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-200 flex items-center",children:[p.jsx(Z0,{className:"w-5 h-5 mr-2"}),j?"i file":"Ti ln CV"]}),j&&p.jsx("span",{className:"text-sm text-green-600",children:j.name}),Ee&&!j&&p.jsxs("a",{href:Ee,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:underline flex items-center",children:[p.jsx($S,{className:"w-4 h-4 mr-1"}),pe||"Xem CV hin ti"]})]}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"H tr nh dng PDF, Word. Ti a 5MB."})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"skills",className:"block text-sm font-medium text-gray-700 mb-1",children:"K nng"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{id:"skills",type:"text",value:q,onChange:ue=>W(ue.target.value),onKeyDown:ue=>ue.key==="Enter"&&(ue.preventDefault(),Ss()),placeholder:"VD: Sa in, gi tr...",className:"flex-grow p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),p.jsx("button",{type:"button",onClick:Ss,className:"bg-indigo-100 text-indigo-700 font-semibold px-4 rounded-lg hover:bg-indigo-200",children:"Thm"})]}),p.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:B.map(ue=>p.jsxs("span",{className:"flex items-center bg-gray-200 text-gray-800 text-sm font-medium px-3 py-1 rounded-full",children:[ue,p.jsx("button",{type:"button",onClick:()=>Ll(ue),className:"ml-2 text-gray-500 hover:text-gray-800",children:p.jsx(J5,{className:"w-4 h-4"})})]},ue))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lch s lm vic"}),p.jsxs("div",{className:"space-y-3",children:[$.map(ue=>p.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-800",children:ue.title}),p.jsx("p",{className:"text-sm text-gray-600",children:ue.company}),p.jsx("p",{className:"text-xs text-gray-500",children:ue.duration})]}),p.jsx("button",{type:"button",onClick:()=>ks(ue.id),className:"text-gray-400 hover:text-red-500 p-1",children:p.jsx(X0,{className:"w-5 h-5"})})]},ue.id)),$.length===0&&!k&&p.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"Cha c kinh nghim lm vic."}),k&&p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg space-y-3 bg-white",children:[p.jsx("input",{type:"text",value:U.title,onChange:ue=>M({...U,title:ue.target.value}),placeholder:"Chc danh cng vic",className:"w-full p-2 border border-gray-300 rounded-md"}),p.jsx("input",{type:"text",value:U.company,onChange:ue=>M({...U,company:ue.target.value}),placeholder:"Tn cng ty/ni lm vic",className:"w-full p-2 border border-gray-300 rounded-md"}),p.jsx("input",{type:"text",value:U.duration,onChange:ue=>M({...U,duration:ue.target.value}),placeholder:"Thi gian (VD: 2020 - 2022)",className:"w-full p-2 border border-gray-300 rounded-md"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",onClick:Ns,className:"bg-green-600 text-white font-semibold py-1 px-3 rounded-md text-sm hover:bg-green-700",children:"Lu"}),p.jsx("button",{type:"button",onClick:()=>R(!1),className:"bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-md text-sm hover:bg-gray-300",children:"Hy"})]})]}),!k&&p.jsxs("button",{type:"button",onClick:()=>R(!0),className:"w-full flex items-center justify-center gap-2 text-sm font-semibold text-indigo-600 hover:text-indigo-800 p-2 border-2 border-dashed rounded-lg hover:border-indigo-400 transition-colors",children:[p.jsx(Ub,{className:"w-5 h-5"}),"Thm kinh nghim"]})]})]})]})]}),ne&&p.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:ne}),ce&&p.jsx("p",{className:"text-green-600 text-sm text-center bg-green-50 p-3 rounded-lg border border-green-200",children:ce}),p.jsxs("div",{className:"pt-2 space-y-4",children:[p.jsxs("button",{type:"submit",disabled:de,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center",children:[de&&p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),de?"ang lu...":"Lu thay i"]}),p.jsx("button",{type:"button",onClick:Ml,className:"w-full bg-gray-100 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"ng xut"})]})]})}),r.userType===Jt.Employer&&p.jsxs("div",{className:"max-w-4xl w-full mx-auto mt-12 space-y-10",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng ang m"}),Ne?p.jsx(ir,{}):Au.length>0?p.jsx("div",{className:"space-y-3",children:Au.map(ue=>p.jsx(j5,{job:ue,onStatusChange:uo,isUpdating:st===ue.id,onClick:tt=>e(tt)},ue.id))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no ang m."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng  ng"}),Ne?p.jsx(ir,{}):bs.length>0?p.jsx("div",{className:"space-y-3",children:bs.map(ue=>p.jsx(j5,{job:ue,onStatusChange:uo,isUpdating:st===ue.id,onClick:tt=>e(tt)},ue.id))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no  ng."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"ng vin  np n"}),Ve?p.jsx(ir,{}):Xe.length>0?p.jsx("div",{className:"space-y-3",children:Xe.map(ue=>p.jsx(x0e,{application:ue,onStatusUpdate:tt=>ho(ue,tt),onViewProfile:()=>n(ue.workerId,ue),isUpdating:mt===`${ue.jobId}-${ue.id}`},`${ue.jobId}-${ue.id}`))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c ng vin no np n."})]})]}),r.userType===Jt.Worker&&p.jsxs("div",{className:"max-w-2xl w-full mx-auto mt-12 space-y-10",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cng vic chnh thc ( trng tuyn)"}),co?p.jsx(ir,{}):bu.length>0?p.jsx("div",{className:"space-y-3",children:bu.map(ue=>p.jsx(Nv,{application:ue,onClick:va},`${ue.jobId}-${ue.id}`))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn cha c cng vic chnh thc no."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn ang ch"}),co?p.jsx(ir,{}):Rl.length>0?p.jsx("div",{className:"space-y-3",children:Rl.map(ue=>p.jsx(Nv,{application:ue,onClick:va},`${ue.jobId}-${ue.id}`))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no ang ch."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"S tuyn thnh cng"}),co?p.jsx(ir,{}):_a.length>0?p.jsx("div",{className:"space-y-3",children:_a.map(ue=>p.jsx(Nv,{application:ue,onClick:va},`${ue.jobId}-${ue.id}`))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c n ng tuyn no c s tuyn."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn b t chi"}),co?p.jsx(ir,{}):Cs.length>0?p.jsx("div",{className:"space-y-3",children:Cs.map(ue=>p.jsx(Nv,{application:ue,onClick:va},`${ue.jobId}-${ue.id}`))}):p.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no b t chi."})]})]}),yn&&p.jsx(ir,{fullScreen:!0,message:"ang ti chi tit cng vic..."})]}):p.jsx(ir,{message:"ang ti h s..."})},I0e=({initialCenter:n,initialZoom:e,onLocationChange:t})=>{const r=Y.useRef(null),i=Y.useRef(null);return Y.useEffect(()=>{if(i.current||!r.current)return;const s=window.L;if(!s){console.error("Th vin Leaflet khng tm thy.");return}const o=n||{lat:16.0544,lng:108.2022},a=e||6,c=s.map(r.current,{zoomControl:!1}).setView([o.lat,o.lng],a);return i.current=c,s.control.zoom({position:"topright"}).addTo(c),s.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(c),t({lat:o.lat,lng:o.lng}),c.on("moveend",()=>{const d=c.getCenter();t({lat:d.lat,lng:d.lng})}),()=>{i.current&&(i.current.remove(),i.current=null)}},[]),Y.useEffect(()=>{i.current&&n&&(i.current.setView([n.lat,n.lng],e||15),t(n))},[n,e,t]),p.jsxs("div",{className:"relative w-full h-80 rounded-lg shadow-md z-0 border overflow-hidden",children:[p.jsx("div",{ref:r,className:"w-full h-full"}),p.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-full pointer-events-none z-[1000]",children:p.jsx(Hc,{className:"w-10 h-10 text-red-500 drop-shadow-lg"})}),p.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-sm text-gray-700 text-xs font-semibold px-3 py-1.5 rounded-full shadow-md pointer-events-none",children:"Di chuyn bn   chn v tr"})]})},A0e=({onClose:n,userLocation:e})=>{const{currentUserData:t}=wa(),[r,i]=Y.useState(""),[s,o]=Y.useState(""),[a,c]=Y.useState([]),[d,h]=Y.useState([]),[m,_]=Y.useState([]),[x,b]=Y.useState(!1),[A,N]=Y.useState(!1),[F,B]=Y.useState(!1),[O,q]=Y.useState(""),[W,$]=Y.useState(""),[D,k]=Y.useState(""),[R,U]=Y.useState(""),[M,j]=Y.useState(null),[V,Ee]=Y.useState(""),[le,pe]=Y.useState("THEO NGY"),[be,de]=Y.useState("Thi v"),[xe,ne]=Y.useState(!1),[z,ce]=Y.useState(!1),[Pe,Re]=Y.useState("");Y.useEffect(()=>{(async()=>{b(!0),Re("");try{const Te=await fetch("https://open.oapi.vn/location/provinces?size=100");if(!Te.ok)throw new Error("Network response was not ok");const it=((await Te.json()).data||[]).map(st=>({name:st.name,code:parseInt(st.id,10)}));c(it)}catch(Te){console.error("Failed to fetch provinces:",Te),Re("Khng th ti danh sch Tnh/Thnh. Vui lng th li.")}finally{b(!1)}})()},[]),Y.useEffect(()=>{if(!O){h([]),_([]),$(""),k("");return}(async()=>{N(!0),Re("");try{const Te=await fetch(`https://open.oapi.vn/location/districts/${O}?size=100`);if(!Te.ok)throw new Error("Network response was not ok");const it=((await Te.json()).data||[]).map(st=>({name:st.name,code:parseInt(st.id,10),province_code:parseInt(st.provinceId,10)}));h(it)}catch(Te){console.error("Failed to fetch districts:",Te),Re("Khng th ti danh sch Qun/Huyn.")}finally{N(!1)}})()},[O]),Y.useEffect(()=>{if(!W){_([]),k("");return}(async()=>{B(!0),Re("");try{const Te=await fetch(`https://open.oapi.vn/location/wards/${W}?size=100`);if(!Te.ok)throw new Error("Network response was not ok");const it=((await Te.json()).data||[]).map(st=>({name:st.name,code:parseInt(st.id,10),district_code:parseInt(st.districtId,10)}));_(it)}catch(Te){console.error("Failed to fetch wards:",Te),Re("Khng th ti danh sch Phng/X.")}finally{B(!1)}})()},[W]);const Ye=Ne=>{q(Ne.target.value),$(""),k(""),h([]),_([])},Xe=Ne=>{$(Ne.target.value),k(""),_([])},et=async Ne=>{var Te,Ve,it;if(Ne.preventDefault(),!t){Re("Bn phi ng nhp  ng tin.");return}if(!M){Re("Vui lng chn mt v tr trn bn .");return}if(!O||!W||!D){Re("Vui lng chn y  Tnh/Thnh, Qun/Huyn, v Phng/X.");return}ce(!0),Re("");try{const st=((Te=a.find(Gr=>Gr.code===parseInt(O)))==null?void 0:Te.name)||"",lt=((Ve=d.find(Gr=>Gr.code===parseInt(W)))==null?void 0:Ve.name)||"",mt=((it=m.find(Gr=>Gr.code===parseInt(D)))==null?void 0:it.name)||"",zt=`${R}, ${mt}, ${lt}, ${st}`.trim(),tn={title:r,description:s,addressString:zt,coordinates:M,payRate:xe?"Tha thun":parseFloat(V)||0,payType:le,jobType:be};await E0e(tn,t),n()}catch(st){Re(st.message||" c li xy ra. Vui lng th li."),console.error(st)}finally{ce(!1)}};return p.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start p-4 overflow-y-auto",onClick:n,"aria-modal":"true",role:"dialog",children:[p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up mt-8 mb-8",onClick:Ne=>Ne.stopPropagation(),children:p.jsxs("form",{onSubmit:et,children:[p.jsxs("div",{className:"p-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"ng tin tuyn dng mi"}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cung cp thng tin chi tit v cng vic bn mun ng."}),p.jsxs("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Tiu  cng vic"}),p.jsx("input",{type:"text",id:"title",value:r,onChange:Ne=>i(Ne.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"M t chi tit"}),p.jsx("textarea",{id:"description",value:s,onChange:Ne=>o(Ne.target.value),required:!0,rows:4,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-y"})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700",children:"Tnh/Thnh ph"}),p.jsxs("select",{id:"province",value:O,onChange:Ye,required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[x?p.jsx("option",{children:"ang ti..."}):p.jsx("option",{value:"",children:"-- Chn Tnh/Thnh --"}),a.map(Ne=>p.jsx("option",{value:Ne.code,children:Ne.name},Ne.code))]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"district",className:"block text-sm font-medium text-gray-700",children:"Qun/Huyn"}),p.jsxs("select",{id:"district",value:W,onChange:Xe,required:!0,disabled:!O||A,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[A?p.jsx("option",{children:"ang ti..."}):p.jsx("option",{value:"",children:"-- Chn Qun/Huyn --"}),d.map(Ne=>p.jsx("option",{value:Ne.code,children:Ne.name},Ne.code))]})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"ward",className:"block text-sm font-medium text-gray-700",children:"Phng/X"}),p.jsxs("select",{id:"ward",value:D,onChange:Ne=>k(Ne.target.value),required:!0,disabled:!W||F,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[F?p.jsx("option",{children:"ang ti..."}):p.jsx("option",{value:"",children:"-- Chn Phng/X --"}),m.map(Ne=>p.jsx("option",{value:Ne.code,children:Ne.name},Ne.code))]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"streetAddress",className:"block text-sm font-medium text-gray-700",children:"S nh, tn ng"}),p.jsx("input",{type:"text",id:"streetAddress",value:R,onChange:Ne=>U(Ne.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"VD: 123 ng Nguyn Hu"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghim v tr chnh xc trn bn "}),p.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Ko bn   ghim  v tr chnh xc nht ca cng vic."}),p.jsx(I0e,{onLocationChange:j,initialCenter:e||{lat:16.0544,lng:108.2022},initialZoom:e?15:6}),M&&p.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Ta   chn: ",M.lat.toFixed(6),", ",M.lng.toFixed(6)]})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"jobType",className:"block text-sm font-medium text-gray-700",children:"Loi hnh cng vic"}),p.jsxs("select",{id:"jobType",value:be,onChange:Ne=>de(Ne.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[p.jsx("option",{children:"Thi v"}),p.jsx("option",{children:"Bn thi gian"}),p.jsx("option",{children:"Linh hot"}),p.jsx("option",{children:"Ton thi gian"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"payType",className:"block text-sm font-medium text-gray-700",children:"Hnh thc tr lng"}),p.jsxs("select",{id:"payType",value:le,onChange:Ne=>pe(Ne.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[p.jsx("option",{value:"THEO NGY",children:"Theo ngy"}),p.jsx("option",{value:"THEO GI",children:"Theo gi"}),p.jsx("option",{value:"THEO THNG",children:"Theo thng"})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"payRate",className:"block text-sm font-medium text-gray-700",children:"Mc lng (VN)"}),p.jsx("input",{type:"number",id:"payRate",value:V,onChange:Ne=>Ee(Ne.target.value),required:!xe,disabled:xe,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"}),p.jsxs("div",{className:"mt-2 flex items-center",children:[p.jsx("input",{type:"checkbox",id:"negotiable",checked:xe,onChange:Ne=>ne(Ne.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),p.jsx("label",{htmlFor:"negotiable",className:"ml-2 block text-sm text-gray-900",children:"Tha thun"})]})]})]})]}),Pe&&p.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 mx-6 rounded-lg border border-red-200",children:Pe}),p.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[p.jsxs("button",{type:"submit",disabled:z,className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 flex items-center justify-center disabled:bg-indigo-400",children:[z&&p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),z?"ang ng tin...":"ng tin"]}),p.jsx("button",{type:"button",onClick:n,className:"w-full bg-white text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors duration-300","aria-label":"Hy",children:"Hy"})]})]})}),p.jsx("style",{children:`
        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
    `})]})},b0e=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.82m5.84-2.56a6 6 0 0 1-7.38 5.84m2.56-5.84a6 6 0 0 1 5.84-7.38m-5.84 2.56a6 6 0 0 1 7.38-5.84m-2.56 5.84a6 6 0 0 1-5.84 7.38m5.84-2.56a6 6 0 0 1-7.38 5.84m0-11.68a6 6 0 0 1 7.38-5.84m-7.38 5.84a6 6 0 0 1 5.84-7.38"})}),C0e=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),S0e=({onNavigateToAuth:n})=>{const e=[{name:"Tnh nng",href:"#features"},{name:"Hot ng",href:"#how-it-works"},{name:"V sao chn?",href:"#why-us"}],t=[{icon:p.jsx(Ts,{className:"w-8 h-8 text-indigo-600"}),title:"Tm Vic Nhanh Chng, Gn Nh",description:"Kt ni trc tip vi hng ngn c hi vic lm thi v, bn thi gian t cc nh tuyn dng uy tn trong khu vc ca bn."},{icon:p.jsx(ia,{className:"w-8 h-8 text-green-600"}),title:"Tch Ly Tng Lai Vi BHXH",description:"D dng trch mt phn thu nhp  ng bo him x hi t nguyn, m bo lng hu v an sinh khi v gi."},{icon:p.jsx(gc,{className:"w-8 h-8 text-amber-600"}),title:"H Tr Thng Minh 4.0",description:"Nhn t vn t chatbot AI v lut lao ng v to nh i din chuyn nghip  gy n tng vi nh tuyn dng."}],r=[{icon:p.jsx(iE,{className:"w-8 h-8 text-blue-600"}),title:"An Ton & Minh Bch",description:"Mi cng vic u c xc thc, thng tin r rng. Chng ti bo v quyn li ca bn, gip bn thot khi s bp bnh khi tm vic qua cc knh khng chnh thc."},{icon:p.jsx(b0e,{className:"w-8 h-8 text-green-600"}),title:"Hiu Qu & Nhanh Chng",description:"i vi nh tuyn dng, vic tm kim lao ng thi v ph hp tr nn d dng hn bao gi ht, gip tit kim thi gian v ti u ha hot ng kinh doanh."},{icon:p.jsx(e0,{className:"w-8 h-8 text-red-600"}),title:"Tc ng X Hi",description:"Bn ang chung tay gii quyt bi ton an sinh cho hn 20 triu lao ng t do, gp phn xy dng mt x hi n nh v pht trin bn vng."}],i=[{quote:"Nh An Tm Vic Lm, ti  tm c cng vic ph h gn nh vi thu nhp n nh. Vic ng k v tm vic rt n gin v minh bch.",name:"Anh Minh Tun",role:"Lao ng xy dng",avatar:"https://images.unsplash.com/photo-1581092921462-2150b3e19190?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},{quote:"Nn tng gip ti nhanh chng tm c ngi gip vic theo gi mi khi qun ng khch. Cc ng vin u c thng tin r rng, rt ng tin cy.",name:"Ch Lan Anh",role:"Ch qun n",avatar:"https://images.unsplash.com/photo-1600565193348-f74d3c2723a9?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}];return p.jsxs("div",{className:"bg-white text-gray-800 antialiased animate-fade-in",children:[p.jsx("header",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-sm border-b border-gray-200",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex items-center justify-between h-20",children:[p.jsxs("div",{className:"flex items-center space-x-10",children:[p.jsxs("a",{href:"#",className:"flex items-center flex-shrink-0 group",children:[p.jsx(ia,{className:"h-8 w-8 text-indigo-600"}),p.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),p.jsx("nav",{className:"hidden md:flex items-baseline space-x-6",children:e.map(s=>p.jsx("a",{href:s.href,className:"text-gray-600 hover:text-indigo-600 font-medium transition-colors",children:s.name},s.name))})]}),p.jsx("div",{className:"flex items-center space-x-4",children:p.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:"ng nhp"})})]})})}),p.jsxs("main",{children:[p.jsx("section",{className:"relative bg-gray-50",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-2 gap-16 items-center pt-24 pb-32",children:[p.jsxs("div",{className:"text-center md:text-left",children:[p.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Nn tng ",p.jsx("span",{className:"text-indigo-600",children:"An Sinh"})," v ",p.jsx("span",{className:"text-indigo-600",children:"Vic Lm"})," cho Lao ng T Do"]}),p.jsx("p",{className:"mt-6 text-lg text-gray-600",children:"Tm vic thi v linh hot, ng gp BHXH d dng, xy dng mt tng lai vng chc v an tm hn."}),p.jsxs("div",{className:"mt-10 flex flex-col sm:flex-row justify-center md:justify-start gap-4",children:[p.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"Tham Gia Ngay"}),p.jsx("a",{href:"#features",className:"bg-white text-indigo-600 font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-50 transition-colors border-2 border-indigo-200",children:"Tm hiu thm"})]})]}),p.jsx("div",{className:"hidden md:block",children:p.jsx("img",{src:"https://images.unsplash.com/photo-1552664730-d307ca884978?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Freelance working smiling",className:"rounded-2xl shadow-2xl object-cover w-full h-full"})})]})}),p.jsx("section",{id:"how-it-works",className:"py-20",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"text-center mb-16",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Hot ng nh th no?"}),p.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Ch vi 3 bc n gin  bt u hnh trnh ca bn."})]}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-center",children:[p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"1"}),p.jsx("h3",{className:"text-xl font-bold mb-2",children:"To H S Chuyn Nghip"}),p.jsx("p",{className:"text-gray-600",children:"ng k ti khon v hon thin h s ca bn ch trong vi pht. Thm nh i din do AI to  tng c hi."})]}),p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"2"}),p.jsx("h3",{className:"text-xl font-bold mb-2",children:"Tm Vic & ng Tuyn"}),p.jsx("p",{className:"text-gray-600",children:"Duyt qua hng ngn cng vic thi v, bn thi gian c cp nht lin tc. ng tuyn ch vi mt c nhp chut."})]}),p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"3"}),p.jsx("h3",{className:"text-xl font-bold mb-2",children:"Nhn Lng & Tch Ly"}),p.jsx("p",{className:"text-gray-600",children:"Nhn thanh ton minh bch v d dng trch mt phn thu nhp  ng BHXH, m bo cho tng lai ca bn."})]})]})]})}),p.jsx("section",{id:"features",className:"py-20 bg-slate-50",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"text-center mb-16",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Mi th bn cn,  cng mt ni"}),p.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Chng ti n gin ha vic tm kim c hi v m bo tng lai."})]}),p.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((s,o)=>p.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[p.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-indigo-100 mb-6",children:s.icon}),p.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:s.title}),p.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),p.jsx("section",{id:"why-us",className:"py-20",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"text-center mb-16",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Khng Ch L Vic Lm, L S An Tm"}),p.jsx("p",{className:"mt-4 max-w-3xl mx-auto text-lg text-gray-600",children:"Chng ti khng ch kt ni bn vi cng vic. Chng ti xy dng mt nn tng vng chc cho tng lai ca bn."})]}),p.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:r.map((s,o)=>p.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[p.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-gray-100 mb-6",children:s.icon}),p.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:s.title}),p.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),p.jsx("section",{id:"testimonials",className:"py-20 bg-slate-50",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"text-center mb-16",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Ting ni t cng ng"}),p.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Xem ngi lao ng v nh tuyn dng ni g v chng ti."})]}),p.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:i.map((s,o)=>p.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200",children:[p.jsxs("p",{className:"text-gray-600 italic mb-6",children:['"',s.quote,'"']}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("img",{src:s.avatar,alt:s.name,className:"w-12 h-12 rounded-full object-cover mr-4"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-bold text-gray-900",children:s.name}),p.jsx("p",{className:"text-gray-500 text-sm",children:s.role})]})]})]},o))})]})}),p.jsx("section",{children:p.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Sn Sng Bt u Hnh Trnh Ca Bn?"}),p.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Tham gia cng ng An Tm Vic Lm ngay hm nay  tm kim c hi v xy dng mt tng lai an ton hn."}),p.jsx("div",{className:"mt-8",children:p.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"To ti khon min ph"})})]})})]}),p.jsx("footer",{className:"bg-gray-800 text-white",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[p.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[p.jsxs("div",{className:"md:col-span-1",children:[p.jsxs("a",{href:"#",className:"flex items-center justify-center md:justify-start flex-shrink-0 group",children:[p.jsx(ia,{className:"h-8 w-8 text-indigo-400"}),p.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),p.jsx("p",{className:"text-gray-400 mt-2 text-center md:text-left",children:"Nn tng an sinh v vic lm cho lao ng t do."})]}),p.jsxs("div",{className:"md:col-span-1",children:[p.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin kt nhanh"}),p.jsx("nav",{className:"flex flex-col items-center md:items-start space-y-2",children:e.map(s=>p.jsx("a",{href:s.href,className:"text-gray-300 hover:text-white font-medium transition-colors",children:s.name},s.name))})]}),p.jsxs("div",{className:"md:col-span-1",children:[p.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin h"}),p.jsxs("div",{className:"flex items-center justify-center md:justify-start text-gray-300",children:[p.jsx(C0e,{className:"w-5 h-5 mr-2"}),p.jsx("a",{href:"mailto:nguyenduyphuc0119@gmail.com",className:"hover:text-white transition-colors",children:"nguyenduyphuc0119@gmail.com"})]})]})]}),p.jsx("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400 text-sm",children:p.jsx("p",{children:" 2024 An Tm Vic Lm. Mi quyn c bo lu."})})]})})]})},N0e=()=>p.jsxs("svg",{className:"w-5 h-5 mr-3",xmlns:"http://www.w.w3.org/2000/svg",viewBox:"0 0 48 48",children:[p.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"}),p.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"}),p.jsx("path",{fill:"#4CAF50",d:"M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.222 0-9.618-3.317-11.284-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"}),p.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.012 34.423 44 29.836 44 24c0-1.341-.138-2.65-.389-3.917z"})]}),k0e=({onBackToLanding:n})=>{const[e,t]=Y.useState(!0),[r,i]=Y.useState(""),[s,o]=Y.useState(""),[a,c]=Y.useState(""),[d,h]=Y.useState(Jt.Worker),[m,_]=Y.useState(""),[x,b]=Y.useState(!1),[A,N]=Y.useState(!1),{signup:F,login:B,loginWithGoogle:O}=wa(),q=async $=>{if($.preventDefault(),_(""),b(!0),!e&&s!==a){_("Mt khu khng khp."),b(!1);return}try{e?await B(r,s):await F(r,s,d)}catch(D){switch(D.code){case"auth/user-not-found":_("Khng tm thy ti khon vi email ny.");break;case"auth/wrong-password":_("Sai mt khu. Vui lng th li.");break;case"auth/email-already-in-use":_("Email ny  c s dng.");break;case"auth/weak-password":_("Mt khu phi c t nht 6 k t.");break;case"auth/popup-closed-by-user":_("Bn  ng ca s ng nhp. Vui lng th li.");break;default:_(" xy ra li. Vui lng th li.");break}}finally{b(!1)}},W=async()=>{_(""),N(!0);try{await O()}catch($){switch($.code){case"auth/popup-closed-by-user":_("Bn  ng ca s ng nhp. Vui lng th li.");break;default:_("ng nhp vi Google tht bi. Vui lng th li.");break}N(!1)}};return p.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-white px-4 animate-fade-in relative",children:[p.jsxs("button",{onClick:n,className:"absolute top-6 left-6 flex items-center text-sm font-semibold text-gray-600 hover:text-indigo-600 transition-colors group",children:[p.jsx(m7,{className:"w-5 h-5 mr-2 text-gray-500 group-hover:text-indigo-600"}),"Quay li trang ch"]}),p.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-2xl border border-gray-100 p-8 space-y-6",children:[p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(ia,{className:"h-12 w-12 text-indigo-600"}),p.jsx("h1",{className:"mt-3 text-3xl font-bold text-gray-800",children:"Cho mng n An Tm Vic Lm"}),p.jsx("p",{className:"text-gray-600 mt-2",children:e?"ng nhp vo ti khon ca bn":"To ti khon mi"})]}),p.jsx("div",{className:"space-y-4",children:p.jsx("button",{onClick:W,disabled:A||x,className:"w-full flex justify-center items-center bg-white text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:bg-gray-200 transition-colors",children:A?p.jsxs(p.Fragment,{children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang chuyn hng..."]}):p.jsxs(p.Fragment,{children:[p.jsx(N0e,{})," ng nhp vi Google"]})})}),p.jsxs("div",{className:"relative flex py-2 items-center",children:[p.jsx("div",{className:"flex-grow border-t border-gray-300"}),p.jsx("span",{className:"flex-shrink mx-4 text-gray-500 text-sm",children:"HOC"}),p.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),p.jsxs("form",{onSubmit:q,className:"space-y-6",children:[p.jsx("input",{type:"email",value:r,onChange:$=>i($.target.value),placeholder:"Email",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),p.jsx("input",{type:"password",value:s,onChange:$=>o($.target.value),placeholder:"Mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),!e&&p.jsxs(p.Fragment,{children:[p.jsx("input",{type:"password",value:a,onChange:$=>c($.target.value),placeholder:"Xc nhn mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),p.jsxs("div",{children:[p.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bn l:"}),p.jsxs("div",{className:"flex gap-4",children:[p.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"role",value:Jt.Worker,checked:d===Jt.Worker,onChange:()=>h(Jt.Worker),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),p.jsx("span",{className:"text-gray-700",children:"Ngi lao ng"})]}),p.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"role",value:Jt.Employer,checked:d===Jt.Employer,onChange:()=>h(Jt.Employer),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),p.jsx("span",{className:"text-gray-700",children:"Nh tuyn dng"})]})]})]})]}),m&&p.jsx("p",{className:"text-red-500 text-sm text-center",children:m}),p.jsx("button",{type:"submit",disabled:x||A,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors",children:x?"ang x l...":e?"ng nhp":"ng k"})]}),p.jsxs("p",{className:"text-center text-sm",children:[e?"Cha c ti khon?":" c ti khon?",p.jsx("button",{onClick:()=>{t(!e),_("")},className:"font-medium text-indigo-600 hover:text-indigo-500 ml-1",children:e?"ng k":"ng nhp"})]})]})]})},P0e=()=>{const[n,e]=Y.useState("landing");return n==="landing"?p.jsx(S0e,{onNavigateToAuth:()=>e("auth")}):p.jsx(k0e,{onBackToLanding:()=>e("landing")})},R0e=()=>{const{currentUser:n,currentUserData:e,refetchUserData:t}=wa(),r=!e,[i,s]=Y.useState((e==null?void 0:e.fullName)||""),[o,a]=Y.useState((e==null?void 0:e.phoneNumber)||""),[c,d]=Y.useState((e==null?void 0:e.address)||""),[h,m]=Y.useState(Jt.Worker),[_,x]=Y.useState(null),[b,A]=Y.useState((e==null?void 0:e.profileImageUrl)||(n==null?void 0:n.photoURL)||null),[N,F]=Y.useState(!1),[B,O]=Y.useState(""),q=Y.useRef(null),W=()=>{var k;(k=q.current)==null||k.click()},$=k=>{var U;const R=(U=k.target.files)==null?void 0:U[0];if(R){x(R);const M=URL.createObjectURL(R);A(M)}},D=async k=>{if(k.preventDefault(),!i){O("Vui lng nhp h v tn ca bn.");return}if(!n){O("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}F(!0),O("");try{let R=b;_&&(R=await hx(_));const U=at.collection("users").doc(n.uid);r?await U.set({uid:n.uid,email:n.email,userType:h,createdAt:ga(),fullName:i,phoneNumber:o,address:c,profileImageUrl:R,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}):await U.update({fullName:i,phoneNumber:o,address:c,profileImageUrl:R}),await t()}catch(R){console.error(R),R instanceof Error?O(R.message):O(" c li xy ra khi cp nht h s. Vui lng th li."),F(!1)}};return p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12",children:p.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 space-y-6 animate-fade-in-up",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:r?"Cho mng bn mi!":"Hon thin h s"}),p.jsx("p",{className:"text-gray-600 mt-2",children:r?"Vui lng chn vai tr v cp nht thng tin  bt u.":"Vui lng cp nht thng tin  tip tc."})]}),p.jsxs("form",{onSubmit:D,className:"space-y-6",children:[r&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bn mun tham gia vi t cch l?"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("button",{type:"button",onClick:()=>m(Jt.Worker),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${h===Jt.Worker?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[p.jsx(Fb,{className:"w-8 h-8 mb-2"}),p.jsx("span",{className:"font-bold text-sm",children:"Ngi Lao ng"})]}),p.jsxs("button",{type:"button",onClick:()=>m(Jt.Employer),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${h===Jt.Employer?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[p.jsx(Ts,{className:"w-8 h-8 mb-2"}),p.jsx("span",{className:"font-bold text-sm",children:"Nh Tuyn Dng"})]})]})]}),p.jsxs("div",{className:"flex flex-col items-center space-y-4 pt-2",children:[p.jsx("input",{type:"file",ref:q,onChange:$,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),p.jsxs("button",{type:"button",onClick:W,className:"relative w-28 h-28 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-300 hover:border-indigo-500 transition-colors","aria-label":"Thay i nh i din",children:[b?p.jsx("img",{src:b,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):p.jsx(so,{className:"w-12 h-12 text-gray-400"}),p.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 rounded-full flex items-center justify-center transition-opacity",children:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),p.jsx("p",{className:"text-xs text-gray-500",children:"nh i din"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{children:p.jsx("input",{type:"text",value:i,onChange:k=>s(k.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),p.jsx("div",{children:p.jsx("input",{type:"tel",value:o,onChange:k=>a(k.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),p.jsx("div",{children:p.jsx("input",{type:"text",value:c,onChange:k=>d(k.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})})]}),B&&p.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:B}),p.jsxs("button",{type:"submit",disabled:N,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center shadow-md",children:[N&&p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N?"ang x l...":r?"To h s":"Cp nht"]})]})]})})},D0e=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),rH=({className:n="w-6 h-6"})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.311a12.06 12.06 0 00-4.5 0m4.5 0a12.06 12.06 0 01-4.5 0M12 6.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5zM12 12.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5z"})}),wy=({icon:n,title:e,children:t,className:r=""})=>p.jsxs("div",{className:r,children:[p.jsxs("div",{className:"flex items-center mb-3",children:[p.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:n}),p.jsx("h4",{className:"text-lg font-bold text-gray-800",children:e})]}),p.jsx("div",{className:"pl-8",children:t})]}),M0e=({userId:n,application:e,onClose:t,onStartChat:r})=>{const[i,s]=Y.useState(null),[o,a]=Y.useState(!0),[c,d]=Y.useState(""),[h,m]=Y.useState(!1);return Y.useEffect(()=>{(async()=>{a(!0),d("");try{const x=await h7(n);x?(s(x),x.cvUrl&&x.cvUrl.toLowerCase().endsWith(".pdf")&&m(!0)):d("Khng tm thy h s ngi dng.")}catch(x){console.error(x),d(" xy ra li khi ti h s.")}finally{a(!1)}})()},[n]),p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[100] flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:t,"aria-modal":"true",role:"dialog",children:p.jsxs("div",{className:"bg-gray-50 rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up flex flex-col h-[90vh]",style:{animationDuration:"0.3s"},onClick:_=>_.stopPropagation(),children:[o&&p.jsx(ir,{message:"ang ti h s..."}),c&&p.jsx("div",{className:"p-8 text-center text-red-500",children:c}),!o&&i&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"p-6 bg-white border-b",children:[p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[i.profileImageUrl?p.jsx("img",{src:i.profileImageUrl,alt:i.fullName||"User",className:"w-20 h-20 rounded-full object-cover border-2 border-white shadow-md"}):p.jsx(so,{className:"w-20 h-20"}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:i.fullName}),i.address&&p.jsxs("div",{className:"flex items-center text-gray-500 mt-1",children:[p.jsx(Hc,{className:"w-4 h-4 mr-1.5"}),p.jsx("p",{children:i.address})]}),((e==null?void 0:e.contactPhoneNumber)||i.phoneNumber)&&p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ST: ",p.jsx("span",{className:"font-medium",children:(e==null?void 0:e.contactPhoneNumber)||i.phoneNumber})]}),i.email&&p.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",i.email]})]})]}),p.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"ng",children:p.jsx(Sm,{className:"w-6 h-6"})})]}),r&&p.jsx("div",{className:"mt-4 flex justify-end",children:p.jsxs("button",{onClick:r,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[p.jsx(Sx,{className:"w-5 h-5 mr-2"}),"Nhn tin"]})})]}),p.jsxs("div",{className:"flex-grow p-6 sm:p-8 overflow-y-auto space-y-8",children:[e&&e.introduction&&p.jsx(wy,{icon:p.jsx(p7,{className:"w-6 h-6 text-indigo-600"}),title:"Thng tin ng tuyn",className:"bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:p.jsx("div",{className:"space-y-2",children:e.introduction&&p.jsxs("div",{children:[p.jsx("p",{className:"text-xs font-bold text-indigo-800 uppercase mb-1",children:"Li nhn t ng vin"}),p.jsxs("p",{className:"text-gray-700 italic",children:['"',e.introduction,'"']})]})})}),i.cvUrl&&p.jsx(wy,{icon:p.jsx(Z0,{className:"w-6 h-6"}),title:"H s nng lc (CV)",children:p.jsxs("div",{className:"flex flex-col gap-3",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("a",{href:i.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition-colors shadow-sm",children:[p.jsx(Z0,{className:"w-5 h-5 mr-2"}),p.jsx("span",{className:"font-medium",children:"Ti xung / M trong tab mi"})]}),i.cvUrl.toLowerCase().endsWith(".pdf")&&p.jsx("button",{onClick:()=>m(!h),className:"text-sm text-gray-500 underline hover:text-indigo-600",children:h?"n xem trc":"Xem trc nhanh"})]}),h&&i.cvUrl&&p.jsxs("div",{className:"w-full h-[500px] border rounded-lg overflow-hidden bg-gray-100 mt-2 relative group",children:[p.jsx("iframe",{src:i.cvUrl,className:"w-full h-full",title:"CV Preview"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none bg-gray-50 opacity-0 group-hover:opacity-0 transition-opacity",children:p.jsx("p",{className:"text-gray-500",children:"ang ti bn xem trc..."})})]})]})}),i.bio&&p.jsx(wy,{icon:p.jsx(D0e,{className:"w-6 h-6"}),title:"Gii thiu",children:p.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:i.bio})}),i.skills&&i.skills.length>0&&p.jsx(wy,{icon:p.jsx(rH,{className:"w-6 h-6"}),title:"K nng",children:p.jsx("div",{className:"flex flex-wrap gap-2",children:i.skills.map(_=>p.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-sm font-medium px-3 py-1.5 rounded-full",children:_},_))})}),i.workHistory&&i.workHistory.length>0&&p.jsx(wy,{icon:p.jsx(Ts,{className:"w-6 h-6"}),title:"Lch s lm vic",children:p.jsx("div",{className:"space-y-4",children:i.workHistory.map((_,x)=>p.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[p.jsx("h5",{className:"font-bold text-gray-800",children:_.title}),p.jsx("p",{className:"text-sm text-gray-600",children:_.company}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:_.duration})]},x))})})]})]})]})})},L0e=({userLocation:n,allJobs:e,currentUserData:t,onViewOnMap:r,onJobSelect:i})=>{const[s,o]=Y.useState(5),[a,c]=Y.useState(!1),[d,h]=Y.useState([]),[m,_]=Y.useState(!1),[x,b]=Y.useState(null);Y.useEffect(()=>{(async()=>{try{const W=(await at.collection("users").doc(t.uid).get()).data();if(W&&W.lastRecommendations){const $=W.lastRecommendations;$.results&&Array.isArray($.results)&&$.results.length>0&&(h($.results),o($.radius||5),_(!0))}}catch(q){console.error("Failed to load recommendation history",q)}})()},[t.uid]);const A=Y.useMemo(()=>n?e.filter(O=>{const q=YE(O.location);if(!q)return!1;const W=l8(n.lat,n.lng,q.lat,q.lng);return O.distance=W,W<=s&&O.status==="OPEN"}):[],[e,n,s]),N=async()=>{if(A.length===0){h([]),_(!0);return}c(!0);try{const O=A.sort((W,$)=>(W.distance||0)-($.distance||0)).slice(0,20),q=await Eye(t,O);h(q),_(!0),await at.collection("users").doc(t.uid).update({lastRecommendations:{timestamp:new Date().toISOString(),radius:s,results:q}})}catch(O){console.error("Analysis failed",O)}finally{c(!1)}},F=O=>{const q=A.find(W=>W.id===O.jobId);q&&b({rec:O,job:q})},B=O=>O>=80?"text-green-600 bg-green-100 border-green-200":O>=50?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-red-600 bg-red-100 border-red-200";return p.jsxs("div",{className:"space-y-6 animate-fade-in",children:[p.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 sm:p-10 text-white shadow-lg relative overflow-hidden",children:[p.jsxs("div",{className:"relative z-10",children:[p.jsxs("h2",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[p.jsx(gc,{className:"w-8 h-8 text-yellow-300"}),"Gi  Vic lm Thng minh"]}),p.jsx("p",{className:"text-indigo-100 max-w-2xl",children:"S dng AI  phn tch h s ca bn, so snh khong cch, k nng v mc lng  tm ra cng vic ph hp nht trong khu vc."})]}),p.jsx("div",{className:"absolute top-0 right-0 -mr-10 -mt-10 w-40 h-40 bg-white opacity-10 rounded-full"}),p.jsx("div",{className:"absolute bottom-0 left-0 -ml-10 -mb-10 w-40 h-40 bg-purple-400 opacity-20 rounded-full"})]}),p.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-6",children:[p.jsxs("div",{className:"w-full sm:w-2/3",children:[p.jsxs("label",{htmlFor:"radius",className:"block text-sm font-medium text-gray-700 mb-2",children:["Khong cch tm kim: ",p.jsxs("span",{className:"text-indigo-600 font-bold",children:[s," km"]})]}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"range",id:"radius",min:"0.5",max:"10",step:"0.5",value:s,onChange:O=>o(parseFloat(O.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),p.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[p.jsx("span",{children:"500m"}),p.jsx("span",{children:"10km"})]})]})]}),p.jsx("div",{className:"w-full sm:w-auto flex-shrink-0",children:p.jsx("button",{onClick:N,disabled:a||!n,className:"w-full sm:w-auto bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:a?p.jsxs(p.Fragment,{children:[p.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang phn tch..."]}):p.jsxs(p.Fragment,{children:[p.jsx(gc,{className:"w-5 h-5"}),"Phn tch ngay"]})})})]}),!n&&p.jsxs("p",{className:"text-red-500 text-sm mt-2 flex items-center gap-1",children:[p.jsx(Hc,{className:"w-4 h-4"}),"Vui lng bt nh v  s dng tnh nng ny."]}),n&&!m&&p.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Tm thy ",p.jsx("span",{className:"font-bold text-gray-800",children:A.length})," cng vic trong bn knh ",s,'km. Nhn "Phn tch ngay"  AI nh gi.']})]}),m&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"flex items-center justify-between",children:p.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Kt qu  xut (",d.length,")"]})}),d.length===0?p.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:[p.jsx(Ts,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),p.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"Khng tm thy cng vic ph hp cao trong bn knh ny."}),p.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Hy th m rng khong cch tm kim hoc cp nht h s k nng ca bn."})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(O=>{var W;const q=A.find($=>$.id===O.jobId);return q?p.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md hover:border-indigo-300 transition-all flex flex-col h-full relative overflow-hidden",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"text-lg font-bold text-gray-800 line-clamp-1",title:q.title,children:q.title}),p.jsx("p",{className:"text-sm text-gray-600 truncate",children:q.employerName})]}),p.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-4 ${B(O.matchScore)} shadow-sm flex-shrink-0 ml-2`,children:p.jsxs("span",{className:"text-sm font-bold",children:[O.matchScore,"%"]})})]}),p.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-4 space-x-3",children:[p.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[p.jsx(Hc,{className:"w-3 h-3 mr-1"}),(W=q.distance)==null?void 0:W.toFixed(1)," km"]}),p.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[p.jsx(Ts,{className:"w-3 h-3 mr-1"}),q.jobType]})]}),p.jsxs("div",{className:"space-y-4 flex-grow",children:[p.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-100",children:[p.jsxs("p",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide mb-1 flex items-center gap-1",children:[p.jsx(gc,{className:"w-3 h-3"}),"AI nh gi"]}),p.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed line-clamp-3",children:O.reason})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-gray-100",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-green-700 text-xs mb-1",children:"u im chnh"}),p.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:O.pros.slice(0,2).map(($,D)=>p.jsxs("li",{className:"truncate",children:[" ",$]},D))})]}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-red-700 text-xs mb-1",children:"Lu "}),p.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:O.cons.slice(0,1).map(($,D)=>p.jsxs("li",{className:"truncate",children:[" ",$]},D))})]})]})]}),p.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[p.jsxs("button",{onClick:()=>F(O),className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 shadow-sm",children:[p.jsx(gc,{className:"w-4 h-4"}),"Chi tit AI"]}),p.jsxs("button",{onClick:()=>r(q),className:"w-full bg-white text-indigo-600 font-bold py-2 px-4 rounded-lg border border-indigo-200 hover:bg-indigo-50 hover:border-indigo-400 transition-colors flex items-center justify-center gap-2",children:[p.jsx(Hc,{className:"w-4 h-4"}),"Xem v tr"]})]})]},O.jobId):null})})]}),x&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:()=>b(null),children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up max-h-[90vh] flex flex-col",onClick:O=>O.stopPropagation(),children:[p.jsxs("div",{className:"p-6 bg-indigo-600 text-white flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx(gc,{className:"w-6 h-6 text-yellow-300"}),p.jsx("span",{className:"font-bold text-indigo-100 uppercase tracking-wider text-xs",children:"Phn tch chuyn su"})]}),p.jsx("h2",{className:"text-2xl font-bold",children:x.job.title}),p.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:x.job.employerName})]}),p.jsx("button",{onClick:()=>b(null),className:"text-white hover:bg-white/20 rounded-full p-1 transition-colors",children:p.jsx(Sm,{className:"w-6 h-6"})})]}),p.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[p.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded-xl border border-gray-200",children:[p.jsxs("div",{className:`w-16 h-16 rounded-full border-4 ${B(x.rec.matchScore)} flex items-center justify-center bg-white text-xl font-bold shadow-sm`,children:[x.rec.matchScore,"%"]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Mc  ph hp"}),p.jsx("p",{className:"text-sm text-gray-600",children:"Da trn h s k nng, v tr v mong mun ca bn."})]})]}),p.jsxs("div",{children:[p.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-2",children:[p.jsx(rH,{className:"w-5 h-5 text-indigo-500 mr-2"}),"Ti sao cng vic ny ph hp?"]}),p.jsx("p",{className:"text-gray-700 leading-relaxed bg-indigo-50 p-4 rounded-lg border border-indigo-100 text-sm",children:x.rec.reason})]}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[p.jsx($S,{className:"w-5 h-5 text-green-500 mr-2"}),"u im"]}),p.jsx("ul",{className:"space-y-2",children:x.rec.pros.map((O,q)=>p.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[p.jsx("span",{className:"mr-2 text-green-500",children:""}),O]},q))})]}),p.jsxs("div",{children:[p.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[p.jsx(Zk,{className:"w-5 h-5 text-red-500 mr-2"}),"Cn cn nhc"]}),p.jsx("ul",{className:"space-y-2",children:x.rec.cons.map((O,q)=>p.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[p.jsx("span",{className:"mr-2 text-red-500",children:""}),O]},q))})]})]}),x.rec.environmentAnalysis&&p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Phn tch mi trng & Ri ro"}),p.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm text-gray-700",children:x.rec.environmentAnalysis})]})]}),p.jsxs("div",{className:"p-6 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[p.jsxs("button",{onClick:()=>{i(x.job)},className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md flex items-center justify-center gap-2",children:[p.jsx(o7,{className:"w-5 h-5"}),"Xem tin tuyn dng & ng tuyn"]}),p.jsxs("button",{onClick:()=>{r(x.job),b(null)},className:"w-full bg-white text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors flex items-center justify-center gap-2",children:[p.jsx(Hc,{className:"w-5 h-5"}),"Xem v tr trn bn "]})]})]})})]})},O0e="modulepreload",V0e=function(n){return"/"+n},q5={},iH=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let o=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=o(t.map(d=>{if(d=V0e(d),d in q5)return;q5[d]=!0;const h=d.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":O0e,h||(_.as="script"),_.crossOrigin="",_.href=d,c&&_.setAttribute("nonce",c),document.head.appendChild(_),h)return new Promise((x,b)=>{_.addEventListener("load",x),_.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Fm;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(Fm||(Fm={}));class Ob extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const F0e=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},U0e=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},i=()=>e!==null?e.name:F0e(n),s=()=>i()!=="web",o=m=>{const _=d.get(m);return!!(_!=null&&_.platforms.has(i())||a(m))},a=m=>{var _;return(_=t.PluginHeaders)===null||_===void 0?void 0:_.find(x=>x.name===m)},c=m=>n.console.error(m),d=new Map,h=(m,_={})=>{const x=d.get(m);if(x)return console.warn(`Capacitor plugin "${m}" already registered. Cannot register plugins twice.`),x.proxy;const b=i(),A=a(m);let N;const F=async()=>(!N&&b in _?N=typeof _[b]=="function"?N=await _[b]():N=_[b]:e!==null&&!N&&"web"in _&&(N=typeof _.web=="function"?N=await _.web():N=_.web),N),B=(k,R)=>{var U,M;if(A){const j=A==null?void 0:A.methods.find(V=>R===V.name);if(j)return j.rtype==="promise"?V=>t.nativePromise(m,R.toString(),V):(V,Ee)=>t.nativeCallback(m,R.toString(),V,Ee);if(k)return(U=k[R])===null||U===void 0?void 0:U.bind(k)}else{if(k)return(M=k[R])===null||M===void 0?void 0:M.bind(k);throw new Ob(`"${m}" plugin is not implemented on ${b}`,Fm.Unimplemented)}},O=k=>{let R;const U=(...M)=>{const j=F().then(V=>{const Ee=B(V,k);if(Ee){const le=Ee(...M);return R=le==null?void 0:le.remove,le}else throw new Ob(`"${m}.${k}()" is not implemented on ${b}`,Fm.Unimplemented)});return k==="addListener"&&(j.remove=async()=>R()),j};return U.toString=()=>`${k.toString()}() { [capacitor code] }`,Object.defineProperty(U,"name",{value:k,writable:!1,configurable:!1}),U},q=O("addListener"),W=O("removeListener"),$=(k,R)=>{const U=q({eventName:k},R),M=async()=>{const V=await U;W({eventName:k,callbackId:V},R)},j=new Promise(V=>U.then(()=>V({remove:M})));return j.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await M()},j},D=new Proxy({},{get(k,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return A?$:q;case"removeListener":return W;default:return O(R)}}});return r[m]=D,d.set(m,{name:m,proxy:D,platforms:new Set([...Object.keys(_),...A?[b]:[]])}),D};return t.convertFileSrc||(t.convertFileSrc=m=>m),t.getPlatform=i,t.handleError=c,t.isNativePlatform=s,t.isPluginAvailable=o,t.registerPlugin=h,t.Exception=Ob,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},B0e=n=>n.Capacitor=U0e(n),hp=B0e(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),iI=hp.registerPlugin;class sH{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const i=this.listeners[e];if(!i){if(r){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}i.forEach(s=>s(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new hp.Exception(e,Fm.Unimplemented)}unavailable(e="not available"){return new hp.Exception(e,Fm.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const i=r.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const z5=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),$5=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class H0e extends sH{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[i,s]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=$5(i).trim(),s=$5(s).trim(),t[i]=s}),t}async setCookie(e){try{const t=z5(e.key),r=z5(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${i}; path=${s}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}iI("CapacitorCookies",{web:()=>new H0e});const G0e=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const i=r.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},r.onerror=i=>t(i),r.readAsDataURL(n)}),j0e=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(i=>i.toLocaleLowerCase()).reduce((i,s,o)=>(i[s]=n[e[o]],i),{})},q0e=(n,e=!0)=>n?Object.entries(n).reduce((r,i)=>{const[s,o]=i;let a,c;return Array.isArray(o)?(c="",o.forEach(d=>{a=e?encodeURIComponent(d):d,c+=`${s}=${a}&`}),c.slice(0,-1)):(a=e?encodeURIComponent(o):o,c=`${s}=${a}`),`${r}&${c}`},"").substr(1):null,z0e=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),i=j0e(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(i.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[o,a]of Object.entries(n.data||{}))s.set(o,a);t.body=s.toString()}else if(i.includes("multipart/form-data")||n.data instanceof FormData){const s=new FormData;if(n.data instanceof FormData)n.data.forEach((a,c)=>{s.append(c,a)});else for(const a of Object.keys(n.data))s.append(a,n.data[a]);t.body=s;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(i.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class $0e extends sH{async request(e){const t=z0e(e,e.webFetchExtra),r=q0e(e.params,e.shouldEncodeUrlParams),i=r?`${e.url}?${r}`:e.url,s=await fetch(i,t),o=s.headers.get("content-type")||"";let{responseType:a="text"}=s.ok?e:{};o.includes("application/json")&&(a="json");let c,d;switch(a){case"arraybuffer":case"blob":d=await s.blob(),c=await G0e(d);break;case"json":c=await s.json();break;case"document":case"text":default:c=await s.text()}const h={};return s.headers.forEach((m,_)=>{h[_]=m}),{data:c,headers:h,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}iI("CapacitorHttp",{web:()=>new $0e});function W0e(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,i){return(s,o,a)=>{const c=n.Capacitor.Plugins[t];if(c===void 0){a(new Error(`Capacitor plugin ${t} not found`));return}if(typeof c[i]!="function"){a(new Error(`Method ${i} not found in Capacitor plugin ${t}`));return}(async()=>{try{const d=await c[i](s);o(d)}catch(d){a(d)}})()}}})}})}function K0e(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function Q0e(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?W0e(window):window.cordova!==void 0&&K0e(window))}const Vb=iI("Geolocation",{web:()=>iH(()=>import("./web-DjyFUY80.js"),[]).then(n=>new n.GeolocationWeb)});Q0e();const J0e=iI("App",{web:()=>iH(()=>import("./web-BKmwowZA.js"),[]).then(n=>new n.AppWeb)}),Y0e=({activeMode:n,setMode:e})=>p.jsxs("div",{className:"flex items-center bg-gray-200 rounded-lg p-1",children:[p.jsxs("button",{onClick:()=>e("list"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="list"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="list",children:[p.jsx(m0e,{className:"w-4 h-4 mr-2"}),"Danh sch"]}),p.jsxs("button",{onClick:()=>e("map"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="map"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="map",children:[p.jsx(nH,{className:"w-4 h-4 mr-2"}),"Bn "]})]}),X0e=()=>{const{currentUser:n,currentUserData:e,loading:t}=wa(),[r,i]=Y.useState(tr.Jobs),[s,o]=Y.useState(null),[a,c]=Y.useState("list"),[d,h]=Y.useState(null),[m,_]=Y.useState(!1),[x,b]=Y.useState(null),[A,N]=Y.useState(null),[F,B]=Y.useState([]),[O,q]=Y.useState(!0),[W,$]=Y.useState(null),[D,k]=Y.useState(null),[R,U]=Y.useState(!1),[M,j]=Y.useState(""),[V,Ee]=Y.useState(""),le=Y.useCallback(async()=>{U(!0),k(null);const Te=hp.isNativePlatform();try{if(console.log(`Starting location check... (Platform: ${Te?"Native":"Web"})`),Te){if((await Vb.checkPermissions()).location!=="granted"&&(console.log("Requesting Native Permissions..."),(await Vb.requestPermissions()).location!=="granted"))throw{code:1,message:"Quyn v tr b t chi trn ng dng."};const it=await Vb.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4,maximumAge:0});console.log("Native Location found:",it.coords),$({lat:it.coords.latitude,lng:it.coords.longitude})}else{if(!navigator.geolocation)throw new Error("Trnh duyt khng h tr nh v.");const Ve=await new Promise((it,st)=>{const lt={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},mt={enableHighAccuracy:!1,timeout:1e4,maximumAge:3e4};navigator.geolocation.getCurrentPosition(it,zt=>{if(zt.code===1)return st(zt);console.warn("High accuracy GPS failed, trying low accuracy...",zt.message),navigator.geolocation.getCurrentPosition(it,st,mt)},lt)});console.log("Web Location found:",Ve.coords),$({lat:Ve.coords.latitude,lng:Ve.coords.longitude})}}catch(Ve){console.error("Location Error:",Ve);let it="Khng th ly v tr. Vui lng th li.";Ve.code===1?Te?it="Quyn truy cp v tr b t chi. Vui lng cp quyn trong Ci t in thoi.":it=`Quyn v tr cha c cp. Vui lng kim tra:
1. Biu tng  kha  trn thanh a ch -> Chn 'Cho php' (Reset Permission).
2. Ci t V tr ca trnh duyt.`:Ve.code===2?it="Khng tm thy tn hiu GPS. Hy kim tra kt ni mng.":Ve.code===3?it="Qu thi gian ly v tr.":Ve.message?it=Ve.message:typeof Ve=="object"&&(it=`Li v tr: ${JSON.stringify(Ve)}`),$(st=>(st||k(it),st))}finally{U(!1)}},[]);Y.useEffect(()=>{hp.isNativePlatform()||navigator.permissions&&navigator.permissions.query&&navigator.permissions.query({name:"geolocation"}).then(Te=>{const Ve=()=>{console.log("Permission state changed to:",Te.state),Te.state==="granted"?(k(null),le()):Te.state==="prompt"&&k(null)};Te.onchange=Ve}).catch(Te=>console.debug("Permissions API check skipped:",Te))},[le]),Y.useEffect(()=>{const Te=hp.isNativePlatform();if("serviceWorker"in navigator&&!Te){const lt="/sw.js",mt=()=>{navigator.serviceWorker.register(lt).then(zt=>console.log("SW registered:",zt.scope)).catch(zt=>{const tn=zt.message||"";tn.includes("invalid state")||tn.includes("does not match the current origin")||tn.includes("The origin of the provided scriptURL")||tn.includes("404")?console.warn("Service Worker registration skipped (environment limitation):",tn):console.error("SW registration failed:",zt)})};document.visibilityState!=="visible"||document.readyState==="loading"?window.addEventListener("load",mt):mt()}n&&(k(null),le());let Ve;(async()=>{try{Ve=await J0e.addListener("appStateChange",({isActive:lt})=>{lt&&(console.log("App resumed, re-checking location..."),le())})}catch(lt){console.warn("App State Listener failed to register:",lt)}})(),q(!0);const st=g0e(lt=>{B(lt),q(!1)});return()=>{st(),Ve&&Ve.remove()}},[le,n]);const pe=async()=>{if(window.confirm("Thao tc ny s xa b nh m v ti li trang  khc phc li. Bn c mun tip tc?"))try{if("serviceWorker"in navigator){const Te=await navigator.serviceWorker.getRegistrations();for(const Ve of Te)await Ve.unregister()}localStorage.clear(),sessionStorage.clear(),window.location.reload()}catch(Te){console.error(Te),window.location.reload()}},be=Te=>{o(Te)},de=Te=>{Te&&(o(null),i(tr.Jobs),c("map"),h(Te.id))},xe=Te=>{b(Te),i(tr.Messaging)},ne=async Te=>{if(Te)try{const Ve=await Ese(Te);A&&N(null),xe(Ve)}catch(Ve){console.error("Failed to start conversation:",Ve),alert("Khng th bt u cuc tr chuyn.")}},z=()=>{h(null)},ce=()=>{o(null)},Pe=()=>{j(""),Ee("")},Re=Te=>{if(Te.startsWith("/jobs/")){const Ve=Te.split("/jobs/")[1],it=F.find(st=>st.id===Ve);it&&o(it)}else Te==="/profile"&&i(tr.Profile)},{uniqueLocations:Ye,uniqueTypes:Xe,filteredJobs:et}=Y.useMemo(()=>{const Te=F.filter(mt=>mt.status==="OPEN"),Ve=W?Te.map(mt=>{const zt=YE(mt.location);if(zt){const tn=l8(W.lat,W.lng,zt.lat,zt.lng);return{...mt,distance:tn}}return mt}):Te,it=[...new Set(Ve.map(mt=>mt.addressString))],st=[...new Set(Ve.map(mt=>mt.jobType).filter(Boolean))];let lt=Ve;return M&&(lt=lt.filter(mt=>mt.addressString===M)),V&&(lt=lt.filter(mt=>mt.jobType===V)),W&&lt.sort((mt,zt)=>(mt.distance??1/0)-(zt.distance??1/0)),{uniqueLocations:it,uniqueTypes:st,filteredJobs:lt}},[F,M,V,W]),Ne=()=>{const Te=r;return p.jsx("div",{className:"animate-fade-in-up",style:{animationDuration:"0.4s"},children:(()=>{switch(r){case tr.Jobs:return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Tm kim vic lm"}),p.jsx(Y0e,{activeMode:a,setMode:c})]}),p.jsx(u0e,{locations:Ye,types:Xe,locationFilter:M,typeFilter:V,onLocationChange:j,onTypeChange:Ee,onReset:Pe}),D&&p.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-800 p-4 rounded-r-lg flex flex-col sm:flex-row items-center justify-between gap-3 animate-fade-in shadow-sm",children:[p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx(nH,{className:"w-5 h-5 text-red-600"}),p.jsx("p",{className:"font-bold",children:"Cn quyn truy cp v tr"})]}),p.jsx("p",{className:"text-sm opacity-90 whitespace-pre-line",children:D})]}),p.jsxs("div",{className:"flex gap-2 flex-wrap sm:flex-nowrap",children:[p.jsx("button",{onClick:pe,className:"bg-red-100 hover:bg-red-200 text-red-800 font-semibold py-2 px-3 rounded-lg transition-colors text-sm whitespace-nowrap",children:"Sa li kt ni"}),p.jsx("button",{onClick:()=>{le()},disabled:R,className:"bg-white border border-red-200 hover:bg-red-100 text-red-800 font-semibold py-2 px-4 rounded-lg transition-colors flex items-center shrink-0 disabled:opacity-50 shadow-sm whitespace-nowrap",children:R?p.jsxs(p.Fragment,{children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-red-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang th li..."]}):"Th li ngay"})]})]}),a==="list"&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4",children:"Vic lm kh dng"}),O?p.jsx(ir,{message:"ang ti cng vic..."}):et.length>0?et.map(Ve=>p.jsx(Fse,{job:Ve,onClick:()=>be(Ve),applicantCount:Ve.applicantCount||0},Ve.id)):p.jsx("div",{className:"text-center py-16 px-4 bg-gray-50 rounded-lg",children:p.jsx("p",{className:"text-gray-600",children:"Khng tm thy cng vic no ph hp vi b lc ca bn."})})]}),a==="map"&&p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4 mb-4",children:"V tr cng vic"}),O?p.jsx(ir,{}):p.jsx(p0e,{jobs:et,onJobSelect:be,focusedJobId:d,onFocusComplete:z,userLocation:W})]})]});case tr.Recommendations:return p.jsx(L0e,{userLocation:W,allJobs:F,currentUserData:e,onViewOnMap:de,onJobSelect:be});case tr.Insurance:return p.jsx(Bue,{});case tr.Messaging:return p.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:p.jsx(zue,{initialSelectedConversationId:x,clearInitialSelection:()=>b(null)})});case tr.Chatbot:return p.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:p.jsx(l0e,{allJobs:et})});case tr.Profile:return p.jsx(T0e,{onViewProfile:(Ve,it)=>N({userId:Ve,applicationContext:it}),onJobSelect:be});default:return null}})()},Te)};return t?p.jsx(ir,{fullScreen:!0,message:"ang ti ng dng..."}):n?!e||!e.fullName?p.jsx(R0e,{}):p.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe",children:[p.jsx(Lse,{activeView:r,setActiveView:i,onPostJobClick:()=>_(!0),onNotificationNavigate:Re}),p.jsx("main",{className:"max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 md:py-10 pb-28 md:pb-10",children:Ne()}),s&&p.jsx(c0e,{job:s,onClose:ce,onViewOnMap:()=>de(s)}),m&&p.jsx(A0e,{onClose:()=>_(!1),userLocation:W}),A&&p.jsx(M0e,{userId:A.userId,application:A.applicationContext,onClose:()=>N(null),onStartChat:A.applicationContext?()=>ne(A.applicationContext):void 0})]}):p.jsx(P0e,{})},oH=document.getElementById("root");if(!oH)throw new Error("Could not find root element to mount to");const Z0e=Q5.createRoot(oH);Z0e.render(p.jsx(wG.StrictMode,{children:p.jsx(vse,{children:p.jsx(X0e,{})})}));export{sH as W};
