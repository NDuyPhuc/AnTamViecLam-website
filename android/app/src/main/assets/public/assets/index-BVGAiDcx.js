var NF=Object.defineProperty;var uC=n=>{throw TypeError(n)};var kF=(n,e,t)=>e in n?NF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var bt=(n,e,t)=>kF(n,typeof e!="symbol"?e+"":e,t),RF=(n,e,t)=>e.has(n)||uC("Cannot "+t);var dC=(n,e,t)=>e.has(n)?uC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var Im=(n,e,t)=>(RF(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function db(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Uv={exports:{}},ih={},Bv={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hC;function bF(){if(hC)return Ke;hC=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function w(G){return G===null||typeof G!="object"?null:(G=v&&G[v]||G["@@iterator"],typeof G=="function"?G:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,R={};function L(G,ne,Re){this.props=G,this.context=ne,this.refs=R,this.updater=Re||x}L.prototype.isReactComponent={},L.prototype.setState=function(G,ne){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ne,"setState")},L.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function j(){}j.prototype=L.prototype;function B(G,ne,Re){this.props=G,this.context=ne,this.refs=R,this.updater=Re||x}var q=B.prototype=new j;q.constructor=B,A(q,L.prototype),q.isPureReactComponent=!0;var K=Array.isArray,te=Object.prototype.hasOwnProperty,ee={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(G,ne,Re){var Me,Ue={},He=null,ue=null;if(ne!=null)for(Me in ne.ref!==void 0&&(ue=ne.ref),ne.key!==void 0&&(He=""+ne.key),ne)te.call(ne,Me)&&!P.hasOwnProperty(Me)&&(Ue[Me]=ne[Me]);var _e=arguments.length-2;if(_e===1)Ue.children=Re;else if(1<_e){for(var Be=Array(_e),it=0;it<_e;it++)Be[it]=arguments[it+2];Ue.children=Be}if(G&&G.defaultProps)for(Me in _e=G.defaultProps,_e)Ue[Me]===void 0&&(Ue[Me]=_e[Me]);return{$$typeof:n,type:G,key:He,ref:ue,props:Ue,_owner:ee.current}}function b(G,ne){return{$$typeof:n,type:G.type,key:ne,ref:G.ref,props:G.props,_owner:G._owner}}function F(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function D(G){var ne={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Re){return ne[Re]})}var O=/\/+/g;function M(G,ne){return typeof G=="object"&&G!==null&&G.key!=null?D(""+G.key):ne.toString(36)}function $e(G,ne,Re,Me,Ue){var He=typeof G;(He==="undefined"||He==="boolean")&&(G=null);var ue=!1;if(G===null)ue=!0;else switch(He){case"string":case"number":ue=!0;break;case"object":switch(G.$$typeof){case n:case e:ue=!0}}if(ue)return ue=G,Ue=Ue(ue),G=Me===""?"."+M(ue,0):Me,K(Ue)?(Re="",G!=null&&(Re=G.replace(O,"$&/")+"/"),$e(Ue,ne,Re,"",function(it){return it})):Ue!=null&&(F(Ue)&&(Ue=b(Ue,Re+(!Ue.key||ue&&ue.key===Ue.key?"":(""+Ue.key).replace(O,"$&/")+"/")+G)),ne.push(Ue)),1;if(ue=0,Me=Me===""?".":Me+":",K(G))for(var _e=0;_e<G.length;_e++){He=G[_e];var Be=Me+M(He,_e);ue+=$e(He,ne,Re,Be,Ue)}else if(Be=w(G),typeof Be=="function")for(G=Be.call(G),_e=0;!(He=G.next()).done;)He=He.value,Be=Me+M(He,_e++),ue+=$e(He,ne,Re,Be,Ue);else if(He==="object")throw ne=String(G),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return ue}function dt(G,ne,Re){if(G==null)return G;var Me=[],Ue=0;return $e(G,Me,"","",function(He){return ne.call(Re,He,Ue++)}),Me}function et(G){if(G._status===-1){var ne=G._result;ne=ne(),ne.then(function(Re){(G._status===0||G._status===-1)&&(G._status=1,G._result=Re)},function(Re){(G._status===0||G._status===-1)&&(G._status=2,G._result=Re)}),G._status===-1&&(G._status=0,G._result=ne)}if(G._status===1)return G._result.default;throw G._result}var tt={current:null},fe={transition:null},Ne={ReactCurrentDispatcher:tt,ReactCurrentBatchConfig:fe,ReactCurrentOwner:ee};function ye(){throw Error("act(...) is not supported in production builds of React.")}return Ke.Children={map:dt,forEach:function(G,ne,Re){dt(G,function(){ne.apply(this,arguments)},Re)},count:function(G){var ne=0;return dt(G,function(){ne++}),ne},toArray:function(G){return dt(G,function(ne){return ne})||[]},only:function(G){if(!F(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Ke.Component=L,Ke.Fragment=t,Ke.Profiler=i,Ke.PureComponent=B,Ke.StrictMode=r,Ke.Suspense=u,Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ne,Ke.act=ye,Ke.cloneElement=function(G,ne,Re){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var Me=A({},G.props),Ue=G.key,He=G.ref,ue=G._owner;if(ne!=null){if(ne.ref!==void 0&&(He=ne.ref,ue=ee.current),ne.key!==void 0&&(Ue=""+ne.key),G.type&&G.type.defaultProps)var _e=G.type.defaultProps;for(Be in ne)te.call(ne,Be)&&!P.hasOwnProperty(Be)&&(Me[Be]=ne[Be]===void 0&&_e!==void 0?_e[Be]:ne[Be])}var Be=arguments.length-2;if(Be===1)Me.children=Re;else if(1<Be){_e=Array(Be);for(var it=0;it<Be;it++)_e[it]=arguments[it+2];Me.children=_e}return{$$typeof:n,type:G.type,key:Ue,ref:He,props:Me,_owner:ue}},Ke.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},Ke.createElement=k,Ke.createFactory=function(G){var ne=k.bind(null,G);return ne.type=G,ne},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(G){return{$$typeof:l,render:G}},Ke.isValidElement=F,Ke.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:et}},Ke.memo=function(G,ne){return{$$typeof:d,type:G,compare:ne===void 0?null:ne}},Ke.startTransition=function(G){var ne=fe.transition;fe.transition={};try{G()}finally{fe.transition=ne}},Ke.unstable_act=ye,Ke.useCallback=function(G,ne){return tt.current.useCallback(G,ne)},Ke.useContext=function(G){return tt.current.useContext(G)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(G){return tt.current.useDeferredValue(G)},Ke.useEffect=function(G,ne){return tt.current.useEffect(G,ne)},Ke.useId=function(){return tt.current.useId()},Ke.useImperativeHandle=function(G,ne,Re){return tt.current.useImperativeHandle(G,ne,Re)},Ke.useInsertionEffect=function(G,ne){return tt.current.useInsertionEffect(G,ne)},Ke.useLayoutEffect=function(G,ne){return tt.current.useLayoutEffect(G,ne)},Ke.useMemo=function(G,ne){return tt.current.useMemo(G,ne)},Ke.useReducer=function(G,ne,Re){return tt.current.useReducer(G,ne,Re)},Ke.useRef=function(G){return tt.current.useRef(G)},Ke.useState=function(G){return tt.current.useState(G)},Ke.useSyncExternalStore=function(G,ne,Re){return tt.current.useSyncExternalStore(G,ne,Re)},Ke.useTransition=function(){return tt.current.useTransition()},Ke.version="18.3.1",Ke}var fC;function Y0(){return fC||(fC=1,Bv.exports=bF()),Bv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pC;function PF(){if(pC)return ih;pC=1;var n=Y0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,d){var p,v={},w=null,x=null;d!==void 0&&(w=""+d),u.key!==void 0&&(w=""+u.key),u.ref!==void 0&&(x=u.ref);for(p in u)r.call(u,p)&&!s.hasOwnProperty(p)&&(v[p]=u[p]);if(l&&l.defaultProps)for(p in u=l.defaultProps,u)v[p]===void 0&&(v[p]=u[p]);return{$$typeof:e,type:l,key:w,ref:x,props:v,_owner:i.current}}return ih.Fragment=t,ih.jsx=o,ih.jsxs=o,ih}var mC;function DF(){return mC||(mC=1,Uv.exports=PF()),Uv.exports}var y=DF(),Q=Y0();const MF=db(Q);var xm={},qv={exports:{}},fr={},Hv={exports:{}},Gv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gC;function LF(){return gC||(gC=1,(function(n){function e(fe,Ne){var ye=fe.length;fe.push(Ne);e:for(;0<ye;){var G=ye-1>>>1,ne=fe[G];if(0<i(ne,Ne))fe[G]=Ne,fe[ye]=ne,ye=G;else break e}}function t(fe){return fe.length===0?null:fe[0]}function r(fe){if(fe.length===0)return null;var Ne=fe[0],ye=fe.pop();if(ye!==Ne){fe[0]=ye;e:for(var G=0,ne=fe.length,Re=ne>>>1;G<Re;){var Me=2*(G+1)-1,Ue=fe[Me],He=Me+1,ue=fe[He];if(0>i(Ue,ye))He<ne&&0>i(ue,Ue)?(fe[G]=ue,fe[He]=ye,G=He):(fe[G]=Ue,fe[Me]=ye,G=Me);else if(He<ne&&0>i(ue,ye))fe[G]=ue,fe[He]=ye,G=He;else break e}}return Ne}function i(fe,Ne){var ye=fe.sortIndex-Ne.sortIndex;return ye!==0?ye:fe.id-Ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],d=[],p=1,v=null,w=3,x=!1,A=!1,R=!1,L=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(fe){for(var Ne=t(d);Ne!==null;){if(Ne.callback===null)r(d);else if(Ne.startTime<=fe)r(d),Ne.sortIndex=Ne.expirationTime,e(u,Ne);else break;Ne=t(d)}}function K(fe){if(R=!1,q(fe),!A)if(t(u)!==null)A=!0,et(te);else{var Ne=t(d);Ne!==null&&tt(K,Ne.startTime-fe)}}function te(fe,Ne){A=!1,R&&(R=!1,j(k),k=-1),x=!0;var ye=w;try{for(q(Ne),v=t(u);v!==null&&(!(v.expirationTime>Ne)||fe&&!D());){var G=v.callback;if(typeof G=="function"){v.callback=null,w=v.priorityLevel;var ne=G(v.expirationTime<=Ne);Ne=n.unstable_now(),typeof ne=="function"?v.callback=ne:v===t(u)&&r(u),q(Ne)}else r(u);v=t(u)}if(v!==null)var Re=!0;else{var Me=t(d);Me!==null&&tt(K,Me.startTime-Ne),Re=!1}return Re}finally{v=null,w=ye,x=!1}}var ee=!1,P=null,k=-1,b=5,F=-1;function D(){return!(n.unstable_now()-F<b)}function O(){if(P!==null){var fe=n.unstable_now();F=fe;var Ne=!0;try{Ne=P(!0,fe)}finally{Ne?M():(ee=!1,P=null)}}else ee=!1}var M;if(typeof B=="function")M=function(){B(O)};else if(typeof MessageChannel<"u"){var $e=new MessageChannel,dt=$e.port2;$e.port1.onmessage=O,M=function(){dt.postMessage(null)}}else M=function(){L(O,0)};function et(fe){P=fe,ee||(ee=!0,M())}function tt(fe,Ne){k=L(function(){fe(n.unstable_now())},Ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(fe){fe.callback=null},n.unstable_continueExecution=function(){A||x||(A=!0,et(te))},n.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<fe?Math.floor(1e3/fe):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(fe){switch(w){case 1:case 2:case 3:var Ne=3;break;default:Ne=w}var ye=w;w=Ne;try{return fe()}finally{w=ye}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(fe,Ne){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var ye=w;w=fe;try{return Ne()}finally{w=ye}},n.unstable_scheduleCallback=function(fe,Ne,ye){var G=n.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?G+ye:G):ye=G,fe){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=ye+ne,fe={id:p++,callback:Ne,priorityLevel:fe,startTime:ye,expirationTime:ne,sortIndex:-1},ye>G?(fe.sortIndex=ye,e(d,fe),t(u)===null&&fe===t(d)&&(R?(j(k),k=-1):R=!0,tt(K,ye-G))):(fe.sortIndex=ne,e(u,fe),A||x||(A=!0,et(te))),fe},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(fe){var Ne=w;return function(){var ye=w;w=Ne;try{return fe.apply(this,arguments)}finally{w=ye}}}})(Gv)),Gv}var yC;function VF(){return yC||(yC=1,Hv.exports=LF()),Hv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C;function FF(){if(_C)return fr;_C=1;var n=Y0(),e=VF();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(i[a]=c,a=0;a<c.length;a++)r.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function w(a){return u.call(v,a)?!0:u.call(p,a)?!1:d.test(a)?v[a]=!0:(p[a]=!0,!1)}function x(a,c,h,_){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return _?!1:h!==null?!h.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function A(a,c,h,_){if(c===null||typeof c>"u"||x(a,c,h,_))return!0;if(_)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function R(a,c,h,_,T,E,C){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=_,this.attributeNamespace=T,this.mustUseProperty=h,this.propertyName=a,this.type=c,this.sanitizeURL=E,this.removeEmptyString=C}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){L[a]=new R(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];L[c]=new R(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){L[a]=new R(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){L[a]=new R(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){L[a]=new R(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){L[a]=new R(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){L[a]=new R(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){L[a]=new R(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){L[a]=new R(a,5,!1,a.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function B(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(j,B);L[c]=new R(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(j,B);L[c]=new R(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(j,B);L[c]=new R(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){L[a]=new R(a,1,!1,a.toLowerCase(),null,!1,!1)}),L.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){L[a]=new R(a,1,!1,a.toLowerCase(),null,!0,!0)});function q(a,c,h,_){var T=L.hasOwnProperty(c)?L[c]:null;(T!==null?T.type!==0:_||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(A(c,h,T,_)&&(h=null),_||T===null?w(c)&&(h===null?a.removeAttribute(c):a.setAttribute(c,""+h)):T.mustUseProperty?a[T.propertyName]=h===null?T.type===3?!1:"":h:(c=T.attributeName,_=T.attributeNamespace,h===null?a.removeAttribute(c):(T=T.type,h=T===3||T===4&&h===!0?"":""+h,_?a.setAttributeNS(_,c,h):a.setAttribute(c,h))))}var K=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),ee=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$e=Symbol.for("react.suspense_list"),dt=Symbol.for("react.memo"),et=Symbol.for("react.lazy"),tt=Symbol.for("react.offscreen"),fe=Symbol.iterator;function Ne(a){return a===null||typeof a!="object"?null:(a=fe&&a[fe]||a["@@iterator"],typeof a=="function"?a:null)}var ye=Object.assign,G;function ne(a){if(G===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);G=c&&c[1]||""}return`
`+G+a}var Re=!1;function Me(a,c){if(!a||Re)return"";Re=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Y){var _=Y}Reflect.construct(a,[],c)}else{try{c.call()}catch(Y){_=Y}a.call(c.prototype)}else{try{throw Error()}catch(Y){_=Y}a()}}catch(Y){if(Y&&_&&typeof Y.stack=="string"){for(var T=Y.stack.split(`
`),E=_.stack.split(`
`),C=T.length-1,V=E.length-1;1<=C&&0<=V&&T[C]!==E[V];)V--;for(;1<=C&&0<=V;C--,V--)if(T[C]!==E[V]){if(C!==1||V!==1)do if(C--,V--,0>V||T[C]!==E[V]){var U=`
`+T[C].replace(" at new "," at ");return a.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",a.displayName)),U}while(1<=C&&0<=V);break}}}finally{Re=!1,Error.prepareStackTrace=h}return(a=a?a.displayName||a.name:"")?ne(a):""}function Ue(a){switch(a.tag){case 5:return ne(a.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return a=Me(a.type,!1),a;case 11:return a=Me(a.type.render,!1),a;case 1:return a=Me(a.type,!0),a;default:return""}}function He(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case ee:return"Portal";case b:return"Profiler";case k:return"StrictMode";case M:return"Suspense";case $e:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case D:return(a.displayName||"Context")+".Consumer";case F:return(a._context.displayName||"Context")+".Provider";case O:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case dt:return c=a.displayName||null,c!==null?c:He(a.type)||"Memo";case et:c=a._payload,a=a._init;try{return He(a(c))}catch{}}return null}function ue(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return He(c);case 8:return c===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function _e(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Be(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function it(a){var c=Be(a)?"checked":"value",h=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),_=""+a[c];if(!a.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var T=h.get,E=h.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return T.call(this)},set:function(C){_=""+C,E.call(this,C)}}),Object.defineProperty(a,c,{enumerable:h.enumerable}),{getValue:function(){return _},setValue:function(C){_=""+C},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function je(a){a._valueTracker||(a._valueTracker=it(a))}function ft(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var h=c.getValue(),_="";return a&&(_=Be(a)?a.checked?"true":"false":a.value),a=_,a!==h?(c.setValue(a),!0):!1}function dn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $r(a,c){var h=c.checked;return ye({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??a._wrapperState.initialChecked})}function ws(a,c){var h=c.defaultValue==null?"":c.defaultValue,_=c.checked!=null?c.checked:c.defaultChecked;h=_e(c.value!=null?c.value:h),a._wrapperState={initialChecked:_,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function kn(a,c){c=c.checked,c!=null&&q(a,"checked",c,!1)}function Ts(a,c){kn(a,c);var h=_e(c.value),_=c.type;if(h!=null)_==="number"?(h===0&&a.value===""||a.value!=h)&&(a.value=""+h):a.value!==""+h&&(a.value=""+h);else if(_==="submit"||_==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?Bt(a,c.type,h):c.hasOwnProperty("defaultValue")&&Bt(a,c.type,_e(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Es(a,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var _=c.type;if(!(_!=="submit"&&_!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,h||c===a.value||(a.value=c),a.defaultValue=c}h=a.name,h!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,h!==""&&(a.name=h)}function Bt(a,c,h){(c!=="number"||dn(a.ownerDocument)!==a)&&(h==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+h&&(a.defaultValue=""+h))}var qt=Array.isArray;function ar(a,c,h,_){if(a=a.options,c){c={};for(var T=0;T<h.length;T++)c["$"+h[T]]=!0;for(h=0;h<a.length;h++)T=c.hasOwnProperty("$"+a[h].value),a[h].selected!==T&&(a[h].selected=T),T&&_&&(a[h].defaultSelected=!0)}else{for(h=""+_e(h),c=null,T=0;T<a.length;T++){if(a[T].value===h){a[T].selected=!0,_&&(a[T].defaultSelected=!0);return}c!==null||a[T].disabled||(c=a[T])}c!==null&&(c.selected=!0)}}function yo(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ye({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function _o(a,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(t(92));if(qt(h)){if(1<h.length)throw Error(t(93));h=h[0]}c=h}c==null&&(c=""),h=c}a._wrapperState={initialValue:_e(h)}}function Oa(a,c){var h=_e(c.value),_=_e(c.defaultValue);h!=null&&(h=""+h,h!==a.value&&(a.value=h),c.defaultValue==null&&a.defaultValue!==h&&(a.defaultValue=h)),_!=null&&(a.defaultValue=""+_)}function ci(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function vo(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Is(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?vo(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var ui,Ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,_,T){MSApp.execUnsafeLocalFunction(function(){return a(c,h,_,T)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(ui=ui||document.createElement("div"),ui.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=ui.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function xs(a,c){if(c){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=c;return}}a.textContent=c}var jr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fc=["Webkit","ms","Moz","O"];Object.keys(jr).forEach(function(a){fc.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),jr[c]=jr[a]})});function bi(a,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||jr.hasOwnProperty(a)&&jr[a]?(""+c).trim():c+"px"}function wo(a,c){a=a.style;for(var h in c)if(c.hasOwnProperty(h)){var _=h.indexOf("--")===0,T=bi(h,c[h],_);h==="float"&&(h="cssFloat"),_?a.setProperty(h,T):a[h]=T}}var Ba=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ir(a,c){if(c){if(Ba[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Ss(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pi=null;function To(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var di=null,re=null,xe=null;function ot(a){if(a=Gd(a)){if(typeof di!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Op(c),di(a.stateNode,a.type,c))}}function yn(a){re?xe?xe.push(a):xe=[a]:re=a}function zr(){if(re){var a=re,c=xe;if(xe=re=null,ot(a),c)for(a=0;a<c.length;a++)ot(c[a])}}function xr(a,c){return a(c)}function Eo(){}var hi=!1;function Io(a,c,h){if(hi)return a(c,h);hi=!0;try{return xr(a,c,h)}finally{hi=!1,(re!==null||xe!==null)&&(Eo(),zr())}}function qa(a,c){var h=a.stateNode;if(h===null)return null;var _=Op(h);if(_===null)return null;h=_[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(a=a.type,_=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!_;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(t(231,c,typeof h));return h}var xo=!1;if(l)try{var So={};Object.defineProperty(So,"passive",{get:function(){xo=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{xo=!1}function mp(a,c,h,_,T,E,C,V,U){var Y=Array.prototype.slice.call(arguments,3);try{c.apply(h,Y)}catch(ae){this.onError(ae)}}var Cs=!1,Di=null,pc=!1,Wr=null,gp={onError:function(a){Cs=!0,Di=a}};function yp(a,c,h,_,T,E,C,V,U){Cs=!1,Di=null,mp.apply(gp,arguments)}function yd(a,c,h,_,T,E,C,V,U){if(yp.apply(this,arguments),Cs){if(Cs){var Y=Di;Cs=!1,Di=null}else throw Error(t(198));pc||(pc=!0,Wr=Y)}}function fi(a){var c=a,h=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(h=c.return),a=c.return;while(a)}return c.tag===3?h:null}function _d(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function _p(a){if(fi(a)!==a)throw Error(t(188))}function vp(a){var c=a.alternate;if(!c){if(c=fi(a),c===null)throw Error(t(188));return c!==a?null:a}for(var h=a,_=c;;){var T=h.return;if(T===null)break;var E=T.alternate;if(E===null){if(_=T.return,_!==null){h=_;continue}break}if(T.child===E.child){for(E=T.child;E;){if(E===h)return _p(T),a;if(E===_)return _p(T),c;E=E.sibling}throw Error(t(188))}if(h.return!==_.return)h=T,_=E;else{for(var C=!1,V=T.child;V;){if(V===h){C=!0,h=T,_=E;break}if(V===_){C=!0,_=T,h=E;break}V=V.sibling}if(!C){for(V=E.child;V;){if(V===h){C=!0,h=E,_=T;break}if(V===_){C=!0,_=E,h=T;break}V=V.sibling}if(!C)throw Error(t(189))}}if(h.alternate!==_)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?a:c}function wp(a){return a=vp(a),a!==null?Ha(a):null}function Ha(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=Ha(a);if(c!==null)return c;a=a.sibling}return null}var vd=e.unstable_scheduleCallback,mc=e.unstable_cancelCallback,Ga=e.unstable_shouldYield,As=e.unstable_requestPaint,Nt=e.unstable_now,g_=e.unstable_getCurrentPriorityLevel,gc=e.unstable_ImmediatePriority,wd=e.unstable_UserBlockingPriority,$a=e.unstable_NormalPriority,Td=e.unstable_LowPriority,yc=e.unstable_IdlePriority,ja=null,Sr=null;function Tp(a){if(Sr&&typeof Sr.onCommitFiberRoot=="function")try{Sr.onCommitFiberRoot(ja,a,void 0,(a.current.flags&128)===128)}catch{}}var Cr=Math.clz32?Math.clz32:za,Mi=Math.log,Kr=Math.LN2;function za(a){return a>>>=0,a===0?32:31-(Mi(a)/Kr|0)|0}var Li=64,Co=4194304;function ht(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Ns(a,c){var h=a.pendingLanes;if(h===0)return 0;var _=0,T=a.suspendedLanes,E=a.pingedLanes,C=h&268435455;if(C!==0){var V=C&~T;V!==0?_=ht(V):(E&=C,E!==0&&(_=ht(E)))}else C=h&~T,C!==0?_=ht(C):E!==0&&(_=ht(E));if(_===0)return 0;if(c!==0&&c!==_&&(c&T)===0&&(T=_&-_,E=c&-c,T>=E||T===16&&(E&4194240)!==0))return c;if((_&4)!==0&&(_|=h&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=_;0<c;)h=31-Cr(c),T=1<<h,_|=a[h],c&=~T;return _}function Wa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ka(a,c){for(var h=a.suspendedLanes,_=a.pingedLanes,T=a.expirationTimes,E=a.pendingLanes;0<E;){var C=31-Cr(E),V=1<<C,U=T[C];U===-1?((V&h)===0||(V&_)!==0)&&(T[C]=Wa(V,c)):U<=c&&(a.expiredLanes|=V),E&=~V}}function Ed(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Id(){var a=Li;return Li<<=1,(Li&4194240)===0&&(Li=64),a}function xd(a){for(var c=[],h=0;31>h;h++)c.push(a);return c}function Ja(a,c,h){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-Cr(c),a[c]=h}function y_(a,c){var h=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var _=a.eventTimes;for(a=a.expirationTimes;0<h;){var T=31-Cr(h),E=1<<T;c[T]=0,_[T]=-1,a[T]=-1,h&=~E}}function Sd(a,c){var h=a.entangledLanes|=c;for(a=a.entanglements;h;){var _=31-Cr(h),T=1<<_;T&c|a[_]&c&&(a[_]|=c),h&=~T}}var nt=0;function Vi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Cd,_c,Ad,Nd,kd,Fi=!1,vc=[],Oi=null,Ui=null,Rn=null,Qa=new Map,ks=new Map,Ar=[],Ep="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ao(a,c){switch(a){case"focusin":case"focusout":Oi=null;break;case"dragenter":case"dragleave":Ui=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":Qa.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ks.delete(c.pointerId)}}function pi(a,c,h,_,T,E){return a===null||a.nativeEvent!==E?(a={blockedOn:c,domEventName:h,eventSystemFlags:_,nativeEvent:E,targetContainers:[T]},c!==null&&(c=Gd(c),c!==null&&_c(c)),a):(a.eventSystemFlags|=_,c=a.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),a)}function Ip(a,c,h,_,T){switch(c){case"focusin":return Oi=pi(Oi,a,c,h,_,T),!0;case"dragenter":return Ui=pi(Ui,a,c,h,_,T),!0;case"mouseover":return Rn=pi(Rn,a,c,h,_,T),!0;case"pointerover":var E=T.pointerId;return Qa.set(E,pi(Qa.get(E)||null,a,c,h,_,T)),!0;case"gotpointercapture":return E=T.pointerId,ks.set(E,pi(ks.get(E)||null,a,c,h,_,T)),!0}return!1}function wc(a){var c=el(a.target);if(c!==null){var h=fi(c);if(h!==null){if(c=h.tag,c===13){if(c=_d(h),c!==null){a.blockedOn=c,kd(a.priority,function(){Ad(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Tt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var h=Tc(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(h===null){h=a.nativeEvent;var _=new h.constructor(h.type,h);Pi=_,h.target.dispatchEvent(_),Pi=null}else return c=Gd(h),c!==null&&_c(c),a.blockedOn=h,!1;c.shift()}return!0}function xp(a,c,h){Tt(a)&&h.delete(c)}function __(){Fi=!1,Oi!==null&&Tt(Oi)&&(Oi=null),Ui!==null&&Tt(Ui)&&(Ui=null),Rn!==null&&Tt(Rn)&&(Rn=null),Qa.forEach(xp),ks.forEach(xp)}function No(a,c){a.blockedOn===c&&(a.blockedOn=null,Fi||(Fi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,__)))}function ko(a){function c(T){return No(T,a)}if(0<vc.length){No(vc[0],a);for(var h=1;h<vc.length;h++){var _=vc[h];_.blockedOn===a&&(_.blockedOn=null)}}for(Oi!==null&&No(Oi,a),Ui!==null&&No(Ui,a),Rn!==null&&No(Rn,a),Qa.forEach(c),ks.forEach(c),h=0;h<Ar.length;h++)_=Ar[h],_.blockedOn===a&&(_.blockedOn=null);for(;0<Ar.length&&(h=Ar[0],h.blockedOn===null);)wc(h),h.blockedOn===null&&Ar.shift()}var Rs=K.ReactCurrentBatchConfig,bs=!0;function Bi(a,c,h,_){var T=nt,E=Rs.transition;Rs.transition=null;try{nt=1,Rd(a,c,h,_)}finally{nt=T,Rs.transition=E}}function Sp(a,c,h,_){var T=nt,E=Rs.transition;Rs.transition=null;try{nt=4,Rd(a,c,h,_)}finally{nt=T,Rs.transition=E}}function Rd(a,c,h,_){if(bs){var T=Tc(a,c,h,_);if(T===null)k_(a,c,_,qi,h),Ao(a,_);else if(Ip(T,a,c,h,_))_.stopPropagation();else if(Ao(a,_),c&4&&-1<Ep.indexOf(a)){for(;T!==null;){var E=Gd(T);if(E!==null&&Cd(E),E=Tc(a,c,h,_),E===null&&k_(a,c,_,qi,h),E===T)break;T=E}T!==null&&_.stopPropagation()}else k_(a,c,_,null,h)}}var qi=null;function Tc(a,c,h,_){if(qi=null,a=To(_),a=el(a),a!==null)if(c=fi(a),c===null)a=null;else if(h=c.tag,h===13){if(a=_d(c),a!==null)return a;a=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return qi=a,null}function Ec(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g_()){case gc:return 1;case wd:return 4;case $a:case Td:return 16;case yc:return 536870912;default:return 16}default:return 16}}var Nr=null,Ic=null,Ps=null;function Cp(){if(Ps)return Ps;var a,c=Ic,h=c.length,_,T="value"in Nr?Nr.value:Nr.textContent,E=T.length;for(a=0;a<h&&c[a]===T[a];a++);var C=h-a;for(_=1;_<=C&&c[h-_]===T[E-_];_++);return Ps=T.slice(a,1<_?1-_:void 0)}function Ya(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Hi(){return!0}function bd(){return!1}function Un(a){function c(h,_,T,E,C){this._reactName=h,this._targetInst=T,this.type=_,this.nativeEvent=E,this.target=C,this.currentTarget=null;for(var V in a)a.hasOwnProperty(V)&&(h=a[V],this[V]=h?h(E):E[V]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Hi:bd,this.isPropagationStopped=bd,this}return ye(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Hi)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Hi)},persist:function(){},isPersistent:Hi}),c}var Gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xa=Un(Gi),Ro=ye({},Gi,{view:0,detail:0}),xc=Un(Ro),Sc,Cc,kr,Za=ye({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qe,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==kr&&(kr&&a.type==="mousemove"?(Sc=a.screenX-kr.screenX,Cc=a.screenY-kr.screenY):Cc=Sc=0,kr=a),Sc)},movementY:function(a){return"movementY"in a?a.movementY:Cc}}),Pd=Un(Za),Ap=ye({},Za,{dataTransfer:0}),Np=Un(Ap),Ac=ye({},Ro,{relatedTarget:0}),bn=Un(Ac),kp=ye({},Gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Rp=Un(kp),bo=ye({},Gi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Un(bo),I=ye({},Gi,{data:0}),S=Un(I),N={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pe(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=Z[a])?!!c[a]:!1}function qe(){return pe}var Xt=ye({},Ro,{key:function(a){if(a.key){var c=N[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Ya(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?W[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qe,charCode:function(a){return a.type==="keypress"?Ya(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ya(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),gt=Un(Xt),sn=ye({},Za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rr=Un(sn),Ds=ye({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qe}),$i=Un(Ds),ji=ye({},Gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nc=Un(ji),Dd=ye({},Za,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),EV=Un(Dd),IV=[9,13,27,32],v_=l&&"CompositionEvent"in window,Md=null;l&&"documentMode"in document&&(Md=document.documentMode);var xV=l&&"TextEvent"in window&&!Md,nx=l&&(!v_||Md&&8<Md&&11>=Md),rx=" ",ix=!1;function sx(a,c){switch(a){case"keyup":return IV.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ox(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var kc=!1;function SV(a,c){switch(a){case"compositionend":return ox(c);case"keypress":return c.which!==32?null:(ix=!0,rx);case"textInput":return a=c.data,a===rx&&ix?null:a;default:return null}}function CV(a,c){if(kc)return a==="compositionend"||!v_&&sx(a,c)?(a=Cp(),Ps=Ic=Nr=null,kc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return nx&&c.locale!=="ko"?null:c.data;default:return null}}var AV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ax(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!AV[a.type]:c==="textarea"}function lx(a,c,h,_){yn(_),c=Lp(c,"onChange"),0<c.length&&(h=new Xa("onChange","change",null,h,_),a.push({event:h,listeners:c}))}var Ld=null,Vd=null;function NV(a){Cx(a,0)}function bp(a){var c=Mc(a);if(ft(c))return a}function kV(a,c){if(a==="change")return c}var cx=!1;if(l){var w_;if(l){var T_="oninput"in document;if(!T_){var ux=document.createElement("div");ux.setAttribute("oninput","return;"),T_=typeof ux.oninput=="function"}w_=T_}else w_=!1;cx=w_&&(!document.documentMode||9<document.documentMode)}function dx(){Ld&&(Ld.detachEvent("onpropertychange",hx),Vd=Ld=null)}function hx(a){if(a.propertyName==="value"&&bp(Vd)){var c=[];lx(c,Vd,a,To(a)),Io(NV,c)}}function RV(a,c,h){a==="focusin"?(dx(),Ld=c,Vd=h,Ld.attachEvent("onpropertychange",hx)):a==="focusout"&&dx()}function bV(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return bp(Vd)}function PV(a,c){if(a==="click")return bp(c)}function DV(a,c){if(a==="input"||a==="change")return bp(c)}function MV(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var mi=typeof Object.is=="function"?Object.is:MV;function Fd(a,c){if(mi(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var h=Object.keys(a),_=Object.keys(c);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var T=h[_];if(!u.call(c,T)||!mi(a[T],c[T]))return!1}return!0}function fx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function px(a,c){var h=fx(a);a=0;for(var _;h;){if(h.nodeType===3){if(_=a+h.textContent.length,a<=c&&_>=c)return{node:h,offset:c-a};a=_}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=fx(h)}}function mx(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?mx(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function gx(){for(var a=window,c=dn();c instanceof a.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)a=c.contentWindow;else break;c=dn(a.document)}return c}function E_(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function LV(a){var c=gx(),h=a.focusedElem,_=a.selectionRange;if(c!==h&&h&&h.ownerDocument&&mx(h.ownerDocument.documentElement,h)){if(_!==null&&E_(h)){if(c=_.start,a=_.end,a===void 0&&(a=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(a,h.value.length);else if(a=(c=h.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var T=h.textContent.length,E=Math.min(_.start,T);_=_.end===void 0?E:Math.min(_.end,T),!a.extend&&E>_&&(T=_,_=E,E=T),T=px(h,E);var C=px(h,_);T&&C&&(a.rangeCount!==1||a.anchorNode!==T.node||a.anchorOffset!==T.offset||a.focusNode!==C.node||a.focusOffset!==C.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),a.removeAllRanges(),E>_?(a.addRange(c),a.extend(C.node,C.offset)):(c.setEnd(C.node,C.offset),a.addRange(c)))}}for(c=[],a=h;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)a=c[h],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var VV=l&&"documentMode"in document&&11>=document.documentMode,Rc=null,I_=null,Od=null,x_=!1;function yx(a,c,h){var _=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;x_||Rc==null||Rc!==dn(_)||(_=Rc,"selectionStart"in _&&E_(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Od&&Fd(Od,_)||(Od=_,_=Lp(I_,"onSelect"),0<_.length&&(c=new Xa("onSelect","select",null,c,h),a.push({event:c,listeners:_}),c.target=Rc)))}function Pp(a,c){var h={};return h[a.toLowerCase()]=c.toLowerCase(),h["Webkit"+a]="webkit"+c,h["Moz"+a]="moz"+c,h}var bc={animationend:Pp("Animation","AnimationEnd"),animationiteration:Pp("Animation","AnimationIteration"),animationstart:Pp("Animation","AnimationStart"),transitionend:Pp("Transition","TransitionEnd")},S_={},_x={};l&&(_x=document.createElement("div").style,"AnimationEvent"in window||(delete bc.animationend.animation,delete bc.animationiteration.animation,delete bc.animationstart.animation),"TransitionEvent"in window||delete bc.transitionend.transition);function Dp(a){if(S_[a])return S_[a];if(!bc[a])return a;var c=bc[a],h;for(h in c)if(c.hasOwnProperty(h)&&h in _x)return S_[a]=c[h];return a}var vx=Dp("animationend"),wx=Dp("animationiteration"),Tx=Dp("animationstart"),Ex=Dp("transitionend"),Ix=new Map,xx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Po(a,c){Ix.set(a,c),s(c,[a])}for(var C_=0;C_<xx.length;C_++){var A_=xx[C_],FV=A_.toLowerCase(),OV=A_[0].toUpperCase()+A_.slice(1);Po(FV,"on"+OV)}Po(vx,"onAnimationEnd"),Po(wx,"onAnimationIteration"),Po(Tx,"onAnimationStart"),Po("dblclick","onDoubleClick"),Po("focusin","onFocus"),Po("focusout","onBlur"),Po(Ex,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ud));function Sx(a,c,h){var _=a.type||"unknown-event";a.currentTarget=h,yd(_,c,void 0,a),a.currentTarget=null}function Cx(a,c){c=(c&4)!==0;for(var h=0;h<a.length;h++){var _=a[h],T=_.event;_=_.listeners;e:{var E=void 0;if(c)for(var C=_.length-1;0<=C;C--){var V=_[C],U=V.instance,Y=V.currentTarget;if(V=V.listener,U!==E&&T.isPropagationStopped())break e;Sx(T,V,Y),E=U}else for(C=0;C<_.length;C++){if(V=_[C],U=V.instance,Y=V.currentTarget,V=V.listener,U!==E&&T.isPropagationStopped())break e;Sx(T,V,Y),E=U}}}if(pc)throw a=Wr,pc=!1,Wr=null,a}function kt(a,c){var h=c[L_];h===void 0&&(h=c[L_]=new Set);var _=a+"__bubble";h.has(_)||(Ax(c,a,2,!1),h.add(_))}function N_(a,c,h){var _=0;c&&(_|=4),Ax(h,a,_,c)}var Mp="_reactListening"+Math.random().toString(36).slice(2);function Bd(a){if(!a[Mp]){a[Mp]=!0,r.forEach(function(h){h!=="selectionchange"&&(UV.has(h)||N_(h,!1,a),N_(h,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Mp]||(c[Mp]=!0,N_("selectionchange",!1,c))}}function Ax(a,c,h,_){switch(Ec(c)){case 1:var T=Bi;break;case 4:T=Sp;break;default:T=Rd}h=T.bind(null,c,h,a),T=void 0,!xo||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),_?T!==void 0?a.addEventListener(c,h,{capture:!0,passive:T}):a.addEventListener(c,h,!0):T!==void 0?a.addEventListener(c,h,{passive:T}):a.addEventListener(c,h,!1)}function k_(a,c,h,_,T){var E=_;if((c&1)===0&&(c&2)===0&&_!==null)e:for(;;){if(_===null)return;var C=_.tag;if(C===3||C===4){var V=_.stateNode.containerInfo;if(V===T||V.nodeType===8&&V.parentNode===T)break;if(C===4)for(C=_.return;C!==null;){var U=C.tag;if((U===3||U===4)&&(U=C.stateNode.containerInfo,U===T||U.nodeType===8&&U.parentNode===T))return;C=C.return}for(;V!==null;){if(C=el(V),C===null)return;if(U=C.tag,U===5||U===6){_=E=C;continue e}V=V.parentNode}}_=_.return}Io(function(){var Y=E,ae=To(h),ce=[];e:{var se=Ix.get(a);if(se!==void 0){var Te=Xa,Se=a;switch(a){case"keypress":if(Ya(h)===0)break e;case"keydown":case"keyup":Te=gt;break;case"focusin":Se="focus",Te=bn;break;case"focusout":Se="blur",Te=bn;break;case"beforeblur":case"afterblur":Te=bn;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Pd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=Np;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=$i;break;case vx:case wx:case Tx:Te=Rp;break;case Ex:Te=Nc;break;case"scroll":Te=xc;break;case"wheel":Te=EV;break;case"copy":case"cut":case"paste":Te=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Rr}var Ae=(c&4)!==0,Zt=!Ae&&a==="scroll",z=Ae?se!==null?se+"Capture":null:se;Ae=[];for(var H=Y,J;H!==null;){J=H;var he=J.stateNode;if(J.tag===5&&he!==null&&(J=he,z!==null&&(he=qa(H,z),he!=null&&Ae.push(qd(H,he,J)))),Zt)break;H=H.return}0<Ae.length&&(se=new Te(se,Se,null,h,ae),ce.push({event:se,listeners:Ae}))}}if((c&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",Te=a==="mouseout"||a==="pointerout",se&&h!==Pi&&(Se=h.relatedTarget||h.fromElement)&&(el(Se)||Se[Ms]))break e;if((Te||se)&&(se=ae.window===ae?ae:(se=ae.ownerDocument)?se.defaultView||se.parentWindow:window,Te?(Se=h.relatedTarget||h.toElement,Te=Y,Se=Se?el(Se):null,Se!==null&&(Zt=fi(Se),Se!==Zt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(Te=null,Se=Y),Te!==Se)){if(Ae=Pd,he="onMouseLeave",z="onMouseEnter",H="mouse",(a==="pointerout"||a==="pointerover")&&(Ae=Rr,he="onPointerLeave",z="onPointerEnter",H="pointer"),Zt=Te==null?se:Mc(Te),J=Se==null?se:Mc(Se),se=new Ae(he,H+"leave",Te,h,ae),se.target=Zt,se.relatedTarget=J,he=null,el(ae)===Y&&(Ae=new Ae(z,H+"enter",Se,h,ae),Ae.target=J,Ae.relatedTarget=Zt,he=Ae),Zt=he,Te&&Se)t:{for(Ae=Te,z=Se,H=0,J=Ae;J;J=Pc(J))H++;for(J=0,he=z;he;he=Pc(he))J++;for(;0<H-J;)Ae=Pc(Ae),H--;for(;0<J-H;)z=Pc(z),J--;for(;H--;){if(Ae===z||z!==null&&Ae===z.alternate)break t;Ae=Pc(Ae),z=Pc(z)}Ae=null}else Ae=null;Te!==null&&Nx(ce,se,Te,Ae,!1),Se!==null&&Zt!==null&&Nx(ce,Zt,Se,Ae,!0)}}e:{if(se=Y?Mc(Y):window,Te=se.nodeName&&se.nodeName.toLowerCase(),Te==="select"||Te==="input"&&se.type==="file")var ke=kV;else if(ax(se))if(cx)ke=DV;else{ke=bV;var Pe=RV}else(Te=se.nodeName)&&Te.toLowerCase()==="input"&&(se.type==="checkbox"||se.type==="radio")&&(ke=PV);if(ke&&(ke=ke(a,Y))){lx(ce,ke,h,ae);break e}Pe&&Pe(a,se,Y),a==="focusout"&&(Pe=se._wrapperState)&&Pe.controlled&&se.type==="number"&&Bt(se,"number",se.value)}switch(Pe=Y?Mc(Y):window,a){case"focusin":(ax(Pe)||Pe.contentEditable==="true")&&(Rc=Pe,I_=Y,Od=null);break;case"focusout":Od=I_=Rc=null;break;case"mousedown":x_=!0;break;case"contextmenu":case"mouseup":case"dragend":x_=!1,yx(ce,h,ae);break;case"selectionchange":if(VV)break;case"keydown":case"keyup":yx(ce,h,ae)}var De;if(v_)e:{switch(a){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else kc?sx(a,h)&&(Fe="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(Fe="onCompositionStart");Fe&&(nx&&h.locale!=="ko"&&(kc||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&kc&&(De=Cp()):(Nr=ae,Ic="value"in Nr?Nr.value:Nr.textContent,kc=!0)),Pe=Lp(Y,Fe),0<Pe.length&&(Fe=new S(Fe,a,null,h,ae),ce.push({event:Fe,listeners:Pe}),De?Fe.data=De:(De=ox(h),De!==null&&(Fe.data=De)))),(De=xV?SV(a,h):CV(a,h))&&(Y=Lp(Y,"onBeforeInput"),0<Y.length&&(ae=new S("onBeforeInput","beforeinput",null,h,ae),ce.push({event:ae,listeners:Y}),ae.data=De))}Cx(ce,c)})}function qd(a,c,h){return{instance:a,listener:c,currentTarget:h}}function Lp(a,c){for(var h=c+"Capture",_=[];a!==null;){var T=a,E=T.stateNode;T.tag===5&&E!==null&&(T=E,E=qa(a,h),E!=null&&_.unshift(qd(a,E,T)),E=qa(a,c),E!=null&&_.push(qd(a,E,T))),a=a.return}return _}function Pc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Nx(a,c,h,_,T){for(var E=c._reactName,C=[];h!==null&&h!==_;){var V=h,U=V.alternate,Y=V.stateNode;if(U!==null&&U===_)break;V.tag===5&&Y!==null&&(V=Y,T?(U=qa(h,E),U!=null&&C.unshift(qd(h,U,V))):T||(U=qa(h,E),U!=null&&C.push(qd(h,U,V)))),h=h.return}C.length!==0&&a.push({event:c,listeners:C})}var BV=/\r\n?/g,qV=/\u0000|\uFFFD/g;function kx(a){return(typeof a=="string"?a:""+a).replace(BV,`
`).replace(qV,"")}function Vp(a,c,h){if(c=kx(c),kx(a)!==c&&h)throw Error(t(425))}function Fp(){}var R_=null,b_=null;function P_(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var D_=typeof setTimeout=="function"?setTimeout:void 0,HV=typeof clearTimeout=="function"?clearTimeout:void 0,Rx=typeof Promise=="function"?Promise:void 0,GV=typeof queueMicrotask=="function"?queueMicrotask:typeof Rx<"u"?function(a){return Rx.resolve(null).then(a).catch($V)}:D_;function $V(a){setTimeout(function(){throw a})}function M_(a,c){var h=c,_=0;do{var T=h.nextSibling;if(a.removeChild(h),T&&T.nodeType===8)if(h=T.data,h==="/$"){if(_===0){a.removeChild(T),ko(c);return}_--}else h!=="$"&&h!=="$?"&&h!=="$!"||_++;h=T}while(h);ko(c)}function Do(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function bx(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return a;c--}else h==="/$"&&c++}a=a.previousSibling}return null}var Dc=Math.random().toString(36).slice(2),zi="__reactFiber$"+Dc,Hd="__reactProps$"+Dc,Ms="__reactContainer$"+Dc,L_="__reactEvents$"+Dc,jV="__reactListeners$"+Dc,zV="__reactHandles$"+Dc;function el(a){var c=a[zi];if(c)return c;for(var h=a.parentNode;h;){if(c=h[Ms]||h[zi]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(a=bx(a);a!==null;){if(h=a[zi])return h;a=bx(a)}return c}a=h,h=a.parentNode}return null}function Gd(a){return a=a[zi]||a[Ms],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Mc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Op(a){return a[Hd]||null}var V_=[],Lc=-1;function Mo(a){return{current:a}}function Rt(a){0>Lc||(a.current=V_[Lc],V_[Lc]=null,Lc--)}function It(a,c){Lc++,V_[Lc]=a.current,a.current=c}var Lo={},Bn=Mo(Lo),lr=Mo(!1),tl=Lo;function Vc(a,c){var h=a.type.contextTypes;if(!h)return Lo;var _=a.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var T={},E;for(E in h)T[E]=c[E];return _&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=T),T}function cr(a){return a=a.childContextTypes,a!=null}function Up(){Rt(lr),Rt(Bn)}function Px(a,c,h){if(Bn.current!==Lo)throw Error(t(168));It(Bn,c),It(lr,h)}function Dx(a,c,h){var _=a.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return h;_=_.getChildContext();for(var T in _)if(!(T in c))throw Error(t(108,ue(a)||"Unknown",T));return ye({},h,_)}function Bp(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Lo,tl=Bn.current,It(Bn,a),It(lr,lr.current),!0}function Mx(a,c,h){var _=a.stateNode;if(!_)throw Error(t(169));h?(a=Dx(a,c,tl),_.__reactInternalMemoizedMergedChildContext=a,Rt(lr),Rt(Bn),It(Bn,a)):Rt(lr),It(lr,h)}var Ls=null,qp=!1,F_=!1;function Lx(a){Ls===null?Ls=[a]:Ls.push(a)}function WV(a){qp=!0,Lx(a)}function Vo(){if(!F_&&Ls!==null){F_=!0;var a=0,c=nt;try{var h=Ls;for(nt=1;a<h.length;a++){var _=h[a];do _=_(!0);while(_!==null)}Ls=null,qp=!1}catch(T){throw Ls!==null&&(Ls=Ls.slice(a+1)),vd(gc,Vo),T}finally{nt=c,F_=!1}}return null}var Fc=[],Oc=0,Hp=null,Gp=0,Jr=[],Qr=0,nl=null,Vs=1,Fs="";function rl(a,c){Fc[Oc++]=Gp,Fc[Oc++]=Hp,Hp=a,Gp=c}function Vx(a,c,h){Jr[Qr++]=Vs,Jr[Qr++]=Fs,Jr[Qr++]=nl,nl=a;var _=Vs;a=Fs;var T=32-Cr(_)-1;_&=~(1<<T),h+=1;var E=32-Cr(c)+T;if(30<E){var C=T-T%5;E=(_&(1<<C)-1).toString(32),_>>=C,T-=C,Vs=1<<32-Cr(c)+T|h<<T|_,Fs=E+a}else Vs=1<<E|h<<T|_,Fs=a}function O_(a){a.return!==null&&(rl(a,1),Vx(a,1,0))}function U_(a){for(;a===Hp;)Hp=Fc[--Oc],Fc[Oc]=null,Gp=Fc[--Oc],Fc[Oc]=null;for(;a===nl;)nl=Jr[--Qr],Jr[Qr]=null,Fs=Jr[--Qr],Jr[Qr]=null,Vs=Jr[--Qr],Jr[Qr]=null}var br=null,Pr=null,Lt=!1,gi=null;function Fx(a,c){var h=ei(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=a,c=a.deletions,c===null?(a.deletions=[h],a.flags|=16):c.push(h)}function Ox(a,c){switch(a.tag){case 5:var h=a.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,br=a,Pr=Do(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,br=a,Pr=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=nl!==null?{id:Vs,overflow:Fs}:null,a.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=ei(18,null,null,0),h.stateNode=c,h.return=a,a.child=h,br=a,Pr=null,!0):!1;default:return!1}}function B_(a){return(a.mode&1)!==0&&(a.flags&128)===0}function q_(a){if(Lt){var c=Pr;if(c){var h=c;if(!Ox(a,c)){if(B_(a))throw Error(t(418));c=Do(h.nextSibling);var _=br;c&&Ox(a,c)?Fx(_,h):(a.flags=a.flags&-4097|2,Lt=!1,br=a)}}else{if(B_(a))throw Error(t(418));a.flags=a.flags&-4097|2,Lt=!1,br=a}}}function Ux(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;br=a}function $p(a){if(a!==br)return!1;if(!Lt)return Ux(a),Lt=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!P_(a.type,a.memoizedProps)),c&&(c=Pr)){if(B_(a))throw Bx(),Error(t(418));for(;c;)Fx(a,c),c=Do(c.nextSibling)}if(Ux(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"){if(c===0){Pr=Do(a.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}a=a.nextSibling}Pr=null}}else Pr=br?Do(a.stateNode.nextSibling):null;return!0}function Bx(){for(var a=Pr;a;)a=Do(a.nextSibling)}function Uc(){Pr=br=null,Lt=!1}function H_(a){gi===null?gi=[a]:gi.push(a)}var KV=K.ReactCurrentBatchConfig;function $d(a,c,h){if(a=h.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var _=h.stateNode}if(!_)throw Error(t(147,a));var T=_,E=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===E?c.ref:(c=function(C){var V=T.refs;C===null?delete V[E]:V[E]=C},c._stringRef=E,c)}if(typeof a!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,a))}return a}function jp(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function qx(a){var c=a._init;return c(a._payload)}function Hx(a){function c(z,H){if(a){var J=z.deletions;J===null?(z.deletions=[H],z.flags|=16):J.push(H)}}function h(z,H){if(!a)return null;for(;H!==null;)c(z,H),H=H.sibling;return null}function _(z,H){for(z=new Map;H!==null;)H.key!==null?z.set(H.key,H):z.set(H.index,H),H=H.sibling;return z}function T(z,H){return z=$o(z,H),z.index=0,z.sibling=null,z}function E(z,H,J){return z.index=J,a?(J=z.alternate,J!==null?(J=J.index,J<H?(z.flags|=2,H):J):(z.flags|=2,H)):(z.flags|=1048576,H)}function C(z){return a&&z.alternate===null&&(z.flags|=2),z}function V(z,H,J,he){return H===null||H.tag!==6?(H=Dv(J,z.mode,he),H.return=z,H):(H=T(H,J),H.return=z,H)}function U(z,H,J,he){var ke=J.type;return ke===P?ae(z,H,J.props.children,he,J.key):H!==null&&(H.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===et&&qx(ke)===H.type)?(he=T(H,J.props),he.ref=$d(z,H,J),he.return=z,he):(he=mm(J.type,J.key,J.props,null,z.mode,he),he.ref=$d(z,H,J),he.return=z,he)}function Y(z,H,J,he){return H===null||H.tag!==4||H.stateNode.containerInfo!==J.containerInfo||H.stateNode.implementation!==J.implementation?(H=Mv(J,z.mode,he),H.return=z,H):(H=T(H,J.children||[]),H.return=z,H)}function ae(z,H,J,he,ke){return H===null||H.tag!==7?(H=dl(J,z.mode,he,ke),H.return=z,H):(H=T(H,J),H.return=z,H)}function ce(z,H,J){if(typeof H=="string"&&H!==""||typeof H=="number")return H=Dv(""+H,z.mode,J),H.return=z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case te:return J=mm(H.type,H.key,H.props,null,z.mode,J),J.ref=$d(z,null,H),J.return=z,J;case ee:return H=Mv(H,z.mode,J),H.return=z,H;case et:var he=H._init;return ce(z,he(H._payload),J)}if(qt(H)||Ne(H))return H=dl(H,z.mode,J,null),H.return=z,H;jp(z,H)}return null}function se(z,H,J,he){var ke=H!==null?H.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return ke!==null?null:V(z,H,""+J,he);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case te:return J.key===ke?U(z,H,J,he):null;case ee:return J.key===ke?Y(z,H,J,he):null;case et:return ke=J._init,se(z,H,ke(J._payload),he)}if(qt(J)||Ne(J))return ke!==null?null:ae(z,H,J,he,null);jp(z,J)}return null}function Te(z,H,J,he,ke){if(typeof he=="string"&&he!==""||typeof he=="number")return z=z.get(J)||null,V(H,z,""+he,ke);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case te:return z=z.get(he.key===null?J:he.key)||null,U(H,z,he,ke);case ee:return z=z.get(he.key===null?J:he.key)||null,Y(H,z,he,ke);case et:var Pe=he._init;return Te(z,H,J,Pe(he._payload),ke)}if(qt(he)||Ne(he))return z=z.get(J)||null,ae(H,z,he,ke,null);jp(H,he)}return null}function Se(z,H,J,he){for(var ke=null,Pe=null,De=H,Fe=H=0,wn=null;De!==null&&Fe<J.length;Fe++){De.index>Fe?(wn=De,De=null):wn=De.sibling;var at=se(z,De,J[Fe],he);if(at===null){De===null&&(De=wn);break}a&&De&&at.alternate===null&&c(z,De),H=E(at,H,Fe),Pe===null?ke=at:Pe.sibling=at,Pe=at,De=wn}if(Fe===J.length)return h(z,De),Lt&&rl(z,Fe),ke;if(De===null){for(;Fe<J.length;Fe++)De=ce(z,J[Fe],he),De!==null&&(H=E(De,H,Fe),Pe===null?ke=De:Pe.sibling=De,Pe=De);return Lt&&rl(z,Fe),ke}for(De=_(z,De);Fe<J.length;Fe++)wn=Te(De,z,Fe,J[Fe],he),wn!==null&&(a&&wn.alternate!==null&&De.delete(wn.key===null?Fe:wn.key),H=E(wn,H,Fe),Pe===null?ke=wn:Pe.sibling=wn,Pe=wn);return a&&De.forEach(function(jo){return c(z,jo)}),Lt&&rl(z,Fe),ke}function Ae(z,H,J,he){var ke=Ne(J);if(typeof ke!="function")throw Error(t(150));if(J=ke.call(J),J==null)throw Error(t(151));for(var Pe=ke=null,De=H,Fe=H=0,wn=null,at=J.next();De!==null&&!at.done;Fe++,at=J.next()){De.index>Fe?(wn=De,De=null):wn=De.sibling;var jo=se(z,De,at.value,he);if(jo===null){De===null&&(De=wn);break}a&&De&&jo.alternate===null&&c(z,De),H=E(jo,H,Fe),Pe===null?ke=jo:Pe.sibling=jo,Pe=jo,De=wn}if(at.done)return h(z,De),Lt&&rl(z,Fe),ke;if(De===null){for(;!at.done;Fe++,at=J.next())at=ce(z,at.value,he),at!==null&&(H=E(at,H,Fe),Pe===null?ke=at:Pe.sibling=at,Pe=at);return Lt&&rl(z,Fe),ke}for(De=_(z,De);!at.done;Fe++,at=J.next())at=Te(De,z,Fe,at.value,he),at!==null&&(a&&at.alternate!==null&&De.delete(at.key===null?Fe:at.key),H=E(at,H,Fe),Pe===null?ke=at:Pe.sibling=at,Pe=at);return a&&De.forEach(function(AF){return c(z,AF)}),Lt&&rl(z,Fe),ke}function Zt(z,H,J,he){if(typeof J=="object"&&J!==null&&J.type===P&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case te:e:{for(var ke=J.key,Pe=H;Pe!==null;){if(Pe.key===ke){if(ke=J.type,ke===P){if(Pe.tag===7){h(z,Pe.sibling),H=T(Pe,J.props.children),H.return=z,z=H;break e}}else if(Pe.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===et&&qx(ke)===Pe.type){h(z,Pe.sibling),H=T(Pe,J.props),H.ref=$d(z,Pe,J),H.return=z,z=H;break e}h(z,Pe);break}else c(z,Pe);Pe=Pe.sibling}J.type===P?(H=dl(J.props.children,z.mode,he,J.key),H.return=z,z=H):(he=mm(J.type,J.key,J.props,null,z.mode,he),he.ref=$d(z,H,J),he.return=z,z=he)}return C(z);case ee:e:{for(Pe=J.key;H!==null;){if(H.key===Pe)if(H.tag===4&&H.stateNode.containerInfo===J.containerInfo&&H.stateNode.implementation===J.implementation){h(z,H.sibling),H=T(H,J.children||[]),H.return=z,z=H;break e}else{h(z,H);break}else c(z,H);H=H.sibling}H=Mv(J,z.mode,he),H.return=z,z=H}return C(z);case et:return Pe=J._init,Zt(z,H,Pe(J._payload),he)}if(qt(J))return Se(z,H,J,he);if(Ne(J))return Ae(z,H,J,he);jp(z,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,H!==null&&H.tag===6?(h(z,H.sibling),H=T(H,J),H.return=z,z=H):(h(z,H),H=Dv(J,z.mode,he),H.return=z,z=H),C(z)):h(z,H)}return Zt}var Bc=Hx(!0),Gx=Hx(!1),zp=Mo(null),Wp=null,qc=null,G_=null;function $_(){G_=qc=Wp=null}function j_(a){var c=zp.current;Rt(zp),a._currentValue=c}function z_(a,c,h){for(;a!==null;){var _=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),a===h)break;a=a.return}}function Hc(a,c){Wp=a,G_=qc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(ur=!0),a.firstContext=null)}function Yr(a){var c=a._currentValue;if(G_!==a)if(a={context:a,memoizedValue:c,next:null},qc===null){if(Wp===null)throw Error(t(308));qc=a,Wp.dependencies={lanes:0,firstContext:a}}else qc=qc.next=a;return c}var il=null;function W_(a){il===null?il=[a]:il.push(a)}function $x(a,c,h,_){var T=c.interleaved;return T===null?(h.next=h,W_(c)):(h.next=T.next,T.next=h),c.interleaved=h,Os(a,_)}function Os(a,c){a.lanes|=c;var h=a.alternate;for(h!==null&&(h.lanes|=c),h=a,a=a.return;a!==null;)a.childLanes|=c,h=a.alternate,h!==null&&(h.childLanes|=c),h=a,a=a.return;return h.tag===3?h.stateNode:null}var Fo=!1;function K_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jx(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Us(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function Oo(a,c,h){var _=a.updateQueue;if(_===null)return null;if(_=_.shared,(st&2)!==0){var T=_.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),_.pending=c,Os(a,h)}return T=_.interleaved,T===null?(c.next=c,W_(_)):(c.next=T.next,T.next=c),_.interleaved=c,Os(a,h)}function Kp(a,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var _=c.lanes;_&=a.pendingLanes,h|=_,c.lanes=h,Sd(a,h)}}function zx(a,c){var h=a.updateQueue,_=a.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var T=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var C={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};E===null?T=E=C:E=E.next=C,h=h.next}while(h!==null);E===null?T=E=c:E=E.next=c}else T=E=c;h={baseState:_.baseState,firstBaseUpdate:T,lastBaseUpdate:E,shared:_.shared,effects:_.effects},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=c}function Jp(a,c,h,_){var T=a.updateQueue;Fo=!1;var E=T.firstBaseUpdate,C=T.lastBaseUpdate,V=T.shared.pending;if(V!==null){T.shared.pending=null;var U=V,Y=U.next;U.next=null,C===null?E=Y:C.next=Y,C=U;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,V=ae.lastBaseUpdate,V!==C&&(V===null?ae.firstBaseUpdate=Y:V.next=Y,ae.lastBaseUpdate=U))}if(E!==null){var ce=T.baseState;C=0,ae=Y=U=null,V=E;do{var se=V.lane,Te=V.eventTime;if((_&se)===se){ae!==null&&(ae=ae.next={eventTime:Te,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var Se=a,Ae=V;switch(se=c,Te=h,Ae.tag){case 1:if(Se=Ae.payload,typeof Se=="function"){ce=Se.call(Te,ce,se);break e}ce=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ae.payload,se=typeof Se=="function"?Se.call(Te,ce,se):Se,se==null)break e;ce=ye({},ce,se);break e;case 2:Fo=!0}}V.callback!==null&&V.lane!==0&&(a.flags|=64,se=T.effects,se===null?T.effects=[V]:se.push(V))}else Te={eventTime:Te,lane:se,tag:V.tag,payload:V.payload,callback:V.callback,next:null},ae===null?(Y=ae=Te,U=ce):ae=ae.next=Te,C|=se;if(V=V.next,V===null){if(V=T.shared.pending,V===null)break;se=V,V=se.next,se.next=null,T.lastBaseUpdate=se,T.shared.pending=null}}while(!0);if(ae===null&&(U=ce),T.baseState=U,T.firstBaseUpdate=Y,T.lastBaseUpdate=ae,c=T.shared.interleaved,c!==null){T=c;do C|=T.lane,T=T.next;while(T!==c)}else E===null&&(T.shared.lanes=0);al|=C,a.lanes=C,a.memoizedState=ce}}function Wx(a,c,h){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var _=a[c],T=_.callback;if(T!==null){if(_.callback=null,_=h,typeof T!="function")throw Error(t(191,T));T.call(_)}}}var jd={},Wi=Mo(jd),zd=Mo(jd),Wd=Mo(jd);function sl(a){if(a===jd)throw Error(t(174));return a}function J_(a,c){switch(It(Wd,c),It(zd,a),It(Wi,jd),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Is(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Is(c,a)}Rt(Wi),It(Wi,c)}function Gc(){Rt(Wi),Rt(zd),Rt(Wd)}function Kx(a){sl(Wd.current);var c=sl(Wi.current),h=Is(c,a.type);c!==h&&(It(zd,a),It(Wi,h))}function Q_(a){zd.current===a&&(Rt(Wi),Rt(zd))}var Ht=Mo(0);function Qp(a){for(var c=a;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Y_=[];function X_(){for(var a=0;a<Y_.length;a++)Y_[a]._workInProgressVersionPrimary=null;Y_.length=0}var Yp=K.ReactCurrentDispatcher,Z_=K.ReactCurrentBatchConfig,ol=0,Gt=null,hn=null,_n=null,Xp=!1,Kd=!1,Jd=0,JV=0;function qn(){throw Error(t(321))}function ev(a,c){if(c===null)return!1;for(var h=0;h<c.length&&h<a.length;h++)if(!mi(a[h],c[h]))return!1;return!0}function tv(a,c,h,_,T,E){if(ol=E,Gt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Yp.current=a===null||a.memoizedState===null?ZV:eF,a=h(_,T),Kd){E=0;do{if(Kd=!1,Jd=0,25<=E)throw Error(t(301));E+=1,_n=hn=null,c.updateQueue=null,Yp.current=tF,a=h(_,T)}while(Kd)}if(Yp.current=tm,c=hn!==null&&hn.next!==null,ol=0,_n=hn=Gt=null,Xp=!1,c)throw Error(t(300));return a}function nv(){var a=Jd!==0;return Jd=0,a}function Ki(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?Gt.memoizedState=_n=a:_n=_n.next=a,_n}function Xr(){if(hn===null){var a=Gt.alternate;a=a!==null?a.memoizedState:null}else a=hn.next;var c=_n===null?Gt.memoizedState:_n.next;if(c!==null)_n=c,hn=a;else{if(a===null)throw Error(t(310));hn=a,a={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},_n===null?Gt.memoizedState=_n=a:_n=_n.next=a}return _n}function Qd(a,c){return typeof c=="function"?c(a):c}function rv(a){var c=Xr(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=a;var _=hn,T=_.baseQueue,E=h.pending;if(E!==null){if(T!==null){var C=T.next;T.next=E.next,E.next=C}_.baseQueue=T=E,h.pending=null}if(T!==null){E=T.next,_=_.baseState;var V=C=null,U=null,Y=E;do{var ae=Y.lane;if((ol&ae)===ae)U!==null&&(U=U.next={lane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),_=Y.hasEagerState?Y.eagerState:a(_,Y.action);else{var ce={lane:ae,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null};U===null?(V=U=ce,C=_):U=U.next=ce,Gt.lanes|=ae,al|=ae}Y=Y.next}while(Y!==null&&Y!==E);U===null?C=_:U.next=V,mi(_,c.memoizedState)||(ur=!0),c.memoizedState=_,c.baseState=C,c.baseQueue=U,h.lastRenderedState=_}if(a=h.interleaved,a!==null){T=a;do E=T.lane,Gt.lanes|=E,al|=E,T=T.next;while(T!==a)}else T===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function iv(a){var c=Xr(),h=c.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=a;var _=h.dispatch,T=h.pending,E=c.memoizedState;if(T!==null){h.pending=null;var C=T=T.next;do E=a(E,C.action),C=C.next;while(C!==T);mi(E,c.memoizedState)||(ur=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),h.lastRenderedState=E}return[E,_]}function Jx(){}function Qx(a,c){var h=Gt,_=Xr(),T=c(),E=!mi(_.memoizedState,T);if(E&&(_.memoizedState=T,ur=!0),_=_.queue,sv(Zx.bind(null,h,_,a),[a]),_.getSnapshot!==c||E||_n!==null&&_n.memoizedState.tag&1){if(h.flags|=2048,Yd(9,Xx.bind(null,h,_,T,c),void 0,null),vn===null)throw Error(t(349));(ol&30)!==0||Yx(h,c,T)}return T}function Yx(a,c,h){a.flags|=16384,a={getSnapshot:c,value:h},c=Gt.updateQueue,c===null?(c={lastEffect:null,stores:null},Gt.updateQueue=c,c.stores=[a]):(h=c.stores,h===null?c.stores=[a]:h.push(a))}function Xx(a,c,h,_){c.value=h,c.getSnapshot=_,eS(c)&&tS(a)}function Zx(a,c,h){return h(function(){eS(c)&&tS(a)})}function eS(a){var c=a.getSnapshot;a=a.value;try{var h=c();return!mi(a,h)}catch{return!0}}function tS(a){var c=Os(a,1);c!==null&&wi(c,a,1,-1)}function nS(a){var c=Ki();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qd,lastRenderedState:a},c.queue=a,a=a.dispatch=XV.bind(null,Gt,a),[c.memoizedState,a]}function Yd(a,c,h,_){return a={tag:a,create:c,destroy:h,deps:_,next:null},c=Gt.updateQueue,c===null?(c={lastEffect:null,stores:null},Gt.updateQueue=c,c.lastEffect=a.next=a):(h=c.lastEffect,h===null?c.lastEffect=a.next=a:(_=h.next,h.next=a,a.next=_,c.lastEffect=a)),a}function rS(){return Xr().memoizedState}function Zp(a,c,h,_){var T=Ki();Gt.flags|=a,T.memoizedState=Yd(1|c,h,void 0,_===void 0?null:_)}function em(a,c,h,_){var T=Xr();_=_===void 0?null:_;var E=void 0;if(hn!==null){var C=hn.memoizedState;if(E=C.destroy,_!==null&&ev(_,C.deps)){T.memoizedState=Yd(c,h,E,_);return}}Gt.flags|=a,T.memoizedState=Yd(1|c,h,E,_)}function iS(a,c){return Zp(8390656,8,a,c)}function sv(a,c){return em(2048,8,a,c)}function sS(a,c){return em(4,2,a,c)}function oS(a,c){return em(4,4,a,c)}function aS(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function lS(a,c,h){return h=h!=null?h.concat([a]):null,em(4,4,aS.bind(null,c,a),h)}function ov(){}function cS(a,c){var h=Xr();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(h.memoizedState=[a,c],a)}function uS(a,c){var h=Xr();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(a=a(),h.memoizedState=[a,c],a)}function dS(a,c,h){return(ol&21)===0?(a.baseState&&(a.baseState=!1,ur=!0),a.memoizedState=h):(mi(h,c)||(h=Id(),Gt.lanes|=h,al|=h,a.baseState=!0),c)}function QV(a,c){var h=nt;nt=h!==0&&4>h?h:4,a(!0);var _=Z_.transition;Z_.transition={};try{a(!1),c()}finally{nt=h,Z_.transition=_}}function hS(){return Xr().memoizedState}function YV(a,c,h){var _=Ho(a);if(h={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null},fS(a))pS(c,h);else if(h=$x(a,c,h,_),h!==null){var T=Zn();wi(h,a,_,T),mS(h,c,_)}}function XV(a,c,h){var _=Ho(a),T={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null};if(fS(a))pS(c,T);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var C=c.lastRenderedState,V=E(C,h);if(T.hasEagerState=!0,T.eagerState=V,mi(V,C)){var U=c.interleaved;U===null?(T.next=T,W_(c)):(T.next=U.next,U.next=T),c.interleaved=T;return}}catch{}finally{}h=$x(a,c,T,_),h!==null&&(T=Zn(),wi(h,a,_,T),mS(h,c,_))}}function fS(a){var c=a.alternate;return a===Gt||c!==null&&c===Gt}function pS(a,c){Kd=Xp=!0;var h=a.pending;h===null?c.next=c:(c.next=h.next,h.next=c),a.pending=c}function mS(a,c,h){if((h&4194240)!==0){var _=c.lanes;_&=a.pendingLanes,h|=_,c.lanes=h,Sd(a,h)}}var tm={readContext:Yr,useCallback:qn,useContext:qn,useEffect:qn,useImperativeHandle:qn,useInsertionEffect:qn,useLayoutEffect:qn,useMemo:qn,useReducer:qn,useRef:qn,useState:qn,useDebugValue:qn,useDeferredValue:qn,useTransition:qn,useMutableSource:qn,useSyncExternalStore:qn,useId:qn,unstable_isNewReconciler:!1},ZV={readContext:Yr,useCallback:function(a,c){return Ki().memoizedState=[a,c===void 0?null:c],a},useContext:Yr,useEffect:iS,useImperativeHandle:function(a,c,h){return h=h!=null?h.concat([a]):null,Zp(4194308,4,aS.bind(null,c,a),h)},useLayoutEffect:function(a,c){return Zp(4194308,4,a,c)},useInsertionEffect:function(a,c){return Zp(4,2,a,c)},useMemo:function(a,c){var h=Ki();return c=c===void 0?null:c,a=a(),h.memoizedState=[a,c],a},useReducer:function(a,c,h){var _=Ki();return c=h!==void 0?h(c):c,_.memoizedState=_.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},_.queue=a,a=a.dispatch=YV.bind(null,Gt,a),[_.memoizedState,a]},useRef:function(a){var c=Ki();return a={current:a},c.memoizedState=a},useState:nS,useDebugValue:ov,useDeferredValue:function(a){return Ki().memoizedState=a},useTransition:function(){var a=nS(!1),c=a[0];return a=QV.bind(null,a[1]),Ki().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,h){var _=Gt,T=Ki();if(Lt){if(h===void 0)throw Error(t(407));h=h()}else{if(h=c(),vn===null)throw Error(t(349));(ol&30)!==0||Yx(_,c,h)}T.memoizedState=h;var E={value:h,getSnapshot:c};return T.queue=E,iS(Zx.bind(null,_,E,a),[a]),_.flags|=2048,Yd(9,Xx.bind(null,_,E,h,c),void 0,null),h},useId:function(){var a=Ki(),c=vn.identifierPrefix;if(Lt){var h=Fs,_=Vs;h=(_&~(1<<32-Cr(_)-1)).toString(32)+h,c=":"+c+"R"+h,h=Jd++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=JV++,c=":"+c+"r"+h.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},eF={readContext:Yr,useCallback:cS,useContext:Yr,useEffect:sv,useImperativeHandle:lS,useInsertionEffect:sS,useLayoutEffect:oS,useMemo:uS,useReducer:rv,useRef:rS,useState:function(){return rv(Qd)},useDebugValue:ov,useDeferredValue:function(a){var c=Xr();return dS(c,hn.memoizedState,a)},useTransition:function(){var a=rv(Qd)[0],c=Xr().memoizedState;return[a,c]},useMutableSource:Jx,useSyncExternalStore:Qx,useId:hS,unstable_isNewReconciler:!1},tF={readContext:Yr,useCallback:cS,useContext:Yr,useEffect:sv,useImperativeHandle:lS,useInsertionEffect:sS,useLayoutEffect:oS,useMemo:uS,useReducer:iv,useRef:rS,useState:function(){return iv(Qd)},useDebugValue:ov,useDeferredValue:function(a){var c=Xr();return hn===null?c.memoizedState=a:dS(c,hn.memoizedState,a)},useTransition:function(){var a=iv(Qd)[0],c=Xr().memoizedState;return[a,c]},useMutableSource:Jx,useSyncExternalStore:Qx,useId:hS,unstable_isNewReconciler:!1};function yi(a,c){if(a&&a.defaultProps){c=ye({},c),a=a.defaultProps;for(var h in a)c[h]===void 0&&(c[h]=a[h]);return c}return c}function av(a,c,h,_){c=a.memoizedState,h=h(_,c),h=h==null?c:ye({},c,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var nm={isMounted:function(a){return(a=a._reactInternals)?fi(a)===a:!1},enqueueSetState:function(a,c,h){a=a._reactInternals;var _=Zn(),T=Ho(a),E=Us(_,T);E.payload=c,h!=null&&(E.callback=h),c=Oo(a,E,T),c!==null&&(wi(c,a,T,_),Kp(c,a,T))},enqueueReplaceState:function(a,c,h){a=a._reactInternals;var _=Zn(),T=Ho(a),E=Us(_,T);E.tag=1,E.payload=c,h!=null&&(E.callback=h),c=Oo(a,E,T),c!==null&&(wi(c,a,T,_),Kp(c,a,T))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var h=Zn(),_=Ho(a),T=Us(h,_);T.tag=2,c!=null&&(T.callback=c),c=Oo(a,T,_),c!==null&&(wi(c,a,_,h),Kp(c,a,_))}};function gS(a,c,h,_,T,E,C){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(_,E,C):c.prototype&&c.prototype.isPureReactComponent?!Fd(h,_)||!Fd(T,E):!0}function yS(a,c,h){var _=!1,T=Lo,E=c.contextType;return typeof E=="object"&&E!==null?E=Yr(E):(T=cr(c)?tl:Bn.current,_=c.contextTypes,E=(_=_!=null)?Vc(a,T):Lo),c=new c(h,E),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=nm,a.stateNode=c,c._reactInternals=a,_&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=T,a.__reactInternalMemoizedMaskedChildContext=E),c}function _S(a,c,h,_){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,_),c.state!==a&&nm.enqueueReplaceState(c,c.state,null)}function lv(a,c,h,_){var T=a.stateNode;T.props=h,T.state=a.memoizedState,T.refs={},K_(a);var E=c.contextType;typeof E=="object"&&E!==null?T.context=Yr(E):(E=cr(c)?tl:Bn.current,T.context=Vc(a,E)),T.state=a.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(av(a,c,E,h),T.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&nm.enqueueReplaceState(T,T.state,null),Jp(a,h,T,_),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308)}function $c(a,c){try{var h="",_=c;do h+=Ue(_),_=_.return;while(_);var T=h}catch(E){T=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:c,stack:T,digest:null}}function cv(a,c,h){return{value:a,source:null,stack:h??null,digest:c??null}}function uv(a,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var nF=typeof WeakMap=="function"?WeakMap:Map;function vS(a,c,h){h=Us(-1,h),h.tag=3,h.payload={element:null};var _=c.value;return h.callback=function(){cm||(cm=!0,Sv=_),uv(a,c)},h}function wS(a,c,h){h=Us(-1,h),h.tag=3;var _=a.type.getDerivedStateFromError;if(typeof _=="function"){var T=c.value;h.payload=function(){return _(T)},h.callback=function(){uv(a,c)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(h.callback=function(){uv(a,c),typeof _!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})}),h}function TS(a,c,h){var _=a.pingCache;if(_===null){_=a.pingCache=new nF;var T=new Set;_.set(c,T)}else T=_.get(c),T===void 0&&(T=new Set,_.set(c,T));T.has(h)||(T.add(h),a=gF.bind(null,a,c,h),c.then(a,a))}function ES(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function IS(a,c,h,_,T){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Us(-1,1),c.tag=2,Oo(h,c,1))),h.lanes|=1),a):(a.flags|=65536,a.lanes=T,a)}var rF=K.ReactCurrentOwner,ur=!1;function Xn(a,c,h,_){c.child=a===null?Gx(c,null,h,_):Bc(c,a.child,h,_)}function xS(a,c,h,_,T){h=h.render;var E=c.ref;return Hc(c,T),_=tv(a,c,h,_,E,T),h=nv(),a!==null&&!ur?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~T,Bs(a,c,T)):(Lt&&h&&O_(c),c.flags|=1,Xn(a,c,_,T),c.child)}function SS(a,c,h,_,T){if(a===null){var E=h.type;return typeof E=="function"&&!Pv(E)&&E.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=E,CS(a,c,E,_,T)):(a=mm(h.type,null,_,c,c.mode,T),a.ref=c.ref,a.return=c,c.child=a)}if(E=a.child,(a.lanes&T)===0){var C=E.memoizedProps;if(h=h.compare,h=h!==null?h:Fd,h(C,_)&&a.ref===c.ref)return Bs(a,c,T)}return c.flags|=1,a=$o(E,_),a.ref=c.ref,a.return=c,c.child=a}function CS(a,c,h,_,T){if(a!==null){var E=a.memoizedProps;if(Fd(E,_)&&a.ref===c.ref)if(ur=!1,c.pendingProps=_=E,(a.lanes&T)!==0)(a.flags&131072)!==0&&(ur=!0);else return c.lanes=a.lanes,Bs(a,c,T)}return dv(a,c,h,_,T)}function AS(a,c,h){var _=c.pendingProps,T=_.children,E=a!==null?a.memoizedState:null;if(_.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(zc,Dr),Dr|=h;else{if((h&1073741824)===0)return a=E!==null?E.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,It(zc,Dr),Dr|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=E!==null?E.baseLanes:h,It(zc,Dr),Dr|=_}else E!==null?(_=E.baseLanes|h,c.memoizedState=null):_=h,It(zc,Dr),Dr|=_;return Xn(a,c,T,h),c.child}function NS(a,c){var h=c.ref;(a===null&&h!==null||a!==null&&a.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function dv(a,c,h,_,T){var E=cr(h)?tl:Bn.current;return E=Vc(c,E),Hc(c,T),h=tv(a,c,h,_,E,T),_=nv(),a!==null&&!ur?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~T,Bs(a,c,T)):(Lt&&_&&O_(c),c.flags|=1,Xn(a,c,h,T),c.child)}function kS(a,c,h,_,T){if(cr(h)){var E=!0;Bp(c)}else E=!1;if(Hc(c,T),c.stateNode===null)im(a,c),yS(c,h,_),lv(c,h,_,T),_=!0;else if(a===null){var C=c.stateNode,V=c.memoizedProps;C.props=V;var U=C.context,Y=h.contextType;typeof Y=="object"&&Y!==null?Y=Yr(Y):(Y=cr(h)?tl:Bn.current,Y=Vc(c,Y));var ae=h.getDerivedStateFromProps,ce=typeof ae=="function"||typeof C.getSnapshotBeforeUpdate=="function";ce||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==_||U!==Y)&&_S(c,C,_,Y),Fo=!1;var se=c.memoizedState;C.state=se,Jp(c,_,C,T),U=c.memoizedState,V!==_||se!==U||lr.current||Fo?(typeof ae=="function"&&(av(c,h,ae,_),U=c.memoizedState),(V=Fo||gS(c,h,V,_,se,U,Y))?(ce||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(c.flags|=4194308)):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=U),C.props=_,C.state=U,C.context=Y,_=V):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{C=c.stateNode,jx(a,c),V=c.memoizedProps,Y=c.type===c.elementType?V:yi(c.type,V),C.props=Y,ce=c.pendingProps,se=C.context,U=h.contextType,typeof U=="object"&&U!==null?U=Yr(U):(U=cr(h)?tl:Bn.current,U=Vc(c,U));var Te=h.getDerivedStateFromProps;(ae=typeof Te=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==ce||se!==U)&&_S(c,C,_,U),Fo=!1,se=c.memoizedState,C.state=se,Jp(c,_,C,T);var Se=c.memoizedState;V!==ce||se!==Se||lr.current||Fo?(typeof Te=="function"&&(av(c,h,Te,_),Se=c.memoizedState),(Y=Fo||gS(c,h,Y,_,se,Se,U)||!1)?(ae||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(_,Se,U),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(_,Se,U)),typeof C.componentDidUpdate=="function"&&(c.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=Se),C.props=_,C.state=Se,C.context=U,_=Y):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),_=!1)}return hv(a,c,h,_,E,T)}function hv(a,c,h,_,T,E){NS(a,c);var C=(c.flags&128)!==0;if(!_&&!C)return T&&Mx(c,h,!1),Bs(a,c,E);_=c.stateNode,rF.current=c;var V=C&&typeof h.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,a!==null&&C?(c.child=Bc(c,a.child,null,E),c.child=Bc(c,null,V,E)):Xn(a,c,V,E),c.memoizedState=_.state,T&&Mx(c,h,!0),c.child}function RS(a){var c=a.stateNode;c.pendingContext?Px(a,c.pendingContext,c.pendingContext!==c.context):c.context&&Px(a,c.context,!1),J_(a,c.containerInfo)}function bS(a,c,h,_,T){return Uc(),H_(T),c.flags|=256,Xn(a,c,h,_),c.child}var fv={dehydrated:null,treeContext:null,retryLane:0};function pv(a){return{baseLanes:a,cachePool:null,transitions:null}}function PS(a,c,h){var _=c.pendingProps,T=Ht.current,E=!1,C=(c.flags&128)!==0,V;if((V=C)||(V=a!==null&&a.memoizedState===null?!1:(T&2)!==0),V?(E=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(T|=1),It(Ht,T&1),a===null)return q_(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(C=_.children,a=_.fallback,E?(_=c.mode,E=c.child,C={mode:"hidden",children:C},(_&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=C):E=gm(C,_,0,null),a=dl(a,_,h,null),E.return=c,a.return=c,E.sibling=a,c.child=E,c.child.memoizedState=pv(h),c.memoizedState=fv,a):mv(c,C));if(T=a.memoizedState,T!==null&&(V=T.dehydrated,V!==null))return iF(a,c,C,_,V,T,h);if(E){E=_.fallback,C=c.mode,T=a.child,V=T.sibling;var U={mode:"hidden",children:_.children};return(C&1)===0&&c.child!==T?(_=c.child,_.childLanes=0,_.pendingProps=U,c.deletions=null):(_=$o(T,U),_.subtreeFlags=T.subtreeFlags&14680064),V!==null?E=$o(V,E):(E=dl(E,C,h,null),E.flags|=2),E.return=c,_.return=c,_.sibling=E,c.child=_,_=E,E=c.child,C=a.child.memoizedState,C=C===null?pv(h):{baseLanes:C.baseLanes|h,cachePool:null,transitions:C.transitions},E.memoizedState=C,E.childLanes=a.childLanes&~h,c.memoizedState=fv,_}return E=a.child,a=E.sibling,_=$o(E,{mode:"visible",children:_.children}),(c.mode&1)===0&&(_.lanes=h),_.return=c,_.sibling=null,a!==null&&(h=c.deletions,h===null?(c.deletions=[a],c.flags|=16):h.push(a)),c.child=_,c.memoizedState=null,_}function mv(a,c){return c=gm({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function rm(a,c,h,_){return _!==null&&H_(_),Bc(c,a.child,null,h),a=mv(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function iF(a,c,h,_,T,E,C){if(h)return c.flags&256?(c.flags&=-257,_=cv(Error(t(422))),rm(a,c,C,_)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(E=_.fallback,T=c.mode,_=gm({mode:"visible",children:_.children},T,0,null),E=dl(E,T,C,null),E.flags|=2,_.return=c,E.return=c,_.sibling=E,c.child=_,(c.mode&1)!==0&&Bc(c,a.child,null,C),c.child.memoizedState=pv(C),c.memoizedState=fv,E);if((c.mode&1)===0)return rm(a,c,C,null);if(T.data==="$!"){if(_=T.nextSibling&&T.nextSibling.dataset,_)var V=_.dgst;return _=V,E=Error(t(419)),_=cv(E,_,void 0),rm(a,c,C,_)}if(V=(C&a.childLanes)!==0,ur||V){if(_=vn,_!==null){switch(C&-C){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(_.suspendedLanes|C))!==0?0:T,T!==0&&T!==E.retryLane&&(E.retryLane=T,Os(a,T),wi(_,a,T,-1))}return bv(),_=cv(Error(t(421))),rm(a,c,C,_)}return T.data==="$?"?(c.flags|=128,c.child=a.child,c=yF.bind(null,a),T._reactRetry=c,null):(a=E.treeContext,Pr=Do(T.nextSibling),br=c,Lt=!0,gi=null,a!==null&&(Jr[Qr++]=Vs,Jr[Qr++]=Fs,Jr[Qr++]=nl,Vs=a.id,Fs=a.overflow,nl=c),c=mv(c,_.children),c.flags|=4096,c)}function DS(a,c,h){a.lanes|=c;var _=a.alternate;_!==null&&(_.lanes|=c),z_(a.return,c,h)}function gv(a,c,h,_,T){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:T}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=_,E.tail=h,E.tailMode=T)}function MS(a,c,h){var _=c.pendingProps,T=_.revealOrder,E=_.tail;if(Xn(a,c,_.children,h),_=Ht.current,(_&2)!==0)_=_&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&DS(a,h,c);else if(a.tag===19)DS(a,h,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}_&=1}if(It(Ht,_),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(h=c.child,T=null;h!==null;)a=h.alternate,a!==null&&Qp(a)===null&&(T=h),h=h.sibling;h=T,h===null?(T=c.child,c.child=null):(T=h.sibling,h.sibling=null),gv(c,!1,T,h,E);break;case"backwards":for(h=null,T=c.child,c.child=null;T!==null;){if(a=T.alternate,a!==null&&Qp(a)===null){c.child=T;break}a=T.sibling,T.sibling=h,h=T,T=a}gv(c,!0,h,null,E);break;case"together":gv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function im(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Bs(a,c,h){if(a!==null&&(c.dependencies=a.dependencies),al|=c.lanes,(h&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,h=$o(a,a.pendingProps),c.child=h,h.return=c;a.sibling!==null;)a=a.sibling,h=h.sibling=$o(a,a.pendingProps),h.return=c;h.sibling=null}return c.child}function sF(a,c,h){switch(c.tag){case 3:RS(c),Uc();break;case 5:Kx(c);break;case 1:cr(c.type)&&Bp(c);break;case 4:J_(c,c.stateNode.containerInfo);break;case 10:var _=c.type._context,T=c.memoizedProps.value;It(zp,_._currentValue),_._currentValue=T;break;case 13:if(_=c.memoizedState,_!==null)return _.dehydrated!==null?(It(Ht,Ht.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?PS(a,c,h):(It(Ht,Ht.current&1),a=Bs(a,c,h),a!==null?a.sibling:null);It(Ht,Ht.current&1);break;case 19:if(_=(h&c.childLanes)!==0,(a.flags&128)!==0){if(_)return MS(a,c,h);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),It(Ht,Ht.current),_)break;return null;case 22:case 23:return c.lanes=0,AS(a,c,h)}return Bs(a,c,h)}var LS,yv,VS,FS;LS=function(a,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)a.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},yv=function(){},VS=function(a,c,h,_){var T=a.memoizedProps;if(T!==_){a=c.stateNode,sl(Wi.current);var E=null;switch(h){case"input":T=$r(a,T),_=$r(a,_),E=[];break;case"select":T=ye({},T,{value:void 0}),_=ye({},_,{value:void 0}),E=[];break;case"textarea":T=yo(a,T),_=yo(a,_),E=[];break;default:typeof T.onClick!="function"&&typeof _.onClick=="function"&&(a.onclick=Fp)}Ir(h,_);var C;h=null;for(Y in T)if(!_.hasOwnProperty(Y)&&T.hasOwnProperty(Y)&&T[Y]!=null)if(Y==="style"){var V=T[Y];for(C in V)V.hasOwnProperty(C)&&(h||(h={}),h[C]="")}else Y!=="dangerouslySetInnerHTML"&&Y!=="children"&&Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(i.hasOwnProperty(Y)?E||(E=[]):(E=E||[]).push(Y,null));for(Y in _){var U=_[Y];if(V=T!=null?T[Y]:void 0,_.hasOwnProperty(Y)&&U!==V&&(U!=null||V!=null))if(Y==="style")if(V){for(C in V)!V.hasOwnProperty(C)||U&&U.hasOwnProperty(C)||(h||(h={}),h[C]="");for(C in U)U.hasOwnProperty(C)&&V[C]!==U[C]&&(h||(h={}),h[C]=U[C])}else h||(E||(E=[]),E.push(Y,h)),h=U;else Y==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,V=V?V.__html:void 0,U!=null&&V!==U&&(E=E||[]).push(Y,U)):Y==="children"?typeof U!="string"&&typeof U!="number"||(E=E||[]).push(Y,""+U):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&(i.hasOwnProperty(Y)?(U!=null&&Y==="onScroll"&&kt("scroll",a),E||V===U||(E=[])):(E=E||[]).push(Y,U))}h&&(E=E||[]).push("style",h);var Y=E;(c.updateQueue=Y)&&(c.flags|=4)}},FS=function(a,c,h,_){h!==_&&(c.flags|=4)};function Xd(a,c){if(!Lt)switch(a.tailMode){case"hidden":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:_.sibling=null}}function Hn(a){var c=a.alternate!==null&&a.alternate.child===a.child,h=0,_=0;if(c)for(var T=a.child;T!==null;)h|=T.lanes|T.childLanes,_|=T.subtreeFlags&14680064,_|=T.flags&14680064,T.return=a,T=T.sibling;else for(T=a.child;T!==null;)h|=T.lanes|T.childLanes,_|=T.subtreeFlags,_|=T.flags,T.return=a,T=T.sibling;return a.subtreeFlags|=_,a.childLanes=h,c}function oF(a,c,h){var _=c.pendingProps;switch(U_(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(c),null;case 1:return cr(c.type)&&Up(),Hn(c),null;case 3:return _=c.stateNode,Gc(),Rt(lr),Rt(Bn),X_(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(a===null||a.child===null)&&($p(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,gi!==null&&(Nv(gi),gi=null))),yv(a,c),Hn(c),null;case 5:Q_(c);var T=sl(Wd.current);if(h=c.type,a!==null&&c.stateNode!=null)VS(a,c,h,_,T),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(t(166));return Hn(c),null}if(a=sl(Wi.current),$p(c)){_=c.stateNode,h=c.type;var E=c.memoizedProps;switch(_[zi]=c,_[Hd]=E,a=(c.mode&1)!==0,h){case"dialog":kt("cancel",_),kt("close",_);break;case"iframe":case"object":case"embed":kt("load",_);break;case"video":case"audio":for(T=0;T<Ud.length;T++)kt(Ud[T],_);break;case"source":kt("error",_);break;case"img":case"image":case"link":kt("error",_),kt("load",_);break;case"details":kt("toggle",_);break;case"input":ws(_,E),kt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!E.multiple},kt("invalid",_);break;case"textarea":_o(_,E),kt("invalid",_)}Ir(h,E),T=null;for(var C in E)if(E.hasOwnProperty(C)){var V=E[C];C==="children"?typeof V=="string"?_.textContent!==V&&(E.suppressHydrationWarning!==!0&&Vp(_.textContent,V,a),T=["children",V]):typeof V=="number"&&_.textContent!==""+V&&(E.suppressHydrationWarning!==!0&&Vp(_.textContent,V,a),T=["children",""+V]):i.hasOwnProperty(C)&&V!=null&&C==="onScroll"&&kt("scroll",_)}switch(h){case"input":je(_),Es(_,E,!0);break;case"textarea":je(_),ci(_);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(_.onclick=Fp)}_=T,c.updateQueue=_,_!==null&&(c.flags|=4)}else{C=T.nodeType===9?T:T.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=vo(h)),a==="http://www.w3.org/1999/xhtml"?h==="script"?(a=C.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof _.is=="string"?a=C.createElement(h,{is:_.is}):(a=C.createElement(h),h==="select"&&(C=a,_.multiple?C.multiple=!0:_.size&&(C.size=_.size))):a=C.createElementNS(a,h),a[zi]=c,a[Hd]=_,LS(a,c,!1,!1),c.stateNode=a;e:{switch(C=Ss(h,_),h){case"dialog":kt("cancel",a),kt("close",a),T=_;break;case"iframe":case"object":case"embed":kt("load",a),T=_;break;case"video":case"audio":for(T=0;T<Ud.length;T++)kt(Ud[T],a);T=_;break;case"source":kt("error",a),T=_;break;case"img":case"image":case"link":kt("error",a),kt("load",a),T=_;break;case"details":kt("toggle",a),T=_;break;case"input":ws(a,_),T=$r(a,_),kt("invalid",a);break;case"option":T=_;break;case"select":a._wrapperState={wasMultiple:!!_.multiple},T=ye({},_,{value:void 0}),kt("invalid",a);break;case"textarea":_o(a,_),T=yo(a,_),kt("invalid",a);break;default:T=_}Ir(h,T),V=T;for(E in V)if(V.hasOwnProperty(E)){var U=V[E];E==="style"?wo(a,U):E==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&Ua(a,U)):E==="children"?typeof U=="string"?(h!=="textarea"||U!=="")&&xs(a,U):typeof U=="number"&&xs(a,""+U):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(i.hasOwnProperty(E)?U!=null&&E==="onScroll"&&kt("scroll",a):U!=null&&q(a,E,U,C))}switch(h){case"input":je(a),Es(a,_,!1);break;case"textarea":je(a),ci(a);break;case"option":_.value!=null&&a.setAttribute("value",""+_e(_.value));break;case"select":a.multiple=!!_.multiple,E=_.value,E!=null?ar(a,!!_.multiple,E,!1):_.defaultValue!=null&&ar(a,!!_.multiple,_.defaultValue,!0);break;default:typeof T.onClick=="function"&&(a.onclick=Fp)}switch(h){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Hn(c),null;case 6:if(a&&c.stateNode!=null)FS(a,c,a.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(t(166));if(h=sl(Wd.current),sl(Wi.current),$p(c)){if(_=c.stateNode,h=c.memoizedProps,_[zi]=c,(E=_.nodeValue!==h)&&(a=br,a!==null))switch(a.tag){case 3:Vp(_.nodeValue,h,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Vp(_.nodeValue,h,(a.mode&1)!==0)}E&&(c.flags|=4)}else _=(h.nodeType===9?h:h.ownerDocument).createTextNode(_),_[zi]=c,c.stateNode=_}return Hn(c),null;case 13:if(Rt(Ht),_=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Lt&&Pr!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Bx(),Uc(),c.flags|=98560,E=!1;else if(E=$p(c),_!==null&&_.dehydrated!==null){if(a===null){if(!E)throw Error(t(318));if(E=c.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[zi]=c}else Uc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Hn(c),E=!1}else gi!==null&&(Nv(gi),gi=null),E=!0;if(!E)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(_=_!==null,_!==(a!==null&&a.memoizedState!==null)&&_&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(Ht.current&1)!==0?fn===0&&(fn=3):bv())),c.updateQueue!==null&&(c.flags|=4),Hn(c),null);case 4:return Gc(),yv(a,c),a===null&&Bd(c.stateNode.containerInfo),Hn(c),null;case 10:return j_(c.type._context),Hn(c),null;case 17:return cr(c.type)&&Up(),Hn(c),null;case 19:if(Rt(Ht),E=c.memoizedState,E===null)return Hn(c),null;if(_=(c.flags&128)!==0,C=E.rendering,C===null)if(_)Xd(E,!1);else{if(fn!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(C=Qp(a),C!==null){for(c.flags|=128,Xd(E,!1),_=C.updateQueue,_!==null&&(c.updateQueue=_,c.flags|=4),c.subtreeFlags=0,_=h,h=c.child;h!==null;)E=h,a=_,E.flags&=14680066,C=E.alternate,C===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=C.childLanes,E.lanes=C.lanes,E.child=C.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=C.memoizedProps,E.memoizedState=C.memoizedState,E.updateQueue=C.updateQueue,E.type=C.type,a=C.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),h=h.sibling;return It(Ht,Ht.current&1|2),c.child}a=a.sibling}E.tail!==null&&Nt()>Wc&&(c.flags|=128,_=!0,Xd(E,!1),c.lanes=4194304)}else{if(!_)if(a=Qp(C),a!==null){if(c.flags|=128,_=!0,h=a.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),Xd(E,!0),E.tail===null&&E.tailMode==="hidden"&&!C.alternate&&!Lt)return Hn(c),null}else 2*Nt()-E.renderingStartTime>Wc&&h!==1073741824&&(c.flags|=128,_=!0,Xd(E,!1),c.lanes=4194304);E.isBackwards?(C.sibling=c.child,c.child=C):(h=E.last,h!==null?h.sibling=C:c.child=C,E.last=C)}return E.tail!==null?(c=E.tail,E.rendering=c,E.tail=c.sibling,E.renderingStartTime=Nt(),c.sibling=null,h=Ht.current,It(Ht,_?h&1|2:h&1),c):(Hn(c),null);case 22:case 23:return Rv(),_=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==_&&(c.flags|=8192),_&&(c.mode&1)!==0?(Dr&1073741824)!==0&&(Hn(c),c.subtreeFlags&6&&(c.flags|=8192)):Hn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function aF(a,c){switch(U_(c),c.tag){case 1:return cr(c.type)&&Up(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Gc(),Rt(lr),Rt(Bn),X_(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return Q_(c),null;case 13:if(Rt(Ht),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Uc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Rt(Ht),null;case 4:return Gc(),null;case 10:return j_(c.type._context),null;case 22:case 23:return Rv(),null;case 24:return null;default:return null}}var sm=!1,Gn=!1,lF=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function jc(a,c){var h=a.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(_){Kt(a,c,_)}else h.current=null}function _v(a,c,h){try{h()}catch(_){Kt(a,c,_)}}var OS=!1;function cF(a,c){if(R_=bs,a=gx(),E_(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var _=h.getSelection&&h.getSelection();if(_&&_.rangeCount!==0){h=_.anchorNode;var T=_.anchorOffset,E=_.focusNode;_=_.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var C=0,V=-1,U=-1,Y=0,ae=0,ce=a,se=null;t:for(;;){for(var Te;ce!==h||T!==0&&ce.nodeType!==3||(V=C+T),ce!==E||_!==0&&ce.nodeType!==3||(U=C+_),ce.nodeType===3&&(C+=ce.nodeValue.length),(Te=ce.firstChild)!==null;)se=ce,ce=Te;for(;;){if(ce===a)break t;if(se===h&&++Y===T&&(V=C),se===E&&++ae===_&&(U=C),(Te=ce.nextSibling)!==null)break;ce=se,se=ce.parentNode}ce=Te}h=V===-1||U===-1?null:{start:V,end:U}}else h=null}h=h||{start:0,end:0}}else h=null;for(b_={focusedElem:a,selectionRange:h},bs=!1,Ie=c;Ie!==null;)if(c=Ie,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Ie=a;else for(;Ie!==null;){c=Ie;try{var Se=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var Ae=Se.memoizedProps,Zt=Se.memoizedState,z=c.stateNode,H=z.getSnapshotBeforeUpdate(c.elementType===c.type?Ae:yi(c.type,Ae),Zt);z.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var J=c.stateNode.containerInfo;J.nodeType===1?J.textContent="":J.nodeType===9&&J.documentElement&&J.removeChild(J.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Kt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,Ie=a;break}Ie=c.return}return Se=OS,OS=!1,Se}function Zd(a,c,h){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var T=_=_.next;do{if((T.tag&a)===a){var E=T.destroy;T.destroy=void 0,E!==void 0&&_v(c,h,E)}T=T.next}while(T!==_)}}function om(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&a)===a){var _=h.create;h.destroy=_()}h=h.next}while(h!==c)}}function vv(a){var c=a.ref;if(c!==null){var h=a.stateNode;switch(a.tag){case 5:a=h;break;default:a=h}typeof c=="function"?c(a):c.current=a}}function US(a){var c=a.alternate;c!==null&&(a.alternate=null,US(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[zi],delete c[Hd],delete c[L_],delete c[jV],delete c[zV])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function BS(a){return a.tag===5||a.tag===3||a.tag===4}function qS(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||BS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function wv(a,c,h){var _=a.tag;if(_===5||_===6)a=a.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(a,c):h.insertBefore(a,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(a,h)):(c=h,c.appendChild(a)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Fp));else if(_!==4&&(a=a.child,a!==null))for(wv(a,c,h),a=a.sibling;a!==null;)wv(a,c,h),a=a.sibling}function Tv(a,c,h){var _=a.tag;if(_===5||_===6)a=a.stateNode,c?h.insertBefore(a,c):h.appendChild(a);else if(_!==4&&(a=a.child,a!==null))for(Tv(a,c,h),a=a.sibling;a!==null;)Tv(a,c,h),a=a.sibling}var Pn=null,_i=!1;function Uo(a,c,h){for(h=h.child;h!==null;)HS(a,c,h),h=h.sibling}function HS(a,c,h){if(Sr&&typeof Sr.onCommitFiberUnmount=="function")try{Sr.onCommitFiberUnmount(ja,h)}catch{}switch(h.tag){case 5:Gn||jc(h,c);case 6:var _=Pn,T=_i;Pn=null,Uo(a,c,h),Pn=_,_i=T,Pn!==null&&(_i?(a=Pn,h=h.stateNode,a.nodeType===8?a.parentNode.removeChild(h):a.removeChild(h)):Pn.removeChild(h.stateNode));break;case 18:Pn!==null&&(_i?(a=Pn,h=h.stateNode,a.nodeType===8?M_(a.parentNode,h):a.nodeType===1&&M_(a,h),ko(a)):M_(Pn,h.stateNode));break;case 4:_=Pn,T=_i,Pn=h.stateNode.containerInfo,_i=!0,Uo(a,c,h),Pn=_,_i=T;break;case 0:case 11:case 14:case 15:if(!Gn&&(_=h.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){T=_=_.next;do{var E=T,C=E.destroy;E=E.tag,C!==void 0&&((E&2)!==0||(E&4)!==0)&&_v(h,c,C),T=T.next}while(T!==_)}Uo(a,c,h);break;case 1:if(!Gn&&(jc(h,c),_=h.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=h.memoizedProps,_.state=h.memoizedState,_.componentWillUnmount()}catch(V){Kt(h,c,V)}Uo(a,c,h);break;case 21:Uo(a,c,h);break;case 22:h.mode&1?(Gn=(_=Gn)||h.memoizedState!==null,Uo(a,c,h),Gn=_):Uo(a,c,h);break;default:Uo(a,c,h)}}function GS(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var h=a.stateNode;h===null&&(h=a.stateNode=new lF),c.forEach(function(_){var T=_F.bind(null,a,_);h.has(_)||(h.add(_),_.then(T,T))})}}function vi(a,c){var h=c.deletions;if(h!==null)for(var _=0;_<h.length;_++){var T=h[_];try{var E=a,C=c,V=C;e:for(;V!==null;){switch(V.tag){case 5:Pn=V.stateNode,_i=!1;break e;case 3:Pn=V.stateNode.containerInfo,_i=!0;break e;case 4:Pn=V.stateNode.containerInfo,_i=!0;break e}V=V.return}if(Pn===null)throw Error(t(160));HS(E,C,T),Pn=null,_i=!1;var U=T.alternate;U!==null&&(U.return=null),T.return=null}catch(Y){Kt(T,c,Y)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)$S(c,a),c=c.sibling}function $S(a,c){var h=a.alternate,_=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(vi(c,a),Ji(a),_&4){try{Zd(3,a,a.return),om(3,a)}catch(Ae){Kt(a,a.return,Ae)}try{Zd(5,a,a.return)}catch(Ae){Kt(a,a.return,Ae)}}break;case 1:vi(c,a),Ji(a),_&512&&h!==null&&jc(h,h.return);break;case 5:if(vi(c,a),Ji(a),_&512&&h!==null&&jc(h,h.return),a.flags&32){var T=a.stateNode;try{xs(T,"")}catch(Ae){Kt(a,a.return,Ae)}}if(_&4&&(T=a.stateNode,T!=null)){var E=a.memoizedProps,C=h!==null?h.memoizedProps:E,V=a.type,U=a.updateQueue;if(a.updateQueue=null,U!==null)try{V==="input"&&E.type==="radio"&&E.name!=null&&kn(T,E),Ss(V,C);var Y=Ss(V,E);for(C=0;C<U.length;C+=2){var ae=U[C],ce=U[C+1];ae==="style"?wo(T,ce):ae==="dangerouslySetInnerHTML"?Ua(T,ce):ae==="children"?xs(T,ce):q(T,ae,ce,Y)}switch(V){case"input":Ts(T,E);break;case"textarea":Oa(T,E);break;case"select":var se=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!E.multiple;var Te=E.value;Te!=null?ar(T,!!E.multiple,Te,!1):se!==!!E.multiple&&(E.defaultValue!=null?ar(T,!!E.multiple,E.defaultValue,!0):ar(T,!!E.multiple,E.multiple?[]:"",!1))}T[Hd]=E}catch(Ae){Kt(a,a.return,Ae)}}break;case 6:if(vi(c,a),Ji(a),_&4){if(a.stateNode===null)throw Error(t(162));T=a.stateNode,E=a.memoizedProps;try{T.nodeValue=E}catch(Ae){Kt(a,a.return,Ae)}}break;case 3:if(vi(c,a),Ji(a),_&4&&h!==null&&h.memoizedState.isDehydrated)try{ko(c.containerInfo)}catch(Ae){Kt(a,a.return,Ae)}break;case 4:vi(c,a),Ji(a);break;case 13:vi(c,a),Ji(a),T=a.child,T.flags&8192&&(E=T.memoizedState!==null,T.stateNode.isHidden=E,!E||T.alternate!==null&&T.alternate.memoizedState!==null||(xv=Nt())),_&4&&GS(a);break;case 22:if(ae=h!==null&&h.memoizedState!==null,a.mode&1?(Gn=(Y=Gn)||ae,vi(c,a),Gn=Y):vi(c,a),Ji(a),_&8192){if(Y=a.memoizedState!==null,(a.stateNode.isHidden=Y)&&!ae&&(a.mode&1)!==0)for(Ie=a,ae=a.child;ae!==null;){for(ce=Ie=ae;Ie!==null;){switch(se=Ie,Te=se.child,se.tag){case 0:case 11:case 14:case 15:Zd(4,se,se.return);break;case 1:jc(se,se.return);var Se=se.stateNode;if(typeof Se.componentWillUnmount=="function"){_=se,h=se.return;try{c=_,Se.props=c.memoizedProps,Se.state=c.memoizedState,Se.componentWillUnmount()}catch(Ae){Kt(_,h,Ae)}}break;case 5:jc(se,se.return);break;case 22:if(se.memoizedState!==null){WS(ce);continue}}Te!==null?(Te.return=se,Ie=Te):WS(ce)}ae=ae.sibling}e:for(ae=null,ce=a;;){if(ce.tag===5){if(ae===null){ae=ce;try{T=ce.stateNode,Y?(E=T.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(V=ce.stateNode,U=ce.memoizedProps.style,C=U!=null&&U.hasOwnProperty("display")?U.display:null,V.style.display=bi("display",C))}catch(Ae){Kt(a,a.return,Ae)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=Y?"":ce.memoizedProps}catch(Ae){Kt(a,a.return,Ae)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:vi(c,a),Ji(a),_&4&&GS(a);break;case 21:break;default:vi(c,a),Ji(a)}}function Ji(a){var c=a.flags;if(c&2){try{e:{for(var h=a.return;h!==null;){if(BS(h)){var _=h;break e}h=h.return}throw Error(t(160))}switch(_.tag){case 5:var T=_.stateNode;_.flags&32&&(xs(T,""),_.flags&=-33);var E=qS(a);Tv(a,E,T);break;case 3:case 4:var C=_.stateNode.containerInfo,V=qS(a);wv(a,V,C);break;default:throw Error(t(161))}}catch(U){Kt(a,a.return,U)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function uF(a,c,h){Ie=a,jS(a)}function jS(a,c,h){for(var _=(a.mode&1)!==0;Ie!==null;){var T=Ie,E=T.child;if(T.tag===22&&_){var C=T.memoizedState!==null||sm;if(!C){var V=T.alternate,U=V!==null&&V.memoizedState!==null||Gn;V=sm;var Y=Gn;if(sm=C,(Gn=U)&&!Y)for(Ie=T;Ie!==null;)C=Ie,U=C.child,C.tag===22&&C.memoizedState!==null?KS(T):U!==null?(U.return=C,Ie=U):KS(T);for(;E!==null;)Ie=E,jS(E),E=E.sibling;Ie=T,sm=V,Gn=Y}zS(a)}else(T.subtreeFlags&8772)!==0&&E!==null?(E.return=T,Ie=E):zS(a)}}function zS(a){for(;Ie!==null;){var c=Ie;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Gn||om(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!Gn)if(h===null)_.componentDidMount();else{var T=c.elementType===c.type?h.memoizedProps:yi(c.type,h.memoizedProps);_.componentDidUpdate(T,h.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var E=c.updateQueue;E!==null&&Wx(c,E,_);break;case 3:var C=c.updateQueue;if(C!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}Wx(c,C,h)}break;case 5:var V=c.stateNode;if(h===null&&c.flags&4){h=V;var U=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&h.focus();break;case"img":U.src&&(h.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Y=c.alternate;if(Y!==null){var ae=Y.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&ko(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Gn||c.flags&512&&vv(c)}catch(se){Kt(c,c.return,se)}}if(c===a){Ie=null;break}if(h=c.sibling,h!==null){h.return=c.return,Ie=h;break}Ie=c.return}}function WS(a){for(;Ie!==null;){var c=Ie;if(c===a){Ie=null;break}var h=c.sibling;if(h!==null){h.return=c.return,Ie=h;break}Ie=c.return}}function KS(a){for(;Ie!==null;){var c=Ie;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{om(4,c)}catch(U){Kt(c,h,U)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var T=c.return;try{_.componentDidMount()}catch(U){Kt(c,T,U)}}var E=c.return;try{vv(c)}catch(U){Kt(c,E,U)}break;case 5:var C=c.return;try{vv(c)}catch(U){Kt(c,C,U)}}}catch(U){Kt(c,c.return,U)}if(c===a){Ie=null;break}var V=c.sibling;if(V!==null){V.return=c.return,Ie=V;break}Ie=c.return}}var dF=Math.ceil,am=K.ReactCurrentDispatcher,Ev=K.ReactCurrentOwner,Zr=K.ReactCurrentBatchConfig,st=0,vn=null,on=null,Dn=0,Dr=0,zc=Mo(0),fn=0,eh=null,al=0,lm=0,Iv=0,th=null,dr=null,xv=0,Wc=1/0,qs=null,cm=!1,Sv=null,Bo=null,um=!1,qo=null,dm=0,nh=0,Cv=null,hm=-1,fm=0;function Zn(){return(st&6)!==0?Nt():hm!==-1?hm:hm=Nt()}function Ho(a){return(a.mode&1)===0?1:(st&2)!==0&&Dn!==0?Dn&-Dn:KV.transition!==null?(fm===0&&(fm=Id()),fm):(a=nt,a!==0||(a=window.event,a=a===void 0?16:Ec(a.type)),a)}function wi(a,c,h,_){if(50<nh)throw nh=0,Cv=null,Error(t(185));Ja(a,h,_),((st&2)===0||a!==vn)&&(a===vn&&((st&2)===0&&(lm|=h),fn===4&&Go(a,Dn)),hr(a,_),h===1&&st===0&&(c.mode&1)===0&&(Wc=Nt()+500,qp&&Vo()))}function hr(a,c){var h=a.callbackNode;Ka(a,c);var _=Ns(a,a===vn?Dn:0);if(_===0)h!==null&&mc(h),a.callbackNode=null,a.callbackPriority=0;else if(c=_&-_,a.callbackPriority!==c){if(h!=null&&mc(h),c===1)a.tag===0?WV(QS.bind(null,a)):Lx(QS.bind(null,a)),GV(function(){(st&6)===0&&Vo()}),h=null;else{switch(Vi(_)){case 1:h=gc;break;case 4:h=wd;break;case 16:h=$a;break;case 536870912:h=yc;break;default:h=$a}h=iC(h,JS.bind(null,a))}a.callbackPriority=c,a.callbackNode=h}}function JS(a,c){if(hm=-1,fm=0,(st&6)!==0)throw Error(t(327));var h=a.callbackNode;if(Kc()&&a.callbackNode!==h)return null;var _=Ns(a,a===vn?Dn:0);if(_===0)return null;if((_&30)!==0||(_&a.expiredLanes)!==0||c)c=pm(a,_);else{c=_;var T=st;st|=2;var E=XS();(vn!==a||Dn!==c)&&(qs=null,Wc=Nt()+500,cl(a,c));do try{pF();break}catch(V){YS(a,V)}while(!0);$_(),am.current=E,st=T,on!==null?c=0:(vn=null,Dn=0,c=fn)}if(c!==0){if(c===2&&(T=Ed(a),T!==0&&(_=T,c=Av(a,T))),c===1)throw h=eh,cl(a,0),Go(a,_),hr(a,Nt()),h;if(c===6)Go(a,_);else{if(T=a.current.alternate,(_&30)===0&&!hF(T)&&(c=pm(a,_),c===2&&(E=Ed(a),E!==0&&(_=E,c=Av(a,E))),c===1))throw h=eh,cl(a,0),Go(a,_),hr(a,Nt()),h;switch(a.finishedWork=T,a.finishedLanes=_,c){case 0:case 1:throw Error(t(345));case 2:ul(a,dr,qs);break;case 3:if(Go(a,_),(_&130023424)===_&&(c=xv+500-Nt(),10<c)){if(Ns(a,0)!==0)break;if(T=a.suspendedLanes,(T&_)!==_){Zn(),a.pingedLanes|=a.suspendedLanes&T;break}a.timeoutHandle=D_(ul.bind(null,a,dr,qs),c);break}ul(a,dr,qs);break;case 4:if(Go(a,_),(_&4194240)===_)break;for(c=a.eventTimes,T=-1;0<_;){var C=31-Cr(_);E=1<<C,C=c[C],C>T&&(T=C),_&=~E}if(_=T,_=Nt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*dF(_/1960))-_,10<_){a.timeoutHandle=D_(ul.bind(null,a,dr,qs),_);break}ul(a,dr,qs);break;case 5:ul(a,dr,qs);break;default:throw Error(t(329))}}}return hr(a,Nt()),a.callbackNode===h?JS.bind(null,a):null}function Av(a,c){var h=th;return a.current.memoizedState.isDehydrated&&(cl(a,c).flags|=256),a=pm(a,c),a!==2&&(c=dr,dr=h,c!==null&&Nv(c)),a}function Nv(a){dr===null?dr=a:dr.push.apply(dr,a)}function hF(a){for(var c=a;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var _=0;_<h.length;_++){var T=h[_],E=T.getSnapshot;T=T.value;try{if(!mi(E(),T))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Go(a,c){for(c&=~Iv,c&=~lm,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var h=31-Cr(c),_=1<<h;a[h]=-1,c&=~_}}function QS(a){if((st&6)!==0)throw Error(t(327));Kc();var c=Ns(a,0);if((c&1)===0)return hr(a,Nt()),null;var h=pm(a,c);if(a.tag!==0&&h===2){var _=Ed(a);_!==0&&(c=_,h=Av(a,_))}if(h===1)throw h=eh,cl(a,0),Go(a,c),hr(a,Nt()),h;if(h===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,ul(a,dr,qs),hr(a,Nt()),null}function kv(a,c){var h=st;st|=1;try{return a(c)}finally{st=h,st===0&&(Wc=Nt()+500,qp&&Vo())}}function ll(a){qo!==null&&qo.tag===0&&(st&6)===0&&Kc();var c=st;st|=1;var h=Zr.transition,_=nt;try{if(Zr.transition=null,nt=1,a)return a()}finally{nt=_,Zr.transition=h,st=c,(st&6)===0&&Vo()}}function Rv(){Dr=zc.current,Rt(zc)}function cl(a,c){a.finishedWork=null,a.finishedLanes=0;var h=a.timeoutHandle;if(h!==-1&&(a.timeoutHandle=-1,HV(h)),on!==null)for(h=on.return;h!==null;){var _=h;switch(U_(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Up();break;case 3:Gc(),Rt(lr),Rt(Bn),X_();break;case 5:Q_(_);break;case 4:Gc();break;case 13:Rt(Ht);break;case 19:Rt(Ht);break;case 10:j_(_.type._context);break;case 22:case 23:Rv()}h=h.return}if(vn=a,on=a=$o(a.current,null),Dn=Dr=c,fn=0,eh=null,Iv=lm=al=0,dr=th=null,il!==null){for(c=0;c<il.length;c++)if(h=il[c],_=h.interleaved,_!==null){h.interleaved=null;var T=_.next,E=h.pending;if(E!==null){var C=E.next;E.next=T,_.next=C}h.pending=_}il=null}return a}function YS(a,c){do{var h=on;try{if($_(),Yp.current=tm,Xp){for(var _=Gt.memoizedState;_!==null;){var T=_.queue;T!==null&&(T.pending=null),_=_.next}Xp=!1}if(ol=0,_n=hn=Gt=null,Kd=!1,Jd=0,Ev.current=null,h===null||h.return===null){fn=1,eh=c,on=null;break}e:{var E=a,C=h.return,V=h,U=c;if(c=Dn,V.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var Y=U,ae=V,ce=ae.tag;if((ae.mode&1)===0&&(ce===0||ce===11||ce===15)){var se=ae.alternate;se?(ae.updateQueue=se.updateQueue,ae.memoizedState=se.memoizedState,ae.lanes=se.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var Te=ES(C);if(Te!==null){Te.flags&=-257,IS(Te,C,V,E,c),Te.mode&1&&TS(E,Y,c),c=Te,U=Y;var Se=c.updateQueue;if(Se===null){var Ae=new Set;Ae.add(U),c.updateQueue=Ae}else Se.add(U);break e}else{if((c&1)===0){TS(E,Y,c),bv();break e}U=Error(t(426))}}else if(Lt&&V.mode&1){var Zt=ES(C);if(Zt!==null){(Zt.flags&65536)===0&&(Zt.flags|=256),IS(Zt,C,V,E,c),H_($c(U,V));break e}}E=U=$c(U,V),fn!==4&&(fn=2),th===null?th=[E]:th.push(E),E=C;do{switch(E.tag){case 3:E.flags|=65536,c&=-c,E.lanes|=c;var z=vS(E,U,c);zx(E,z);break e;case 1:V=U;var H=E.type,J=E.stateNode;if((E.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Bo===null||!Bo.has(J)))){E.flags|=65536,c&=-c,E.lanes|=c;var he=wS(E,V,c);zx(E,he);break e}}E=E.return}while(E!==null)}eC(h)}catch(ke){c=ke,on===h&&h!==null&&(on=h=h.return);continue}break}while(!0)}function XS(){var a=am.current;return am.current=tm,a===null?tm:a}function bv(){(fn===0||fn===3||fn===2)&&(fn=4),vn===null||(al&268435455)===0&&(lm&268435455)===0||Go(vn,Dn)}function pm(a,c){var h=st;st|=2;var _=XS();(vn!==a||Dn!==c)&&(qs=null,cl(a,c));do try{fF();break}catch(T){YS(a,T)}while(!0);if($_(),st=h,am.current=_,on!==null)throw Error(t(261));return vn=null,Dn=0,fn}function fF(){for(;on!==null;)ZS(on)}function pF(){for(;on!==null&&!Ga();)ZS(on)}function ZS(a){var c=rC(a.alternate,a,Dr);a.memoizedProps=a.pendingProps,c===null?eC(a):on=c,Ev.current=null}function eC(a){var c=a;do{var h=c.alternate;if(a=c.return,(c.flags&32768)===0){if(h=oF(h,c,Dr),h!==null){on=h;return}}else{if(h=aF(h,c),h!==null){h.flags&=32767,on=h;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{fn=6,on=null;return}}if(c=c.sibling,c!==null){on=c;return}on=c=a}while(c!==null);fn===0&&(fn=5)}function ul(a,c,h){var _=nt,T=Zr.transition;try{Zr.transition=null,nt=1,mF(a,c,h,_)}finally{Zr.transition=T,nt=_}return null}function mF(a,c,h,_){do Kc();while(qo!==null);if((st&6)!==0)throw Error(t(327));h=a.finishedWork;var T=a.finishedLanes;if(h===null)return null;if(a.finishedWork=null,a.finishedLanes=0,h===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var E=h.lanes|h.childLanes;if(y_(a,E),a===vn&&(on=vn=null,Dn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||um||(um=!0,iC($a,function(){return Kc(),null})),E=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||E){E=Zr.transition,Zr.transition=null;var C=nt;nt=1;var V=st;st|=4,Ev.current=null,cF(a,h),$S(h,a),LV(b_),bs=!!R_,b_=R_=null,a.current=h,uF(h),As(),st=V,nt=C,Zr.transition=E}else a.current=h;if(um&&(um=!1,qo=a,dm=T),E=a.pendingLanes,E===0&&(Bo=null),Tp(h.stateNode),hr(a,Nt()),c!==null)for(_=a.onRecoverableError,h=0;h<c.length;h++)T=c[h],_(T.value,{componentStack:T.stack,digest:T.digest});if(cm)throw cm=!1,a=Sv,Sv=null,a;return(dm&1)!==0&&a.tag!==0&&Kc(),E=a.pendingLanes,(E&1)!==0?a===Cv?nh++:(nh=0,Cv=a):nh=0,Vo(),null}function Kc(){if(qo!==null){var a=Vi(dm),c=Zr.transition,h=nt;try{if(Zr.transition=null,nt=16>a?16:a,qo===null)var _=!1;else{if(a=qo,qo=null,dm=0,(st&6)!==0)throw Error(t(331));var T=st;for(st|=4,Ie=a.current;Ie!==null;){var E=Ie,C=E.child;if((Ie.flags&16)!==0){var V=E.deletions;if(V!==null){for(var U=0;U<V.length;U++){var Y=V[U];for(Ie=Y;Ie!==null;){var ae=Ie;switch(ae.tag){case 0:case 11:case 15:Zd(8,ae,E)}var ce=ae.child;if(ce!==null)ce.return=ae,Ie=ce;else for(;Ie!==null;){ae=Ie;var se=ae.sibling,Te=ae.return;if(US(ae),ae===Y){Ie=null;break}if(se!==null){se.return=Te,Ie=se;break}Ie=Te}}}var Se=E.alternate;if(Se!==null){var Ae=Se.child;if(Ae!==null){Se.child=null;do{var Zt=Ae.sibling;Ae.sibling=null,Ae=Zt}while(Ae!==null)}}Ie=E}}if((E.subtreeFlags&2064)!==0&&C!==null)C.return=E,Ie=C;else e:for(;Ie!==null;){if(E=Ie,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Zd(9,E,E.return)}var z=E.sibling;if(z!==null){z.return=E.return,Ie=z;break e}Ie=E.return}}var H=a.current;for(Ie=H;Ie!==null;){C=Ie;var J=C.child;if((C.subtreeFlags&2064)!==0&&J!==null)J.return=C,Ie=J;else e:for(C=H;Ie!==null;){if(V=Ie,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:om(9,V)}}catch(ke){Kt(V,V.return,ke)}if(V===C){Ie=null;break e}var he=V.sibling;if(he!==null){he.return=V.return,Ie=he;break e}Ie=V.return}}if(st=T,Vo(),Sr&&typeof Sr.onPostCommitFiberRoot=="function")try{Sr.onPostCommitFiberRoot(ja,a)}catch{}_=!0}return _}finally{nt=h,Zr.transition=c}}return!1}function tC(a,c,h){c=$c(h,c),c=vS(a,c,1),a=Oo(a,c,1),c=Zn(),a!==null&&(Ja(a,1,c),hr(a,c))}function Kt(a,c,h){if(a.tag===3)tC(a,a,h);else for(;c!==null;){if(c.tag===3){tC(c,a,h);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Bo===null||!Bo.has(_))){a=$c(h,a),a=wS(c,a,1),c=Oo(c,a,1),a=Zn(),c!==null&&(Ja(c,1,a),hr(c,a));break}}c=c.return}}function gF(a,c,h){var _=a.pingCache;_!==null&&_.delete(c),c=Zn(),a.pingedLanes|=a.suspendedLanes&h,vn===a&&(Dn&h)===h&&(fn===4||fn===3&&(Dn&130023424)===Dn&&500>Nt()-xv?cl(a,0):Iv|=h),hr(a,c)}function nC(a,c){c===0&&((a.mode&1)===0?c=1:(c=Co,Co<<=1,(Co&130023424)===0&&(Co=4194304)));var h=Zn();a=Os(a,c),a!==null&&(Ja(a,c,h),hr(a,h))}function yF(a){var c=a.memoizedState,h=0;c!==null&&(h=c.retryLane),nC(a,h)}function _F(a,c){var h=0;switch(a.tag){case 13:var _=a.stateNode,T=a.memoizedState;T!==null&&(h=T.retryLane);break;case 19:_=a.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(c),nC(a,h)}var rC;rC=function(a,c,h){if(a!==null)if(a.memoizedProps!==c.pendingProps||lr.current)ur=!0;else{if((a.lanes&h)===0&&(c.flags&128)===0)return ur=!1,sF(a,c,h);ur=(a.flags&131072)!==0}else ur=!1,Lt&&(c.flags&1048576)!==0&&Vx(c,Gp,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;im(a,c),a=c.pendingProps;var T=Vc(c,Bn.current);Hc(c,h),T=tv(null,c,_,a,T,h);var E=nv();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,cr(_)?(E=!0,Bp(c)):E=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,K_(c),T.updater=nm,c.stateNode=T,T._reactInternals=c,lv(c,_,a,h),c=hv(null,c,_,!0,E,h)):(c.tag=0,Lt&&E&&O_(c),Xn(null,c,T,h),c=c.child),c;case 16:_=c.elementType;e:{switch(im(a,c),a=c.pendingProps,T=_._init,_=T(_._payload),c.type=_,T=c.tag=wF(_),a=yi(_,a),T){case 0:c=dv(null,c,_,a,h);break e;case 1:c=kS(null,c,_,a,h);break e;case 11:c=xS(null,c,_,a,h);break e;case 14:c=SS(null,c,_,yi(_.type,a),h);break e}throw Error(t(306,_,""))}return c;case 0:return _=c.type,T=c.pendingProps,T=c.elementType===_?T:yi(_,T),dv(a,c,_,T,h);case 1:return _=c.type,T=c.pendingProps,T=c.elementType===_?T:yi(_,T),kS(a,c,_,T,h);case 3:e:{if(RS(c),a===null)throw Error(t(387));_=c.pendingProps,E=c.memoizedState,T=E.element,jx(a,c),Jp(c,_,null,h);var C=c.memoizedState;if(_=C.element,E.isDehydrated)if(E={element:_,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){T=$c(Error(t(423)),c),c=bS(a,c,_,h,T);break e}else if(_!==T){T=$c(Error(t(424)),c),c=bS(a,c,_,h,T);break e}else for(Pr=Do(c.stateNode.containerInfo.firstChild),br=c,Lt=!0,gi=null,h=Gx(c,null,_,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Uc(),_===T){c=Bs(a,c,h);break e}Xn(a,c,_,h)}c=c.child}return c;case 5:return Kx(c),a===null&&q_(c),_=c.type,T=c.pendingProps,E=a!==null?a.memoizedProps:null,C=T.children,P_(_,T)?C=null:E!==null&&P_(_,E)&&(c.flags|=32),NS(a,c),Xn(a,c,C,h),c.child;case 6:return a===null&&q_(c),null;case 13:return PS(a,c,h);case 4:return J_(c,c.stateNode.containerInfo),_=c.pendingProps,a===null?c.child=Bc(c,null,_,h):Xn(a,c,_,h),c.child;case 11:return _=c.type,T=c.pendingProps,T=c.elementType===_?T:yi(_,T),xS(a,c,_,T,h);case 7:return Xn(a,c,c.pendingProps,h),c.child;case 8:return Xn(a,c,c.pendingProps.children,h),c.child;case 12:return Xn(a,c,c.pendingProps.children,h),c.child;case 10:e:{if(_=c.type._context,T=c.pendingProps,E=c.memoizedProps,C=T.value,It(zp,_._currentValue),_._currentValue=C,E!==null)if(mi(E.value,C)){if(E.children===T.children&&!lr.current){c=Bs(a,c,h);break e}}else for(E=c.child,E!==null&&(E.return=c);E!==null;){var V=E.dependencies;if(V!==null){C=E.child;for(var U=V.firstContext;U!==null;){if(U.context===_){if(E.tag===1){U=Us(-1,h&-h),U.tag=2;var Y=E.updateQueue;if(Y!==null){Y=Y.shared;var ae=Y.pending;ae===null?U.next=U:(U.next=ae.next,ae.next=U),Y.pending=U}}E.lanes|=h,U=E.alternate,U!==null&&(U.lanes|=h),z_(E.return,h,c),V.lanes|=h;break}U=U.next}}else if(E.tag===10)C=E.type===c.type?null:E.child;else if(E.tag===18){if(C=E.return,C===null)throw Error(t(341));C.lanes|=h,V=C.alternate,V!==null&&(V.lanes|=h),z_(C,h,c),C=E.sibling}else C=E.child;if(C!==null)C.return=E;else for(C=E;C!==null;){if(C===c){C=null;break}if(E=C.sibling,E!==null){E.return=C.return,C=E;break}C=C.return}E=C}Xn(a,c,T.children,h),c=c.child}return c;case 9:return T=c.type,_=c.pendingProps.children,Hc(c,h),T=Yr(T),_=_(T),c.flags|=1,Xn(a,c,_,h),c.child;case 14:return _=c.type,T=yi(_,c.pendingProps),T=yi(_.type,T),SS(a,c,_,T,h);case 15:return CS(a,c,c.type,c.pendingProps,h);case 17:return _=c.type,T=c.pendingProps,T=c.elementType===_?T:yi(_,T),im(a,c),c.tag=1,cr(_)?(a=!0,Bp(c)):a=!1,Hc(c,h),yS(c,_,T),lv(c,_,T,h),hv(null,c,_,!0,a,h);case 19:return MS(a,c,h);case 22:return AS(a,c,h)}throw Error(t(156,c.tag))};function iC(a,c){return vd(a,c)}function vF(a,c,h,_){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(a,c,h,_){return new vF(a,c,h,_)}function Pv(a){return a=a.prototype,!(!a||!a.isReactComponent)}function wF(a){if(typeof a=="function")return Pv(a)?1:0;if(a!=null){if(a=a.$$typeof,a===O)return 11;if(a===dt)return 14}return 2}function $o(a,c){var h=a.alternate;return h===null?(h=ei(a.tag,c,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=c,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&14680064,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,c=a.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h}function mm(a,c,h,_,T,E){var C=2;if(_=a,typeof a=="function")Pv(a)&&(C=1);else if(typeof a=="string")C=5;else e:switch(a){case P:return dl(h.children,T,E,c);case k:C=8,T|=8;break;case b:return a=ei(12,h,c,T|2),a.elementType=b,a.lanes=E,a;case M:return a=ei(13,h,c,T),a.elementType=M,a.lanes=E,a;case $e:return a=ei(19,h,c,T),a.elementType=$e,a.lanes=E,a;case tt:return gm(h,T,E,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case F:C=10;break e;case D:C=9;break e;case O:C=11;break e;case dt:C=14;break e;case et:C=16,_=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=ei(C,h,c,T),c.elementType=a,c.type=_,c.lanes=E,c}function dl(a,c,h,_){return a=ei(7,a,_,c),a.lanes=h,a}function gm(a,c,h,_){return a=ei(22,a,_,c),a.elementType=tt,a.lanes=h,a.stateNode={isHidden:!1},a}function Dv(a,c,h){return a=ei(6,a,null,c),a.lanes=h,a}function Mv(a,c,h){return c=ei(4,a.children!==null?a.children:[],a.key,c),c.lanes=h,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function TF(a,c,h,_,T){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xd(0),this.expirationTimes=xd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xd(0),this.identifierPrefix=_,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Lv(a,c,h,_,T,E,C,V,U){return a=new TF(a,c,h,V,U),c===1?(c=1,E===!0&&(c|=8)):c=0,E=ei(3,null,null,c),a.current=E,E.stateNode=a,E.memoizedState={element:_,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},K_(E),a}function EF(a,c,h){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ee,key:_==null?null:""+_,children:a,containerInfo:c,implementation:h}}function sC(a){if(!a)return Lo;a=a._reactInternals;e:{if(fi(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(cr(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var h=a.type;if(cr(h))return Dx(a,h,c)}return c}function oC(a,c,h,_,T,E,C,V,U){return a=Lv(h,_,!0,a,T,E,C,V,U),a.context=sC(null),h=a.current,_=Zn(),T=Ho(h),E=Us(_,T),E.callback=c??null,Oo(h,E,T),a.current.lanes=T,Ja(a,T,_),hr(a,_),a}function ym(a,c,h,_){var T=c.current,E=Zn(),C=Ho(T);return h=sC(h),c.context===null?c.context=h:c.pendingContext=h,c=Us(E,C),c.payload={element:a},_=_===void 0?null:_,_!==null&&(c.callback=_),a=Oo(T,c,C),a!==null&&(wi(a,T,C,E),Kp(a,T,C)),C}function _m(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function aC(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<c?h:c}}function Vv(a,c){aC(a,c),(a=a.alternate)&&aC(a,c)}function IF(){return null}var lC=typeof reportError=="function"?reportError:function(a){console.error(a)};function Fv(a){this._internalRoot=a}vm.prototype.render=Fv.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));ym(a,c,null,null)},vm.prototype.unmount=Fv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ll(function(){ym(null,a,null,null)}),c[Ms]=null}};function vm(a){this._internalRoot=a}vm.prototype.unstable_scheduleHydration=function(a){if(a){var c=Nd();a={blockedOn:null,target:a,priority:c};for(var h=0;h<Ar.length&&c!==0&&c<Ar[h].priority;h++);Ar.splice(h,0,a),h===0&&wc(a)}};function Ov(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function wm(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function cC(){}function xF(a,c,h,_,T){if(T){if(typeof _=="function"){var E=_;_=function(){var Y=_m(C);E.call(Y)}}var C=oC(c,_,a,0,null,!1,!1,"",cC);return a._reactRootContainer=C,a[Ms]=C.current,Bd(a.nodeType===8?a.parentNode:a),ll(),C}for(;T=a.lastChild;)a.removeChild(T);if(typeof _=="function"){var V=_;_=function(){var Y=_m(U);V.call(Y)}}var U=Lv(a,0,!1,null,null,!1,!1,"",cC);return a._reactRootContainer=U,a[Ms]=U.current,Bd(a.nodeType===8?a.parentNode:a),ll(function(){ym(c,U,h,_)}),U}function Tm(a,c,h,_,T){var E=h._reactRootContainer;if(E){var C=E;if(typeof T=="function"){var V=T;T=function(){var U=_m(C);V.call(U)}}ym(c,C,a,T)}else C=xF(h,c,a,T,_);return _m(C)}Cd=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var h=ht(c.pendingLanes);h!==0&&(Sd(c,h|1),hr(c,Nt()),(st&6)===0&&(Wc=Nt()+500,Vo()))}break;case 13:ll(function(){var _=Os(a,1);if(_!==null){var T=Zn();wi(_,a,1,T)}}),Vv(a,1)}},_c=function(a){if(a.tag===13){var c=Os(a,134217728);if(c!==null){var h=Zn();wi(c,a,134217728,h)}Vv(a,134217728)}},Ad=function(a){if(a.tag===13){var c=Ho(a),h=Os(a,c);if(h!==null){var _=Zn();wi(h,a,c,_)}Vv(a,c)}},Nd=function(){return nt},kd=function(a,c){var h=nt;try{return nt=a,c()}finally{nt=h}},di=function(a,c,h){switch(c){case"input":if(Ts(a,h),c=h.name,h.type==="radio"&&c!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var _=h[c];if(_!==a&&_.form===a.form){var T=Op(_);if(!T)throw Error(t(90));ft(_),Ts(_,T)}}}break;case"textarea":Oa(a,h);break;case"select":c=h.value,c!=null&&ar(a,!!h.multiple,c,!1)}},xr=kv,Eo=ll;var SF={usingClientEntryPoint:!1,Events:[Gd,Mc,Op,yn,zr,kv]},rh={findFiberByHostInstance:el,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CF={bundleType:rh.bundleType,version:rh.version,rendererPackageName:rh.rendererPackageName,rendererConfig:rh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:K.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=wp(a),a===null?null:a.stateNode},findFiberByHostInstance:rh.findFiberByHostInstance||IF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{ja=Em.inject(CF),Sr=Em}catch{}}return fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SF,fr.createPortal=function(a,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ov(c))throw Error(t(200));return EF(a,c,null,h)},fr.createRoot=function(a,c){if(!Ov(a))throw Error(t(299));var h=!1,_="",T=lC;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(_=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=Lv(a,1,!1,null,null,h,!1,_,T),a[Ms]=c.current,Bd(a.nodeType===8?a.parentNode:a),new Fv(c)},fr.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=wp(c),a=a===null?null:a.stateNode,a},fr.flushSync=function(a){return ll(a)},fr.hydrate=function(a,c,h){if(!wm(c))throw Error(t(200));return Tm(null,a,c,!0,h)},fr.hydrateRoot=function(a,c,h){if(!Ov(a))throw Error(t(405));var _=h!=null&&h.hydratedSources||null,T=!1,E="",C=lC;if(h!=null&&(h.unstable_strictMode===!0&&(T=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onRecoverableError!==void 0&&(C=h.onRecoverableError)),c=oC(c,null,a,1,h??null,T,!1,E,C),a[Ms]=c.current,Bd(a),_)for(a=0;a<_.length;a++)h=_[a],T=h._getVersion,T=T(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,T]:c.mutableSourceEagerHydrationData.push(h,T);return new vm(c)},fr.render=function(a,c,h){if(!wm(c))throw Error(t(200));return Tm(null,a,c,!1,h)},fr.unmountComponentAtNode=function(a){if(!wm(a))throw Error(t(40));return a._reactRootContainer?(ll(function(){Tm(null,null,a,!1,function(){a._reactRootContainer=null,a[Ms]=null})}),!0):!1},fr.unstable_batchedUpdates=kv,fr.unstable_renderSubtreeIntoContainer=function(a,c,h,_){if(!wm(h))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Tm(a,c,h,!1,_)},fr.version="18.3.1-next-f1338f8080-20240426",fr}var vC;function OF(){if(vC)return qv.exports;vC=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qv.exports=FF(),qv.exports}var wC;function UF(){if(wC)return xm;wC=1;var n=OF();return xm.createRoot=n.createRoot,xm.hydrateRoot=n.hydrateRoot,xm}var BF=UF();const hb=db(BF);var Tn=(n=>(n.Jobs="JOBS",n.Insurance="INSURANCE",n.Messaging="MESSAGING",n.Chatbot="CHATBOT",n.Profile="PROFILE",n.Recommendations="RECOMMENDATIONS",n))(Tn||{}),El=(n=>(n.User="USER",n.Bot="BOT",n))(El||{}),$t=(n=>(n.Worker="WORKER",n.Employer="EMPLOYER",n))($t||{}),$s=(n=>(n.NEW_APPLICATION="NEW_APPLICATION",n.NEW_JOB_MATCH="NEW_JOB_MATCH",n.APPLICATION_ACCEPTED="APPLICATION_ACCEPTED",n.APPLICATION_REJECTED="APPLICATION_REJECTED",n))($s||{});const fs=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Ks=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),ey=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),qF=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Cw=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Aw=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),HF=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),Yo=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.75 18l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 14.25l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 18l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),Na=({className:n="w-8 h-8"})=>y.jsx("div",{className:`flex items-center justify-center rounded-full bg-blue-500 text-white ${n}`,children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),X0=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),fb=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),GF=({type:n})=>{const e="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0";switch(n){case $s.NEW_APPLICATION:return y.jsx("div",{className:`${e} bg-blue-100 text-blue-600`,children:y.jsx(Na,{className:"w-5 h-5 bg-transparent"})});case $s.NEW_JOB_MATCH:return y.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:y.jsx(fs,{className:"w-5 h-5"})});case $s.APPLICATION_ACCEPTED:return y.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:y.jsx(X0,{className:"w-6 h-6"})});case $s.APPLICATION_REJECTED:return y.jsx("div",{className:`${e} bg-red-100 text-red-600`,children:y.jsx(fb,{className:"w-6 h-6"})});default:return y.jsx("div",{className:`${e} bg-gray-100 text-gray-600`,children:y.jsx(fs,{className:"w-5 h-5"})})}},$F=({notifications:n,onNotificationClick:e,onMarkAllAsRead:t,onClose:r})=>{const i=n.filter(s=>!s.isRead).length;return y.jsx("div",{className:"fixed inset-0 z-40",onClick:r,children:y.jsxs("div",{className:"absolute top-20 right-4 sm:right-6 lg:right-8 w-full max-w-sm bg-white rounded-lg shadow-2xl border border-gray-200 overflow-hidden animate-fade-in-down z-50",style:{animationDuration:"0.2s"},onClick:s=>s.stopPropagation(),children:[y.jsxs("div",{className:"p-4 flex items-center justify-between border-b",children:[y.jsx("h3",{className:"font-bold text-gray-800",children:"Thng bo"}),i>0&&y.jsx("button",{onClick:t,className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"nh du tt c l  c"})]}),y.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.length>0?n.map(s=>y.jsxs("div",{onClick:()=>e(s),className:`flex items-start gap-4 p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b ${s.isRead?"bg-white":"bg-indigo-50"}`,children:[y.jsx(GF,{type:s.type}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm text-gray-700",children:s.message}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.createdAt).toLocaleString("vi-VN")})]}),!s.isRead&&y.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full mt-1 flex-shrink-0"})]},s.id)):y.jsx("div",{className:"p-10 text-center text-gray-500",children:y.jsx("p",{children:"Bn khng c thng bo no."})})})]})})},jF=()=>{};var TC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de=function(n,e){if(!n)throw Qu(e)},Qu=function(n){return new Error("Firebase Database ("+pb.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},zF=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Z0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,p=s>>2,v=(s&3)<<4|l>>4;let w=(l&15)<<2|d>>6,x=d&63;u||(x=64,o||(w=64)),r.push(t[p],t[v],t[w],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(mb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):zF(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const v=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||d==null||v==null)throw new WF;const w=s<<2|l>>4;if(r.push(w),d!==64){const x=l<<4&240|d>>2;if(r.push(x),v!==64){const A=d<<6&192|v;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class WF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gb=function(n){const e=mb(n);return Z0.encodeByteArray(e,!0)},ng=function(n){return gb(n).replace(/\./g,"")},Zh=function(n){try{return Z0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(n){return ef(void 0,n)}function ef(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!JF(t)||(n[t]=ef(n[t],e[t]));return n}function JF(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF=()=>eT().__FIREBASE_DEFAULTS__,YF=()=>{if(typeof process>"u"||typeof TC>"u")return;const n=TC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},XF=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Zh(n[1]);return e&&JSON.parse(e)},tT=()=>{try{return jF()||QF()||YF()||XF()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nT=()=>{var n;return(n=tT())==null?void 0:n.config},ZF=n=>{var e;return(e=tT())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rT(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ng(JSON.stringify(t)),ng(JSON.stringify(o)),""].join(".")}const bh={};function e5(){const n={prod:[],emulator:[]};for(const e of Object.keys(bh))bh[e]?n.emulator.push(e):n.prod.push(e);return n}function t5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let EC=!1;function iT(n,e){if(typeof window>"u"||typeof document>"u"||!ka(window.location.host)||bh[n]===e||bh[n]||EC)return;bh[n]=e;function t(w){return`__firebase__banner__${w}`}const r="__firebase__banner",s=e5().prod.length>0;function o(){const w=document.getElementById(r);w&&w.remove()}function l(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function u(w,x){w.setAttribute("width","24"),w.setAttribute("id",x),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function d(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{EC=!0,o()},w}function p(w,x){w.setAttribute("id",x),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function v(){const w=t5(r),x=t("text"),A=document.getElementById(x)||document.createElement("span"),R=t("learnmore"),L=document.getElementById(R)||document.createElement("a"),j=t("preprendIcon"),B=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const q=w.element;l(q),p(L,R);const K=d();u(B,j),q.append(B,A,L,K),document.body.appendChild(q)}s?(A.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zt())}function ty(){var e;const n=(e=tT())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n5(){return typeof window<"u"||_b()}function _b(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function r5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vb(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ny(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wb(){const n=zt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function i5(){return pb.NODE_ADMIN===!0}function Tb(){return!ty()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Eb(){return!ty()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Dl(){try{return typeof indexedDB=="object"}catch{return!1}}function s5(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}function o5(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5="FirebaseError";class Kn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=a5,Object.setPrototypeOf(this,Kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vs.prototype.create)}}class vs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?l5(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Kn(i,l,r)}}function l5(n,e){return n.replace(c5,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const c5=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(n){return JSON.parse(n)}function pn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=tf(Zh(s[0])||""),t=tf(Zh(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},u5=function(n){const e=Ib(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},d5=function(n){const e=Ib(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ml(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function rg(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ig(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Xs(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(IC(s)&&IC(o)){if(!Xs(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function IC(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Eh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let v=0;v<16;v++)r[v]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let v=0;v<16;v++)r[v]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let v=16;v<80;v++){const w=r[v-3]^r[v-8]^r[v-14]^r[v-16];r[v]=(w<<1|w>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],u=this.chain_[4],d,p;for(let v=0;v<80;v++){v<40?v<20?(d=l^s&(o^l),p=1518500249):(d=s^o^l,p=1859775393):v<60?(d=s&o|l&(s|o),p=2400959708):(d=s^o^l,p=3395469782);const w=(i<<5|i>>>27)+d+u+p+r[v]&4294967295;u=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=w}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function xb(n,e){const t=new f5(n,e);return t.subscribe.bind(t)}class f5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");p5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=$v),i.error===void 0&&(i.error=$v),i.complete===void 0&&(i.complete=$v);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function p5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $v(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ve=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){const s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function wr(n,e){return`${n} failed: ${e} argument `}function xn(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(wr(n,e)+"must be a valid function.")}function xC(n,e,t,r){if(t&&(typeof t!="object"||t===null))throw new Error(wr(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,de(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ry=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(n){return n&&n._delegate?n._delegate:n}class un{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new gr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y5(e))try{this.getOrInitializeService({instanceIdentifier:fl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=fl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fl){return this.instances.has(e)}getOptions(e=fl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:g5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fl){return this.component?this.component.multipleInstances?e:fl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function g5(n){return n===fl?void 0:n}function y5(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Nw(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=[];var Je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Je||(Je={}));const Sb={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},_5=Je.INFO,v5={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},w5=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=v5[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yu{constructor(e){this.name=e,this._logLevel=_5,this._logHandler=w5,this._userLogHandler=null,aT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Sb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}function T5(n){aT.forEach(e=>{e.setLogLevel(n)})}function E5(n,e){for(const t of aT){let r=null;e&&e.level&&(r=Sb[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{const l=o.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");s>=(r??i.logLevel)&&n({level:Je[s].toLowerCase(),message:l,args:o,type:i.name})}}}const I5=(n,e)=>e.some(t=>n instanceof t);let SC,CC;function x5(){return SC||(SC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function S5(){return CC||(CC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Cb=new WeakMap,kw=new WeakMap,Ab=new WeakMap,jv=new WeakMap,lT=new WeakMap;function C5(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Js(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Cb.set(t,n)}).catch(()=>{}),lT.set(e,n),e}function A5(n){if(kw.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});kw.set(n,e)}let Rw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return kw.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ab.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Js(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function N5(n){Rw=n(Rw)}function k5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(zv(this),e,...t);return Ab.set(r,e.sort?e.sort():[e]),Js(r)}:S5().includes(n)?function(...e){return n.apply(zv(this),e),Js(Cb.get(this))}:function(...e){return Js(n.apply(zv(this),e))}}function R5(n){return typeof n=="function"?k5(n):(n instanceof IDBTransaction&&A5(n),I5(n,x5())?new Proxy(n,Rw):n)}function Js(n){if(n instanceof IDBRequest)return C5(n);if(jv.has(n))return jv.get(n);const e=R5(n);return e!==n&&(jv.set(n,e),lT.set(e,n)),e}const zv=n=>lT.get(n);function Xu(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Js(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Js(o.result),u.oldVersion,u.newVersion,Js(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function uu(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),Js(t).then(()=>{})}const b5=["get","getKey","getAll","getAllKeys","count"],P5=["put","add","delete","clear"],Wv=new Map;function AC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Wv.get(e))return Wv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=P5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||b5.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),i&&u.done]))[0]};return Wv.set(e,s),s}N5(n=>({...n,get:(e,t,r)=>AC(e,t)||n.get(e,t,r),has:(e,t)=>!!AC(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(M5(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function M5(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sg="@firebase/app",bw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=new Yu("@firebase/app"),L5="@firebase/app-compat",V5="@firebase/analytics-compat",F5="@firebase/analytics",O5="@firebase/app-check-compat",U5="@firebase/app-check",B5="@firebase/auth",q5="@firebase/auth-compat",H5="@firebase/database",G5="@firebase/data-connect",$5="@firebase/database-compat",j5="@firebase/functions",z5="@firebase/functions-compat",W5="@firebase/installations",K5="@firebase/installations-compat",J5="@firebase/messaging",Q5="@firebase/messaging-compat",Y5="@firebase/performance",X5="@firebase/performance-compat",Z5="@firebase/remote-config",eO="@firebase/remote-config-compat",tO="@firebase/storage",nO="@firebase/storage-compat",rO="@firebase/firestore",iO="@firebase/ai",sO="@firebase/firestore-compat",oO="firebase",aO="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]",lO={[sg]:"fire-core",[L5]:"fire-core-compat",[F5]:"fire-analytics",[V5]:"fire-analytics-compat",[U5]:"fire-app-check",[O5]:"fire-app-check-compat",[B5]:"fire-auth",[q5]:"fire-auth-compat",[H5]:"fire-rtdb",[G5]:"fire-data-connect",[$5]:"fire-rtdb-compat",[j5]:"fire-fn",[z5]:"fire-fn-compat",[W5]:"fire-iid",[K5]:"fire-iid-compat",[J5]:"fire-fcm",[Q5]:"fire-fcm-compat",[Y5]:"fire-perf",[X5]:"fire-perf-compat",[Z5]:"fire-rc",[eO]:"fire-rc-compat",[tO]:"fire-gcs",[nO]:"fire-gcs-compat",[rO]:"fire-fst",[sO]:"fire-fst-compat",[iO]:"fire-vertex","fire-js":"fire-js",[oO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Map,Eu=new Map,Iu=new Map;function nf(n,e){try{n.container.addComponent(e)}catch(t){Zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nb(n,e){n.container.addOrOverwriteComponent(e)}function Tr(n){const e=n.name;if(Iu.has(e))return Zs.debug(`There were multiple attempts to register component ${e}.`),!1;Iu.set(e,n);for(const t of pa.values())nf(t,n);for(const t of Eu.values())nf(t,n);return!0}function iy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function cO(n,e,t=fa){iy(n,e).clearInstance(t)}function cT(n){return n.options!==void 0}function kb(n){return cT(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Mt(n){return n==null?!1:n.settings!==void 0}function uO(){Iu.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Br=new vs("app","Firebase",dO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rb=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Br.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(n,e){const t=Zh(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,s=new Date().getTime();i-s<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class hO extends Rb{constructor(e,t,r,i){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const l=e;super(l.options,o,i)}this._serverConfig={automaticDataCollectionEnabled:s,...t},this._serverConfig.authIdToken&&NC(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&NC(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Vn(sg,bw,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){dT(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Br.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=aO;function uT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:fa,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Br.create("bad-app-name",{appName:String(i)});if(t||(t=nT()),!t)throw Br.create("no-options");const s=pa.get(i);if(s){if(Xs(t,s.options)&&Xs(r,s.config))return s;throw Br.create("duplicate-app",{appName:i})}const o=new oT(i);for(const u of Iu.values())o.addComponent(u);const l=new Rb(t,r,o);return pa.set(i,l),l}function fO(n,e={}){if(n5()&&!_b())throw Br.create("invalid-server-app-environment");let t,r=e||{};if(n&&(cT(n)?t=n.options:kb(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=nT()),!t)throw Br.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const s=p=>[...p].reduce((v,w)=>Math.imul(31,v)+w.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Br.create("finalization-registry-not-supported",{});const o=""+s(JSON.stringify(i)),l=Eu.get(o);if(l)return l.incRefCount(r.releaseOnDeref),l;const u=new oT(o);for(const p of Iu.values())u.addComponent(p);const d=new hO(t,r,o,u);return Eu.set(o,d),d}function pO(n=fa){const e=pa.get(n);if(!e&&n===fa&&nT())return uT();if(!e)throw Br.create("no-app",{appName:n});return e}function mO(){return Array.from(pa.values())}async function dT(n){let e=!1;const t=n.name;pa.has(t)?(e=!0,pa.delete(t)):Eu.has(t)&&n.decRefCount()<=0&&(Eu.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Vn(n,e,t){let r=lO[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zs.warn(o.join(" "));return}Tr(new un(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function bb(n,e){if(n!==null&&typeof n!="function")throw Br.create("invalid-log-argument");E5(n,e)}function Pb(n){T5(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO="firebase-heartbeat-database",yO=1,rf="firebase-heartbeat-store";let Kv=null;function Db(){return Kv||(Kv=Xu(gO,yO,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(rf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Br.create("idb-open",{originalErrorMessage:n.message})})),Kv}async function _O(n){try{const t=(await Db()).transaction(rf),r=await t.objectStore(rf).get(Mb(n));return await t.done,r}catch(e){if(e instanceof Kn)Zs.warn(e.message);else{const t=Br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zs.warn(t.message)}}}async function kC(n,e){try{const r=(await Db()).transaction(rf,"readwrite");await r.objectStore(rf).put(e,Mb(n)),await r.done}catch(t){if(t instanceof Kn)Zs.warn(t.message);else{const r=Br.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Zs.warn(r.message)}}}function Mb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=1024,wO=30;class TO{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new IO(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=RC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>wO){const o=xO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Zs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=RC(),{heartbeatsToSend:r,unsentEntries:i}=EO(this._heartbeatsCache.heartbeats),s=ng(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Zs.warn(t),""}}}function RC(){return new Date().toISOString().substring(0,10)}function EO(n,e=vO){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),bC(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),bC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class IO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Dl()?s5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _O(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function bC(n){return ng(JSON.stringify({version:2,heartbeats:n})).length}function xO(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SO(n){Tr(new un("platform-logger",e=>new D5(e),"PRIVATE")),Tr(new un("heartbeat",e=>new TO(e),"PRIVATE")),Vn(sg,bw,n),Vn(sg,bw,"esm2020"),Vn("fire-js","")}SO("");const CO=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Kn,SDK_VERSION:oo,_DEFAULT_ENTRY_NAME:fa,_addComponent:nf,_addOrOverwriteComponent:Nb,_apps:pa,_clearComponents:uO,_components:Iu,_getProvider:iy,_isFirebaseApp:cT,_isFirebaseServerApp:Mt,_isFirebaseServerAppSettings:kb,_registerComponent:Tr,_removeServiceInstance:cO,_serverApps:Eu,deleteApp:dT,getApp:pO,getApps:mO,initializeApp:uT,initializeServerApp:fO,onLog:bb,registerVersion:Vn,setLogLevel:Pb},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,t){this._delegate=e,this.firebase=t,nf(e,new un("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),dT(this._delegate)))}_getService(e,t=fa){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=fa){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){nf(this._delegate,e)}_addOrOverwriteComponent(e){Nb(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},PC=new vs("app-compat","Firebase",NO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kO(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Vn,setLogLevel:Pb,onLog:bb,apps:null,SDK_VERSION:oo,INTERNAL:{registerComponent:l,removeApp:r,useAsService:u,modularAPIs:CO}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(d){delete e[d]}function i(d){if(d=d||fa,!qr(e,d))throw PC.create("no-app",{appName:d});return e[d]}i.App=n;function s(d,p={}){const v=uT(d,p);if(qr(e,v.name))return e[v.name];const w=new n(v,t);return e[v.name]=w,w}function o(){return Object.keys(e).map(d=>e[d])}function l(d){const p=d.name,v=p.replace("-compat","");if(Tr(d)&&d.type==="PUBLIC"){const w=(x=i())=>{if(typeof x[v]!="function")throw PC.create("invalid-app-argument",{appName:p});return x[v]()};d.serviceProps!==void 0&&ef(w,d.serviceProps),t[v]=w,n.prototype[v]=function(...x){return this._getService.bind(this,p).apply(this,d.multipleInstances?x:[])}}return d.type==="PUBLIC"?t[v]:null}function u(d,p){return p==="serverAuth"?null:p}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(){const n=kO(AO);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:Lb,extendNamespace:e,createSubscribe:xb,ErrorFactory:vs,deepExtend:ef};function e(t){ef(n,t)}return n}const RO=Lb();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC=new Yu("@firebase/app-compat"),bO="@firebase/app-compat",PO="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){Vn(bO,PO,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=eT();if(n.firebase!==void 0){DC.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&DC.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const tn=RO;DO();var MO="firebase",LO="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tn.registerVersion(MO,LO,"app-compat");const sh={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Jc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function Vb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FO=VO,OO=Vb,Fb=new vs("auth","Firebase",Vb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=new Yu("@firebase/auth");function UO(n,...e){og.logLevel<=Je.WARN&&og.warn(`Auth (${oo}): ${n}`,...e)}function Fm(n,...e){og.logLevel<=Je.ERROR&&og.error(`Auth (${oo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(n,...e){throw fT(n,...e)}function mn(n,...e){return fT(n,...e)}function hT(n,e,t){const r={...OO(),[e]:t};return new vs("auth","Firebase",r).create(e,{appName:n.name})}function An(n){return hT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Zu(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&On(n,"argument-error"),hT(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function fT(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Fb.create(n,...e)}function le(n,e,...t){if(!n)throw fT(e,...t)}function ns(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Fm(e),new Error(e)}function Ni(n,e){n||ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function pT(){return MC()==="http:"||MC()==="https:"}function MC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pT()||vb()||"connection"in navigator)?navigator.onLine:!0}function qO(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ni(t>e,"Short delay should be less than long delay!"),this.isMobile=sT()||ny()}get(){return BO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(n,e){Ni(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$O=new Lf(3e4,6e4);function Qt(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Yt(n,e,t,r,i={}){return Ub(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=nc({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...s};return r5()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&ka(n.emulatorConfig.host)&&(d.credentials="include"),Ob.fetch()(await Bb(n,n.config.apiHost,t,l),d)})}async function Ub(n,e,t){n._canInitEmulator=!1;const r={...HO,...e};try{const i=new zO(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ih(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ih(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ih(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ih(n,"user-disabled",o);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw hT(n,p,d);On(n,p)}}catch(i){if(i instanceof Kn)throw i;On(n,"network-request-failed",{message:String(i)})}}async function ao(n,e,t,r,i={}){const s=await Yt(n,e,t,r,i);return"mfaPendingCredential"in s&&On(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Bb(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?mT(n.config,i):`${n.config.apiScheme}://${i}`;return GO.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function jO(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(mn(this.auth,"network-request-failed")),$O.get())})}}function Ih(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=mn(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(n){return n!==void 0&&n.getResponse!==void 0}function VC(n){return n!==void 0&&n.enterprise!==void 0}class qb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jO(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WO(n){return(await Yt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Hb(n,e){return Yt(n,"GET","/v2/recaptchaConfig",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KO(n,e){return Yt(n,"POST","/v1/accounts:delete",e)}async function JO(n,e){return Yt(n,"POST","/v1/accounts:update",e)}async function ag(n,e){return Yt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QO(n,e=!1){const t=Ee(n),r=await t.getIdToken(e),i=sy(r);le(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ph(Jv(i.auth_time)),issuedAtTime:Ph(Jv(i.iat)),expirationTime:Ph(Jv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Jv(n){return Number(n)*1e3}function sy(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Fm("JWT malformed, contained fewer than 3 sections"),null;try{const i=Zh(t);return i?JSON.parse(i):(Fm("Failed to decode base64 JWT payload"),null)}catch(i){return Fm("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function FC(n){const e=sy(n);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Kn&&YO(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function YO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ph(this.lastLoginAt),this.creationTime=Ph(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function of(n){var v;const e=n.auth,t=await n.getIdToken(),r=await eo(n,ag(e,{idToken:t}));le(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=(v=i.providerUserInfo)!=null&&v.length?Gb(i.providerUserInfo):[],o=e4(n.providerData,s),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Pw(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,p)}async function ZO(n){const e=Ee(n);await of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function e4(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Gb(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4(n,e){const t=await Ub(n,{},async()=>{const r=nc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Bb(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return n.emulatorConfig&&ka(n.emulatorConfig.host)&&(u.credentials="include"),Ob.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function n4(n,e){return Yt(n,"POST","/v2/accounts:revokeToken",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):FC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){le(e.length!==0,"internal-error");const t=FC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await t4(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new du;return r&&(le(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(le(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(le(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new du,this.toJSON())}_performRefresh(){return ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(n,e){le(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ii{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new XO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Pw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await eo(this,this.stsTokenManager.getToken(this.auth,e));return le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return QO(this,e)}reload(){return ZO(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ii({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await of(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mt(this.auth.app))return Promise.reject(An(this.auth));const e=await this.getIdToken();return await eo(this,KO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:v,emailVerified:w,isAnonymous:x,providerData:A,stsTokenManager:R}=t;le(v&&R,e,"internal-error");const L=du.fromJSON(this.name,R);le(typeof v=="string",e,"internal-error"),zo(r,e.name),zo(i,e.name),le(typeof w=="boolean",e,"internal-error"),le(typeof x=="boolean",e,"internal-error"),zo(s,e.name),zo(o,e.name),zo(l,e.name),zo(u,e.name),zo(d,e.name),zo(p,e.name);const j=new Ii({uid:v,auth:e,email:i,emailVerified:w,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:L,createdAt:d,lastLoginAt:p});return A&&Array.isArray(A)&&(j.providerData=A.map(B=>({...B}))),u&&(j._redirectEventId=u),j}static async _fromIdTokenResponse(e,t,r=!1){const i=new du;i.updateFromServerResponse(t);const s=new Ii({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await of(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];le(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Gb(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new du;l.updateFromIdToken(r);const u=new Ii({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Pw(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Map;function Ur(n){Ni(n instanceof Function,"Expected a class definition");let e=OC.get(n);return e?(Ni(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,OC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$b.type="NONE";const xu=$b;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(n,e,t){return`firebase:${n}:${e}:${t}`}class hu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=kl(this.userKey,i.apiKey,s),this.fullPersistenceKey=kl("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ag(this.auth,{idToken:e}).catch(()=>{});return t?Ii._fromGetAccountInfoResponse(this.auth,t,e):null}return Ii._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new hu(Ur(xu),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ur(xu);const o=kl(r,e.config.apiKey,e.name);let l=null;for(const d of t)try{const p=await d._get(o);if(p){let v;if(typeof p=="string"){const w=await ag(e,{idToken:p}).catch(()=>{});if(!w)break;v=await Ii._fromGetAccountInfoResponse(e,w,p)}else v=Ii._fromJSON(e,p);d!==s&&(l=v),s=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new hu(s,e,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new hu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Kb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Jb(e))return"Blackberry";if(Qb(e))return"Webos";if(zb(e))return"Safari";if((e.includes("chrome/")||Wb(e))&&!e.includes("edge/"))return"Chrome";if(Vf(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function jb(n=zt()){return/firefox\//i.test(n)}function zb(n=zt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Wb(n=zt()){return/crios\//i.test(n)}function Kb(n=zt()){return/iemobile/i.test(n)}function Vf(n=zt()){return/android/i.test(n)}function Jb(n=zt()){return/blackberry/i.test(n)}function Qb(n=zt()){return/webos/i.test(n)}function Ff(n=zt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function r4(n=zt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function i4(n=zt()){var e;return Ff(n)&&!!((e=window.navigator)!=null&&e.standalone)}function s4(){return wb()&&document.documentMode===10}function Yb(n=zt()){return Ff(n)||Vf(n)||Qb(n)||Jb(n)||/windows phone/i.test(n)||Kb(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(n,e=[]){let t;switch(n){case"Browser":t=UC(zt());break;case"Worker":t=`${UC(zt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${oo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a4(n,e={}){return Yt(n,"GET","/v2/passwordPolicy",Qt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=6;class c4{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??l4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BC(this),this.idTokenSubscription=new BC(this),this.beforeStateQueue=new o4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ur(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await hu.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ag(this,{idToken:e}),r=await Ii._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Mt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,l=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await of(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mt(this.app))return Promise.reject(An(this));const t=e?Ee(e):null;return t&&le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mt(this.app)?Promise.reject(An(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mt(this.app)?Promise.reject(An(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await a4(this),t=new c4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vs("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await n4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ur(e)||this._popupRedirectResolver;le(t,this,"argument-error"),this.redirectPersistenceManager=await hu.create(this,[Ur(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Xb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Mt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&UO(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Wt(n){return Ee(n)}class BC{constructor(e){this.auth=e,this.observer=null,this.addObserver=xb(t=>this.observer=t)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function d4(n){Of=n}function gT(n){return Of.loadJS(n)}function h4(){return Of.recaptchaV2Script}function f4(){return Of.recaptchaEnterpriseScript}function p4(){return Of.gapiScript}function Zb(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=500,g4=6e4,Sm=1e12;class y4{constructor(e){this.auth=e,this.counter=Sm,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new w4(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||Sm;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||Sm;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||Sm;return(r=this._widgets.get(t))==null||r.execute(),""}}class _4{constructor(){this.enterprise=new v4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class v4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class w4{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;le(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=T4(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},g4)},m4))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function T4(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const E4="recaptcha-enterprise",Dh="NO_RECAPTCHA";class eP{constructor(e){this.type=E4,this.auth=Wt(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Hb(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new qb(u);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function i(s,o,l){const u=window.grecaptcha;VC(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(Dh)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _4().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&VC(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=f4();u.length!==0&&(u+=l),gT(u).then(()=>{i(l,s,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function oh(n,e,t,r=!1,i=!1){const s=new eP(n);let o;if(i)o=Dh;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const l={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function oa(n,e,t,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await oh(n,e,t,t==="getOobCode");return r(n,l)}else return r(n,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await oh(n,e,t,t==="getOobCode");return r(n,u)}else return Promise.reject(l)});else if(i==="PHONE_PROVIDER")if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await oh(n,e,t);return r(n,l).catch(async u=>{var d;if(((d=n._getRecaptchaConfig())==null?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const p=await oh(n,e,t,!1,!0);return r(n,p)}return Promise.reject(u)})}else{const l=await oh(n,e,t,!1,!0);return r(n,l)}else return Promise.reject(i+" provider is not supported.")}async function I4(n){const e=Wt(n),t=await Hb(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new qb(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new eP(e).verify()}function x4(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ur);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function S4(n,e,t){const r=Wt(n);le(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=tP(e),{host:o,port:l}=C4(e),u=l===null?"":`:${l}`,d={url:`${s}//${o}${u}/`},p=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){le(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),le(Xs(d,r.config.emulator)&&Xs(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,ka(o)?(rT(`${s}//${o}${u}`),iT("Auth",!0)):i||A4()}function tP(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function C4(n){const e=tP(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:qC(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:qC(o)}}}function qC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function A4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ns("not implemented")}_getIdTokenResponse(e){return ns("not implemented")}_linkToIdToken(e,t){return ns("not implemented")}_getReauthenticationResolver(e){return ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nP(n,e){return Yt(n,"POST","/v1/accounts:resetPassword",Qt(n,e))}async function N4(n,e){return Yt(n,"POST","/v1/accounts:update",e)}async function k4(n,e){return Yt(n,"POST","/v1/accounts:signUp",e)}async function R4(n,e){return Yt(n,"POST","/v1/accounts:update",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4(n,e){return ao(n,"POST","/v1/accounts:signInWithPassword",Qt(n,e))}async function oy(n,e){return Yt(n,"POST","/v1/accounts:sendOobCode",Qt(n,e))}async function P4(n,e){return oy(n,e)}async function D4(n,e){return oy(n,e)}async function M4(n,e){return oy(n,e)}async function L4(n,e){return oy(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(n,e){return ao(n,"POST","/v1/accounts:signInWithEmailLink",Qt(n,e))}async function F4(n,e){return ao(n,"POST","/v1/accounts:signInWithEmailLink",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af extends ed{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new af(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new af(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oa(e,t,"signInWithPassword",b4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return V4(e,{email:this._email,oobCode:this._password});default:On(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oa(e,r,"signUpPassword",k4,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return F4(e,{idToken:t,email:this._email,oobCode:this._password});default:On(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qs(n,e){return ao(n,"POST","/v1/accounts:signInWithIdp",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4="http://localhost";class ps extends ed{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ps(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):On("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const o=new ps(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Qs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Qs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qs(e,t)}buildRequest(){const e={requestUri:O4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(n,e){return Yt(n,"POST","/v1/accounts:sendVerificationCode",Qt(n,e))}async function U4(n,e){return ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Qt(n,e))}async function B4(n,e){const t=await ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Qt(n,e));if(t.temporaryProof)throw Ih(n,"account-exists-with-different-credential",t);return t}const q4={USER_NOT_FOUND:"user-not-found"};async function H4(n,e){const t={...e,operation:"REAUTH"};return ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Qt(n,t),q4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends ed{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Rl({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Rl({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return U4(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return B4(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return H4(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Rl({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $4(n){const e=lu(Eh(n)).link,t=e?lu(Eh(e)).deep_link_id:null,r=lu(Eh(n)).deep_link_id;return(r?lu(Eh(r)).link:null)||r||t||e||n}class ay{constructor(e){const t=lu(Eh(e)),r=t.apiKey??null,i=t.oobCode??null,s=G4(t.mode??null);le(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=$4(e);try{return new ay(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this.providerId=Ra.PROVIDER_ID}static credential(e,t){return af._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ay.parseLink(t);return le(r,"argument-error"),af._fromEmailAndCode(e,r.code,r.tenantId)}}Ra.PROVIDER_ID="password";Ra.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ra.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends lo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fu extends td{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return le("providerId"in t&&"signInMethod"in t,"argument-error"),ps._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return le(e.idToken||e.accessToken,"argument-error"),ps._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return fu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return fu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new fu(l)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends td{constructor(){super("facebook.com")}static credential(e){return ps._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends td{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ps._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Zi.credential(t,r)}catch{return null}}}Zi.GOOGLE_SIGN_IN_METHOD="google.com";Zi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends td{constructor(){super("github.com")}static credential(e){return ps._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return es.credential(e.oauthAccessToken)}catch{return null}}}es.GITHUB_SIGN_IN_METHOD="github.com";es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4="http://localhost";class Su extends ed{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Qs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Qs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Su(r,s)}static _create(e,t){return new Su(e,t)}buildRequest(){return{requestUri:j4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4="saml.";class lg extends lo{constructor(e){le(e.startsWith(z4),"argument-error"),super(e)}static credentialFromResult(e){return lg.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return lg.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Su.fromJSON(e);return le(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Su._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends td{constructor(){super("twitter.com")}static credential(e,t){return ps._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ts.credential(t,r)}catch{return null}}}ts.TWITTER_SIGN_IN_METHOD="twitter.com";ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rP(n,e){return ao(n,"POST","/v1/accounts:signUp",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ii._fromIdTokenResponse(e,r,i),o=GC(r);return new ai({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=GC(r);return new ai({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function GC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W4(n){var i;if(Mt(n.app))return Promise.reject(An(n));const e=Wt(n);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new ai({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await rP(e,{returnSecureToken:!0}),r=await ai._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg extends Kn{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,cg.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new cg(e,t,r,i)}}function iP(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?cg._fromErrorAndOperation(n,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4(n,e){const t=Ee(n);await ly(!0,t,e);const{providerUserInfo:r}=await JO(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=sP(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function yT(n,e,t=!1){const r=await eo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ai._forOperation(n,"link",r)}async function ly(n,e,t){await of(e);const r=sP(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";le(r.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oP(n,e,t=!1){const{auth:r}=n;if(Mt(r.app))return Promise.reject(An(r));const i="reauthenticate";try{const s=await eo(n,iP(r,i,e,n),t);le(s.idToken,r,"internal-error");const o=sy(s.idToken);le(o,r,"internal-error");const{sub:l}=o;return le(n.uid===l,r,"user-mismatch"),ai._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&On(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aP(n,e,t=!1){if(Mt(n.app))return Promise.reject(An(n));const r="signIn",i=await iP(n,r,e),s=await ai._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function cy(n,e){return aP(Wt(n),e)}async function lP(n,e){const t=Ee(n);return await ly(!1,t,e.providerId),yT(t,e)}async function cP(n,e){return oP(Ee(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(n,e){return ao(n,"POST","/v1/accounts:signInWithCustomToken",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q4(n,e){if(Mt(n.app))return Promise.reject(An(n));const t=Wt(n),r=await J4(t,{token:e,returnSecureToken:!0}),i=await ai._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?_T._fromServerResponse(e,t):"totpInfo"in t?vT._fromServerResponse(e,t):On(e,"internal-error")}}class _T extends Uf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new _T(t)}}class vT extends Uf{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new vT(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(n,e,t){var r;le(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),le(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),le(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(le(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(le(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(n){const e=Wt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Y4(n,e,t){const r=Wt(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&uy(r,i,t),await oa(r,i,"getOobCode",D4,"EMAIL_PASSWORD_PROVIDER")}async function X4(n,e,t){await nP(Ee(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&wT(n),r})}async function Z4(n,e){await R4(Ee(n),{oobCode:e})}async function uP(n,e){const t=Ee(n),r=await nP(t,{oobCode:e}),i=r.requestType;switch(le(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":le(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":le(r.mfaInfo,t,"internal-error");default:le(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Uf._fromServerResponse(Wt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function e3(n,e){const{data:t}=await uP(Ee(n),e);return t.email}async function t3(n,e,t){if(Mt(n.app))return Promise.reject(An(n));const r=Wt(n),o=await oa(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rP,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&wT(n),u}),l=await ai._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function n3(n,e,t){return Mt(n.app)?Promise.reject(An(n)):cy(Ee(n),Ra.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&wT(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r3(n,e,t){const r=Wt(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,l){le(l.handleCodeInApp,r,"argument-error"),l&&uy(r,o,l)}s(i,t),await oa(r,i,"getOobCode",M4,"EMAIL_PASSWORD_PROVIDER")}function i3(n,e){const t=ay.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function s3(n,e,t){if(Mt(n.app))return Promise.reject(An(n));const r=Ee(n),i=Ra.credentialWithLink(e,t||sf());return le(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),cy(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o3(n,e){return Yt(n,"POST","/v1/accounts:createAuthUri",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a3(n,e){const t=pT()?sf():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await o3(Ee(n),r);return i||[]}async function l3(n,e){const t=Ee(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&uy(t.auth,i,e);const{email:s}=await P4(t.auth,i);s!==n.email&&await n.reload()}async function c3(n,e,t){const r=Ee(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&uy(r.auth,s,t);const{email:o}=await L4(r.auth,s);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u3(n,e){return Yt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d3(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ee(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await eo(r,u3(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function h3(n,e){const t=Ee(n);return Mt(t.auth.app)?Promise.reject(An(t.auth)):dP(t,e,null)}function f3(n,e){return dP(Ee(n),null,e)}async function dP(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const o=await eo(n,N4(r,s));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(n){var i,s;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const o=(s=(i=sy(n.idToken))==null?void 0:i.firebase)==null?void 0:s.sign_in_provider;if(o){const l=o!=="anonymous"&&o!=="custom"?o:null;return new pu(r,l)}}if(!e)return null;switch(e){case"facebook.com":return new m3(r,t);case"github.com":return new g3(r,t);case"google.com":return new y3(r,t);case"twitter.com":return new _3(r,t,n.screenName||null);case"custom":case"anonymous":return new pu(r,null);default:return new pu(r,e,t)}}class pu{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class hP extends pu{constructor(e,t,r,i){super(e,t,r),this.username=i}}class m3 extends pu{constructor(e,t){super(e,"facebook.com",t)}}class g3 extends hP{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class y3 extends pu{constructor(e,t){super(e,"google.com",t)}}class _3 extends hP{constructor(e,t,r){super(e,"twitter.com",t,r)}}function v3(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:p3(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Il("enroll",e,t)}static _fromMfaPendingCredential(e){return new Il("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Il._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return Il._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Wt(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>Uf._fromServerResponse(r,l));le(i.mfaPendingCredential,r,"internal-error");const o=Il._fromMfaPendingCredential(i.mfaPendingCredential);return new TT(o,s,async l=>{const u=await l._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const d={...i,idToken:u.idToken,refreshToken:u.refreshToken};switch(t.operationType){case"signIn":const p=await ai._fromIdTokenResponse(r,t.operationType,d);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return le(t.user,r,"internal-error"),ai._forOperation(t.user,t.operationType,d);default:On(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function w3(n,e){var i;const t=Ee(n),r=e;return le(e.customData.operationType,t,"argument-error"),le((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),TT._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(n,e){return Yt(n,"POST","/v2/accounts/mfaEnrollment:start",Qt(n,e))}function T3(n,e){return Yt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Qt(n,e))}function E3(n,e){return Yt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Qt(n,e))}class ET{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Uf._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new ET(e)}async getSession(){return Il._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await eo(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await eo(this.user,E3(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Qv=new WeakMap;function I3(n){const e=Ee(n);return Qv.has(e)||Qv.set(e,ET._fromUser(e)),Qv.get(e)}const ug="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ug,"1"),this.storage.removeItem(ug),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3=1e3,S3=10;class pP extends fP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Yb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);s4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,S3):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},x3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}pP.type="LOCAL";const IT=pP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP extends fP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mP.type="SESSION";const Ll=mP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C3(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new dy(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async d=>d(t.origin,s)),u=await C3(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const d=Bf("",20);i.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(v){const w=v;if(w.data.eventId===d)switch(w.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(w.data.response);break;default:clearTimeout(p),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(){return window}function N3(n){ln().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(){return typeof ln().WorkerGlobalScope<"u"&&typeof ln().importScripts=="function"}async function k3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function R3(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function b3(){return xT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP="firebaseLocalStorageDb",P3=1,dg="firebaseLocalStorage",yP="fbase_key";class qf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function hy(n,e){return n.transaction([dg],e?"readwrite":"readonly").objectStore(dg)}function D3(){const n=indexedDB.deleteDatabase(gP);return new qf(n).toPromise()}function Dw(){const n=indexedDB.open(gP,P3);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(dg,{keyPath:yP})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(dg)?e(r):(r.close(),await D3(),e(await Dw()))})})}async function jC(n,e,t){const r=hy(n,!0).put({[yP]:e,value:t});return new qf(r).toPromise()}async function M3(n,e){const t=hy(n,!1).get(e),r=await new qf(t).toPromise();return r===void 0?null:r.value}function zC(n,e){const t=hy(n,!0).delete(e);return new qf(t).toPromise()}const L3=800,V3=3;class _P{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>V3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dy._getInstance(b3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await k3(),!this.activeServiceWorker)return;this.sender=new A3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||R3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dw();return await jC(e,ug,"1"),await zC(e,ug),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>jC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>M3(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>zC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=hy(i,!1).getAll();return new qf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),L3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_P.type="LOCAL";const lf=_P;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n,e){return Yt(n,"POST","/v2/accounts/mfaSignIn:start",Qt(n,e))}function F3(n,e){return Yt(n,"POST","/v2/accounts/mfaSignIn:finalize",Qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv=Zb("rcb"),O3=new Lf(3e4,6e4);class U3{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=ln().grecaptcha)!=null&&e.render)}load(e,t=""){return le(B3(t),e,"argument-error"),this.shouldResolveImmediately(t)&&LC(ln().grecaptcha)?Promise.resolve(ln().grecaptcha):new Promise((r,i)=>{const s=ln().setTimeout(()=>{i(mn(e,"network-request-failed"))},O3.get());ln()[Yv]=()=>{ln().clearTimeout(s),delete ln()[Yv];const l=ln().grecaptcha;if(!l||!LC(l)){i(mn(e,"internal-error"));return}const u=l.render;l.render=(d,p)=>{const v=u(d,p);return this.counter++,v},this.hostLanguage=t,r(l)};const o=`${h4()}?${nc({onload:Yv,render:"explicit",hl:t})}`;gT(o).catch(()=>{clearTimeout(s),i(mn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=ln().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function B3(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class q3{async load(e){return new y4(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="recaptcha",H3={theme:"light",type:"image"};let G3=class{constructor(e,t,r={...H3}){this.parameters=r,this.type=Mh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Wt(e),this.isInvisible=this.parameters.size==="invisible",le(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;le(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new q3:new U3,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){le(!this.parameters.sitekey,this.auth,"argument-error"),le(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),le(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=ln()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){le(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){le(pT()&&!xT(),this.auth,"internal-error"),await $3(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await WO(this.auth);le(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return le(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function $3(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Rl._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function j3(n,e,t){if(Mt(n.app))return Promise.reject(An(n));const r=Wt(n),i=await fy(r,e,Ee(t));return new ST(i,s=>cy(r,s))}async function z3(n,e,t){const r=Ee(n);await ly(!1,r,"phone");const i=await fy(r.auth,e,Ee(t));return new ST(i,s=>lP(r,s))}async function W3(n,e,t){const r=Ee(n);if(Mt(r.auth.app))return Promise.reject(An(r.auth));const i=await fy(r.auth,e,Ee(t));return new ST(i,s=>cP(r,s))}async function fy(n,e,t){var r;if(!n._getRecaptchaConfig())try{await I4(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const s=i.session;if("phoneNumber"in i){le(s.type==="enroll",n,"internal-error");const o={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await oa(n,o,"mfaSmsEnrollment",async(p,v)=>{if(v.phoneEnrollmentInfo.captchaResponse===Dh){le((t==null?void 0:t.type)===Mh,p,"argument-error");const w=await Xv(p,v,t);return $C(p,w)}return $C(p,v)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{le(s.type==="signin",n,"internal-error");const o=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;le(o,n,"missing-multi-factor-info");const l={mfaPendingCredential:s.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await oa(n,l,"mfaSmsSignIn",async(v,w)=>{if(w.phoneSignInInfo.captchaResponse===Dh){le((t==null?void 0:t.type)===Mh,v,"argument-error");const x=await Xv(v,w,t);return WC(v,x)}return WC(v,w)},"PHONE_PROVIDER").catch(v=>Promise.reject(v))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await oa(n,s,"sendVerificationCode",async(d,p)=>{if(p.captchaResponse===Dh){le((t==null?void 0:t.type)===Mh,d,"argument-error");const v=await Xv(d,p,t);return HC(d,v)}return HC(d,p)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).sessionInfo}}finally{t==null||t._reset()}}async function K3(n,e){const t=Ee(n);if(Mt(t.auth.app))return Promise.reject(An(t.auth));await yT(t,e)}async function Xv(n,e,t){le(t.type===Mh,n,"argument-error");const r=await t.verify();le(typeof r=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,l=i.phoneEnrollmentInfo.clientType,u=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:l,recaptchaVersion:u}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,l=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:l}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vl=class Om{constructor(e){this.providerId=Om.PROVIDER_ID,this.auth=Wt(e)}verifyPhoneNumber(e,t){return fy(this.auth,e,Ee(t))}static credential(e,t){return Rl._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Om.credentialFromTaggedObject(t)}static credentialFromError(e){return Om.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Rl._fromTokenResponse(t,r):null}};Vl.PROVIDER_ID="phone";Vl.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(n,e){return e?Ur(e):(le(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT extends ed{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function J3(n){return aP(n.auth,new CT(n),n.bypassAuthState)}function Q3(n){const{auth:e,user:t}=n;return le(t,e,"internal-error"),oP(t,new CT(n),n.bypassAuthState)}async function Y3(n){const{auth:e,user:t}=n;return le(t,e,"internal-error"),yT(t,new CT(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return J3;case"linkViaPopup":case"linkViaRedirect":return Y3;case"reauthViaPopup":case"reauthViaRedirect":return Q3;default:On(this.auth,"internal-error")}}resolve(e){Ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3=new Lf(2e3,1e4);async function Z3(n,e,t){if(Mt(n.app))return Promise.reject(mn(n,"operation-not-supported-in-this-environment"));const r=Wt(n);Zu(n,e,lo);const i=rc(r,t);return new js(r,"signInViaPopup",e,i).executeNotNull()}async function eU(n,e,t){const r=Ee(n);if(Mt(r.auth.app))return Promise.reject(mn(r.auth,"operation-not-supported-in-this-environment"));Zu(r.auth,e,lo);const i=rc(r.auth,t);return new js(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function tU(n,e,t){const r=Ee(n);Zu(r.auth,e,lo);const i=rc(r.auth,t);return new js(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class js extends vP{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,js.currentPopupAction&&js.currentPopupAction.cancel(),js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return le(e,this.auth,"internal-error"),e}async onExecution(){Ni(this.filter.length===1,"Popup operations only handle one event");const e=Bf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,X3.get())};e()}}js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU="pendingRedirect",Lh=new Map;class rU extends vP{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Lh.get(this.auth._key());if(!e){try{const r=await iU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Lh.set(this.auth._key(),e)}return this.bypassAuthState||Lh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iU(n,e){const t=TP(e),r=wP(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function AT(n,e){return wP(n)._set(TP(e),"true")}function sU(){Lh.clear()}function NT(n,e){Lh.set(n._key(),e)}function wP(n){return Ur(n._redirectPersistence)}function TP(n){return kl(nU,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(n,e,t){return aU(n,e,t)}async function aU(n,e,t){if(Mt(n.app))return Promise.reject(An(n));const r=Wt(n);Zu(n,e,lo),await r._initializationPromise;const i=rc(r,t);return await AT(i,r),i._openRedirect(r,e,"signInViaRedirect")}function lU(n,e,t){return cU(n,e,t)}async function cU(n,e,t){const r=Ee(n);if(Zu(r.auth,e,lo),Mt(r.auth.app))return Promise.reject(An(r.auth));await r.auth._initializationPromise;const i=rc(r.auth,t);await AT(i,r.auth);const s=await EP(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function uU(n,e,t){return dU(n,e,t)}async function dU(n,e,t){const r=Ee(n);Zu(r.auth,e,lo),await r.auth._initializationPromise;const i=rc(r.auth,t);await ly(!1,r,e.providerId),await AT(i,r.auth);const s=await EP(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function hU(n,e){return await Wt(n)._initializationPromise,py(n,e,!1)}async function py(n,e,t=!1){if(Mt(n.app))return Promise.reject(An(n));const r=Wt(n),i=rc(r,e),o=await new rU(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function EP(n){const e=Bf(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=600*1e3;class IP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!xP(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(mn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fU&&this.cachedEventUids.clear(),this.cachedEventUids.has(KC(e))}saveEventToCache(e){this.cachedEventUids.add(KC(e)),this.lastProcessedEventTime=Date.now()}}function KC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xP({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xP(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SP(n,e={}){return Yt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gU=/^https?/;async function yU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await SP(n);for(const t of e)try{if(_U(t))return}catch{}On(n,"unauthorized-domain")}function _U(n){const e=sf(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!gU.test(t))return!1;if(mU.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=new Lf(3e4,6e4);function JC(){const n=ln().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function wU(n){return new Promise((e,t)=>{var i,s,o;function r(){JC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{JC(),t(mn(n,"network-request-failed"))},timeout:vU.get()})}if((s=(i=ln().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=ln().gapi)!=null&&o.load)r();else{const l=Zb("iframefcb");return ln()[l]=()=>{gapi.load?r():t(mn(n,"network-request-failed"))},gT(`${p4()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Um=null,e})}let Um=null;function TU(n){return Um=Um||wU(n),Um}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=new Lf(5e3,15e3),IU="__/auth/iframe",xU="emulator/auth/iframe",SU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AU(n){const e=n.config;le(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?mT(e,xU):`https://${n.config.authDomain}/${IU}`,r={apiKey:e.apiKey,appName:n.name,v:oo},i=CU.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${nc(r).slice(1)}`}async function NU(n){const e=await TU(n),t=ln().gapi;return le(t,n,"internal-error"),e.open({where:document.body,url:AU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SU,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=mn(n,"network-request-failed"),l=ln().setTimeout(()=>{s(o)},EU.get());function u(){ln().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RU=500,bU=600,PU="_blank",DU="http://localhost";class QC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MU(n,e,t,r=RU,i=bU){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...kU,width:r.toString(),height:i.toString(),top:s,left:o},d=zt().toLowerCase();t&&(l=Wb(d)?PU:t),jb(d)&&(e=e||DU,u.scrollbars="yes");const p=Object.entries(u).reduce((w,[x,A])=>`${w}${x}=${A},`,"");if(i4(d)&&l!=="_self")return LU(e||"",l),new QC(null);const v=window.open(e||"",l,p);le(v,n,"popup-blocked");try{v.focus()}catch{}return new QC(v)}function LU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VU="__/auth/handler",FU="emulator/auth/handler",OU=encodeURIComponent("fac");async function Mw(n,e,t,r,i,s){le(n.config.authDomain,n,"auth-domain-config-required"),le(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:oo,eventId:i};if(e instanceof lo){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",rg(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries(s||{}))o[p]=v}if(e instanceof td){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const u=await n._getAppCheckToken(),d=u?`#${OU}=${encodeURIComponent(u)}`:"";return`${UU(n)}?${nc(l).slice(1)}${d}`}function UU({config:n}){return n.emulator?mT(n,FU):`https://${n.authDomain}/${VU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="webStorageSupport";class BU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ll,this._completeRedirectFn=py,this._overrideRedirectResult=NT}async _openPopup(e,t,r,i){var o;Ni((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await Mw(e,t,r,sf(),i);return MU(e,s,Bf())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await Mw(e,t,r,sf(),i);return N3(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ni(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await NU(e),r=new IP(e);return t.register("authEvent",i=>(le(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zv,{type:Zv},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Zv];s!==void 0&&t(!!s),On(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Yb()||zb()||Ff()}}const qU=BU;class HU{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ns("unexpected MultiFactorSessionType")}}}class kT extends HU{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new kT(e)}_finalizeEnroll(e,t,r){return T3(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return F3(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class CP{constructor(){}static assertion(e){return kT._fromCredential(e)}}CP.FACTOR_ID="phone";var YC="@firebase/auth",XC="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jU(n){Tr(new un("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;le(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xb(n)},d=new u4(r,i,s,u);return x4(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Tr(new un("auth-internal",e=>{const t=Wt(e.getProvider("auth").getImmediate());return(r=>new GU(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vn(YC,XC,$U(n)),Vn(YC,XC,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=300;ZF("authIdTokenMaxAge");function WU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}d4({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=mn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",WU().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jU("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KU=2e3;async function JU(n,e,t){const{BuildInfo:r}=Fl();Ni(e.sessionId,"AuthEvent did not contain a session ID");const i=await e6(e.sessionId),s={};return Ff()?s.ibi=r.packageName:Vf()?s.apn=r.packageName:On(n,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=i,Mw(n,t,e.type,void 0,e.eventId??void 0,s)}async function QU(n){const{BuildInfo:e}=Fl(),t={};Ff()?t.iosBundleId=e.packageName:Vf()?t.androidPackageName=e.packageName:On(n,"operation-not-supported-in-this-environment"),await SP(n,t)}function YU(n){const{cordova:e}=Fl();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,r4()?"_blank":"_system","location=yes"),t(i)})})}async function XU(n,e,t){const{cordova:r}=Fl();let i=()=>{};try{await new Promise((s,o)=>{let l=null;function u(){var w;s();const v=(w=r.plugins.browsertab)==null?void 0:w.close;typeof v=="function"&&v(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function d(){l||(l=window.setTimeout(()=>{o(mn(n,"redirect-cancelled-by-user"))},KU))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&d()}e.addPassiveListener(u),document.addEventListener("resume",d,!1),Vf()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(u),document.removeEventListener("resume",d,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function ZU(n){var t,r,i,s,o,l,u,d,p,v;const e=Fl();le(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),le(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),le(typeof((o=(s=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:s.browsertab)==null?void 0:o.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),le(typeof((d=(u=(l=e==null?void 0:e.cordova)==null?void 0:l.plugins)==null?void 0:u.browsertab)==null?void 0:d.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),le(typeof((v=(p=e==null?void 0:e.cordova)==null?void 0:p.InAppBrowser)==null?void 0:v.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function e6(n){const e=t6(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function t6(n){if(Ni(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6=20;class r6 extends IP{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function i6(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:a6(),postBody:null,tenantId:n.tenantId,error:mn(n,"no-auth-event")}}function s6(n,e){return Lw()._set(Vw(n),e)}async function ZC(n){const e=await Lw()._get(Vw(n));return e&&await Lw()._remove(Vw(n)),e}function o6(n,e){var r,i;const t=c6(e);if(t.includes("/__/auth/callback")){const s=Bm(t),o=s.firebaseError?l6(decodeURIComponent(s.firebaseError)):null,l=(i=(r=o==null?void 0:o.code)==null?void 0:r.split("auth/"))==null?void 0:i[1],u=l?mn(l):null;return u?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function a6(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<n6;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Lw(){return Ur(IT)}function Vw(n){return kl("authEvent",n.config.apiKey,n.name)}function l6(n){try{return JSON.parse(n)}catch{return null}}function c6(n){const e=Bm(n),t=e.link?decodeURIComponent(e.link):void 0,r=Bm(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Bm(i).link||i||r||t||n}function Bm(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return lu(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6=500;class d6{constructor(){this._redirectPersistence=Ll,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=py,this._overrideRedirectResult=NT}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new r6(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){On(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){ZU(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),sU(),await this._originValidation(e);const o=i6(e,r,i);await s6(e,o);const l=await JU(e,o,t),u=await YU(l);return XU(e,s,u)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QU(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Fl(),o=setTimeout(async()=>{await ZC(e),t.onEvent(eA())},u6),l=async p=>{clearTimeout(o);const v=await ZC(e);let w=null;v&&(p!=null&&p.url)&&(w=o6(v,p.url)),t.onEvent(w||eA())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const u=i,d=`${s.packageName.toLowerCase()}://`;Fl().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(d)&&l({url:p}),typeof u=="function")try{u(p)}catch(v){console.error(v)}}}}const h6=d6;function eA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:mn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(n,e){Wt(n)._logFramework(e)}var p6="@firebase/auth-compat",m6="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6=1e3;function Vh(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function y6(){return Vh()==="http:"||Vh()==="https:"}function AP(n=zt()){return!!((Vh()==="file:"||Vh()==="ionic:"||Vh()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function _6(){return ny()||ty()}function v6(){return wb()&&(document==null?void 0:document.documentMode)===11}function w6(n=zt()){return/Edge\/\d+/.test(n)}function T6(n=zt()){return v6()||w6(n)}function NP(){try{const n=self.localStorage,e=Bf();if(n)return n.setItem(e,"1"),n.removeItem(e),T6()?Dl():!0}catch{return RT()&&Dl()}return!1}function RT(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ew(){return(y6()||vb()||AP())&&!_6()&&NP()&&!RT()}function kP(){return AP()&&typeof document<"u"}async function E6(){return kP()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},g6);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function I6(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr={LOCAL:"local",NONE:"none",SESSION:"session"},ah=le,RP="persistence";function x6(n,e){if(ah(Object.values(Fr).includes(e),n,"invalid-persistence-type"),ny()){ah(e!==Fr.SESSION,n,"unsupported-persistence-type");return}if(ty()){ah(e===Fr.NONE,n,"unsupported-persistence-type");return}if(RT()){ah(e===Fr.NONE||e===Fr.LOCAL&&Dl(),n,"unsupported-persistence-type");return}ah(e===Fr.NONE||NP(),n,"unsupported-persistence-type")}async function Fw(n){await n._initializationPromise;const e=bP(),t=kl(RP,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function S6(n,e){const t=bP();if(!t)return[];const r=kl(RP,n,e);switch(t.getItem(r)){case Fr.NONE:return[xu];case Fr.LOCAL:return[lf,Ll];case Fr.SESSION:return[Ll];default:return[]}}function bP(){var n;try{return((n=I6())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=le;class Zo{constructor(){this.browserResolver=Ur(qU),this.cordovaResolver=Ur(h6),this.underlyingResolver=null,this._redirectPersistence=Ll,this._completeRedirectFn=py,this._overrideRedirectResult=NT}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return kP()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return C6(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await E6();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(n){return n.unwrap()}function A6(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N6(n){return DP(n)}function k6(n,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new R6(n,w3(n,e))}else if(t){const i=DP(e),s=e;i&&(s.credential=i,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function DP(n){const{_tokenResponse:e}=n instanceof Kn?n.customData:n;if(!e)return null;if(!(n instanceof Kn)&&"temporaryProof"in e&&"phoneNumber"in e)return Vl.credentialFromResult(n);const t=e.providerId;if(!t||t===sh.PASSWORD)return null;let r;switch(t){case sh.GOOGLE:r=Zi;break;case sh.FACEBOOK:r=Xi;break;case sh.GITHUB:r=es;break;case sh.TWITTER:r=ts;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:l,nonce:u}=e;return!s&&!o&&!i&&!l?null:l?t.startsWith("saml.")?Su._create(t,l):ps._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new fu(t).credential({idToken:i,accessToken:s,rawNonce:u})}return n instanceof Kn?r.credentialFromError(n):r.credentialFromResult(n)}function pr(n,e){return e.catch(t=>{throw t instanceof Kn&&k6(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:N6(t),additionalUserInfo:v3(t),user:my.getOrCreate(i)}})}async function Ow(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>pr(n,t.confirm(r))}}class R6{constructor(e,t){this.resolver=t,this.auth=A6(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return pr(PP(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let my=class xh{constructor(e){this._delegate=e,this.multiFactor=I3(e)}static getOrCreate(e){return xh.USER_MAP.has(e)||xh.USER_MAP.set(e,new xh(e)),xh.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return pr(this.auth,lP(this._delegate,e))}async linkWithPhoneNumber(e,t){return Ow(this.auth,z3(this._delegate,e,t))}async linkWithPopup(e){return pr(this.auth,tU(this._delegate,e,Zo))}async linkWithRedirect(e){return await Fw(Wt(this.auth)),uU(this._delegate,e,Zo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return pr(this.auth,cP(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Ow(this.auth,W3(this._delegate,e,t))}reauthenticateWithPopup(e){return pr(this.auth,eU(this._delegate,e,Zo))}async reauthenticateWithRedirect(e){return await Fw(Wt(this.auth)),lU(this._delegate,e,Zo)}sendEmailVerification(e){return l3(this._delegate,e)}async unlink(e){return await K4(this._delegate,e),this}updateEmail(e){return h3(this._delegate,e)}updatePassword(e){return f3(this._delegate,e)}updatePhoneNumber(e){return K3(this._delegate,e)}updateProfile(e){return d3(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return c3(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};my.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=le;class Uw{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;lh(r,"invalid-api-key",{appName:e.name}),lh(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Zo:void 0;this._delegate=t.initialize({options:{persistence:b6(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(FO),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?my.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){S4(this._delegate,e,t)}applyActionCode(e){return Z4(this._delegate,e)}checkActionCode(e){return uP(this._delegate,e)}confirmPasswordReset(e,t){return X4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return pr(this._delegate,t3(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return a3(this._delegate,e)}isSignInWithEmailLink(e){return i3(this._delegate,e)}async getRedirectResult(){lh(ew(),this._delegate,"operation-not-supported-in-this-environment");const e=await hU(this._delegate,Zo);return e?pr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){f6(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:o}=tA(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:o}=tA(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return r3(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Y4(this._delegate,e,t||void 0)}async setPersistence(e){x6(this._delegate,e);let t;switch(e){case Fr.SESSION:t=Ll;break;case Fr.LOCAL:t=await Ur(lf)._isAvailable()?lf:IT;break;case Fr.NONE:t=xu;break;default:return On("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return pr(this._delegate,W4(this._delegate))}signInWithCredential(e){return pr(this._delegate,cy(this._delegate,e))}signInWithCustomToken(e){return pr(this._delegate,Q4(this._delegate,e))}signInWithEmailAndPassword(e,t){return pr(this._delegate,n3(this._delegate,e,t))}signInWithEmailLink(e,t){return pr(this._delegate,s3(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Ow(this._delegate,j3(this._delegate,e,t))}async signInWithPopup(e){return lh(ew(),this._delegate,"operation-not-supported-in-this-environment"),pr(this._delegate,Z3(this._delegate,e,Zo))}async signInWithRedirect(e){return lh(ew(),this._delegate,"operation-not-supported-in-this-environment"),await Fw(this._delegate),oU(this._delegate,e,Zo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return e3(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Uw.Persistence=Fr;function tA(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:o=>i(o&&my.getOrCreate(o)),error:e,complete:t}}function b6(n,e){const t=S6(n,e);if(typeof self<"u"&&!t.includes(lf)&&t.push(lf),typeof window<"u")for(const r of[IT,Ll])t.includes(r)||t.push(r);return t.includes(xu)||t.push(xu),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{static credential(e,t){return Vl.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Vl(PP(tn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}bT.PHONE_SIGN_IN_METHOD=Vl.PHONE_SIGN_IN_METHOD;bT.PROVIDER_ID=Vl.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P6=le;class D6{constructor(e,t,r=tn.app()){var i;P6((i=r.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new G3(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6="auth-compat";function L6(n){n.INTERNAL.registerComponent(new un(M6,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Uw(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Jc.EMAIL_SIGNIN,PASSWORD_RESET:Jc.PASSWORD_RESET,RECOVER_EMAIL:Jc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Jc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Jc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Jc.VERIFY_EMAIL}},EmailAuthProvider:Ra,FacebookAuthProvider:Xi,GithubAuthProvider:es,GoogleAuthProvider:Zi,OAuthProvider:fu,SAMLAuthProvider:lg,PhoneAuthProvider:bT,PhoneMultiFactorGenerator:CP,RecaptchaVerifier:D6,TwitterAuthProvider:ts,Auth:Uw,AuthCredential:ed,Error:Kn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(p6,m6)}L6(tn);var nA={};const rA="@firebase/database",iA="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MP="";function LP(n){MP=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),pn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:tf(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return qr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new V6(e)}}catch{}return new F6},xl=VP("localStorage"),Bw=VP("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=new Yu("@firebase/database"),FP=(function(){let n=1;return function(){return n++}})(),OP=function(n){const e=m5(n),t=new h5;t.update(e);const r=t.digest();return Z0.encodeByteArray(r)},Hf=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Hf.apply(null,r):typeof r=="object"?e+=pn(r):e+=r,e+=" "}return e};let bl=null,sA=!0;const UP=function(n,e){de(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(mu.logLevel=Je.VERBOSE,bl=mu.log.bind(mu),e&&Bw.set("logging_enabled",!0)):typeof n=="function"?bl=n:(bl=null,Bw.remove("logging_enabled"))},Cn=function(...n){if(sA===!0&&(sA=!1,bl===null&&Bw.get("logging_enabled")===!0&&UP(!0)),bl){const e=Hf.apply(null,n);bl(e)}},Gf=function(n){return function(...e){Cn(n,...e)}},qw=function(...n){const e="FIREBASE INTERNAL ERROR: "+Hf(...n);mu.error(e)},ms=function(...n){const e=`FIREBASE FATAL ERROR: ${Hf(...n)}`;throw mu.error(e),new Error(e)},Jn=function(...n){const e="FIREBASE WARNING: "+Hf(...n);mu.warn(e)},O6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Jn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},gy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},U6=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ma="[MIN_NAME]",to="[MAX_NAME]",ic=function(n,e){if(n===e)return 0;if(n===ma||e===to)return-1;if(e===ma||n===to)return 1;{const t=oA(n),r=oA(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},B6=function(n,e){return n===e?0:n<e?-1:1},ch=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+pn(e))},PT=function(n){if(typeof n!="object"||n===null)return pn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=pn(e[r]),t+=":",t+=PT(n[e[r]]);return t+="}",t},BP=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Nn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const qP=function(n){de(!gy(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,l,u;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const d=[];for(u=t;u;u-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const p=d.join("");let v="";for(u=0;u<64;u+=8){let w=parseInt(p.substr(u,8),2).toString(16);w.length===1&&(w="0"+w),v=v+w}return v.toLowerCase()},q6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},H6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function G6(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const $6=new RegExp("^-?(0*)\\d{1,10}$"),j6=-2147483648,z6=2147483647,oA=function(n){if($6.test(n)){const e=Number(n);if(e>=j6&&e<=z6)return e}return null},nd=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Jn("Exception was thrown by user callback.",t),e},Math.floor(0))}},W6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Fh=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Mt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Jn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Cn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Jn(e)}}class gu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}gu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="5",HP="v",GP="s",$P="r",jP="f",zP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,WP="ls",KP="p",Hw="ac",JP="websocket",QP="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,t,r,i,s=!1,o="",l=!1,u=!1,d=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=u,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xl.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xl.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Q6(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function XP(n,e,t){de(typeof e=="string","typeof type must == string"),de(typeof t=="object","typeof params must == object");let r;if(e===JP)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===QP)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Q6(n)&&(t.ns=n.namespace);const i=[];return Nn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(){this.counters_={}}incrementCounter(e,t=1){qr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return KF(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw={},nw={};function MT(n){const e=n.toString();return tw[e]||(tw[e]=new Y6),tw[e]}function X6(n,e){const t=n.toString();return nw[t]||(nw[t]=e()),nw[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&nd(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="start",eB="close",tB="pLPCommand",nB="pRTLPCB",ZP="id",e1="pw",t1="ser",rB="cb",iB="seg",sB="ts",oB="d",aB="dframe",n1=1870,r1=30,lB=n1-r1,cB=25e3,uB=3e4;class ea{constructor(e,t,r,i,s,o,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Gf(e),this.stats_=MT(t),this.urlFn=u=>(this.appCheckToken&&(u[Hw]=this.appCheckToken),XP(t,QP,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Z6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uB)),U6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new LT((...s)=>{const[o,l,u,d,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===aA)this.id=l,this.password=u;else if(o===eB)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[aA]="t",r[t1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[rB]=this.scriptTagHolder.uniqueCallbackIdentifier),r[HP]=DT,this.transportSessionId&&(r[GP]=this.transportSessionId),this.lastSessionId&&(r[WP]=this.lastSessionId),this.applicationId&&(r[KP]=this.applicationId),this.appCheckToken&&(r[Hw]=this.appCheckToken),typeof location<"u"&&location.hostname&&zP.test(location.hostname)&&(r[$P]=jP);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ea.forceAllow_=!0}static forceDisallow(){ea.forceDisallow_=!0}static isAvailable(){return ea.forceAllow_?!0:!ea.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!q6()&&!H6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=gb(t),i=BP(r,lB);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[aB]="t",r[ZP]=e,r[e1]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=pn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class LT{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=FP(),window[tB+this.uniqueCallbackIdentifier]=e,window[nB+this.uniqueCallbackIdentifier]=t,this.myIFrame=LT.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Cn("frame writing exception"),l.stack&&Cn(l.stack),Cn(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Cn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[ZP]=this.myID,e[e1]=this.myPW,e[t1]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+r1+r.length<=n1;){const o=this.pendingSegs.shift();r=r+"&"+iB+i+"="+o.seg+"&"+sB+i+"="+o.ts+"&"+oB+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(cB)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Cn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB=16384,hB=45e3;let hg=null;typeof MozWebSocket<"u"?hg=MozWebSocket:typeof WebSocket<"u"&&(hg=WebSocket);class ti{constructor(e,t,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Gf(this.connId),this.stats_=MT(t),this.connURL=ti.connectionURL_(t,o,l,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[HP]=DT,typeof location<"u"&&location.hostname&&zP.test(location.hostname)&&(o[$P]=jP),t&&(o[GP]=t),r&&(o[WP]=r),i&&(o[Hw]=i),s&&(o[KP]=s),XP(e,JP,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xl.set("previous_websocket_failure",!0);try{let r;i5(),this.mySock=new hg(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){ti.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&hg!==null&&!ti.forceDisallow_}static previouslyFailed(){return xl.isInMemoryStorage||xl.get("previous_websocket_failure")===!0}markConnectionHealthy(){xl.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=tf(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(de(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=BP(t,dB);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hB))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ti.responsesRequiredToBeHealthy=2;ti.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{static get ALL_TRANSPORTS(){return[ea,ti]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=ti&&ti.isAvailable();let r=t&&!ti.previouslyFailed();if(e.webSocketOnly&&(t||Jn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ti];else{const i=this.transports_=[];for(const s of Cu.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Cu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Cu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB=6e4,pB=5e3,mB=10*1024,gB=100*1024,rw="t",lA="d",yB="s",cA="r",_B="e",uA="o",dA="a",hA="n",fA="p",vB="h";class wB{constructor(e,t,r,i,s,o,l,u,d,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=u,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Gf("c:"+this.id+":"),this.transportManager_=new Cu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Fh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gB?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>mB?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rw in e){const t=e[rw];t===dA?this.upgradeIfSecondaryHealthy_():t===cA?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===uA&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ch("t",e),r=ch("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:fA,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:dA,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:hA,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ch("t",e),r=ch("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ch(rw,e);if(lA in e){const r=e[lA];if(t===vB){const i={...r};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===hA){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===yB?this.onConnectionShutdown_(r):t===cA?this.onReset_(r):t===_B?qw("Server Error: "+r):t===uA?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):qw("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),DT!==r&&Jn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Fh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(fB))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Fh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(pB))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:fA,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xl.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this.allowedEvents_=e,this.listeners_={},de(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){de(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg extends s1{static getInstance(){return new fg}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!sT()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return de(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=32,mA=768;class mt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function lt(){return new mt("")}function ze(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ga(n){return n.pieces_.length-n.pieceNum_}function Et(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new mt(n.pieces_,e)}function VT(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function TB(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function cf(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function o1(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new mt(e,0)}function Ft(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof mt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new mt(t,0)}function We(n){return n.pieceNum_>=n.pieces_.length}function rr(n,e){const t=ze(n),r=ze(e);if(t===null)return e;if(t===r)return rr(Et(n),Et(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function EB(n,e){const t=cf(n,0),r=cf(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=ic(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function FT(n,e){if(ga(n)!==ga(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function ni(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ga(n)>ga(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class IB{constructor(e,t){this.errorPrefix_=t,this.parts_=cf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ry(this.parts_[r]);a1(this)}}function xB(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ry(e),a1(n)}function SB(n){const e=n.parts_.pop();n.byteLength_-=ry(e),n.parts_.length>0&&(n.byteLength_-=1)}function a1(n){if(n.byteLength_>mA)throw new Error(n.errorPrefix_+"has a key path longer than "+mA+" bytes ("+n.byteLength_+").");if(n.parts_.length>pA)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+pA+") or object contains a cycle "+pl(n))}function pl(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT extends s1{static getInstance(){return new OT}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return de(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=1e3,CB=300*1e3,gA=30*1e3,AB=1.3,NB=3e4,kB="server_kill",yA=3;class Ys extends i1{constructor(e,t,r,i,s,o,l,u){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=Ys.nextPersistentConnectionId_++,this.log_=Gf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=uh,this.maxReconnectDelay_=CB,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");OT.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&fg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(pn(s)),de(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new gr,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),de(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const u=l.d,d=l.s;Ys.warnOnListenWarnings_(u,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(d,u))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&qr(e,"w")){const r=Ml(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Jn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||d5(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=gA)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=u5(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+pn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):qw("Unrecognized action received from server: "+pn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){de(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>NB&&(this.reconnectDelay_=uh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*AB)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ys.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const u=function(){l?l.close():(o=!0,r())},d=function(v){de(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(v)};this.realtime_={close:u,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[v,w]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?Cn("getToken() completed but was canceled"):(Cn("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=w&&w.token,l=new wB(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,x=>{Jn(x+" ("+this.repoInfo_.toString()+")"),this.interrupt(kB)},s))}catch(v){this.log_("Failed to get token: "+v),o||(this.repoInfo_.nodeAdmin&&Jn(v),u())}}}interrupt(e){Cn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Cn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],rg(this.interruptReasons_)&&(this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>PT(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new mt(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Cn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=yA&&(this.reconnectDelay_=gA,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Cn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=yA&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+MP.replace(/\./g,"-")]=1,sT()?e["framework.cordova"]=1:ny()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=fg.getInstance().currentlyOnline();return rg(this.interruptReasons_)&&e}}Ys.nextPersistentConnectionId_=0;Ys.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Qe(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Qe(ma,e),i=new Qe(ma,t);return this.compare(r,i)!==0}minPost(){return Qe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cm;class l1 extends yy{static get __EMPTY_NODE(){return Cm}static set __EMPTY_NODE(e){Cm=e}compare(e,t){return ic(e.name,t.name)}isDefinedOn(e){throw Qu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Qe.MIN}maxPost(){return new Qe(to,Cm)}makePost(e,t){return de(typeof e=="string","KeyIndex indexValue must always be a string."),new Qe(e,Cm)}toString(){return".key"}}const ls=new l1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Am=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Mr=class Sh{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Sh.RED,this.left=i??rs.EMPTY_NODE,this.right=s??rs.EMPTY_NODE}copy(e,t,r,i,s){return new Sh(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return rs.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return rs.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Sh.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Sh.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Mr.RED=!0;Mr.BLACK=!1;class RB{copy(e,t,r,i,s){return this}insert(e,t,r){return new Mr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let rs=class qm{constructor(e,t=qm.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new qm(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Mr.BLACK,null,null))}remove(e){return new qm(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Mr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Am(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Am(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Am(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Am(this.root_,null,this.comparator_,!0,e)}};rs.EMPTY_NODE=new RB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bB(n,e){return ic(n.name,e.name)}function UT(n,e){return ic(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gw;function PB(n){Gw=n}const c1=function(n){return typeof n=="number"?"number:"+qP(n):"string:"+n},u1=function(n){if(n.isLeafNode()){const e=n.val();de(typeof e=="string"||typeof e=="number"||typeof e=="object"&&qr(e,".sv"),"Priority must be a string or number.")}else de(n===Gw||n.isEmpty(),"priority of unexpected type.");de(n===Gw||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _A;class En{static set __childrenNodeConstructor(e){_A=e}static get __childrenNodeConstructor(){return _A}constructor(e,t=En.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,de(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),u1(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new En(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:En.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return We(e)?this:ze(e)===".priority"?this.priorityNode_:En.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:En.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=ze(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(de(r!==".priority"||ga(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,En.__childrenNodeConstructor.EMPTY_NODE.updateChild(Et(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+c1(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=qP(this.value_):e+=this.value_,this.lazyHash_=OP(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===En.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof En.__childrenNodeConstructor?-1:(de(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=En.VALUE_TYPE_ORDER.indexOf(t),s=En.VALUE_TYPE_ORDER.indexOf(r);return de(i>=0,"Unknown leaf type: "+t),de(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}En.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d1,h1;function DB(n){d1=n}function MB(n){h1=n}class LB extends yy{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ic(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Qe.MIN}maxPost(){return new Qe(to,new En("[PRIORITY-POST]",h1))}makePost(e,t){const r=d1(e);return new Qe(t,new En("[PRIORITY-POST]",r))}toString(){return".priority"}}const St=new LB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VB=Math.log(2);class FB{constructor(e){const t=s=>parseInt(Math.log(s)/VB,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const pg=function(n,e,t,r){n.sort(e);const i=function(u,d){const p=d-u;let v,w;if(p===0)return null;if(p===1)return v=n[u],w=t?t(v):v,new Mr(w,v.node,Mr.BLACK,null,null);{const x=parseInt(p/2,10)+u,A=i(u,x),R=i(x+1,d);return v=n[x],w=t?t(v):v,new Mr(w,v.node,Mr.BLACK,A,R)}},s=function(u){let d=null,p=null,v=n.length;const w=function(A,R){const L=v-A,j=v;v-=A;const B=i(L+1,j),q=n[L],K=t?t(q):q;x(new Mr(K,q.node,R,null,B))},x=function(A){d?(d.left=A,d=A):(p=A,d=A)};for(let A=0;A<u.count;++A){const R=u.nextBitIsOne(),L=Math.pow(2,u.count-(A+1));R?w(L,Mr.BLACK):(w(L,Mr.BLACK),w(L,Mr.RED))}return p},o=new FB(n.length),l=s(o);return new rs(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iw;const Qc={};class zs{static get Default(){return de(Qc&&St,"ChildrenNode.ts has not been loaded"),iw=iw||new zs({".priority":Qc},{".priority":St}),iw}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Ml(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof rs?t:null}hasIndex(e){return qr(this.indexSet_,e.toString())}addIndex(e,t){de(e!==ls,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Qe.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=pg(r,e.getCompare()):l=Qc;const u=e.toString(),d={...this.indexSet_};d[u]=e;const p={...this.indexes_};return p[u]=l,new zs(p,d)}addToIndexes(e,t){const r=ig(this.indexes_,(i,s)=>{const o=Ml(this.indexSet_,s);if(de(o,"Missing index implementation for "+s),i===Qc)if(o.isDefinedOn(e.node)){const l=[],u=t.getIterator(Qe.Wrap);let d=u.getNext();for(;d;)d.name!==e.name&&l.push(d),d=u.getNext();return l.push(e),pg(l,o.getCompare())}else return Qc;else{const l=t.get(e.name);let u=i;return l&&(u=u.remove(new Qe(e.name,l))),u.insert(e,e.node)}});return new zs(r,this.indexSet_)}removeFromIndexes(e,t){const r=ig(this.indexes_,i=>{if(i===Qc)return i;{const s=t.get(e.name);return s?i.remove(new Qe(e.name,s)):i}});return new zs(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh;class Le{static get EMPTY_NODE(){return dh||(dh=new Le(new rs(UT),null,zs.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&u1(this.priorityNode_),this.children_.isEmpty()&&de(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||dh}updatePriority(e){return this.children_.isEmpty()?this:new Le(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?dh:t}}getChild(e){const t=ze(e);return t===null?this:this.getImmediateChild(t).getChild(Et(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(de(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Qe(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?dh:this.priorityNode_;return new Le(i,o,s)}}updateChild(e,t){const r=ze(e);if(r===null)return t;{de(ze(e)!==".priority"||ga(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Et(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(St,(o,l)=>{t[o]=l.val(e),r++,s&&Le.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in t)o[l]=t[l];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+c1(this.getPriority().val())+":"),this.forEachChild(St,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":OP(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Qe(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Qe(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Qe(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Qe.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Qe.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===$f?-1:0}withIndex(e){if(e===ls||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Le(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ls||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(St),i=t.getIterator(St);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ls?null:this.indexMap_.get(e.toString())}}Le.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class OB extends Le{constructor(){super(new rs(UT),Le.EMPTY_NODE,zs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Le.EMPTY_NODE}isEmpty(){return!1}}const $f=new OB;Object.defineProperties(Qe,{MIN:{value:new Qe(ma,Le.EMPTY_NODE)},MAX:{value:new Qe(to,$f)}});l1.__EMPTY_NODE=Le.EMPTY_NODE;En.__childrenNodeConstructor=Le;PB($f);MB($f);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB=!0;function jt(n,e=null){if(n===null)return Le.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),de(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new En(t,jt(e))}if(!(n instanceof Array)&&UB){const t=[];let r=!1;if(Nn(n,(o,l)=>{if(o.substring(0,1)!=="."){const u=jt(l);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new Qe(o,u)))}}),t.length===0)return Le.EMPTY_NODE;const s=pg(t,bB,o=>o.name,UT);if(r){const o=pg(t,St.getCompare());return new Le(s,jt(e),new zs({".priority":o},{".priority":St}))}else return new Le(s,jt(e),zs.Default)}else{let t=Le.EMPTY_NODE;return Nn(n,(r,i)=>{if(qr(n,r)&&r.substring(0,1)!=="."){const s=jt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(jt(e))}}DB(jt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT extends yy{constructor(e){super(),this.indexPath_=e,de(!We(e)&&ze(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ic(e.name,t.name):s}makePost(e,t){const r=jt(e),i=Le.EMPTY_NODE.updateChild(this.indexPath_,r);return new Qe(t,i)}maxPost(){const e=Le.EMPTY_NODE.updateChild(this.indexPath_,$f);return new Qe(to,e)}toString(){return cf(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB extends yy{compare(e,t){const r=e.node.compareTo(t.node);return r===0?ic(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Qe.MIN}maxPost(){return Qe.MAX}makePost(e,t){const r=jt(e);return new Qe(t,r)}toString(){return".value"}}const qT=new BB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(n){return{type:"value",snapshotNode:n}}function Au(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function uf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function df(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function qB(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){de(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(uf(t,l)):de(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(Au(t,r)):o.trackChildChange(df(t,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(St,(i,s)=>{t.hasChild(i)||r.trackChildChange(uf(i,s))}),t.isLeafNode()||t.forEachChild(St,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(df(i,s,o))}else r.trackChildChange(Au(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Le.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e){this.indexedFilter_=new HT(e.getIndex()),this.index_=e.getIndex(),this.startPost_=hf.getStartPost_(e),this.endPost_=hf.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Qe(t,r))||(r=Le.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Le.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Le.EMPTY_NODE);const s=this;return t.forEachChild(St,(o,l)=>{s.matches(new Qe(o,l))||(i=i.updateImmediateChild(o,Le.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new hf(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Qe(t,r))||(r=Le.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Le.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Le.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Le.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Le.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const v=this.index_.getCompare();o=(w,x)=>v(x,w)}else o=this.index_.getCompare();const l=e;de(l.numChildren()===this.limit_,"");const u=new Qe(t,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),p=this.rangedFilter_.matches(u);if(l.hasChild(t)){const v=l.getImmediateChild(t);let w=i.getChildAfterChild(this.index_,d,this.reverse_);for(;w!=null&&(w.name===t||l.hasChild(w.name));)w=i.getChildAfterChild(this.index_,w,this.reverse_);const x=w==null?1:o(w,u);if(p&&!r.isEmpty()&&x>=0)return s!=null&&s.trackChildChange(df(t,r,v)),l.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(uf(t,v));const R=l.updateImmediateChild(t,Le.EMPTY_NODE);return w!=null&&this.rangedFilter_.matches(w)?(s!=null&&s.trackChildChange(Au(w.name,w.node)),R.updateImmediateChild(w.name,w.node)):R}}else return r.isEmpty()?e:p&&o(d,u)>=0?(s!=null&&(s.trackChildChange(uf(d.name,d.node)),s.trackChildChange(Au(t,r))),l.updateImmediateChild(t,r).updateImmediateChild(d.name,Le.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=St}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return de(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return de(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ma}hasEnd(){return this.endSet_}getIndexEndValue(){return de(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return de(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:to}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return de(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===St}copy(){const e=new _y;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function GB(n){return n.loadsAllData()?new HT(n.getIndex()):n.hasLimit()?new HB(n):new hf(n)}function $B(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function jB(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function $w(n,e,t){const r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function zB(n,e,t){let r;return n.index_===ls||t?r=$w(n,e,t):r=$w(n,e,to),r.startAfterSet_=!0,r}function jw(n,e,t){const r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function WB(n,e,t){let r;return n.index_===ls||t?r=jw(n,e,t):r=jw(n,e,ma),r.endBeforeSet_=!0,r}function vy(n,e){const t=n.copy();return t.index_=e,t}function vA(n){const e={};if(n.isDefault())return e;let t;if(n.index_===St?t="$priority":n.index_===qT?t="$value":n.index_===ls?t="$key":(de(n.index_ instanceof BT,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=pn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=pn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+pn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=pn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+pn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function wA(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==St&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg extends i1{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(de(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Gf("p:rest:"),this.listens_={}}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=mg.getListenId_(e,r),l={};this.listens_[o]=l;const u=vA(e._queryParams);this.restRequest_(s+".json",u,(d,p)=>{let v=p;if(d===404&&(v=null,d=null),d===null&&this.onDataUpdate_(s,v,!1,r),Ml(this.listens_,o)===l){let w;d?d===401?w="permission_denied":w="rest_error:"+d:w="ok",i(w,null)}})}unlisten(e,t){const r=mg.getListenId_(e,t);delete this.listens_[r]}get(e){const t=vA(e._queryParams),r=e._path.toString(),i=new gr;return this.restRequest_(r+".json",t,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+nc(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let u=null;if(l.status>=200&&l.status<300){try{u=tf(l.responseText)}catch{Jn("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,u)}else l.status!==401&&l.status!==404&&Jn("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(){this.rootNode_=Le.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(){return{value:null,children:new Map}}function rd(n,e,t){if(We(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=ze(e);n.children.has(r)||n.children.set(r,gg());const i=n.children.get(r);e=Et(e),rd(i,e,t)}}function zw(n,e){if(We(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(St,(r,i)=>{rd(n,new mt(r),i)}),zw(n,e)}}else if(n.children.size>0){const t=ze(e);return e=Et(e),n.children.has(t)&&zw(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function Ww(n,e,t){n.value!==null?t(e,n.value):JB(n,(r,i)=>{const s=new mt(e.toString()+"/"+r);Ww(i,s,t)})}function JB(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&Nn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=10*1e3,YB=30*1e3,XB=300*1e3;class ZB{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new QB(e);const r=TA+(YB-TA)*Math.random();Fh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Nn(e,(i,s)=>{s>0&&qr(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Fh(this.reportStats_.bind(this),Math.floor(Math.random()*2*XB))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(xi||(xi={}));function GT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function $T(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function jT(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=xi.ACK_USER_WRITE,this.source=GT()}operationForChild(e){if(We(this.path)){if(this.affectedTree.value!=null)return de(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new mt(e));return new yg(lt(),t,this.revert)}}else return de(ze(this.path)===e,"operationForChild called for unrelated child."),new yg(Et(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t){this.source=e,this.path=t,this.type=xi.LISTEN_COMPLETE}operationForChild(e){return We(this.path)?new ff(this.source,lt()):new ff(this.source,Et(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=xi.OVERWRITE}operationForChild(e){return We(this.path)?new Ol(this.source,lt(),this.snap.getImmediateChild(e)):new Ol(this.source,Et(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=xi.MERGE}operationForChild(e){if(We(this.path)){const t=this.children.subtree(new mt(e));return t.isEmpty()?null:t.value?new Ol(this.source,lt(),t.value):new Nu(this.source,lt(),t)}else return de(ze(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Nu(this.source,Et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(We(e))return this.isFullyInitialized()&&!this.filtered_;const t=ze(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eq{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function tq(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(qB(o.childName,o.snapshotNode))}),hh(n,i,"child_removed",e,r,t),hh(n,i,"child_added",e,r,t),hh(n,i,"child_moved",s,r,t),hh(n,i,"child_changed",e,r,t),hh(n,i,"value",e,r,t),i}function hh(n,e,t,r,i,s){const o=r.filter(l=>l.type===t);o.sort((l,u)=>rq(n,l,u)),o.forEach(l=>{const u=nq(n,l,s);i.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(u,n.query_))})})}function nq(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function rq(n,e,t){if(e.childName==null||t.childName==null)throw Qu("Should only compare child_ events.");const r=new Qe(e.childName,e.snapshotNode),i=new Qe(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(n,e){return{eventCache:n,serverCache:e}}function Oh(n,e,t,r){return wy(new ya(e,t,r),n.serverCache)}function p1(n,e,t,r){return wy(n.eventCache,new ya(e,t,r))}function _g(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ul(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sw;const iq=()=>(sw||(sw=new rs(B6)),sw);class xt{static fromObject(e){let t=new xt(null);return Nn(e,(r,i)=>{t=t.set(new mt(r),i)}),t}constructor(e,t=iq()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:lt(),value:this.value};if(We(e))return null;{const r=ze(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Et(e),t);return s!=null?{path:Ft(new mt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(We(e))return this;{const t=ze(e),r=this.children.get(t);return r!==null?r.subtree(Et(e)):new xt(null)}}set(e,t){if(We(e))return new xt(t,this.children);{const r=ze(e),s=(this.children.get(r)||new xt(null)).set(Et(e),t),o=this.children.insert(r,s);return new xt(this.value,o)}}remove(e){if(We(e))return this.children.isEmpty()?new xt(null):new xt(null,this.children);{const t=ze(e),r=this.children.get(t);if(r){const i=r.remove(Et(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new xt(null):new xt(this.value,s)}else return this}}get(e){if(We(e))return this.value;{const t=ze(e),r=this.children.get(t);return r?r.get(Et(e)):null}}setTree(e,t){if(We(e))return t;{const r=ze(e),s=(this.children.get(r)||new xt(null)).setTree(Et(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new xt(this.value,o)}}fold(e){return this.fold_(lt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ft(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,lt(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(We(e))return null;{const s=ze(e),o=this.children.get(s);return o?o.findOnPath_(Et(e),Ft(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,lt(),t)}foreachOnPath_(e,t,r){if(We(e))return this;{this.value&&r(t,this.value);const i=ze(e),s=this.children.get(i);return s?s.foreachOnPath_(Et(e),Ft(t,i),r):new xt(null)}}foreach(e){this.foreach_(lt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ft(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.writeTree_=e}static empty(){return new Si(new xt(null))}}function Uh(n,e,t){if(We(e))return new Si(new xt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=rr(i,e);return s=s.updateChild(o,t),new Si(n.writeTree_.set(i,s))}else{const i=new xt(t),s=n.writeTree_.setTree(e,i);return new Si(s)}}}function Kw(n,e,t){let r=n;return Nn(t,(i,s)=>{r=Uh(r,Ft(e,i),s)}),r}function EA(n,e){if(We(e))return Si.empty();{const t=n.writeTree_.setTree(e,new xt(null));return new Si(t)}}function Jw(n,e){return sc(n,e)!=null}function sc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(rr(t.path,e)):null}function IA(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(St,(r,i)=>{e.push(new Qe(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Qe(r,i.value))}),e}function aa(n,e){if(We(e))return n;{const t=sc(n,e);return t!=null?new Si(new xt(t)):new Si(n.writeTree_.subtree(e))}}function Qw(n){return n.writeTree_.isEmpty()}function ku(n,e){return m1(lt(),n.writeTree_,e)}function m1(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(de(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=m1(Ft(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Ft(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(n,e){return v1(e,n)}function sq(n,e,t,r,i){de(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Uh(n.visibleWrites,e,t)),n.lastWriteId=r}function oq(n,e,t,r){de(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=Kw(n.visibleWrites,e,t),n.lastWriteId=r}function aq(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function lq(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);de(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=t&&cq(l,r.path)?i=!1:ni(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return uq(n),!0;if(r.snap)n.visibleWrites=EA(n.visibleWrites,r.path);else{const l=r.children;Nn(l,u=>{n.visibleWrites=EA(n.visibleWrites,Ft(r.path,u))})}return!0}else return!1}function cq(n,e){if(n.snap)return ni(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ni(Ft(n.path,t),e))return!0;return!1}function uq(n){n.visibleWrites=g1(n.allWrites,dq,lt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function dq(n){return n.visible}function g1(n,e,t){let r=Si.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let l;if(s.snap)ni(t,o)?(l=rr(t,o),r=Uh(r,l,s.snap)):ni(o,t)&&(l=rr(o,t),r=Uh(r,lt(),s.snap.getChild(l)));else if(s.children){if(ni(t,o))l=rr(t,o),r=Kw(r,l,s.children);else if(ni(o,t))if(l=rr(o,t),We(l))r=Kw(r,lt(),s.children);else{const u=Ml(s.children,ze(l));if(u){const d=u.getChild(Et(l));r=Uh(r,lt(),d)}}}else throw Qu("WriteRecord should have .snap or .children")}}return r}function y1(n,e,t,r,i){if(!r&&!i){const s=sc(n.visibleWrites,e);if(s!=null)return s;{const o=aa(n.visibleWrites,e);if(Qw(o))return t;if(t==null&&!Jw(o,lt()))return null;{const l=t||Le.EMPTY_NODE;return ku(o,l)}}}else{const s=aa(n.visibleWrites,e);if(!i&&Qw(s))return t;if(!i&&t==null&&!Jw(s,lt()))return null;{const o=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(ni(d.path,e)||ni(e,d.path))},l=g1(n.allWrites,o,e),u=t||Le.EMPTY_NODE;return ku(l,u)}}}function hq(n,e,t){let r=Le.EMPTY_NODE;const i=sc(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(St,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=aa(n.visibleWrites,e);return t.forEachChild(St,(o,l)=>{const u=ku(aa(s,new mt(o)),l);r=r.updateImmediateChild(o,u)}),IA(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=aa(n.visibleWrites,e);return IA(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function fq(n,e,t,r,i){de(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ft(e,t);if(Jw(n.visibleWrites,s))return null;{const o=aa(n.visibleWrites,s);return Qw(o)?i.getChild(t):ku(o,i.getChild(t))}}function pq(n,e,t,r){const i=Ft(e,t),s=sc(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=aa(n.visibleWrites,i);return ku(o,r.getNode().getImmediateChild(t))}else return null}function mq(n,e){return sc(n.visibleWrites,e)}function gq(n,e,t,r,i,s,o){let l;const u=aa(n.visibleWrites,e),d=sc(u,lt());if(d!=null)l=d;else if(t!=null)l=ku(u,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const p=[],v=o.getCompare(),w=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let x=w.getNext();for(;x&&p.length<i;)v(x,r)!==0&&p.push(x),x=w.getNext();return p}else return[]}function yq(){return{visibleWrites:Si.empty(),allWrites:[],lastWriteId:-1}}function vg(n,e,t,r){return y1(n.writeTree,n.treePath,e,t,r)}function zT(n,e){return hq(n.writeTree,n.treePath,e)}function xA(n,e,t,r){return fq(n.writeTree,n.treePath,e,t,r)}function wg(n,e){return mq(n.writeTree,Ft(n.treePath,e))}function _q(n,e,t,r,i,s){return gq(n.writeTree,n.treePath,e,t,r,i,s)}function WT(n,e,t){return pq(n.writeTree,n.treePath,e,t)}function _1(n,e){return v1(Ft(n.treePath,e),n.writeTree)}function v1(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vq{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;de(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),de(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,df(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,uf(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Au(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,df(r,e.snapshotNode,i.oldSnap));else throw Qu("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const w1=new wq;class KT{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new ya(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return WT(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ul(this.viewCache_),s=_q(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tq(n){return{filter:n}}function Eq(n,e){de(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),de(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Iq(n,e,t,r,i){const s=new vq;let o,l;if(t.type===xi.OVERWRITE){const d=t;d.source.fromUser?o=Yw(n,e,d.path,d.snap,r,i,s):(de(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!We(d.path),o=Tg(n,e,d.path,d.snap,r,i,l,s))}else if(t.type===xi.MERGE){const d=t;d.source.fromUser?o=Sq(n,e,d.path,d.children,r,i,s):(de(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),o=Xw(n,e,d.path,d.children,r,i,l,s))}else if(t.type===xi.ACK_USER_WRITE){const d=t;d.revert?o=Nq(n,e,d.path,r,i,s):o=Cq(n,e,d.path,d.affectedTree,r,i,s)}else if(t.type===xi.LISTEN_COMPLETE)o=Aq(n,e,t.path,r,s);else throw Qu("Unknown operation type: "+t.type);const u=s.getChanges();return xq(e,o,u),{viewCache:o,changes:u}}function xq(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=_g(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(f1(_g(e)))}}function T1(n,e,t,r,i,s){const o=e.eventCache;if(wg(r,t)!=null)return e;{let l,u;if(We(t))if(de(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=Ul(e),p=d instanceof Le?d:Le.EMPTY_NODE,v=zT(r,p);l=n.filter.updateFullNode(e.eventCache.getNode(),v,s)}else{const d=vg(r,Ul(e));l=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=ze(t);if(d===".priority"){de(ga(t)===1,"Can't have a priority with additional path components");const p=o.getNode();u=e.serverCache.getNode();const v=xA(r,t,p,u);v!=null?l=n.filter.updatePriority(p,v):l=o.getNode()}else{const p=Et(t);let v;if(o.isCompleteForChild(d)){u=e.serverCache.getNode();const w=xA(r,t,o.getNode(),u);w!=null?v=o.getNode().getImmediateChild(d).updateChild(p,w):v=o.getNode().getImmediateChild(d)}else v=WT(r,d,e.serverCache);v!=null?l=n.filter.updateChild(o.getNode(),d,v,p,i,s):l=o.getNode()}}return Oh(e,l,o.isFullyInitialized()||We(t),n.filter.filtersNodes())}}function Tg(n,e,t,r,i,s,o,l){const u=e.serverCache;let d;const p=o?n.filter:n.filter.getIndexedFilter();if(We(t))d=p.updateFullNode(u.getNode(),r,null);else if(p.filtersNodes()&&!u.isFiltered()){const x=u.getNode().updateChild(t,r);d=p.updateFullNode(u.getNode(),x,null)}else{const x=ze(t);if(!u.isCompleteForPath(t)&&ga(t)>1)return e;const A=Et(t),L=u.getNode().getImmediateChild(x).updateChild(A,r);x===".priority"?d=p.updatePriority(u.getNode(),L):d=p.updateChild(u.getNode(),x,L,A,w1,null)}const v=p1(e,d,u.isFullyInitialized()||We(t),p.filtersNodes()),w=new KT(i,v,s);return T1(n,v,t,i,w,l)}function Yw(n,e,t,r,i,s,o){const l=e.eventCache;let u,d;const p=new KT(i,e,s);if(We(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Oh(e,d,!0,n.filter.filtersNodes());else{const v=ze(t);if(v===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),u=Oh(e,d,l.isFullyInitialized(),l.isFiltered());else{const w=Et(t),x=l.getNode().getImmediateChild(v);let A;if(We(w))A=r;else{const R=p.getCompleteChild(v);R!=null?VT(w)===".priority"&&R.getChild(o1(w)).isEmpty()?A=R:A=R.updateChild(w,r):A=Le.EMPTY_NODE}if(x.equals(A))u=e;else{const R=n.filter.updateChild(l.getNode(),v,A,w,p,o);u=Oh(e,R,l.isFullyInitialized(),n.filter.filtersNodes())}}}return u}function SA(n,e){return n.eventCache.isCompleteForChild(e)}function Sq(n,e,t,r,i,s,o){let l=e;return r.foreach((u,d)=>{const p=Ft(t,u);SA(e,ze(p))&&(l=Yw(n,l,p,d,i,s,o))}),r.foreach((u,d)=>{const p=Ft(t,u);SA(e,ze(p))||(l=Yw(n,l,p,d,i,s,o))}),l}function CA(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Xw(n,e,t,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,d;We(t)?d=r:d=new xt(null).setTree(t,r);const p=e.serverCache.getNode();return d.children.inorderTraversal((v,w)=>{if(p.hasChild(v)){const x=e.serverCache.getNode().getImmediateChild(v),A=CA(n,x,w);u=Tg(n,u,new mt(v),A,i,s,o,l)}}),d.children.inorderTraversal((v,w)=>{const x=!e.serverCache.isCompleteForChild(v)&&w.value===null;if(!p.hasChild(v)&&!x){const A=e.serverCache.getNode().getImmediateChild(v),R=CA(n,A,w);u=Tg(n,u,new mt(v),R,i,s,o,l)}}),u}function Cq(n,e,t,r,i,s,o){if(wg(i,t)!=null)return e;const l=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(We(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return Tg(n,e,t,u.getNode().getChild(t),i,s,l,o);if(We(t)){let d=new xt(null);return u.getNode().forEachChild(ls,(p,v)=>{d=d.set(new mt(p),v)}),Xw(n,e,t,d,i,s,l,o)}else return e}else{let d=new xt(null);return r.foreach((p,v)=>{const w=Ft(t,p);u.isCompleteForPath(w)&&(d=d.set(p,u.getNode().getChild(w)))}),Xw(n,e,t,d,i,s,l,o)}}function Aq(n,e,t,r,i){const s=e.serverCache,o=p1(e,s.getNode(),s.isFullyInitialized()||We(t),s.isFiltered());return T1(n,o,t,r,w1,i)}function Nq(n,e,t,r,i,s){let o;if(wg(r,t)!=null)return e;{const l=new KT(r,e,i),u=e.eventCache.getNode();let d;if(We(t)||ze(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=vg(r,Ul(e));else{const v=e.serverCache.getNode();de(v instanceof Le,"serverChildren would be complete if leaf node"),p=zT(r,v)}p=p,d=n.filter.updateFullNode(u,p,s)}else{const p=ze(t);let v=WT(r,p,e.serverCache);v==null&&e.serverCache.isCompleteForChild(p)&&(v=u.getImmediateChild(p)),v!=null?d=n.filter.updateChild(u,p,v,Et(t),l,s):e.eventCache.getNode().hasChild(p)?d=n.filter.updateChild(u,p,Le.EMPTY_NODE,Et(t),l,s):d=u,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=vg(r,Ul(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||wg(r,lt())!=null,Oh(e,d,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kq{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new HT(r.getIndex()),s=GB(r);this.processor_=Tq(s);const o=t.serverCache,l=t.eventCache,u=i.updateFullNode(Le.EMPTY_NODE,o.getNode(),null),d=s.updateFullNode(Le.EMPTY_NODE,l.getNode(),null),p=new ya(u,o.isFullyInitialized(),i.filtersNodes()),v=new ya(d,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=wy(v,p),this.eventGenerator_=new eq(this.query_)}get query(){return this.query_}}function Rq(n){return n.viewCache_.serverCache.getNode()}function bq(n){return _g(n.viewCache_)}function Pq(n,e){const t=Ul(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!We(e)&&!t.getImmediateChild(ze(e)).isEmpty())?t.getChild(e):null}function AA(n){return n.eventRegistrations_.length===0}function Dq(n,e){n.eventRegistrations_.push(e)}function NA(n,e,t){const r=[];if(t){de(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function kA(n,e,t,r){e.type===xi.MERGE&&e.source.queryId!==null&&(de(Ul(n.viewCache_),"We should always have a full cache before handling merges"),de(_g(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=Iq(n.processor_,i,e,t,r);return Eq(n.processor_,s.viewCache),de(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,E1(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Mq(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(St,(s,o)=>{r.push(Au(s,o))}),t.isFullyInitialized()&&r.push(f1(t.getNode())),E1(n,r,t.getNode(),e)}function E1(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return tq(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eg;class I1{constructor(){this.views=new Map}}function Lq(n){de(!Eg,"__referenceConstructor has already been defined"),Eg=n}function Vq(){return de(Eg,"Reference.ts has not been loaded"),Eg}function Fq(n){return n.views.size===0}function JT(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return de(s!=null,"SyncTree gave us an op for an invalid query."),kA(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(kA(o,e,t,r));return s}}function x1(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let l=vg(t,i?r:null),u=!1;l?u=!0:r instanceof Le?(l=zT(t,r),u=!1):(l=Le.EMPTY_NODE,u=!1);const d=wy(new ya(l,u,!1),new ya(r,i,!1));return new kq(e,d)}return o}function Oq(n,e,t,r,i,s){const o=x1(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),Dq(o,t),Mq(o,t)}function Uq(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const l=_a(n);if(i==="default")for(const[u,d]of n.views.entries())o=o.concat(NA(d,t,r)),AA(d)&&(n.views.delete(u),d.query._queryParams.loadsAllData()||s.push(d.query));else{const u=n.views.get(i);u&&(o=o.concat(NA(u,t,r)),AA(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return l&&!_a(n)&&s.push(new(Vq())(e._repo,e._path)),{removed:s,events:o}}function S1(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function la(n,e){let t=null;for(const r of n.views.values())t=t||Pq(r,e);return t}function C1(n,e){if(e._queryParams.loadsAllData())return Ey(n);{const r=e._queryIdentifier;return n.views.get(r)}}function A1(n,e){return C1(n,e)!=null}function _a(n){return Ey(n)!=null}function Ey(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ig;function Bq(n){de(!Ig,"__referenceConstructor has already been defined"),Ig=n}function qq(){return de(Ig,"Reference.ts has not been loaded"),Ig}let Hq=1;class RA{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xt(null),this.pendingWriteTree_=yq(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function QT(n,e,t,r,i){return sq(n.pendingWriteTree_,e,t,r,i),i?id(n,new Ol(GT(),e,t)):[]}function Gq(n,e,t,r){oq(n.pendingWriteTree_,e,t,r);const i=xt.fromObject(t);return id(n,new Nu(GT(),e,i))}function ta(n,e,t=!1){const r=aq(n.pendingWriteTree_,e);if(lq(n.pendingWriteTree_,e)){let s=new xt(null);return r.snap!=null?s=s.set(lt(),!0):Nn(r.children,o=>{s=s.set(new mt(o),!0)}),id(n,new yg(r.path,s,t))}else return[]}function jf(n,e,t){return id(n,new Ol($T(),e,t))}function $q(n,e,t){const r=xt.fromObject(t);return id(n,new Nu($T(),e,r))}function jq(n,e){return id(n,new ff($T(),e))}function zq(n,e,t){const r=YT(n,t);if(r){const i=XT(r),s=i.path,o=i.queryId,l=rr(s,e),u=new ff(jT(o),l);return ZT(n,s,u)}else return[]}function xg(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||A1(o,e))){const u=Uq(o,e,t,r);Fq(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const d=u.removed;if(l=u.events,!i){const p=d.findIndex(w=>w._queryParams.loadsAllData())!==-1,v=n.syncPointTree_.findOnPath(s,(w,x)=>_a(x));if(p&&!v){const w=n.syncPointTree_.subtree(s);if(!w.isEmpty()){const x=Jq(w);for(let A=0;A<x.length;++A){const R=x[A],L=R.query,j=b1(n,R);n.listenProvider_.startListening(Bh(L),pf(n,L),j.hashFn,j.onComplete)}}}!v&&d.length>0&&!r&&(p?n.listenProvider_.stopListening(Bh(e),null):d.forEach(w=>{const x=n.queryToTagMap.get(xy(w));n.listenProvider_.stopListening(Bh(w),x)}))}Qq(n,d)}return l}function N1(n,e,t,r){const i=YT(n,r);if(i!=null){const s=XT(i),o=s.path,l=s.queryId,u=rr(o,e),d=new Ol(jT(l),u,t);return ZT(n,o,d)}else return[]}function Wq(n,e,t,r){const i=YT(n,r);if(i){const s=XT(i),o=s.path,l=s.queryId,u=rr(o,e),d=xt.fromObject(t),p=new Nu(jT(l),u,d);return ZT(n,o,p)}else return[]}function Zw(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(w,x)=>{const A=rr(w,i);s=s||la(x,A),o=o||_a(x)});let l=n.syncPointTree_.get(i);l?(o=o||_a(l),s=s||la(l,lt())):(l=new I1,n.syncPointTree_=n.syncPointTree_.set(i,l));let u;s!=null?u=!0:(u=!1,s=Le.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((x,A)=>{const R=la(A,lt());R&&(s=s.updateImmediateChild(x,R))}));const d=A1(l,e);if(!d&&!e._queryParams.loadsAllData()){const w=xy(e);de(!n.queryToTagMap.has(w),"View does not exist, but we have a tag");const x=Yq();n.queryToTagMap.set(w,x),n.tagToQueryMap.set(x,w)}const p=Ty(n.pendingWriteTree_,i);let v=Oq(l,e,t,p,s,u);if(!d&&!o&&!r){const w=C1(l,e);v=v.concat(Xq(n,e,w))}return v}function Iy(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,l)=>{const u=rr(o,e),d=la(l,u);if(d)return d});return y1(i,e,s,t,!0)}function Kq(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(d,p)=>{const v=rr(d,t);r=r||la(p,v)});let i=n.syncPointTree_.get(t);i?r=r||la(i,lt()):(i=new I1,n.syncPointTree_=n.syncPointTree_.set(t,i));const s=r!=null,o=s?new ya(r,!0,!1):null,l=Ty(n.pendingWriteTree_,e._path),u=x1(i,e,l,s?o.getNode():Le.EMPTY_NODE,s);return bq(u)}function id(n,e){return k1(e,n.syncPointTree_,null,Ty(n.pendingWriteTree_,lt()))}function k1(n,e,t,r){if(We(n.path))return R1(n,e,t,r);{const i=e.get(lt());t==null&&i!=null&&(t=la(i,lt()));let s=[];const o=ze(n.path),l=n.operationForChild(o),u=e.children.get(o);if(u&&l){const d=t?t.getImmediateChild(o):null,p=_1(r,o);s=s.concat(k1(l,u,d,p))}return i&&(s=s.concat(JT(i,n,r,t))),s}}function R1(n,e,t,r){const i=e.get(lt());t==null&&i!=null&&(t=la(i,lt()));let s=[];return e.children.inorderTraversal((o,l)=>{const u=t?t.getImmediateChild(o):null,d=_1(r,o),p=n.operationForChild(o);p&&(s=s.concat(R1(p,l,u,d)))}),i&&(s=s.concat(JT(i,n,r,t))),s}function b1(n,e){const t=e.query,r=pf(n,t);return{hashFn:()=>(Rq(e)||Le.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?zq(n,t._path,r):jq(n,t._path);{const s=G6(i,t);return xg(n,t,null,s)}}}}function pf(n,e){const t=xy(e);return n.queryToTagMap.get(t)}function xy(n){return n._path.toString()+"$"+n._queryIdentifier}function YT(n,e){return n.tagToQueryMap.get(e)}function XT(n){const e=n.indexOf("$");return de(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new mt(n.substr(0,e))}}function ZT(n,e,t){const r=n.syncPointTree_.get(e);de(r,"Missing sync point for query tag that we're tracking");const i=Ty(n.pendingWriteTree_,e);return JT(r,t,i,null)}function Jq(n){return n.fold((e,t,r)=>{if(t&&_a(t))return[Ey(t)];{let i=[];return t&&(i=S1(t)),Nn(r,(s,o)=>{i=i.concat(o)}),i}})}function Bh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(qq())(n._repo,n._path):n}function Qq(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=xy(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function Yq(){return Hq++}function Xq(n,e,t){const r=e._path,i=pf(n,e),s=b1(n,t),o=n.listenProvider_.startListening(Bh(e),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)de(!_a(l.value),"If we're adding a query, it shouldn't be shadowed");else{const u=l.fold((d,p,v)=>{if(!We(d)&&p&&_a(p))return[Ey(p).query];{let w=[];return p&&(w=w.concat(S1(p).map(x=>x.query))),Nn(v,(x,A)=>{w=w.concat(A)}),w}});for(let d=0;d<u.length;++d){const p=u[d];n.listenProvider_.stopListening(Bh(p),pf(n,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new eE(t)}node(){return this.node_}}class tE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ft(this.path_,e);return new tE(this.syncTree_,t)}node(){return Iy(this.syncTree_,this.path_)}}const Zq=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},bA=function(n,e,t){if(!n||typeof n!="object")return n;if(de(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return e9(n[".sv"],e,t);if(typeof n[".sv"]=="object")return t9(n[".sv"],e);de(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},e9=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:de(!1,"Unexpected server value: "+n)}},t9=function(n,e,t){n.hasOwnProperty("increment")||de(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&de(!1,"Unexpected increment value: "+r);const i=e.node();if(de(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},P1=function(n,e,t,r){return rE(e,new tE(t,n),r)},nE=function(n,e,t){return rE(n,new eE(e),t)};function rE(n,e,t){const r=n.getPriority().val(),i=bA(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,l=bA(o.getValue(),e,t);return l!==o.getValue()||i!==o.getPriority().val()?new En(l,jt(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new En(i))),o.forEachChild(St,(l,u)=>{const d=rE(u,e.getImmediateChild(l),t);d!==u&&(s=s.updateImmediateChild(l,d))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Sy(n,e){let t=e instanceof mt?e:new mt(e),r=n,i=ze(t);for(;i!==null;){const s=Ml(r.node.children,i)||{children:{},childCount:0};r=new iE(i,r,s),t=Et(t),i=ze(t)}return r}function oc(n){return n.node.value}function sE(n,e){n.node.value=e,e0(n)}function D1(n){return n.node.childCount>0}function n9(n){return oc(n)===void 0&&!D1(n)}function Cy(n,e){Nn(n.node.children,(t,r)=>{e(new iE(t,n,r))})}function M1(n,e,t,r){t&&e(n),Cy(n,i=>{M1(i,e,!0)})}function r9(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function zf(n){return new mt(n.parent===null?n.name:zf(n.parent)+"/"+n.name)}function e0(n){n.parent!==null&&i9(n.parent,n.name,n)}function i9(n,e,t){const r=n9(t),i=qr(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,e0(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,e0(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9=/[\[\].#$\/\u0000-\u001F\u007F]/,o9=/[\[\].#$\u0000-\u001F\u007F]/,ow=10*1024*1024,Ay=function(n){return typeof n=="string"&&n.length!==0&&!s9.test(n)},L1=function(n){return typeof n=="string"&&n.length!==0&&!o9.test(n)},a9=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),L1(n)},mf=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!gy(n)||n&&typeof n=="object"&&qr(n,".sv")},gs=function(n,e,t,r){r&&e===void 0||Wf(wr(n,"value"),e,t)},Wf=function(n,e,t){const r=t instanceof mt?new IB(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+pl(r));if(typeof e=="function")throw new Error(n+"contains a function "+pl(r)+" with contents = "+e.toString());if(gy(e))throw new Error(n+"contains "+e.toString()+" "+pl(r));if(typeof e=="string"&&e.length>ow/3&&ry(e)>ow)throw new Error(n+"contains a string greater than "+ow+" utf8 bytes "+pl(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Nn(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ay(o)))throw new Error(n+" contains an invalid key ("+o+") "+pl(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);xB(r,o),Wf(n,l,r),SB(r)}),i&&s)throw new Error(n+' contains ".value" child '+pl(r)+" in addition to actual children.")}},l9=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=cf(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Ay(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(EB);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&ni(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},V1=function(n,e,t,r){const i=wr(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Nn(e,(o,l)=>{const u=new mt(o);if(Wf(i,l,Ft(t,u)),VT(u)===".priority"&&!mf(l))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),l9(i,s)},oE=function(n,e,t){if(gy(e))throw new Error(wr(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!mf(e))throw new Error(wr(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Kf=function(n,e,t,r){if(t!==void 0&&!Ay(t))throw new Error(wr(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},gf=function(n,e,t,r){if(!L1(t))throw new Error(wr(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},c9=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),gf(n,e,t)},ri=function(n,e){if(ze(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},F1=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ay(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!a9(t))throw new Error(wr(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ny(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!FT(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function O1(n,e,t){Ny(n,t),U1(n,r=>FT(r,e))}function Hr(n,e,t){Ny(n,t),U1(n,r=>ni(r,e)||ni(e,r))}function U1(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(d9(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function d9(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();bl&&Cn("event: "+t.toString()),nd(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="repo_interrupt",h9=25;class f9{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new u9,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gg(),this.transactionQueueTree_=new iE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function p9(n,e,t){if(n.stats_=MT(n.repoInfo_),n.forceRestClient_||W6())n.server_=new mg(n.repoInfo_,(r,i,s,o)=>{PA(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>DA(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{pn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Ys(n.repoInfo_,e,(r,i,s,o)=>{PA(n,r,i,s,o)},r=>{DA(n,r)},r=>{m9(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=X6(n.repoInfo_,()=>new ZB(n.stats_,n.server_)),n.infoData_=new KB,n.infoSyncTree_=new RA({startListening:(r,i,s,o)=>{let l=[];const u=n.infoData_.getNode(r._path);return u.isEmpty()||(l=jf(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),aE(n,"connected",!1),n.serverSyncTree_=new RA({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,u)=>{const d=o(l,u);Hr(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function q1(n){const t=n.infoData_.getNode(new mt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Jf(n){return Zq({timestamp:q1(n)})}function PA(n,e,t,r,i){n.dataUpdateCount++;const s=new mt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const u=ig(t,d=>jt(d));o=Wq(n.serverSyncTree_,s,u,i)}else{const u=jt(t);o=N1(n.serverSyncTree_,s,u,i)}else if(r){const u=ig(t,d=>jt(d));o=$q(n.serverSyncTree_,s,u)}else{const u=jt(t);o=jf(n.serverSyncTree_,s,u)}let l=s;o.length>0&&(l=Ru(n,s)),Hr(n.eventQueue_,l,o)}function DA(n,e){aE(n,"connected",e),e===!1&&_9(n)}function m9(n,e){Nn(e,(t,r)=>{aE(n,t,r)})}function aE(n,e,t){const r=new mt("/.info/"+e),i=jt(t);n.infoData_.updateSnapshot(r,i);const s=jf(n.infoSyncTree_,r,i);Hr(n.eventQueue_,r,s)}function ky(n){return n.nextWriteId_++}function g9(n,e,t){const r=Kq(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{const s=jt(i).withIndex(e._queryParams.getIndex());Zw(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=jf(n.serverSyncTree_,e._path,s);else{const l=pf(n.serverSyncTree_,e);o=N1(n.serverSyncTree_,e._path,s,l)}return Hr(n.eventQueue_,e._path,o),xg(n.serverSyncTree_,e,t,null,!0),s},i=>(sd(n,"get for query "+pn(e)+" failed: "+i),Promise.reject(new Error(i))))}function lE(n,e,t,r,i){sd(n,"set",{path:e.toString(),value:t,priority:r});const s=Jf(n),o=jt(t,r),l=Iy(n.serverSyncTree_,e),u=nE(o,l,s),d=ky(n),p=QT(n.serverSyncTree_,e,u,d,!0);Ny(n.eventQueue_,p),n.server_.put(e.toString(),o.val(!0),(w,x)=>{const A=w==="ok";A||Jn("set at "+e+" failed: "+w);const R=ta(n.serverSyncTree_,d,!A);Hr(n.eventQueue_,e,R),va(n,i,w,x)});const v=uE(n,e);Ru(n,v),Hr(n.eventQueue_,v,[])}function y9(n,e,t,r){sd(n,"update",{path:e.toString(),value:t});let i=!0;const s=Jf(n),o={};if(Nn(t,(l,u)=>{i=!1,o[l]=P1(Ft(e,l),jt(u),n.serverSyncTree_,s)}),i)Cn("update() called with empty data.  Don't do anything."),va(n,r,"ok",void 0);else{const l=ky(n),u=Gq(n.serverSyncTree_,e,o,l);Ny(n.eventQueue_,u),n.server_.merge(e.toString(),t,(d,p)=>{const v=d==="ok";v||Jn("update at "+e+" failed: "+d);const w=ta(n.serverSyncTree_,l,!v),x=w.length>0?Ru(n,e):e;Hr(n.eventQueue_,x,w),va(n,r,d,p)}),Nn(t,d=>{const p=uE(n,Ft(e,d));Ru(n,p)}),Hr(n.eventQueue_,e,[])}}function _9(n){sd(n,"onDisconnectEvents");const e=Jf(n),t=gg();Ww(n.onDisconnect_,lt(),(i,s)=>{const o=P1(i,s,n.serverSyncTree_,e);rd(t,i,o)});let r=[];Ww(t,lt(),(i,s)=>{r=r.concat(jf(n.serverSyncTree_,i,s));const o=uE(n,i);Ru(n,o)}),n.onDisconnect_=gg(),Hr(n.eventQueue_,lt(),r)}function v9(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&zw(n.onDisconnect_,e),va(n,t,r,i)})}function MA(n,e,t,r){const i=jt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&rd(n.onDisconnect_,e,i),va(n,r,s,o)})}function w9(n,e,t,r,i){const s=jt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&rd(n.onDisconnect_,e,s),va(n,i,o,l)})}function T9(n,e,t,r){if(rg(t)){Cn("onDisconnect().update() called with empty data.  Don't do anything."),va(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Nn(t,(o,l)=>{const u=jt(l);rd(n.onDisconnect_,Ft(e,o),u)}),va(n,r,i,s)})}function E9(n,e,t){let r;ze(e._path)===".info"?r=Zw(n.infoSyncTree_,e,t):r=Zw(n.serverSyncTree_,e,t),O1(n.eventQueue_,e._path,r)}function t0(n,e,t){let r;ze(e._path)===".info"?r=xg(n.infoSyncTree_,e,t):r=xg(n.serverSyncTree_,e,t),O1(n.eventQueue_,e._path,r)}function H1(n){n.persistentConnection_&&n.persistentConnection_.interrupt(B1)}function I9(n){n.persistentConnection_&&n.persistentConnection_.resume(B1)}function sd(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Cn(t,...e)}function va(n,e,t,r){e&&nd(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function x9(n,e,t,r,i,s){sd(n,"transaction on "+e);const o={path:e,update:t,onComplete:r,status:null,order:FP(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=cE(n,e,void 0);o.currentInputSnapshot=l;const u=o.update(l.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Wf("transaction failed: Data returned ",u,o.path),o.status=0;const d=Sy(n.transactionQueueTree_,e),p=oc(d)||[];p.push(o),sE(d,p);let v;typeof u=="object"&&u!==null&&qr(u,".priority")?(v=Ml(u,".priority"),de(mf(v),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):v=(Iy(n.serverSyncTree_,e)||Le.EMPTY_NODE).getPriority().val();const w=Jf(n),x=jt(u,v),A=nE(x,l,w);o.currentOutputSnapshotRaw=x,o.currentOutputSnapshotResolved=A,o.currentWriteId=ky(n);const R=QT(n.serverSyncTree_,e,A,o.currentWriteId,o.applyLocally);Hr(n.eventQueue_,e,R),Ry(n,n.transactionQueueTree_)}}function cE(n,e,t){return Iy(n.serverSyncTree_,e,t)||Le.EMPTY_NODE}function Ry(n,e=n.transactionQueueTree_){if(e||by(n,e),oc(e)){const t=$1(n,e);de(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&S9(n,zf(e),t)}else D1(e)&&Cy(e,t=>{Ry(n,t)})}function S9(n,e,t){const r=t.map(d=>d.currentWriteId),i=cE(n,e,r);let s=i;const o=i.hash();for(let d=0;d<t.length;d++){const p=t[d];de(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const v=rr(e,p.path);s=s.updateChild(v,p.currentOutputSnapshotRaw)}const l=s.val(!0),u=e;n.server_.put(u.toString(),l,d=>{sd(n,"transaction put response",{path:u.toString(),status:d});let p=[];if(d==="ok"){const v=[];for(let w=0;w<t.length;w++)t[w].status=2,p=p.concat(ta(n.serverSyncTree_,t[w].currentWriteId)),t[w].onComplete&&v.push(()=>t[w].onComplete(null,!0,t[w].currentOutputSnapshotResolved)),t[w].unwatcher();by(n,Sy(n.transactionQueueTree_,e)),Ry(n,n.transactionQueueTree_),Hr(n.eventQueue_,e,p);for(let w=0;w<v.length;w++)nd(v[w])}else{if(d==="datastale")for(let v=0;v<t.length;v++)t[v].status===3?t[v].status=4:t[v].status=0;else{Jn("transaction at "+u.toString()+" failed: "+d);for(let v=0;v<t.length;v++)t[v].status=4,t[v].abortReason=d}Ru(n,e)}},o)}function Ru(n,e){const t=G1(n,e),r=zf(t),i=$1(n,t);return C9(n,i,r),r}function C9(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const u=e[l],d=rr(t,u.path);let p=!1,v;if(de(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)p=!0,v=u.abortReason,i=i.concat(ta(n.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=h9)p=!0,v="maxretry",i=i.concat(ta(n.serverSyncTree_,u.currentWriteId,!0));else{const w=cE(n,u.path,o);u.currentInputSnapshot=w;const x=e[l].update(w.val());if(x!==void 0){Wf("transaction failed: Data returned ",x,u.path);let A=jt(x);typeof x=="object"&&x!=null&&qr(x,".priority")||(A=A.updatePriority(w.getPriority()));const L=u.currentWriteId,j=Jf(n),B=nE(A,w,j);u.currentOutputSnapshotRaw=A,u.currentOutputSnapshotResolved=B,u.currentWriteId=ky(n),o.splice(o.indexOf(L),1),i=i.concat(QT(n.serverSyncTree_,u.path,B,u.currentWriteId,u.applyLocally)),i=i.concat(ta(n.serverSyncTree_,L,!0))}else p=!0,v="nodata",i=i.concat(ta(n.serverSyncTree_,u.currentWriteId,!0))}Hr(n.eventQueue_,t,i),i=[],p&&(e[l].status=2,(function(w){setTimeout(w,Math.floor(0))})(e[l].unwatcher),e[l].onComplete&&(v==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(v),!1,null))))}by(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)nd(r[l]);Ry(n,n.transactionQueueTree_)}function G1(n,e){let t,r=n.transactionQueueTree_;for(t=ze(e);t!==null&&oc(r)===void 0;)r=Sy(r,t),e=Et(e),t=ze(e);return r}function $1(n,e){const t=[];return j1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function j1(n,e,t){const r=oc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Cy(e,i=>{j1(n,i,t)})}function by(n,e){const t=oc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,sE(e,t.length>0?t:void 0)}Cy(e,r=>{by(n,r)})}function uE(n,e){const t=zf(G1(n,e)),r=Sy(n.transactionQueueTree_,e);return r9(r,i=>{aw(n,i)}),aw(n,r),M1(r,i=>{aw(n,i)}),t}function aw(n,e){const t=oc(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(de(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(de(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(ta(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?sE(e,void 0):t.length=s+1,Hr(n.eventQueue_,zf(e),i);for(let o=0;o<r.length;o++)nd(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function N9(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Jn(`Invalid query segment '${t}' in query '${n}'`)}return e}const n0=function(n,e){const t=k9(n),r=t.namespace;t.domain==="firebase.com"&&ms(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ms("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||O6();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new YP(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new mt(t.pathString)}},k9=function(n){let e="",t="",r="",i="",s="",o=!0,l="https",u=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let p=n.indexOf("/");p===-1&&(p=n.length);let v=n.indexOf("?");v===-1&&(v=n.length),e=n.substring(0,Math.min(p,v)),p<v&&(i=A9(n.substring(p,v)));const w=N9(n.substring(Math.min(n.length,v)));d=e.indexOf(":"),d>=0?(o=l==="https"||l==="wss",u=parseInt(e.substring(d+1),10)):d=e.length;const x=e.slice(0,d);if(x.toLowerCase()==="localhost")t="localhost";else if(x.split(".").length<=2)t=x;else{const A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),t=e.substring(A+1),s=r}"ns"in w&&(s=w.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",R9=(function(){let n=0;const e=[];return function(t){const r=t===n;n=t;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=LA.charAt(t%64),t=Math.floor(t/64);de(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=LA.charAt(e[i]);return de(o.length===20,"nextPushId: Length should be 20."),o}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+pn(this.snapshot.exportVal())}}class W1{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return de(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b9=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new gr;return v9(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ri("OnDisconnect.remove",this._path);const e=new gr;return MA(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ri("OnDisconnect.set",this._path),gs("OnDisconnect.set",e,this._path,!1);const t=new gr;return MA(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){ri("OnDisconnect.setWithPriority",this._path),gs("OnDisconnect.setWithPriority",e,this._path,!1),oE("OnDisconnect.setWithPriority",t);const r=new gr;return w9(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){ri("OnDisconnect.update",this._path),V1("OnDisconnect.update",e,this._path);const t=new gr;return T9(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return We(this._path)?null:VT(this._path)}get ref(){return new li(this._repo,this._path)}get _queryIdentifier(){const e=wA(this._queryParams),t=PT(e);return t==="{}"?"default":t}get _queryObject(){return wA(this._queryParams)}isEqual(e){if(e=Ee(e),!(e instanceof Er))return!1;const t=this._repo===e._repo,r=FT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+TB(this._path)}}function Py(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ba(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ls){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ma)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==to)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===St){if(e!=null&&!mf(e)||t!=null&&!mf(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(de(n.getIndex()instanceof BT||n.getIndex()===qT,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Dy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class li extends Er{constructor(e,t){super(e,t,new _y,!1)}get parent(){const e=o1(this._path);return e===null?null:new li(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let My=class r0{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new mt(e),r=Bl(this.ref,e);return new r0(this._node.getChild(t),r,St)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new r0(i,Bl(this.ref,r),St)))}hasChild(e){const t=new mt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function K1(n,e){return n=Ee(n),n._checkNotDeleted("ref"),e!==void 0?Bl(n._root,e):n._root}function VA(n,e){n=Ee(n),n._checkNotDeleted("refFromURL");const t=n0(e,n._repo.repoInfo_.nodeAdmin);F1("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ms("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),K1(n,t.path.toString())}function Bl(n,e){return n=Ee(n),ze(n._path)===null?c9("child","path",e):gf("child","path",e),new li(n._repo,Ft(n._path,e))}function P9(n,e){n=Ee(n),ri("push",n._path),gs("push",e,n._path,!0);const t=q1(n._repo),r=R9(t),i=Bl(n,r),s=Bl(n,r);let o;return e!=null?o=hE(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function D9(n){return ri("remove",n._path),hE(n,null)}function hE(n,e){n=Ee(n),ri("set",n._path),gs("set",e,n._path,!1);const t=new gr;return lE(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function M9(n,e){n=Ee(n),ri("setPriority",n._path),oE("setPriority",e);const t=new gr;return lE(n._repo,Ft(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function L9(n,e,t){if(ri("setWithPriority",n._path),gs("setWithPriority",e,n._path,!1),oE("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new gr;return lE(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function V9(n,e){V1("update",e,n._path);const t=new gr;return y9(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function F9(n){n=Ee(n);const e=new dE(()=>{}),t=new Qf(e);return g9(n._repo,n,t).then(r=>new My(r,new li(n._repo,n._path),n._queryParams.getIndex()))}class Qf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new z1("value",this,new My(e.snapshotNode,new li(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new W1(this,e,t):null}matches(e){return e instanceof Qf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ly{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new W1(this,e,t):null}createEvent(e,t){de(e.childName!=null,"Child events should have a childName.");const r=Bl(new li(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new z1(e.type,this,new My(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Ly?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Yf(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const u=t,d=(p,v)=>{t0(n._repo,n,l),u(p,v)};d.userCallback=t.userCallback,d.context=t.context,t=d}const o=new dE(t,s||void 0),l=e==="value"?new Qf(o):new Ly(e,o);return E9(n._repo,n,l),()=>t0(n._repo,n,l)}function i0(n,e,t,r){return Yf(n,"value",e,t,r)}function FA(n,e,t,r){return Yf(n,"child_added",e,t,r)}function OA(n,e,t,r){return Yf(n,"child_changed",e,t,r)}function UA(n,e,t,r){return Yf(n,"child_moved",e,t,r)}function BA(n,e,t,r){return Yf(n,"child_removed",e,t,r)}function qA(n,e,t){let r=null;const i=t?new dE(t):null;e==="value"?r=new Qf(i):e&&(r=new Ly(e,i)),t0(n._repo,n,r)}let ki=class{},J1=class extends ki{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){gs("endAt",this._value,e._path,!0);const t=jw(e._queryParams,this._value,this._key);if(Dy(t),ba(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Er(e._repo,e._path,t,e._orderByCalled)}};function O9(n,e){return Kf("endAt","key",e),new J1(n,e)}class U9 extends ki{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){gs("endBefore",this._value,e._path,!1);const t=WB(e._queryParams,this._value,this._key);if(Dy(t),ba(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Er(e._repo,e._path,t,e._orderByCalled)}}function B9(n,e){return Kf("endBefore","key",e),new U9(n,e)}let Q1=class extends ki{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){gs("startAt",this._value,e._path,!0);const t=$w(e._queryParams,this._value,this._key);if(Dy(t),ba(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Er(e._repo,e._path,t,e._orderByCalled)}};function q9(n=null,e){return Kf("startAt","key",e),new Q1(n,e)}class H9 extends ki{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){gs("startAfter",this._value,e._path,!1);const t=zB(e._queryParams,this._value,this._key);if(Dy(t),ba(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Er(e._repo,e._path,t,e._orderByCalled)}}function G9(n,e){return Kf("startAfter","key",e),new H9(n,e)}class $9 extends ki{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Er(e._repo,e._path,$B(e._queryParams,this._limit),e._orderByCalled)}}function j9(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new $9(n)}class z9 extends ki{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Er(e._repo,e._path,jB(e._queryParams,this._limit),e._orderByCalled)}}function W9(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new z9(n)}class K9 extends ki{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Py(e,"orderByChild");const t=new mt(this._path);if(We(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new BT(t),i=vy(e._queryParams,r);return ba(i),new Er(e._repo,e._path,i,!0)}}function J9(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return gf("orderByChild","path",n),new K9(n)}class Q9 extends ki{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Py(e,"orderByKey");const t=vy(e._queryParams,ls);return ba(t),new Er(e._repo,e._path,t,!0)}}function Y9(){return new Q9}class X9 extends ki{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Py(e,"orderByPriority");const t=vy(e._queryParams,St);return ba(t),new Er(e._repo,e._path,t,!0)}}function Z9(){return new X9}class e7 extends ki{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Py(e,"orderByValue");const t=vy(e._queryParams,qT);return ba(t),new Er(e._repo,e._path,t,!0)}}function t7(){return new e7}class n7 extends ki{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(gs("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new J1(this._value,this._key)._apply(new Q1(this._value,this._key)._apply(e))}}function r7(n,e){return Kf("equalTo","key",e),new n7(n,e)}function Ti(n,...e){let t=Ee(n);for(const r of e)t=r._apply(t);return t}Lq(li);Bq(li);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7="FIREBASE_DATABASE_EMULATOR_HOST",s0={};let s7=!1;function o7(n,e,t,r){const i=e.lastIndexOf(":"),s=e.substring(0,i),o=ka(s);n.repoInfo_=new YP(e,o,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function Y1(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ms("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Cn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=n0(s,i),l=o.repoInfo,u,d;typeof process<"u"&&nA&&(d=nA[i7]),d?(u=!0,s=`http://${d}?ns=${l.namespace}`,o=n0(s,i),l=o.repoInfo):u=!o.repoInfo.secure;const p=i&&u?new gu(gu.OWNER):new J6(n.name,n.options,e);F1("Invalid Firebase Database URL",o),We(o.path)||ms("Database URL must point to the root of a Firebase Database (not including a child path).");const v=l7(l,n,p,new K6(n,t));return new c7(v,n)}function a7(n,e){const t=s0[e];(!t||t[n.key]!==n)&&ms(`Database ${e}(${n.repoInfo_}) has already been deleted.`),H1(n),delete t[n.key]}function l7(n,e,t,r){let i=s0[e.name];i||(i={},s0[e.name]=i);let s=i[n.toURLString()];return s&&ms("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new f9(n,s7,t,r),i[n.toURLString()]=s,s}let c7=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(p9(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new li(this._repo,lt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(a7(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ms("Cannot call "+e+" on a deleted database.")}};function X1(){Cu.IS_TRANSPORT_INITIALIZED&&Jn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function u7(){X1(),ea.forceDisallow()}function d7(){X1(),ti.forceDisallow(),ea.forceAllow()}function h7(n,e,t,r={}){n=Ee(n),n._checkNotDeleted("useEmulator");const i=`${e}:${t}`,s=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&Xs(r,s.repoInfo_.emulatorOptions))return;ms("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&ms('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new gu(gu.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:yb(r.mockUserToken,n.app.options.projectId);o=new gu(l)}ka(e)&&(rT(e),iT("Database",!0)),o7(s,i,r,o)}function f7(n){n=Ee(n),n._checkNotDeleted("goOffline"),H1(n._repo)}function p7(n){n=Ee(n),n._checkNotDeleted("goOnline"),I9(n._repo)}function m7(n,e){UP(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g7(n){LP(oo),Tr(new un("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Y1(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Vn(rA,iA,n),Vn(rA,iA,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y7={".sv":"timestamp"};function _7(){return y7}function v7(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w7=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function T7(n,e,t){if(n=Ee(n),ri("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=(t==null?void 0:t.applyLocally)??!0,i=new gr,s=(l,u,d)=>{let p=null;l?i.reject(l):(p=new My(d,new li(n._repo,n._path),St),i.resolve(new w7(u,p)))},o=i0(n,()=>{});return x9(n._repo,n._path,e,s,o,r),i.promise}Ys.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ys.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};g7();const E7="@firebase/database-compat",I7="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7=new Yu("@firebase/database-compat"),Z1=function(n){const e="FIREBASE WARNING: "+n;x7.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S7=function(n,e,t,r){if(t!==void 0&&typeof t!="boolean")throw new Error(wr(n,e)+"must be a boolean.")},C7=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(wr(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e){this._delegate=e}cancel(e){Ve("OnDisconnect.cancel",0,1,arguments.length),xn("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){Ve("OnDisconnect.remove",0,1,arguments.length),xn("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){Ve("OnDisconnect.set",1,2,arguments.length),xn("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){Ve("OnDisconnect.setWithPriority",2,3,arguments.length),xn("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(Ve("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Z1("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}xn("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Ve("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t){this._database=e,this._delegate=t}val(){return Ve("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Ve("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Ve("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Ve("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Ve("DataSnapshot.child",0,1,arguments.length),e=String(e),gf("DataSnapshot.child","path",e),new ca(this._database,this._delegate.child(e))}hasChild(e){return Ve("DataSnapshot.hasChild",1,1,arguments.length),gf("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return Ve("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Ve("DataSnapshot.forEach",1,1,arguments.length),xn("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new ca(this._database,t)))}hasChildren(){return Ve("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Ve("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Ve("DataSnapshot.ref",0,0,arguments.length),new Or(this._database,this._delegate.ref)}get ref(){return this.getRef()}}let eD=class er{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var u;Ve("Query.on",2,4,arguments.length),xn("Query.on","callback",t,!1);const s=er.getCancelAndContextArgs_("Query.on",r,i),o=(d,p)=>{t.call(s.context,new ca(this.database,d),p)};o.userCallback=t,o.context=s.context;const l=(u=s.cancel)==null?void 0:u.bind(s.context);switch(e){case"value":return i0(this._delegate,o,l),t;case"child_added":return FA(this._delegate,o,l),t;case"child_removed":return BA(this._delegate,o,l),t;case"child_changed":return OA(this._delegate,o,l),t;case"child_moved":return UA(this._delegate,o,l),t;default:throw new Error(wr("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(Ve("Query.off",0,3,arguments.length),C7("Query.off",e),xn("Query.off","callback",t,!0),xC("Query.off","context",r),t){const i=()=>{};i.userCallback=t,i.context=r,qA(this._delegate,e,i)}else qA(this._delegate,e)}get(){return F9(this._delegate).then(e=>new ca(this.database,e))}once(e,t,r,i){Ve("Query.once",1,4,arguments.length),xn("Query.once","callback",t,!0);const s=er.getCancelAndContextArgs_("Query.once",r,i),o=new gr,l=(d,p)=>{const v=new ca(this.database,d);t&&t.call(s.context,v,p),o.resolve(v)};l.userCallback=t,l.context=s.context;const u=d=>{s.cancel&&s.cancel.call(s.context,d),o.reject(d)};switch(e){case"value":i0(this._delegate,l,u,{onlyOnce:!0});break;case"child_added":FA(this._delegate,l,u,{onlyOnce:!0});break;case"child_removed":BA(this._delegate,l,u,{onlyOnce:!0});break;case"child_changed":OA(this._delegate,l,u,{onlyOnce:!0});break;case"child_moved":UA(this._delegate,l,u,{onlyOnce:!0});break;default:throw new Error(wr("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return Ve("Query.limitToFirst",1,1,arguments.length),new er(this.database,Ti(this._delegate,j9(e)))}limitToLast(e){return Ve("Query.limitToLast",1,1,arguments.length),new er(this.database,Ti(this._delegate,W9(e)))}orderByChild(e){return Ve("Query.orderByChild",1,1,arguments.length),new er(this.database,Ti(this._delegate,J9(e)))}orderByKey(){return Ve("Query.orderByKey",0,0,arguments.length),new er(this.database,Ti(this._delegate,Y9()))}orderByPriority(){return Ve("Query.orderByPriority",0,0,arguments.length),new er(this.database,Ti(this._delegate,Z9()))}orderByValue(){return Ve("Query.orderByValue",0,0,arguments.length),new er(this.database,Ti(this._delegate,t7()))}startAt(e=null,t){return Ve("Query.startAt",0,2,arguments.length),new er(this.database,Ti(this._delegate,q9(e,t)))}startAfter(e=null,t){return Ve("Query.startAfter",0,2,arguments.length),new er(this.database,Ti(this._delegate,G9(e,t)))}endAt(e=null,t){return Ve("Query.endAt",0,2,arguments.length),new er(this.database,Ti(this._delegate,O9(e,t)))}endBefore(e=null,t){return Ve("Query.endBefore",0,2,arguments.length),new er(this.database,Ti(this._delegate,B9(e,t)))}equalTo(e,t){return Ve("Query.equalTo",1,2,arguments.length),new er(this.database,Ti(this._delegate,r7(e,t)))}toString(){return Ve("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Ve("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Ve("Query.isEqual",1,1,arguments.length),!(e instanceof er)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,xn(e,"cancel",i.cancel,!0),i.context=r,xC(e,"context",i.context);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(wr(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Or(this.database,new li(this._delegate._repo,this._delegate._path))}};class Or extends eD{constructor(e,t){super(e,new Er(t._repo,t._path,new _y,!1)),this.database=e,this._delegate=t}getKey(){return Ve("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Ve("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Or(this.database,Bl(this._delegate,e))}getParent(){Ve("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Or(this.database,e):null}getRoot(){return Ve("Reference.root",0,0,arguments.length),new Or(this.database,this._delegate.root)}set(e,t){Ve("Reference.set",1,2,arguments.length),xn("Reference.set","onComplete",t,!0);const r=hE(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(Ve("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Z1("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ri("Reference.update",this._delegate._path),xn("Reference.update","onComplete",t,!0);const r=V9(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){Ve("Reference.setWithPriority",2,3,arguments.length),xn("Reference.setWithPriority","onComplete",r,!0);const i=L9(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){Ve("Reference.remove",0,1,arguments.length),xn("Reference.remove","onComplete",e,!0);const t=D9(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){Ve("Reference.transaction",1,3,arguments.length),xn("Reference.transaction","transactionUpdate",e,!1),xn("Reference.transaction","onComplete",t,!0),S7("Reference.transaction","applyLocally",r);const i=T7(this._delegate,e,{applyLocally:r}).then(s=>new N7(s.committed,new ca(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){Ve("Reference.setPriority",1,2,arguments.length),xn("Reference.setPriority","onComplete",t,!0);const r=M9(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){Ve("Reference.push",0,2,arguments.length),xn("Reference.push","onComplete",t,!0);const r=P9(this._delegate,e),i=r.then(o=>new Or(this.database,o));t&&i.then(()=>t(null),o=>t(o));const s=new Or(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return ri("Reference.onDisconnect",this._delegate._path),new A7(new b9(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:u7,forceLongPolling:d7}}useEmulator(e,t,r={}){h7(this._delegate,e,t,r)}ref(e){if(Ve("database.ref",0,1,arguments.length),e instanceof Or){const t=VA(this._delegate,e.toString());return new Or(this,t)}else{const t=K1(this._delegate,e);return new Or(this,t)}}refFromURL(e){Ve("database.refFromURL",1,1,arguments.length);const r=VA(this._delegate,e);return new Or(this,r)}goOffline(){return Ve("database.goOffline",0,0,arguments.length),f7(this._delegate)}goOnline(){return Ve("database.goOnline",0,0,arguments.length),p7(this._delegate)}}yf.ServerValue={TIMESTAMP:_7(),increment:n=>v7(n)};function k7({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){LP(t);const l=new oT("database-standalone"),u=new Nw("auth-internal",l);u.setComponent(new un("auth-internal",()=>r,"PRIVATE"));let d;return i&&(d=new Nw("app-check-internal",l),d.setComponent(new un("app-check-internal",()=>i,"PRIVATE"))),{instance:new yf(Y1(n,u,d,e,o),n),namespace:s}}var R7=Object.freeze({__proto__:null,initStandalone:k7});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7=yf.ServerValue;function P7(n){n.INTERNAL.registerComponent(new un("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new yf(i,r)},"PUBLIC").setServiceProps({Reference:Or,Query:eD,Database:yf,DataSnapshot:ca,enableLogging:m7,INTERNAL:R7,ServerValue:b7}).setMultipleInstances(!0)),n.registerVersion(E7,I7)}P7(tn);var HA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ua,tD;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,k){function b(){}b.prototype=k.prototype,P.F=k.prototype,P.prototype=new b,P.prototype.constructor=P,P.D=function(F,D,O){for(var M=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)M[$e-2]=arguments[$e];return k.prototype[D].apply(F,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,k,b){b||(b=0);const F=Array(16);if(typeof k=="string")for(var D=0;D<16;++D)F[D]=k.charCodeAt(b++)|k.charCodeAt(b++)<<8|k.charCodeAt(b++)<<16|k.charCodeAt(b++)<<24;else for(D=0;D<16;++D)F[D]=k[b++]|k[b++]<<8|k[b++]<<16|k[b++]<<24;k=P.g[0],b=P.g[1],D=P.g[2];let O=P.g[3],M;M=k+(O^b&(D^O))+F[0]+3614090360&4294967295,k=b+(M<<7&4294967295|M>>>25),M=O+(D^k&(b^D))+F[1]+3905402710&4294967295,O=k+(M<<12&4294967295|M>>>20),M=D+(b^O&(k^b))+F[2]+606105819&4294967295,D=O+(M<<17&4294967295|M>>>15),M=b+(k^D&(O^k))+F[3]+3250441966&4294967295,b=D+(M<<22&4294967295|M>>>10),M=k+(O^b&(D^O))+F[4]+4118548399&4294967295,k=b+(M<<7&4294967295|M>>>25),M=O+(D^k&(b^D))+F[5]+1200080426&4294967295,O=k+(M<<12&4294967295|M>>>20),M=D+(b^O&(k^b))+F[6]+2821735955&4294967295,D=O+(M<<17&4294967295|M>>>15),M=b+(k^D&(O^k))+F[7]+4249261313&4294967295,b=D+(M<<22&4294967295|M>>>10),M=k+(O^b&(D^O))+F[8]+1770035416&4294967295,k=b+(M<<7&4294967295|M>>>25),M=O+(D^k&(b^D))+F[9]+2336552879&4294967295,O=k+(M<<12&4294967295|M>>>20),M=D+(b^O&(k^b))+F[10]+4294925233&4294967295,D=O+(M<<17&4294967295|M>>>15),M=b+(k^D&(O^k))+F[11]+2304563134&4294967295,b=D+(M<<22&4294967295|M>>>10),M=k+(O^b&(D^O))+F[12]+1804603682&4294967295,k=b+(M<<7&4294967295|M>>>25),M=O+(D^k&(b^D))+F[13]+4254626195&4294967295,O=k+(M<<12&4294967295|M>>>20),M=D+(b^O&(k^b))+F[14]+2792965006&4294967295,D=O+(M<<17&4294967295|M>>>15),M=b+(k^D&(O^k))+F[15]+1236535329&4294967295,b=D+(M<<22&4294967295|M>>>10),M=k+(D^O&(b^D))+F[1]+4129170786&4294967295,k=b+(M<<5&4294967295|M>>>27),M=O+(b^D&(k^b))+F[6]+3225465664&4294967295,O=k+(M<<9&4294967295|M>>>23),M=D+(k^b&(O^k))+F[11]+643717713&4294967295,D=O+(M<<14&4294967295|M>>>18),M=b+(O^k&(D^O))+F[0]+3921069994&4294967295,b=D+(M<<20&4294967295|M>>>12),M=k+(D^O&(b^D))+F[5]+3593408605&4294967295,k=b+(M<<5&4294967295|M>>>27),M=O+(b^D&(k^b))+F[10]+38016083&4294967295,O=k+(M<<9&4294967295|M>>>23),M=D+(k^b&(O^k))+F[15]+3634488961&4294967295,D=O+(M<<14&4294967295|M>>>18),M=b+(O^k&(D^O))+F[4]+3889429448&4294967295,b=D+(M<<20&4294967295|M>>>12),M=k+(D^O&(b^D))+F[9]+568446438&4294967295,k=b+(M<<5&4294967295|M>>>27),M=O+(b^D&(k^b))+F[14]+3275163606&4294967295,O=k+(M<<9&4294967295|M>>>23),M=D+(k^b&(O^k))+F[3]+4107603335&4294967295,D=O+(M<<14&4294967295|M>>>18),M=b+(O^k&(D^O))+F[8]+1163531501&4294967295,b=D+(M<<20&4294967295|M>>>12),M=k+(D^O&(b^D))+F[13]+2850285829&4294967295,k=b+(M<<5&4294967295|M>>>27),M=O+(b^D&(k^b))+F[2]+4243563512&4294967295,O=k+(M<<9&4294967295|M>>>23),M=D+(k^b&(O^k))+F[7]+1735328473&4294967295,D=O+(M<<14&4294967295|M>>>18),M=b+(O^k&(D^O))+F[12]+2368359562&4294967295,b=D+(M<<20&4294967295|M>>>12),M=k+(b^D^O)+F[5]+4294588738&4294967295,k=b+(M<<4&4294967295|M>>>28),M=O+(k^b^D)+F[8]+2272392833&4294967295,O=k+(M<<11&4294967295|M>>>21),M=D+(O^k^b)+F[11]+1839030562&4294967295,D=O+(M<<16&4294967295|M>>>16),M=b+(D^O^k)+F[14]+4259657740&4294967295,b=D+(M<<23&4294967295|M>>>9),M=k+(b^D^O)+F[1]+2763975236&4294967295,k=b+(M<<4&4294967295|M>>>28),M=O+(k^b^D)+F[4]+1272893353&4294967295,O=k+(M<<11&4294967295|M>>>21),M=D+(O^k^b)+F[7]+4139469664&4294967295,D=O+(M<<16&4294967295|M>>>16),M=b+(D^O^k)+F[10]+3200236656&4294967295,b=D+(M<<23&4294967295|M>>>9),M=k+(b^D^O)+F[13]+681279174&4294967295,k=b+(M<<4&4294967295|M>>>28),M=O+(k^b^D)+F[0]+3936430074&4294967295,O=k+(M<<11&4294967295|M>>>21),M=D+(O^k^b)+F[3]+3572445317&4294967295,D=O+(M<<16&4294967295|M>>>16),M=b+(D^O^k)+F[6]+76029189&4294967295,b=D+(M<<23&4294967295|M>>>9),M=k+(b^D^O)+F[9]+3654602809&4294967295,k=b+(M<<4&4294967295|M>>>28),M=O+(k^b^D)+F[12]+3873151461&4294967295,O=k+(M<<11&4294967295|M>>>21),M=D+(O^k^b)+F[15]+530742520&4294967295,D=O+(M<<16&4294967295|M>>>16),M=b+(D^O^k)+F[2]+3299628645&4294967295,b=D+(M<<23&4294967295|M>>>9),M=k+(D^(b|~O))+F[0]+4096336452&4294967295,k=b+(M<<6&4294967295|M>>>26),M=O+(b^(k|~D))+F[7]+1126891415&4294967295,O=k+(M<<10&4294967295|M>>>22),M=D+(k^(O|~b))+F[14]+2878612391&4294967295,D=O+(M<<15&4294967295|M>>>17),M=b+(O^(D|~k))+F[5]+4237533241&4294967295,b=D+(M<<21&4294967295|M>>>11),M=k+(D^(b|~O))+F[12]+1700485571&4294967295,k=b+(M<<6&4294967295|M>>>26),M=O+(b^(k|~D))+F[3]+2399980690&4294967295,O=k+(M<<10&4294967295|M>>>22),M=D+(k^(O|~b))+F[10]+4293915773&4294967295,D=O+(M<<15&4294967295|M>>>17),M=b+(O^(D|~k))+F[1]+2240044497&4294967295,b=D+(M<<21&4294967295|M>>>11),M=k+(D^(b|~O))+F[8]+1873313359&4294967295,k=b+(M<<6&4294967295|M>>>26),M=O+(b^(k|~D))+F[15]+4264355552&4294967295,O=k+(M<<10&4294967295|M>>>22),M=D+(k^(O|~b))+F[6]+2734768916&4294967295,D=O+(M<<15&4294967295|M>>>17),M=b+(O^(D|~k))+F[13]+1309151649&4294967295,b=D+(M<<21&4294967295|M>>>11),M=k+(D^(b|~O))+F[4]+4149444226&4294967295,k=b+(M<<6&4294967295|M>>>26),M=O+(b^(k|~D))+F[11]+3174756917&4294967295,O=k+(M<<10&4294967295|M>>>22),M=D+(k^(O|~b))+F[2]+718787259&4294967295,D=O+(M<<15&4294967295|M>>>17),M=b+(O^(D|~k))+F[9]+3951481745&4294967295,P.g[0]=P.g[0]+k&4294967295,P.g[1]=P.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,P.g[2]=P.g[2]+D&4294967295,P.g[3]=P.g[3]+O&4294967295}r.prototype.v=function(P,k){k===void 0&&(k=P.length);const b=k-this.blockSize,F=this.C;let D=this.h,O=0;for(;O<k;){if(D==0)for(;O<=b;)i(this,P,O),O+=this.blockSize;if(typeof P=="string"){for(;O<k;)if(F[D++]=P.charCodeAt(O++),D==this.blockSize){i(this,F),D=0;break}}else for(;O<k;)if(F[D++]=P[O++],D==this.blockSize){i(this,F),D=0;break}}this.h=D,this.o+=k},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var k=1;k<P.length-8;++k)P[k]=0;k=this.o*8;for(var b=P.length-8;b<P.length;++b)P[b]=k&255,k/=256;for(this.v(P),P=Array(16),k=0,b=0;b<4;++b)for(let F=0;F<32;F+=8)P[k++]=this.g[b]>>>F&255;return P};function s(P,k){var b=l;return Object.prototype.hasOwnProperty.call(b,P)?b[P]:b[P]=k(P)}function o(P,k){this.h=k;const b=[];let F=!0;for(let D=P.length-1;D>=0;D--){const O=P[D]|0;F&&O==k||(b[D]=O,F=!1)}this.g=b}var l={};function u(P){return-128<=P&&P<128?s(P,function(k){return new o([k|0],k<0?-1:0)}):new o([P|0],P<0?-1:0)}function d(P){if(isNaN(P)||!isFinite(P))return v;if(P<0)return L(d(-P));const k=[];let b=1;for(let F=0;P>=b;F++)k[F]=P/b|0,b*=4294967296;return new o(k,0)}function p(P,k){if(P.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(P.charAt(0)=="-")return L(p(P.substring(1),k));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(k,8));let F=v;for(let O=0;O<P.length;O+=8){var D=Math.min(8,P.length-O);const M=parseInt(P.substring(O,O+D),k);D<8?(D=d(Math.pow(k,D)),F=F.j(D).add(d(M))):(F=F.j(b),F=F.add(d(M)))}return F}var v=u(0),w=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(R(this))return-L(this).m();let P=0,k=1;for(let b=0;b<this.g.length;b++){const F=this.i(b);P+=(F>=0?F:4294967296+F)*k,k*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(A(this))return"0";if(R(this))return"-"+L(this).toString(P);const k=d(Math.pow(P,6));var b=this;let F="";for(;;){const D=K(b,k).g;b=j(b,D.j(k));let O=((b.g.length>0?b.g[0]:b.h)>>>0).toString(P);if(b=D,A(b))return O+F;for(;O.length<6;)O="0"+O;F=O+F}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function A(P){if(P.h!=0)return!1;for(let k=0;k<P.g.length;k++)if(P.g[k]!=0)return!1;return!0}function R(P){return P.h==-1}n.l=function(P){return P=j(this,P),R(P)?-1:A(P)?0:1};function L(P){const k=P.g.length,b=[];for(let F=0;F<k;F++)b[F]=~P.g[F];return new o(b,~P.h).add(w)}n.abs=function(){return R(this)?L(this):this},n.add=function(P){const k=Math.max(this.g.length,P.g.length),b=[];let F=0;for(let D=0;D<=k;D++){let O=F+(this.i(D)&65535)+(P.i(D)&65535),M=(O>>>16)+(this.i(D)>>>16)+(P.i(D)>>>16);F=M>>>16,O&=65535,M&=65535,b[D]=M<<16|O}return new o(b,b[b.length-1]&-2147483648?-1:0)};function j(P,k){return P.add(L(k))}n.j=function(P){if(A(this)||A(P))return v;if(R(this))return R(P)?L(this).j(L(P)):L(L(this).j(P));if(R(P))return L(this.j(L(P)));if(this.l(x)<0&&P.l(x)<0)return d(this.m()*P.m());const k=this.g.length+P.g.length,b=[];for(var F=0;F<2*k;F++)b[F]=0;for(F=0;F<this.g.length;F++)for(let D=0;D<P.g.length;D++){const O=this.i(F)>>>16,M=this.i(F)&65535,$e=P.i(D)>>>16,dt=P.i(D)&65535;b[2*F+2*D]+=M*dt,B(b,2*F+2*D),b[2*F+2*D+1]+=O*dt,B(b,2*F+2*D+1),b[2*F+2*D+1]+=M*$e,B(b,2*F+2*D+1),b[2*F+2*D+2]+=O*$e,B(b,2*F+2*D+2)}for(P=0;P<k;P++)b[P]=b[2*P+1]<<16|b[2*P];for(P=k;P<2*k;P++)b[P]=0;return new o(b,0)};function B(P,k){for(;(P[k]&65535)!=P[k];)P[k+1]+=P[k]>>>16,P[k]&=65535,k++}function q(P,k){this.g=P,this.h=k}function K(P,k){if(A(k))throw Error("division by zero");if(A(P))return new q(v,v);if(R(P))return k=K(L(P),k),new q(L(k.g),L(k.h));if(R(k))return k=K(P,L(k)),new q(L(k.g),k.h);if(P.g.length>30){if(R(P)||R(k))throw Error("slowDivide_ only works with positive integers.");for(var b=w,F=k;F.l(P)<=0;)b=te(b),F=te(F);var D=ee(b,1),O=ee(F,1);for(F=ee(F,2),b=ee(b,2);!A(F);){var M=O.add(F);M.l(P)<=0&&(D=D.add(b),O=M),F=ee(F,1),b=ee(b,1)}return k=j(P,D.j(k)),new q(D,k)}for(D=v;P.l(k)>=0;){for(b=Math.max(1,Math.floor(P.m()/k.m())),F=Math.ceil(Math.log(b)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),O=d(b),M=O.j(k);R(M)||M.l(P)>0;)b-=F,O=d(b),M=O.j(k);A(O)&&(O=w),D=D.add(O),P=j(P,M)}return new q(D,P)}n.B=function(P){return K(this,P).h},n.and=function(P){const k=Math.max(this.g.length,P.g.length),b=[];for(let F=0;F<k;F++)b[F]=this.i(F)&P.i(F);return new o(b,this.h&P.h)},n.or=function(P){const k=Math.max(this.g.length,P.g.length),b=[];for(let F=0;F<k;F++)b[F]=this.i(F)|P.i(F);return new o(b,this.h|P.h)},n.xor=function(P){const k=Math.max(this.g.length,P.g.length),b=[];for(let F=0;F<k;F++)b[F]=this.i(F)^P.i(F);return new o(b,this.h^P.h)};function te(P){const k=P.g.length+1,b=[];for(let F=0;F<k;F++)b[F]=P.i(F)<<1|P.i(F-1)>>>31;return new o(b,P.h)}function ee(P,k){const b=k>>5;k%=32;const F=P.g.length-b,D=[];for(let O=0;O<F;O++)D[O]=k>0?P.i(O+b)>>>k|P.i(O+b+1)<<32-k:P.i(O+b);return new o(D,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,tD=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,ua=o}).apply(typeof HA<"u"?HA:typeof self<"u"?self:typeof window<"u"?window:{});var Nm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nD,Ch,rD,Hm,o0,iD,sD,oD;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nm=="object"&&Nm];for(var I=0;I<g.length;++I){var S=g[I];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var r=t(this);function i(g,I){if(I)e:{var S=r;g=g.split(".");for(var N=0;N<g.length-1;N++){var W=g[N];if(!(W in S))break e;S=S[W]}g=g[g.length-1],N=S[g],I=I(N),I!=N&&I!=null&&e(S,g,{configurable:!0,writable:!0,value:I})}}i("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(g){return g||function(I){var S=[],N;for(N in I)Object.prototype.hasOwnProperty.call(I,N)&&S.push([N,I[N]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function l(g){var I=typeof g;return I=="object"&&g!=null||I=="function"}function u(g,I,S){return g.call.apply(g.bind,arguments)}function d(g,I,S){return d=u,d.apply(null,arguments)}function p(g,I){var S=Array.prototype.slice.call(arguments,1);return function(){var N=S.slice();return N.push.apply(N,arguments),g.apply(this,N)}}function v(g,I){function S(){}S.prototype=I.prototype,g.Z=I.prototype,g.prototype=new S,g.prototype.constructor=g,g.Ob=function(N,W,Z){for(var pe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)pe[qe-2]=arguments[qe];return I.prototype[W].apply(N,pe)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const I=g.length;if(I>0){const S=Array(I);for(let N=0;N<I;N++)S[N]=g[N];return S}return[]}function A(g,I){for(let N=1;N<arguments.length;N++){const W=arguments[N];var S=typeof W;if(S=S!="object"?S:W?Array.isArray(W)?"array":S:"null",S=="array"||S=="object"&&typeof W.length=="number"){S=g.length||0;const Z=W.length||0;g.length=S+Z;for(let pe=0;pe<Z;pe++)g[S+pe]=W[pe]}else g.push(W)}}class R{constructor(I,S){this.i=I,this.j=S,this.h=0,this.g=null}get(){let I;return this.h>0?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function L(g){o.setTimeout(()=>{throw g},0)}function j(){var g=P;let I=null;return g.g&&(I=g.g,g.g=g.g.next,g.g||(g.h=null),I.next=null),I}class B{constructor(){this.h=this.g=null}add(I,S){const N=q.get();N.set(I,S),this.h?this.h.next=N:this.g=N,this.h=N}}var q=new R(()=>new K,g=>g.reset());class K{constructor(){this.next=this.g=this.h=null}set(I,S){this.h=I,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let te,ee=!1,P=new B,k=()=>{const g=Promise.resolve(void 0);te=()=>{g.then(b)}};function b(){for(var g;g=j();){try{g.h.call(g.g)}catch(S){L(S)}var I=q;I.j(g),I.h<100&&(I.h++,g.next=I.g,I.g=g)}ee=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(g,I){this.type=g,this.g=this.target=I,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,I=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const S=()=>{};o.addEventListener("test",S,I),o.removeEventListener("test",S,I)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function $e(g,I){D.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,I)}v($e,D),$e.prototype.init=function(g,I){const S=this.type=g.type,N=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=I,I=g.relatedTarget,I||(S=="mouseover"?I=g.fromElement:S=="mouseout"&&(I=g.toElement)),this.relatedTarget=I,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&$e.Z.h.call(this)},$e.prototype.h=function(){$e.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var dt="closure_listenable_"+(Math.random()*1e6|0),et=0;function tt(g,I,S,N,W){this.listener=g,this.proxy=null,this.src=I,this.type=S,this.capture=!!N,this.ha=W,this.key=++et,this.da=this.fa=!1}function fe(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ne(g,I,S){for(const N in g)I.call(S,g[N],N,g)}function ye(g,I){for(const S in g)I.call(void 0,g[S],S,g)}function G(g){const I={};for(const S in g)I[S]=g[S];return I}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Re(g,I){let S,N;for(let W=1;W<arguments.length;W++){N=arguments[W];for(S in N)g[S]=N[S];for(let Z=0;Z<ne.length;Z++)S=ne[Z],Object.prototype.hasOwnProperty.call(N,S)&&(g[S]=N[S])}}function Me(g){this.src=g,this.g={},this.h=0}Me.prototype.add=function(g,I,S,N,W){const Z=g.toString();g=this.g[Z],g||(g=this.g[Z]=[],this.h++);const pe=He(g,I,N,W);return pe>-1?(I=g[pe],S||(I.fa=!1)):(I=new tt(I,this.src,Z,!!N,W),I.fa=S,g.push(I)),I};function Ue(g,I){const S=I.type;if(S in g.g){var N=g.g[S],W=Array.prototype.indexOf.call(N,I,void 0),Z;(Z=W>=0)&&Array.prototype.splice.call(N,W,1),Z&&(fe(I),g.g[S].length==0&&(delete g.g[S],g.h--))}}function He(g,I,S,N){for(let W=0;W<g.length;++W){const Z=g[W];if(!Z.da&&Z.listener==I&&Z.capture==!!S&&Z.ha==N)return W}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),_e={};function Be(g,I,S,N,W){if(Array.isArray(I)){for(let Z=0;Z<I.length;Z++)Be(g,I[Z],S,N,W);return null}return S=Es(S),g&&g[dt]?g.J(I,S,l(N)?!!N.capture:!1,W):it(g,I,S,!1,N,W)}function it(g,I,S,N,W,Z){if(!I)throw Error("Invalid event type");const pe=l(W)?!!W.capture:!!W;let qe=kn(g);if(qe||(g[ue]=qe=new Me(g)),S=qe.add(I,S,N,pe,Z),S.proxy)return S;if(N=je(),S.proxy=N,N.src=g,N.listener=S,g.addEventListener)O||(W=pe),W===void 0&&(W=!1),g.addEventListener(I.toString(),N,W);else if(g.attachEvent)g.attachEvent($r(I.toString()),N);else if(g.addListener&&g.removeListener)g.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return S}function je(){function g(S){return I.call(g.src,g.listener,S)}const I=ws;return g}function ft(g,I,S,N,W){if(Array.isArray(I))for(var Z=0;Z<I.length;Z++)ft(g,I[Z],S,N,W);else N=l(N)?!!N.capture:!!N,S=Es(S),g&&g[dt]?(g=g.i,Z=String(I).toString(),Z in g.g&&(I=g.g[Z],S=He(I,S,N,W),S>-1&&(fe(I[S]),Array.prototype.splice.call(I,S,1),I.length==0&&(delete g.g[Z],g.h--)))):g&&(g=kn(g))&&(I=g.g[I.toString()],g=-1,I&&(g=He(I,S,N,W)),(S=g>-1?I[g]:null)&&dn(S))}function dn(g){if(typeof g!="number"&&g&&!g.da){var I=g.src;if(I&&I[dt])Ue(I.i,g);else{var S=g.type,N=g.proxy;I.removeEventListener?I.removeEventListener(S,N,g.capture):I.detachEvent?I.detachEvent($r(S),N):I.addListener&&I.removeListener&&I.removeListener(N),(S=kn(I))?(Ue(S,g),S.h==0&&(S.src=null,I[ue]=null)):fe(g)}}}function $r(g){return g in _e?_e[g]:_e[g]="on"+g}function ws(g,I){if(g.da)g=!0;else{I=new $e(I,this);const S=g.listener,N=g.ha||g.src;g.fa&&dn(g),g=S.call(N,I)}return g}function kn(g){return g=g[ue],g instanceof Me?g:null}var Ts="__closure_events_fn_"+(Math.random()*1e9>>>0);function Es(g){return typeof g=="function"?g:(g[Ts]||(g[Ts]=function(I){return g.handleEvent(I)}),g[Ts])}function Bt(){F.call(this),this.i=new Me(this),this.M=this,this.G=null}v(Bt,F),Bt.prototype[dt]=!0,Bt.prototype.removeEventListener=function(g,I,S,N){ft(this,g,I,S,N)};function qt(g,I){var S,N=g.G;if(N)for(S=[];N;N=N.G)S.push(N);if(g=g.M,N=I.type||I,typeof I=="string")I=new D(I,g);else if(I instanceof D)I.target=I.target||g;else{var W=I;I=new D(N,g),Re(I,W)}W=!0;let Z,pe;if(S)for(pe=S.length-1;pe>=0;pe--)Z=I.g=S[pe],W=ar(Z,N,!0,I)&&W;if(Z=I.g=g,W=ar(Z,N,!0,I)&&W,W=ar(Z,N,!1,I)&&W,S)for(pe=0;pe<S.length;pe++)Z=I.g=S[pe],W=ar(Z,N,!1,I)&&W}Bt.prototype.N=function(){if(Bt.Z.N.call(this),this.i){var g=this.i;for(const I in g.g){const S=g.g[I];for(let N=0;N<S.length;N++)fe(S[N]);delete g.g[I],g.h--}}this.G=null},Bt.prototype.J=function(g,I,S,N){return this.i.add(String(g),I,!1,S,N)},Bt.prototype.K=function(g,I,S,N){return this.i.add(String(g),I,!0,S,N)};function ar(g,I,S,N){if(I=g.i.g[String(I)],!I)return!0;I=I.concat();let W=!0;for(let Z=0;Z<I.length;++Z){const pe=I[Z];if(pe&&!pe.da&&pe.capture==S){const qe=pe.listener,Xt=pe.ha||pe.src;pe.fa&&Ue(g.i,pe),W=qe.call(Xt,N)!==!1&&W}}return W&&!N.defaultPrevented}function yo(g,I){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(I)>2147483647?-1:o.setTimeout(g,I||0)}function _o(g){g.g=yo(()=>{g.g=null,g.i&&(g.i=!1,_o(g))},g.l);const I=g.h;g.h=null,g.m.apply(null,I)}class Oa extends F{constructor(I,S){super(),this.m=I,this.l=S,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:_o(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ci(g){F.call(this),this.h=g,this.g={}}v(ci,F);var vo=[];function Is(g){Ne(g.g,function(I,S){this.g.hasOwnProperty(S)&&dn(I)},g),g.g={}}ci.prototype.N=function(){ci.Z.N.call(this),Is(this)},ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ui=o.JSON.stringify,Ua=o.JSON.parse,xs=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function jr(){}function fc(){}var bi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wo(){D.call(this,"d")}v(wo,D);function Ba(){D.call(this,"c")}v(Ba,D);var Ir={},Ss=null;function Pi(){return Ss=Ss||new Bt}Ir.Ia="serverreachability";function To(g){D.call(this,Ir.Ia,g)}v(To,D);function di(g){const I=Pi();qt(I,new To(I))}Ir.STAT_EVENT="statevent";function re(g,I){D.call(this,Ir.STAT_EVENT,g),this.stat=I}v(re,D);function xe(g){const I=Pi();qt(I,new re(I,g))}Ir.Ja="timingevent";function ot(g,I){D.call(this,Ir.Ja,g),this.size=I}v(ot,D);function yn(g,I){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},I)}function zr(){this.g=!0}zr.prototype.ua=function(){this.g=!1};function xr(g,I,S,N,W,Z){g.info(function(){if(g.g)if(Z){var pe="",qe=Z.split("&");for(let gt=0;gt<qe.length;gt++){var Xt=qe[gt].split("=");if(Xt.length>1){const sn=Xt[0];Xt=Xt[1];const Rr=sn.split("_");pe=Rr.length>=2&&Rr[1]=="type"?pe+(sn+"="+Xt+"&"):pe+(sn+"=redacted&")}}}else pe=null;else pe=Z;return"XMLHTTP REQ ("+N+") [attempt "+W+"]: "+I+`
`+S+`
`+pe})}function Eo(g,I,S,N,W,Z,pe){g.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+W+"]: "+I+`
`+S+`
`+Z+" "+pe})}function hi(g,I,S,N){g.info(function(){return"XMLHTTP TEXT ("+I+"): "+qa(g,S)+(N?" "+N:"")})}function Io(g,I){g.info(function(){return"TIMEOUT: "+I})}zr.prototype.info=function(){};function qa(g,I){if(!g.g)return I;if(!I)return null;try{const Z=JSON.parse(I);if(Z){for(g=0;g<Z.length;g++)if(Array.isArray(Z[g])){var S=Z[g];if(!(S.length<2)){var N=S[1];if(Array.isArray(N)&&!(N.length<1)){var W=N[0];if(W!="noop"&&W!="stop"&&W!="close")for(let pe=1;pe<N.length;pe++)N[pe]=""}}}}return ui(Z)}catch{return I}}var xo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},So={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mp;function Cs(){}v(Cs,jr),Cs.prototype.g=function(){return new XMLHttpRequest},mp=new Cs;function Di(g){return encodeURIComponent(String(g))}function pc(g){var I=1;g=g.split(":");const S=[];for(;I>0&&g.length;)S.push(g.shift()),I--;return g.length&&S.push(g.join(":")),S}function Wr(g,I,S,N){this.j=g,this.i=I,this.l=S,this.S=N||1,this.V=new ci(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gp}function gp(){this.i=null,this.g="",this.h=!1}var yp={},yd={};function fi(g,I,S){g.M=1,g.A=Ns(Kr(I)),g.u=S,g.R=!0,_d(g,null)}function _d(g,I){g.F=Date.now(),Ha(g),g.B=Kr(g.A);var S=g.B,N=g.S;Array.isArray(N)||(N=[String(N)]),Nd(S.i,"t",N),g.C=0,S=g.j.L,g.h=new gp,g.g=Ap(g.j,S?I:null,!g.u),g.P>0&&(g.O=new Oa(d(g.Y,g,g.g),g.P)),I=g.V,S=g.g,N=g.ba;var W="readystatechange";Array.isArray(W)||(W&&(vo[0]=W.toString()),W=vo);for(let Z=0;Z<W.length;Z++){const pe=Be(S,W[Z],N||I.handleEvent,!1,I.h||I);if(!pe)break;I.g[pe.key]=pe}I=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),I["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,I)):(g.v="GET",g.g.ea(g.B,g.v,null,I)),di(),xr(g.i,g.v,g.B,g.l,g.S,g.u)}Wr.prototype.ba=function(g){g=g.target;const I=this.O;I&&Bi(g)==3?I.j():this.Y(g)},Wr.prototype.Y=function(g){try{if(g==this.g)e:{const qe=Bi(this.g),Xt=this.g.ya(),gt=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||Sp(this.g)))){this.K||qe!=4||Xt==7||(Xt==8||gt<=0?di(3):di(2)),mc(this);var I=this.g.ca();this.X=I;var S=_p(this);if(this.o=I==200,Eo(this.i,this.v,this.B,this.l,this.S,qe,I),this.o){if(this.U&&!this.L){t:{if(this.g){var N,W=this.g;if((N=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(N)){var Z=N;break t}}Z=null}if(g=Z)hi(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Nt(this,g);else{this.o=!1,this.m=3,xe(12),As(this),Ga(this);break e}}if(this.R){g=!0;let sn;for(;!this.K&&this.C<S.length;)if(sn=wp(this,S),sn==yd){qe==4&&(this.m=4,xe(14),g=!1),hi(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==yp){this.m=4,xe(15),hi(this.i,this.l,S,"[Invalid Chunk]"),g=!1;break}else hi(this.i,this.l,sn,null),Nt(this,sn);if(vp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,xe(16),g=!1),this.o=this.o&&g,!g)hi(this.i,this.l,S,"[Invalid Chunked Response]"),As(this),Ga(this);else if(S.length>0&&!this.W){this.W=!0;var pe=this.j;pe.g==this&&pe.aa&&!pe.P&&(pe.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Xa(pe),pe.P=!0,xe(11))}}else hi(this.i,this.l,S,null),Nt(this,S);qe==4&&As(this),this.o&&!this.K&&(qe==4?Sc(this.j,this):(this.o=!1,Ha(this)))}else Rd(this.g),I==400&&S.indexOf("Unknown SID")>0?(this.m=3,xe(12)):(this.m=0,xe(13)),As(this),Ga(this)}}}catch{}finally{}};function _p(g){if(!vp(g))return g.g.la();const I=Sp(g.g);if(I==="")return"";let S="";const N=I.length,W=Bi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return As(g),Ga(g),"";g.h.i=new o.TextDecoder}for(let Z=0;Z<N;Z++)g.h.h=!0,S+=g.h.i.decode(I[Z],{stream:!(W&&Z==N-1)});return I.length=0,g.h.g+=S,g.C=0,g.h.g}function vp(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function wp(g,I){var S=g.C,N=I.indexOf(`
`,S);return N==-1?yd:(S=Number(I.substring(S,N)),isNaN(S)?yp:(N+=1,N+S>I.length?yd:(I=I.slice(N,N+S),g.C=N+S,I)))}Wr.prototype.cancel=function(){this.K=!0,As(this)};function Ha(g){g.T=Date.now()+g.H,vd(g,g.H)}function vd(g,I){if(g.D!=null)throw Error("WatchDog timer not null");g.D=yn(d(g.aa,g),I)}function mc(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Wr.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Io(this.i,this.B),this.M!=2&&(di(),xe(17)),As(this),this.m=2,Ga(this)):vd(this,this.T-g)};function Ga(g){g.j.I==0||g.K||Sc(g.j,g)}function As(g){mc(g);var I=g.O;I&&typeof I.dispose=="function"&&I.dispose(),g.O=null,Is(g.V),g.g&&(I=g.g,g.g=null,I.abort(),I.dispose())}function Nt(g,I){try{var S=g.j;if(S.I!=0&&(S.g==g||Td(S.h,g))){if(!g.L&&Td(S.h,g)&&S.I==3){try{var N=S.Ba.g.parse(I)}catch{N=null}if(Array.isArray(N)&&N.length==3){var W=N;if(W[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<g.F)xc(S),Nr(S);else break e;Gi(S),xe(18)}}else S.xa=W[1],0<S.xa-S.K&&W[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=yn(d(S.Va,S),6e3));$a(S.h)<=1&&S.ta&&(S.ta=void 0)}else kr(S,11)}else if((g.L||S.g==g)&&xc(S),!M(I))for(W=S.Ba.g.parse(I),I=0;I<W.length;I++){let gt=W[I];const sn=gt[0];if(!(sn<=S.K))if(S.K=sn,gt=gt[1],S.I==2)if(gt[0]=="c"){S.M=gt[1],S.ba=gt[2];const Rr=gt[3];Rr!=null&&(S.ka=Rr,S.j.info("VER="+S.ka));const Ds=gt[4];Ds!=null&&(S.za=Ds,S.j.info("SVER="+S.za));const $i=gt[5];$i!=null&&typeof $i=="number"&&$i>0&&(N=1.5*$i,S.O=N,S.j.info("backChannelRequestTimeoutMs_="+N)),N=S;const ji=g.g;if(ji){const Nc=ji.g?ji.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nc){var Z=N.h;Z.g||Nc.indexOf("spdy")==-1&&Nc.indexOf("quic")==-1&&Nc.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(yc(Z,Z.h),Z.h=null))}if(N.G){const Dd=ji.g?ji.g.getResponseHeader("X-HTTP-Session-Id"):null;Dd&&(N.wa=Dd,ht(N.J,N.G,Dd))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-g.F,S.j.info("Handshake RTT: "+S.T+"ms")),N=S;var pe=g;if(N.na=Pd(N,N.L?N.ba:null,N.W),pe.L){ja(N.h,pe);var qe=pe,Xt=N.O;Xt&&(qe.H=Xt),qe.D&&(mc(qe),Ha(qe)),N.g=pe}else Un(N);S.i.length>0&&Ps(S)}else gt[0]!="stop"&&gt[0]!="close"||kr(S,7);else S.I==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?kr(S,7):Ec(S):gt[0]!="noop"&&S.l&&S.l.qa(gt),S.A=0)}}di(4)}catch{}}var g_=class{constructor(g,I){this.g=g,this.map=I}};function gc(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wd(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function $a(g){return g.h?1:g.g?g.g.size:0}function Td(g,I){return g.h?g.h==I:g.g?g.g.has(I):!1}function yc(g,I){g.g?g.g.add(I):g.h=I}function ja(g,I){g.h&&g.h==I?g.h=null:g.g&&g.g.has(I)&&g.g.delete(I)}gc.prototype.cancel=function(){if(this.i=Sr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function Sr(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let I=g.i;for(const S of g.g.values())I=I.concat(S.G);return I}return x(g.i)}var Tp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cr(g,I){if(g){g=g.split("&");for(let S=0;S<g.length;S++){const N=g[S].indexOf("=");let W,Z=null;N>=0?(W=g[S].substring(0,N),Z=g[S].substring(N+1)):W=g[S],I(W,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function Mi(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let I;g instanceof Mi?(this.l=g.l,za(this,g.j),this.o=g.o,this.g=g.g,Li(this,g.u),this.h=g.h,Co(this,kd(g.i)),this.m=g.m):g&&(I=String(g).match(Tp))?(this.l=!1,za(this,I[1]||"",!0),this.o=Wa(I[2]||""),this.g=Wa(I[3]||"",!0),Li(this,I[4]),this.h=Wa(I[5]||"",!0),Co(this,I[6]||"",!0),this.m=Wa(I[7]||"")):(this.l=!1,this.i=new nt(null,this.l))}Mi.prototype.toString=function(){const g=[];var I=this.j;I&&g.push(Ka(I,Id,!0),":");var S=this.g;return(S||I=="file")&&(g.push("//"),(I=this.o)&&g.push(Ka(I,Id,!0),"@"),g.push(Di(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&g.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&g.push("/"),g.push(Ka(S,S.charAt(0)=="/"?Ja:xd,!0))),(S=this.i.toString())&&g.push("?",S),(S=this.m)&&g.push("#",Ka(S,Sd)),g.join("")},Mi.prototype.resolve=function(g){const I=Kr(this);let S=!!g.j;S?za(I,g.j):S=!!g.o,S?I.o=g.o:S=!!g.g,S?I.g=g.g:S=g.u!=null;var N=g.h;if(S)Li(I,g.u);else if(S=!!g.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var W=I.h.lastIndexOf("/");W!=-1&&(N=I.h.slice(0,W+1)+N)}if(W=N,W==".."||W==".")N="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){N=W.lastIndexOf("/",0)==0,W=W.split("/");const Z=[];for(let pe=0;pe<W.length;){const qe=W[pe++];qe=="."?N&&pe==W.length&&Z.push(""):qe==".."?((Z.length>1||Z.length==1&&Z[0]!="")&&Z.pop(),N&&pe==W.length&&Z.push("")):(Z.push(qe),N=!0)}N=Z.join("/")}else N=W}return S?I.h=N:S=g.i.toString()!=="",S?Co(I,kd(g.i)):S=!!g.m,S&&(I.m=g.m),I};function Kr(g){return new Mi(g)}function za(g,I,S){g.j=S?Wa(I,!0):I,g.j&&(g.j=g.j.replace(/:$/,""))}function Li(g,I){if(I){if(I=Number(I),isNaN(I)||I<0)throw Error("Bad port number "+I);g.u=I}else g.u=null}function Co(g,I,S){I instanceof nt?(g.i=I,vc(g.i,g.l)):(S||(I=Ka(I,y_)),g.i=new nt(I,g.l))}function ht(g,I,S){g.i.set(I,S)}function Ns(g){return ht(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Wa(g,I){return g?I?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Ka(g,I,S){return typeof g=="string"?(g=encodeURI(g).replace(I,Ed),S&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Ed(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Id=/[#\/\?@]/g,xd=/[#\?:]/g,Ja=/[#\?]/g,y_=/[#\?@]/g,Sd=/#/g;function nt(g,I){this.h=this.g=null,this.i=g||null,this.j=!!I}function Vi(g){g.g||(g.g=new Map,g.h=0,g.i&&Cr(g.i,function(I,S){g.add(decodeURIComponent(I.replace(/\+/g," ")),S)}))}n=nt.prototype,n.add=function(g,I){Vi(this),this.i=null,g=Fi(this,g);let S=this.g.get(g);return S||this.g.set(g,S=[]),S.push(I),this.h+=1,this};function Cd(g,I){Vi(g),I=Fi(g,I),g.g.has(I)&&(g.i=null,g.h-=g.g.get(I).length,g.g.delete(I))}function _c(g,I){return Vi(g),I=Fi(g,I),g.g.has(I)}n.forEach=function(g,I){Vi(this),this.g.forEach(function(S,N){S.forEach(function(W){g.call(I,W,N,this)},this)},this)};function Ad(g,I){Vi(g);let S=[];if(typeof I=="string")_c(g,I)&&(S=S.concat(g.g.get(Fi(g,I))));else for(g=Array.from(g.g.values()),I=0;I<g.length;I++)S=S.concat(g[I]);return S}n.set=function(g,I){return Vi(this),this.i=null,g=Fi(this,g),_c(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[I]),this.h+=1,this},n.get=function(g,I){return g?(g=Ad(this,g),g.length>0?String(g[0]):I):I};function Nd(g,I,S){Cd(g,I),S.length>0&&(g.i=null,g.g.set(Fi(g,I),x(S)),g.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],I=Array.from(this.g.keys());for(let N=0;N<I.length;N++){var S=I[N];const W=Di(S);S=Ad(this,S);for(let Z=0;Z<S.length;Z++){let pe=W;S[Z]!==""&&(pe+="="+Di(S[Z])),g.push(pe)}}return this.i=g.join("&")};function kd(g){const I=new nt;return I.i=g.i,g.g&&(I.g=new Map(g.g),I.h=g.h),I}function Fi(g,I){return I=String(I),g.j&&(I=I.toLowerCase()),I}function vc(g,I){I&&!g.j&&(Vi(g),g.i=null,g.g.forEach(function(S,N){const W=N.toLowerCase();N!=W&&(Cd(this,N),Nd(this,W,S))},g)),g.j=I}function Oi(g,I){const S=new zr;if(o.Image){const N=new Image;N.onload=p(Rn,S,"TestLoadImage: loaded",!0,I,N),N.onerror=p(Rn,S,"TestLoadImage: error",!1,I,N),N.onabort=p(Rn,S,"TestLoadImage: abort",!1,I,N),N.ontimeout=p(Rn,S,"TestLoadImage: timeout",!1,I,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=g}else I(!1)}function Ui(g,I){const S=new zr,N=new AbortController,W=setTimeout(()=>{N.abort(),Rn(S,"TestPingServer: timeout",!1,I)},1e4);fetch(g,{signal:N.signal}).then(Z=>{clearTimeout(W),Z.ok?Rn(S,"TestPingServer: ok",!0,I):Rn(S,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(W),Rn(S,"TestPingServer: error",!1,I)})}function Rn(g,I,S,N,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),N(S)}catch{}}function Qa(){this.g=new xs}function ks(g){this.i=g.Sb||null,this.h=g.ab||!1}v(ks,jr),ks.prototype.g=function(){return new Ar(this.i,this.h)};function Ar(g,I){Bt.call(this),this.H=g,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Ar,Bt),n=Ar.prototype,n.open=function(g,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=I,this.readyState=1,pi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const I={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(I.body=g),(this.H||o).fetch(new Request(this.D,I)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ao(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,pi(this)),this.g&&(this.readyState=3,pi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ep(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ep(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var I=g.value?g.value:new Uint8Array(0);(I=this.B.decode(I,{stream:!g.done}))&&(this.response=this.responseText+=I)}g.done?Ao(this):pi(this),this.readyState==3&&Ep(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,Ao(this))},n.Na=function(g){this.g&&(this.response=g,Ao(this))},n.ga=function(){this.g&&Ao(this)};function Ao(g){g.readyState=4,g.l=null,g.j=null,g.B=null,pi(g)}n.setRequestHeader=function(g,I){this.A.append(g,I)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],I=this.h.entries();for(var S=I.next();!S.done;)S=S.value,g.push(S[0]+": "+S[1]),S=I.next();return g.join(`\r
`)};function pi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Ar.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ip(g){let I="";return Ne(g,function(S,N){I+=N,I+=":",I+=S,I+=`\r
`}),I}function wc(g,I,S){e:{for(N in S){var N=!1;break e}N=!0}N||(S=Ip(S),typeof g=="string"?S!=null&&Di(S):ht(g,I,S))}function Tt(g){Bt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Tt,Bt);var xp=/^https?$/i,__=["POST","PUT"];n=Tt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,I,S,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);I=I?I.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mp.g(),this.g.onreadystatechange=w(d(this.Ca,this));try{this.B=!0,this.g.open(I,String(g),!0),this.B=!1}catch(Z){No(this,Z);return}if(g=S||"",S=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var W in N)S.set(W,N[W]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const Z of N.keys())S.set(Z,N.get(Z));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(S.keys()).find(Z=>Z.toLowerCase()=="content-type"),W=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(__,I,void 0)>=0)||N||W||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,pe]of S)this.g.setRequestHeader(Z,pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(Z){No(this,Z)}};function No(g,I){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=I,g.o=5,ko(g),bs(g)}function ko(g){g.A||(g.A=!0,qt(g,"complete"),qt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,qt(this,"complete"),qt(this,"abort"),bs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bs(this,!0)),Tt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Rs(this):this.Xa())},n.Xa=function(){Rs(this)};function Rs(g){if(g.h&&typeof s<"u"){if(g.v&&Bi(g)==4)setTimeout(g.Ca.bind(g),0);else if(qt(g,"readystatechange"),Bi(g)==4){g.h=!1;try{const Z=g.ca();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var S;if(!(S=I)){var N;if(N=Z===0){let pe=String(g.D).match(Tp)[1]||null;!pe&&o.self&&o.self.location&&(pe=o.self.location.protocol.slice(0,-1)),N=!xp.test(pe?pe.toLowerCase():"")}S=N}if(S)qt(g,"complete"),qt(g,"success");else{g.o=6;try{var W=Bi(g)>2?g.g.statusText:""}catch{W=""}g.l=W+" ["+g.ca()+"]",ko(g)}}finally{bs(g)}}}}function bs(g,I){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const S=g.g;g.g=null,I||qt(g,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Bi(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Bi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var I=this.g.responseText;return g&&I.indexOf(g)==0&&(I=I.substring(g.length)),Ua(I)}};function Sp(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Rd(g){const I={};g=(g.g&&Bi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<g.length;N++){if(M(g[N]))continue;var S=pc(g[N]);const W=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Z=I[W]||[];I[W]=Z,Z.push(S)}ye(I,function(N){return N.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qi(g,I,S){return S&&S.internalChannelParams&&S.internalChannelParams[g]||I}function Tc(g){this.za=0,this.i=[],this.j=new zr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qi("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qi("baseRetryDelayMs",5e3,g),this.Za=qi("retryDelaySeedMs",1e4,g),this.Ta=qi("forwardChannelMaxRetries",2,g),this.va=qi("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new gc(g&&g.concurrentRequestLimit),this.Ba=new Qa,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Tc.prototype,n.ka=8,n.I=1,n.connect=function(g,I,S,N){xe(0),this.W=g,this.H=I||{},S&&N!==void 0&&(this.H.OSID=S,this.H.OAID=N),this.F=this.X,this.J=Pd(this,null,this.W),Ps(this)};function Ec(g){if(Ic(g),g.I==3){var I=g.V++,S=Kr(g.J);if(ht(S,"SID",g.M),ht(S,"RID",I),ht(S,"TYPE","terminate"),Hi(g,S),I=new Wr(g,g.j,I),I.M=2,I.A=Ns(Kr(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(I.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=I.A,S=!0),S||(I.g=Ap(I.j,null),I.g.ea(I.A)),I.F=Date.now(),Ha(I)}Za(g)}function Nr(g){g.g&&(Xa(g),g.g.cancel(),g.g=null)}function Ic(g){Nr(g),g.v&&(o.clearTimeout(g.v),g.v=null),xc(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Ps(g){if(!wd(g.h)&&!g.m){g.m=!0;var I=g.Ea;te||k(),ee||(te(),ee=!0),P.add(I,g),g.D=0}}function Cp(g,I){return $a(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=I.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=yn(d(g.Ea,g,I),Cc(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const W=new Wr(this,this.j,g);let Z=this.o;if(this.U&&(Z?(Z=G(Z),Re(Z,this.U)):Z=this.U),this.u!==null||this.R||(W.J=Z,Z=null),this.S)e:{for(var I=0,S=0;S<this.i.length;S++){t:{var N=this.i[S];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(I+=N,I>4096){I=S;break e}if(I===4096||S===this.i.length-1){I=S+1;break e}}I=1e3}else I=1e3;I=bd(this,W,I),S=Kr(this.J),ht(S,"RID",g),ht(S,"CVER",22),this.G&&ht(S,"X-HTTP-Session-Id",this.G),Hi(this,S),Z&&(this.R?I="headers="+Di(Ip(Z))+"&"+I:this.u&&wc(S,this.u,Z)),yc(this.h,W),this.Ra&&ht(S,"TYPE","init"),this.S?(ht(S,"$req",I),ht(S,"SID","null"),W.U=!0,fi(W,S,null)):fi(W,S,I),this.I=2}}else this.I==3&&(g?Ya(this,g):this.i.length==0||wd(this.h)||Ya(this))};function Ya(g,I){var S;I?S=I.l:S=g.V++;const N=Kr(g.J);ht(N,"SID",g.M),ht(N,"RID",S),ht(N,"AID",g.K),Hi(g,N),g.u&&g.o&&wc(N,g.u,g.o),S=new Wr(g,g.j,S,g.D+1),g.u===null&&(S.J=g.o),I&&(g.i=I.G.concat(g.i)),I=bd(g,S,1e3),S.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),yc(g.h,S),fi(S,N,I)}function Hi(g,I){g.H&&Ne(g.H,function(S,N){ht(I,N,S)}),g.l&&Ne({},function(S,N){ht(I,N,S)})}function bd(g,I,S){S=Math.min(g.i.length,S);const N=g.l?d(g.l.Ka,g.l,g):null;e:{var W=g.i;let qe=-1;for(;;){const Xt=["count="+S];qe==-1?S>0?(qe=W[0].g,Xt.push("ofs="+qe)):qe=0:Xt.push("ofs="+qe);let gt=!0;for(let sn=0;sn<S;sn++){var Z=W[sn].g;const Rr=W[sn].map;if(Z-=qe,Z<0)qe=Math.max(0,W[sn].g-100),gt=!1;else try{Z="req"+Z+"_"||"";try{var pe=Rr instanceof Map?Rr:Object.entries(Rr);for(const[Ds,$i]of pe){let ji=$i;l($i)&&(ji=ui($i)),Xt.push(Z+Ds+"="+encodeURIComponent(ji))}}catch(Ds){throw Xt.push(Z+"type="+encodeURIComponent("_badmap")),Ds}}catch{N&&N(Rr)}}if(gt){pe=Xt.join("&");break e}}pe=void 0}return g=g.i.splice(0,S),I.G=g,pe}function Un(g){if(!g.g&&!g.v){g.Y=1;var I=g.Da;te||k(),ee||(te(),ee=!0),P.add(I,g),g.A=0}}function Gi(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=yn(d(g.Da,g),Cc(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Ro(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=yn(d(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xe(10),Nr(this),Ro(this))};function Xa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function Ro(g){g.g=new Wr(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var I=Kr(g.na);ht(I,"RID","rpc"),ht(I,"SID",g.M),ht(I,"AID",g.K),ht(I,"CI",g.F?"0":"1"),!g.F&&g.ia&&ht(I,"TO",g.ia),ht(I,"TYPE","xmlhttp"),Hi(g,I),g.u&&g.o&&wc(I,g.u,g.o),g.O&&(g.g.H=g.O);var S=g.g;g=g.ba,S.M=1,S.A=Ns(Kr(I)),S.u=null,S.R=!0,_d(S,g)}n.Va=function(){this.C!=null&&(this.C=null,Nr(this),Gi(this),xe(19))};function xc(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Sc(g,I){var S=null;if(g.g==I){xc(g),Xa(g),g.g=null;var N=2}else if(Td(g.h,I))S=I.G,ja(g.h,I),N=1;else return;if(g.I!=0){if(I.o)if(N==1){S=I.u?I.u.length:0,I=Date.now()-I.F;var W=g.D;N=Pi(),qt(N,new ot(N,S)),Ps(g)}else Un(g);else if(W=I.m,W==3||W==0&&I.X>0||!(N==1&&Cp(g,I)||N==2&&Gi(g)))switch(S&&S.length>0&&(I=g.h,I.i=I.i.concat(S)),W){case 1:kr(g,5);break;case 4:kr(g,10);break;case 3:kr(g,6);break;default:kr(g,2)}}}function Cc(g,I){let S=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(S*=2),S*I}function kr(g,I){if(g.j.info("Error code "+I),I==2){var S=d(g.bb,g),N=g.Ua;const W=!N;N=new Mi(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||za(N,"https"),Ns(N),W?Oi(N.toString(),S):Ui(N.toString(),S)}else xe(2);g.I=0,g.l&&g.l.pa(I),Za(g),Ic(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))};function Za(g){if(g.I=0,g.ja=[],g.l){const I=Sr(g.h);(I.length!=0||g.i.length!=0)&&(A(g.ja,I),A(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Pd(g,I,S){var N=S instanceof Mi?Kr(S):new Mi(S);if(N.g!="")I&&(N.g=I+"."+N.g),Li(N,N.u);else{var W=o.location;N=W.protocol,I=I?I+"."+W.hostname:W.hostname,W=+W.port;const Z=new Mi(null);N&&za(Z,N),I&&(Z.g=I),W&&Li(Z,W),S&&(Z.h=S),N=Z}return S=g.G,I=g.wa,S&&I&&ht(N,S,I),ht(N,"VER",g.ka),Hi(g,N),N}function Ap(g,I,S){if(I&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return I=g.Aa&&!g.ma?new Tt(new ks({ab:S})):new Tt(g.ma),I.Fa(g.L),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Np(){}n=Np.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ac(){}Ac.prototype.g=function(g,I){return new bn(g,I)};function bn(g,I){Bt.call(this),this.g=new Tc(I),this.l=g,this.h=I&&I.messageUrlParams||null,g=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(g?g["X-WebChannel-Content-Type"]=I.messageContentType:g={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.sa&&(g?g["X-WebChannel-Client-Profile"]=I.sa:g={"X-WebChannel-Client-Profile":I.sa}),this.g.U=g,(g=I&&I.Qb)&&!M(g)&&(this.g.u=g),this.A=I&&I.supportsCrossDomainXhr||!1,this.v=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!M(I)&&(this.g.G=I,g=this.h,g!==null&&I in g&&(g=this.h,I in g&&delete g[I])),this.j=new bo(this)}v(bn,Bt),bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){Ec(this.g)},bn.prototype.o=function(g){var I=this.g;if(typeof g=="string"){var S={};S.__data__=g,g=S}else this.v&&(S={},S.__data__=ui(g),g=S);I.i.push(new g_(I.Ya++,g)),I.I==3&&Ps(I)},bn.prototype.N=function(){this.g.l=null,delete this.j,Ec(this.g),delete this.g,bn.Z.N.call(this)};function kp(g){wo.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var I=g.__sm__;if(I){e:{for(const S in I){g=S;break e}g=void 0}(this.i=g)&&(g=this.i,I=I!==null&&g in I?I[g]:void 0),this.data=I}else this.data=g}v(kp,wo);function Rp(){Ba.call(this),this.status=1}v(Rp,Ba);function bo(g){this.g=g}v(bo,Np),bo.prototype.ra=function(){qt(this.g,"a")},bo.prototype.qa=function(g){qt(this.g,new kp(g))},bo.prototype.pa=function(g){qt(this.g,new Rp)},bo.prototype.oa=function(){qt(this.g,"b")},Ac.prototype.createWebChannel=Ac.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,oD=function(){return new Ac},sD=function(){return Pi()},iD=Ir,o0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xo.NO_ERROR=0,xo.TIMEOUT=8,xo.HTTP_ERROR=6,Hm=xo,So.COMPLETE="complete",rD=So,fc.EventType=bi,bi.OPEN="a",bi.CLOSE="b",bi.ERROR="c",bi.MESSAGE="d",Bt.prototype.listen=Bt.prototype.J,Ch=fc,Tt.prototype.listenOnce=Tt.prototype.K,Tt.prototype.getLastError=Tt.prototype.Ha,Tt.prototype.getLastErrorCode=Tt.prototype.ya,Tt.prototype.getStatus=Tt.prototype.ca,Tt.prototype.getResponseJson=Tt.prototype.La,Tt.prototype.getResponseText=Tt.prototype.la,Tt.prototype.send=Tt.prototype.ea,Tt.prototype.setWithCredentials=Tt.prototype.Fa,nD=Tt}).apply(typeof Nm<"u"?Nm:typeof self<"u"?self:typeof window<"u"?window:{});const GA="@firebase/firestore",$A="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let od="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Yu("@firebase/firestore");function ru(){return wa.logLevel}function D7(n){wa.setLogLevel(n)}function oe(n,...e){if(wa.logLevel<=Je.DEBUG){const t=e.map(fE);wa.debug(`Firestore (${od}): ${n}`,...t)}}function en(n,...e){if(wa.logLevel<=Je.ERROR){const t=e.map(fE);wa.error(`Firestore (${od}): ${n}`,...t)}}function ys(n,...e){if(wa.logLevel<=Je.WARN){const t=e.map(fE);wa.warn(`Firestore (${od}): ${n}`,...t)}}function fE(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,aD(n,r,t)}function aD(n,e,t){let r=`FIRESTORE (${od}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw en(r),new Error(r)}function Ce(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||aD(e,i,r)}function M7(n,e){n||we(57014,e)}function ge(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Kn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class L7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Sn.UNAUTHENTICATED)))}shutdown(){}}class V7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class F7{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ce(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let s=new Fn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Fn,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},l=u=>{oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Fn)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ce(typeof r.accessToken=="string",31837,{l:r}),new lD(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string",2055,{h:e}),new Sn(e)}}class O7{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class U7{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new O7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Sn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class jA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class B7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ce(this.o===void 0,3512);const r=s=>{s.error!=null&&oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new jA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ce(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=q7(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Oe(n,e){return n<e?-1:n>e?1:0}function a0(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return lw(i)===lw(s)?Oe(i,s):lw(i)?1:-1}return Oe(n.length,e.length)}const H7=55296,G7=57343;function lw(n){const e=n.charCodeAt(0);return e>=H7&&e<=G7}function bu(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function cD(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA="__name__";class Qi{constructor(e,t,r){t===void 0?t=0:t>e.length&&we(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&we(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Qi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qi?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Qi.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Oe(e.length,t.length)}static compareSegments(e,t){const r=Qi.isNumericId(e),i=Qi.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Qi.extractNumericId(e).compare(Qi.extractNumericId(t)):a0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ua.fromString(e.substring(4,e.length-2))}}class Xe extends Qi{construct(e,t,r){return new Xe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Xe(t)}static emptyPath(){return new Xe([])}}const $7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ot extends Qi{construct(e,t,r){return new Ot(e,t,r)}static isValidIdentifier(e){return $7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ot.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zA}static keyField(){return new Ot([zA])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ie(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new ie(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ie(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new ie(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ot(t)}static emptyPath(){return new Ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.path=e}static fromPath(e){return new me(Xe.fromString(e))}static fromName(e){return new me(Xe.fromString(e).popFirst(5))}static empty(){return new me(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(n,e,t){if(!t)throw new ie(X.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uD(n,e,t,r){if(e===!0&&r===!0)throw new ie(X.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function WA(n){if(!me.isDocumentKey(n))throw new ie(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function KA(n){if(me.isDocumentKey(n))throw new ie(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function dD(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":we(12329,{type:typeof n})}function ct(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ie(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vy(n);throw new ie(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function hD(n,e){if(e<=0)throw new ie(X.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Xf(n,e){if(!dD(n))throw new ie(X.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ie(X.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA=-62135596800,QA=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*QA);return new pt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ie(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ie(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<JA)throw new ie(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/QA}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xf(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-JA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:cn("string",pt._jsonSchemaVersion),seconds:cn("number"),nanoseconds:cn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{static fromTimestamp(e){return new be(e)}static min(){return new be(new pt(0,0))}static max(){return new be(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=-1;class Sg{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function l0(n){return n.fields.find((e=>e.kind===2))}function ml(n){return n.fields.filter((e=>e.kind!==2))}Sg.UNKNOWN_ID=-1;class Gm{constructor(e,t){this.fieldPath=e,this.kind=t}}class _f{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _f(0,Gr.min())}}function fD(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=be.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new Gr(i,me.empty(),e)}function pD(n){return new Gr(n.readTime,n.key,Pu)}class Gr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Gr(be.min(),me.empty(),Pu)}static max(){return new Gr(be.max(),me.empty(),Pu)}}function gE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=me.comparator(n.documentKey,e.documentKey),t!==0?t:Oe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pa(n){if(n.code!==X.FAILED_PRECONDITION||n.message!==mD)throw n;oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):$.reject(t)}static resolve(e){return new $(((t,r)=>{t(e)}))}static reject(e){return new $(((t,r)=>{r(e)}))}static waitFor(e){return new $(((t,r)=>{let i=0,s=0,o=!1;e.forEach((l=>{++i,l.next((()=>{++s,o&&s===i&&t()}),(u=>r(u)))})),o=!0,s===i&&t()}))}static or(e){let t=$.resolve(!1);for(const r of e)t=t.next((i=>i?$.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new $(((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const d=u;t(e[d]).next((p=>{o[d]=p,++l,l===s&&r(o)}),(p=>i(p)))}}))}static doWhile(e,t){return new $(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr="SimpleDb";class Fy{static open(e,t,r,i){try{return new Fy(t,e.transaction(i,r))}catch(s){throw new qh(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Fn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new qh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=yE(r.target.error);this.S.reject(new qh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(oe(Lr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new z7(t)}}class cs{static delete(e){return oe(Lr,"Removing database:",e),yl(eT().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Dl())return!1;if(cs.F())return!0;const e=zt(),t=cs.M(e),r=0<t&&t<10,i=yD(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,cs.M(zt())===12.2&&en("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(oe(Lr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new qh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ie(X.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ie(X.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new qh(e,o))},i.onupgradeneeded=s=>{oe(Lr,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{oe(Lr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Fy.open(this.db,e,s?"readonly":"readwrite",r),u=i(l).next((d=>(l.C(),d))).catch((d=>(l.abort(d),$.reject(d)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,d=u.name!=="FirebaseError"&&o<3;if(oe(Lr,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function yD(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class j7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return yl(this.U.delete())}}class qh extends ie{constructor(e,t){super(X.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Da(n){return n.name==="IndexedDbTransactionError"}class z7{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(oe(Lr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(oe(Lr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yl(r)}add(e){return oe(Lr,"ADD",this.store.name,e,e),yl(this.store.add(e))}get(e){return yl(this.store.get(e)).next((t=>(t===void 0&&(t=null),oe(Lr,"GET",this.store.name,e,t),t)))}delete(e){return oe(Lr,"DELETE",this.store.name,e),yl(this.store.delete(e))}count(){return oe(Lr,"COUNT",this.store.name),yl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new $(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(r),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new $(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){oe(Lr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,o,l)=>l.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new $(((r,i)=>{t.onerror=s=>{const o=yE(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():r()})):r()}}))}H(e,t){const r=[];return new $(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const u=new j7(l),d=t(l.primaryKey,l.value,u);if(d instanceof $){const p=d.catch((v=>(u.done(),$.reject(v))));r.push(p)}u.isDone?i():u.G===null?l.continue():l.continue(u.G)}})).next((()=>$.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function yl(n){return new $(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=yE(r.target.error);t(i)}}))}let YA=!1;function yE(n){const e=cs.M(zt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return YA||(YA=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Hh="IndexBackfiller";class W7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){oe(Hh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();oe(Hh,`Documents written: ${t}`)}catch(t){Da(t)?oe(Hh,"Ignoring IndexedDB error during index backfill: ",t):await Pa(t)}await this.re(6e4)}))}}class K7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return $.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return oe(Hh,`Processing collection: ${o}`),this.oe(e,o,i).next((l=>{i-=l,r.add(o)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((l=>(oe(Hh,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const o=pD(s);gE(o,r)>0&&(r=o)})),new Gr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=-1;function Zf(n){return n==null}function vf(n){return n===0&&1/n==-1/0}function _D(n){return typeof n=="number"&&Number.isInteger(n)&&!vf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="";function Qn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=XA(e)),e=J7(n.get(t),e);return XA(e)}function J7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case Cg:t+="";break;default:t+=s}}return t}function XA(n){return n+Cg+""}function is(n){const e=n.length;if(Ce(e>=2,64408,{path:n}),e===2)return Ce(n.charAt(0)===Cg&&n.charAt(1)==="",56145,{path:n}),Xe.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf(Cg,s);switch((o<0||o>t)&&we(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;i.length===0?u=l:(i+=l,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:we(61167,{path:n})}s=o+2}return new Xe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl="remoteDocuments",ep="owner",Yc="owner",wf="mutationQueues",Q7="userId",Ei="mutations",ZA="batchId",Sl="userMutationsIndex",eN=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(n,e){return[n,Qn(e)]}function vD(n,e,t){return[n,Qn(e),t]}const Y7={},Du="documentMutations",Ag="remoteDocumentsV14",X7=["prefixPath","collectionGroup","readTime","documentId"],jm="documentKeyIndex",Z7=["prefixPath","collectionGroup","documentId"],wD="collectionGroupIndex",e8=["collectionGroup","readTime","prefixPath","documentId"],Tf="remoteDocumentGlobal",c0="remoteDocumentGlobalKey",Mu="targets",TD="queryTargetsIndex",t8=["canonicalId","targetId"],Lu="targetDocuments",n8=["targetId","path"],_E="documentTargetsIndex",r8=["path","targetId"],Ng="targetGlobalKey",Pl="targetGlobal",Ef="collectionParents",i8=["collectionId","parent"],Vu="clientMetadata",s8="clientId",Oy="bundles",o8="bundleId",Uy="namedQueries",a8="name",vE="indexConfiguration",l8="indexId",u0="collectionGroupIndex",c8="collectionGroup",Gh="indexState",u8=["indexId","uid"],ED="sequenceNumberIndex",d8=["uid","sequenceNumber"],$h="indexEntries",h8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ID="documentKeyIndex",f8=["indexId","uid","orderedDocumentKey"],By="documentOverlays",p8=["userId","collectionPath","documentId"],d0="collectionPathOverlayIndex",m8=["userId","collectionPath","largestBatchId"],xD="collectionGroupOverlayIndex",g8=["userId","collectionGroup","largestBatchId"],wE="globals",y8="name",SD=[wf,Ei,Du,gl,Mu,ep,Pl,Lu,Vu,Tf,Ef,Oy,Uy],_8=[...SD,By],CD=[wf,Ei,Du,Ag,Mu,ep,Pl,Lu,Vu,Tf,Ef,Oy,Uy,By],AD=CD,TE=[...AD,vE,Gh,$h],v8=TE,ND=[...TE,wE],w8=ND;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends gD{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function gn(n,e){const t=ge(n);return cs.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ma(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t){this.comparator=e,this.root=t||Mn.EMPTY}insert(e,t){return new At(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Mn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new km(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new km(this.root,e,this.comparator,!1)}getReverseIterator(){return new km(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new km(this.root,e,this.comparator,!0)}}class km{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Mn.RED,this.left=i??Mn.EMPTY,this.right=s??Mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Mn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Mn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw we(43730,{key:this.key,value:this.value});if(this.right.isRed())throw we(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw we(27949);return e+(this.isRed()?0:1)}}Mn.EMPTY=null,Mn.RED=!0,Mn.BLACK=!1;Mn.EMPTY=new class{constructor(){this.size=0}get key(){throw we(57766)}get value(){throw we(16141)}get color(){throw we(16727)}get left(){throw we(29726)}get right(){throw we(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Mn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nN(this.data.getIterator())}getIteratorFrom(e){return new nN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new vt(this.comparator);return t.data=e,t}}class nN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.fields=e,e.sort(Ot.comparator)}static empty(){return new _r([])}unionWith(e){let t=new vt(Ot.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new _r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bu(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new RD("Invalid base64 string: "+s):s}})(e);return new Jt(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new Jt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jt.EMPTY_BYTE_STRING=new Jt("");const E8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function no(n){if(Ce(!!n,39018),typeof n=="string"){let e=0;const t=E8.exec(n);if(Ce(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ro(n){return typeof n=="string"?Jt.fromBase64String(n):Jt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="server_timestamp",PD="__type__",DD="__previous_value__",MD="__local_write_time__";function qy(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[PD])==null?void 0:r.stringValue)===bD}function Hy(n){const e=n.mapValue.fields[DD];return qy(e)?Hy(e):e}function If(n){const e=no(n.mapValue.fields[MD].timestampValue);return new pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I8{constructor(e,t,r,i,s,o,l,u,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=p}}const f0="(default)";class Ta{constructor(e,t){this.projectId=e,this.database=t||f0}static empty(){return new Ta("","")}get isDefaultDatabase(){return this.database===f0}isEqual(e){return e instanceof Ta&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE="__type__",LD="__max__",na={mapValue:{fields:{__type__:{stringValue:LD}}}},IE="__vector__",Fu="value",zm={nullValue:"NULL_VALUE"};function Ea(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qy(n)?4:VD(n)?9007199254740991:Gy(n)?10:11:we(28295,{value:n})}function _s(n,e){if(n===e)return!0;const t=Ea(n);if(t!==Ea(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return If(n).isEqual(If(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=no(i.timestampValue),l=no(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return ro(i.bytesValue).isEqual(ro(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Vt(i.geoPointValue.latitude)===Vt(s.geoPointValue.latitude)&&Vt(i.geoPointValue.longitude)===Vt(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Vt(i.integerValue)===Vt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Vt(i.doubleValue),l=Vt(s.doubleValue);return o===l?vf(o)===vf(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return bu(n.arrayValue.values||[],e.arrayValue.values||[],_s);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(tN(o)!==tN(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!_s(o[u],l[u])))return!1;return!0})(n,e);default:return we(52216,{left:n})}}function xf(n,e){return(n.values||[]).find((t=>_s(t,e)))!==void 0}function Ia(n,e){if(n===e)return 0;const t=Ea(n),r=Ea(e);if(t!==r)return Oe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oe(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Vt(s.integerValue||s.doubleValue),u=Vt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return rN(n.timestampValue,e.timestampValue);case 4:return rN(If(n),If(e));case 5:return a0(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=ro(s),u=ro(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const p=Oe(l[d],u[d]);if(p!==0)return p}return Oe(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Oe(Vt(s.latitude),Vt(o.latitude));return l!==0?l:Oe(Vt(s.longitude),Vt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return iN(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var w,x,A,R;const l=s.fields||{},u=o.fields||{},d=(w=l[Fu])==null?void 0:w.arrayValue,p=(x=u[Fu])==null?void 0:x.arrayValue,v=Oe(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((R=p==null?void 0:p.values)==null?void 0:R.length)||0);return v!==0?v:iN(d,p)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===na.mapValue&&o===na.mapValue)return 0;if(s===na.mapValue)return 1;if(o===na.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),d=o.fields||{},p=Object.keys(d);u.sort(),p.sort();for(let v=0;v<u.length&&v<p.length;++v){const w=a0(u[v],p[v]);if(w!==0)return w;const x=Ia(l[u[v]],d[p[v]]);if(x!==0)return x}return Oe(u.length,p.length)})(n.mapValue,e.mapValue);default:throw we(23264,{he:t})}}function rN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Oe(n,e);const t=no(n),r=no(e),i=Oe(t.seconds,r.seconds);return i!==0?i:Oe(t.nanos,r.nanos)}function iN(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Ia(t[i],r[i]);if(s)return s}return Oe(t.length,r.length)}function Ou(n){return p0(n)}function p0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=no(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ro(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=p0(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${p0(t.fields[o])}`;return i+"}"})(n.mapValue):we(61005,{value:n})}function Wm(n){switch(Ea(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hy(n);return e?16+Wm(e):16;case 5:return 2*n.stringValue.length;case 6:return ro(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Wm(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Ma(r.fields,((s,o)=>{i+=s.length+Wm(o)})),i})(n.mapValue);default:throw we(13486,{value:n})}}function ql(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function m0(n){return!!n&&"integerValue"in n}function Sf(n){return!!n&&"arrayValue"in n}function sN(n){return!!n&&"nullValue"in n}function oN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Km(n){return!!n&&"mapValue"in n}function Gy(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[EE])==null?void 0:r.stringValue)===IE}function jh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ma(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=jh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=jh(n.arrayValue.values[t]);return e}return{...n}}function VD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===LD}const FD={mapValue:{fields:{[EE]:{stringValue:IE},[Fu]:{arrayValue:{}}}}};function x8(n){return"nullValue"in n?zm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ql(Ta.empty(),me.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Gy(n)?FD:{mapValue:{}}:we(35942,{value:n})}function S8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ql(Ta.empty(),me.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?FD:"mapValue"in n?Gy(n)?{mapValue:{}}:na:we(61959,{value:n})}function aN(n,e){const t=Ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function lN(n,e){const t=Ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.value=e}static empty(){return new Ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Km(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jh(t)}setAll(e){let t=Ot.emptyPath(),r={},i=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=jh(o):i.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Km(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _s(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Km(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ma(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new Ln(jh(this.value))}}function OD(n){const e=[];return Ma(n.fields,((t,r)=>{const i=new Ot([t]);if(Km(r)){const s=OD(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new _r(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Dt(e,0,be.min(),be.min(),be.min(),Ln.empty(),0)}static newFoundDocument(e,t,r,i){return new Dt(e,1,t,be.min(),r,i,0)}static newNoDocument(e,t){return new Dt(e,2,t,be.min(),be.min(),Ln.empty(),0)}static newUnknownDocument(e,t){return new Dt(e,3,t,be.min(),be.min(),Ln.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t){this.position=e,this.inclusive=t}}function cN(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=me.comparator(me.fromName(o.referenceValue),t.key):r=Ia(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function uN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!_s(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t="asc"){this.field=e,this.dir=t}}function C8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{}class Ze extends UD{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new A8(e,t,r):t==="array-contains"?new R8(e,r):t==="in"?new jD(e,r):t==="not-in"?new b8(e,r):t==="array-contains-any"?new P8(e,r):new Ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new N8(e,r):new k8(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ia(t,this.value)):t!==null&&Ea(this.value)===Ea(t)&&this.matchesComparison(Ia(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _t extends UD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _t(e,t)}matches(e){return Uu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Uu(n){return n.op==="and"}function g0(n){return n.op==="or"}function xE(n){return BD(n)&&Uu(n)}function BD(n){for(const e of n.filters)if(e instanceof _t)return!1;return!0}function y0(n){if(n instanceof Ze)return n.field.canonicalString()+n.op.toString()+Ou(n.value);if(xE(n))return n.filters.map((e=>y0(e))).join(",");{const e=n.filters.map((t=>y0(t))).join(",");return`${n.op}(${e})`}}function qD(n,e){return n instanceof Ze?(function(r,i){return i instanceof Ze&&r.op===i.op&&r.field.isEqual(i.field)&&_s(r.value,i.value)})(n,e):n instanceof _t?(function(r,i){return i instanceof _t&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,l)=>s&&qD(o,i.filters[l])),!0):!1})(n,e):void we(19439)}function HD(n,e){const t=n.filters.concat(e);return _t.create(t,n.op)}function GD(n){return n instanceof Ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ou(t.value)}`})(n):n instanceof _t?(function(t){return t.op.toString()+" {"+t.getFilters().map(GD).join(" ,")+"}"})(n):"Filter"}class A8 extends Ze{constructor(e,t,r){super(e,t,r),this.key=me.fromName(r.referenceValue)}matches(e){const t=me.comparator(e.key,this.key);return this.matchesComparison(t)}}class N8 extends Ze{constructor(e,t){super(e,"in",t),this.keys=$D("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class k8 extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=$D("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $D(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>me.fromName(r.referenceValue)))}class R8 extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sf(t)&&xf(t.arrayValue,this.value)}}class jD extends Ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&xf(this.value.arrayValue,t)}}class b8 extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(xf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!xf(this.value.arrayValue,t)}}class P8 extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>xf(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function _0(n,e=null,t=[],r=[],i=null,s=null,o=null){return new D8(n,e,t,r,i,s,o)}function Hl(n){const e=ge(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>y0(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Zf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ou(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ou(r))).join(",")),e.Te=t}return e.Te}function tp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!C8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!qD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uN(n.startAt,e.startAt)&&uN(n.endAt,e.endAt)}function kg(n){return me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Rg(n,e){return n.filters.filter((t=>t instanceof Ze&&t.field.isEqual(e)))}function dN(n,e,t){let r=zm,i=!0;for(const s of Rg(n,e)){let o=zm,l=!0;switch(s.op){case"<":case"<=":o=x8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=zm}aN({value:r,inclusive:i},{value:o,inclusive:l})<0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];aN({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function hN(n,e,t){let r=na,i=!0;for(const s of Rg(n,e)){let o=na,l=!0;switch(s.op){case">=":case">":o=S8(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=na}lN({value:r,inclusive:i},{value:o,inclusive:l})>0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];lN({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zD(n,e,t,r,i,s,o,l){return new co(n,e,t,r,i,s,o,l)}function ad(n){return new co(n)}function fN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function SE(n){return n.collectionGroup!==null}function yu(n){const e=ge(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new vt(Ot.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(l=l.add(d.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Cf(s,r))})),t.has(Ot.keyField().canonicalString())||e.Ie.push(new Cf(Ot.keyField(),r))}return e.Ie}function ir(n){const e=ge(n);return e.Ee||(e.Ee=M8(e,yu(n))),e.Ee}function M8(n,e){if(n.limitType==="F")return _0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Cf(i.field,s)}));const t=n.endAt?new xa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new xa(n.startAt.position,n.startAt.inclusive):null;return _0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function v0(n,e){const t=n.filters.concat([e]);return new co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function bg(n,e,t){return new co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function np(n,e){return tp(ir(n),ir(e))&&n.limitType===e.limitType}function WD(n){return`${Hl(ir(n))}|lt:${n.limitType}`}function iu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>GD(i))).join(", ")}]`),Zf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Ou(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Ou(i))).join(",")),`Target(${r})`})(ir(n))}; limitType=${n.limitType})`}function rp(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):me.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of yu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,l,u){const d=cN(o,l,u);return o.inclusive?d<=0:d<0})(r.startAt,yu(r),i)||r.endAt&&!(function(o,l,u){const d=cN(o,l,u);return o.inclusive?d>=0:d>0})(r.endAt,yu(r),i))})(n,e)}function KD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JD(n){return(e,t)=>{let r=!1;for(const i of yu(n)){const s=L8(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function L8(n,e,t){const r=n.field.isKeyField()?me.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),d=l.data.field(s);return u!==null&&d!==null?Ia(u,d):we(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return we(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ma(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return kD(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V8=new At(me.comparator);function vr(){return V8}const QD=new At(me.comparator);function Ah(...n){let e=QD;for(const t of n)e=e.insert(t.key,t);return e}function YD(n){let e=QD;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ss(){return zh()}function XD(){return zh()}function zh(){return new uo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const F8=new At(me.comparator),O8=new vt(me.comparator);function Ge(...n){let e=O8;for(const t of n)e=e.add(t);return e}const U8=new vt(Oe);function CE(){return U8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vf(e)?"-0":e}}function ZD(n){return{integerValue:""+n}}function eM(n,e){return _D(e)?ZD(e):AE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this._=void 0}}function B8(n,e,t){return n instanceof Bu?(function(i,s){const o={fields:{[PD]:{stringValue:bD},[MD]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&qy(s)&&(s=Hy(s)),s&&(o.fields[DD]=s),{mapValue:o}})(t,e):n instanceof Gl?nM(n,e):n instanceof $l?rM(n,e):(function(i,s){const o=tM(i,s),l=pN(o)+pN(i.Ae);return m0(o)&&m0(i.Ae)?ZD(l):AE(i.serializer,l)})(n,e)}function q8(n,e,t){return n instanceof Gl?nM(n,e):n instanceof $l?rM(n,e):t}function tM(n,e){return n instanceof qu?(function(r){return m0(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class Bu extends $y{}class Gl extends $y{constructor(e){super(),this.elements=e}}function nM(n,e){const t=iM(e);for(const r of n.elements)t.some((i=>_s(i,r)))||t.push(r);return{arrayValue:{values:t}}}class $l extends $y{constructor(e){super(),this.elements=e}}function rM(n,e){let t=iM(e);for(const r of n.elements)t=t.filter((i=>!_s(i,r)));return{arrayValue:{values:t}}}class qu extends $y{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function pN(n){return Vt(n.integerValue||n.doubleValue)}function iM(n){return Sf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,t){this.field=e,this.transform=t}}function H8(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Gl&&i instanceof Gl||r instanceof $l&&i instanceof $l?bu(r.elements,i.elements,_s):r instanceof qu&&i instanceof qu?_s(r.Ae,i.Ae):r instanceof Bu&&i instanceof Bu})(n.transform,e.transform)}class G8{constructor(e,t){this.version=e,this.transformResults=t}}class Ut{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ut}static exists(e){return new Ut(void 0,e)}static updateTime(e){return new Ut(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class jy{}function sM(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cd(n.key,Ut.none()):new ld(n.key,n.data,Ut.none());{const t=n.data,r=Ln.empty();let i=new vt(Ot.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ho(n.key,r,new _r(i.toArray()),Ut.none())}}function $8(n,e,t){n instanceof ld?(function(i,s,o){const l=i.value.clone(),u=gN(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof ho?(function(i,s,o){if(!Jm(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=gN(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(oM(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Wh(n,e,t,r){return n instanceof ld?(function(s,o,l,u){if(!Jm(s.precondition,o))return l;const d=s.value.clone(),p=yN(s.fieldTransforms,u,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof ho?(function(s,o,l,u){if(!Jm(s.precondition,o))return l;const d=yN(s.fieldTransforms,u,o),p=o.data;return p.setAll(oM(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(s,o,l){return Jm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function j8(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=tM(r.transform,i||null);s!=null&&(t===null&&(t=Ln.empty()),t.set(r.field,s))}return t||null}function mN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&bu(r,i,((s,o)=>H8(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ld extends jy{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ho extends jy{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function oM(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function gN(n,e,t){const r=new Map;Ce(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,q8(o,l,t[i]))}return r}function yN(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,B8(s,o,e))}return r}class cd extends jy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NE extends jy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&$8(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=XD();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const u=sM(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(be.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ge())}isEqual(e){return this.batchId===e.batchId&&bu(this.mutations,e.mutations,((t,r)=>mN(t,r)))&&bu(this.baseMutations,e.baseMutations,((t,r)=>mN(t,r)))}}class RE{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ce(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return F8})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new RE(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var an,rt;function aM(n){switch(n){case X.OK:return we(64938);case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0;default:return we(15467,{code:n})}}function lM(n){if(n===void 0)return en("GRPC error has no .code"),X.UNKNOWN;switch(n){case an.OK:return X.OK;case an.CANCELLED:return X.CANCELLED;case an.UNKNOWN:return X.UNKNOWN;case an.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case an.INTERNAL:return X.INTERNAL;case an.UNAVAILABLE:return X.UNAVAILABLE;case an.UNAUTHENTICATED:return X.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case an.NOT_FOUND:return X.NOT_FOUND;case an.ALREADY_EXISTS:return X.ALREADY_EXISTS;case an.PERMISSION_DENIED:return X.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case an.ABORTED:return X.ABORTED;case an.OUT_OF_RANGE:return X.OUT_OF_RANGE;case an.UNIMPLEMENTED:return X.UNIMPLEMENTED;case an.DATA_LOSS:return X.DATA_LOSS;default:return we(39323,{code:n})}}(rt=an||(an={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8=new ua([4294967295,4294967295],0);function _N(n){const e=cM().encode(n),t=new tD;return t.update(e),new Uint8Array(t.digest())}function vN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ua([t,r],0),new ua([i,s],0)]}class PE{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Nh(`Invalid padding: ${t}`);if(r<0)throw new Nh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Nh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ua.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(ua.fromNumber(r)));return i.compare(W8)===1&&(i=new ua([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=_N(e),[r,i]=vN(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new PE(s,i,t);return r.forEach((l=>o.insert(l))),o}insert(e){if(this.ge===0)return;const t=_N(e),[r,i]=vN(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Nh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,op.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new sp(be.min(),i,new At(Oe),vr(),Ge())}}class op{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new op(r,t,Ge(),Ge(),Ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class uM{constructor(e,t){this.targetId=e,this.Ce=t}}class dM{constructor(e,t,r=Jt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class wN{constructor(){this.ve=0,this.Fe=TN(),this.Me=Jt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ge(),t=Ge(),r=Ge();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:we(38017,{changeType:s})}})),new op(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=TN()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class K8{constructor(e){this.Ge=e,this.ze=new Map,this.je=vr(),this.Je=Rm(),this.He=Rm(),this.Ye=new At(Oe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:we(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(kg(s))if(r===0){const o=new me(s.path);this.et(t,o,Dt.newNoDocument(o,be.min()))}else Ce(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=ro(r).toUint8Array()}catch(u){if(u instanceof RD)return ys("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new PE(o,i,s)}catch(u){return ys(u instanceof Nh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const l=this.ot(o);if(l){if(s.current&&kg(l.target)){const u=new me(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Dt.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let r=Ge();this.He.forEach(((s,o)=>{let l=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new sp(e,t,this.Ye,this.je,r);return this.je=vr(),this.Je=Rm(),this.He=Rm(),this.Ye=new At(Oe),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new wN,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new vt(Oe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new vt(Oe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new At(me.comparator)}function TN(){return new At(me.comparator)}const J8={asc:"ASCENDING",desc:"DESCENDING"},Q8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Y8={and:"AND",or:"OR"};class X8{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function w0(n,e){return n.useProto3Json||Zf(e)?e:{value:e}}function Hu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hM(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Z8(n,e){return Hu(n,e.toTimestamp())}function nn(n){return Ce(!!n,49232),be.fromTimestamp((function(t){const r=no(t);return new pt(r.seconds,r.nanos)})(n))}function DE(n,e){return T0(n,e).canonicalString()}function T0(n,e){const t=(function(i){return new Xe(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function fM(n){const e=Xe.fromString(n);return Ce(IM(e),10190,{key:e.toString()}),e}function Af(n,e){return DE(n.databaseId,e.path)}function us(n,e){const t=fM(e);if(t.get(1)!==n.databaseId.projectId)throw new ie(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ie(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new me(gM(t))}function pM(n,e){return DE(n.databaseId,e)}function mM(n){const e=fM(n);return e.length===4?Xe.emptyPath():gM(e)}function E0(n){return new Xe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function gM(n){return Ce(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function EN(n,e,t){return{name:Af(n,e),fields:t.value.mapValue.fields}}function yM(n,e,t){const r=us(n,e.name),i=nn(e.updateTime),s=e.createTime?nn(e.createTime):be.min(),o=new Ln({mapValue:{fields:e.fields}}),l=Dt.newFoundDocument(r,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function eH(n,e){return"found"in e?(function(r,i){Ce(!!i.found,43571),i.found.name,i.found.updateTime;const s=us(r,i.found.name),o=nn(i.found.updateTime),l=i.found.createTime?nn(i.found.createTime):be.min(),u=new Ln({mapValue:{fields:i.found.fields}});return Dt.newFoundDocument(s,o,l,u)})(n,e):"missing"in e?(function(r,i){Ce(!!i.missing,3894),Ce(!!i.readTime,22933);const s=us(r,i.missing),o=nn(i.readTime);return Dt.newNoDocument(s,o)})(n,e):we(7234,{result:e})}function tH(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:we(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,p){return d.useProto3Json?(Ce(p===void 0||typeof p=="string",58123),Jt.fromBase64String(p||"")):(Ce(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Jt.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&(function(d){const p=d.code===void 0?X.UNKNOWN:lM(d.code);return new ie(p,d.message||"")})(o);t=new dM(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=us(n,r.document.name),s=nn(r.document.updateTime),o=r.document.createTime?nn(r.document.createTime):be.min(),l=new Ln({mapValue:{fields:r.document.fields}}),u=Dt.newFoundDocument(i,s,o,l),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Qm(d,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=us(n,r.document),s=r.readTime?nn(r.readTime):be.min(),o=Dt.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Qm([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=us(n,r.document),s=r.removedTargetIds||[];t=new Qm([],s,i,null)}else{if(!("filter"in e))return we(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new z8(i,s),l=r.targetId;t=new uM(l,o)}}return t}function Nf(n,e){let t;if(e instanceof ld)t={update:EN(n,e.key,e.value)};else if(e instanceof cd)t={delete:Af(n,e.key)};else if(e instanceof ho)t={update:EN(n,e.key,e.data),updateMask:aH(e.fieldMask)};else{if(!(e instanceof NE))return we(16599,{Vt:e.type});t={verify:Af(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const l=o.transform;if(l instanceof Bu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Gl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $l)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof qu)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw we(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Z8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:we(27497)})(n,e.precondition)),t}function I0(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Ut.updateTime(nn(s.updateTime)):s.exists!==void 0?Ut.exists(s.exists):Ut.none()})(e.currentDocument):Ut.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,l){let u=null;if("setToServerValue"in l)Ce(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Bu;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];u=new Gl(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];u=new $l(p)}else"increment"in l?u=new qu(o,l.increment):we(16584,{proto:l});const d=Ot.fromServerFormat(l.fieldPath);return new ip(d,u)})(n,i))):[];if(e.update){e.update.name;const i=us(n,e.update.name),s=new Ln({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new _r(d.map((p=>Ot.fromServerFormat(p))))})(e.updateMask);return new ho(i,s,o,t,r)}return new ld(i,s,t,r)}if(e.delete){const i=us(n,e.delete);return new cd(i,t)}if(e.verify){const i=us(n,e.verify);return new NE(i,t)}return we(1463,{proto:e})}function nH(n,e){return n&&n.length>0?(Ce(e!==void 0,14353),n.map((t=>(function(i,s){let o=i.updateTime?nn(i.updateTime):nn(s);return o.isEqual(be.min())&&(o=nn(s)),new G8(o,i.transformResults||[])})(t,e)))):[]}function _M(n,e){return{documents:[pM(n,e.path)]}}function vM(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=pM(n,i);const s=(function(d){if(d.length!==0)return EM(_t.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(d){if(d.length!==0)return d.map((p=>(function(w){return{field:su(w.field),direction:iH(w.dir)}})(p)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=w0(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function wM(n){let e=mM(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ce(r===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(v){const w=TM(v);return w instanceof _t&&xE(w)?w.getFilters():[w]})(t.where));let o=[];t.orderBy&&(o=(function(v){return v.map((w=>(function(A){return new Cf(ou(A.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(w)))})(t.orderBy));let l=null;t.limit&&(l=(function(v){let w;return w=typeof v=="object"?v.value:v,Zf(w)?null:w})(t.limit));let u=null;t.startAt&&(u=(function(v){const w=!!v.before,x=v.values||[];return new xa(x,w)})(t.startAt));let d=null;return t.endAt&&(d=(function(v){const w=!v.before,x=v.values||[];return new xa(x,w)})(t.endAt)),zD(e,i,o,s,l,"F",u,d)}function rH(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function TM(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ou(t.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ou(t.unaryFilter.field);return Ze.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ou(t.unaryFilter.field);return Ze.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ou(t.unaryFilter.field);return Ze.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return we(61313);default:return we(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ze.create(ou(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return we(58110);default:return we(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _t.create(t.compositeFilter.filters.map((r=>TM(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we(1026)}})(t.compositeFilter.op))})(n):we(30097,{filter:n})}function iH(n){return J8[n]}function sH(n){return Q8[n]}function oH(n){return Y8[n]}function su(n){return{fieldPath:n.canonicalString()}}function ou(n){return Ot.fromServerFormat(n.fieldPath)}function EM(n){return n instanceof Ze?(function(t){if(t.op==="=="){if(oN(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NAN"}};if(sN(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(oN(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NAN"}};if(sN(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:su(t.field),op:sH(t.op),value:t.value}}})(n):n instanceof _t?(function(t){const r=t.getFilters().map((i=>EM(i)));return r.length===1?r[0]:{compositeFilter:{op:oH(t.op),filters:r}}})(n):we(54877,{filter:n})}function aH(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function IM(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t,r,i,s=be.min(),o=be.min(),l=Jt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ws(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ws(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ws(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.yt=e}}function lH(n,e){let t;if(e.document)t=yM(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=me.fromSegments(e.noDocument.path),i=zl(e.noDocument.readTime);t=Dt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we(56709);{const r=me.fromSegments(e.unknownDocument.path),i=zl(e.unknownDocument.version);t=Dt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new pt(i[0],i[1]);return be.fromTimestamp(s)})(e.readTime)),t}function IN(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:Af(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Hu(s,o.version.toTimestamp()),createTime:Hu(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:jl(e.version)};else{if(!e.isUnknownDocument())return we(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:jl(e.version)}}return r}function Pg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function jl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function zl(n){const e=new pt(n.seconds,n.nanoseconds);return be.fromTimestamp(e)}function _l(n,e){const t=(e.baseMutations||[]).map((s=>I0(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>I0(n.yt,s))),i=pt.fromMillis(e.localWriteTimeMs);return new kE(e.batchId,i,t,r)}function kh(n){const e=zl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?zl(n.lastLimboFreeSnapshotVersion):be.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ce(o===1,1966,{count:o}),ir(ad(mM(s.documents[0])))})(n.query):(function(s){return ir(wM(s))})(n.query),new Ws(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Jt.fromBase64String(n.resumeToken))}function SM(n,e){const t=jl(e.snapshotVersion),r=jl(e.lastLimboFreeSnapshotVersion);let i;i=kg(e.target)?_M(n.yt,e.target):vM(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ME(n){const e=wM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bg(e,e.limit,"L"):e}function cw(n,e){return new bE(e.largestBatchId,I0(n.yt,e.overlayMutation))}function xN(n,e){const t=e.path.lastSegment();return[n,Qn(e.path.popLast()),t]}function SN(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:jl(r.readTime),documentKey:Qn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{getBundleMetadata(e,t){return CN(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:zl(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return CN(e).put((function(i){return{bundleId:i.id,createTime:jl(nn(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return AN(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:ME(s.bundledQuery),readTime:zl(s.readTime)}})(r)}))}saveNamedQuery(e,t){return AN(e).put((function(i){return{name:i.name,readTime:jl(nn(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function CN(n){return gn(n,Oy)}function AN(n){return gn(n,Uy)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new zy(e,r)}getOverlay(e,t){return fh(e).get(xN(this.userId,t)).next((r=>r?cw(this.serializer,r):null))}getOverlays(e,t){const r=ss();return $.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,o)=>{const l=new bE(t,o);i.push(this.St(e,l))})),$.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Qn(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(fh(e).Z(d0,l))})),$.waitFor(s)}getOverlaysForCollection(e,t,r){const i=ss(),s=Qn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return fh(e).J(d0,o).next((l=>{for(const u of l){const d=cw(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=ss();let o;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return fh(e).ee({index:xD,range:l},((u,d,p)=>{const v=cw(this.serializer,d);s.size()<i||v.largestBatchId===o?(s.set(v.getKey(),v),o=v.largestBatchId):p.done()})).next((()=>s))}St(e,t){return fh(e).put((function(i,s,o){const[l,u,d]=xN(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Nf(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function fh(n){return gn(n,By)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uH{bt(e){return gn(e,wE)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?Jt.fromUint8Array(r):Jt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Vt(e.integerValue));else if("doubleValue"in e){const r=Vt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),vf(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=no(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ro(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?VD(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Gy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):we(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){var o,l;const r=e.fields||{};this.Ft(t,53);const i=Fu,s=((l=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(Vt(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),me.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}vl.Kt=new vl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zc=255;function dH(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function NN(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=dH(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class hH{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=NN(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=NN(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Zc),this.sn(255)}_n(){this.an(Zc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Zc?(this.sn(Zc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Zc?(this.an(Zc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class fH{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class pH{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ph{constructor(){this.cn=new hH,this.ln=new fH(this.cn),this.hn=new pH(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new wl(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Ym(this.En),directionalValue:Ym(this.dn),orderedDocumentKey:Ym(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Wo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=kN(n.En,e.En),t!==0?t:(t=kN(n.dn,e.dn),t!==0?t:me.comparator(n.In,e.In)))}function kN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Ym(n){return Eb()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function RN(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class bN{constructor(e){this.mn=new vt(((t,r)=>Ot.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ce(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=l0(e);if(t!==void 0&&!this.wn(t))return!1;const r=ml(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const u=r[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<r.length;++s){const l=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new vt(Ot.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Gm(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Gm(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Gm(r.field,r.dir==="asc"?0:1)));return new Sg(Sg.UNKNOWN_ID,this.collectionId,t,_f.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(n){var t,r;if(Ce(n instanceof Ze||n instanceof _t,20012),n instanceof Ze){if(n instanceof jD){const i=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((s=>Ze.create(n.field,"==",s))))||[];return _t.create(i,"or")}return n}const e=n.filters.map((i=>CM(i)));return _t.create(e,n.op)}function mH(n){if(n.getFilters().length===0)return[];const e=C0(CM(n));return Ce(AM(e),7391),x0(e)||S0(e)?[e]:e.getFilters()}function x0(n){return n instanceof Ze}function S0(n){return n instanceof _t&&xE(n)}function AM(n){return x0(n)||S0(n)||(function(t){if(t instanceof _t&&g0(t)){for(const r of t.getFilters())if(!x0(r)&&!S0(r))return!1;return!0}return!1})(n)}function C0(n){if(Ce(n instanceof Ze||n instanceof _t,34018),n instanceof Ze)return n;if(n.filters.length===1)return C0(n.filters[0]);const e=n.filters.map((r=>C0(r)));let t=_t.create(e,n.op);return t=Dg(t),AM(t)?t:(Ce(t instanceof _t,64498),Ce(Uu(t),40251),Ce(t.filters.length>1,57927),t.filters.reduce(((r,i)=>LE(r,i))))}function LE(n,e){let t;return Ce(n instanceof Ze||n instanceof _t,38388),Ce(e instanceof Ze||e instanceof _t,25473),t=n instanceof Ze?e instanceof Ze?(function(i,s){return _t.create([i,s],"and")})(n,e):PN(n,e):e instanceof Ze?PN(e,n):(function(i,s){if(Ce(i.filters.length>0&&s.filters.length>0,48005),Uu(i)&&Uu(s))return HD(i,s.getFilters());const o=g0(i)?i:s,l=g0(i)?s:i,u=o.filters.map((d=>LE(d,l)));return _t.create(u,"or")})(n,e),Dg(t)}function PN(n,e){if(Uu(e))return HD(e,n.getFilters());{const t=e.filters.map((r=>LE(n,r)));return _t.create(t,"or")}}function Dg(n){if(Ce(n instanceof Ze||n instanceof _t,11850),n instanceof Ze)return n;const e=n.getFilters();if(e.length===1)return Dg(e[0]);if(BD(n))return n;const t=e.map((i=>Dg(i))),r=[];return t.forEach((i=>{i instanceof Ze?r.push(i):i instanceof _t&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:_t.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(){this.Cn=new VE}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(Gr.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(Gr.min())}updateCollectionGroup(e,t,r){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class VE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new vt(Xe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new vt(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN="IndexedDbIndexManager",bm=new Uint8Array(0);class yH{constructor(e,t){this.databaseId=t,this.vn=new VE,this.Fn=new uo((r=>Hl(r)),((r,i)=>tp(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Qn(i)};return MN(e).put(s)}return $.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[cD(t),""],!1,!0);return MN(e).J(i).next((s=>{for(const o of s){if(o.collectionId!==t)break;r.push(is(o.parent))}return r}))}addFieldIndex(e,t){const r=mh(e),i=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=tu(e);return s.next((l=>{o.put(SN(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=mh(e),i=tu(e),s=eu(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=mh(e),r=eu(e),i=tu(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return $.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new bN(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=eu(e);let i=!0;const s=new Map;return $.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{i&&(i=!!l),s.set(o,l)})))).next((()=>{if(i){let o=Ge();const l=[];return $.forEach(s,((u,d)=>{oe(DN,`Using index ${(function(q){return`id=${q.indexId}|cg=${q.collectionGroup}|f=${q.fields.map((K=>`${K.fieldPath}:${K.kind}`)).join(",")}`})(u)} to execute ${Hl(t)}`);const p=(function(q,K){const te=l0(K);if(te===void 0)return null;for(const ee of Rg(q,te.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null})(d,u),v=(function(q,K){const te=new Map;for(const ee of ml(K))for(const P of Rg(q,ee.fieldPath))switch(P.op){case"==":case"in":te.set(ee.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return te.set(ee.fieldPath.canonicalString(),P.value),Array.from(te.values())}return null})(d,u),w=(function(q,K){const te=[];let ee=!0;for(const P of ml(K)){const k=P.kind===0?dN(q,P.fieldPath,q.startAt):hN(q,P.fieldPath,q.startAt);te.push(k.value),ee&&(ee=k.inclusive)}return new xa(te,ee)})(d,u),x=(function(q,K){const te=[];let ee=!0;for(const P of ml(K)){const k=P.kind===0?hN(q,P.fieldPath,q.endAt):dN(q,P.fieldPath,q.endAt);te.push(k.value),ee&&(ee=k.inclusive)}return new xa(te,ee)})(d,u),A=this.On(u,d,w),R=this.On(u,d,x),L=this.Nn(u,d,v),j=this.Bn(u.indexId,p,A,w.inclusive,R,x.inclusive,L);return $.forEach(j,(B=>r.Y(B,t.limit).next((q=>{q.forEach((K=>{const te=me.fromSegments(K.documentKey);o.has(te)||(o=o.add(te),l.push(te))}))}))))})).next((()=>l))}return $.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=mH(_t.create(e.filters,"and")).map((r=>_0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,o,l){const u=(t!=null?t.length:1)*Math.max(r.length,s.length),d=u/(t!=null?t.length:1),p=[];for(let v=0;v<u;++v){const w=t?this.Ln(t[v/d]):bm,x=this.kn(e,w,r[v%d],i),A=this.qn(e,w,s[v%d],o),R=l.map((L=>this.kn(e,w,L,!0)));p.push(...this.createRange(x,A,R))}return p}kn(e,t,r,i){const s=new wl(e,me.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new wl(e,me.empty(),t,r);return i?s.An():s}xn(e,t){const r=new bN(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const l of s)r.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return $.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new vt(Ot.comparator),p=!1;for(const v of u.filters)for(const w of v.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?p=!0:d=d.add(w.field));for(const v of u.orderBy)v.field.isKeyField()||(d=d.add(v.field));return d.size+(p?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new ph;for(const i of ml(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);vl.Kt.Dt(s,o)}return r.un()}Ln(e){const t=new ph;return vl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new ph;return vl.Kt.Dt(ql(this.databaseId,t),r.Pn((function(s){const o=ml(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new ph);let s=0;for(const o of ml(e)){const l=r[s++];for(const u of i)if(this.Un(t,o.fieldPath)&&Sf(l))i=this.Kn(i,o,l);else{const d=u.Pn(o.kind);vl.Kt.Dt(l,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const l of i){const u=new ph;u.seed(l.un()),vl.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof Ze&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=mh(e),i=tu(e);return(t?r.J(u0,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const o=[];return $.forEach(s,(l=>i.get([l.indexId,this.uid]).next((u=>{o.push((function(p,v){const w=v?new _f(v.sequenceNumber,new Gr(zl(v.readTime),new me(is(v.documentKey)),v.largestBatchId)):_f.empty(),x=p.fields.map((([A,R])=>new Gm(Ot.fromServerFormat(A),R)));return new Sg(p.indexId,p.collectionGroup,x,w)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Oe(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=mh(e),s=tu(e);return this.Gn(e).next((o=>i.J(u0,IDBKeyRange.bound(t,t)).next((l=>$.forEach(l,(u=>s.put(SN(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return $.forEach(t,((i,s)=>{const o=r.get(i.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((l=>(r.set(i.collectionGroup,l),$.forEach(l,(u=>this.zn(e,i,u).next((d=>{const p=this.jn(s,u);return d.isEqual(p)?$.resolve():this.Jn(e,s,u,d,p)})))))))}))}Hn(e,t,r,i){return eu(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return eu(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=eu(e);let s=new vt(Wo);return i.ee({index:ID,range:IDBKeyRange.only([r.indexId,this.uid,Ym(this.$n(r,t))])},((o,l)=>{s=s.add(new wl(r.indexId,t,RN(l.arrayValue),RN(l.directionalValue)))})).next((()=>s))}jn(e,t){let r=new vt(Wo);const i=this.Qn(t,e);if(i==null)return r;const s=l0(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Sf(o))for(const l of o.arrayValue.values||[])r=r.add(new wl(t.indexId,e.key,this.Ln(l),i))}else r=r.add(new wl(t.indexId,e.key,bm,i));return r}Jn(e,t,r,i,s){oe(DN,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,p,v,w){const x=u.getIterator(),A=d.getIterator();let R=Xc(x),L=Xc(A);for(;R||L;){let j=!1,B=!1;if(R&&L){const q=p(R,L);q<0?B=!0:q>0&&(j=!0)}else R!=null?B=!0:j=!0;j?(v(L),L=Xc(A)):B?(w(R),R=Xc(x)):(R=Xc(x),L=Xc(A))}})(i,s,Wo,(l=>{o.push(this.Hn(e,t,r,l))}),(l=>{o.push(this.Yn(e,t,r,l))})),$.waitFor(o)}Gn(e){let t=1;return tu(e).ee({index:ED,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,l)=>Wo(o,l))).filter(((o,l,u)=>!l||Wo(o,u[l-1])!==0));const i=[];i.push(e);for(const o of r){const l=Wo(o,e),u=Wo(o,t);if(l===0)i[0]=e.An();else if(l>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const l=i[o].Vn(this.uid,bm,me.empty()),u=i[o+1].Vn(this.uid,bm,me.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Wo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(LN)}getMinOffset(e,t){return $.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||we(44426))))).next(LN)}}function MN(n){return gn(n,Ef)}function eu(n){return gn(n,$h)}function mh(n){return gn(n,vE)}function tu(n){return gn(n,Gh)}function LN(n){Ce(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;gE(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Gr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},NM=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(n,e,t){const r=n.store(Ei),i=n.store(Du),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=r.ee({range:o},((p,v,w)=>(l++,w.delete())));s.push(u.next((()=>{Ce(l===1,47070,{batchId:t.batchId})})));const d=[];for(const p of t.mutations){const v=vD(e,p.key.path,t.batchId);s.push(i.delete(v)),d.push(p.key)}return $.waitFor(s).next((()=>d))}function Mg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(NM,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class Wy{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ce(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Wy(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ko(e).ee({index:Sl,range:r},((i,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=au(e),o=Ko(e);return o.add({}).next((l=>{Ce(typeof l=="number",49019);const u=new kE(l,t,r,i),d=(function(x,A,R){const L=R.baseMutations.map((B=>Nf(x.yt,B))),j=R.mutations.map((B=>Nf(x.yt,B)));return{userId:A,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:L,mutations:j}})(this.serializer,this.userId,u),p=[];let v=new vt(((w,x)=>Oe(w.canonicalString(),x.canonicalString())));for(const w of i){const x=vD(this.userId,w.key.path,l);v=v.add(w.key.path.popLast()),p.push(o.put(d)),p.push(s.put(x,Y7))}return v.forEach((w=>{p.push(this.indexManager.addToCollectionParentIndex(e,w))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),$.waitFor(p).next((()=>u))}))}lookupMutationBatch(e,t){return Ko(e).get(t).next((r=>r?(Ce(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),_l(this.serializer,r)):null))}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ko(e).ee({index:Sl,range:i},((o,l,u)=>{l.userId===this.userId&&(Ce(l.batchId>=r,47524,{tr:r}),s=_l(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=da;return Ko(e).ee({index:Sl,range:t,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,da],[this.userId,Number.POSITIVE_INFINITY]);return Ko(e).J(Sl,t).next((r=>r.map((i=>_l(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=$m(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return au(e).ee({range:i},((o,l,u)=>{const[d,p,v]=o,w=is(p);if(d===this.userId&&t.path.isEqual(w))return Ko(e).get(v).next((x=>{if(!x)throw we(61480,{nr:o,batchId:v});Ce(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:v}),s.push(_l(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt(Oe);const i=[];return t.forEach((s=>{const o=$m(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=au(e).ee({range:l},((d,p,v)=>{const[w,x,A]=d,R=is(x);w===this.userId&&s.path.isEqual(R)?r=r.add(A):v.done()}));i.push(u)})),$.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=$m(this.userId,r),o=IDBKeyRange.lowerBound(s);let l=new vt(Oe);return au(e).ee({range:o},((u,d,p)=>{const[v,w,x]=u,A=is(w);v===this.userId&&r.isPrefixOf(A)?A.length===i&&(l=l.add(x)):p.done()})).next((()=>this.rr(e,l)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Ko(e).get(s).next((o=>{if(o===null)throw we(35274,{batchId:s});Ce(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(_l(this.serializer,o))})))})),$.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return kM(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),$.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return $.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return au(e).ee({range:r},((s,o,l)=>{if(s[0]===this.userId){const u=is(s[1]);i.push(u)}else l.done()})).next((()=>{Ce(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return RM(e,this.userId,t)}_r(e){return bM(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:da,lastStreamToken:""}))}}function RM(n,e,t){const r=$m(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return au(n).ee({range:s,X:!0},((l,u,d)=>{const[p,v,w]=l;p===e&&v===i&&(o=!0),d.done()})).next((()=>o))}function Ko(n){return gn(n,Ei)}function au(n){return gn(n,Du)}function bM(n){return gn(n,wf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Wl(0)}static cr(){return new Wl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _H{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Wl(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>be.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>nu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ce(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return nu(e).ee(((o,l)=>{const u=kh(l);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))})).next((()=>$.waitFor(s))).next((()=>i))}forEachTarget(e,t){return nu(e).ee(((r,i)=>{const s=kh(i);t(s)}))}lr(e){return FN(e).get(Ng).next((t=>(Ce(t!==null,2888),t)))}hr(e,t){return FN(e).put(Ng,t)}Pr(e,t){return nu(e).put(SM(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Hl(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return nu(e).ee({range:i,index:TD},((o,l,u)=>{const d=kh(l);tp(t,d.target)&&(s=d,u.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=Xo(e);return t.forEach((o=>{const l=Qn(o.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,o))})),$.waitFor(i)}removeMatchingKeys(e,t,r){const i=Xo(e);return $.forEach(t,(s=>{const o=Qn(s.path);return $.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=Xo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Xo(e);let s=Ge();return i.ee({range:r,X:!0},((o,l,u)=>{const d=is(o[1]),p=new me(d);s=s.add(p)})).next((()=>s))}containsKey(e,t){const r=Qn(t.path),i=IDBKeyRange.bound([r],[cD(r)],!1,!0);let s=0;return Xo(e).ee({index:_E,X:!0,range:i},(([o,l],u,d)=>{o!==0&&(s++,d.done())})).next((()=>s>0))}At(e,t){return nu(e).get(t).next((r=>r?kh(r):null))}}function nu(n){return gn(n,Mu)}function FN(n){return gn(n,Pl)}function Xo(n){return gn(n,Lu)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON="LruGarbageCollector",vH=1048576;function UN([n,e],[t,r]){const i=Oe(n,t);return i===0?Oe(e,r):i}class wH{constructor(e){this.Ir=e,this.buffer=new vt(UN),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();UN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class PM{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){oe(ON,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Da(t)?oe(ON,"Ignoring IndexedDB error during garbage collection: ",t):await Pa(t)}await this.Vr(3e5)}))}}class TH{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return $.resolve(yr.ce);const r=new wH(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(oe("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(VN)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VN):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,l,u,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,o=Date.now(),this.nthSequenceNumber(e,i)))).next((v=>(r=v,l=Date.now(),this.removeTargets(e,r,t)))).next((v=>(s=v,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(d=Date.now(),ru()<=Je.DEBUG&&oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${v} documents in `+(d-u)+`ms
Total Duration: ${d-p}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:v}))))}}function DM(n,e){return new TH(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EH{constructor(e,t){this.db=e,this.garbageCollector=DM(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Pm(e,r)}removeReference(e,t,r){return Pm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Pm(e,t)}br(e,t){return(function(i,s){let o=!1;return bM(i).te((l=>RM(i,l,s).next((u=>(u&&(o=!0),$.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((d=>{if(!d)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,be.min()),Xo(e).delete((function(v){return[0,Qn(v.path)]})(o)))))}));i.push(u)}})).next((()=>$.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Pm(e,t)}Sr(e,t){const r=Xo(e);let i,s=yr.ce;return r.ee({index:_E},(([o,l],{path:u,sequenceNumber:d})=>{o===0?(s!==yr.ce&&t(new me(is(i)),s),s=d,i=u):s=yr.ce})).next((()=>{s!==yr.ce&&t(new me(is(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Pm(n,e){return Xo(n).put((function(r,i){return{targetId:0,path:Qn(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.changes=new uo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?$.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return hl(e).put(r)}removeEntry(e,t,r){return hl(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Pg(o),l[l.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Dt.newInvalidDocument(t);return hl(e).ee({index:jm,range:IDBKeyRange.only(gh(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Dt.newInvalidDocument(t)};return hl(e).ee({index:jm,range:IDBKeyRange.only(gh(t))},((i,s)=>{r={document:this.Cr(t,s),size:Mg(s)}})).next((()=>r))}getEntries(e,t){let r=vr();return this.Fr(e,t,((i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=vr(),i=new At(me.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);r=r.insert(s,l),i=i.insert(s,Mg(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return $.resolve();let i=new vt(HN);t.forEach((u=>i=i.add(u)));const s=IDBKeyRange.bound(gh(i.first()),gh(i.last())),o=i.getIterator();let l=o.getNext();return hl(e).ee({index:jm,range:s},((u,d,p)=>{const v=me.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&HN(l,v)<0;)r(l,null),l=o.getNext();l&&l.isEqual(v)&&(r(l,d),l=o.hasNext()?o.getNext():null),l?p.j(gh(l)):p.done()})).next((()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Pg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return hl(e).J(IDBKeyRange.bound(l,u,!0)).next((d=>{s==null||s.incrementDocumentReadCount(d.length);let p=vr();for(const v of d){const w=this.Cr(me.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);w.isFoundDocument()&&(rp(t,w)||i.has(w.key))&&(p=p.insert(w.key,w))}return p}))}getAllFromCollectionGroup(e,t,r,i){let s=vr();const o=qN(t,r),l=qN(t,Gr.max());return hl(e).ee({index:wD,range:IDBKeyRange.bound(o,l,!0)},((u,d,p)=>{const v=this.Cr(me.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(v.key,v),s.size===i&&p.done()})).next((()=>s))}newChangeBuffer(e){return new xH(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return BN(e).get(c0).next((t=>(Ce(!!t,20021),t)))}Dr(e,t){return BN(e).put(c0,t)}Cr(e,t){if(t){const r=lH(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(be.min())))return r}return Dt.newInvalidDocument(e)}}function LM(n){return new IH(n)}class xH extends MM{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new uo((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new vt(((s,o)=>Oe(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=IN(this.Nr.serializer,o);i=i.add(s.path.popLast());const d=Mg(u);r+=d-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(r-=l.size,this.trackRemovals){const u=IN(this.Nr.serializer,o.convertToNoDocument(be.min()));t.push(this.Nr.addEntry(e,s,u))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function BN(n){return gn(n,Tf)}function hl(n){return gn(n,Ag)}function gh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function qN(n,e){const t=e.documentKey.path.toArray();return[n,Pg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function HN(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Oe(t[s],r[s]),i)return i;return i=Oe(t.length,r.length),i||(i=Oe(t[t.length-2],r[r.length-2]),i||Oe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Wh(r.mutation,i,_r.empty(),pt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ge()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ge()){const i=ss();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let o=Ah();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=ss();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ge())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,r,i){let s=vr();const o=zh(),l=(function(){return zh()})();return t.forEach(((u,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof ho)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),Wh(p.mutation,d,p.mutation.getFieldMask(),pt.now())):o.set(d.key,_r.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((d,p)=>o.set(d,p))),t.forEach(((d,p)=>l.set(d,new SH(p,o.get(d)??null)))),l)))}recalculateAndSaveOverlays(e,t){const r=zh();let i=new At(((o,l)=>o-l)),s=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let p=r.get(u)||_r.empty();p=l.applyToLocalView(d,p),r.set(u,p);const v=(i.get(l.batchId)||Ge()).add(u);i=i.insert(l.batchId,v)}))})).next((()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,p=u.value,v=XD();p.forEach((w=>{if(!s.has(w)){const x=sM(t.get(w),r.get(w));x!==null&&v.set(w,x),s=s.add(w)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,v))}return $.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):SE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):$.resolve(ss());let l=Pu,u=s;return o.next((d=>$.forEach(d,((p,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),s.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next((w=>{u=u.insert(p,w)}))))).next((()=>this.populateOverlays(e,d,s))).next((()=>this.computeViews(e,u,d,Ge()))).next((p=>({batchId:l,changes:YD(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new me(t)).next((r=>{let i=Ah();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ah();return this.indexManager.getCollectionParents(e,s).next((l=>$.forEach(l,(u=>{const d=(function(v,w){return new co(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((p=>{p.forEach(((v,w)=>{o=o.insert(v,w)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((o=>{s.forEach(((u,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,Dt.newInvalidDocument(p)))}));let l=Ah();return o.forEach(((u,d)=>{const p=s.get(u);p!==void 0&&Wh(p.mutation,d,_r.empty(),pt.now()),rp(t,d)&&(l=l.insert(u,d))})),l}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:nn(i.createTime)}})(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:ME(i.bundledQuery),readTime:nn(i.readTime)}})(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AH{constructor(){this.overlays=new At(me.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ss();return $.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),$.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,t,r){const i=ss(),s=t.length+1,o=new me(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return $.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new At(((d,p)=>d-p));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=ss(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const l=ss(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,p)=>l.set(d,p))),!(l.size()>=i)););return $.resolve(l)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bE(t,r));let s=this.qr.get(t);s===void 0&&(s=Ge(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NH{constructor(){this.sessionToken=Jt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(){this.Qr=new vt(In.$r),this.Ur=new vt(In.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new In(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new In(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new me(new Xe([])),r=new In(t,e),i=new In(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new me(new Xe([])),r=new In(t,e),i=new In(t,e+1);let s=Ge();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new In(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class In{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return me.comparator(e.key,t.key)||Oe(e.Yr,t.Yr)}static Kr(e,t){return Oe(e.Yr,t.Yr)||me.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new vt(In.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new kE(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.Zr=this.Zr.add(new In(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return $.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?da:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new In(t,0),i=new In(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{const l=this.Xr(o.Yr);s.push(l)})),$.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt(Oe);return t.forEach((i=>{const s=new In(i,0),o=new In(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{r=r.add(l.Yr)}))})),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;me.isDocumentKey(s)||(s=s.child(""));const o=new In(new me(s),0);let l=new vt(Oe);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(u.Yr)),!0)}),o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ce(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(t.mutations,(i=>{const s=new In(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new In(t,0),i=this.Zr.firstAfterOrEqual(r);return $.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(e){this.ri=e,this.docs=(function(){return new At(me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return $.resolve(r?r.document.mutableCopy():Dt.newInvalidDocument(t))}getEntries(e,t){let r=vr();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Dt.newInvalidDocument(i))})),$.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=vr();const o=t.path,l=new me(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:p}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||gE(pD(p),r)<=0||(i.has(p.key)||rp(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return $.resolve(s)}getAllFromCollectionGroup(e,t,r,i){we(9500)}ii(e,t){return $.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new bH(this)}getSize(e){return $.resolve(this.size)}}class bH extends MM{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(e){this.persistence=e,this.si=new uo((t=>Hl(t)),tp),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.oi=0,this._i=new FE,this.targetCount=0,this.ai=Wl.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Wl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)})),$.waitFor(s).next((()=>i))}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return $.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),$.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),$.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return $.resolve(r)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t){this.ui={},this.overlays={},this.ci=new yr(0),this.li=!1,this.li=!0,this.hi=new NH,this.referenceDelegate=e(this),this.Pi=new PH(this),this.indexManager=new gH,this.remoteDocumentCache=(function(i){return new RH(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new xM(t),this.Ii=new CH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new kH(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){oe("MemoryPersistence","Starting transaction:",e);const i=new DH(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return $.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class DH extends gD{constructor(e){super(),this.currentSequenceNumber=e}}class Ky{constructor(e){this.persistence=e,this.Ri=new FE,this.Vi=null}static mi(e){return new Ky(e)}get fi(){if(this.Vi)return this.Vi;throw we(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),$.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,(r=>{const i=me.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,be.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Lg{constructor(e,t){this.persistence=e,this.pi=new uo((r=>Qn(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=DM(this,t)}static mi(e,t){return new Lg(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return $.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?$.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((l=>{l||(r++,s.removeEntry(o,be.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wm(e.data.value)),t}br(e,t,r){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(e){this.serializer=e}k(e,t,r,i){const s=new Fy("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(ep)})(e),(function(u){u.createObjectStore(wf,{keyPath:Q7}),u.createObjectStore(Ei,{keyPath:ZA,autoIncrement:!0}).createIndex(Sl,eN,{unique:!0}),u.createObjectStore(Du)})(e),GN(e),(function(u){u.createObjectStore(gl)})(e));let o=$.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(Lu),u.deleteObjectStore(Mu),u.deleteObjectStore(Pl)})(e),GN(e)),o=o.next((()=>(function(u){const d=u.store(Pl),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return d.put(Ng,p)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(Ei).J().next((v=>{u.deleteObjectStore(Ei),u.createObjectStore(Ei,{keyPath:ZA,autoIncrement:!0}).createIndex(Sl,eN,{unique:!0});const w=d.store(Ei),x=v.map((A=>w.put(A)));return $.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Vu,{keyPath:s8})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Tf)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Oy,{keyPath:o8})})(e),(function(u){u.createObjectStore(Uy,{keyPath:a8})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(By,{keyPath:p8});d.createIndex(d0,m8,{unique:!1}),d.createIndex(xD,g8,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(Ag,{keyPath:X7});d.createIndex(jm,Z7),d.createIndex(wD,e8)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(gl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(vE,{keyPath:l8,autoIncrement:!0}).createIndex(u0,c8,{unique:!1}),u.createObjectStore(Gh,{keyPath:u8}).createIndex(ED,d8,{unique:!1}),u.createObjectStore($h,{keyPath:h8}).createIndex(ID,f8,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(Gh).clear()})).next((()=>{t.objectStore($h).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(wE,{keyPath:y8})})(e)}))),r<18&&i>=18&&Eb()&&(o=o.next((()=>{t.objectStore(Gh).clear()})).next((()=>{t.objectStore($h).clear()}))),o}wi(e){let t=0;return e.store(gl).ee(((r,i)=>{t+=Mg(i)})).next((()=>{const r={byteSize:t};return e.store(Tf).put(c0,r)}))}yi(e){const t=e.store(wf),r=e.store(Ei);return t.J().next((i=>$.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,da],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Sl,o).next((l=>$.forEach(l,(u=>{Ce(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=_l(this.serializer,u);return kM(e,s.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(Lu),r=e.store(gl);return e.store(Pl).get(Ng).next((i=>{const s=[];return r.ee(((o,l)=>{const u=new Xe(o),d=(function(v){return[0,Qn(v)]})(u);s.push(t.get(d).next((p=>p?$.resolve():(v=>t.put({targetId:0,path:Qn(v),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>$.waitFor(s)))}))}bi(e,t){e.createObjectStore(Ef,{keyPath:i8});const r=t.store(Ef),i=new VE,s=o=>{if(i.add(o)){const l=o.lastSegment(),u=o.popLast();return r.put({collectionId:l,parent:Qn(u)})}};return t.store(gl).ee({X:!0},((o,l)=>{const u=new Xe(o);return s(u.popLast())})).next((()=>t.store(Du).ee({X:!0},(([o,l,u],d)=>{const p=is(l);return s(p.popLast())}))))}Di(e){const t=e.store(Mu);return t.ee(((r,i)=>{const s=kh(i),o=SM(this.serializer,s);return t.put(o)}))}Ci(e,t){const r=t.store(gl),i=[];return r.ee(((s,o)=>{const l=t.store(Ag),u=(function(v){return v.document?new me(Xe.fromString(v.document.name).popFirst(5)):v.noDocument?me.fromSegments(v.noDocument.path):v.unknownDocument?me.fromSegments(v.unknownDocument.path):we(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(d))})).next((()=>$.waitFor(i)))}Fi(e,t){const r=t.store(Ei),i=LM(this.serializer),s=new OE(Ky.mi,this.serializer.yt);return r.J().next((o=>{const l=new Map;return o.forEach((u=>{let d=l.get(u.userId)??Ge();_l(this.serializer,u).keys().forEach((p=>d=d.add(p))),l.set(u.userId,d)})),$.forEach(l,((u,d)=>{const p=new Sn(d),v=zy.wt(this.serializer,p),w=s.getIndexManager(p),x=Wy.wt(p,this.serializer,w,s.referenceDelegate);return new VM(i,x,v,w).recalculateAndSaveOverlaysForDocumentKeys(new h0(t,yr.ce),u).next()}))}))}}function GN(n){n.createObjectStore(Lu,{keyPath:n8}).createIndex(_E,r8,{unique:!0}),n.createObjectStore(Mu,{keyPath:"targetId"}).createIndex(TD,t8,{unique:!0}),n.createObjectStore(Pl)}const Jo="IndexedDbPersistence",uw=18e5,dw=5e3,hw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",FM="main";class UE{constructor(e,t,r,i,s,o,l,u,d,p,v=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=o,this.document=l,this.xi=d,this.Oi=p,this.Ni=v,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=w=>Promise.resolve(),!UE.v())throw new ie(X.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new EH(this,i),this.$i=t+FM,this.serializer=new xM(u),this.Ui=new cs(this.$i,this.Ni,new MH(this.serializer)),this.hi=new uH,this.Pi=new _H(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LM(this.serializer),this.Ii=new cH,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,p===!1&&en(Jo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(X.FAILED_PRECONDITION,hw);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new yr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Dm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Da(e))return oe(Jo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return oe(Jo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return yh(e).get(Yc).next((t=>$.resolve(this.es(t))))}ts(e){return Dm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,uw)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=gn(t,Vu);return r.J().next((i=>{const s=this.ss(i,uw),o=i.filter((l=>s.indexOf(l)===-1));return $.forEach(o,(l=>r.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):yh(e).get(Yc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,dw)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ie(X.FAILED_PRECONDITION,hw);return!1}}return!(!this.networkEnabled||!this.inForeground)||Dm(e).J().next((r=>this.ss(r,dw).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&oe(Jo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[ep,Vu],(e=>{const t=new h0(e,yr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Dm(e).J().next((t=>this.ss(t,uw).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Wy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yH(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return zy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){oe(Jo,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?w8:u===17?ND:u===16?v8:u===15?TE:u===14?AD:u===13?CD:u===12?_8:u===11?SD:void we(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,s,(l=>(o=new h0(l,this.ci?this.ci.next():yr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw en(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ie(X.FAILED_PRECONDITION,mD);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return yh(e).get(Yc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,dw)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ie(X.FAILED_PRECONDITION,hw)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return yh(e).put(Yc,t)}static v(){return cs.v()}Zi(e){const t=yh(e);return t.get(Yc).next((r=>this.es(r)?(oe(Jo,"Releasing primary lease."),t.delete(Yc)):$.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(en(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;Tb()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const r=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return oe(Jo,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return en(Jo,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){en("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function yh(n){return gn(n,ep)}function Dm(n){return gn(n,Vu)}function BE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Ge(),i=Ge();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new qE(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Tb()?8:yD(zt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new LH;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(ru()<=Je.DEBUG&&oe("QueryEngine","SDK will not create cache indexes for query:",iu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(ru()<=Je.DEBUG&&oe("QueryEngine","Query:",iu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ru()<=Je.DEBUG&&oe("QueryEngine","The SDK decides to create cache indexes for query:",iu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(t))):$.resolve())}ys(e,t){if(fN(t))return $.resolve(null);let r=ir(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=bg(t,null,"F"),r=ir(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=Ge(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,l);return this.Cs(t,d,o,u.readTime)?this.ys(e,bg(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return fN(t)||i.isEqual(be.min())?$.resolve(null):this.ps.getDocuments(e,r).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,r,i)?$.resolve(null):(ru()<=Je.DEBUG&&oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),iu(t)),this.vs(e,o,t,fD(i,Pu)).next((l=>l)))}))}Ds(e,t){let r=new vt(JD(e));return t.forEach(((i,s)=>{rp(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return ru()<=Je.DEBUG&&oe("QueryEngine","Using full collection scan to execute query:",iu(t)),this.ps.getDocumentsMatchingQuery(e,t,Gr.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="LocalStore",VH=3e8;class FH{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new At(Oe),this.xs=new uo((s=>Hl(s)),tp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function UM(n,e,t,r){return new FH(n,e,t,r)}async function BM(n,e){const t=ge(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],l=[];let u=Ge();for(const d of i){o.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}for(const d of s){l.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:l})))}))}))}function OH(n,e){const t=ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,d,p){const v=d.batch,w=v.keys();let x=$.resolve();return w.forEach((A=>{x=x.next((()=>p.getEntry(u,A))).next((R=>{const L=d.docVersions.get(A);Ce(L!==null,48541),R.version.compareTo(L)<0&&(v.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),p.addEntry(R)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,v)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let u=Ge();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function qM(n){const e=ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function UH(n,e){const t=ge(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const l=[];e.targetChanges.forEach(((p,v)=>{const w=i.get(v);if(!w)return;l.push(t.Pi.removeMatchingKeys(s,p.removedDocuments,v).next((()=>t.Pi.addMatchingKeys(s,p.addedDocuments,v))));let x=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?x=x.withResumeToken(Jt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):p.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(p.resumeToken,r)),i=i.insert(v,x),(function(R,L,j){return R.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=VH?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0})(w,x,p)&&l.push(t.Pi.updateTargetData(s,x))}));let u=vr(),d=Ge();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))})),l.push(HM(s,o,e.documentUpdates).next((p=>{u=p.ks,d=p.qs}))),!r.isEqual(be.min())){const p=t.Pi.getLastRemoteSnapshotVersion(s).next((v=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));l.push(p)}return $.waitFor(l).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,d))).next((()=>u))})).then((s=>(t.Ms=i,s)))}function HM(n,e,t){let r=Ge(),i=Ge();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let o=vr();return t.forEach(((l,u)=>{const d=s.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(be.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):oe(HE,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function BH(n,e){const t=ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=da),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Gu(n,e){const t=ge(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,$.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Ws(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function $u(n,e,t){const r=ge(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Da(o))throw o;oe(HE,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Vg(n,e,t){const r=ge(n);let i=be.min(),s=Ge();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,p){const v=ge(u),w=v.xs.get(p);return w!==void 0?$.resolve(v.Ms.get(w)):v.Pi.getTargetData(d,p)})(r,o,ir(e)).next((l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next((u=>{s=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:be.min(),t?s:Ge()))).next((l=>(jM(r,KD(e),l),{documents:l,Qs:s})))))}function GM(n,e){const t=ge(n),r=ge(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(s=>r.At(s,e).next((o=>o?o.target:null))))}function $M(n,e){const t=ge(n),r=t.Os.get(e)||be.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,fD(r,Pu),Number.MAX_SAFE_INTEGER))).then((i=>(jM(t,e,i),i)))}function jM(n,e,t){let r=n.Os.get(e)||be.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}async function qH(n,e,t,r){const i=ge(n);let s=Ge(),o=vr();for(const d of t){const p=e.$s(d.metadata.name);d.document&&(s=s.add(p));const v=e.Us(d);v.setReadTime(e.Ks(d.metadata.readTime)),o=o.insert(p,v)}const l=i.Ns.newChangeBuffer({trackRemovals:!0}),u=await Gu(i,(function(p){return ir(ad(Xe.fromString(`__bundle__/docs/${p}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(d=>HM(d,l,o).next((p=>(l.apply(d),p))).next((p=>i.Pi.removeMatchingKeysForTargetId(d,u.targetId).next((()=>i.Pi.addMatchingKeys(d,s,u.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(d,p.ks,p.qs))).next((()=>p.ks))))))}async function HH(n,e,t=Ge()){const r=await Gu(n,ir(ME(e.bundledQuery))),i=ge(n);return i.persistence.runTransaction("Save named query","readwrite",(s=>{const o=nn(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ii.saveNamedQuery(s,e);const l=r.withResumeToken(Jt.EMPTY_BYTE_STRING,o);return i.Ms=i.Ms.insert(l.targetId,l),i.Pi.updateTargetData(s,l).next((()=>i.Pi.removeMatchingKeysForTargetId(s,r.targetId))).next((()=>i.Pi.addMatchingKeys(s,t,r.targetId))).next((()=>i.Ii.saveNamedQuery(s,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM="firestore_clients";function $N(n,e){return`${zM}_${n}_${e}`}const WM="firestore_mutations";function jN(n,e,t){let r=`${WM}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const KM="firestore_targets";function fw(n,e){return`${KM}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="SharedClientState";class Fg{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ws(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ie(i.error.code,i.error.message))),o?new Fg(e,t,i.state,s):(en(Yi,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kh{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new ie(r.error.code,r.error.message))),s?new Kh(e,r.state,i):(en(Yi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Og{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=CE();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=_D(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Og(e,s):(en(Yi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class GE{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new GE(t.clientId,t.onlineState):(en(Yi,`Failed to parse online state: ${e}`),null)}}class A0{constructor(){this.activeTargetIds=CE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pw{constructor(e,t,r,i,s){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new At(Oe),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.eo=$N(this.persistenceKey,this.Js),this.no=(function(u){return`firestore_sequence_number_${u}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new A0),this.ro=new RegExp(`^${zM}_${o}_([^_]*)$`),this.io=new RegExp(`^${WM}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${KM}_${o}_(\\d+)$`),this.oo=(function(u){return`firestore_online_state_${u}`})(this.persistenceKey),this._o=(function(u){return`firestore_bundle_loaded_v2_${u}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem($N(this.persistenceKey,r));if(i){const s=Og.Ws(r,i);s&&(this.Zs=this.Zs.insert(s.clientId,s))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(fw(this.persistenceKey,e));if(i){const s=Kh.Ws(e,i);s&&(r=s.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fw(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.Po(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return oe(Yi,"READ",e,t),t}setItem(e,t){oe(Yi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){oe(Yi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(oe(Yi,"EVENT",t.key,t.newValue),t.key===this.eo)return void en("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(s){let o=yr.ce;if(s!=null)try{const l=JSON.parse(s);Ce(typeof l=="number",30636,{So:s}),o=l}catch(l){en(Yi,"Failed to read sequence number from WebStorage",l)}return o})(t.newValue);r!==yr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const i=new Fg(this.currentUser,e,t,r),s=jN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Gs())}Po(e){const t=jN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const i=fw(this.persistenceKey,e),s=new Kh(e,t,r);this.setItem(i,s.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return Og.Ws(r,t)}fo(e,t){const r=this.io.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Fg.Ws(new Sn(s),i,t)}yo(e,t){const r=this.so.exec(e),i=Number(r[1]);return Kh.Ws(i,t)}uo(e){return GE.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);oe(Yi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),s=this.lo(r),o=[],l=[];return s.forEach((u=>{i.has(u)||o.push(u)})),i.forEach((u=>{s.has(u)||l.push(u)})),this.syncEngine.Fo(o,l).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=CE();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class JM{constructor(){this.Mo=new A0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new A0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="ConnectivityMonitor";class WN{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){oe(zN,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){oe(zN,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mm=null;function N0(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="RestConnection",$H={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===f0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const o=N0(),l=this.zo(e,t.toUriEncodedString());oe(mw,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);const{host:d}=new URL(l),p=ka(d);return this.Jo(e,l,u,r,p).then((v=>(oe(mw,`Received RPC '${e}' ${o}: `,v),v)),(v=>{throw ys(mw,`RPC '${e}' ${o} failed with error: `,v,"url: ",l,"request:",r),v}))}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+od})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=$H[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zH{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class WH extends jH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const o=N0();return new Promise(((l,u)=>{const d=new nD;d.setWithCredentials(!0),d.listenOnce(rD.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Hm.NO_ERROR:const v=d.getResponseJson();oe($n,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(v)),l(v);break;case Hm.TIMEOUT:oe($n,`RPC '${e}' ${o} timed out`),u(new ie(X.DEADLINE_EXCEEDED,"Request time out"));break;case Hm.HTTP_ERROR:const w=d.getStatus();if(oe($n,`RPC '${e}' ${o} failed with status:`,w,"response text:",d.getResponseText()),w>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const A=x==null?void 0:x.error;if(A&&A.status&&A.message){const R=(function(j){const B=j.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(B)>=0?B:X.UNKNOWN})(A.status);u(new ie(R,A.message))}else u(new ie(X.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new ie(X.UNAVAILABLE,"Connection failed."));break;default:we(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{oe($n,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(i);oe($n,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",p,r,15)}))}T_(e,t,r){const i=N0(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=oD(),l=sD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const p=s.join("");oe($n,`Creating RPC '${e}' stream ${i}: ${p}`,u);const v=o.createWebChannel(p,u);this.I_(v);let w=!1,x=!1;const A=new zH({Yo:L=>{x?oe($n,`Not sending because RPC '${e}' stream ${i} is closed:`,L):(w||(oe($n,`Opening RPC '${e}' stream ${i} transport.`),v.open(),w=!0),oe($n,`RPC '${e}' stream ${i} sending:`,L),v.send(L))},Zo:()=>v.close()}),R=(L,j,B)=>{L.listen(j,(q=>{try{B(q)}catch(K){setTimeout((()=>{throw K}),0)}}))};return R(v,Ch.EventType.OPEN,(()=>{x||(oe($n,`RPC '${e}' stream ${i} transport opened.`),A.o_())})),R(v,Ch.EventType.CLOSE,(()=>{x||(x=!0,oe($n,`RPC '${e}' stream ${i} transport closed`),A.a_(),this.E_(v))})),R(v,Ch.EventType.ERROR,(L=>{x||(x=!0,ys($n,`RPC '${e}' stream ${i} transport errored. Name:`,L.name,"Message:",L.message),A.a_(new ie(X.UNAVAILABLE,"The operation could not be completed")))})),R(v,Ch.EventType.MESSAGE,(L=>{var j;if(!x){const B=L.data[0];Ce(!!B,16349);const q=B,K=(q==null?void 0:q.error)||((j=q[0])==null?void 0:j.error);if(K){oe($n,`RPC '${e}' stream ${i} received error:`,K);const te=K.status;let ee=(function(b){const F=an[b];if(F!==void 0)return lM(F)})(te),P=K.message;ee===void 0&&(ee=X.INTERNAL,P="Unknown error status: "+te+" with message "+K.message),x=!0,A.a_(new ie(ee,P)),v.close()}else oe($n,`RPC '${e}' stream ${i} received:`,B),A.u_(B)}})),R(l,iD.STAT_EVENT,(L=>{L.stat===o0.PROXY?oe($n,`RPC '${e}' stream ${i} detected buffering proxy`):L.stat===o0.NOPROXY&&oe($n,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(){return typeof window<"u"?window:null}function Xm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(n){return new X8(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN="PersistentStream";class YM{constructor(e,t,r,i,s,o,l,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $E(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===X.RESOURCE_EXHAUSTED?(en(t.toString()),en("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ie(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return oe(KN,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(oe(KN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class KH extends YM{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=tH(this.serializer,e),r=(function(s){if(!("targetChange"in s))return be.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?be.min():o.readTime?nn(o.readTime):be.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=E0(this.serializer),t.addTarget=(function(s,o){let l;const u=o.target;if(l=kg(u)?{documents:_M(s,u)}:{query:vM(s,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=hM(s,o.resumeToken);const d=w0(s,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(be.min())>0){l.readTime=Hu(s,o.snapshotVersion.toTimestamp());const d=w0(s,o.expectedCount);d!==null&&(l.expectedCount=d)}return l})(this.serializer,e);const r=rH(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=E0(this.serializer),t.removeTarget=e,this.q_(t)}}class JH extends YM{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=nH(e.writeResults,e.commitTime),r=nn(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=E0(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Nf(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QH{}class YH extends QH{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ie(X.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,T0(t,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ie(X.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,T0(t,r),i,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(X.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class XH{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(en(t),this.aa=!1):oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl="RemoteStore";class ZH{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{La(this)&&(oe(Kl,"Restarting streams for network reachability change."),await(async function(u){const d=ge(u);d.Ea.add(4),await ud(d),d.Ra.set("Unknown"),d.Ea.delete(4),await lp(d)})(this))}))})),this.Ra=new XH(r,i)}}async function lp(n){if(La(n))for(const e of n.da)await e(!0)}async function ud(n){for(const e of n.da)await e(!1)}function Jy(n,e){const t=ge(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),WE(t)?zE(t):hd(t).O_()&&jE(t,e))}function ju(n,e){const t=ge(n),r=hd(t);t.Ia.delete(e),r.O_()&&XM(t,e),t.Ia.size===0&&(r.O_()?r.L_():La(t)&&t.Ra.set("Unknown"))}function jE(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hd(n).Y_(e)}function XM(n,e){n.Va.Ue(e),hd(n).Z_(e)}function zE(n){n.Va=new K8({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),hd(n).start(),n.Ra.ua()}function WE(n){return La(n)&&!hd(n).x_()&&n.Ia.size>0}function La(n){return ge(n).Ea.size===0}function ZM(n){n.Va=void 0}async function eG(n){n.Ra.set("Online")}async function tG(n){n.Ia.forEach(((e,t)=>{jE(n,e)}))}async function nG(n,e){ZM(n),WE(n)?(n.Ra.ha(e),zE(n)):n.Ra.set("Unknown")}async function rG(n,e,t){if(n.Ra.set("Online"),e instanceof dM&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ia.delete(l),i.Va.removeTarget(l))})(n,e)}catch(r){oe(Kl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ug(n,r)}else if(e instanceof Qm?n.Va.Ze(e):e instanceof uM?n.Va.st(e):n.Va.tt(e),!t.isEqual(be.min()))try{const r=await qM(n.localStore);t.compareTo(r)>=0&&await(function(s,o){const l=s.Va.Tt(o);return l.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const p=s.Ia.get(d);p&&s.Ia.set(d,p.withResumeToken(u.resumeToken,o))}})),l.targetMismatches.forEach(((u,d)=>{const p=s.Ia.get(u);if(!p)return;s.Ia.set(u,p.withResumeToken(Jt.EMPTY_BYTE_STRING,p.snapshotVersion)),XM(s,u);const v=new Ws(p.target,u,d,p.sequenceNumber);jE(s,v)})),s.remoteSyncer.applyRemoteEvent(l)})(n,t)}catch(r){oe(Kl,"Failed to raise snapshot:",r),await Ug(n,r)}}async function Ug(n,e,t){if(!Da(e))throw e;n.Ea.add(1),await ud(n),n.Ra.set("Offline"),t||(t=()=>qM(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{oe(Kl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await lp(n)}))}function e2(n,e){return e().catch((t=>Ug(n,t,e)))}async function dd(n){const e=ge(n),t=Sa(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:da;for(;iG(e);)try{const i=await BH(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,sG(e,i)}catch(i){await Ug(e,i)}t2(e)&&n2(e)}function iG(n){return La(n)&&n.Ta.length<10}function sG(n,e){n.Ta.push(e);const t=Sa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function t2(n){return La(n)&&!Sa(n).x_()&&n.Ta.length>0}function n2(n){Sa(n).start()}async function oG(n){Sa(n).ra()}async function aG(n){const e=Sa(n);for(const t of n.Ta)e.ea(t.mutations)}async function lG(n,e,t){const r=n.Ta.shift(),i=RE.from(r,e,t);await e2(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await dd(n)}async function cG(n,e){e&&Sa(n).X_&&await(async function(r,i){if((function(o){return aM(o)&&o!==X.ABORTED})(i.code)){const s=r.Ta.shift();Sa(r).B_(),await e2(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await dd(r)}})(n,e),t2(n)&&n2(n)}async function JN(n,e){const t=ge(n);t.asyncQueue.verifyOperationInProgress(),oe(Kl,"RemoteStore received new credentials");const r=La(t);t.Ea.add(3),await ud(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await lp(t)}async function k0(n,e){const t=ge(n);e?(t.Ea.delete(2),await lp(t)):e||(t.Ea.add(2),await ud(t),t.Ra.set("Unknown"))}function hd(n){return n.ma||(n.ma=(function(t,r,i){const s=ge(t);return s.sa(),new KH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:eG.bind(null,n),t_:tG.bind(null,n),r_:nG.bind(null,n),H_:rG.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),WE(n)?zE(n):n.Ra.set("Unknown")):(await n.ma.stop(),ZM(n))}))),n.ma}function Sa(n){return n.fa||(n.fa=(function(t,r,i){const s=ge(t);return s.sa(),new JH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:oG.bind(null,n),r_:cG.bind(null,n),ta:aG.bind(null,n),na:lG.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await dd(n)):(await n.fa.stop(),n.Ta.length>0&&(oe(Kl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new KE(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fd(n,e){if(en("AsyncQueue",`${e}: ${n}`),Da(n))return new ie(X.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{static emptySet(e){return new _u(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||me.comparator(t.key,r.key):(t,r)=>me.comparator(t.key,r.key),this.keyedMap=Ah(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _u)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new _u;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.ga=new At(me.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):we(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class zu{constructor(e,t,r,i,s,o,l,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach((l=>{o.push({type:0,doc:l})})),new zu(e,t,_u.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&np(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uG{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class dG{constructor(){this.queries=YN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ge(t),s=i.queries;i.queries=YN(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(r)}))})(this,new ie(X.ABORTED,"Firestore shutting down"))}}function YN(){return new uo((n=>WD(n)),np)}async function JE(n,e){const t=ge(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new uG,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=fd(o,`Initialization of query '${iu(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&YE(t)}async function QE(n,e){const t=ge(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function hG(n,e){const t=ge(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.Sa)l.Fa(i)&&(r=!0);o.wa=i}}r&&YE(t)}function fG(n,e,t){const r=ge(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function YE(n){n.Ca.forEach((e=>{e.next()}))}var R0,XN;(XN=R0||(R0={})).Ma="default",XN.Cache="cache";class XE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new zu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=zu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==R0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e){this.serializer=e}$s(e){return us(this.serializer,e)}Us(e){return e.metadata.exists?yM(this.serializer,e.document,!1):Dt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return nn(e)}}class mG{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=r2(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=Xe.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new ZN(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.$s(i.metadata.name);for(const o of i.metadata.queries){const l=(t.get(o)||Ge()).add(s);t.set(o,l)}}return t}async ja(e){const t=await qH(e,new ZN(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const i of this.Ka)await HH(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function r2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e){this.key=e}}class s2{constructor(e){this.key=e}}class o2{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ge(),this.mutatedKeys=Ge(),this.eu=JD(e),this.tu=new _u(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new QN,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((p,v)=>{const w=i.get(p),x=rp(this.query,v)?v:null,A=!!w&&this.mutatedKeys.has(w.key),R=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let L=!1;w&&x?w.data.isEqual(x.data)?A!==R&&(r.track({type:3,doc:x}),L=!0):this.su(w,x)||(r.track({type:2,doc:x}),L=!0,(u&&this.eu(x,u)>0||d&&this.eu(x,d)<0)&&(l=!0)):!w&&x?(r.track({type:0,doc:x}),L=!0):w&&!x&&(r.track({type:1,doc:w}),L=!0,(u||d)&&(l=!0)),L&&(x?(o=o.add(x),s=R?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{tu:o,iu:r,Cs:l,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((p,v)=>(function(x,A){const R=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we(20277,{Rt:L})}};return R(x)-R(A)})(p.type,v.type)||this.eu(p.doc,v.doc))),this.ou(r),i=i??!1;const l=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new zu(this.query,e.tu,s,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new QN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ge(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new s2(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new i2(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ge();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return zu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Va="SyncEngine";class gG{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class yG{constructor(e){this.key=e,this.hu=!1}}class _G{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new uo((l=>WD(l)),np),this.Iu=new Map,this.Eu=new Set,this.du=new At(me.comparator),this.Au=new Map,this.Ru=new FE,this.Vu={},this.mu=new Map,this.fu=Wl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function vG(n,e,t=!0){const r=Qy(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await a2(r,e,t,!0),i}async function wG(n,e){const t=Qy(n);await a2(t,e,!0,!1)}async function a2(n,e,t,r){const i=await Gu(n.localStore,ir(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await ZE(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Jy(n.remoteStore,i),l}async function ZE(n,e,t,r,i){n.pu=(v,w,x)=>(async function(R,L,j,B){let q=L.view.ru(j);q.Cs&&(q=await Vg(R.localStore,L.query,!1).then((({documents:P})=>L.view.ru(P,q))));const K=B&&B.targetChanges.get(L.targetId),te=B&&B.targetMismatches.get(L.targetId)!=null,ee=L.view.applyChanges(q,R.isPrimaryClient,K,te);return b0(R,L.targetId,ee.au),ee.snapshot})(n,v,w,x);const s=await Vg(n.localStore,e,!0),o=new o2(e,s.Qs),l=o.ru(s.documents),u=op.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(l,n.isPrimaryClient,u);b0(n,t,d.au);const p=new gG(e,t,o);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function TG(n,e,t){const r=ge(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!np(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await $u(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ju(r.remoteStore,i.targetId),Wu(r,i.targetId)})).catch(Pa)):(Wu(r,i.targetId),await $u(r.localStore,i.targetId,!0))}async function EG(n,e){const t=ge(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ju(t.remoteStore,r.targetId))}async function IG(n,e,t){const r=rI(n);try{const i=await(function(o,l){const u=ge(o),d=pt.now(),p=l.reduce(((x,A)=>x.add(A.key)),Ge());let v,w;return u.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let A=vr(),R=Ge();return u.Ns.getEntries(x,p).next((L=>{A=L,A.forEach(((j,B)=>{B.isValidDocument()||(R=R.add(j))}))})).next((()=>u.localDocuments.getOverlayedDocuments(x,A))).next((L=>{v=L;const j=[];for(const B of l){const q=j8(B,v.get(B.key).overlayedDocument);q!=null&&j.push(new ho(B.key,q,OD(q.value.mapValue),Ut.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,j,l)})).next((L=>{w=L;const j=L.applyToLocalDocumentSet(v,R);return u.documentOverlayCache.saveOverlays(x,L.batchId,j)}))})).then((()=>({batchId:w.batchId,changes:YD(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,l,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new At(Oe)),d=d.insert(l,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await fo(r,i.changes),await dd(r.remoteStore)}catch(i){const s=fd(i,"Failed to persist write");t.reject(s)}}async function l2(n,e){const t=ge(n);try{const r=await UH(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=t.Au.get(s);o&&(Ce(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ce(o.hu,14607):i.removedDocuments.size>0&&(Ce(o.hu,42227),o.hu=!1))})),await fo(t,r,e)}catch(r){await Pa(r)}}function ek(n,e,t){const r=ge(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&i.push(l.snapshot)})),(function(o,l){const u=ge(o);u.onlineState=l;let d=!1;u.queries.forEach(((p,v)=>{for(const w of v.Sa)w.va(l)&&(d=!0)})),d&&YE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xG(n,e,t){const r=ge(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new At(me.comparator);o=o.insert(s,Dt.newNoDocument(s,be.min()));const l=Ge().add(s),u=new sp(be.min(),new Map,new At(Oe),o,l);await l2(r,u),r.du=r.du.remove(s),r.Au.delete(e),nI(r)}else await $u(r.localStore,e,!1).then((()=>Wu(r,e,t))).catch(Pa)}async function SG(n,e){const t=ge(n),r=e.batch.batchId;try{const i=await OH(t.localStore,e);tI(t,r,null),eI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await fo(t,i)}catch(i){await Pa(i)}}async function CG(n,e,t){const r=ge(n);try{const i=await(function(o,l){const u=ge(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return u.mutationQueue.lookupMutationBatch(d,l).next((v=>(Ce(v!==null,37113),p=v.keys(),u.mutationQueue.removeMutationBatch(d,v)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,p,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>u.localDocuments.getDocuments(d,p)))}))})(r.localStore,e);tI(r,e,t),eI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await fo(r,i)}catch(i){await Pa(i)}}async function AG(n,e){const t=ge(n);La(t.remoteStore)||oe(Va,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(o){const l=ge(o);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(u=>l.mutationQueue.getHighestUnacknowledgedBatchId(u)))})(t.localStore);if(r===da)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=fd(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function eI(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function tI(n,e,t){const r=ge(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Wu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||c2(n,r)}))}function c2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(ju(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),nI(n))}function b0(n,e,t){for(const r of t)r instanceof i2?(n.Ru.addReference(r.key,e),NG(n,r)):r instanceof s2?(oe(Va,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||c2(n,r.key)):we(19791,{wu:r})}function NG(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(oe(Va,"New document in limbo: "+t),n.Eu.add(r),nI(n))}function nI(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new me(Xe.fromString(e)),r=n.fu.next();n.Au.set(r,new yG(t)),n.du=n.du.insert(t,r),Jy(n.remoteStore,new Ws(ir(ad(t.path)),r,"TargetPurposeLimboResolution",yr.ce))}}async function fo(n,e,t){const r=ge(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,u)=>{o.push(r.pu(u,e,t).then((d=>{var p;if((d||t)&&r.isPrimaryClient){const v=d?!d.fromCache:(p=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,v?"current":"not-current")}if(d){i.push(d);const v=qE.As(u.targetId,d);s.push(v)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const p=ge(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>$.forEach(d,(w=>$.forEach(w.Es,(x=>p.persistence.referenceDelegate.addReference(v,w.targetId,x))).next((()=>$.forEach(w.ds,(x=>p.persistence.referenceDelegate.removeReference(v,w.targetId,x)))))))))}catch(v){if(!Da(v))throw v;oe(HE,"Failed to update sequence numbers: "+v)}for(const v of d){const w=v.targetId;if(!v.fromCache){const x=p.Ms.get(w),A=x.snapshotVersion,R=x.withLastLimboFreeSnapshotVersion(A);p.Ms=p.Ms.insert(w,R)}}})(r.localStore,s))}async function kG(n,e){const t=ge(n);if(!t.currentUser.isEqual(e)){oe(Va,"User change. New user:",e.toKey());const r=await BM(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new ie(X.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fo(t,r.Ls)}}function RG(n,e){const t=ge(n),r=t.Au.get(e);if(r&&r.hu)return Ge().add(r.key);{let i=Ge();const s=t.Iu.get(e);if(!s)return i;for(const o of s){const l=t.Tu.get(o);i=i.unionWith(l.view.nu)}return i}}async function bG(n,e){const t=ge(n),r=await Vg(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&b0(t,e.targetId,i.au),i}async function PG(n,e){const t=ge(n);return $M(t.localStore,e).then((r=>fo(t,r)))}async function DG(n,e,t,r){const i=ge(n),s=await(function(l,u){const d=ge(l),p=ge(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",(v=>p.er(v,u).next((w=>w?d.localDocuments.getDocuments(v,w):$.resolve(null)))))})(i.localStore,e);s!==null?(t==="pending"?await dd(i.remoteStore):t==="acknowledged"||t==="rejected"?(tI(i,e,r||null),eI(i,e),(function(l,u){ge(ge(l).mutationQueue).ir(u)})(i.localStore,e)):we(6720,"Unknown batchState",{Su:t}),await fo(i,s)):oe(Va,"Cannot apply mutation batch with id: "+e)}async function MG(n,e){const t=ge(n);if(Qy(t),rI(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await tk(t,r.toArray());t.gu=!0,await k0(t.remoteStore,!0);for(const s of i)Jy(t.remoteStore,s)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then((()=>(Wu(t,o),$u(t.localStore,o,!0)))),ju(t.remoteStore,o)})),await i,await tk(t,r),(function(o){const l=ge(o);l.Au.forEach(((u,d)=>{ju(l.remoteStore,d)})),l.Ru.Jr(),l.Au=new Map,l.du=new At(me.comparator)})(t),t.gu=!1,await k0(t.remoteStore,!1)}}async function tk(n,e,t){const r=ge(n),i=[],s=[];for(const o of e){let l;const u=r.Iu.get(o);if(u&&u.length!==0){l=await Gu(r.localStore,ir(u[0]));for(const d of u){const p=r.Tu.get(d),v=await bG(r,p);v.snapshot&&s.push(v.snapshot)}}else{const d=await GM(r.localStore,o);l=await Gu(r.localStore,d),await ZE(r,u2(d),o,!1,l.resumeToken)}i.push(l)}return r.Pu.H_(s),i}function u2(n){return zD(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function LG(n){return(function(t){return ge(ge(t).persistence).Ts()})(ge(n).localStore)}async function VG(n,e,t,r){const i=ge(n);if(i.gu)return void oe(Va,"Ignoring unexpected query state notification.");const s=i.Iu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await $M(i.localStore,KD(s[0])),l=sp.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Jt.EMPTY_BYTE_STRING);await fo(i,o,l);break}case"rejected":await $u(i.localStore,e,!0),Wu(i,e,r);break;default:we(64155,t)}}async function FG(n,e,t){const r=Qy(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){oe(Va,"Adding an already active target "+i);continue}const s=await GM(r.localStore,i),o=await Gu(r.localStore,s);await ZE(r,u2(s),o.targetId,!1,o.resumeToken),Jy(r.remoteStore,o)}for(const i of t)r.Iu.has(i)&&await $u(r.localStore,i,!1).then((()=>{ju(r.remoteStore,i),Wu(r,i)})).catch(Pa)}}function Qy(n){const e=ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=l2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xG.bind(null,e),e.Pu.H_=hG.bind(null,e.eventManager),e.Pu.yu=fG.bind(null,e.eventManager),e}function rI(n){const e=ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CG.bind(null,e),e}function OG(n,e,t){const r=ge(n);(async function(s,o,l){try{const u=await o.getMetadata();if(await(function(x,A){const R=ge(x),L=nn(A.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",(j=>R.Ii.getBundleMetadata(j,A.id))).then((j=>!!j&&j.createTime.compareTo(L)>=0))})(s.localStore,u))return await o.close(),l._completeWith((function(x){return{taskState:"Success",documentsLoaded:x.totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}})(u)),Promise.resolve(new Set);l._updateProgress(r2(u));const d=new mG(u,o.serializer);let p=await o.bu();for(;p;){const w=await d.Ga(p);w&&l._updateProgress(w),p=await o.bu()}const v=await d.ja(s.localStore);return await fo(s,v.Ha,void 0),await(function(x,A){const R=ge(x);return R.persistence.runTransaction("Save bundle","readwrite",(L=>R.Ii.saveBundleMetadata(L,A)))})(s.localStore,u),l._completeWith(v.progress),Promise.resolve(v.Ja)}catch(u){return ys(Va,`Loading bundle failed with ${u}`),l._failWith(u),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class kf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ap(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return UM(this.persistence,new OM,e.initialUser,this.serializer)}Cu(e){return new OE(Ky.mi,this.serializer)}Du(e){return new JM}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kf.provider={build:()=>new kf};class UG extends kf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ce(this.persistence.referenceDelegate instanceof Lg,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new PM(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new OE((r=>Lg.mi(r,t)),this.serializer)}}class d2 extends kf{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await rI(this.xu.syncEngine),await dd(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return UM(this.persistence,new OM,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new PM(r,e.asyncQueue,t)}Mu(e,t){const r=new K7(t,this.persistence);return new W7(e.asyncQueue,r)}Cu(e){const t=BE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new UE(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,QM(),Xm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new JM}}class BG extends d2{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof pw&&(this.sharedClientState.syncEngine={Co:DG.bind(null,t),vo:VG.bind(null,t),Fo:FG.bind(null,t),Ts:LG.bind(null,t),Do:PG.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await MG(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=QM();if(!pw.v(t))throw new ie(X.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=BE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pw(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Rf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ek(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kG.bind(null,this.syncEngine),await k0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dG})()}createDatastore(e){const t=ap(e.databaseInfo.databaseId),r=(function(s){return new WH(s)})(e.databaseInfo);return(function(s,o,l,u){return new YH(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,o,l){return new ZH(r,i,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>ek(this.syncEngine,t,0)),(function(){return WN.v()?new WN:new GH})())}createSyncEngine(e,t){return(function(i,s,o,l,u,d,p){const v=new _G(i,s,o,l,u,d);return p&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const s=ge(i);oe(Kl,"RemoteStore shutting down."),s.Ea.add(5),await ud(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Rf.provider={build:()=>new Rf};function nk(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):en("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qG{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Fn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(r);return new pG(JSON.parse(i),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(X.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,s){const o=ge(i),l={documents:s.map((v=>Af(o.serializer,v)))},u=await o.Ho("BatchGetDocuments",o.serializer.databaseId,Xe.emptyPath(),l,s.length),d=new Map;u.forEach((v=>{const w=eH(o.serializer,v);d.set(w.key.toString(),w)}));const p=[];return s.forEach((v=>{const w=d.get(v.toString());Ce(!!w,55234,{key:v}),p.push(w)})),p})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new cd(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=me.fromPath(r);this.mutations.push(new NE(i,this.precondition(i)))})),await(async function(r,i){const s=ge(r),o={writes:i.map((l=>Nf(s.serializer,l)))};await s.Go("Commit",s.serializer.databaseId,Xe.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we(50498,{Gu:e.constructor.name});t=be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ie(X.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(be.min())?Ut.exists(!1):Ut.updateTime(t):Ut.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(be.min()))throw new ie(X.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ut.updateTime(t)}return Ut.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new $E(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new HG(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Yu(i)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!Zf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!aM(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca="FirestoreClient";class $G{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Sn.UNAUTHENTICATED,this.clientId=pE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{oe(Ca,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(oe(Ca,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=fd(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function gw(n,e){n.asyncQueue.verifyOperationInProgress(),oe(Ca,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await BM(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function rk(n,e){n.asyncQueue.verifyOperationInProgress();const t=await iI(n);oe(Ca,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>JN(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>JN(e.remoteStore,i))),n._onlineComponents=e}async function iI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){oe(Ca,"Using user provided OfflineComponentProvider");try{await gw(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===X.FAILED_PRECONDITION||i.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;ys("Error using user provided cache. Falling back to memory cache: "+t),await gw(n,new kf)}}else oe(Ca,"Using default OfflineComponentProvider"),await gw(n,new UG(void 0));return n._offlineComponents}async function Xy(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(oe(Ca,"Using user provided OnlineComponentProvider"),await rk(n,n._uninitializedComponentsProvider._online)):(oe(Ca,"Using default OnlineComponentProvider"),await rk(n,new Rf))),n._onlineComponents}function h2(n){return iI(n).then((e=>e.persistence))}function sI(n){return iI(n).then((e=>e.localStore))}function f2(n){return Xy(n).then((e=>e.remoteStore))}function oI(n){return Xy(n).then((e=>e.syncEngine))}function jG(n){return Xy(n).then((e=>e.datastore))}async function Ku(n){const e=await Xy(n),t=e.eventManager;return t.onListen=vG.bind(null,e.syncEngine),t.onUnlisten=TG.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wG.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=EG.bind(null,e.syncEngine),t}function zG(n){return n.asyncQueue.enqueue((async()=>{const e=await h2(n),t=await f2(n);return e.setNetworkEnabled(!0),(function(i){const s=ge(i);return s.Ea.delete(0),lp(s)})(t)}))}function WG(n){return n.asyncQueue.enqueue((async()=>{const e=await h2(n),t=await f2(n);return e.setNetworkEnabled(!1),(async function(i){const s=ge(i);s.Ea.add(0),await ud(s),s.Ra.set("Offline")})(t)}))}function KG(n,e){const t=new Fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const l=await(function(d,p){const v=ge(d);return v.persistence.runTransaction("read document","readonly",(w=>v.localDocuments.getDocument(w,p)))})(i,s);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new ie(X.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const u=fd(l,`Failed to get document '${s} from cache`);o.reject(u)}})(await sI(n),e,t))),t.promise}function p2(n,e,t={}){const r=new Fn;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,d){const p=new Yy({next:w=>{p.Nu(),o.enqueueAndForget((()=>QE(s,v)));const x=w.docs.has(l);!x&&w.fromCache?d.reject(new ie(X.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&w.fromCache&&u&&u.source==="server"?d.reject(new ie(X.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(w)},error:w=>d.reject(w)}),v=new XE(ad(l.path),p,{includeMetadataChanges:!0,qa:!0});return JE(s,v)})(await Ku(n),n.asyncQueue,e,t,r))),r.promise}function JG(n,e){const t=new Fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const l=await Vg(i,s,!0),u=new o2(s,l.Qs),d=u.ru(l.documents),p=u.applyChanges(d,!1);o.resolve(p.snapshot)}catch(l){const u=fd(l,`Failed to execute query '${s} against cache`);o.reject(u)}})(await sI(n),e,t))),t.promise}function m2(n,e,t={}){const r=new Fn;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,d){const p=new Yy({next:w=>{p.Nu(),o.enqueueAndForget((()=>QE(s,v))),w.fromCache&&u.source==="server"?d.reject(new ie(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(w)},error:w=>d.reject(w)}),v=new XE(l,p,{includeMetadataChanges:!0,qa:!0});return JE(s,v)})(await Ku(n),n.asyncQueue,e,t,r))),r.promise}function QG(n,e){const t=new Yy(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,s){ge(i).Ca.add(s),s.next()})(await Ku(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,s){ge(i).Ca.delete(s)})(await Ku(n),t)))}}function YG(n,e,t,r){const i=(function(o,l){let u;return u=typeof o=="string"?cM().encode(o):o,(function(p,v){return new qG(p,v)})((function(p,v){if(p instanceof Uint8Array)return nk(p,v);if(p instanceof ArrayBuffer)return nk(new Uint8Array(p),v);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(u),l)})(t,ap(e));n.asyncQueue.enqueueAndForget((async()=>{OG(await oI(n),i,r)}))}function XG(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const s=ge(r);return s.persistence.runTransaction("Get named query","readonly",(o=>s.Ii.getNamedQuery(o,i)))})(await sI(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2="firestore.googleapis.com",sk=!0;class ok{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=y2,this.ssl=sk}else this.host=e.host,this.ssl=e.ssl??sk;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=NM;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vH)throw new ie(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=g2(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ie(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ie(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ie(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cp{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ok({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ok(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new L7;switch(r.type){case"firstParty":return new U7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=ik.get(t);r&&(oe("ComponentProvider","Removing Datastore"),ik.delete(t),r.terminate())})(this),Promise.resolve()}}function ZG(n,e,t,r={}){var d;n=ct(n,cp);const i=ka(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;i&&(rT(`https://${l}`),iT("Firestore",!0)),s.host!==y2&&s.host!==l&&ys("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:i,emulatorOptions:r};if(!Xs(u,o)&&(n._setSettings(u),r.mockUserToken)){let p,v;if(typeof r.mockUserToken=="string")p=r.mockUserToken,v=Sn.MOCK_USER;else{p=yb(r.mockUserToken,(d=n._app)==null?void 0:d.options.projectId);const w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new ie(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Sn(w)}n._authCredentials=new V7(new lD(p,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let or=class _2{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _2(this.firestore,e,this._query)}},Ct=class Rh{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rh(this.firestore,e,this._key)}toJSON(){return{type:Rh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Xf(t,Rh._jsonSchema))return new Rh(e,r||null,new me(Xe.fromString(t.referencePath)))}};Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:cn("string",Ct._jsonSchemaVersion),referencePath:cn("string")};let ha=class v2 extends or{constructor(e,t,r){super(e,t,ad(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new me(e))}withConverter(e){return new v2(this.firestore,e,this._path)}};function w2(n,e,...t){if(n=Ee(n),mE("collection","path",e),n instanceof cp){const r=Xe.fromString(e,...t);return KA(r),new ha(n,null,r)}{if(!(n instanceof Ct||n instanceof ha))throw new ie(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xe.fromString(e,...t));return KA(r),new ha(n.firestore,null,r)}}function e$(n,e){if(n=ct(n,cp),mE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(X.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new or(n,null,(function(r){return new co(Xe.emptyPath(),r)})(e))}function Bg(n,e,...t){if(n=Ee(n),arguments.length===1&&(e=pE.newId()),mE("doc","path",e),n instanceof cp){const r=Xe.fromString(e,...t);return WA(r),new Ct(n,null,new me(r))}{if(!(n instanceof Ct||n instanceof ha))throw new ie(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xe.fromString(e,...t));return WA(r),new Ct(n.firestore,n instanceof ha?n.converter:null,new me(r))}}function T2(n,e){return n=Ee(n),e=Ee(e),(n instanceof Ct||n instanceof ha)&&(e instanceof Ct||e instanceof ha)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function E2(n,e){return n=Ee(n),e=Ee(e),n instanceof or&&e instanceof or&&n.firestore===e.firestore&&np(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak="AsyncQueue";class lk{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $E(this,"async_queue_retry"),this._c=()=>{const r=Xm();r&&oe(ak,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Xm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Xm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Fn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Da(e))throw e;oe(ak,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,en("INTERNAL UNHANDLED ERROR: ",ck(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=KE.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&we(47125,{Pc:ck(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ck(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}class t${constructor(){this._progressObserver={},this._taskCompletionResolver=new Fn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n$=-1;let rn=class extends cp{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new lk,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new lk(e),this._firestoreClient=void 0,await e}}};function Yn(n){if(n._terminated)throw new ie(X.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||I2(n),n._firestoreClient}function I2(n){var r,i,s;const e=n._freezeSettings(),t=(function(l,u,d,p){return new I8(l,u,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,g2(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new $G(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}})(n._componentsProvider))}function r$(n,e){ys("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return x2(n,Rf.provider,{build:r=>new d2(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function i$(n){ys("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();x2(n,Rf.provider,{build:t=>new BG(t,e.cacheSizeBytes)})}function x2(n,e,t){if((n=ct(n,rn))._firestoreClient||n._terminated)throw new ie(X.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ie(X.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},I2(n)}function s$(n){if(n._initialized&&!n._terminated)throw new ie(X.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Fn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!cs.v())return Promise.resolve();const i=r+FM;await cs.delete(i)})(BE(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function o$(n){return(function(t){const r=new Fn;return t.asyncQueue.enqueueAndForget((async()=>AG(await oI(t),r))),r.promise})(Yn(n=ct(n,rn)))}function a$(n){return zG(Yn(n=ct(n,rn)))}function l$(n){return WG(Yn(n=ct(n,rn)))}function c$(n,e){const t=Yn(n=ct(n,rn)),r=new t$;return YG(t,n._databaseId,e,r),r}function u$(n,e){return XG(Yn(n=ct(n,rn)),e).then((t=>t?new or(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zn(Jt.fromBase64String(e))}catch(t){throw new ie(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new zn(Jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xf(e,zn._jsonSchema))return zn.fromBase64String(e.bytes)}}zn._jsonSchemaVersion="firestore/bytes/1.0",zn._jsonSchema={type:cn("string",zn._jsonSchemaVersion),bytes:cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Aa=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ie(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ac=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ie(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ie(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ci._jsonSchemaVersion}}static fromJSON(e){if(Xf(e,Ci._jsonSchema))return new Ci(e.latitude,e.longitude)}}Ci._jsonSchemaVersion="firestore/geoPoint/1.0",Ci._jsonSchema={type:cn("string",Ci._jsonSchemaVersion),latitude:cn("number"),longitude:cn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ds._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xf(e,ds._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ds(e.vectorValues);throw new ie(X.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ds._jsonSchemaVersion="firestore/vectorValue/1.0",ds._jsonSchema={type:cn("string",ds._jsonSchemaVersion),vectorValues:cn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d$=/^__.*__$/;class h${constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ho(e,this.data,this.fieldMask,t,this.fieldTransforms):new ld(e,this.data,t,this.fieldTransforms)}}class S2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ho(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function C2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we(40011,{Ac:n})}}class Zy{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Zy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return qg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(C2(this.Ac)&&d$.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class f${constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ap(e)}Cc(e,t,r,i=!1){return new Zy({Ac:e,methodName:t,Dc:r,path:Ot.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lc(n){const e=n._freezeSettings(),t=ap(n._databaseId);return new f$(n._databaseId,!!e.ignoreUndefinedProperties,t)}function e_(n,e,t,r,i,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);fI("Data must be an object, but it was:",o,r);const l=k2(r,o);let u,d;if(s.merge)u=new _r(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const v of s.mergeFields){const w=D0(e,v,t);if(!o.contains(w))throw new ie(X.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);b2(p,w)||p.push(w)}u=new _r(p),d=o.fieldTransforms.filter((v=>u.covers(v.field)))}else u=null,d=o.fieldTransforms;return new h$(new Ln(l),u,d)}class up extends ac{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof up}}function A2(n,e,t){return new Zy({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class aI extends ac{_toFieldTransform(e){return new ip(e.path,new Bu)}isEqual(e){return e instanceof aI}}class lI extends ac{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=A2(this,e,!0),r=this.vc.map((s=>cc(s,t))),i=new Gl(r);return new ip(e.path,i)}isEqual(e){return e instanceof lI&&Xs(this.vc,e.vc)}}class cI extends ac{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=A2(this,e,!0),r=this.vc.map((s=>cc(s,t))),i=new $l(r);return new ip(e.path,i)}isEqual(e){return e instanceof cI&&Xs(this.vc,e.vc)}}class uI extends ac{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new qu(e.serializer,eM(e.serializer,this.Fc));return new ip(e.path,t)}isEqual(e){return e instanceof uI&&this.Fc===e.Fc}}function dI(n,e,t,r){const i=n.Cc(1,e,t);fI("Data must be an object, but it was:",i,r);const s=[],o=Ln.empty();Ma(r,((u,d)=>{const p=pI(e,u,t);d=Ee(d);const v=i.yc(p);if(d instanceof up)s.push(p);else{const w=cc(d,v);w!=null&&(s.push(p),o.set(p,w))}}));const l=new _r(s);return new S2(o,l,i.fieldTransforms)}function hI(n,e,t,r,i,s){const o=n.Cc(1,e,t),l=[D0(e,r,t)],u=[i];if(s.length%2!=0)throw new ie(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)l.push(D0(e,s[w])),u.push(s[w+1]);const d=[],p=Ln.empty();for(let w=l.length-1;w>=0;--w)if(!b2(d,l[w])){const x=l[w];let A=u[w];A=Ee(A);const R=o.yc(x);if(A instanceof up)d.push(x);else{const L=cc(A,R);L!=null&&(d.push(x),p.set(x,L))}}const v=new _r(d);return new S2(p,v,o.fieldTransforms)}function N2(n,e,t,r=!1){return cc(t,n.Cc(r?4:3,e))}function cc(n,e){if(R2(n=Ee(n)))return fI("Unsupported field value:",e,n),k2(n,e);if(n instanceof ac)return(function(r,i){if(!C2(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const l of r){let u=cc(l,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return eM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=pt.fromDate(r);return{timestampValue:Hu(i.serializer,s)}}if(r instanceof pt){const s=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Hu(i.serializer,s)}}if(r instanceof Ci)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zn)return{bytesValue:hM(i.serializer,r._byteString)};if(r instanceof Ct){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:DE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ds)return(function(o,l){return{mapValue:{fields:{[EE]:{stringValue:IE},[Fu]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return AE(l.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Vy(r)}`)})(n,e)}function k2(n,e){const t={};return kD(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ma(n,((r,i)=>{const s=cc(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function R2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof Ci||n instanceof zn||n instanceof Ct||n instanceof ac||n instanceof ds)}function fI(n,e,t){if(!R2(t)||!dD(t)){const r=Vy(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function D0(n,e,t){if((e=Ee(e))instanceof Aa)return e._internalPath;if(typeof e=="string")return pI(n,e);throw qg("Field path arguments must be of type string or ",n,!1,void 0,t)}const p$=new RegExp("[~\\*/\\[\\]]");function pI(n,e,t){if(e.search(p$)>=0)throw qg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Aa(...e.split("."))._internalPath}catch{throw qg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qg(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new ie(X.INVALID_ARGUMENT,l+n+u)}function b2(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new m$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(t_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class m$ extends bf{data(){return super.data()}}function t_(n,e){return typeof e=="string"?pI(n,e):e instanceof Aa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ie(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mI{}class dp extends mI{}function Qo(n,e,...t){let r=[];e instanceof mI&&r.push(e),r=r.concat(t),(function(s){const o=s.filter((u=>u instanceof gI)).length,l=s.filter((u=>u instanceof n_)).length;if(o>1||o>0&&l>0)throw new ie(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class n_ extends dp{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n_(e,t,r)}_apply(e){const t=this._parse(e);return M2(e._query,t),new or(e.firestore,e.converter,v0(e._query,t))}_parse(e){const t=lc(e.firestore);return(function(s,o,l,u,d,p,v){let w;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ie(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){dk(v,p);const A=[];for(const R of v)A.push(uk(u,s,R));w={arrayValue:{values:A}}}else w=uk(u,s,v)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||dk(v,p),w=N2(l,o,v,p==="in"||p==="not-in");return Ze.create(d,p,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function g$(n,e,t){const r=e,i=t_("where",n);return n_._create(i,r,t)}class gI extends mI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gI(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:_t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)M2(o,u),o=v0(o,u)})(e._query,t),new or(e.firestore,e.converter,v0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yI extends dp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yI(e,t)}_apply(e){const t=(function(i,s,o){if(i.startAt!==null)throw new ie(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ie(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cf(s,o)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,(function(i,s){const o=i.explicitOrderBy.concat([s]);return new co(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function y$(n,e="asc"){const t=e,r=t_("orderBy",n);return yI._create(r,t)}class r_ extends dp{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new r_(e,t,r)}_apply(e){return new or(e.firestore,e.converter,bg(e._query,this._limit,this._limitType))}}function _$(n){return hD("limit",n),r_._create("limit",n,"F")}function v$(n){return hD("limitToLast",n),r_._create("limitToLast",n,"L")}class i_ extends dp{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new i_(e,t,r)}_apply(e){const t=D2(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,(function(i,s){return new co(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)})(e._query,t))}}function w$(...n){return i_._create("startAt",n,!0)}function T$(...n){return i_._create("startAfter",n,!1)}class s_ extends dp{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new s_(e,t,r)}_apply(e){const t=D2(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,(function(i,s){return new co(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)})(e._query,t))}}function E$(...n){return s_._create("endBefore",n,!1)}function I$(...n){return s_._create("endAt",n,!0)}function D2(n,e,t,r){if(t[0]=Ee(t[0]),t[0]instanceof bf)return(function(s,o,l,u,d){if(!u)throw new ie(X.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const v of yu(s))if(v.field.isKeyField())p.push(ql(o,u.key));else{const w=u.data.field(v.field);if(qy(w))throw new ie(X.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(w===null){const x=v.field.canonicalString();throw new ie(X.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}p.push(w)}return new xa(p,d)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=lc(n.firestore);return(function(o,l,u,d,p,v){const w=o.explicitOrderBy;if(p.length>w.length)throw new ie(X.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let A=0;A<p.length;A++){const R=p[A];if(w[A].field.isKeyField()){if(typeof R!="string")throw new ie(X.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof R}`);if(!SE(o)&&R.indexOf("/")!==-1)throw new ie(X.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${R}' contains a slash.`);const L=o.path.child(Xe.fromString(R));if(!me.isDocumentKey(L))throw new ie(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${L}' is not because it contains an odd number of segments.`);const j=new me(L);x.push(ql(l,j))}else{const L=N2(u,d,R);x.push(L)}}return new xa(x,v)})(n._query,n.firestore._databaseId,i,e,t,r)}}function uk(n,e,t){if(typeof(t=Ee(t))=="string"){if(t==="")throw new ie(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!SE(e)&&t.indexOf("/")!==-1)throw new ie(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Xe.fromString(t));if(!me.isDocumentKey(r))throw new ie(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ql(n,new me(r))}if(t instanceof Ct)return ql(n,t._key);throw new ie(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vy(t)}.`)}function dk(n,e){if(!Array.isArray(n)||n.length===0)throw new ie(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function M2(n,e){const t=(function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ie(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class _I{convertValue(e,t="none"){switch(Ea(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ro(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ma(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){var r,i,s;const t=(s=(i=(r=e.fields)==null?void 0:r[Fu].arrayValue)==null?void 0:i.values)==null?void 0:s.map((o=>Vt(o.doubleValue)));return new ds(t)}convertGeoPoint(e){return new Ci(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hy(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(If(e));default:return null}}convertTimestamp(e){const t=no(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Xe.fromString(e);Ce(IM(r),9688,{name:e});const i=new Ta(r.get(1),r.get(3)),s=new me(r.popFirst(5));return i.isEqual(t)||en(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class x$ extends _I{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,t)}}class Cl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let si=class L2 extends bf{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(t_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(X.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=L2._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};si._jsonSchemaVersion="firestore/documentSnapshot/1.0",si._jsonSchema={type:cn("string",si._jsonSchemaVersion),bundleSource:cn("string","DocumentSnapshot"),bundleName:cn("string"),bundle:cn("string")};let Jh=class extends si{data(e={}){return super.data(e)}},Ai=class V2{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Cl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Jh(this._firestore,this._userDataWriter,r.key,r,new Cl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ie(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((l=>{const u=new Jh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Cl(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Jh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Cl(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:S$(l.type),doc:u,oldIndex:d,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(X.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=V2._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=pE.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function S$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we(61501,{type:n})}}function F2(n,e){return n instanceof si&&e instanceof si?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ai&&e instanceof Ai&&n._firestore===e._firestore&&E2(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C$(n){n=ct(n,Ct);const e=ct(n.firestore,rn);return p2(Yn(e),n._key).then((t=>vI(e,n,t)))}Ai._jsonSchemaVersion="firestore/querySnapshot/1.0",Ai._jsonSchema={type:cn("string",Ai._jsonSchemaVersion),bundleSource:cn("string","QuerySnapshot"),bundleName:cn("string"),bundle:cn("string")};class uc extends _I{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,t)}}function A$(n){n=ct(n,Ct);const e=ct(n.firestore,rn),t=Yn(e),r=new uc(e);return KG(t,n._key).then((i=>new si(e,r,n._key,i,new Cl(i!==null&&i.hasLocalMutations,!0),n.converter)))}function N$(n){n=ct(n,Ct);const e=ct(n.firestore,rn);return p2(Yn(e),n._key,{source:"server"}).then((t=>vI(e,n,t)))}function k$(n){n=ct(n,or);const e=ct(n.firestore,rn),t=Yn(e),r=new uc(e);return P2(n._query),m2(t,n._query).then((i=>new Ai(e,r,n,i)))}function R$(n){n=ct(n,or);const e=ct(n.firestore,rn),t=Yn(e),r=new uc(e);return JG(t,n._query).then((i=>new Ai(e,r,n,i)))}function b$(n){n=ct(n,or);const e=ct(n.firestore,rn),t=Yn(e),r=new uc(e);return m2(t,n._query,{source:"server"}).then((i=>new Ai(e,r,n,i)))}function hk(n,e,t){n=ct(n,Ct);const r=ct(n.firestore,rn),i=o_(n.converter,e,t);return hp(r,[e_(lc(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ut.none())])}function fk(n,e,t,...r){n=ct(n,Ct);const i=ct(n.firestore,rn),s=lc(i);let o;return o=typeof(e=Ee(e))=="string"||e instanceof Aa?hI(s,"updateDoc",n._key,e,t,r):dI(s,"updateDoc",n._key,e),hp(i,[o.toMutation(n._key,Ut.exists(!0))])}function P$(n){return hp(ct(n.firestore,rn),[new cd(n._key,Ut.none())])}function D$(n,e){const t=ct(n.firestore,rn),r=Bg(n),i=o_(n.converter,e);return hp(t,[e_(lc(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ut.exists(!1))]).then((()=>r))}function O2(n,...e){var u,d,p;n=Ee(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||P0(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(P0(e[r])){const v=e[r];e[r]=(u=v.next)==null?void 0:u.bind(v),e[r+1]=(d=v.error)==null?void 0:d.bind(v),e[r+2]=(p=v.complete)==null?void 0:p.bind(v)}let s,o,l;if(n instanceof Ct)o=ct(n.firestore,rn),l=ad(n._key.path),s={next:v=>{e[r]&&e[r](vI(o,n,v))},error:e[r+1],complete:e[r+2]};else{const v=ct(n,or);o=ct(v.firestore,rn),l=v._query;const w=new uc(o);s={next:x=>{e[r]&&e[r](new Ai(o,w,v,x))},error:e[r+1],complete:e[r+2]},P2(n._query)}return(function(w,x,A,R){const L=new Yy(R),j=new XE(x,L,A);return w.asyncQueue.enqueueAndForget((async()=>JE(await Ku(w),j))),()=>{L.Nu(),w.asyncQueue.enqueueAndForget((async()=>QE(await Ku(w),j)))}})(Yn(o),l,i,s)}function M$(n,e){return QG(Yn(n=ct(n,rn)),P0(e)?e:{next:e})}function hp(n,e){return(function(r,i){const s=new Fn;return r.asyncQueue.enqueueAndForget((async()=>IG(await oI(r),i,s))),s.promise})(Yn(n),e)}function vI(n,e,t){const r=t.docs.get(e._key),i=new uc(n);return new si(n,i,e._key,r,new Cl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L$={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V$=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=lc(e)}set(e,t,r){this._verifyNotCommitted();const i=ra(e,this._firestore),s=o_(i.converter,t,r),o=e_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ut.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=ra(e,this._firestore);let o;return o=typeof(t=Ee(t))=="string"||t instanceof Aa?hI(this._dataReader,"WriteBatch.update",s._key,t,r,i):dI(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Ut.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ra(e,this._firestore);return this._mutations=this._mutations.concat(new cd(t._key,Ut.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(X.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ra(n,e){if((n=Ee(n)).firestore!==e)throw new ie(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=lc(e)}get(e){const t=ra(e,this._firestore),r=new x$(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return we(24041);const s=i[0];if(s.isFoundDocument())return new bf(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new bf(this._firestore,r,t._key,null,t.converter);throw we(18433,{doc:s})}))}set(e,t,r){const i=ra(e,this._firestore),s=o_(i.converter,t,r),o=e_(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){const s=ra(e,this._firestore);let o;return o=typeof(t=Ee(t))=="string"||t instanceof Aa?hI(this._dataReader,"Transaction.update",s._key,t,r,i):dI(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=ra(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O$=class extends F${constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ra(e,this._firestore),r=new uc(this._firestore);return super.get(e).then((i=>new si(this._firestore,r,t._key,i._document,new Cl(!1,!1),t.converter)))}};function U$(n,e,t){n=ct(n,rn);const r={...L$,...t};return(function(s){if(s.maxAttempts<1)throw new ie(X.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(s,o,l){const u=new Fn;return s.asyncQueue.enqueueAndForget((async()=>{const d=await jG(s);new GG(s.asyncQueue,d,l,o,u).ju()})),u.promise})(Yn(n),(i=>e(new O$(n,i))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B$(){return new up("deleteField")}function q$(){return new aI("serverTimestamp")}function H$(...n){return new lI("arrayUnion",n)}function G$(...n){return new cI("arrayRemove",n)}function $$(n){return new uI("increment",n)}(function(e,t=!0){(function(i){od=i})(oo),Tr(new un("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new rn(new F7(r.getProvider("auth-internal")),new B7(o,r.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ie(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ta(d.options.projectId,p)})(o,i),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),Vn(GA,$A,e),Vn(GA,$A,"esm2020")})();const j$="@firebase/firestore-compat",z$="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ie("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(){if(typeof Uint8Array>"u")throw new ie("unimplemented","Uint8Arrays are not available in this environment.")}function mk(){if(!T8())throw new ie("unimplemented","Blobs are unavailable in Firestore in this environment.")}let U2=class M0{constructor(e){this._delegate=e}static fromBase64String(e){return mk(),new M0(zn.fromBase64String(e))}static fromUint8Array(e){return pk(),new M0(zn.fromUint8Array(e))}toBase64(){return mk(),this._delegate.toBase64()}toUint8Array(){return pk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(n){return W$(n,["next","error","complete"])}function W$(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${enableIndexedDbPersistence(e,t){return r$(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return i$(e._delegate)}clearIndexedDbPersistence(e){return s$(e._delegate)}}class B2{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ta||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ys("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){ZG(this._delegate,e,t,r)}enableNetwork(){return a$(this._delegate)}disableNetwork(){return l$(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,uD("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return o$(this._delegate)}onSnapshotsInSync(e){return M$(this._delegate,e)}get app(){if(!this._appCompat)throw new ie("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ju(this,w2(this._delegate,e))}catch(t){throw nr(t,"collection()","Firestore.collection()")}}doc(e){try{return new ii(this,Bg(this._delegate,e))}catch(t){throw nr(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new tr(this,e$(this._delegate,e))}catch(t){throw nr(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return U$(this._delegate,t=>e(new q2(this,t)))}batch(){return Yn(this._delegate),new H2(new V$(this._delegate,e=>hp(this._delegate,e)))}loadBundle(e){return c$(this._delegate,e)}namedQuery(e){return u$(this._delegate,e).then(t=>t?new tr(this,t):null)}}class a_ extends _I{constructor(e){super(),this.firestore=e}convertBytes(e){return new U2(new zn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ii.forKey(t,this.firestore,null)}}function J$(n){D7(n)}class q2{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new a_(e)}get(e){const t=Al(e);return this._delegate.get(t).then(r=>new Pf(this._firestore,new si(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Al(e);return r?(wI("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Al(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Al(e);return this._delegate.delete(t),this}}class H2{constructor(e){this._delegate=e}set(e,t,r){const i=Al(e);return r?(wI("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Al(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Al(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Jl{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Jh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Df(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Jl.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Jl(e,new a_(e),t),i.set(t,s)),s}}Jl.INSTANCES=new WeakMap;class ii{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new a_(e)}static forPath(e,t,r){if(e.length%2!==0)throw new ie("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ii(t,new Ct(t._delegate,r,new me(e)))}static forKey(e,t,r){return new ii(t,new Ct(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ju(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ju(this.firestore,w2(this._delegate,e))}catch(t){throw nr(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ee(e),e instanceof Ct?T2(this._delegate,e):!1}set(e,t){t=wI("DocumentReference.set",t);try{return t?hk(this._delegate,e,t):hk(this._delegate,e)}catch(r){throw nr(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?fk(this._delegate,e):fk(this._delegate,e,t,...r)}catch(i){throw nr(i,"updateDoc()","DocumentReference.update()")}}delete(){return P$(this._delegate)}onSnapshot(...e){const t=G2(e),r=$2(e,i=>new Pf(this.firestore,new si(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return O2(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=A$(this._delegate):(e==null?void 0:e.source)==="server"?t=N$(this._delegate):t=C$(this._delegate),t.then(r=>new Pf(this.firestore,new si(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ii(this.firestore,e?this._delegate.withConverter(Jl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nr(n,e,t){return n.message=n.message.replace(e,t),n}function G2(n){for(const e of n)if(typeof e=="object"&&!L0(e))return e;return{}}function $2(n,e){var r,i;let t;return L0(n[0])?t=n[0]:L0(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:s=>{t.next&&t.next(e(s))},error:(r=t.error)==null?void 0:r.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class Pf{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ii(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return F2(this._delegate,e._delegate)}}class Df extends Pf{data(e){const t=this._delegate.data(e);return this._delegate._converter||M7(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class tr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new a_(e)}where(e,t,r){try{return new tr(this.firestore,Qo(this._delegate,g$(e,t,r)))}catch(i){throw nr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new tr(this.firestore,Qo(this._delegate,y$(e,t)))}catch(r){throw nr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new tr(this.firestore,Qo(this._delegate,_$(e)))}catch(t){throw nr(t,"limit()","Query.limit()")}}limitToLast(e){try{return new tr(this.firestore,Qo(this._delegate,v$(e)))}catch(t){throw nr(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new tr(this.firestore,Qo(this._delegate,w$(...e)))}catch(t){throw nr(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new tr(this.firestore,Qo(this._delegate,T$(...e)))}catch(t){throw nr(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new tr(this.firestore,Qo(this._delegate,E$(...e)))}catch(t){throw nr(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new tr(this.firestore,Qo(this._delegate,I$(...e)))}catch(t){throw nr(t,"endAt()","Query.endAt()")}}isEqual(e){return E2(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=R$(this._delegate):(e==null?void 0:e.source)==="server"?t=b$(this._delegate):t=k$(this._delegate),t.then(r=>new V0(this.firestore,new Ai(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=G2(e),r=$2(e,i=>new V0(this.firestore,new Ai(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return O2(this._delegate,t,r)}withConverter(e){return new tr(this.firestore,e?this._delegate.withConverter(Jl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Q${constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Df(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class V0{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new tr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Df(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Q$(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Df(this._firestore,r))})}isEqual(e){return F2(this._delegate,e._delegate)}}class Ju extends tr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ii(this.firestore,e):null}doc(e){try{return e===void 0?new ii(this.firestore,Bg(this._delegate)):new ii(this.firestore,Bg(this._delegate,e))}catch(t){throw nr(t,"doc()","CollectionReference.doc()")}}add(e){return D$(this._delegate,e).then(t=>new ii(this.firestore,t))}isEqual(e){return T2(this._delegate,e._delegate)}withConverter(e){return new Ju(this.firestore,e?this._delegate.withConverter(Jl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Al(n){return ct(n,Ct)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(...e){this._delegate=new Aa(...e)}static documentId(){return new TI(Ot.keyField().canonicalString())}isEqual(e){return e=Ee(e),e instanceof Aa?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{static serverTimestamp(){const e=q$();return e._methodName="FieldValue.serverTimestamp",new Tl(e)}static delete(){const e=B$();return e._methodName="FieldValue.delete",new Tl(e)}static arrayUnion(...e){const t=H$(...e);return t._methodName="FieldValue.arrayUnion",new Tl(t)}static arrayRemove(...e){const t=G$(...e);return t._methodName="FieldValue.arrayRemove",new Tl(t)}static increment(e){const t=$$(e);return t._methodName="FieldValue.increment",new Tl(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$={Firestore:B2,GeoPoint:Ci,Timestamp:pt,Blob:U2,Transaction:q2,WriteBatch:H2,DocumentReference:ii,DocumentSnapshot:Pf,Query:tr,QueryDocumentSnapshot:Df,QuerySnapshot:V0,CollectionReference:Ju,FieldPath:TI,FieldValue:Tl,setLogLevel:J$,CACHE_SIZE_UNLIMITED:n$};function X$(n,e){n.INTERNAL.registerComponent(new un("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...Y$}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z$(n){X$(n,(e,t)=>new B2(e,t,new K$)),n.registerVersion(j$,z$)}Z$(tn);const j2="@firebase/installations",EI="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2=1e4,W2=`w:${EI}`,K2="FIS_v2",ej="https://firebaseinstallations.googleapis.com/v1",tj=3600*1e3,nj="installations",rj="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ql=new vs(nj,rj,ij);function J2(n){return n instanceof Kn&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2({projectId:n}){return`${ej}/projects/${n}/installations`}function Y2(n){return{token:n.token,requestStatus:2,expiresIn:oj(n.expiresIn),creationTime:Date.now()}}async function X2(n,e){const r=(await e.json()).error;return Ql.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Z2({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function sj(n,{refreshToken:e}){const t=Z2(n);return t.append("Authorization",aj(e)),t}async function eL(n){const e=await n();return e.status>=500&&e.status<600?n():e}function oj(n){return Number(n.replace("s","000"))}function aj(n){return`${K2} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lj({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=Q2(n),i=Z2(n),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={fid:t,authVersion:K2,appId:n.appId,sdkVersion:W2},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await eL(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:Y2(d.authToken)}}else throw await X2("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj=/^[cdef][\w-]{21}$/,F0="";function dj(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=hj(n);return uj.test(t)?t:F0}catch{return F0}}function hj(n){return cj(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL=new Map;function rL(n,e){const t=l_(n);iL(t,e),fj(t,e)}function iL(n,e){const t=nL.get(n);if(t)for(const r of t)r(e)}function fj(n,e){const t=pj();t&&t.postMessage({key:n,fid:e}),mj()}let Nl=null;function pj(){return!Nl&&"BroadcastChannel"in self&&(Nl=new BroadcastChannel("[Firebase] FID Change"),Nl.onmessage=n=>{iL(n.data.key,n.data.fid)}),Nl}function mj(){nL.size===0&&Nl&&(Nl.close(),Nl=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj="firebase-installations-database",yj=1,Yl="firebase-installations-store";let yw=null;function II(){return yw||(yw=Xu(gj,yj,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Yl)}}})),yw}async function Hg(n,e){const t=l_(n),i=(await II()).transaction(Yl,"readwrite"),s=i.objectStore(Yl),o=await s.get(t);return await s.put(e,t),await i.done,(!o||o.fid!==e.fid)&&rL(n,e.fid),e}async function sL(n){const e=l_(n),r=(await II()).transaction(Yl,"readwrite");await r.objectStore(Yl).delete(e),await r.done}async function c_(n,e){const t=l_(n),i=(await II()).transaction(Yl,"readwrite"),s=i.objectStore(Yl),o=await s.get(t),l=e(o);return l===void 0?await s.delete(t):await s.put(l,t),await i.done,l&&(!o||o.fid!==l.fid)&&rL(n,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(n){let e;const t=await c_(n.appConfig,r=>{const i=_j(r),s=vj(n,i);return e=s.registrationPromise,s.installationEntry});return t.fid===F0?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function _j(n){const e=n||{fid:dj(),registrationStatus:0};return oL(e)}function vj(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Ql.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=wj(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Tj(n)}:{installationEntry:e}}async function wj(n,e){try{const t=await lj(n,e);return Hg(n.appConfig,t)}catch(t){throw J2(t)&&t.customData.serverCode===409?await sL(n.appConfig):await Hg(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Tj(n){let e=await gk(n.appConfig);for(;e.registrationStatus===1;)await tL(100),e=await gk(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await xI(n);return r||t}return e}function gk(n){return c_(n,e=>{if(!e)throw Ql.create("installation-not-found");return oL(e)})}function oL(n){return Ej(n)?{fid:n.fid,registrationStatus:0}:n}function Ej(n){return n.registrationStatus===1&&n.registrationTime+z2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij({appConfig:n,heartbeatServiceProvider:e},t){const r=xj(n,t),i=sj(n,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={installation:{sdkVersion:W2,appId:n.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await eL(()=>fetch(r,l));if(u.ok){const d=await u.json();return Y2(d)}else throw await X2("Generate Auth Token",u)}function xj(n,{fid:e}){return`${Q2(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(n,e=!1){let t;const r=await c_(n.appConfig,s=>{if(!aL(s))throw Ql.create("not-registered");const o=s.authToken;if(!e&&Aj(o))return s;if(o.requestStatus===1)return t=Sj(n,e),s;{if(!navigator.onLine)throw Ql.create("app-offline");const l=kj(s);return t=Cj(n,l),l}});return t?await t:r.authToken}async function Sj(n,e){let t=await yk(n.appConfig);for(;t.authToken.requestStatus===1;)await tL(100),t=await yk(n.appConfig);const r=t.authToken;return r.requestStatus===0?SI(n,e):r}function yk(n){return c_(n,e=>{if(!aL(e))throw Ql.create("not-registered");const t=e.authToken;return Rj(t)?{...e,authToken:{requestStatus:0}}:e})}async function Cj(n,e){try{const t=await Ij(n,e),r={...e,authToken:t};return await Hg(n.appConfig,r),t}catch(t){if(J2(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await sL(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Hg(n.appConfig,r)}throw t}}function aL(n){return n!==void 0&&n.registrationStatus===2}function Aj(n){return n.requestStatus===2&&!Nj(n)}function Nj(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+tj}function kj(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function Rj(n){return n.requestStatus===1&&n.requestTime+z2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(n){const e=n,{installationEntry:t,registrationPromise:r}=await xI(e);return r?r.catch(console.error):SI(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pj(n,e=!1){const t=n;return await Dj(t),(await SI(t,e)).token}async function Dj(n){const{registrationPromise:e}=await xI(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(n){if(!n||!n.options)throw _w("App Configuration");if(!n.name)throw _w("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw _w(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function _w(n){return Ql.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="installations",Lj="installations-internal",Vj=n=>{const e=n.getProvider("app").getImmediate(),t=Mj(e),r=iy(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Fj=n=>{const e=n.getProvider("app").getImmediate(),t=iy(e,lL).getImmediate();return{getId:()=>bj(t),getToken:i=>Pj(t,i)}};function Oj(){Tr(new un(lL,Vj,"PUBLIC")),Tr(new un(Lj,Fj,"PRIVATE"))}Oj();Vn(j2,EI);Vn(j2,EI,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj="/firebase-messaging-sw.js",Bj="/firebase-cloud-messaging-push-scope",cL="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",qj="https://fcmregistrations.googleapis.com/v1",uL="google.c.a.c_id",Hj="google.c.a.c_l",Gj="google.c.a.ts",$j="google.c.a.e",_k=1e4;var vk;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(vk||(vk={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Mf;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(Mf||(Mf={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jj(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="fcm_token_details_db",zj=5,wk="fcm_token_object_Store";async function Wj(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(vw))return null;let e=null;return(await Xu(vw,zj,{upgrade:async(r,i,s,o)=>{if(i<2||!r.objectStoreNames.contains(wk))return;const l=o.objectStore(wk),u=await l.index("fcmSenderId").get(n);if(await l.clear(),!!u){if(i===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Hs(d.vapidKey)}}}else if(i===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Hs(d.auth),p256dh:Hs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Hs(d.vapidKey)}}}else if(i===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Hs(d.auth),p256dh:Hs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Hs(d.vapidKey)}}}}}})).close(),await uu(vw),await uu("fcm_vapid_details_db"),await uu("undefined"),Kj(e)?e:null}function Kj(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj="firebase-messaging-database",Qj=1,Xl="firebase-messaging-store";let ww=null;function CI(){return ww||(ww=Xu(Jj,Qj,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Xl)}}})),ww}async function dL(n){const e=NI(n),r=await(await CI()).transaction(Xl).objectStore(Xl).get(e);if(r)return r;{const i=await Wj(n.appConfig.senderId);if(i)return await AI(n,i),i}}async function AI(n,e){const t=NI(n),i=(await CI()).transaction(Xl,"readwrite");return await i.objectStore(Xl).put(e,t),await i.done,e}async function Yj(n){const e=NI(n),r=(await CI()).transaction(Xl,"readwrite");await r.objectStore(Xl).delete(e),await r.done}function NI({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},sr=new vs("messaging","Messaging",Xj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zj(n,e){const t=await RI(n),r=fL(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(kI(n.appConfig),i)).json()}catch(o){throw sr.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw sr.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw sr.create("token-subscribe-no-token");return s.token}async function ez(n,e){const t=await RI(n),r=fL(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${kI(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw sr.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw sr.create("token-update-failed",{errorInfo:o})}if(!s.token)throw sr.create("token-update-no-token");return s.token}async function hL(n,e){const r={method:"DELETE",headers:await RI(n)};try{const s=await(await fetch(`${kI(n.appConfig)}/${e}`,r)).json();if(s.error){const o=s.error.message;throw sr.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw sr.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function kI({projectId:n}){return`${qj}/projects/${n}/registrations`}async function RI({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function fL({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==cL&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=10080*60*1e3;async function nz(n){const e=await sz(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Hs(e.getKey("auth")),p256dh:Hs(e.getKey("p256dh"))},r=await dL(n.firebaseDependencies);if(r){if(oz(r.subscriptionOptions,t))return Date.now()>=r.createTime+tz?iz(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await hL(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Tk(n.firebaseDependencies,t)}else return Tk(n.firebaseDependencies,t)}async function rz(n){const e=await dL(n.firebaseDependencies);e&&(await hL(n.firebaseDependencies,e.token),await Yj(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function iz(n,e){try{const t=await ez(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await AI(n.firebaseDependencies,r),t}catch(t){throw t}}async function Tk(n,e){const r={token:await Zj(n,e),createTime:Date.now(),subscriptionOptions:e};return await AI(n,r),r.token}async function sz(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jj(e)})}function oz(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return az(e,n),lz(e,n),cz(e,n),e}function az(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const s=e.notification.icon;s&&(n.notification.icon=s)}function lz(n,e){e.data&&(n.data=e.data)}function cz(n,e){var i,s,o,l;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((s=e.fcmOptions)==null?void 0:s.link)??((o=e.notification)==null?void 0:o.click_action);t&&(n.fcmOptions.link=t);const r=(l=e.fcmOptions)==null?void 0:l.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(n){return typeof n=="object"&&!!n&&uL in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dz(n){if(!n||!n.options)throw Tw("App Configuration Object");if(!n.name)throw Tw("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Tw(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Tw(n){return sr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hz=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=dz(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pL(n){try{n.swRegistration=await navigator.serviceWorker.register(Uj,{scope:Bj}),n.swRegistration.update().catch(()=>{}),await fz(n.swRegistration)}catch(e){throw sr.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function fz(n){return new Promise((e,t)=>{const r=setTimeout(()=>t(new Error(`Service worker not registered after ${_k} ms`)),_k),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=s=>{var o;((o=s.target)==null?void 0:o.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pz(n,e){if(!e&&!n.swRegistration&&await pL(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw sr.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mz(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=cL)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mL(n,e){if(!navigator)throw sr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw sr.create("permission-blocked");return await mz(n,e==null?void 0:e.vapidKey),await pz(n,e==null?void 0:e.serviceWorkerRegistration),nz(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gz(n,e,t){const r=yz(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[uL],message_name:t[Hj],message_time:t[Gj],message_device_time:Math.floor(Date.now()/1e3)})}function yz(n){switch(n){case Mf.NOTIFICATION_CLICKED:return"notification_open";case Mf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _z(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===Mf.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(Ek(t)):n.onMessageHandler.next(Ek(t)));const r=t.data;uz(r)&&r[$j]==="1"&&await gz(n,t.messageType,r)}const Ik="@firebase/messaging",xk="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=n=>{const e=new hz(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>_z(e,t)),e},wz=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>mL(e,r)}};function Tz(){Tr(new un("messaging",vz,"PUBLIC")),Tr(new un("messaging-internal",wz,"PRIVATE")),Vn(Ik,xk),Vn(Ik,xk,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ez(n){if(!navigator)throw sr.create("only-available-in-window");return n.swRegistration||await pL(n),rz(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(n,e){if(!navigator)throw sr.create("only-available-in-window");return n.onMessageHandler=e,()=>{n.onMessageHandler=null}}async function xz(n,e){return n=Ee(n),mL(n,e)}function Sz(n){return n=Ee(n),Ez(n)}function Cz(n,e){return n=Ee(n),Iz(n,e)}Tz();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Az="https://fcmregistrations.googleapis.com/v1",yL="FCM_MSG",Nz="google.c.a.c_id",kz=3,Rz=1;var Gg;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Gg||(Gg={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var $g;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})($g||($g={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bz(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="fcm_token_details_db",Pz=5,Sk="fcm_token_object_Store";async function Dz(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(Ew))return null;let e=null;return(await Xu(Ew,Pz,{upgrade:async(r,i,s,o)=>{if(i<2||!r.objectStoreNames.contains(Sk))return;const l=o.objectStore(Sk),u=await l.index("fcmSenderId").get(n);if(await l.clear(),!!u){if(i===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Gs(d.vapidKey)}}}else if(i===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Gs(d.auth),p256dh:Gs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Gs(d.vapidKey)}}}else if(i===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Gs(d.auth),p256dh:Gs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Gs(d.vapidKey)}}}}}})).close(),await uu(Ew),await uu("fcm_vapid_details_db"),await uu("undefined"),Mz(e)?e:null}function Mz(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lz="firebase-messaging-database",Vz=1,Zl="firebase-messaging-store";let Iw=null;function bI(){return Iw||(Iw=Xu(Lz,Vz,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Zl)}}})),Iw}async function PI(n){const e=MI(n),r=await(await bI()).transaction(Zl).objectStore(Zl).get(e);if(r)return r;{const i=await Dz(n.appConfig.senderId);if(i)return await DI(n,i),i}}async function DI(n,e){const t=MI(n),i=(await bI()).transaction(Zl,"readwrite");return await i.objectStore(Zl).put(e,t),await i.done,e}async function Fz(n){const e=MI(n),r=(await bI()).transaction(Zl,"readwrite");await r.objectStore(Zl).delete(e),await r.done}function MI({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},hs=new vs("messaging","Messaging",Oz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uz(n,e){const t=await VI(n),r=vL(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(LI(n.appConfig),i)).json()}catch(o){throw hs.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw hs.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw hs.create("token-subscribe-no-token");return s.token}async function Bz(n,e){const t=await VI(n),r=vL(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${LI(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw hs.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw hs.create("token-update-failed",{errorInfo:o})}if(!s.token)throw hs.create("token-update-no-token");return s.token}async function _L(n,e){const r={method:"DELETE",headers:await VI(n)};try{const s=await(await fetch(`${LI(n.appConfig)}/${e}`,r)).json();if(s.error){const o=s.error.message;throw hs.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw hs.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function LI({projectId:n}){return`${Az}/projects/${n}/registrations`}async function VI({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function vL({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==gL&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz=10080*60*1e3;async function Hz(n){const e=await $z(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Gs(e.getKey("auth")),p256dh:Gs(e.getKey("p256dh"))},r=await PI(n.firebaseDependencies);if(r){if(jz(r.subscriptionOptions,t))return Date.now()>=r.createTime+qz?Gz(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await _L(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Ak(n.firebaseDependencies,t)}else return Ak(n.firebaseDependencies,t)}async function Ck(n){const e=await PI(n.firebaseDependencies);e&&(await _L(n.firebaseDependencies,e.token),await Fz(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function Gz(n,e){try{const t=await Bz(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await DI(n.firebaseDependencies,r),t}catch(t){throw t}}async function Ak(n,e){const r={token:await Uz(n,e),createTime:Date.now(),subscriptionOptions:e};return await DI(n,r),r.token}async function $z(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:bz(e)})}function jz(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return Wz(e,n),Kz(e,n),Jz(e,n),e}function Wz(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const s=e.notification.icon;s&&(n.notification.icon=s)}function Kz(n,e){e.data&&(n.data=e.data)}function Jz(n,e){var i,s,o,l;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((s=e.fcmOptions)==null?void 0:s.link)??((o=e.notification)==null?void 0:o.click_action);t&&(n.fcmOptions.link=t);const r=(l=e.fcmOptions)==null?void 0:l.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(n){return typeof n=="object"&&!!n&&Nz in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yz(n){return new Promise(e=>{setTimeout(e,n)})}async function Xz(n,e){const t=Zz(e,await n.firebaseDependencies.installations.getId());eW(n,t,e.productId)}function Zz(n,e){var r,i;const t={};return n.from&&(t.project_number=n.from),n.fcmMessageId&&(t.message_id=n.fcmMessageId),t.instance_id=e,n.notification?t.message_type=Gg.DISPLAY_NOTIFICATION.toString():t.message_type=Gg.DATA_MESSAGE.toString(),t.sdk_platform=kz.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),n.collapse_key&&(t.collapse_key=n.collapse_key),t.event=Rz.toString(),(r=n.fcmOptions)!=null&&r.analytics_label&&(t.analytics_label=(i=n.fcmOptions)==null?void 0:i.analytics_label),t}function eW(n,e,t){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(r.compliance_data=tW(t)),n.logEvents.push(r)}function tW(n){return{privacy_context:{prequest:{origin_associated_product_id:n}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nW(n,e){var i;const{newSubscription:t}=n;if(!t){await Ck(e);return}const r=await PI(e.firebaseDependencies);await Ck(e),e.vapidKey=((i=r==null?void 0:r.subscriptionOptions)==null?void 0:i.vapidKey)??gL,await Hz(e)}async function rW(n,e){const t=oW(n);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await Xz(e,t);const r=await wL();if(lW(r))return cW(r,t);if(t.notification&&await uW(sW(t)),!!e&&e.onBackgroundMessageHandler){const i=zz(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(i):e.onBackgroundMessageHandler.next(i)}}async function iW(n){var o,l;const e=(l=(o=n.notification)==null?void 0:o.data)==null?void 0:l[yL];if(e){if(n.action)return}else return;n.stopImmediatePropagation(),n.notification.close();const t=dW(e);if(!t)return;const r=new URL(t,self.location.href),i=new URL(self.location.origin);if(r.host!==i.host)return;let s=await aW(r);if(s?s=await s.focus():(s=await self.clients.openWindow(t),await Yz(3e3)),!!s)return e.messageType=$g.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,s.postMessage(e)}function sW(n){const e={...n.notification};return e.data={[yL]:n},e}function oW({data:n}){if(!n)return null;try{return n.json()}catch{return null}}async function aW(n){const e=await wL();for(const t of e){const r=new URL(t.url,self.location.href);if(n.host===r.host)return t}return null}function lW(n){return n.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function cW(n,e){e.isFirebaseMessaging=!0,e.messageType=$g.PUSH_RECEIVED;for(const t of n)t.postMessage(e)}function wL(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function uW(n){const{actions:e}=n,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(n.title??"",n)}function dW(n){var t,r;const e=((t=n.fcmOptions)==null?void 0:t.link)??((r=n.notification)==null?void 0:r.click_action);return e||(Qz(n.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hW(n){if(!n||!n.options)throw xw("App Configuration Object");if(!n.name)throw xw("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw xw(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function xw(n){return hs.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fW{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=hW(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW=n=>{const e=new fW(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(rW(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(nW(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(iW(t))}),e};function mW(){Tr(new un("messaging-sw",pW,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(n,e){if(self.document!==void 0)throw hs.create("only-available-in-sw");return n.onBackgroundMessageHandler=e,()=>{n.onBackgroundMessageHandler=null}}function yW(n,e){return n=Ee(n),gW(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mW();const _W="@firebase/messaging-compat",vW="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wW(){return self&&"ServiceWorkerGlobalScope"in self?EW():TW()}function TW(){return typeof window<"u"&&Dl()&&o5()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function EW(){return Dl()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class Nk{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return xz(this._delegate,e)}async deleteToken(){return Sz(this._delegate)}onMessage(e){return Cz(this._delegate,e)}onBackgroundMessage(e){return yW(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW=n=>self&&"ServiceWorkerGlobalScope"in self?new Nk(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging-sw").getImmediate()):new Nk(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging").getImmediate()),xW={isSupported:wW};function SW(){tn.INTERNAL.registerComponent(new un("messaging-compat",IW,"PUBLIC").setServiceProps(xW))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */SW();tn.registerVersion(_W,vW);const CW={apiKey:"AIzaSyAsAmByLvLqfFAKPiAeen0UJWdjT9MnTxQ",authDomain:"antamvieclam.firebaseapp.com",projectId:"antamvieclam",storageBucket:"antamvieclam.appspot.com",messagingSenderId:"221272132411",appId:"1:221272132411:web:83f7ab86a08823f3c8451e",measurementId:"G-2PT3C0KQWB",databaseURL:"https://antamvieclam-default-rtdb.asia-southeast1.firebasedatabase.app"};tn.apps.length?tn.app():tn.initializeApp(CW);const _h=tn.auth(),Ye=tn.firestore(),kk=tn.messaging(),O0=tn.database(),io=tn.firestore.FieldValue.serverTimestamp,AW=tn.firestore.FieldValue.arrayUnion,NW=tn.firestore.FieldValue.increment,kW="BC0S6kKANv-QpY1c-5rXw1Xg_WfH3Z7T6t_g8C6Z4-F8r4w8S9tQ8n7w6X3Z7f7b5t3b3Y5F-E1d0D9k8H",RW=async n=>{console.log("Requesting notification permission...");try{await Notification.requestPermission()==="granted"?(console.log("Notification permission granted."),await bW(n)):console.log("Unable to get permission to notify.")}catch(e){console.error("An error occurred while requesting permission:",e)}},bW=async n=>{try{const e=await kk.getToken({vapidKey:kW});e?(console.log("FCM Token:",e),await Ye.collection("users").doc(n).update({fcmTokens:AW(e)}),console.log("FCM token saved for user:",n),kk.onMessage(r=>{var i,s;console.log("Foreground message received. ",r),alert(`Tin nhn mi t ${(i=r.notification)==null?void 0:i.title}:
${(s=r.notification)==null?void 0:s.body}`)})):console.log("No registration token available. Request permission to generate one.")}catch(e){console.error("An error occurred while retrieving token:",e)}},FI=async(n,e,t,r)=>{try{await Ye.collection("notifications").add({userId:n,type:e,message:t,link:r,isRead:!1,createdAt:io()})}catch(i){console.error("Error creating notification:",i)}},PW=(n,e)=>Ye.collection("notifications").where("userId","==",n).onSnapshot(s=>{const o=[];s.forEach(l=>{var p;const u=l.data(),d=(p=u.createdAt)!=null&&p.toDate?u.createdAt.toDate().toISOString():new Date().toISOString();o.push({id:l.id,...u,createdAt:d})}),o.sort((l,u)=>new Date(u.createdAt).getTime()-new Date(l.createdAt).getTime()),e(o)},s=>{console.error("Error fetching notifications:",s),e([])}),DW=async n=>{await Ye.collection("notifications").doc(n).update({isRead:!0})},MW=async(n,e)=>{const t=e.filter(i=>!i.isRead);if(t.length===0)return;const r=Ye.batch();t.forEach(i=>{const s=Ye.collection("notifications").doc(i.id);r.update(s,{isRead:!0})}),await r.commit()},LW=n=>{const e=O0.ref(`/status/${n}`),t={isOnline:!0,lastSeen:tn.database.ServerValue.TIMESTAMP},r={isOnline:!1,lastSeen:tn.database.ServerValue.TIMESTAMP},i=O0.ref(".info/connected"),s=i.on("value",o=>{o.val()!==!1&&e.onDisconnect().set(r).then(()=>{e.set(t)})});return()=>{i.off("value",s),e.set(r)}},TL=Q.createContext(void 0),po=()=>{const n=Q.useContext(TL);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},VW=({children:n})=>{const[e,t]=Q.useState(null),[r,i]=Q.useState(null),[s,o]=Q.useState(!0),l=async A=>{var j;if(!A){i(null);return}const L=await Ye.collection("users").doc(A.uid).get();if(L.exists){const B=L.data(),q=(j=B.createdAt)!=null&&j.toDate?B.createdAt.toDate().toISOString():new Date().toISOString(),K={uid:B.uid,email:B.email,userType:B.userType,createdAt:q,fullName:B.fullName,phoneNumber:B.phoneNumber,address:B.address,profileImageUrl:B.profileImageUrl,fcmTokens:B.fcmTokens||[],bio:B.bio||"",skills:B.skills||[],workHistory:B.workHistory||[],cvUrl:B.cvUrl||null,cvName:B.cvName||null};i(K)}else console.log("No such user document!"),i(null)},u=Q.useCallback(async()=>{e&&await l(e)},[e]),d=async(A,R,L)=>{const j=await _h.createUserWithEmailAndPassword(A,R),{user:B}=j;if(!B)throw new Error("User creation failed.");return await Ye.collection("users").doc(B.uid).set({uid:B.uid,email:B.email,userType:L,createdAt:io(),fullName:null,phoneNumber:null,address:null,profileImageUrl:null,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}),j},p=(A,R)=>_h.signInWithEmailAndPassword(A,R),v=()=>_h.signOut(),w=async()=>{const A=new tn.auth.GoogleAuthProvider;try{await _h.signInWithPopup(A)}catch(R){throw console.error("Error with Google Sign-in Popup:",R),R}};Q.useEffect(()=>{let A;const R=_h.onAuthStateChanged(async L=>{A&&(A(),A=void 0),t(L),L?(await l(L),await RW(L.uid),A=LW(L.uid)):i(null),o(!1)});return()=>{R(),A&&A()}},[]);const x={currentUser:e,currentUserData:r,loading:s,signup:d,login:p,logout:v,loginWithGoogle:w,refetchUserData:u};return y.jsx(TL.Provider,{value:x,children:!s&&n})},FW=async n=>{const{workerId:e,employerId:t}=n,r=[e,t].sort(),i=r.join("_"),s=Ye.collection("conversations").doc(i);if(!(await s.get()).exists){const l={[e]:{fullName:n.workerName,profileImageUrl:n.workerProfileImageUrl||null},[t]:{fullName:n.employerName,profileImageUrl:n.employerProfileImageUrl||null}},u={[e]:0,[t]:0};await s.set({id:i,participants:r,participantInfo:l,lastMessage:`Bt u tr chuyn v cng vic: ${n.jobTitle}`,lastMessageTimestamp:io(),unreadCounts:u})}return i},EL=(n,e)=>Ye.collection("conversations").where("participants","array-contains",n).onSnapshot(s=>{const o=[];s.forEach(l=>{var p;const u=l.data(),d=(p=u.lastMessageTimestamp)!=null&&p.toDate?u.lastMessageTimestamp.toDate().toISOString():new Date().toISOString();o.push({id:l.id,...u,lastMessageTimestamp:d})}),o.sort((l,u)=>new Date(u.lastMessageTimestamp||0).getTime()-new Date(l.lastMessageTimestamp||0).getTime()),e(o)},s=>{console.error("Error fetching conversations:",s),e([])}),OW=(n,e)=>Ye.collection("conversations").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(s=>{const o=[];s.forEach(l=>{var p;const u=l.data(),d=(p=u.timestamp)!=null&&p.toDate?u.timestamp.toDate().toISOString():new Date().toISOString();o.push({id:l.id,conversationId:n,...u,timestamp:d})}),e(o)},s=>{console.error("Error fetching messages:",s),e([])}),UW=async(n,e,t,r)=>{if(!r.trim())return;await Ye.collection("conversations").doc(n).collection("messages").add({senderId:e,text:r,timestamp:io(),status:"sent",deleted:!1});const s=Ye.collection("conversations").doc(n),o=await s.get();if(o.exists){const u=o.data().participants.find(d=>d!==e);if(u){const d={lastMessage:r,lastMessageTimestamp:io(),[`unreadCounts.${u}`]:NW(1)};await s.update(d)}}},BW=async(n,e)=>{const t=Ye.collection("conversations").doc(n);try{await t.update({[`unreadCounts.${e}`]:0})}catch(r){console.error("Error marking conversation as read:",r)}},qW=async(n,e)=>{const r=Ye.collection("conversations").doc(n).collection("messages").where("senderId","!=",e).where("status","==","sent");try{const i=await r.get();if(i.empty)return;const s=Ye.batch();i.forEach(o=>{s.update(o.ref,{status:"read"})}),await s.commit()}catch(i){console.error("Error marking messages as read:",i)}},HW=async(n,e,t,r)=>{if(t!==r)throw new Error("You can only delete your own messages.");await Ye.collection("conversations").doc(n).collection("messages").doc(e).update({text:"Tin nhn ny  c thu hi.",deleted:!0})},GW=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 2a2 2 0 00-2 2v1h4V4a2 2 0 00-2-2zM4 7v1h12V7a1 1 0 00-1-1H5a1 1 0 00-1 1zm0 3v7a1 1 0 001 1h10a1 1 0 001-1v-7H4z",clipRule:"evenodd"})}),$W=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M12.016 2.002c-5.523 0-9.984 4.47-9.984 9.998 0 3.803 2.12 7.126 5.234 8.786a.75.75 0 00.98-.103l.055-.065a.75.75 0 00-.03-1.06l-1.29-1.29a.75.75 0 01-.217-.53v-3.384a3.75 3.75 0 016.48-2.457.75.75 0 001.353-.646A3.75 3.75 0 0118 9.75v3.384a.75.75 0 01-.217.53l-1.29 1.29a.75.75 0 00-.03 1.06l.055.065a.75.75 0 00.98.103c3.113-1.66 5.234-4.983 5.234-8.786C22 6.472 17.539 2.002 12.016 2.002zM8.982 13.24a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l4.5-4.5a.75.75 0 00-1.06-1.06L10.5 14.94l-1.518-1.518z",clipRule:"evenodd"})}),jW=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:y.jsx("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})}),zW=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.774.182 1.584.279 2.417.279 5.352 0 9.75-4.348 9.75-9.75S17.352 2.25 12 2.25 2.25 6.598 2.25 12c0 1.752.47 3.419 1.305 4.804l-1.125 4.498a.75.75 0 00.916.916l4.498-1.125zM8.25 12a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H9a.75.75 0 01-.75-.75zm3.75 0a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H12.75a.75.75 0 01-.75-.75zm3-1.5a.75.75 0 000 1.5h.01a.75.75 0 000-1.5H15z",clipRule:"evenodd"})}),WW=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",clipRule:"evenodd"})}),KW=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:y.jsx("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 01.721.544l.813 2.846a3.75 3.75 0 002.576 2.576l2.846.813a.75.75 0 010 1.442l-2.846.813a3.75 3.75 0 00-2.576 2.576l-.813 2.846a.75.75 0 01-1.442 0l-.813-2.846a3.75 3.75 0 00-2.576-2.576l-2.846-.813a.75.75 0 010-1.442l2.846-.813a3.75 3.75 0 002.576-2.576l.813-2.846A.75.75 0 019 4.5zM18 1.5a.75.75 0 01.728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 010 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 01-1.456 0l-.258-1.036a2.625 2.625 0 00-1.91-1.91l-1.036-.258a.75.75 0 010-1.456l1.036-.258a2.625 2.625 0 001.91-1.91l.258-1.036A.75.75 0 0118 1.5zM16.5 15a.75.75 0 01.712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 010 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 01-1.422 0l-.395-1.183a1.5 1.5 0 00-.948-.948l-1.183-.395a.75.75 0 010-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0116.5 15z",clipRule:"evenodd"})}),JW=({icon:n,activeIcon:e,label:t,isActive:r,onClick:i,hasUnread:s=!1})=>y.jsxs("button",{onClick:i,className:`relative flex flex-col items-center justify-center space-y-1 w-full p-2 rounded-lg transition-colors duration-200 ${r?"text-indigo-600 bg-indigo-50":"text-gray-500 hover:bg-gray-100"}`,children:[r?e:n,y.jsx("span",{className:"text-[10px] font-medium text-center leading-tight",children:t}),s&&y.jsx("span",{className:"absolute top-1 right-3 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),QW=({label:n,isActive:e,onClick:t,hasUnread:r=!1})=>y.jsxs("button",{onClick:t,className:`relative px-3 py-2 rounded-md text-sm transition-colors duration-200 ${e?"text-indigo-600 font-semibold":"text-gray-600 hover:text-indigo-600 font-medium"}`,children:[n,e&&y.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-5 h-0.5 bg-indigo-600 rounded-full"}),r&&y.jsx("span",{className:"absolute top-1 right-0 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),YW=({activeView:n,setActiveView:e,onPostJobClick:t,onNotificationNavigate:r})=>{const{currentUser:i,currentUserData:s,logout:o}=po(),[l,u]=Q.useState([]),[d,p]=Q.useState(!1),[v,w]=Q.useState(0),x=l.filter(B=>!B.isRead).length;Q.useEffect(()=>{if(i){const B=PW(i.uid,u),q=EL(i.uid,K=>{const te=K.reduce((ee,P)=>{var k;return ee+(((k=P.unreadCounts)==null?void 0:k[i.uid])||0)},0);w(te)});return()=>{B(),q()}}},[i]);const A=async()=>{try{await o()}catch(B){console.error("Failed to log out",B)}},R=B=>{DW(B.id),r(B.link),p(!1)},L=()=>{i&&MW(i.uid,l)};let j=[{view:Tn.Jobs,label:"Tm Vic",icon:y.jsx(fs,{className:"w-6 h-6"}),activeIcon:y.jsx(GW,{className:"w-6 h-6"})},{view:Tn.Insurance,label:"Bo Him",icon:y.jsx(Ks,{className:"w-6 h-6"}),activeIcon:y.jsx($W,{className:"w-6 h-6"})},{view:Tn.Messaging,label:"Tin Nhn",icon:y.jsx(ey,{className:"w-6 h-6"}),activeIcon:y.jsx(jW,{className:"w-6 h-6"}),hasUnread:v>0},{view:Tn.Chatbot,label:"Hi p",icon:y.jsx(qF,{className:"w-6 h-6"}),activeIcon:y.jsx(zW,{className:"w-6 h-6"})},{view:Tn.Profile,label:"H S",icon:y.jsx(Cw,{className:"w-6 h-6"}),activeIcon:y.jsx(WW,{className:"w-6 h-6"})}];return(s==null?void 0:s.userType)===$t.Worker&&j.splice(1,0,{view:Tn.Recommendations,label:"Gi  AI",icon:y.jsx(Yo,{className:"w-6 h-6"}),activeIcon:y.jsx(KW,{className:"w-6 h-6"})}),y.jsxs(y.Fragment,{children:[y.jsx("header",{className:"hidden md:block sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-200",children:y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:y.jsxs("div",{className:"flex items-center justify-between h-20",children:[y.jsxs("div",{className:"flex items-center space-x-10",children:[y.jsxs("button",{onClick:()=>e(Tn.Jobs),className:"flex items-center flex-shrink-0 group",children:[y.jsx(Ks,{className:"h-8 w-8 text-indigo-600 group-hover:animate-pulse"}),y.jsx("h1",{className:"ml-3 text-2xl font-bold text-gray-800",children:"An Tm Vic Lm"})]}),y.jsx("nav",{className:"flex items-baseline space-x-2 lg:space-x-4",children:j.map(B=>y.jsx(QW,{label:B.label,isActive:n===B.view,onClick:()=>e(B.view),hasUnread:B.hasUnread},B.view))})]}),i&&s&&y.jsxs("div",{className:"flex items-center space-x-4",children:[s.userType===$t.Employer&&y.jsxs("button",{onClick:t,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[y.jsx(Aw,{className:"w-5 h-5 mr-2"}),"ng tin"]}),y.jsx("div",{className:"relative",children:y.jsxs("button",{onClick:()=>p(B=>!B),className:"p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Thng bo",children:[y.jsx(HF,{}),x>0&&y.jsx("span",{className:"absolute top-1 right-1 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]})}),y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsxs("span",{className:"text-sm text-gray-600 text-right hidden lg:block",children:["Cho, ",y.jsx("span",{className:"font-semibold",children:s.fullName||i.email})]}),s.profileImageUrl?y.jsx("img",{src:s.profileImageUrl,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover"}):y.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:y.jsx(Cw,{className:"w-6 h-6 text-gray-500"})})]}),y.jsx("button",{onClick:A,className:"text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors",children:"ng xut"})]})]})})}),y.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.05)]",children:y.jsx("div",{className:"max-w-7xl mx-auto px-2",children:y.jsx("nav",{className:`grid grid-cols-${j.length} gap-1 h-full items-center p-1.5`,children:j.map(B=>y.jsx(JW,{icon:B.icon,activeIcon:B.activeIcon,label:B.label,isActive:n===B.view,onClick:()=>e(B.view),hasUnread:B.hasUnread},B.view))})})}),i&&(s==null?void 0:s.userType)===$t.Employer&&y.jsx("div",{className:"md:hidden fixed bottom-20 right-4 z-50",children:y.jsx("button",{onClick:t,className:"bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"ng tin tuyn dng mi",children:y.jsx(Aw,{className:"w-8 h-8"})})}),d&&y.jsx($F,{notifications:l,onNotificationClick:R,onMarkAllAsRead:L,onClose:()=>p(!1)})]})},XW=n=>{if(typeof n=="string")return n;try{return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n)}catch{return`${n} VN`}},IL=(n,e)=>{if(n==="Tha thun")return"Tha thun";const t=XW(n);switch(e){case"THEO GI":return`${t}/gi`;case"THEO NGY":return`${t}/ngy`;case"THEO THNG":return`${t}/thng`;default:return t}},jg=n=>{if(!n||typeof n!="string")return null;try{const e=n.match(/\[\s*(-?\d+\.?\d*)\s*\s*N,\s*(-?\d+\.?\d*)\s*\s*E\s*\]/);if(e&&e.length===3){const t=parseFloat(e[1]),r=parseFloat(e[2]);if(!isNaN(t)&&!isNaN(r))return{lat:t,lng:r}}return null}catch(e){return console.error("Error parsing location string:",n,e),null}},xL=(n,e,t,r)=>{const s=(t-n)*(Math.PI/180),o=(r-e)*(Math.PI/180),l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n*(Math.PI/180))*Math.cos(t*(Math.PI/180))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},OI=(n,e="post")=>{const t=new Date,r=new Date(n),i=Math.floor((t.getTime()-r.getTime())/1e3);if(i<5)return e==="presence"?"vi giy trc":"va xong";if(i<60)return`${i} giy trc`;const s=Math.floor(i/60);if(s<60)return`${s} pht trc`;const o=Math.floor(s/60);if(o<24)return`${o} gi trc`;const l=Math.floor(o/24);return l===1?"hm qua":l<7?`${l} ngy trc`:new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)},ZW=({className:n="w-5 h-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),ia=({className:n="w-8 h-8"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-3.96 0-7.25 3.29-7.25 7.353 0 4.434 5.333 11.235 6.75 12.83a.75.75 0 001.002 0c1.417-1.595 6.75-8.396 6.75-12.83C19.25 5.543 15.96 2.25 12 2.25zM12 12a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z",clipRule:"evenodd"})}),SL=({className:n="w-5 h-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),eK=({className:n="w-5 h-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})}),tK=({job:n,onClick:e,applicantCount:t})=>{const r=n.status==="CLOSED",i=s=>{s.stopPropagation();const o="nguyenduyphuc0119@gmail.com",l=encodeURIComponent(`Bo co tin tuyn dng: ${n.title}`),u=encodeURIComponent(`Knh gi Ban qun tr An Tm Vic Lm,

Ti mun bo co tin tuyn dng sau v ni dung khng chnh xc hoc khng ph hp:

- ID Cng vic: ${n.id}
- Tiu : ${n.title}
- Nh tuyn dng: ${n.employerName}

L do bo co:
(Vui lng nhp l do ca bn ti y)

Trn trng.`);window.location.href=`mailto:${o}?subject=${l}&body=${u}`};return y.jsxs("div",{onClick:e,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&e()},className:`bg-white p-5 rounded-xl border border-gray-200 flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-5 transition-all duration-300 ${r?"opacity-60":"hover:shadow-lg hover:border-indigo-300 cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transform hover:-translate-y-1"}`,role:"button",tabIndex:0,"aria-label":`Xem chi tit cng vic ${n.title} ti ${n.employerName}`,children:[n.employerProfileUrl?y.jsx("img",{src:n.employerProfileUrl,alt:`${n.employerName} logo`,className:"w-20 h-20 rounded-lg object-cover flex-shrink-0"}):y.jsx("div",{className:"w-20 h-20 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0",children:y.jsx(fs,{className:"w-10 h-10 text-gray-400"})}),y.jsxs("div",{className:"flex-grow flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{className:"flex-grow",children:[y.jsx("h3",{className:"font-bold text-lg text-gray-800",children:n.title}),y.jsx("p",{className:"text-sm text-gray-600",children:n.employerName})]}),y.jsxs("div",{className:"flex items-center text-xs text-gray-500 flex-shrink-0 ml-4 pt-1",title:`ng vo ${new Date(n.createdAt).toLocaleString("vi-VN")}`,children:[y.jsx(SL,{className:"w-4 h-4 mr-1"}),y.jsx("span",{children:OI(n.createdAt)})]})]}),y.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.addressString}),y.jsxs("div",{className:"mt-3 flex items-center justify-between pt-3 border-t border-gray-100 sm:mt-auto flex-wrap gap-y-2",children:[y.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[y.jsx("span",{className:"text-sm font-semibold text-green-700 bg-green-100 px-3 py-1 rounded-full",children:IL(n.payRate,n.payType)}),n.distance!==void 0&&y.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`Khong cch c tnh ${n.distance.toFixed(1)} km`,children:[y.jsx(ia,{className:"w-4 h-4 mr-1 text-gray-500"}),y.jsxs("span",{children:[n.distance.toFixed(1)," km"]})]}),t>0&&y.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`${t} ngi  ng tuyn`,children:[y.jsx(ZW,{className:"w-4 h-4 mr-1 text-gray-500"}),y.jsx("span",{children:t})]}),n.jobType&&y.jsx("span",{className:"text-xs text-indigo-700 font-medium bg-indigo-100 px-3 py-1 rounded-full",children:n.jobType}),r?y.jsx("span",{className:"text-xs font-medium text-gray-700 bg-gray-200 px-3 py-1 rounded-full",children:" ng"}):y.jsx("span",{className:"text-xs font-medium text-green-700 bg-green-100 px-3 py-1 rounded-full",children:"ang tuyn"})]}),y.jsxs("button",{onClick:i,className:"flex items-center text-xs font-medium text-gray-400 hover:text-red-500 transition-colors p-1 rounded",title:"Bo co tin tuyn dng ny","aria-label":"Bo co tin tuyn dng",children:[y.jsx(eK,{className:"w-4 h-4 mr-1"}),"Bo xu"]})]})]})]})},CL={points:250,pointsGoal:1e3,pointsRewardVND:5e5,autoDeductEnabled:!0,autoDeductAccumulatedThisMonth:15e4},nK=`
BN L TR L AI CA NN TNG "AN TM VIC LM".

MC TIU CA NN TNG:
"An Tm Vic Lm" l mt nn tng s c to ra vi s mnh h tr cng ng lao ng t do ti Vit Nam. Chng ti gii quyt hai vn  ln:
1.  **Vic lm:** Gip ngi lao ng d dng tm thy cc cng vic thi v, bn thi gian, hoc linh hot  gn h mt cch an ton v minh bch.
2.  **An sinh x hi:** Khuyn khch v to iu kin  ngi lao ng tham gia bo him x hi (BHXH) t nguyn, m bo h c lng hu v s n nh khi v gi.

CHC NNG CHNH:
-   **Tm vic:** Ngi lao ng tm vic, nh tuyn dng ng tin.
-   **Bo him:** Cung cp thng tin v cc cng c  ngi lao ng tch ly cho BHXH t nguyn v tham kho cc sn phm bo him b sung.
-   **Hi p (Chatbot):** Bn, tr l AI, gip gii p cc thc mc lin quan n vic lm, bo him v cch s dng nn tng.

HY S DNG BI CNH DI Y  TR LI CU HI CA NGI DNG MT CCH CHNH XC NHT.
`.trim(),u_=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),AL=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-4.5 0V6.75a.75.75 0 01.75-.75h3.75a.75.75 0 01.75.75v3.75M13.5 6l5.25 5.25"})}),rK=({onClose:n})=>y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:n,"aria-modal":"true",role:"dialog",children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden relative animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:t=>t.stopPropagation(),children:[y.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"ng",children:y.jsx(u_,{className:"w-6 h-6"})}),y.jsxs("div",{className:"p-8 text-center",children:[y.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:y.jsx(Ks,{className:"w-8 h-8 text-indigo-600"})}),y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Chuyn n Cng Dch v cng"}),y.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Bn s c chuyn hng n trang web chnh thc ca Bo him X hi Vit Nam  thc hin thanh ton mt cch an ton."}),y.jsxs("a",{href:"https://dichvucong.baohiemxahoi.gov.vn/#/index?login=1&url=%2Fthanh-toan-bhxh-dien-tu%2Fngan-hang-lien-ket&queryUrl=",target:"_blank",rel:"noopener noreferrer",className:"mt-6 w-full inline-flex items-center justify-center bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 shadow-sm",children:["Tip tc n trang thanh ton",y.jsx(AL,{className:"w-5 h-5 ml-2"})]}),y.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Lu : Bn s cn ng nhp vo ti khon BHXH ca mnh trn cng dch v cng."})]})]})}),NL=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),Rk=({className:n="w-6 h-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 01-3 0m3 0h1.5M15.75 18.75a1.5 1.5 0 01-3 0m3 0h1.5m-9-1.5H5.625c-.621 0-1.125-.504-1.125-1.125V11.25c0-.621.504-1.125 1.125-1.125h12.75c.621 0 1.125.504 1.125 1.125v4.875c0 .621-.504 1.125-1.125 1.125H12M5.25 12.75v-1.5m13.5 1.5v-1.5"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 12.75h13.5m-13.5 0a3 3 0 003 3h7.5a3 3 0 003-3"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 9.75h13.5"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 4.5l-2.25 2.25"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 4.5l2.25 2.25"})]}),bk=({className:n="w-6 h-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.5c0 1.242-1.008 2.25-2.25 2.25S16.5 17.742 16.5 16.5 17.508 14.25 18.75 14.25 21 15.258 21 16.5z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5c0 1.242-1.008 2.25-2.25 2.25S3 17.742 3 16.5 4.008 14.25 5.25 14.25 7.5 15.258 7.5 16.5z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5h9"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 16.5v-4.5a1.5 1.5 0 011.5-1.5h1.5v-1.5H12a3 3 0 00-3 3v4.5"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9l2.25 3h3.75"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 6.75l-.75-1.5"})]}),Zm=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),kL=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),iK=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21V11.25m0-1.01V8.25m0 5.25v5.25m0-5.25H4.5m7.5 0H19.5M3.75 11.25h16.5M4.5 21h15M3 11.25a.75.75 0 01.75-.75h16.5a.75.75 0 01.75.75v9a.75.75 0 01-.75.75H3.75a.75.75 0 01-.75-.75v-9z"})}),Pk=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955a.75.75 0 011.06 0l8.955 8.955a.75.75 0 01-1.06 1.06l-1.72-1.72V21a.75.75 0 01-.75.75H5.25a.75.75 0 01-.75-.75V11.34l-1.72 1.72a.75.75 0 01-1.06-1.06z"})}),sK=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.18-3.185m-3.18-3.182a8.25 8.25 0 00-11.664 0l-3.182 3.182"})}),oK=[{title:"BH xe my bt buc",description:"Bo v trch nhim dn s ca bn khi tham gia giao thng.",link:"https://motor-civil.globalcare.vn/293f4359&skip-password=1?token=2306244fxozgmotc",icon:y.jsx(bk,{className:"w-7 h-7 text-gray-700"})},{title:"BH  t bt buc",description:"Yn tm vng li vi bo him trch nhim dn s cho  t.",link:"https://oto-civil.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:y.jsx(Rk,{className:"w-7 h-7 text-gray-700"})},{title:"BH vt cht  t",description:"Bo v ton din cho x yu trc mi ri ro va chm, h hng.",link:"https://phydam.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:y.jsx(Rk,{className:"w-7 h-7 text-gray-700"})},{title:"BH sc khe",description:"Chm sc sc khe ton din cho bn v gia nh.",link:"https://globalcare.vn/products-hub?code=health&token=2306244fxozgmotc",icon:y.jsx(Zm,{className:"w-7 h-7 text-red-500"})},{title:"BH an ninh mng",description:"Bo v bn khi cc ri ro v tn cng trn khng gian mng.",link:"https://globalcare.vn/bao-hiem-an-ninh-mang?token=2306244fxozgmotc",icon:y.jsx(kL,{className:"w-7 h-7 text-blue-600"})},{title:"BH ton din h kinh doanh",description:"An tm kinh doanh vi gii php bo v ti sn v hot ng.",link:"https://globalcare.vn/bao-hiem-toan-dien-ho-kinh-doanh-ca-the?token=2306244fxozgmotc",icon:y.jsx(iK,{className:"w-7 h-7 text-yellow-600"})},{title:"BH cu h xe my 24/7",description:"H tr kp thi mi lc, mi ni khi xe bn gp s c.",link:"https://globalcare.vn/dich-vu-cuu-ho-xe-may?token=2306244fxozgmotc",icon:y.jsx(bk,{className:"w-7 h-7 text-gray-700"})},{title:"BH bnh him ngho",description:"Ngun ti chnh vng chc gip bn vt qua bnh tt.",link:"https://critical-disease.globalcare.vn/b45306c2?token=2306244fxozgmotc",icon:y.jsx(Zm,{className:"w-7 h-7 text-red-500"})},{title:"BH VIB care",description:"Gi chm sc sc khe cao cp vi nhiu quyn li vt tri.",link:"https://vbi-care.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:y.jsx(Zm,{className:"w-7 h-7 text-red-500"})},{title:"BH nh t nhn",description:"Bo v t m ca bn trc nhng ri ro chy, n, thin tai.",link:"https://private-home.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:y.jsx(Pk,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn Tomato",description:"Gi bo him tai nn c nhn linh hot, chi ph thp.",link:"https://tomato.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:y.jsx(Ks,{className:"w-7 h-7 text-indigo-600"})},{title:"BH Home Care",description:"Bo v ton din cho ngi nh v ti sn bn trong.",link:"https://private-home.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:y.jsx(Pk,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn c nhn",description:"An tm trc mi ri ro khng lng trc trong cuc sng.",link:"https://personal-accident.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:y.jsx(Ks,{className:"w-7 h-7 text-indigo-600"})}],aK=()=>{const n=CL,[e,t]=Q.useState(!1),[r,i]=Q.useState(n.autoDeductEnabled),s=o=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o);return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"space-y-12",children:[y.jsxs("div",{children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Trung tm An Sinh"}),y.jsx("p",{className:"text-lg text-gray-600",children:"Tch ly cho tng lai, an tm cho hm nay."})]}),y.jsxs("div",{className:"space-y-6",children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Bo him X hi T nguyn"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"relative bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col opacity-70",children:[y.jsx("div",{className:"absolute top-3 right-3 bg-gray-200 text-gray-700 text-xs font-semibold px-3 py-1 rounded-full z-10",children:"D kin ra mt"}),y.jsxs("div",{className:"flex items-center mb-4",children:[y.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:y.jsx(Yo,{className:"w-6 h-6 text-gray-400"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Tch im An Sinh"}),y.jsx("p",{className:"text-sm text-gray-500",children:"Hon thnh vic, nhn thng t nn tng."})]})]}),y.jsxs("div",{className:"flex-grow space-y-3 mt-auto",children:[y.jsxs("p",{className:"text-3xl font-bold text-gray-400",children:["0 ",y.jsxs("span",{className:"text-xl font-semibold text-gray-500",children:["/ ",n.pointsGoal," im"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:y.jsx("div",{className:"bg-gray-300 h-2.5 rounded-full",style:{width:"0%"}})}),y.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 p-3 rounded-lg mt-3 flex items-start space-x-2",children:[y.jsx(NL,{className:"w-4 h-4 text-gray-500 flex-shrink-0 mt-0.5"}),y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold",children:"[Tnh nng d kin]"})," Vi mi cng vic hon thnh, bn s c cng im. Khon h tr ",y.jsx("span",{className:"font-semibold text-gray-500",children:s(n.pointsRewardVND)})," s c ti tr bi ",y.jsx("span",{className:"font-semibold",children:"Qu An Sinh"})," khi bn t mc im."]})]})]})]}),y.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col",children:[y.jsxs("div",{className:"flex items-center justify-between mb-4",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:y.jsx(sK,{className:"w-6 h-6 text-indigo-600"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Tch Ly T ng"}),y.jsx("p",{className:"text-sm text-gray-500",children:" dnh cho tng lai."})]})]}),y.jsx("button",{onClick:()=>i(!r),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${r?"bg-indigo-600":"bg-gray-300"}`,children:y.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]}),y.jsx("div",{className:"flex-grow flex flex-col items-center justify-center bg-gray-50 rounded-lg p-4 text-center mt-auto",children:r?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-sm text-gray-600",children:"S tin  tch ly trong thng ny"}),y.jsx("p",{className:"text-4xl font-extrabold text-indigo-600 my-2",children:s(n.autoDeductAccumulatedThisMonth)}),y.jsx("p",{className:"text-xs text-gray-500",children:"H thng s t ng trch 2% thu nhp t cc cng vic bn lm qua nn tng. Khon tch ly ny s c t li vo u mi thng."})]}):y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Tnh nng ang tt"}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bt  t ng trch mt phn thu nhp cho qu BHXH ca bn."})]})})]})]}),y.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[y.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Ch ng ng gp"}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bn c th ng thm vo qu BHXH ca mnh bt c lc no  nhanh chng t c mc tiu hu tr."}),y.jsx("button",{onClick:()=>t(!0),className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 shadow-sm",children:"ng BHXH ngay"})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Sn phm Bo him B sung"}),y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:oK.map(o=>y.jsxs("a",{href:o.link,target:"_blank",rel:"noopener noreferrer",className:"group block p-5 bg-white rounded-xl border border-gray-200 hover:border-indigo-400 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center",children:o.icon}),y.jsx(AL,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-600 transition-colors"})]}),y.jsx("p",{className:"font-bold text-gray-800 mt-4",children:o.title}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o.description})]},o.title))})]})]}),e&&y.jsx(rK,{onClose:()=>t(!1)})]})},RL=n=>{const[e,t]=Q.useState({isOnline:!1,statusText:null});return Q.useEffect(()=>{if(!n){t({isOnline:!1,statusText:null});return}const r=O0.ref(`/status/${n}`),i=r.on("value",s=>{const o=s.val();if(o!=null&&o.isOnline)t({isOnline:!0,statusText:"ang hot ng"});else if(o!=null&&o.lastSeen&&typeof o.lastSeen=="number")try{const l=new Date(o.lastSeen).toISOString();t({isOnline:!1,statusText:`Hot ng ${OI(l,"presence")}`})}catch{console.warn("Invalid lastSeen date for user:",n,o.lastSeen),t({isOnline:!1,statusText:"Khng hot ng"})}else t({isOnline:!1,statusText:"Khng hot ng"})});return()=>r.off("value",i)},[n]),e},mr=({fullScreen:n=!1,message:e})=>{const t=n?"fixed inset-0 flex flex-col items-center justify-center bg-gray-50 z-50":"flex flex-col items-center justify-center";return y.jsxs("div",{className:t,children:[y.jsx("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-indigo-500"}),e&&y.jsx("p",{className:"mt-4 text-lg font-semibold text-gray-700",children:e})]})},bL=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.85.064-1.649-.24-2.228-.796a4.425 4.425 0 01-1.16-3.197V8.511c0-.969.616-1.813 1.5-2.097L16.5 6.25l3.75 2.261zM3.75 14.25a2.25 2.25 0 002.25 2.25h3.75V15.75h-3.75a.75.75 0 01-.75-.75V8.25a.75.75 0 01.75-.75h3.75V6.75h-3.75a2.25 2.25 0 00-2.25 2.25v6z"})}),PL=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),lK=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),cK=({className:n="w-6 h-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 12.75l6 6 9-13.5",opacity:"0.5"})]}),UI=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),uK=({status:n})=>n==="read"?y.jsx(cK,{className:"w-4 h-4 text-blue-500"}):y.jsx(lK,{className:"w-4 h-4 text-gray-400"}),dK=({convo:n,isActive:e,currentUserId:t,onClick:r})=>{var u;const i=n.participants.find(d=>d!==t),s=i?n.participantInfo[i]:null,{isOnline:o}=RL(i||null),l=((u=n.unreadCounts)==null?void 0:u[t])||0;return y.jsxs("div",{onClick:r,className:`p-4 flex items-center space-x-3 cursor-pointer transition-colors ${e?"bg-indigo-50":"hover:bg-gray-50"}`,children:[y.jsxs("div",{className:"relative flex-shrink-0",children:[s!=null&&s.profileImageUrl?y.jsx("img",{src:s.profileImageUrl,alt:"",className:"w-12 h-12 rounded-full object-cover"}):y.jsx(Na,{className:"w-12 h-12"}),o&&y.jsx("span",{className:"w-3.5 h-3.5 bg-green-500 rounded-full absolute bottom-0 right-0 border-2 border-white"})]}),y.jsxs("div",{className:"flex-grow overflow-hidden",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("p",{className:`font-semibold text-gray-800 truncate ${l>0?"font-bold":""}`,children:s==null?void 0:s.fullName}),l>0&&y.jsx("span",{className:"bg-indigo-600 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full flex-shrink-0",children:l})]}),y.jsx("p",{className:`text-sm truncate ${l>0?"text-indigo-700 font-semibold":"text-gray-500"}`,children:n.lastMessage})]})]})},hK=({initialSelectedConversationId:n,clearInitialSelection:e})=>{const{currentUser:t,currentUserData:r}=po(),[i,s]=Q.useState([]),[o,l]=Q.useState(null),[u,d]=Q.useState([]),[p,v]=Q.useState(""),[w,x]=Q.useState(!0),[A,R]=Q.useState(!1),[L,j]=Q.useState(!1),B=(o==null?void 0:o.participants.find(D=>D!==(t==null?void 0:t.uid)))||null,q=B&&o?o.participantInfo[B]:null,{statusText:K}=RL(B),te=Q.useRef(null);Q.useEffect(()=>{if(!t)return;x(!0);const D=EL(t.uid,O=>{if(s(O),x(!1),n){const M=O.find($e=>$e.id===n);M&&l(M),e()}});return()=>D()},[t,n,e]),Q.useEffect(()=>{if(!o||!t){d([]);return}R(!0),BW(o.id,t.uid),qW(o.id,t.uid);const D=OW(o.id,O=>{d(O),R(!1)});return()=>D()},[o,t]),Q.useEffect(()=>{var D;(D=te.current)==null||D.scrollIntoView({behavior:"smooth"})},[u]);const ee=async D=>{if(D.preventDefault(),!(!p.trim()||!o||!t||!(r!=null&&r.fullName))){j(!0);try{await UW(o.id,t.uid,r.fullName,p),v("")}catch(O){console.error("Failed to send message:",O)}finally{j(!1)}}},P=async D=>{if(!(!t||!o||D.senderId!==t.uid)&&window.confirm("Bn c chc mun thu hi tin nhn ny khng?"))try{await HW(o.id,D.id,t.uid,D.senderId)}catch(O){console.error("Failed to delete message:",O),alert(" c li xy ra khi thu hi tin nhn.")}},k=window.innerWidth<768,b=!k||k&&!o,F=!k||k&&o;return y.jsxs("div",{className:"flex h-full bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[b&&y.jsxs("div",{className:`w-full md:w-1/3 border-r border-gray-200 flex flex-col ${!o&&k?"":"hidden md:flex"}`,children:[y.jsx("div",{className:"p-4 border-b border-gray-200",children:y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tin nhn"})}),y.jsx("div",{className:"flex-grow overflow-y-auto",children:w?y.jsx(mr,{}):i.length>0?i.map(D=>y.jsx(dK,{convo:D,isActive:(o==null?void 0:o.id)===D.id,currentUserId:t.uid,onClick:()=>l(D)},D.id)):y.jsx("div",{className:"p-6 text-center text-gray-500",children:y.jsx("p",{children:"Cha c cuc tr chuyn no."})})})]}),F&&y.jsx("div",{className:"w-full md:w-2/3 flex flex-col",children:o?y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center space-x-3",children:[k&&y.jsx("button",{onClick:()=>l(null),className:"p-2 rounded-full hover:bg-gray-100",children:y.jsx(PL,{className:"w-5 h-5"})}),y.jsx("div",{className:"relative flex-shrink-0",children:q!=null&&q.profileImageUrl?y.jsx("img",{src:q.profileImageUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):y.jsx(Na,{className:"w-10 h-10"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-gray-800",children:q==null?void 0:q.fullName}),K&&y.jsx("p",{className:"text-xs text-gray-500",children:K})]})]}),y.jsxs("div",{className:"flex-grow p-4 space-y-2 overflow-y-auto bg-gray-50",children:[A?y.jsx(mr,{}):u.map(D=>y.jsxs("div",{className:`flex flex-col group ${D.senderId===(t==null?void 0:t.uid)?"items-end":"items-start"}`,children:[y.jsxs("div",{className:`flex items-end gap-2 ${D.senderId===(t==null?void 0:t.uid)?"flex-row-reverse":"flex-row"}`,children:[D.senderId===(t==null?void 0:t.uid)&&!D.deleted&&y.jsx("button",{onClick:()=>P(D),className:"opacity-0 group-hover:opacity-100 transition-opacity text-gray-400 hover:text-red-500 p-1 mb-1",children:y.jsx(UI,{className:"w-4 h-4"})}),y.jsx("div",{className:`max-w-xs md:max-w-md px-4 py-2 rounded-2xl break-words whitespace-pre-wrap ${D.deleted?"bg-transparent text-gray-500 italic":D.senderId===(t==null?void 0:t.uid)?"bg-indigo-600 text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-200"}`,children:y.jsx("p",{className:"text-sm",children:D.text})})]}),!D.deleted&&y.jsxs("div",{className:"flex items-center text-xs text-gray-400 mt-1 px-1",children:[y.jsx("span",{className:"mr-1",children:OI(D.timestamp)}),D.senderId===(t==null?void 0:t.uid)&&y.jsx(uK,{status:D.status})]})]},D.id)),y.jsx("div",{ref:te})]}),y.jsx("div",{className:"p-4 bg-white border-t border-gray-200",children:y.jsxs("form",{onSubmit:ee,className:"flex items-center space-x-3",children:[y.jsx("input",{type:"text",value:p,onChange:D=>v(D.target.value),placeholder:"Nhp tin nhn...",className:"flex-1 p-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500",disabled:L}),y.jsx("button",{type:"submit",disabled:L||!p.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors",children:y.jsx(ey,{className:"h-6 w-6"})})]})})]}):y.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-gray-500 p-4",children:[y.jsx(bL,{className:"w-16 h-16 text-gray-300 mb-4"}),y.jsx("h3",{className:"text-xl font-semibold",children:"Chn mt cuc tr chuyn"}),y.jsx("p",{children:"Bt u lin lc vi nh tuyn dng hoc ngi lao ng ti y."})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let fK,pK;function mK(){return{geminiUrl:fK,vertexUrl:pK}}function gK(n,e,t,r){var i,s;if(!(n!=null&&n.baseUrl)){const o=mK();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:t:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mo{}function ve(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function m(n,e,t){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const u=n[l];if(Array.isArray(t))for(let d=0;d<u.length;d++){const p=u[d];m(p,e.slice(s+1),t[d])}else for(const d of u)m(d,e.slice(s+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const u=n[l];m(u[0],e.slice(s+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[r]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let r=0;r<e.length;r++){if(typeof n!="object"||n===null)return t;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in n){const o=n[s];return Array.isArray(o)?o.map(l=>f(l,e.slice(r+1),t)):t}else return t}else n=n[i]}return n}catch(r){if(r instanceof TypeError)return t;throw r}}function yK(n,e){for(const[t,r]of Object.entries(e)){const i=t.split("."),s=r.split("."),o=new Set;let l=-1;for(let u=0;u<i.length;u++)if(i[u]==="*"){l=u;break}if(l!==-1&&s.length>l)for(let u=l;u<s.length;u++){const d=s[u];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&o.add(d)}U0(n,i,s,0,o)}}function U0(n,e,t,r,i){if(r>=e.length||typeof n!="object"||n===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),l=n;if(o in l&&Array.isArray(l[o]))for(const u of l[o])U0(u,e,t,r+1,i)}else if(s==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,l=Object.keys(o).filter(d=>!d.startsWith("_")&&!i.has(d)),u={};for(const d of l)u[d]=o[d];for(const[d,p]of Object.entries(u)){const v=[];for(const w of t.slice(r))w==="*"?v.push(d):v.push(w);m(o,v,p)}for(const d of l)delete o[d]}}else{const o=n;s in o&&U0(o[s],e,t,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BI(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _K(n){const e={},t=f(n,["operationName"]);t!=null&&m(e,["operationName"],t);const r=f(n,["resourceName"]);return r!=null&&m(e,["_url","resourceName"],r),e}function vK(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response","generateVideoResponse"]);return o!=null&&m(e,["response"],TK(o)),e}function wK(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response"]);return o!=null&&m(e,["response"],EK(o)),e}function TK(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>IK(o))),m(e,["generatedVideos"],s)}const r=f(n,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function EK(n){const e={},t=f(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>xK(o))),m(e,["generatedVideos"],s)}const r=f(n,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function IK(n){const e={},t=f(n,["video"]);return t!=null&&m(e,["video"],RK(t)),e}function xK(n){const e={},t=f(n,["_self"]);return t!=null&&m(e,["video"],bK(t)),e}function SK(n){const e={},t=f(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function CK(n){const e={},t=f(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function AK(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response"]);return o!=null&&m(e,["response"],NK(o)),e}function NK(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["parent"]);r!=null&&m(e,["parent"],r);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function DL(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response"]);return o!=null&&m(e,["response"],kK(o)),e}function kK(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["parent"]);r!=null&&m(e,["parent"],r);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function RK(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const r=f(n,["encodedVideo"]);r!=null&&m(e,["videoBytes"],BI(r));const i=f(n,["encoding"]);return i!=null&&m(e,["mimeType"],i),e}function bK(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const r=f(n,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],BI(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dk;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Dk||(Dk={}));var Mk;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Mk||(Mk={}));var Lk;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Lk||(Lk={}));var sa;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(sa||(sa={}));var Vk;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Vk||(Vk={}));var Fk;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Fk||(Fk={}));var Ok;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ok||(Ok={}));var Uk;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Uk||(Uk={}));var Bk;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Bk||(Bk={}));var qk;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(qk||(qk={}));var Hk;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Hk||(Hk={}));var Gk;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Gk||(Gk={}));var $k;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})($k||($k={}));var jk;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(jk||(jk={}));var zk;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(zk||(zk={}));var Wk;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Wk||(Wk={}));var Kk;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Kk||(Kk={}));var Jk;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Jk||(Jk={}));var Qk;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Qk||(Qk={}));var zg;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(zg||(zg={}));var Yk;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Yk||(Yk={}));var Xk;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Xk||(Xk={}));var Zk;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Zk||(Zk={}));var B0;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(B0||(B0={}));var eR;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(eR||(eR={}));var tR;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(tR||(tR={}));var nR;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(nR||(nR={}));var rR;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(rR||(rR={}));var iR;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(iR||(iR={}));var sR;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(sR||(sR={}));var oR;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(oR||(oR={}));var aR;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(aR||(aR={}));var lR;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(lR||(lR={}));var cR;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(cR||(cR={}));var uR;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(uR||(uR={}));var dR;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(dR||(dR={}));var hR;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(hR||(hR={}));var fR;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(fR||(fR={}));var pR;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(pR||(pR={}));var mR;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(mR||(mR={}));var gR;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(gR||(gR={}));var yR;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(yR||(yR={}));var _R;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(_R||(_R={}));var vR;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(vR||(vR={}));var wR;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(wR||(wR={}));var TR;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(TR||(TR={}));var ER;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(ER||(ER={}));var IR;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(IR||(IR={}));var xR;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(xR||(xR={}));var SR;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(SR||(SR={}));var CR;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(CR||(CR={}));var AR;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(AR||(AR={}));var NR;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(NR||(NR={}));var kR;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(kR||(kR={}));var cu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(cu||(cu={}));class q0{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class vh{get text(){var e,t,r,i,s,o,l,u;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",p=!1;const v=[];for(const w of(u=(l=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[x,A]of Object.entries(w))x!=="text"&&x!=="thought"&&x!=="thoughtSignature"&&(A!==null||A!==void 0)&&v.push(x);if(typeof w.text=="string"){if(typeof w.thought=="boolean"&&w.thought)continue;p=!0,d+=w.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?d:void 0}get data(){var e,t,r,i,s,o,l,u;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const p=[];for(const v of(u=(l=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[w,x]of Object.entries(v))w!=="inlineData"&&(x!==null||x!==void 0)&&p.push(w);v.inlineData&&typeof v.inlineData.data=="string"&&(d+=atob(v.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,i,s,o,l,u;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(l=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,t,r,i,s,o,l,u,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(u=(l=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(d=p==null?void 0:p[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,i,s,o,l,u,d;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(u=(l=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(d=p==null?void 0:p[0])===null||d===void 0?void 0:d.output}}class RR{}class bR{}class PK{}class DK{}class MK{}class LK{}class PR{}class DR{}class MR{}class VK{}class Wg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new Wg;let i;const s=e;return t?i=wK(s):i=vK(s),Object.assign(r,i),r}}class LR{}class VR{}class FR{}class FK{}class OK{}class UK{}class qI{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new qI,s=AK(e);return Object.assign(r,s),r}}class BK{}class qK{}class HK{}class OR{}class GK{get text(){var e,t,r;let i="",s=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(l))u!=="text"&&u!=="thought"&&d!==null&&o.push(u);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;s=!0,i+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,r;let i="";const s=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(o))l!=="inlineData"&&u!==null&&s.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class $K{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class HI{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const r=new HI,s=DL(e);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ut(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ML(n,e){const t=ut(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function LL(n){return Array.isArray(n)?n.map(e=>Kg(e)):[Kg(n)]}function Kg(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function VL(n){const e=Kg(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function FL(n){const e=Kg(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function UR(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function OL(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>UR(e)):[UR(n)]}function H0(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function BR(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function qR(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Wn(n){if(n==null)throw new Error("ContentUnion is required");return H0(n)?n:{role:"user",parts:OL(n)}}function GI(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Wn(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Wn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Wn(t)):[Wn(e)]}function oi(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(BR(n)||qR(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Wn(n)]}const e=[],t=[],r=H0(n[0]);for(const i of n){const s=H0(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(BR(i)||qR(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return r||e.push({role:"user",parts:OL(t)}),e}function jK(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.values(sa).includes(t[0].toUpperCase())?t[0].toUpperCase():sa.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.values(sa).includes(r.toUpperCase())?r.toUpperCase():sa.TYPE_UNSPECIFIED})}}function vu(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=n.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,n=s[1]):s[1].type==="null"&&(e.nullable=!0,n=s[0])),n.type instanceof Array&&jK(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.values(sa).includes(l.toUpperCase())?l.toUpperCase():sa.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=vu(l);else if(r.includes(o)){const u=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}u.push(vu(d))}e[o]=u}else if(i.includes(o)){const u={};for(const[d,p]of Object.entries(l))u[d]=vu(p);e[o]=u}else{if(o==="additionalProperties")continue;e[o]=l}return e}function $I(n){return vu(n)}function jI(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function zI(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function pd(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=vu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=vu(e.response));return n}function md(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function zK(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function go(n,e){if(typeof e!="string")throw new Error("name must be a string");return zK(n,e,"cachedContents")}function UL(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Fa(n){return BI(n)}function WK(n){return n!=null&&typeof n=="object"&&"name"in n}function KK(n){return n!=null&&typeof n=="object"&&"video"in n}function JK(n){return n!=null&&typeof n=="object"&&"uri"in n}function BL(n){var e;let t;if(WK(n)&&(t=n.name),!(JK(n)&&(t=n.uri,t===void 0))&&!(KK(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function qL(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function HL(n){for(const e of["models","tunedModels","publisherModels"])if(QK(n,e))return n[e];return[]}function QK(n,e){return n!==null&&typeof n=="object"&&e in n}function YK(n,e={}){const t=n,r={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(r.responseJsonSchema=t.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function XK(n,e={}){const t=[],r=new Set;for(const i of n){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=YK(i,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function GL(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const r=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function ZK(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function $L(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const u=o.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function gd(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function jL(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eJ(n){const e={},t=f(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const r=f(n,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>MJ(o))),m(e,["inlinedResponses"],s)}const i=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["inlinedEmbedContentResponses"],s)}return e}function tJ(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const r=f(n,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const i=f(n,["bigqueryDestination","outputUri"]);return i!=null&&m(e,["bigqueryUri"],i),e}function nJ(n){const e={},t=f(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const r=f(n,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const i=f(n,["bigqueryUri"]);if(i!=null&&m(e,["bigqueryDestination","outputUri"],i),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function eg(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const i=f(n,["metadata","state"]);i!=null&&m(e,["state"],jL(i));const s=f(n,["metadata","createTime"]);s!=null&&m(e,["createTime"],s);const o=f(n,["metadata","endTime"]);o!=null&&m(e,["endTime"],o);const l=f(n,["metadata","updateTime"]);l!=null&&m(e,["updateTime"],l);const u=f(n,["metadata","model"]);u!=null&&m(e,["model"],u);const d=f(n,["metadata","output"]);return d!=null&&m(e,["dest"],eJ($L(d))),e}function G0(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["displayName"]);r!=null&&m(e,["displayName"],r);const i=f(n,["state"]);i!=null&&m(e,["state"],jL(i));const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["createTime"]);o!=null&&m(e,["createTime"],o);const l=f(n,["startTime"]);l!=null&&m(e,["startTime"],l);const u=f(n,["endTime"]);u!=null&&m(e,["endTime"],u);const d=f(n,["updateTime"]);d!=null&&m(e,["updateTime"],d);const p=f(n,["model"]);p!=null&&m(e,["model"],p);const v=f(n,["inputConfig"]);v!=null&&m(e,["src"],rJ(v));const w=f(n,["outputConfig"]);w!=null&&m(e,["dest"],tJ($L(w)));const x=f(n,["completionStats"]);return x!=null&&m(e,["completionStats"],x),e}function rJ(n){const e={},t=f(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const r=f(n,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const i=f(n,["bigquerySource","inputUri"]);return i!=null&&m(e,["bigqueryUri"],i),e}function iJ(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(e,["fileName"]);r!=null&&m(t,["fileName"],r);const i=f(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>DJ(n,o))),m(t,["requests","requests"],s)}return t}function sJ(n){const e={},t=f(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const r=f(n,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const i=f(n,["bigqueryUri"]);if(i!=null&&m(e,["bigquerySource","inputUri"],i),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function oJ(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function aJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function lJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function cJ(n){const e={},t=f(n,["content"]);t!=null&&m(e,["content"],t);const r=f(n,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],uJ(r));const i=f(n,["tokenCount"]);i!=null&&m(e,["tokenCount"],i);const s=f(n,["finishReason"]);s!=null&&m(e,["finishReason"],s);const o=f(n,["avgLogprobs"]);o!=null&&m(e,["avgLogprobs"],o);const l=f(n,["groundingMetadata"]);l!=null&&m(e,["groundingMetadata"],l);const u=f(n,["index"]);u!=null&&m(e,["index"],u);const d=f(n,["logprobsResult"]);d!=null&&m(e,["logprobsResult"],d);const p=f(n,["safetyRatings"]);if(p!=null){let w=p;Array.isArray(w)&&(w=w.map(x=>x)),m(e,["safetyRatings"],w)}const v=f(n,["urlContextMetadata"]);return v!=null&&m(e,["urlContextMetadata"],v),e}function uJ(n){const e={},t=f(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),m(e,["citations"],r)}return e}function zL(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>qJ(s))),m(e,["parts"],i)}const r=f(n,["role"]);return r!=null&&m(e,["role"],r),e}function dJ(n,e){const t={},r=f(n,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function hJ(n,e){const t={},r=f(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const i=f(n,["dest"]);return e!==void 0&&i!=null&&m(e,["outputConfig"],nJ(ZK(i))),t}function HR(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["src"]);i!=null&&m(t,["batch","inputConfig"],iJ(n,GL(n,i)));const s=f(e,["config"]);return s!=null&&dJ(s,t),t}function fJ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["model"],ut(n,r));const i=f(e,["src"]);i!=null&&m(t,["inputConfig"],sJ(GL(n,i)));const s=f(e,["config"]);return s!=null&&hJ(s,t),t}function pJ(n,e){const t={},r=f(n,["displayName"]);return e!==void 0&&r!=null&&m(e,["batch","displayName"],r),t}function mJ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["src"]);i!=null&&m(t,["batch","inputConfig"],EJ(n,i));const s=f(e,["config"]);return s!=null&&pJ(s,t),t}function gJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function yJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function _J(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["name"]);r!=null&&m(e,["name"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);return s!=null&&m(e,["error"],s),e}function vJ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["name"]);r!=null&&m(e,["name"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);return s!=null&&m(e,["error"],s),e}function wJ(n,e){const t={},r=f(e,["contents"]);if(r!=null){let s=GI(n,r);Array.isArray(s)&&(s=s.map(o=>o)),m(t,["requests[]","request","content"],s)}const i=f(e,["config"]);return i!=null&&(m(t,["_self"],TJ(i,t)),yK(t,{"requests[].*":"requests[].request.*"})),t}function TJ(n,e){const t={},r=f(n,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["requests[]","title"],i);const s=f(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&m(e,["requests[]","outputDimensionality"],s),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function EJ(n,e){const t={},r=f(e,["fileName"]);r!=null&&m(t,["file_name"],r);const i=f(e,["inlinedRequests"]);return i!=null&&m(t,["requests"],wJ(n,i)),t}function IJ(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function xJ(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const r=f(n,["args"]);r!=null&&m(e,["args"],r);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function SJ(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const r=f(n,["allowedFunctionNames"]);if(r!=null&&m(e,["allowedFunctionNames"],r),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function CJ(n,e,t){const r={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],zL(Wn(i)));const s=f(e,["temperature"]);s!=null&&m(r,["temperature"],s);const o=f(e,["topP"]);o!=null&&m(r,["topP"],o);const l=f(e,["topK"]);l!=null&&m(r,["topK"],l);const u=f(e,["candidateCount"]);u!=null&&m(r,["candidateCount"],u);const d=f(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const p=f(e,["stopSequences"]);p!=null&&m(r,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const w=f(e,["logprobs"]);w!=null&&m(r,["logprobs"],w);const x=f(e,["presencePenalty"]);x!=null&&m(r,["presencePenalty"],x);const A=f(e,["frequencyPenalty"]);A!=null&&m(r,["frequencyPenalty"],A);const R=f(e,["seed"]);R!=null&&m(r,["seed"],R);const L=f(e,["responseMimeType"]);L!=null&&m(r,["responseMimeType"],L);const j=f(e,["responseSchema"]);j!=null&&m(r,["responseSchema"],$I(j));const B=f(e,["responseJsonSchema"]);if(B!=null&&m(r,["responseJsonSchema"],B),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=f(e,["safetySettings"]);if(t!==void 0&&q!=null){let O=q;Array.isArray(O)&&(O=O.map(M=>HJ(M))),m(t,["safetySettings"],O)}const K=f(e,["tools"]);if(t!==void 0&&K!=null){let O=md(K);Array.isArray(O)&&(O=O.map(M=>$J(pd(M)))),m(t,["tools"],O)}const te=f(e,["toolConfig"]);if(t!==void 0&&te!=null&&m(t,["toolConfig"],GJ(te)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=f(e,["cachedContent"]);t!==void 0&&ee!=null&&m(t,["cachedContent"],go(n,ee));const P=f(e,["responseModalities"]);P!=null&&m(r,["responseModalities"],P);const k=f(e,["mediaResolution"]);k!=null&&m(r,["mediaResolution"],k);const b=f(e,["speechConfig"]);if(b!=null&&m(r,["speechConfig"],jI(b)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=f(e,["thinkingConfig"]);F!=null&&m(r,["thinkingConfig"],F);const D=f(e,["imageConfig"]);return D!=null&&m(r,["imageConfig"],PJ(D)),r}function AJ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>cJ(d))),m(e,["candidates"],u)}const i=f(n,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const s=f(n,["promptFeedback"]);s!=null&&m(e,["promptFeedback"],s);const o=f(n,["responseId"]);o!=null&&m(e,["responseId"],o);const l=f(n,["usageMetadata"]);return l!=null&&m(e,["usageMetadata"],l),e}function NJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function kJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],gd(n,r)),t}function RJ(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function bJ(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function PJ(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const r=f(n,["imageSize"]);if(r!=null&&m(e,["imageSize"],r),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function DJ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["request","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let l=oi(i);Array.isArray(l)&&(l=l.map(u=>zL(u))),m(t,["request","contents"],l)}const s=f(e,["metadata"]);s!=null&&m(t,["metadata"],s);const o=f(e,["config"]);return o!=null&&m(t,["request","generationConfig"],CJ(n,o,f(t,["request"],{}))),t}function MJ(n){const e={},t=f(n,["response"]);t!=null&&m(e,["response"],AJ(t));const r=f(n,["error"]);return r!=null&&m(e,["error"],r),e}function LJ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);if(e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function VJ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);e!==void 0&&i!=null&&m(e,["_query","pageToken"],i);const s=f(n,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),t}function FJ(n){const e={},t=f(n,["config"]);return t!=null&&LJ(t,e),e}function OJ(n){const e={},t=f(n,["config"]);return t!=null&&VJ(t,e),e}function UJ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>eg(o))),m(e,["batchJobs"],s)}return e}function BJ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>G0(o))),m(e,["batchJobs"],s)}return e}function qJ(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const r=f(n,["codeExecutionResult"]);r!=null&&m(e,["codeExecutionResult"],r);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const s=f(n,["fileData"]);s!=null&&m(e,["fileData"],IJ(s));const o=f(n,["functionCall"]);o!=null&&m(e,["functionCall"],xJ(o));const l=f(n,["functionResponse"]);l!=null&&m(e,["functionResponse"],l);const u=f(n,["inlineData"]);u!=null&&m(e,["inlineData"],oJ(u));const d=f(n,["text"]);d!=null&&m(e,["text"],d);const p=f(n,["thought"]);p!=null&&m(e,["thought"],p);const v=f(n,["thoughtSignature"]);v!=null&&m(e,["thoughtSignature"],v);const w=f(n,["videoMetadata"]);return w!=null&&m(e,["videoMetadata"],w),e}function HJ(n){const e={},t=f(n,["category"]);if(t!=null&&m(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(n,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function GJ(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],SJ(t));const r=f(n,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],r),e}function $J(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(v=>v)),m(e,["functionDeclarations"],p)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(n,["googleSearchRetrieval"]);r!=null&&m(e,["googleSearchRetrieval"],r);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const s=f(n,["fileSearch"]);s!=null&&m(e,["fileSearch"],s);const o=f(n,["codeExecution"]);if(o!=null&&m(e,["codeExecution"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],RJ(l));const u=f(n,["googleSearch"]);u!=null&&m(e,["googleSearch"],bJ(u));const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var so;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(so||(so={}));class dc{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jJ extends mo{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new dc(so.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=HR(this.apiClient,e),r=t._url,i=ve("{model}:batchGenerateContent",r),l=t.batch.inputConfig.requests,u=l.requests,d=[];for(const p of u){const v=Object.assign({},p);if(v.systemInstruction){const w=v.systemInstruction;delete v.systemInstruction;const x=v.request;x.systemInstruction=w,v.request=x}d.push(v)}return l.requests=d,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const r=t?Object.assign({},t):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=fJ(this.apiClient,e);return l=ve("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>G0(p))}else{const d=HR(this.apiClient,e);return l=ve("{model}:batchGenerateContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>eg(p))}}async createEmbeddingsInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=mJ(this.apiClient,e);return s=ve("{model}:asyncBatchEmbedContent",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>eg(u))}}async get(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=kJ(this.apiClient,e);return l=ve("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>G0(p))}else{const d=NJ(this.apiClient,e);return l=ve("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>eg(p))}}async cancel(e){var t,r,i,s;let o="",l={};if(this.apiClient.isVertexAI()){const u=lJ(this.apiClient,e);o=ve("batchPredictionJobs/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=aJ(this.apiClient,e);o=ve("batches/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=OJ(e);return l=ve("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=BJ(p),w=new OR;return Object.assign(w,v),w})}else{const d=FJ(e);return l=ve("batches",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=UJ(p),w=new OR;return Object.assign(w,v),w})}}async delete(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=yJ(this.apiClient,e);return l=ve("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>vJ(p))}else{const d=gJ(this.apiClient,e);return l=ve("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>_J(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zJ(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function GR(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>mQ(s))),m(e,["parts"],i)}const r=f(n,["role"]);return r!=null&&m(e,["role"],r),e}function WJ(n,e){const t={},r=f(n,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const i=f(n,["expireTime"]);e!==void 0&&i!=null&&m(e,["expireTime"],i);const s=f(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const o=f(n,["contents"]);if(e!==void 0&&o!=null){let p=oi(o);Array.isArray(p)&&(p=p.map(v=>GR(v))),m(e,["contents"],p)}const l=f(n,["systemInstruction"]);e!==void 0&&l!=null&&m(e,["systemInstruction"],GR(Wn(l)));const u=f(n,["tools"]);if(e!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(v=>yQ(v))),m(e,["tools"],p)}const d=f(n,["toolConfig"]);if(e!==void 0&&d!=null&&m(e,["toolConfig"],gQ(d)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function KJ(n,e){const t={},r=f(n,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const i=f(n,["expireTime"]);e!==void 0&&i!=null&&m(e,["expireTime"],i);const s=f(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const o=f(n,["contents"]);if(e!==void 0&&o!=null){let v=oi(o);Array.isArray(v)&&(v=v.map(w=>w)),m(e,["contents"],v)}const l=f(n,["systemInstruction"]);e!==void 0&&l!=null&&m(e,["systemInstruction"],Wn(l));const u=f(n,["tools"]);if(e!==void 0&&u!=null){let v=u;Array.isArray(v)&&(v=v.map(w=>_Q(w))),m(e,["tools"],v)}const d=f(n,["toolConfig"]);e!==void 0&&d!=null&&m(e,["toolConfig"],d);const p=f(n,["kmsKeyName"]);return e!==void 0&&p!=null&&m(e,["encryption_spec","kmsKeyName"],p),t}function JJ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["model"],ML(n,r));const i=f(e,["config"]);return i!=null&&WJ(i,t),t}function QJ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["model"],ML(n,r));const i=f(e,["config"]);return i!=null&&KJ(i,t),t}function YJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],go(n,r)),t}function XJ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],go(n,r)),t}function ZJ(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function eQ(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function tQ(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function nQ(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const r=f(n,["args"]);r!=null&&m(e,["args"],r);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rQ(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const r=f(n,["allowedFunctionNames"]);if(r!=null&&m(e,["allowedFunctionNames"],r),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function iQ(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const r=f(n,["name"]);r!=null&&m(e,["name"],r);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const s=f(n,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const o=f(n,["response"]);o!=null&&m(e,["response"],o);const l=f(n,["responseJsonSchema"]);return l!=null&&m(e,["responseJsonSchema"],l),e}function sQ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],go(n,r)),t}function oQ(n,e){const t={},r=f(e,["name"]);return r!=null&&m(t,["_url","name"],go(n,r)),t}function aQ(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function lQ(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function cQ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function uQ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function dQ(n){const e={},t=f(n,["config"]);return t!=null&&cQ(t,e),e}function hQ(n){const e={},t=f(n,["config"]);return t!=null&&uQ(t,e),e}function fQ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["cachedContents"],s)}return e}function pQ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["cachedContents"],s)}return e}function mQ(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const r=f(n,["codeExecutionResult"]);r!=null&&m(e,["codeExecutionResult"],r);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const s=f(n,["fileData"]);s!=null&&m(e,["fileData"],tQ(s));const o=f(n,["functionCall"]);o!=null&&m(e,["functionCall"],nQ(o));const l=f(n,["functionResponse"]);l!=null&&m(e,["functionResponse"],l);const u=f(n,["inlineData"]);u!=null&&m(e,["inlineData"],zJ(u));const d=f(n,["text"]);d!=null&&m(e,["text"],d);const p=f(n,["thought"]);p!=null&&m(e,["thought"],p);const v=f(n,["thoughtSignature"]);v!=null&&m(e,["thoughtSignature"],v);const w=f(n,["videoMetadata"]);return w!=null&&m(e,["videoMetadata"],w),e}function gQ(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],rQ(t));const r=f(n,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],r),e}function yQ(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(v=>v)),m(e,["functionDeclarations"],p)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(n,["googleSearchRetrieval"]);r!=null&&m(e,["googleSearchRetrieval"],r);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const s=f(n,["fileSearch"]);s!=null&&m(e,["fileSearch"],s);const o=f(n,["codeExecution"]);if(o!=null&&m(e,["codeExecution"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],aQ(l));const u=f(n,["googleSearch"]);u!=null&&m(e,["googleSearch"],lQ(u));const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function _Q(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(w=>iQ(w))),m(e,["functionDeclarations"],v)}const r=f(n,["retrieval"]);r!=null&&m(e,["retrieval"],r);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=f(n,["computerUse"]);if(s!=null&&m(e,["computerUse"],s),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(n,["codeExecution"]);o!=null&&m(e,["codeExecution"],o);const l=f(n,["enterpriseWebSearch"]);l!=null&&m(e,["enterpriseWebSearch"],l);const u=f(n,["googleMaps"]);u!=null&&m(e,["googleMaps"],u);const d=f(n,["googleSearch"]);d!=null&&m(e,["googleSearch"],d);const p=f(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function vQ(n,e){const t={},r=f(n,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const i=f(n,["expireTime"]);return e!==void 0&&i!=null&&m(e,["expireTime"],i),t}function wQ(n,e){const t={},r=f(n,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const i=f(n,["expireTime"]);return e!==void 0&&i!=null&&m(e,["expireTime"],i),t}function TQ(n,e){const t={},r=f(e,["name"]);r!=null&&m(t,["_url","name"],go(n,r));const i=f(e,["config"]);return i!=null&&vQ(i,t),t}function EQ(n,e){const t={},r=f(e,["name"]);r!=null&&m(t,["_url","name"],go(n,r));const i=f(e,["config"]);return i!=null&&wQ(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IQ extends mo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dc(so.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=QJ(this.apiClient,e);return l=ve("cachedContents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const d=JJ(this.apiClient,e);return l=ve("cachedContents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async get(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=oQ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const d=sQ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async delete(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=XJ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=eQ(p),w=new VR;return Object.assign(w,v),w})}else{const d=YJ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=ZJ(p),w=new VR;return Object.assign(w,v),w})}}async update(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=EQ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const d=TQ(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async listInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=hQ(e);return l=ve("cachedContents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=pQ(p),w=new FR;return Object.assign(w,v),w})}else{const d=dQ(e);return l=ve("cachedContents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=fQ(p),w=new FR;return Object.assign(w,v),w})}}}function $R(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(n){return this instanceof Pt?(this.v=n,this):new Pt(n)}function wu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(x){return function(A){return Promise.resolve(A).then(x,v)}}function l(x,A){r[x]&&(i[x]=function(R){return new Promise(function(L,j){s.push([x,R,L,j])>1||u(x,R)})},A&&(i[x]=A(i[x])))}function u(x,A){try{d(r[x](A))}catch(R){w(s[0][3],R)}}function d(x){x.value instanceof Pt?Promise.resolve(x.value.v).then(p,v):w(s[0][2],x)}function p(x){u("next",x)}function v(x){u("throw",x)}function w(x,A){x(A),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Qh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof $R=="function"?$R(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(l,u){o=n[s](o),i(l,u,o.done,o.value)})}}function i(s,o,l,u){Promise.resolve(u).then(function(d){s({value:d,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xQ(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:WL(t)}function WL(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function SQ(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function jR(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let s=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),s&&!WL(n[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class CQ{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new AQ(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class AQ{constructor(e,t,r,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),SQ(s)}async sendMessage(e){var t;await this.sendPromise;const r=Wn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,o,l;const u=await i,d=(o=(s=u.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,p=u.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let w=[];p!=null&&(w=(l=p.slice(v))!==null&&l!==void 0?l:[]);const x=d?[d]:[];this.recordHistory(r,x,w)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const r=Wn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const t=e?jR(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,i;return wu(this,arguments,function*(){var o,l,u,d;const p=[];try{for(var v=!0,w=Qh(e),x;x=yield Pt(w.next()),o=x.done,!o;v=!0){d=x.value,v=!1;const A=d;if(xQ(A)){const R=(i=(r=A.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;R!==void 0&&p.push(R)}yield yield Pt(A)}}catch(A){l={error:A}}finally{try{!v&&!o&&(u=w.return)&&(yield Pt(u.call(w)))}finally{if(l)throw l.error}}this.recordHistory(t,p)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...jR(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class d_ extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,d_.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NQ(n){const e={},t=f(n,["file"]);return t!=null&&m(e,["file"],t),e}function kQ(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function RQ(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","file"],BL(t)),e}function bQ(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function PQ(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","file"],BL(t)),e}function DQ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function MQ(n){const e={},t=f(n,["config"]);return t!=null&&DQ(t,e),e}function LQ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VQ extends mo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dc(so.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=MQ(e);return s=ve("files",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const d=LQ(u),p=new BK;return Object.assign(p,d),p})}}async createInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=NQ(e);return s=ve("upload/v1beta/files",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=kQ(u),p=new qK;return Object.assign(p,d),p})}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=PQ(e);return s=ve("files/{file}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=RQ(e);return s=ve("files/{file}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const d=bQ(u),p=new HK;return Object.assign(p,d),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tg(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function FQ(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>ZQ(s))),m(e,["parts"],i)}const r=f(n,["role"]);return r!=null&&m(e,["role"],r),e}function OQ(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function UQ(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const r=f(n,["args"]);r!=null&&m(e,["args"],r);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function BQ(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const r=f(n,["name"]);r!=null&&m(e,["name"],r);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const s=f(n,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const o=f(n,["response"]);o!=null&&m(e,["response"],o);const l=f(n,["responseJsonSchema"]);return l!=null&&m(e,["responseJsonSchema"],l),e}function qQ(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const r=f(n,["responseJsonSchema"]);r!=null&&m(e,["responseJsonSchema"],r);const i=f(n,["audioTimestamp"]);i!=null&&m(e,["audioTimestamp"],i);const s=f(n,["candidateCount"]);s!=null&&m(e,["candidateCount"],s);const o=f(n,["enableAffectiveDialog"]);o!=null&&m(e,["enableAffectiveDialog"],o);const l=f(n,["frequencyPenalty"]);l!=null&&m(e,["frequencyPenalty"],l);const u=f(n,["logprobs"]);u!=null&&m(e,["logprobs"],u);const d=f(n,["maxOutputTokens"]);d!=null&&m(e,["maxOutputTokens"],d);const p=f(n,["mediaResolution"]);p!=null&&m(e,["mediaResolution"],p);const v=f(n,["presencePenalty"]);v!=null&&m(e,["presencePenalty"],v);const w=f(n,["responseLogprobs"]);w!=null&&m(e,["responseLogprobs"],w);const x=f(n,["responseMimeType"]);x!=null&&m(e,["responseMimeType"],x);const A=f(n,["responseModalities"]);A!=null&&m(e,["responseModalities"],A);const R=f(n,["responseSchema"]);R!=null&&m(e,["responseSchema"],R);const L=f(n,["routingConfig"]);L!=null&&m(e,["routingConfig"],L);const j=f(n,["seed"]);j!=null&&m(e,["seed"],j);const B=f(n,["speechConfig"]);B!=null&&m(e,["speechConfig"],KL(B));const q=f(n,["stopSequences"]);q!=null&&m(e,["stopSequences"],q);const K=f(n,["temperature"]);K!=null&&m(e,["temperature"],K);const te=f(n,["thinkingConfig"]);te!=null&&m(e,["thinkingConfig"],te);const ee=f(n,["topK"]);ee!=null&&m(e,["topK"],ee);const P=f(n,["topP"]);if(P!=null&&m(e,["topP"],P),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function HQ(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function GQ(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function $Q(n,e){const t={},r=f(n,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const s=f(n,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const o=f(n,["topP"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topP"],o);const l=f(n,["topK"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topK"],l);const u=f(n,["maxOutputTokens"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","maxOutputTokens"],u);const d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const p=f(n,["seed"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","seed"],p);const v=f(n,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],zI(v));const w=f(n,["thinkingConfig"]);e!==void 0&&w!=null&&m(e,["setup","generationConfig","thinkingConfig"],w);const x=f(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=f(n,["systemInstruction"]);e!==void 0&&A!=null&&m(e,["setup","systemInstruction"],FQ(Wn(A)));const R=f(n,["tools"]);if(e!==void 0&&R!=null){let ee=md(R);Array.isArray(ee)&&(ee=ee.map(P=>tY(pd(P)))),m(e,["setup","tools"],ee)}const L=f(n,["sessionResumption"]);e!==void 0&&L!=null&&m(e,["setup","sessionResumption"],eY(L));const j=f(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","inputAudioTranscription"],j);const B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&m(e,["setup","outputAudioTranscription"],B);const q=f(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const K=f(n,["contextWindowCompression"]);e!==void 0&&K!=null&&m(e,["setup","contextWindowCompression"],K);const te=f(n,["proactivity"]);return e!==void 0&&te!=null&&m(e,["setup","proactivity"],te),t}function jQ(n,e){const t={},r=f(n,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],qQ(r));const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const s=f(n,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const o=f(n,["topP"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topP"],o);const l=f(n,["topK"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topK"],l);const u=f(n,["maxOutputTokens"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","maxOutputTokens"],u);const d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const p=f(n,["seed"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","seed"],p);const v=f(n,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],KL(zI(v)));const w=f(n,["thinkingConfig"]);e!==void 0&&w!=null&&m(e,["setup","generationConfig","thinkingConfig"],w);const x=f(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=f(n,["systemInstruction"]);e!==void 0&&A!=null&&m(e,["setup","systemInstruction"],Wn(A));const R=f(n,["tools"]);if(e!==void 0&&R!=null){let ee=md(R);Array.isArray(ee)&&(ee=ee.map(P=>nY(pd(P)))),m(e,["setup","tools"],ee)}const L=f(n,["sessionResumption"]);e!==void 0&&L!=null&&m(e,["setup","sessionResumption"],L);const j=f(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","inputAudioTranscription"],j);const B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&m(e,["setup","outputAudioTranscription"],B);const q=f(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const K=f(n,["contextWindowCompression"]);e!==void 0&&K!=null&&m(e,["setup","contextWindowCompression"],K);const te=f(n,["proactivity"]);return e!==void 0&&te!=null&&m(e,["setup","proactivity"],te),t}function zQ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["setup","model"],ut(n,r));const i=f(e,["config"]);return i!=null&&m(t,["config"],$Q(i,t)),t}function WQ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["setup","model"],ut(n,r));const i=f(e,["config"]);return i!=null&&m(t,["config"],jQ(i,t)),t}function KQ(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function JQ(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),m(e,["weightedPrompts"],r)}return e}function QQ(n){const e={},t=f(n,["media"]);if(t!=null){let d=LL(t);Array.isArray(d)&&(d=d.map(p=>tg(p))),m(e,["mediaChunks"],d)}const r=f(n,["audio"]);r!=null&&m(e,["audio"],tg(FL(r)));const i=f(n,["audioStreamEnd"]);i!=null&&m(e,["audioStreamEnd"],i);const s=f(n,["video"]);s!=null&&m(e,["video"],tg(VL(s)));const o=f(n,["text"]);o!=null&&m(e,["text"],o);const l=f(n,["activityStart"]);l!=null&&m(e,["activityStart"],l);const u=f(n,["activityEnd"]);return u!=null&&m(e,["activityEnd"],u),e}function YQ(n){const e={},t=f(n,["media"]);if(t!=null){let d=LL(t);Array.isArray(d)&&(d=d.map(p=>p)),m(e,["mediaChunks"],d)}const r=f(n,["audio"]);r!=null&&m(e,["audio"],FL(r));const i=f(n,["audioStreamEnd"]);i!=null&&m(e,["audioStreamEnd"],i);const s=f(n,["video"]);s!=null&&m(e,["video"],VL(s));const o=f(n,["text"]);o!=null&&m(e,["text"],o);const l=f(n,["activityStart"]);l!=null&&m(e,["activityStart"],l);const u=f(n,["activityEnd"]);return u!=null&&m(e,["activityEnd"],u),e}function XQ(n){const e={},t=f(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const r=f(n,["serverContent"]);r!=null&&m(e,["serverContent"],r);const i=f(n,["toolCall"]);i!=null&&m(e,["toolCall"],i);const s=f(n,["toolCallCancellation"]);s!=null&&m(e,["toolCallCancellation"],s);const o=f(n,["usageMetadata"]);o!=null&&m(e,["usageMetadata"],rY(o));const l=f(n,["goAway"]);l!=null&&m(e,["goAway"],l);const u=f(n,["sessionResumptionUpdate"]);return u!=null&&m(e,["sessionResumptionUpdate"],u),e}function ZQ(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const r=f(n,["codeExecutionResult"]);r!=null&&m(e,["codeExecutionResult"],r);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const s=f(n,["fileData"]);s!=null&&m(e,["fileData"],OQ(s));const o=f(n,["functionCall"]);o!=null&&m(e,["functionCall"],UQ(o));const l=f(n,["functionResponse"]);l!=null&&m(e,["functionResponse"],l);const u=f(n,["inlineData"]);u!=null&&m(e,["inlineData"],tg(u));const d=f(n,["text"]);d!=null&&m(e,["text"],d);const p=f(n,["thought"]);p!=null&&m(e,["thought"],p);const v=f(n,["thoughtSignature"]);v!=null&&m(e,["thoughtSignature"],v);const w=f(n,["videoMetadata"]);return w!=null&&m(e,["videoMetadata"],w),e}function eY(n){const e={},t=f(n,["handle"]);if(t!=null&&m(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function KL(n){const e={},t=f(n,["languageCode"]);t!=null&&m(e,["languageCode"],t);const r=f(n,["voiceConfig"]);if(r!=null&&m(e,["voiceConfig"],r),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function tY(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(v=>v)),m(e,["functionDeclarations"],p)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(n,["googleSearchRetrieval"]);r!=null&&m(e,["googleSearchRetrieval"],r);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const s=f(n,["fileSearch"]);s!=null&&m(e,["fileSearch"],s);const o=f(n,["codeExecution"]);if(o!=null&&m(e,["codeExecution"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],HQ(l));const u=f(n,["googleSearch"]);u!=null&&m(e,["googleSearch"],GQ(u));const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function nY(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(w=>BQ(w))),m(e,["functionDeclarations"],v)}const r=f(n,["retrieval"]);r!=null&&m(e,["retrieval"],r);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=f(n,["computerUse"]);if(s!=null&&m(e,["computerUse"],s),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(n,["codeExecution"]);o!=null&&m(e,["codeExecution"],o);const l=f(n,["enterpriseWebSearch"]);l!=null&&m(e,["enterpriseWebSearch"],l);const u=f(n,["googleMaps"]);u!=null&&m(e,["googleMaps"],u);const d=f(n,["googleSearch"]);d!=null&&m(e,["googleSearch"],d);const p=f(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function rY(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const r=f(n,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const i=f(n,["candidatesTokenCount"]);i!=null&&m(e,["responseTokenCount"],i);const s=f(n,["toolUsePromptTokenCount"]);s!=null&&m(e,["toolUsePromptTokenCount"],s);const o=f(n,["thoughtsTokenCount"]);o!=null&&m(e,["thoughtsTokenCount"],o);const l=f(n,["totalTokenCount"]);l!=null&&m(e,["totalTokenCount"],l);const u=f(n,["promptTokensDetails"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(A=>A)),m(e,["promptTokensDetails"],x)}const d=f(n,["cacheTokensDetails"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(A=>A)),m(e,["cacheTokensDetails"],x)}const p=f(n,["candidatesTokensDetails"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(A=>A)),m(e,["responseTokensDetails"],x)}const v=f(n,["toolUsePromptTokensDetails"]);if(v!=null){let x=v;Array.isArray(x)&&(x=x.map(A=>A)),m(e,["toolUsePromptTokensDetails"],x)}const w=f(n,["trafficType"]);return w!=null&&m(e,["trafficType"],w),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iY(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function sY(n){const e={},t=f(n,["content"]);t!=null&&m(e,["content"],t);const r=f(n,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],oY(r));const i=f(n,["tokenCount"]);i!=null&&m(e,["tokenCount"],i);const s=f(n,["finishReason"]);s!=null&&m(e,["finishReason"],s);const o=f(n,["avgLogprobs"]);o!=null&&m(e,["avgLogprobs"],o);const l=f(n,["groundingMetadata"]);l!=null&&m(e,["groundingMetadata"],l);const u=f(n,["index"]);u!=null&&m(e,["index"],u);const d=f(n,["logprobsResult"]);d!=null&&m(e,["logprobsResult"],d);const p=f(n,["safetyRatings"]);if(p!=null){let w=p;Array.isArray(w)&&(w=w.map(x=>x)),m(e,["safetyRatings"],w)}const v=f(n,["urlContextMetadata"]);return v!=null&&m(e,["urlContextMetadata"],v),e}function oY(n){const e={},t=f(n,["citationSources"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>i)),m(e,["citations"],r)}return e}function aY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let s=oi(i);Array.isArray(s)&&(s=s.map(o=>o)),m(t,["contents"],s)}return t}function lY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["tokensInfo"],i)}return e}function cY(n){const e={},t=f(n,["values"]);t!=null&&m(e,["values"],t);const r=f(n,["statistics"]);return r!=null&&m(e,["statistics"],uY(r)),e}function uY(n){const e={},t=f(n,["truncated"]);t!=null&&m(e,["truncated"],t);const r=f(n,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function h_(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>vX(s))),m(e,["parts"],i)}const r=f(n,["role"]);return r!=null&&m(e,["role"],r),e}function dY(n){const e={},t=f(n,["controlType"]);t!=null&&m(e,["controlType"],t);const r=f(n,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function hY(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function fY(n,e){const t={},r=f(n,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],Wn(r));const i=f(n,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>ZL(l))),m(e,["tools"],o)}const s=f(n,["generationConfig"]);return e!==void 0&&s!=null&&m(e,["generationConfig"],iX(s)),t}function pY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let o=oi(i);Array.isArray(o)&&(o=o.map(l=>h_(l))),m(t,["contents"],o)}const s=f(e,["config"]);return s!=null&&hY(s),t}function mY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let o=oi(i);Array.isArray(o)&&(o=o.map(l=>l)),m(t,["contents"],o)}const s=f(e,["config"]);return s!=null&&fY(s,t),t}function gY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["totalTokens"]);r!=null&&m(e,["totalTokens"],r);const i=f(n,["cachedContentTokenCount"]);return i!=null&&m(e,["cachedContentTokenCount"],i),e}function yY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["totalTokens"]);return r!=null&&m(e,["totalTokens"],r),e}function _Y(n,e){const t={},r=f(e,["model"]);return r!=null&&m(t,["_url","name"],ut(n,r)),t}function vY(n,e){const t={},r=f(e,["model"]);return r!=null&&m(t,["_url","name"],ut(n,r)),t}function wY(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function TY(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function EY(n,e){const t={},r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const i=f(n,["negativePrompt"]);e!==void 0&&i!=null&&m(e,["parameters","negativePrompt"],i);const s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const o=f(n,["aspectRatio"]);e!==void 0&&o!=null&&m(e,["parameters","aspectRatio"],o);const l=f(n,["guidanceScale"]);e!==void 0&&l!=null&&m(e,["parameters","guidanceScale"],l);const u=f(n,["seed"]);e!==void 0&&u!=null&&m(e,["parameters","seed"],u);const d=f(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const p=f(n,["personGeneration"]);e!==void 0&&p!=null&&m(e,["parameters","personGeneration"],p);const v=f(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const w=f(n,["includeRaiReason"]);e!==void 0&&w!=null&&m(e,["parameters","includeRaiReason"],w);const x=f(n,["language"]);e!==void 0&&x!=null&&m(e,["parameters","language"],x);const A=f(n,["outputMimeType"]);e!==void 0&&A!=null&&m(e,["parameters","outputOptions","mimeType"],A);const R=f(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&m(e,["parameters","outputOptions","compressionQuality"],R);const L=f(n,["addWatermark"]);e!==void 0&&L!=null&&m(e,["parameters","addWatermark"],L);const j=f(n,["labels"]);e!==void 0&&j!=null&&m(e,["labels"],j);const B=f(n,["editMode"]);e!==void 0&&B!=null&&m(e,["parameters","editMode"],B);const q=f(n,["baseSteps"]);return e!==void 0&&q!=null&&m(e,["parameters","editConfig","baseSteps"],q),t}function IY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const s=f(e,["referenceImages"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>SX(u))),m(t,["instances[0]","referenceImages"],l)}const o=f(e,["config"]);return o!=null&&EY(o,t),t}function xY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>f_(s))),m(e,["generatedImages"],i)}return e}function SY(n,e){const t={},r=f(n,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["requests[]","title"],i);const s=f(n,["outputDimensionality"]);if(e!==void 0&&s!=null&&m(e,["requests[]","outputDimensionality"],s),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function CY(n,e){const t={},r=f(n,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["instances[]","title"],i);const s=f(n,["outputDimensionality"]);e!==void 0&&s!=null&&m(e,["parameters","outputDimensionality"],s);const o=f(n,["mimeType"]);e!==void 0&&o!=null&&m(e,["instances[]","mimeType"],o);const l=f(n,["autoTruncate"]);return e!==void 0&&l!=null&&m(e,["parameters","autoTruncate"],l),t}function AY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let l=GI(n,i);Array.isArray(l)&&(l=l.map(u=>u)),m(t,["requests[]","content"],l)}const s=f(e,["config"]);s!=null&&SY(s,t);const o=f(e,["model"]);return o!==void 0&&m(t,["requests[]","model"],ut(n,o)),t}function NY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let o=GI(n,i);Array.isArray(o)&&(o=o.map(l=>l)),m(t,["instances[]","content"],o)}const s=f(e,["config"]);return s!=null&&CY(s,t),t}function kY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["embeddings"],s)}const i=f(n,["metadata"]);return i!=null&&m(e,["metadata"],i),e}function RY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>cY(o))),m(e,["embeddings"],s)}const i=f(n,["metadata"]);return i!=null&&m(e,["metadata"],i),e}function bY(n){const e={},t=f(n,["endpoint"]);t!=null&&m(e,["name"],t);const r=f(n,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function PY(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function DY(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const r=f(n,["args"]);r!=null&&m(e,["args"],r);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function MY(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const r=f(n,["allowedFunctionNames"]);if(r!=null&&m(e,["allowedFunctionNames"],r),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function LY(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const r=f(n,["name"]);r!=null&&m(e,["name"],r);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const s=f(n,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const o=f(n,["response"]);o!=null&&m(e,["response"],o);const l=f(n,["responseJsonSchema"]);return l!=null&&m(e,["responseJsonSchema"],l),e}function VY(n,e,t){const r={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],h_(Wn(i)));const s=f(e,["temperature"]);s!=null&&m(r,["temperature"],s);const o=f(e,["topP"]);o!=null&&m(r,["topP"],o);const l=f(e,["topK"]);l!=null&&m(r,["topK"],l);const u=f(e,["candidateCount"]);u!=null&&m(r,["candidateCount"],u);const d=f(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const p=f(e,["stopSequences"]);p!=null&&m(r,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const w=f(e,["logprobs"]);w!=null&&m(r,["logprobs"],w);const x=f(e,["presencePenalty"]);x!=null&&m(r,["presencePenalty"],x);const A=f(e,["frequencyPenalty"]);A!=null&&m(r,["frequencyPenalty"],A);const R=f(e,["seed"]);R!=null&&m(r,["seed"],R);const L=f(e,["responseMimeType"]);L!=null&&m(r,["responseMimeType"],L);const j=f(e,["responseSchema"]);j!=null&&m(r,["responseSchema"],$I(j));const B=f(e,["responseJsonSchema"]);if(B!=null&&m(r,["responseJsonSchema"],B),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=f(e,["safetySettings"]);if(t!==void 0&&q!=null){let O=q;Array.isArray(O)&&(O=O.map(M=>CX(M))),m(t,["safetySettings"],O)}const K=f(e,["tools"]);if(t!==void 0&&K!=null){let O=md(K);Array.isArray(O)&&(O=O.map(M=>DX(pd(M)))),m(t,["tools"],O)}const te=f(e,["toolConfig"]);if(t!==void 0&&te!=null&&m(t,["toolConfig"],PX(te)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=f(e,["cachedContent"]);t!==void 0&&ee!=null&&m(t,["cachedContent"],go(n,ee));const P=f(e,["responseModalities"]);P!=null&&m(r,["responseModalities"],P);const k=f(e,["mediaResolution"]);k!=null&&m(r,["mediaResolution"],k);const b=f(e,["speechConfig"]);if(b!=null&&m(r,["speechConfig"],jI(b)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=f(e,["thinkingConfig"]);F!=null&&m(r,["thinkingConfig"],F);const D=f(e,["imageConfig"]);return D!=null&&m(r,["imageConfig"],cX(D)),r}function FY(n,e,t){const r={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],Wn(i));const s=f(e,["temperature"]);s!=null&&m(r,["temperature"],s);const o=f(e,["topP"]);o!=null&&m(r,["topP"],o);const l=f(e,["topK"]);l!=null&&m(r,["topK"],l);const u=f(e,["candidateCount"]);u!=null&&m(r,["candidateCount"],u);const d=f(e,["maxOutputTokens"]);d!=null&&m(r,["maxOutputTokens"],d);const p=f(e,["stopSequences"]);p!=null&&m(r,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const w=f(e,["logprobs"]);w!=null&&m(r,["logprobs"],w);const x=f(e,["presencePenalty"]);x!=null&&m(r,["presencePenalty"],x);const A=f(e,["frequencyPenalty"]);A!=null&&m(r,["frequencyPenalty"],A);const R=f(e,["seed"]);R!=null&&m(r,["seed"],R);const L=f(e,["responseMimeType"]);L!=null&&m(r,["responseMimeType"],L);const j=f(e,["responseSchema"]);j!=null&&m(r,["responseSchema"],$I(j));const B=f(e,["responseJsonSchema"]);B!=null&&m(r,["responseJsonSchema"],B);const q=f(e,["routingConfig"]);q!=null&&m(r,["routingConfig"],q);const K=f(e,["modelSelectionConfig"]);K!=null&&m(r,["modelConfig"],K);const te=f(e,["safetySettings"]);if(t!==void 0&&te!=null){let et=te;Array.isArray(et)&&(et=et.map(tt=>tt)),m(t,["safetySettings"],et)}const ee=f(e,["tools"]);if(t!==void 0&&ee!=null){let et=md(ee);Array.isArray(et)&&(et=et.map(tt=>ZL(pd(tt)))),m(t,["tools"],et)}const P=f(e,["toolConfig"]);t!==void 0&&P!=null&&m(t,["toolConfig"],P);const k=f(e,["labels"]);t!==void 0&&k!=null&&m(t,["labels"],k);const b=f(e,["cachedContent"]);t!==void 0&&b!=null&&m(t,["cachedContent"],go(n,b));const F=f(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const D=f(e,["mediaResolution"]);D!=null&&m(r,["mediaResolution"],D);const O=f(e,["speechConfig"]);O!=null&&m(r,["speechConfig"],XL(jI(O)));const M=f(e,["audioTimestamp"]);M!=null&&m(r,["audioTimestamp"],M);const $e=f(e,["thinkingConfig"]);$e!=null&&m(r,["thinkingConfig"],$e);const dt=f(e,["imageConfig"]);return dt!=null&&m(r,["imageConfig"],uX(dt)),r}function zR(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let o=oi(i);Array.isArray(o)&&(o=o.map(l=>h_(l))),m(t,["contents"],o)}const s=f(e,["config"]);return s!=null&&m(t,["generationConfig"],VY(n,s,t)),t}function WR(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["contents"]);if(i!=null){let o=oi(i);Array.isArray(o)&&(o=o.map(l=>l)),m(t,["contents"],o)}const s=f(e,["config"]);return s!=null&&m(t,["generationConfig"],FY(n,s,t)),t}function KR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>sY(d))),m(e,["candidates"],u)}const i=f(n,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const s=f(n,["promptFeedback"]);s!=null&&m(e,["promptFeedback"],s);const o=f(n,["responseId"]);o!=null&&m(e,["responseId"],o);const l=f(n,["usageMetadata"]);return l!=null&&m(e,["usageMetadata"],l),e}function JR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(p=>p)),m(e,["candidates"],d)}const i=f(n,["createTime"]);i!=null&&m(e,["createTime"],i);const s=f(n,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const o=f(n,["promptFeedback"]);o!=null&&m(e,["promptFeedback"],o);const l=f(n,["responseId"]);l!=null&&m(e,["responseId"],l);const u=f(n,["usageMetadata"]);return u!=null&&m(e,["usageMetadata"],u),e}function OY(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const i=f(n,["aspectRatio"]);e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i);const s=f(n,["guidanceScale"]);if(e!==void 0&&s!=null&&m(e,["parameters","guidanceScale"],s),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=f(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&m(e,["parameters","safetySetting"],o);const l=f(n,["personGeneration"]);e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l);const u=f(n,["includeSafetyAttributes"]);e!==void 0&&u!=null&&m(e,["parameters","includeSafetyAttributes"],u);const d=f(n,["includeRaiReason"]);e!==void 0&&d!=null&&m(e,["parameters","includeRaiReason"],d);const p=f(n,["language"]);e!==void 0&&p!=null&&m(e,["parameters","language"],p);const v=f(n,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const w=f(n,["outputCompressionQuality"]);if(e!==void 0&&w!=null&&m(e,["parameters","outputOptions","compressionQuality"],w),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const x=f(n,["imageSize"]);if(e!==void 0&&x!=null&&m(e,["parameters","sampleImageSize"],x),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function UY(n,e){const t={},r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const i=f(n,["negativePrompt"]);e!==void 0&&i!=null&&m(e,["parameters","negativePrompt"],i);const s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const o=f(n,["aspectRatio"]);e!==void 0&&o!=null&&m(e,["parameters","aspectRatio"],o);const l=f(n,["guidanceScale"]);e!==void 0&&l!=null&&m(e,["parameters","guidanceScale"],l);const u=f(n,["seed"]);e!==void 0&&u!=null&&m(e,["parameters","seed"],u);const d=f(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const p=f(n,["personGeneration"]);e!==void 0&&p!=null&&m(e,["parameters","personGeneration"],p);const v=f(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const w=f(n,["includeRaiReason"]);e!==void 0&&w!=null&&m(e,["parameters","includeRaiReason"],w);const x=f(n,["language"]);e!==void 0&&x!=null&&m(e,["parameters","language"],x);const A=f(n,["outputMimeType"]);e!==void 0&&A!=null&&m(e,["parameters","outputOptions","mimeType"],A);const R=f(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&m(e,["parameters","outputOptions","compressionQuality"],R);const L=f(n,["addWatermark"]);e!==void 0&&L!=null&&m(e,["parameters","addWatermark"],L);const j=f(n,["labels"]);e!==void 0&&j!=null&&m(e,["labels"],j);const B=f(n,["imageSize"]);e!==void 0&&B!=null&&m(e,["parameters","sampleImageSize"],B);const q=f(n,["enhancePrompt"]);return e!==void 0&&q!=null&&m(e,["parameters","enhancePrompt"],q),t}function BY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const s=f(e,["config"]);return s!=null&&OY(s,t),t}function qY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const s=f(e,["config"]);return s!=null&&UY(s,t),t}function HY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>eX(o))),m(e,["generatedImages"],s)}const i=f(n,["positivePromptSafetyAttributes"]);return i!=null&&m(e,["positivePromptSafetyAttributes"],QL(i)),e}function GY(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>f_(o))),m(e,["generatedImages"],s)}const i=f(n,["positivePromptSafetyAttributes"]);return i!=null&&m(e,["positivePromptSafetyAttributes"],YL(i)),e}function $Y(n,e){const t={},r=f(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(n,["durationSeconds"]);if(e!==void 0&&i!=null&&m(e,["parameters","durationSeconds"],i),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=f(n,["aspectRatio"]);e!==void 0&&s!=null&&m(e,["parameters","aspectRatio"],s);const o=f(n,["resolution"]);e!==void 0&&o!=null&&m(e,["parameters","resolution"],o);const l=f(n,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=f(n,["negativePrompt"]);e!==void 0&&u!=null&&m(e,["parameters","negativePrompt"],u);const d=f(n,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=f(n,["lastFrame"]);e!==void 0&&p!=null&&m(e,["instances[0]","lastFrame"],p_(p));const v=f(n,["referenceImages"]);if(e!==void 0&&v!=null){let w=v;Array.isArray(w)&&(w=w.map(x=>zX(x))),m(e,["instances[0]","referenceImages"],w)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function jY(n,e){const t={},r=f(n,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=f(n,["fps"]);e!==void 0&&s!=null&&m(e,["parameters","fps"],s);const o=f(n,["durationSeconds"]);e!==void 0&&o!=null&&m(e,["parameters","durationSeconds"],o);const l=f(n,["seed"]);e!==void 0&&l!=null&&m(e,["parameters","seed"],l);const u=f(n,["aspectRatio"]);e!==void 0&&u!=null&&m(e,["parameters","aspectRatio"],u);const d=f(n,["resolution"]);e!==void 0&&d!=null&&m(e,["parameters","resolution"],d);const p=f(n,["personGeneration"]);e!==void 0&&p!=null&&m(e,["parameters","personGeneration"],p);const v=f(n,["pubsubTopic"]);e!==void 0&&v!=null&&m(e,["parameters","pubsubTopic"],v);const w=f(n,["negativePrompt"]);e!==void 0&&w!=null&&m(e,["parameters","negativePrompt"],w);const x=f(n,["enhancePrompt"]);e!==void 0&&x!=null&&m(e,["parameters","enhancePrompt"],x);const A=f(n,["generateAudio"]);e!==void 0&&A!=null&&m(e,["parameters","generateAudio"],A);const R=f(n,["lastFrame"]);e!==void 0&&R!=null&&m(e,["instances[0]","lastFrame"],Ri(R));const L=f(n,["referenceImages"]);if(e!==void 0&&L!=null){let q=L;Array.isArray(q)&&(q=q.map(K=>WX(K))),m(e,["instances[0]","referenceImages"],q)}const j=f(n,["mask"]);e!==void 0&&j!=null&&m(e,["instances[0]","mask"],jX(j));const B=f(n,["compressionQuality"]);return e!==void 0&&B!=null&&m(e,["parameters","compressionQuality"],B),t}function zY(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response","generateVideoResponse"]);return o!=null&&m(e,["response"],QY(o)),e}function WY(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response"]);return o!=null&&m(e,["response"],YY(o)),e}function KY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const s=f(e,["image"]);s!=null&&m(t,["instances[0]","image"],p_(s));const o=f(e,["video"]);o!=null&&m(t,["instances[0]","video"],eV(o));const l=f(e,["source"]);l!=null&&XY(l,t);const u=f(e,["config"]);return u!=null&&$Y(u,t),t}function JY(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const s=f(e,["image"]);s!=null&&m(t,["instances[0]","image"],Ri(s));const o=f(e,["video"]);o!=null&&m(t,["instances[0]","video"],tV(o));const l=f(e,["source"]);l!=null&&ZY(l,t);const u=f(e,["config"]);return u!=null&&jY(u,t),t}function QY(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>nX(o))),m(e,["generatedVideos"],s)}const r=f(n,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function YY(n){const e={},t=f(n,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>rX(o))),m(e,["generatedVideos"],s)}const r=f(n,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function XY(n,e){const t={},r=f(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],p_(i));const s=f(n,["video"]);return e!==void 0&&s!=null&&m(e,["instances[0]","video"],eV(s)),t}function ZY(n,e){const t={},r=f(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],Ri(i));const s=f(n,["video"]);return e!==void 0&&s!=null&&m(e,["instances[0]","video"],tV(s)),t}function eX(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["image"],dX(t));const r=f(n,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const i=f(n,["_self"]);return i!=null&&m(e,["safetyAttributes"],QL(i)),e}function f_(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["image"],JL(t));const r=f(n,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const i=f(n,["_self"]);i!=null&&m(e,["safetyAttributes"],YL(i));const s=f(n,["prompt"]);return s!=null&&m(e,["enhancedPrompt"],s),e}function tX(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["mask"],JL(t));const r=f(n,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["labels"],i)}return e}function nX(n){const e={},t=f(n,["video"]);return t!=null&&m(e,["video"],GX(t)),e}function rX(n){const e={},t=f(n,["_self"]);return t!=null&&m(e,["video"],$X(t)),e}function iX(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const r=f(n,["responseJsonSchema"]);r!=null&&m(e,["responseJsonSchema"],r);const i=f(n,["audioTimestamp"]);i!=null&&m(e,["audioTimestamp"],i);const s=f(n,["candidateCount"]);s!=null&&m(e,["candidateCount"],s);const o=f(n,["enableAffectiveDialog"]);o!=null&&m(e,["enableAffectiveDialog"],o);const l=f(n,["frequencyPenalty"]);l!=null&&m(e,["frequencyPenalty"],l);const u=f(n,["logprobs"]);u!=null&&m(e,["logprobs"],u);const d=f(n,["maxOutputTokens"]);d!=null&&m(e,["maxOutputTokens"],d);const p=f(n,["mediaResolution"]);p!=null&&m(e,["mediaResolution"],p);const v=f(n,["presencePenalty"]);v!=null&&m(e,["presencePenalty"],v);const w=f(n,["responseLogprobs"]);w!=null&&m(e,["responseLogprobs"],w);const x=f(n,["responseMimeType"]);x!=null&&m(e,["responseMimeType"],x);const A=f(n,["responseModalities"]);A!=null&&m(e,["responseModalities"],A);const R=f(n,["responseSchema"]);R!=null&&m(e,["responseSchema"],R);const L=f(n,["routingConfig"]);L!=null&&m(e,["routingConfig"],L);const j=f(n,["seed"]);j!=null&&m(e,["seed"],j);const B=f(n,["speechConfig"]);B!=null&&m(e,["speechConfig"],XL(B));const q=f(n,["stopSequences"]);q!=null&&m(e,["stopSequences"],q);const K=f(n,["temperature"]);K!=null&&m(e,["temperature"],K);const te=f(n,["thinkingConfig"]);te!=null&&m(e,["thinkingConfig"],te);const ee=f(n,["topK"]);ee!=null&&m(e,["topK"],ee);const P=f(n,["topP"]);if(P!=null&&m(e,["topP"],P),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function sX(n,e){const t={},r=f(e,["model"]);return r!=null&&m(t,["_url","name"],ut(n,r)),t}function oX(n,e){const t={},r=f(e,["model"]);return r!=null&&m(t,["_url","name"],ut(n,r)),t}function aX(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function lX(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function cX(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const r=f(n,["imageSize"]);if(r!=null&&m(e,["imageSize"],r),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function uX(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const r=f(n,["imageSize"]);r!=null&&m(e,["imageSize"],r);const i=f(n,["outputMimeType"]);i!=null&&m(e,["imageOutputOptions","mimeType"],i);const s=f(n,["outputCompressionQuality"]);return s!=null&&m(e,["imageOutputOptions","compressionQuality"],s),e}function dX(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&m(e,["imageBytes"],Fa(t));const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function JL(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const r=f(n,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],Fa(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function p_(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&m(e,["bytesBase64Encoded"],Fa(t));const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function Ri(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const r=f(n,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Fa(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function hX(n,e,t){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=f(e,["filter"]);t!==void 0&&o!=null&&m(t,["_query","filter"],o);const l=f(e,["queryBase"]);return t!==void 0&&l!=null&&m(t,["_url","models_url"],qL(n,l)),r}function fX(n,e,t){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=f(e,["filter"]);t!==void 0&&o!=null&&m(t,["_query","filter"],o);const l=f(e,["queryBase"]);return t!==void 0&&l!=null&&m(t,["_url","models_url"],qL(n,l)),r}function pX(n,e){const t={},r=f(e,["config"]);return r!=null&&hX(n,r,t),t}function mX(n,e){const t={},r=f(e,["config"]);return r!=null&&fX(n,r,t),t}function gX(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["_self"]);if(i!=null){let s=HL(i);Array.isArray(s)&&(s=s.map(o=>$0(o))),m(e,["models"],s)}return e}function yX(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["_self"]);if(i!=null){let s=HL(i);Array.isArray(s)&&(s=s.map(o=>j0(o))),m(e,["models"],s)}return e}function _X(n){const e={},t=f(n,["maskMode"]);t!=null&&m(e,["maskMode"],t);const r=f(n,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const i=f(n,["maskDilation"]);return i!=null&&m(e,["dilation"],i),e}function $0(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["displayName"]);r!=null&&m(e,["displayName"],r);const i=f(n,["description"]);i!=null&&m(e,["description"],i);const s=f(n,["version"]);s!=null&&m(e,["version"],s);const o=f(n,["_self"]);o!=null&&m(e,["tunedModelInfo"],MX(o));const l=f(n,["inputTokenLimit"]);l!=null&&m(e,["inputTokenLimit"],l);const u=f(n,["outputTokenLimit"]);u!=null&&m(e,["outputTokenLimit"],u);const d=f(n,["supportedGenerationMethods"]);d!=null&&m(e,["supportedActions"],d);const p=f(n,["temperature"]);p!=null&&m(e,["temperature"],p);const v=f(n,["maxTemperature"]);v!=null&&m(e,["maxTemperature"],v);const w=f(n,["topP"]);w!=null&&m(e,["topP"],w);const x=f(n,["topK"]);x!=null&&m(e,["topK"],x);const A=f(n,["thinking"]);return A!=null&&m(e,["thinking"],A),e}function j0(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["displayName"]);r!=null&&m(e,["displayName"],r);const i=f(n,["description"]);i!=null&&m(e,["description"],i);const s=f(n,["versionId"]);s!=null&&m(e,["version"],s);const o=f(n,["deployedModels"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(w=>bY(w))),m(e,["endpoints"],v)}const l=f(n,["labels"]);l!=null&&m(e,["labels"],l);const u=f(n,["_self"]);u!=null&&m(e,["tunedModelInfo"],LX(u));const d=f(n,["defaultCheckpointId"]);d!=null&&m(e,["defaultCheckpointId"],d);const p=f(n,["checkpoints"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(w=>w)),m(e,["checkpoints"],v)}return e}function vX(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const r=f(n,["codeExecutionResult"]);r!=null&&m(e,["codeExecutionResult"],r);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const s=f(n,["fileData"]);s!=null&&m(e,["fileData"],PY(s));const o=f(n,["functionCall"]);o!=null&&m(e,["functionCall"],DY(o));const l=f(n,["functionResponse"]);l!=null&&m(e,["functionResponse"],l);const u=f(n,["inlineData"]);u!=null&&m(e,["inlineData"],iY(u));const d=f(n,["text"]);d!=null&&m(e,["text"],d);const p=f(n,["thought"]);p!=null&&m(e,["thought"],p);const v=f(n,["thoughtSignature"]);v!=null&&m(e,["thoughtSignature"],v);const w=f(n,["videoMetadata"]);return w!=null&&m(e,["videoMetadata"],w),e}function wX(n){const e={},t=f(n,["productImage"]);return t!=null&&m(e,["image"],Ri(t)),e}function TX(n,e){const t={},r=f(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const i=f(n,["baseSteps"]);e!==void 0&&i!=null&&m(e,["parameters","baseSteps"],i);const s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const o=f(n,["seed"]);e!==void 0&&o!=null&&m(e,["parameters","seed"],o);const l=f(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const u=f(n,["personGeneration"]);e!==void 0&&u!=null&&m(e,["parameters","personGeneration"],u);const d=f(n,["addWatermark"]);e!==void 0&&d!=null&&m(e,["parameters","addWatermark"],d);const p=f(n,["outputMimeType"]);e!==void 0&&p!=null&&m(e,["parameters","outputOptions","mimeType"],p);const v=f(n,["outputCompressionQuality"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","compressionQuality"],v);const w=f(n,["enhancePrompt"]);e!==void 0&&w!=null&&m(e,["parameters","enhancePrompt"],w);const x=f(n,["labels"]);return e!==void 0&&x!=null&&m(e,["labels"],x),t}function EX(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["source"]);i!=null&&xX(i,t);const s=f(e,["config"]);return s!=null&&TX(s,t),t}function IX(n){const e={},t=f(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>f_(i))),m(e,["generatedImages"],r)}return e}function xX(n,e){const t={},r=f(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const i=f(n,["personImage"]);e!==void 0&&i!=null&&m(e,["instances[0]","personImage","image"],Ri(i));const s=f(n,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>wX(l))),m(e,["instances[0]","productImages"],o)}return t}function SX(n){const e={},t=f(n,["referenceImage"]);t!=null&&m(e,["referenceImage"],Ri(t));const r=f(n,["referenceId"]);r!=null&&m(e,["referenceId"],r);const i=f(n,["referenceType"]);i!=null&&m(e,["referenceType"],i);const s=f(n,["maskImageConfig"]);s!=null&&m(e,["maskImageConfig"],_X(s));const o=f(n,["controlImageConfig"]);o!=null&&m(e,["controlImageConfig"],dY(o));const l=f(n,["styleImageConfig"]);l!=null&&m(e,["styleImageConfig"],l);const u=f(n,["subjectImageConfig"]);return u!=null&&m(e,["subjectImageConfig"],u),e}function QL(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const r=f(n,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const i=f(n,["contentType"]);return i!=null&&m(e,["contentType"],i),e}function YL(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const r=f(n,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const i=f(n,["contentType"]);return i!=null&&m(e,["contentType"],i),e}function CX(n){const e={},t=f(n,["category"]);if(t!=null&&m(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(n,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function AX(n){const e={},t=f(n,["image"]);return t!=null&&m(e,["image"],Ri(t)),e}function NX(n,e){const t={},r=f(n,["mode"]);e!==void 0&&r!=null&&m(e,["parameters","mode"],r);const i=f(n,["maxPredictions"]);e!==void 0&&i!=null&&m(e,["parameters","maxPredictions"],i);const s=f(n,["confidenceThreshold"]);e!==void 0&&s!=null&&m(e,["parameters","confidenceThreshold"],s);const o=f(n,["maskDilation"]);e!==void 0&&o!=null&&m(e,["parameters","maskDilation"],o);const l=f(n,["binaryColorThreshold"]);e!==void 0&&l!=null&&m(e,["parameters","binaryColorThreshold"],l);const u=f(n,["labels"]);return e!==void 0&&u!=null&&m(e,["labels"],u),t}function kX(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["source"]);i!=null&&bX(i,t);const s=f(e,["config"]);return s!=null&&NX(s,t),t}function RX(n){const e={},t=f(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>tX(i))),m(e,["generatedMasks"],r)}return e}function bX(n,e){const t={},r=f(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],Ri(i));const s=f(n,["scribbleImage"]);return e!==void 0&&s!=null&&m(e,["instances[0]","scribble"],AX(s)),t}function XL(n){const e={},t=f(n,["languageCode"]);t!=null&&m(e,["languageCode"],t);const r=f(n,["voiceConfig"]);if(r!=null&&m(e,["voiceConfig"],r),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function PX(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],MY(t));const r=f(n,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],r),e}function DX(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(v=>v)),m(e,["functionDeclarations"],p)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(n,["googleSearchRetrieval"]);r!=null&&m(e,["googleSearchRetrieval"],r);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const s=f(n,["fileSearch"]);s!=null&&m(e,["fileSearch"],s);const o=f(n,["codeExecution"]);if(o!=null&&m(e,["codeExecution"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],aX(l));const u=f(n,["googleSearch"]);u!=null&&m(e,["googleSearch"],lX(u));const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function ZL(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(w=>LY(w))),m(e,["functionDeclarations"],v)}const r=f(n,["retrieval"]);r!=null&&m(e,["retrieval"],r);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=f(n,["computerUse"]);if(s!=null&&m(e,["computerUse"],s),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(n,["codeExecution"]);o!=null&&m(e,["codeExecution"],o);const l=f(n,["enterpriseWebSearch"]);l!=null&&m(e,["enterpriseWebSearch"],l);const u=f(n,["googleMaps"]);u!=null&&m(e,["googleMaps"],u);const d=f(n,["googleSearch"]);d!=null&&m(e,["googleSearch"],d);const p=f(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function MX(n){const e={},t=f(n,["baseModel"]);t!=null&&m(e,["baseModel"],t);const r=f(n,["createTime"]);r!=null&&m(e,["createTime"],r);const i=f(n,["updateTime"]);return i!=null&&m(e,["updateTime"],i),e}function LX(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&m(e,["baseModel"],t);const r=f(n,["createTime"]);r!=null&&m(e,["createTime"],r);const i=f(n,["updateTime"]);return i!=null&&m(e,["updateTime"],i),e}function VX(n,e){const t={},r=f(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const i=f(n,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const s=f(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),t}function FX(n,e){const t={},r=f(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const i=f(n,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const s=f(n,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),t}function OX(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","name"],ut(n,r));const i=f(e,["config"]);return i!=null&&VX(i,t),t}function UX(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["config"]);return i!=null&&FX(i,t),t}function BX(n,e){const t={},r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const i=f(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&m(e,["parameters","safetySetting"],i);const s=f(n,["personGeneration"]);e!==void 0&&s!=null&&m(e,["parameters","personGeneration"],s);const o=f(n,["includeRaiReason"]);e!==void 0&&o!=null&&m(e,["parameters","includeRaiReason"],o);const l=f(n,["outputMimeType"]);e!==void 0&&l!=null&&m(e,["parameters","outputOptions","mimeType"],l);const u=f(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&m(e,["parameters","outputOptions","compressionQuality"],u);const d=f(n,["enhanceInputImage"]);e!==void 0&&d!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],d);const p=f(n,["imagePreservationFactor"]);e!==void 0&&p!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const v=f(n,["labels"]);e!==void 0&&v!=null&&m(e,["labels"],v);const w=f(n,["numberOfImages"]);e!==void 0&&w!=null&&m(e,["parameters","sampleCount"],w);const x=f(n,["mode"]);return e!==void 0&&x!=null&&m(e,["parameters","mode"],x),t}function qX(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["_url","model"],ut(n,r));const i=f(e,["image"]);i!=null&&m(t,["instances[0]","image"],Ri(i));const s=f(e,["upscaleFactor"]);s!=null&&m(t,["parameters","upscaleConfig","upscaleFactor"],s);const o=f(e,["config"]);return o!=null&&BX(o,t),t}function HX(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>f_(s))),m(e,["generatedImages"],i)}return e}function GX(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const r=f(n,["encodedVideo"]);r!=null&&m(e,["videoBytes"],Fa(r));const i=f(n,["encoding"]);return i!=null&&m(e,["mimeType"],i),e}function $X(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const r=f(n,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],Fa(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function jX(n){const e={},t=f(n,["image"]);t!=null&&m(e,["_self"],Ri(t));const r=f(n,["maskMode"]);return r!=null&&m(e,["maskMode"],r),e}function zX(n){const e={},t=f(n,["image"]);t!=null&&m(e,["image"],p_(t));const r=f(n,["referenceType"]);return r!=null&&m(e,["referenceType"],r),e}function WX(n){const e={},t=f(n,["image"]);t!=null&&m(e,["image"],Ri(t));const r=f(n,["referenceType"]);return r!=null&&m(e,["referenceType"],r),e}function eV(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const r=f(n,["videoBytes"]);r!=null&&m(e,["encodedVideo"],Fa(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["encoding"],i),e}function tV(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["gcsUri"],t);const r=f(n,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Fa(r));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KX="Content-Type",JX="X-Server-Timeout",QX="User-Agent",z0="x-goog-api-client",YX="1.30.0",XX=`google-genai-sdk/${YX}`,ZX="v1beta1",eZ="v1beta",QR=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tZ{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:ZX,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:eZ,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))i.searchParams.append(o,String(l));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,i){if(t&&t.timeout||i){const s=new AbortController,o=s.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const l=setTimeout(()=>s.abort(),t.timeout);l&&typeof l.unref=="function"&&l.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return t&&t.extraBody!==null&&nZ(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await YR(i),new q0(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await YR(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return wu(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:u}=yield Pt(i.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(u,{stream:!0});try{const v=JSON.parse(d);if("error"in v){const w=JSON.parse(JSON.stringify(v.error)),x=w.status,A=w.code,R=`got status: ${x}. ${JSON.stringify(v)}`;if(A>=400&&A<600)throw new d_({message:R,status:A})}}catch(v){if(v.name==="ApiError")throw v}o+=d;let p=o.match(QR);for(;p;){const v=p[1];try{const w=new Response(v,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pt(new q0(w)),o=o.slice(p[0].length),p=o.match(QR)}catch(w){throw new Error(`exception parsing stream chunk ${v}. ${w}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=XX+" "+this.clientOptions.userAgentExtra;return e[QX]=t,e[z0]=t,e[KX]="application/json",e}async getHeadersInternal(e,t){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(JX,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}getFileName(e){var t;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(t=r.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),r}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const l=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=l;const u={file:i},d=this.getFileName(e),p=ve("upload/v1beta/files",u._url),v=await this.fetchUploadUrl(p,i.sizeBytes,i.mimeType,d,u,t==null?void 0:t.httpOptions);return s.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,r){var i;const s=this.clientOptions.uploader,o=await s.stat(t),l=String(o.size),u=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(t),v={};r!=null&&r.customMetadata&&(v.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(v.chunkingConfig=r.chunkingConfig);const w=await this.fetchUploadUrl(d,l,u,p,v,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(t,w,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,r,i,s,o){var l;let u={};o?u=o:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const d=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:u});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(l=d==null?void 0:d.headers)===null||l===void 0?void 0:l["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function YR(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(r);throw t>=400&&t<600?new d_({message:i,status:t}):new Error(i)}}function nZ(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const s=JSON.parse(n.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))t=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const l=Object.assign({},s);for(const u in o)if(Object.prototype.hasOwnProperty.call(o,u)){const d=o[u],p=l[u];d&&typeof d=="object"&&!Array.isArray(d)&&p&&typeof p=="object"&&!Array.isArray(p)?l[u]=r(p,d):(p&&d&&typeof p!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof p}, New type: ${typeof d}. Overwriting.`),l[u]=d)}return l}const i=r(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rZ="mcp_used/unknown";let iZ=!1;function nV(n){for(const e of n)if(sZ(e)||typeof e=="object"&&"inputSchema"in e)return!0;return iZ}function rV(n){var e;const t=(e=n[z0])!==null&&e!==void 0?e:"";n[z0]=(t+` ${rZ}`).trimStart()}function sZ(n){return n!==null&&typeof n=="object"&&n instanceof WI}function oZ(n,e=100){return wu(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield Pt(n.listTools({cursor:r}));for(const o of s.tools)yield yield Pt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class WI{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new WI(e,t)}async initialize(){var e,t,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const p of this.mcpClients)try{for(var l=!0,u=(t=void 0,Qh(oZ(p))),d;d=await u.next(),e=d.done,!e;l=!0){i=d.value,l=!1;const v=i;o.push(v);const w=v.name;if(s[w])throw new Error(`Duplicate function name ${w} found in MCP tools. Please ensure function names are unique.`);s[w]=p}}catch(v){t={error:v}}finally{try{!l&&!e&&(r=u.return)&&await r.call(u)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),XK(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);t.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aZ(n,e,t){const r=new $K;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(r,i),e(r)}class lZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=dZ(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),u=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const p=new Promise(q=>{d=q}),v=e.callbacks,w=function(){d({})},x=this.apiClient,A={onopen:w,onmessage:q=>{aZ(x,v.onmessage,q)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(q){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(q){}},R=this.webSocketFactory.create(u,uZ(o),A);R.connect(),await p;const B={setup:{model:ut(this.apiClient,e.model)}};return R.send(JSON.stringify(B)),new cZ(R,this.apiClient)}}class cZ{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=JQ(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=KQ(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(cu.PLAY)}pause(){this.sendPlaybackControl(cu.PAUSE)}stop(){this.sendPlaybackControl(cu.STOP)}resetContext(){this.sendPlaybackControl(cu.RESET_CONTEXT)}close(){this.conn.close()}}function uZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function dZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function fZ(n,e,t){const r=new GK;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const s=JSON.parse(i);if(n.isVertexAI()){const o=XQ(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class pZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new lZ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,s,o,l;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let p;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&nV(e.config.tools)&&rV(v);const w=_Z(v);if(this.apiClient.isVertexAI())p=`${u}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(w,p);else{const b=this.apiClient.getApiKey();let F="BidiGenerateContent",D="key";b!=null&&b.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),F="BidiGenerateContentConstrained",D="access_token"),p=`${u}/ws/google.ai.generativelanguage.${d}.GenerativeService.${F}?${D}=${b}`}let x=()=>{};const A=new Promise(b=>{x=b}),R=e.callbacks,L=function(){var b;(b=R==null?void 0:R.onopen)===null||b===void 0||b.call(R),x({})},j=this.apiClient,B={onopen:L,onmessage:b=>{fZ(j,R.onmessage,b)},onerror:(t=R==null?void 0:R.onerror)!==null&&t!==void 0?t:function(b){},onclose:(r=R==null?void 0:R.onclose)!==null&&r!==void 0?r:function(b){}},q=this.webSocketFactory.create(p,yZ(w),B);q.connect(),await A;let K=ut(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&K.startsWith("publishers/")){const b=this.apiClient.getProject(),F=this.apiClient.getLocation();K=`projects/${b}/locations/${F}/`+K}let te={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[zg.AUDIO]}:e.config.responseModalities=[zg.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ee=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],P=[];for(const b of ee)if(this.isCallableTool(b)){const F=b;P.push(await F.tool())}else P.push(b);P.length>0&&(e.config.tools=P);const k={model:K,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?te=WQ(this.apiClient,k):te=zQ(this.apiClient,k),delete te.config,q.send(JSON.stringify(te)),new gZ(q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const mZ={turnComplete:!0};class gZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=oi(t.turns),e.isVertexAI()||(r=r.map(i=>h_(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(hZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},mZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:YQ(e)}:t={realtimeInput:QQ(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function yZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function _Z(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XR=10;function ZR(n){var e,t,r;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Tu(o)){i=!0;break}if(!i)return!0;const s=(r=n==null?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Tu(n){return"callTool"in n&&typeof n.callTool=="function"}function vZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Tu(i)))!==null&&r!==void 0?r:!1}function eb(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((r,i)=>{if(Tu(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&t.push(i)}),t}function tb(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wZ extends mo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,s,o,l;const u=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!vZ(t)||ZR(t.config))return await this.generateContentInternal(u);const d=eb(t);if(d.length>0){const R=d.map(L=>`tools[${L}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${R}.`)}let p,v;const w=oi(u.contents),x=(s=(i=(r=u.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:XR;let A=0;for(;A<x&&(p=await this.generateContentInternal(u),!(!p.functionCalls||p.functionCalls.length===0));){const R=p.candidates[0].content,L=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(Tu(j)){const q=await j.callTool(p.functionCalls);L.push(...q)}A++,v={role:"user",parts:L},u.contents=oi(u.contents),u.contents.push(R),u.contents.push(v),tb(u.config)&&(w.push(R),w.push(v))}return tb(u.config)&&(p.automaticFunctionCallingHistory=w),p},this.generateContentStream=async t=>{var r,i,s,o,l;if(this.maybeMoveToResponseJsonSchem(t),ZR(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const u=eb(t);if(u.length>0){const v=u.map(w=>`tools[${w}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(s=(i=(r=t==null?void 0:t.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,p=(l=(o=t==null?void 0:t.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||l===void 0?void 0:l.disable;if(d&&!p)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((i=u==null?void 0:u.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:o.push(u);let l;return s?l={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:l={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new dc(so.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var r,i,s,o,l,u;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=t.video)===null||r===void 0)&&r.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(s=t.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((u=(l=t.source)===null||l===void 0?void 0:l.video)===null||u===void 0)&&u.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,r,i;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const o=await Promise.all(s.map(async u=>Tu(u)?await u.tool():u)),l={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(l.config.tools=o,e.config&&e.config.tools&&nV(e.config.tools)){const u=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},u);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),rV(d),l.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return l}async initAfcToolsMap(e){var t,r,i;const s=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(Tu(o)){const l=o,u=await l.tool();for(const d of(i=u.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(s.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);s.set(d.name,l)}}return s}async processAfcStream(e){var t,r,i;const s=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:XR;let o=!1,l=0;const u=await this.initAfcToolsMap(e);return(function(d,p,v){var w,x;return wu(this,arguments,function*(){for(var A,R,L,j;l<s;){o&&(l++,o=!1);const te=yield Pt(d.processParamsMaybeAddMcpUsage(v)),ee=yield Pt(d.generateContentStreamInternal(te)),P=[],k=[];try{for(var B=!0,q=(R=void 0,Qh(ee)),K;K=yield Pt(q.next()),A=K.done,!A;B=!0){j=K.value,B=!1;const b=j;if(yield yield Pt(b),b.candidates&&(!((w=b.candidates[0])===null||w===void 0)&&w.content)){k.push(b.candidates[0].content);for(const F of(x=b.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(l<s&&F.functionCall){if(!F.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(F.functionCall.name)){const D=yield Pt(p.get(F.functionCall.name).callTool([F.functionCall]));P.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${F.functionCall.name}`)}}}}catch(b){R={error:b}}finally{try{!B&&!A&&(L=q.return)&&(yield Pt(L.call(q)))}finally{if(R)throw R.error}}if(P.length>0){o=!0;const b=new vh;b.candidates=[{content:{role:"user",parts:P}}],yield yield Pt(b);const F=[];F.push(...k),F.push({role:"user",parts:P});const D=oi(v.contents).concat(F);v.contents=D}else break}})})(this,u,e)}async generateContentInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=WR(this.apiClient,e);return l=ve("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=JR(p),w=new vh;return Object.assign(w,v),w})}else{const d=zR(this.apiClient,e);return l=ve("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=KR(p),w=new vh;return Object.assign(w,v),w})}}async generateContentStreamInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=WR(this.apiClient,e);return l=ve("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(v){return wu(this,arguments,function*(){var w,x,A,R;try{for(var L=!0,j=Qh(v),B;B=yield Pt(j.next()),w=B.done,!w;L=!0){R=B.value,L=!1;const q=R,K=JR(yield Pt(q.json()));K.sdkHttpResponse={headers:q.headers};const te=new vh;Object.assign(te,K),yield yield Pt(te)}}catch(q){x={error:q}}finally{try{!L&&!w&&(A=j.return)&&(yield Pt(A.call(j)))}finally{if(x)throw x.error}}})})}else{const d=zR(this.apiClient,e);return l=ve("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(v){return wu(this,arguments,function*(){var w,x,A,R;try{for(var L=!0,j=Qh(v),B;B=yield Pt(j.next()),w=B.done,!w;L=!0){R=B.value,L=!1;const q=R,K=KR(yield Pt(q.json()));K.sdkHttpResponse={headers:q.headers};const te=new vh;Object.assign(te,K),yield yield Pt(te)}}catch(q){x={error:q}}finally{try{!L&&!w&&(A=j.return)&&(yield Pt(A.call(j)))}finally{if(x)throw x.error}}})})}}async embedContent(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=NY(this.apiClient,e);return l=ve("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=RY(p),w=new RR;return Object.assign(w,v),w})}else{const d=AY(this.apiClient,e);return l=ve("{model}:batchEmbedContents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=kY(p),w=new RR;return Object.assign(w,v),w})}}async generateImagesInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=qY(this.apiClient,e);return l=ve("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=GY(p),w=new bR;return Object.assign(w,v),w})}else{const d=BY(this.apiClient,e);return l=ve("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=HY(p),w=new bR;return Object.assign(w,v),w})}}async editImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=IY(this.apiClient,e);return s=ve("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const d=xY(u),p=new PK;return Object.assign(p,d),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=qX(this.apiClient,e);return s=ve("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const d=HX(u),p=new DK;return Object.assign(p,d),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=EX(this.apiClient,e);return s=ve("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=IX(u),p=new MK;return Object.assign(p,d),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=kX(this.apiClient,e);return s=ve("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=RX(u),p=new LK;return Object.assign(p,d),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=oX(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>j0(p))}else{const d=sX(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>$0(p))}}async listInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=mX(this.apiClient,e);return l=ve("{models_url}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=yX(p),w=new PR;return Object.assign(w,v),w})}else{const d=pX(this.apiClient,e);return l=ve("{models_url}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=gX(p),w=new PR;return Object.assign(w,v),w})}}async update(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=UX(this.apiClient,e);return l=ve("{model}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>j0(p))}else{const d=OX(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>$0(p))}}async delete(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=vY(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=TY(p),w=new DR;return Object.assign(w,v),w})}else{const d=_Y(this.apiClient,e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=wY(p),w=new DR;return Object.assign(w,v),w})}}async countTokens(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=mY(this.apiClient,e);return l=ve("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=yY(p),w=new MR;return Object.assign(w,v),w})}else{const d=pY(this.apiClient,e);return l=ve("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=gY(p),w=new MR;return Object.assign(w,v),w})}}async computeTokens(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=aY(this.apiClient,e);return s=ve("{model}:computeTokens",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>{const d=lY(u),p=new VK;return Object.assign(p,d),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=JY(this.apiClient,e);return l=ve("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>{const v=WY(p),w=new Wg;return Object.assign(w,v),w})}else{const d=KY(this.apiClient,e);return l=ve("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>{const v=zY(p),w=new Wg;return Object.assign(w,v),w})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TZ extends mo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=CK(e);return l=ve("{operationName}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o}else{const d=SK(e);return l=ve("{operationName}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o}}async fetchPredictVideosOperationInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=_K(e);return s=ve("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EZ(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function IZ(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>PZ(s))),m(e,["parts"],i)}const r=f(n,["role"]);return r!=null&&m(e,["role"],r),e}function xZ(n,e,t){const r={},i=f(e,["expireTime"]);t!==void 0&&i!=null&&m(t,["expireTime"],i);const s=f(e,["newSessionExpireTime"]);t!==void 0&&s!=null&&m(t,["newSessionExpireTime"],s);const o=f(e,["uses"]);t!==void 0&&o!=null&&m(t,["uses"],o);const l=f(e,["liveConnectConstraints"]);t!==void 0&&l!=null&&m(t,["bidiGenerateContentSetup"],bZ(n,l));const u=f(e,["lockAdditionalFields"]);return t!==void 0&&u!=null&&m(t,["fieldMask"],u),r}function SZ(n,e){const t={},r=f(e,["config"]);return r!=null&&m(t,["config"],xZ(n,r,t)),t}function CZ(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const r=f(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function AZ(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const r=f(n,["args"]);r!=null&&m(e,["args"],r);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function NZ(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function kZ(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function RZ(n,e){const t={},r=f(n,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const s=f(n,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const o=f(n,["topP"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topP"],o);const l=f(n,["topK"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topK"],l);const u=f(n,["maxOutputTokens"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","maxOutputTokens"],u);const d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","mediaResolution"],d);const p=f(n,["seed"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","seed"],p);const v=f(n,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],zI(v));const w=f(n,["thinkingConfig"]);e!==void 0&&w!=null&&m(e,["setup","generationConfig","thinkingConfig"],w);const x=f(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=f(n,["systemInstruction"]);e!==void 0&&A!=null&&m(e,["setup","systemInstruction"],IZ(Wn(A)));const R=f(n,["tools"]);if(e!==void 0&&R!=null){let ee=md(R);Array.isArray(ee)&&(ee=ee.map(P=>MZ(pd(P)))),m(e,["setup","tools"],ee)}const L=f(n,["sessionResumption"]);e!==void 0&&L!=null&&m(e,["setup","sessionResumption"],DZ(L));const j=f(n,["inputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","inputAudioTranscription"],j);const B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&m(e,["setup","outputAudioTranscription"],B);const q=f(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const K=f(n,["contextWindowCompression"]);e!==void 0&&K!=null&&m(e,["setup","contextWindowCompression"],K);const te=f(n,["proactivity"]);return e!==void 0&&te!=null&&m(e,["setup","proactivity"],te),t}function bZ(n,e){const t={},r=f(e,["model"]);r!=null&&m(t,["setup","model"],ut(n,r));const i=f(e,["config"]);return i!=null&&m(t,["config"],RZ(i,t)),t}function PZ(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const r=f(n,["codeExecutionResult"]);r!=null&&m(e,["codeExecutionResult"],r);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const s=f(n,["fileData"]);s!=null&&m(e,["fileData"],CZ(s));const o=f(n,["functionCall"]);o!=null&&m(e,["functionCall"],AZ(o));const l=f(n,["functionResponse"]);l!=null&&m(e,["functionResponse"],l);const u=f(n,["inlineData"]);u!=null&&m(e,["inlineData"],EZ(u));const d=f(n,["text"]);d!=null&&m(e,["text"],d);const p=f(n,["thought"]);p!=null&&m(e,["thought"],p);const v=f(n,["thoughtSignature"]);v!=null&&m(e,["thoughtSignature"],v);const w=f(n,["videoMetadata"]);return w!=null&&m(e,["videoMetadata"],w),e}function DZ(n){const e={},t=f(n,["handle"]);if(t!=null&&m(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function MZ(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(v=>v)),m(e,["functionDeclarations"],p)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(n,["googleSearchRetrieval"]);r!=null&&m(e,["googleSearchRetrieval"],r);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const s=f(n,["fileSearch"]);s!=null&&m(e,["fileSearch"],s);const o=f(n,["codeExecution"]);if(o!=null&&m(e,["codeExecution"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],NZ(l));const u=f(n,["googleSearch"]);u!=null&&m(e,["googleSearch"],kZ(u));const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LZ(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${t}.${s}`);e.push(...i)}else e.push(t)}return e.join(",")}function VZ(n,e){let t=null;const r=n.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(n.bidiGenerateContentSetup=s,t=s):delete n.bidiGenerateContentSetup}else r!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const s=LZ(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?n.fieldMask=s:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let l=[];i.length>0&&(l=i.map(d=>o.includes(d)?`generationConfig.${d}`:d));const u=[];s&&u.push(s),l.length>0&&u.push(...l),u.length>0?n.fieldMask=u.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class FZ extends mo{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const l=SZ(this.apiClient,e);s=ve("auth_tokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query;const u=VZ(l,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OZ(n,e){const t={},r=f(n,["displayName"]);return e!==void 0&&r!=null&&m(e,["displayName"],r),t}function UZ(n){const e={},t=f(n,["config"]);return t!=null&&OZ(t,e),e}function BZ(n,e){const t={},r=f(n,["force"]);return e!==void 0&&r!=null&&m(e,["_query","force"],r),t}function qZ(n){const e={},t=f(n,["name"]);t!=null&&m(e,["_url","name"],t);const r=f(n,["config"]);return r!=null&&BZ(r,e),e}function HZ(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function GZ(n,e){const t={},r=f(n,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["customMetadata"],s)}const i=f(n,["chunkingConfig"]);return e!==void 0&&i!=null&&m(e,["chunkingConfig"],i),t}function $Z(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const r=f(n,["metadata"]);r!=null&&m(e,["metadata"],r);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const s=f(n,["error"]);s!=null&&m(e,["error"],s);const o=f(n,["response"]);return o!=null&&m(e,["response"],zZ(o)),e}function jZ(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const r=f(n,["fileName"]);r!=null&&m(e,["fileName"],r);const i=f(n,["config"]);return i!=null&&GZ(i,e),e}function zZ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["parent"]);r!=null&&m(e,["parent"],r);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function WZ(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function KZ(n){const e={},t=f(n,["config"]);return t!=null&&WZ(t,e),e}function JZ(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["fileSearchStores"],s)}return e}function QZ(n,e){const t={},r=f(n,["mimeType"]);e!==void 0&&r!=null&&m(e,["mimeType"],r);const i=f(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=f(n,["customMetadata"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>u)),m(e,["customMetadata"],l)}const o=f(n,["chunkingConfig"]);return e!==void 0&&o!=null&&m(e,["chunkingConfig"],o),t}function YZ(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const r=f(n,["config"]);return r!=null&&QZ(r,e),e}function XZ(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZZ(n,e){const t={},r=f(n,["force"]);return e!==void 0&&r!=null&&m(e,["_query","force"],r),t}function eee(n){const e={},t=f(n,["name"]);t!=null&&m(e,["_url","name"],t);const r=f(n,["config"]);return r!=null&&ZZ(r,e),e}function tee(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function nee(n,e){const t={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function ree(n){const e={},t=f(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const r=f(n,["config"]);return r!=null&&nee(r,e),e}function iee(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const r=f(n,["nextPageToken"]);r!=null&&m(e,["nextPageToken"],r);const i=f(n,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class see extends mo{constructor(e){super(),this.apiClient=e,this.list=async t=>new dc(so.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:t.parent,config:r.config}),await this.listInternal(t),t)}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=tee(e);return s=ve("{name}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=eee(e);i=ve("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ree(e);return s=ve("{parent}/documents",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=iee(u),p=new FK;return Object.assign(p,d),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oee extends mo{constructor(e,t=new see(e)){super(),this.apiClient=e,this.documents=t,this.list=async(r={})=>new dc(so.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=UZ(e);return s=ve("fileSearchStores",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async get(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=HZ(e);return s=ve("{name}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(e){var t,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=qZ(e);i=ve("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KZ(e);return s=ve("fileSearchStores",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=JZ(u),p=new OK;return Object.assign(p,d),p})}}async uploadToFileSearchStoreInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=YZ(e);return s=ve("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=XZ(u),p=new UK;return Object.assign(p,d),p})}}async importFile(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=jZ(e);return s=ve("{file_search_store_name}:importFile",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const d=$Z(u),p=new qI;return Object.assign(p,d),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aee(n,e){const t={},r=f(n,["name"]);return r!=null&&m(t,["_url","name"],r),t}function lee(n,e){const t={},r=f(n,["name"]);return r!=null&&m(t,["_url","name"],r),t}function cee(n,e,t){const r={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=f(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&m(e,["displayName"],i),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=f(n,["epochCount"]);e!==void 0&&s!=null&&m(e,["tuningTask","hyperparameters","epochCount"],s);const o=f(n,["learningRateMultiplier"]);if(o!=null&&m(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=f(n,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const u=f(n,["learningRate"]);if(e!==void 0&&u!=null&&m(e,["tuningTask","hyperparameters","learningRate"],u),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function uee(n,e,t){const r={};let i=f(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const x=f(n,["validationDataset"]);e!==void 0&&x!=null&&m(e,["supervisedTuningSpec"],nb(x))}else if(i==="PREFERENCE_TUNING"){const x=f(n,["validationDataset"]);e!==void 0&&x!=null&&m(e,["preferenceOptimizationSpec"],nb(x))}const s=f(n,["tunedModelDisplayName"]);e!==void 0&&s!=null&&m(e,["tunedModelDisplayName"],s);const o=f(n,["description"]);e!==void 0&&o!=null&&m(e,["description"],o);let l=f(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const x=f(n,["epochCount"]);e!==void 0&&x!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],x)}else if(l==="PREFERENCE_TUNING"){const x=f(n,["epochCount"]);e!==void 0&&x!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],x)}let u=f(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const x=f(n,["learningRateMultiplier"]);e!==void 0&&x!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],x)}else if(u==="PREFERENCE_TUNING"){const x=f(n,["learningRateMultiplier"]);e!==void 0&&x!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],x)}let d=f(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const x=f(n,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],x)}else if(d==="PREFERENCE_TUNING"){const x=f(n,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],x)}let p=f(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const x=f(n,["adapterSize"]);e!==void 0&&x!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],x)}else if(p==="PREFERENCE_TUNING"){const x=f(n,["adapterSize"]);e!==void 0&&x!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],x)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=f(n,["labels"]);e!==void 0&&v!=null&&m(e,["labels"],v);const w=f(n,["beta"]);return e!==void 0&&w!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],w),r}function dee(n,e){const t={},r=f(n,["baseModel"]);r!=null&&m(t,["baseModel"],r);const i=f(n,["preTunedModel"]);i!=null&&m(t,["preTunedModel"],i);const s=f(n,["trainingDataset"]);s!=null&&Eee(s);const o=f(n,["config"]);return o!=null&&cee(o,t),t}function hee(n,e){const t={},r=f(n,["baseModel"]);r!=null&&m(t,["baseModel"],r);const i=f(n,["preTunedModel"]);i!=null&&m(t,["preTunedModel"],i);const s=f(n,["trainingDataset"]);s!=null&&Iee(s,t,e);const o=f(n,["config"]);return o!=null&&uee(o,t,e),t}function fee(n,e){const t={},r=f(n,["name"]);return r!=null&&m(t,["_url","name"],r),t}function pee(n,e){const t={},r=f(n,["name"]);return r!=null&&m(t,["_url","name"],r),t}function mee(n,e,t){const r={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=f(n,["pageToken"]);e!==void 0&&s!=null&&m(e,["_query","pageToken"],s);const o=f(n,["filter"]);return e!==void 0&&o!=null&&m(e,["_query","filter"],o),r}function gee(n,e,t){const r={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=f(n,["pageToken"]);e!==void 0&&s!=null&&m(e,["_query","pageToken"],s);const o=f(n,["filter"]);return e!==void 0&&o!=null&&m(e,["_query","filter"],o),r}function yee(n,e){const t={},r=f(n,["config"]);return r!=null&&mee(r,t),t}function _ee(n,e){const t={},r=f(n,["config"]);return r!=null&&gee(r,t),t}function vee(n,e){const t={},r=f(n,["sdkHttpResponse"]);r!=null&&m(t,["sdkHttpResponse"],r);const i=f(n,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const s=f(n,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>iV(l))),m(t,["tuningJobs"],o)}return t}function wee(n,e){const t={},r=f(n,["sdkHttpResponse"]);r!=null&&m(t,["sdkHttpResponse"],r);const i=f(n,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const s=f(n,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>W0(l))),m(t,["tuningJobs"],o)}return t}function Tee(n,e){const t={},r=f(n,["name"]);r!=null&&m(t,["model"],r);const i=f(n,["name"]);return i!=null&&m(t,["endpoint"],i),t}function Eee(n,e){const t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=f(n,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),m(t,["examples","examples"],i)}return t}function Iee(n,e,t){const r={};let i=f(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=f(n,["gcsUri"]);e!==void 0&&o!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=f(n,["gcsUri"]);e!==void 0&&o!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=f(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=f(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=f(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function iV(n,e){const t={},r=f(n,["sdkHttpResponse"]);r!=null&&m(t,["sdkHttpResponse"],r);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const s=f(n,["state"]);s!=null&&m(t,["state"],UL(s));const o=f(n,["createTime"]);o!=null&&m(t,["createTime"],o);const l=f(n,["tuningTask","startTime"]);l!=null&&m(t,["startTime"],l);const u=f(n,["tuningTask","completeTime"]);u!=null&&m(t,["endTime"],u);const d=f(n,["updateTime"]);d!=null&&m(t,["updateTime"],d);const p=f(n,["description"]);p!=null&&m(t,["description"],p);const v=f(n,["baseModel"]);v!=null&&m(t,["baseModel"],v);const w=f(n,["_self"]);return w!=null&&m(t,["tunedModel"],Tee(w)),t}function W0(n,e){const t={},r=f(n,["sdkHttpResponse"]);r!=null&&m(t,["sdkHttpResponse"],r);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const s=f(n,["state"]);s!=null&&m(t,["state"],UL(s));const o=f(n,["createTime"]);o!=null&&m(t,["createTime"],o);const l=f(n,["startTime"]);l!=null&&m(t,["startTime"],l);const u=f(n,["endTime"]);u!=null&&m(t,["endTime"],u);const d=f(n,["updateTime"]);d!=null&&m(t,["updateTime"],d);const p=f(n,["error"]);p!=null&&m(t,["error"],p);const v=f(n,["description"]);v!=null&&m(t,["description"],v);const w=f(n,["baseModel"]);w!=null&&m(t,["baseModel"],w);const x=f(n,["tunedModel"]);x!=null&&m(t,["tunedModel"],x);const A=f(n,["preTunedModel"]);A!=null&&m(t,["preTunedModel"],A);const R=f(n,["supervisedTuningSpec"]);R!=null&&m(t,["supervisedTuningSpec"],R);const L=f(n,["preferenceOptimizationSpec"]);L!=null&&m(t,["preferenceOptimizationSpec"],L);const j=f(n,["tuningDataStats"]);j!=null&&m(t,["tuningDataStats"],j);const B=f(n,["encryptionSpec"]);B!=null&&m(t,["encryptionSpec"],B);const q=f(n,["partnerModelTuningSpec"]);q!=null&&m(t,["partnerModelTuningSpec"],q);const K=f(n,["customBaseModel"]);K!=null&&m(t,["customBaseModel"],K);const te=f(n,["experiment"]);te!=null&&m(t,["experiment"],te);const ee=f(n,["labels"]);ee!=null&&m(t,["labels"],ee);const P=f(n,["outputUri"]);P!=null&&m(t,["outputUri"],P);const k=f(n,["pipelineJob"]);k!=null&&m(t,["pipelineJob"],k);const b=f(n,["serviceAccount"]);b!=null&&m(t,["serviceAccount"],b);const F=f(n,["tunedModelDisplayName"]);F!=null&&m(t,["tunedModelDisplayName"],F);const D=f(n,["veoTuningSpec"]);return D!=null&&m(t,["veoTuningSpec"],D),t}function xee(n,e){const t={},r=f(n,["sdkHttpResponse"]);r!=null&&m(t,["sdkHttpResponse"],r);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const s=f(n,["metadata"]);s!=null&&m(t,["metadata"],s);const o=f(n,["done"]);o!=null&&m(t,["done"],o);const l=f(n,["error"]);return l!=null&&m(t,["error"],l),t}function nb(n,e){const t={},r=f(n,["gcsUri"]);r!=null&&m(t,["validationDatasetUri"],r);const i=f(n,["vertexDatasetResource"]);return i!=null&&m(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class See extends mo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new dc(so.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{var r;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((r=t.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},t),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:B0.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=pee(e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>W0(p))}else{const d=fee(e);return l=ve("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>iV(p))}}async listInternal(e){var t,r,i,s;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=_ee(e);return l=ve("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=wee(p),w=new LR;return Object.assign(w,v),w})}else{const d=yee(e);return l=ve("tunedModels",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(v=>{const w=v;return w.sdkHttpResponse={headers:p.headers},w})),o.then(p=>{const v=vee(p),w=new LR;return Object.assign(w,v),w})}}async cancel(e){var t,r,i,s;let o="",l={};if(this.apiClient.isVertexAI()){const u=lee(e);o=ve("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=aee(e);o=ve("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const l=hee(e,e);return s=ve("tuningJobs",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>W0(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=dee(e);return s=ve("tunedModels",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const p=d;return p.sdkHttpResponse={headers:u.headers},p})),i.then(u=>xee(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cee{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Aee=1024*1024*8,Nee=3,kee=1e3,Ree=2,Jg="x-goog-upload-status";async function bee(n,e,t){var r;const i=await sV(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Jg])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function Pee(n,e,t){var r;const i=await sV(n,e,t),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Jg])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=DL(s),l=new HI;return Object.assign(l,o),l}async function sV(n,e,t){var r,i;let s=0,o=0,l=new q0(new Response),u="upload";for(s=n.size;o<s;){const d=Math.min(Aee,s-o),p=n.slice(o,o+d);o+d>=s&&(u+=", finalize");let v=0,w=kee;for(;v<Nee&&(l=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(o),"Content-Length":String(d)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[Jg]));)v++,await Mee(w),w=w*Ree;if(o+=d,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[Jg])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return l}async function Dee(n){return{size:n.size,type:n.type}}function Mee(n){return new Promise(e=>setTimeout(e,n))}class Lee{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bee(e,t,r)}async uploadToFileSearchStore(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Pee(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Dee(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vee{create(e,t,r){return new Fee(e,t,r)}}class Fee{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rb="x-goog-api-key";class Oee{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(rb)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(rb,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uee="gl-node/";class oV{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=gK(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new Oee(this.apiKey);this.apiClient=new tZ({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Uee+"web",uploader:new Lee,downloader:new Cee}),this.models=new wZ(this.apiClient),this.live=new pZ(this.apiClient,i,new Vee),this.batches=new jJ(this.apiClient),this.chats=new CQ(this.models,this.apiClient),this.caches=new IQ(this.apiClient),this.files=new VQ(this.apiClient),this.operations=new TZ(this.apiClient),this.authTokens=new FZ(this.apiClient),this.tunings=new See(this.apiClient),this.fileSearchStores=new oee(this.apiClient)}}const aV="AIzaSyDFTZ0D_EOchhykhh9QqBxSyy2wO1tpn-c",Bee=async(n,e,t)=>{var l;console.group(" [GeminiService] Start");const r=`
        ${t.projectContext}

        DI Y L D LIU HIN TI CA NN TNG:
        - Cng vic mu: ${JSON.stringify(t.jobs.slice(0,3))}
        - Bo him: ${JSON.stringify(t.insuranceInfo)}
        
        HY TR LI NGN GN, THN THIN.
    `,s=e.filter((u,d)=>!0).map(u=>({role:u.author===El.User?"user":"model",parts:[{text:u.text}]})),o=(u,d,p)=>Promise.race([fetch(u,d),new Promise((v,w)=>setTimeout(()=>w(new Error(`Request timed out after ${p}ms`)),p))]);try{console.log(" [Step 1] Th gi Backend (/api/chat)...");const u=await o("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,history:s,systemInstruction:r})},5e3),d=u.headers.get("content-type");if(u.ok&&d&&d.includes("application/json")){const p=await u.json();if(p.text)return console.log(" [Backend Vercel] Thnh cng!"),console.groupEnd(),p.text}throw new Error("Backend response invalid or 404")}catch(u){console.warn(` [Backend Error] ${u instanceof Error?u.message:"Failed"}. Chuyn sang phng n d phng.`),console.log(" [Step 2] Gi trc tip (Client SDK)...");try{const p=await new oV({apiKey:aV}).models.generateContent({model:"gemini-2.5-flash",contents:[...s,{role:"user",parts:[{text:n}]}],config:{systemInstruction:r}});return console.log(" [Client SDK] Thnh cng!"),console.groupEnd(),p.text||"Xin li, ti khng th tr li lc ny."}catch(d){return console.error(" [Critical] C 2 cch u tht bi:",d),console.groupEnd(),(l=d.message)!=null&&l.includes("403")||d.toString().includes("PERMISSION_DENIED")?" Li quyn truy cp (API Key b chn). Vui lng kim tra cu hnh Key trn Google Cloud Console (b gii hn Android App nu ang chy Web).":" H thng ang bo tr hoc mt kt ni mng. Vui lng th li sau t pht."}}},qee=async(n,e)=>{var s;if(!e.length)return[];const t=e.map(o=>{var l;return{id:o.id,title:o.title,description:o.description.substring(0,500),pay:`${o.payRate} ${o.payType}`,distance:`${(l=o.distance)==null?void 0:l.toFixed(1)} km`,type:o.jobType,employer:o.employerName}}),r={name:n.fullName,bio:n.bio,skills:n.skills,history:(s=n.workHistory)==null?void 0:s.map(o=>`${o.title} ti ${o.company}`)},i=`
        Bn l chuyn gia t vn ngh nghip AI. Hy phn tch mc  ph hp ca cc cng vic sau cho ngi dng ny.
        
        NGI DNG: ${JSON.stringify(r)}
        
        DANH SCH CNG VIC ( lc theo bn knh): ${JSON.stringify(t)}

        YU CU PHN TCH:
        nh gi tng cng vic da trn:
        1. Khong cch (cng gn cng tt).
        2. K nng & Kinh nghim ph hp.
        3. Mc lng & Loi hnh (Thi v/Bn thi gian...).
        4. Phn tch Ri ro & Mi trng (da trn m t v tn cng vic).
        5.  tui/Gii tnh (suy lun logic t m t nu c yu cu ngm, v d bc vc nng cn sc khe tt).

        OUTPUT JSON FORMAT (BT BUC):
        Tr v mng JSON thun ty, khng markdown:
        [
            {
                "jobId": "id_ca_job",
                "matchScore": 85, // S nguyn 0-100
                "reason": "L do chnh ti sao ph hp (ngn gn)",
                "pros": ["im mnh 1", "im mnh 2"],
                "cons": ["Ri ro hoc im yu"],
                "environmentAnalysis": "Nhn xt v mi trng/tnh cht (vd: Ngoi tri, n o, vn phng...)"
            }
        ]
    `;try{const u=(await new oV({apiKey:aV}).models.generateContent({model:"gemini-2.5-flash",contents:[{role:"user",parts:[{text:i}]}],config:{responseMimeType:"application/json",temperature:.3}})).text;return u?JSON.parse(u).sort((p,v)=>v.matchScore-p.matchScore):[]}catch(o){return console.error("Error analyzing jobs:",o),[]}},KI="ai_conversations",Hee=(n,e)=>Ye.collection("users").doc(n).collection(KI).orderBy("timestamp","asc").onSnapshot(i=>{const s=[];i.forEach(o=>{const l=o.data();s.push({author:l.author,text:l.text})}),e(s)},i=>{console.error("Error fetching AI chat history:",i),e([])}),ib=async(n,e)=>{try{await Ye.collection("users").doc(n).collection(KI).add({text:e.text,author:e.author,timestamp:io()})}catch(t){console.error("Error saving AI chat message:",t)}},Gee=async n=>{try{const t=await Ye.collection("users").doc(n).collection(KI).get(),r=Ye.batch();t.docs.forEach(i=>{r.delete(i.ref)}),await r.commit()}catch(e){throw console.error("Error clearing AI chat history:",e),e}},lV=({className:n="w-8 h-8"})=>y.jsx("div",{className:`flex items-center justify-center rounded-full bg-indigo-500 text-white ${n}`,children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})})});function JI(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let hc=JI();function cV(n){hc=n}const uV=/[&<>"']/,$ee=new RegExp(uV.source,"g"),dV=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,jee=new RegExp(dV.source,"g"),zee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},sb=n=>zee[n];function Vr(n,e){if(e){if(uV.test(n))return n.replace($ee,sb)}else if(dV.test(n))return n.replace(jee,sb);return n}const Wee=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Kee(n){return n.replace(Wee,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Jee=/(^|[^\[])\^/g;function wt(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(i,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(Jee,"$1"),t=t.replace(i,o),r},getRegex:()=>new RegExp(t,e)};return r}function ob(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Yh={exec:()=>null};function ab(n,e){const t=n.replace(/\|/g,(s,o,l)=>{let u=!1,d=o;for(;--d>=0&&l[d]==="\\";)u=!u;return u?"|":" |"}),r=t.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function Lm(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function Qee(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function lb(n,e,t,r){const i=e.href,s=e.title?Vr(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const l={type:"link",raw:t,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}return{type:"image",raw:t,href:i,title:s,text:Vr(o)}}function Yee(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}class Qg{constructor(e){bt(this,"options");bt(this,"rules");bt(this,"lexer");this.options=e||hc}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Lm(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=Yee(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const i=Lm(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=Lm(r.replace(/^ *>[ \t]?/gm,""),`
`);const i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let l="",u="",d=!1;for(;e;){let p=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;l=t[0],e=e.substring(l.length);let v=t[2].split(`
`,1)[0].replace(/^\t+/,j=>" ".repeat(3*j.length)),w=e.split(`
`,1)[0],x=0;this.options.pedantic?(x=2,u=v.trimStart()):(x=t[2].search(/[^ ]/),x=x>4?1:x,u=v.slice(x),x+=t[1].length);let A=!1;if(!v&&/^ *$/.test(w)&&(l+=w+`
`,e=e.substring(w.length+1),p=!0),!p){const j=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),B=new RegExp(`^ {0,${Math.min(3,x-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),q=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:\`\`\`|~~~)`),K=new RegExp(`^ {0,${Math.min(3,x-1)}}#`);for(;e;){const te=e.split(`
`,1)[0];if(w=te,this.options.pedantic&&(w=w.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),q.test(w)||K.test(w)||j.test(w)||B.test(e))break;if(w.search(/[^ ]/)>=x||!w.trim())u+=`
`+w.slice(x);else{if(A||v.search(/[^ ]/)>=4||q.test(v)||K.test(v)||B.test(v))break;u+=`
`+w}!A&&!w.trim()&&(A=!0),l+=te+`
`,e=e.substring(te.length+1),v=w.slice(x)}}s.loose||(d?s.loose=!0:/\n *\n *$/.test(l)&&(d=!0));let R=null,L;this.options.gfm&&(R=/^\[[ xX]\] /.exec(u),R&&(L=R[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:l,task:!!R,checked:L,loose:!1,text:u,tokens:[]}),s.raw+=l}s.items[s.items.length-1].raw=l.trimEnd(),s.items[s.items.length-1].text=u.trimEnd(),s.raw=s.raw.trimEnd();for(let p=0;p<s.items.length;p++)if(this.lexer.state.top=!1,s.items[p].tokens=this.lexer.blockTokens(s.items[p].text,[]),!s.loose){const v=s.items[p].tokens.filter(x=>x.type==="space"),w=v.length>0&&v.some(x=>/\n.*\n/.test(x.raw));s.loose=w}if(s.loose)for(let p=0;p<s.items.length;p++)s.items[p].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:i,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=ab(t[1]),i=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const l of i)/^ *-+: *$/.test(l)?o.align.push("right"):/^ *:-+: *$/.test(l)?o.align.push("center"):/^ *:-+ *$/.test(l)?o.align.push("left"):o.align.push(null);for(const l of r)o.header.push({text:l,tokens:this.lexer.inline(l)});for(const l of s)o.rows.push(ab(l,o.header.length).map(u=>({text:u,tokens:this.lexer.inline(u)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Vr(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const o=Lm(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=Qee(t[2],"()");if(o>-1){const u=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,u).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),lb(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(/\s+/g," "),s=t[i.toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return lb(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const o=[...i[0]].length-1;let l,u,d=o,p=0;const v=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,t=t.slice(-1*e.length+o);(i=v.exec(t))!=null;){if(l=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!l)continue;if(u=[...l].length,i[3]||i[4]){d+=u;continue}else if((i[5]||i[6])&&o%3&&!((o+u)%3)){p+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+p);const w=[...i[0]][0].length,x=e.slice(0,o+i.index+w+u);if(Math.min(o,u)%2){const R=x.slice(1,-1);return{type:"em",raw:x,text:R,tokens:this.lexer.inlineTokens(R)}}const A=x.slice(2,-2);return{type:"strong",raw:x,text:A,tokens:this.lexer.inlineTokens(A)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=Vr(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,i;return t[2]==="@"?(r=Vr(t[1]),i="mailto:"+r):(r=Vr(t[1]),i=r),{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=Vr(t[0]),s="mailto:"+i;else{let o;do o=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(o!==t[0]);i=Vr(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=Vr(t[0]),{type:"text",raw:t[0],text:r}}}}const Xee=/^(?: *(?:\n|$))+/,Zee=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,ete=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,fp=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,tte=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hV=/(?:[*+-]|\d{1,9}[.)])/,fV=wt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,hV).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),QI=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,nte=/^[^\n]+/,YI=/(?!\s*\])(?:\\.|[^\[\]\\])+/,rte=wt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",YI).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ite=wt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,hV).getRegex(),m_="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",XI=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ste=wt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",XI).replace("tag",m_).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pV=wt(QI).replace("hr",fp).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m_).getRegex(),ote=wt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pV).getRegex(),ZI={blockquote:ote,code:Zee,def:rte,fences:ete,heading:tte,hr:fp,html:ste,lheading:fV,list:ite,newline:Xee,paragraph:pV,table:Yh,text:nte},cb=wt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",fp).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m_).getRegex(),ate={...ZI,table:cb,paragraph:wt(QI).replace("hr",fp).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",cb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m_).getRegex()},lte={...ZI,html:wt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",XI).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yh,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:wt(QI).replace("hr",fp).replace("heading",` *#{1,6} *[^
]`).replace("lheading",fV).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},mV=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,cte=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,gV=/^( {2,}|\\)\n(?!\s*$)/,ute=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pp="\\p{P}\\p{S}",dte=wt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,pp).getRegex(),hte=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,fte=wt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,pp).getRegex(),pte=wt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,pp).getRegex(),mte=wt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,pp).getRegex(),gte=wt(/\\([punct])/,"gu").replace(/punct/g,pp).getRegex(),yte=wt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_te=wt(XI).replace("(?:-->|$)","-->").getRegex(),vte=wt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_te).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Yg=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,wte=wt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Yg).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),yV=wt(/^!?\[(label)\]\[(ref)\]/).replace("label",Yg).replace("ref",YI).getRegex(),_V=wt(/^!?\[(ref)\](?:\[\])?/).replace("ref",YI).getRegex(),Tte=wt("reflink|nolink(?!\\()","g").replace("reflink",yV).replace("nolink",_V).getRegex(),ex={_backpedal:Yh,anyPunctuation:gte,autolink:yte,blockSkip:hte,br:gV,code:cte,del:Yh,emStrongLDelim:fte,emStrongRDelimAst:pte,emStrongRDelimUnd:mte,escape:mV,link:wte,nolink:_V,punctuation:dte,reflink:yV,reflinkSearch:Tte,tag:vte,text:ute,url:Yh},Ete={...ex,link:wt(/^!?\[(label)\]\((.*?)\)/).replace("label",Yg).getRegex(),reflink:wt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Yg).getRegex()},K0={...ex,escape:wt(mV).replace("])","~|])").getRegex(),url:wt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ite={...K0,br:wt(gV).replace("{2,}","*").getRegex(),text:wt(K0.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Vm={normal:ZI,gfm:ate,pedantic:lte},wh={normal:ex,gfm:K0,breaks:Ite,pedantic:Ete};class os{constructor(e){bt(this,"tokens");bt(this,"options");bt(this,"state");bt(this,"tokenizer");bt(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||hc,this.options.tokenizer=this.options.tokenizer||new Qg,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Vm.normal,inline:wh.normal};this.options.pedantic?(t.block=Vm.pedantic,t.inline=wh.pedantic):this.options.gfm&&(t.block=Vm.gfm,this.options.breaks?t.inline=wh.breaks:t.inline=wh.gfm),this.tokenizer.rules=t}static get rules(){return{block:Vm,inline:wh}}static lex(e,t){return new os(t).lex(e)}static lexInline(e,t){return new os(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(l,u,d)=>u+"    ".repeat(d.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(r=l.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(p=>{d=p.call({lexer:this},u),typeof d=="number"&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(s=e.substring(0,l+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,i,s,o=e,l,u,d;if(this.tokens.links){const p=Object.keys(this.tokens.links);if(p.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)p.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,l.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(u||(d=""),u=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(p=>(r=p.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,d)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let p=1/0;const v=e.slice(1);let w;this.options.extensions.startInline.forEach(x=>{w=x.call({lexer:this},v),typeof w=="number"&&w>=0&&(p=Math.min(p,w))}),p<1/0&&p>=0&&(s=e.substring(0,p+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(d=r.raw.slice(-1)),u=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){const p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return t}}class Xg{constructor(e){bt(this,"options");this.options=e||hc}code(e,t,r){var s;const i=(s=(t||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Vr(i)+'">'+(r?e:Vr(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:Vr(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const i=t?"ol":"ul",s=t&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const i=ob(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image(e,t,r){const i=ob(e);if(i===null)return r;e=i;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class tx{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class as{constructor(e){bt(this,"options");bt(this,"renderer");bt(this,"textRenderer");this.options=e||hc,this.options.renderer=this.options.renderer||new Xg,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new tx}static parse(e,t){return new as(t).parse(e)}static parseInline(e,t){return new as(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=l||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Kee(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=s;let l="",u="";for(let p=0;p<o.header.length;p++)u+=this.renderer.tablecell(this.parseInline(o.header[p].tokens),{header:!0,align:o.align[p]});l+=this.renderer.tablerow(u);let d="";for(let p=0;p<o.rows.length;p++){const v=o.rows[p];u="";for(let w=0;w<v.length;w++)u+=this.renderer.tablecell(this.parseInline(v[w].tokens),{header:!1,align:o.align[w]});d+=this.renderer.tablerow(u)}r+=this.renderer.table(l,d);continue}case"blockquote":{const o=s,l=this.parse(o.tokens);r+=this.renderer.blockquote(l);continue}case"list":{const o=s,l=o.ordered,u=o.start,d=o.loose;let p="";for(let v=0;v<o.items.length;v++){const w=o.items[v],x=w.checked,A=w.task;let R="";if(w.task){const L=this.renderer.checkbox(!!x);d?w.tokens.length>0&&w.tokens[0].type==="paragraph"?(w.tokens[0].text=L+" "+w.tokens[0].text,w.tokens[0].tokens&&w.tokens[0].tokens.length>0&&w.tokens[0].tokens[0].type==="text"&&(w.tokens[0].tokens[0].text=L+" "+w.tokens[0].tokens[0].text)):w.tokens.unshift({type:"text",text:L+" "}):R+=L+" "}R+=this.parse(w.tokens,d),p+=this.renderer.listitem(R,A,!!x)}r+=this.renderer.list(p,l,u);continue}case"html":{const o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,l=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],l+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=t?this.renderer.paragraph(l):l;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{const o=s;r+=t.text(o.text);break}case"html":{const o=s;r+=t.html(o.text);break}case"link":{const o=s;r+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=s;r+=t.image(o.href,o.title,o.text);break}case"strong":{const o=s;r+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=s;r+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=s;r+=t.codespan(o.text);break}case"br":{r+=t.br();break}case"del":{const o=s;r+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=s;r+=t.text(o.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}}class Xh{constructor(e){bt(this,"options");this.options=e||hc}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}bt(Xh,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var tc,J0,vV;class xte{constructor(...e){dC(this,tc);bt(this,"defaults",JI());bt(this,"options",this.setOptions);bt(this,"parse",Im(this,tc,J0).call(this,os.lex,as.parse));bt(this,"parseInline",Im(this,tc,J0).call(this,os.lexInline,as.parseInline));bt(this,"Parser",as);bt(this,"Renderer",Xg);bt(this,"TextRenderer",tx);bt(this,"Lexer",os);bt(this,"Tokenizer",Qg);bt(this,"Hooks",Xh);this.use(...e)}walkTokens(e,t){var i,s;let r=[];for(const o of e)switch(r=r.concat(t.call(this,o)),o.type){case"table":{const l=o;for(const u of l.header)r=r.concat(this.walkTokens(u.tokens,t));for(const u of l.rows)for(const d of u)r=r.concat(this.walkTokens(d.tokens,t));break}case"list":{const l=o;r=r.concat(this.walkTokens(l.items,t));break}default:{const l=o;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[l.type]?this.defaults.extensions.childTokens[l.type].forEach(u=>{const d=l[u].flat(1/0);r=r.concat(this.walkTokens(d,t))}):l.tokens&&(r=r.concat(this.walkTokens(l.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];o?t.renderers[s.name]=function(...l){let u=s.renderer.apply(this,l);return u===!1&&(u=o.apply(this,l)),u}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),r.renderer){const s=this.defaults.renderer||new Xg(this.defaults);for(const o in r.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const l=o,u=r.renderer[l],d=s[l];s[l]=(...p)=>{let v=u.apply(s,p);return v===!1&&(v=d.apply(s,p)),v||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new Qg(this.defaults);for(const o in r.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const l=o,u=r.tokenizer[l],d=s[l];s[l]=(...p)=>{let v=u.apply(s,p);return v===!1&&(v=d.apply(s,p)),v}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new Xh;for(const o in r.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const l=o,u=r.hooks[l],d=s[l];Xh.passThroughHooks.has(o)?s[l]=p=>{if(this.defaults.async)return Promise.resolve(u.call(s,p)).then(w=>d.call(s,w));const v=u.call(s,p);return d.call(s,v)}:s[l]=(...p)=>{let v=u.apply(s,p);return v===!1&&(v=d.apply(s,p)),v}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(l){let u=[];return u.push(o.call(this,l)),s&&(u=u.concat(s.call(this,l))),u}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return os.lex(e,t??this.defaults)}parser(e,t){return as.parse(e,t??this.defaults)}}tc=new WeakSet,J0=function(e,t){return(r,i)=>{const s={...i},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const l=Im(this,tc,vV).call(this,!!o.silent,!!o.async);if(typeof r>"u"||r===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(u=>e(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>t(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(l);try{o.hooks&&(r=o.hooks.preprocess(r));let u=e(r,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=t(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return l(u)}}},vV=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Vr(r.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(r);throw r}};const ec=new xte;function yt(n,e){return ec.parse(n,e)}yt.options=yt.setOptions=function(n){return ec.setOptions(n),yt.defaults=ec.defaults,cV(yt.defaults),yt};yt.getDefaults=JI;yt.defaults=hc;yt.use=function(...n){return ec.use(...n),yt.defaults=ec.defaults,cV(yt.defaults),yt};yt.walkTokens=function(n,e){return ec.walkTokens(n,e)};yt.parseInline=ec.parseInline;yt.Parser=as;yt.parser=as.parse;yt.Renderer=Xg;yt.TextRenderer=tx;yt.Lexer=os;yt.lexer=os.lex;yt.Tokenizer=Qg;yt.Hooks=Xh;yt.parse=yt;yt.options;yt.setOptions;yt.use;yt.walkTokens;yt.parseInline;const Ste=yt;as.parse;os.lex;const Cte=({content:n})=>{const[e,t]=Q.useState("");return Q.useEffect(()=>{(async()=>{try{const i=await Ste(n);t(i)}catch(i){console.error("Markdown parse error",i),t(n)}})()},[n]),y.jsx("div",{className:"markdown-content text-sm",dangerouslySetInnerHTML:{__html:e}})},Ate=({message:n})=>{const e=n.author===El.User;return y.jsxs("div",{className:`flex items-start gap-3 ${e?"justify-end":""}`,children:[!e&&y.jsx(lV,{}),y.jsx("div",{className:`max-w-[85%] md:max-w-lg px-4 py-3 rounded-2xl shadow-sm ${e?"bg-blue-500 text-white rounded-br-none":"bg-white border border-gray-100 text-gray-800 rounded-bl-none"}`,children:e?y.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.text}):y.jsx(Cte,{content:n.text})}),e&&y.jsx(Na,{})]})},Nte=({allJobs:n})=>{const{currentUser:e}=po(),[t,r]=Q.useState([]),[i,s]=Q.useState(""),[o,l]=Q.useState(!1),u=Q.useRef(null),d={author:El.Bot,text:"Xin cho! Ti c th gip g cho bn v cng vic hoc chnh sch bo him x hi?"};Q.useEffect(()=>{if(!e)return;const x=Hee(e.uid,A=>{A.length===0?r([d]):r(A)});return()=>x()},[e]);const p=()=>{var x;(x=u.current)==null||x.scrollIntoView({behavior:"smooth"})};Q.useEffect(p,[t,o]);const v=async x=>{if(x.preventDefault(),!i.trim()||o||!e)return;const A=i,R={author:El.User,text:A};s(""),l(!0);try{await ib(e.uid,R);const L={jobs:n,insuranceInfo:CL,projectContext:nK},j=[...t,R],B=await Bee(A,j,L),q={author:El.Bot,text:B};await ib(e.uid,q)}catch(L){console.error("Chat error:",L);const j={author:El.Bot,text:"Xin li, ti ang gp s c kt ni. Vui lng th li sau."};r(B=>[...B,j])}finally{l(!1)}},w=async()=>{e&&window.confirm("Bn c chc mun xa ton b lch s tr chuyn khng?")&&(await Gee(e.uid),r([d]))};return y.jsxs("div",{className:"flex flex-col h-full bg-gray-50 rounded-lg shadow-md overflow-hidden relative",children:[y.jsx("style",{children:`
            .markdown-content ul {
                list-style-type: disc;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content ol {
                list-style-type: decimal;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content li {
                margin-bottom: 0.25em;
                line-height: 1.5;
            }
            .markdown-content p {
                margin-bottom: 0.75em;
                line-height: 1.6;
            }
            .markdown-content p:last-child {
                margin-bottom: 0;
            }
            .markdown-content strong {
                font-weight: 700;
                color: #111827; /* gray-900 */
            }
            .markdown-content em {
                font-style: italic;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3 {
                font-weight: 700;
                margin-top: 1em;
                margin-bottom: 0.5em;
                color: #1f2937; /* gray-800 */
                font-size: 1em; /* Keep text size consistent but bold */
            }
            .markdown-content a {
                color: #2563eb; /* blue-600 */
                text-decoration: underline;
            }
        `}),y.jsxs("div",{className:"px-4 py-3 bg-white border-b flex justify-between items-center shadow-sm z-10",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs("span",{className:"relative flex h-3 w-3",children:[y.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),y.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),y.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tr l AI An Tm"})]}),t.length>1&&y.jsx("button",{onClick:w,className:"text-gray-400 hover:text-red-500 transition-colors p-1.5 rounded-full hover:bg-gray-100",title:"Xa lch s tr chuyn",children:y.jsx(UI,{className:"w-5 h-5"})})]}),y.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto bg-slate-50",children:[t.map((x,A)=>y.jsx(Ate,{message:x},A)),o&&y.jsxs("div",{className:"flex items-start gap-3 animate-pulse",children:[y.jsx(lV,{}),y.jsx("div",{className:"bg-white border border-gray-100 text-gray-800 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm",children:y.jsxs("div",{className:"flex items-center space-x-1.5",children:[y.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),y.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),y.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce"})]})})]}),y.jsx("div",{ref:u})]}),y.jsx("div",{className:"p-4 bg-white border-t shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:y.jsxs("form",{onSubmit:v,className:"flex items-center space-x-3",children:[y.jsx("input",{type:"text",value:i,onChange:x=>s(x.target.value),placeholder:"Hi v vic lm, bo him...",className:"flex-1 p-3 px-4 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 shadow-sm",disabled:o}),y.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-all duration-300 shadow-md hover:shadow-lg transform active:scale-95",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]})},kte=async(n,e,t="",r="")=>{if(e.userType!=="WORKER")throw new Error("Only workers can apply for jobs.");if(!e.fullName)throw new Error("Worker must have a full name to apply.");const i=`${n.id}_${e.uid}`,s=Ye.collection("applications").doc(i);if((await s.get()).exists)throw new Error("You have already applied for this job.");const l={jobId:n.id,jobTitle:n.title,workerId:e.uid,workerName:e.fullName,workerProfileImageUrl:e.profileImageUrl||null,employerId:n.employerId,employerName:n.employerName,employerProfileImageUrl:n.employerProfileUrl||null,applicationDate:io(),status:"pending",cvUrl:e.cvUrl||null,cvName:e.cvName||null,introduction:t,contactPhoneNumber:r||e.phoneNumber||""};await s.set(l),await FI(n.employerId,$s.NEW_APPLICATION,`${e.fullName} va ng tuyn vo cng vic: "${n.title}"`,"/profile")},Rte=async(n,e)=>{const t=`${n}_${e}`;return(await Ye.collection("applications").doc(t).get()).exists},bte=n=>Ye.collection("applications").onSnapshot(r=>{const i={};r.forEach(s=>{const l=s.data().jobId;l&&(i[l]=(i[l]||0)+1)}),n(i)},r=>{console.error("Error fetching application counts: ",r),n({})}),Pte=(n,e)=>Ye.collection("applications").where("employerId","==",n).onSnapshot(s=>{const o=[];s.forEach(l=>{var v;const u=l.data(),d=(v=u.applicationDate)!=null&&v.toDate?u.applicationDate.toDate().toISOString():new Date().toISOString(),p={id:l.id,jobId:u.jobId,jobTitle:u.jobTitle,workerId:u.workerId,workerName:u.workerName,employerName:u.employerName||"Khng r",workerProfileImageUrl:u.workerProfileImageUrl,employerId:u.employerId,employerProfileImageUrl:u.employerProfileImageUrl,applicationDate:d,status:u.status,cvUrl:u.cvUrl||null,cvName:u.cvName||null,introduction:u.introduction||"",contactPhoneNumber:u.contactPhoneNumber||""};o.push(p)}),o.sort((l,u)=>new Date(u.applicationDate).getTime()-new Date(l.applicationDate).getTime()),e(o)},s=>{console.error("Error fetching employer applications: ",s),e([])}),Dte=(n,e)=>Ye.collection("applications").where("workerId","==",n).onSnapshot(s=>{const o=[];s.forEach(l=>{var v;const u=l.data(),d=(v=u.applicationDate)!=null&&v.toDate?u.applicationDate.toDate().toISOString():new Date().toISOString(),p={id:l.id,jobId:u.jobId,jobTitle:u.jobTitle,workerId:u.workerId,workerName:u.workerName,employerName:u.employerName||"Khng r",workerProfileImageUrl:u.workerProfileImageUrl,employerId:u.employerId,employerProfileImageUrl:u.employerProfileImageUrl,applicationDate:d,status:u.status,cvUrl:u.cvUrl||null,cvName:u.cvName||null,introduction:u.introduction||"",contactPhoneNumber:u.contactPhoneNumber||""};o.push(p)}),o.sort((l,u)=>new Date(u.applicationDate).getTime()-new Date(l.applicationDate).getTime()),e(o)},s=>{console.error("Error fetching worker applications: ",s),e([])}),Mte=async(n,e)=>{await Ye.collection("applications").doc(n.id).update({status:e});const r=e==="accepted"?$s.APPLICATION_ACCEPTED:$s.APPLICATION_REJECTED,i=e==="accepted"?`Chc mng! n ng tuyn ca bn cho cng vic "${n.jobTitle}"  c chp nhn.`:`Rt tic, n ng tuyn ca bn cho cng vic "${n.jobTitle}"  b t chi.`;await FI(n.workerId,r,i,"/profile")},Lte=({job:n,onClose:e,onViewOnMap:t})=>{const{currentUser:r,currentUserData:i}=po(),[s,o]=Q.useState(!1),[l,u]=Q.useState(!1),[d,p]=Q.useState(""),[v,w]=Q.useState(!1),[x,A]=Q.useState(""),[R,L]=Q.useState("");Q.useEffect(()=>{i!=null&&i.phoneNumber&&A(i.phoneNumber)},[i]),Q.useEffect(()=>{const K=ee=>{ee.key==="Escape"&&e()};return document.body.style.overflow="hidden",window.addEventListener("keydown",K),(async()=>{if(r&&(i==null?void 0:i.userType)==="WORKER"){const ee=await Rte(n.id,r.uid);u(ee)}})(),()=>{window.removeEventListener("keydown",K),document.body.style.overflow="unset"}},[e,n.id,r,i]);const j=()=>{if(!r||!i){p("Bn cn ng nhp  ng tuyn.");return}w(!0)},B=async K=>{if(K.preventDefault(),!(!r||!i)){if(!x.trim()){p("Vui lng nhp s in thoi lin h.");return}o(!0),p("");try{await kte(n,i,R,x),u(!0),w(!1)}catch(te){console.error("Application failed:",te),p(" c li xy ra khi ng tuyn. Vui lng th li.")}finally{o(!1)}}},q=(i==null?void 0:i.uid)===n.employerId;return y.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center",role:"dialog","aria-modal":"true",children:[y.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:e}),y.jsxs("div",{className:"bg-white w-full md:w-[90%] md:max-w-3xl h-[90vh] md:h-auto md:max-h-[85vh] rounded-t-2xl md:rounded-2xl shadow-2xl flex flex-col relative z-10 animate-slide-up md:animate-fade-in overflow-hidden",onClick:K=>K.stopPropagation(),children:[y.jsx("div",{className:"md:hidden w-full flex justify-center pt-3 pb-1 bg-white cursor-pointer",onClick:e,children:y.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),y.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-start bg-white flex-shrink-0",children:[y.jsxs("div",{className:"flex gap-4 overflow-hidden",children:[n.employerProfileUrl?y.jsx("img",{src:n.employerProfileUrl,alt:"logo",className:"w-14 h-14 rounded-lg object-cover border border-gray-100 flex-shrink-0"}):y.jsx("div",{className:"w-14 h-14 rounded-lg bg-indigo-50 flex items-center justify-center flex-shrink-0",children:y.jsx(fs,{className:"w-8 h-8 text-indigo-500"})}),y.jsxs("div",{className:"min-w-0",children:[y.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate leading-tight",children:n.title}),y.jsx("p",{className:"text-gray-500 text-sm truncate mt-1",children:n.employerName}),y.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[y.jsx("span",{className:"bg-green-100 text-green-700 text-xs font-bold px-2 py-0.5 rounded-md",children:IL(n.payRate,n.payType)}),y.jsxs("span",{className:"text-gray-400 text-xs flex items-center",children:[y.jsx(SL,{className:"w-3 h-3 mr-1"}),new Date(n.createdAt).toLocaleDateString("vi-VN")]})]})]})]}),y.jsx("button",{onClick:e,className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-500 transition-colors flex-shrink-0 ml-2",children:y.jsx(u_,{className:"w-5 h-5"})})]}),y.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-white",children:[y.jsxs("div",{className:"flex items-start gap-3 mb-6 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[y.jsx(ia,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"a im lm vic"}),y.jsx("p",{className:"text-sm text-gray-600",children:n.addressString}),y.jsx("button",{onClick:t,className:"text-xs text-indigo-600 font-semibold hover:underline mt-1",children:"Xem trn bn "})]})]}),y.jsxs("div",{className:"mb-6",children:[y.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"M t cng vic"}),y.jsx("div",{className:"text-gray-600 leading-relaxed whitespace-pre-wrap text-sm md:text-base",children:n.description})]}),y.jsxs("div",{className:"flex flex-wrap gap-2 mb-8",children:[y.jsx("span",{className:"bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-medium border border-indigo-100",children:n.jobType}),n.payType&&y.jsxs("span",{className:"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium border border-gray-200",children:["Tr lng ",n.payType.toLowerCase()]})]}),v&&!l&&y.jsxs("div",{className:"mb-6 bg-indigo-50 p-5 rounded-xl border border-indigo-100 animate-fade-in",children:[y.jsxs("h3",{className:"font-bold text-indigo-800 mb-4 flex items-center text-lg",children:[y.jsx(ey,{className:"w-5 h-5 mr-2"}),"Thng tin ng tuyn"]}),y.jsxs("form",{onSubmit:B,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsxs("label",{htmlFor:"contactPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:["S in thoi lin h ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx("input",{type:"tel",id:"contactPhone",value:x,onChange:K=>A(K.target.value),className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Nhp s in thoi...",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"introduction",className:"block text-sm font-medium text-gray-700 mb-1",children:"Li nhn (Ty chn)"}),y.jsx("textarea",{id:"introduction",value:R,onChange:K=>L(K.target.value),rows:3,className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none",placeholder:"Gii thiu ngn gn v kinh nghim ca bn..."})]}),d&&y.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded border border-red-100",children:d}),y.jsxs("div",{className:"flex gap-3 pt-2",children:[y.jsx("button",{type:"button",onClick:()=>w(!1),className:"px-4 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 font-semibold flex-1",children:"Hy"}),y.jsx("button",{type:"submit",disabled:s,className:"flex-[2] bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-400 flex items-center justify-center shadow-md",children:s?y.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Gi h s"})]})]})]})]}),!v&&y.jsxs("div",{className:"p-4 bg-white border-t border-gray-100 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] flex-shrink-0",children:[(i==null?void 0:i.userType)==="WORKER"&&!q&&y.jsx("button",{onClick:j,disabled:s||l,className:`flex-1 font-bold py-3 px-4 rounded-xl transition-all duration-300 flex items-center justify-center shadow-md active:scale-95 ${l?"bg-green-100 text-green-700 cursor-default":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:l?y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"mr-2",children:""}),"  ng tuyn"]}):"ng tuyn ngay"}),q&&y.jsx("div",{className:"flex-1 bg-gray-100 text-gray-500 font-medium py-3 px-4 rounded-xl text-center text-sm flex items-center justify-center",children:"y l bi ng ca bn"}),y.jsx("button",{onClick:e,className:"px-5 bg-white text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-50 border border-gray-200 transition-colors active:scale-95",children:"ng"})]})]}),y.jsx("style",{children:`
        @keyframes slide-up {
            0% { transform: translateY(100%); }
            100% { transform: translateY(0); }
        }
        .animate-slide-up {
            animation: slide-up 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        /* Override fade-in for desktop to be simpler */
        @media (min-width: 768px) {
            .animate-slide-up {
                animation: fade-in 0.2s ease-out forwards;
            }
        }
    `})]})},Vte=({locations:n,types:e,locationFilter:t,typeFilter:r,onLocationChange:i,onTypeChange:s,onReset:o})=>y.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"location-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"a im"}),y.jsxs("select",{id:"location-filter",value:t,onChange:l=>i(l.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${t?"text-gray-900 font-medium":"text-gray-500"}`,children:[y.jsx("option",{value:"",children:"Tt c a im"}),n.map(l=>y.jsx("option",{value:l,children:l},l))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"type-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi hnh"}),y.jsxs("select",{id:"type-filter",value:r,onChange:l=>s(l.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${r?"text-gray-900 font-medium":"text-gray-500"}`,children:[y.jsx("option",{value:"",children:"Tt c loi hnh"}),e.map(l=>y.jsx("option",{value:l,children:l},l))]})]}),y.jsx("div",{className:"flex items-end",children:y.jsx("button",{onClick:o,className:"w-full bg-gray-100 text-gray-700 font-semibold py-2.5 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"Xa b lc"})})]})}),Fte=({className:n="w-6 h-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ote=({job:n,onJobSelect:e})=>y.jsxs("div",{className:"p-1 font-sans",children:[y.jsx("h4",{className:"font-bold text-sm text-gray-800",children:n.title}),y.jsx("p",{className:"text-xs text-gray-600 mb-1",children:n.employerName}),y.jsx("button",{onClick:()=>e(n),className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"Xem chi tit"})]}),Ute=({jobs:n,onJobSelect:e,focusedJobId:t,onFocusComplete:r,userLocation:i})=>{const s=Q.useRef(null),o=Q.useRef({map:null,markers:{},userMarker:null,popupRoots:[]});Q.useEffect(()=>{if(o.current.map||!s.current)return;const u=window.L;if(!u){console.error("Th vin Leaflet khng tm thy. Vui lng m bo  ti th vin.");return}const d=u.map(s.current).setView([16.0544,108.2022],6);return d.options.scrollWheelZoom=!0,u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d),i?d.setView([i.lat,i.lng],13):navigator.geolocation&&navigator.geolocation.getCurrentPosition(p=>{const{latitude:v,longitude:w}=p.coords;d.setView([v,w],13)}),o.current.map=d,setTimeout(()=>{o.current.map&&o.current.map.invalidateSize()},400),()=>{o.current.popupRoots.forEach(p=>p.unmount()),o.current.popupRoots=[],o.current.map&&(o.current.map.remove(),o.current.map=null)}},[i]),Q.useEffect(()=>{const u=window.L,{map:d}=o.current;if(!d||!u||(o.current.popupRoots.forEach(v=>v.unmount()),o.current.popupRoots=[],Object.values(o.current.markers).forEach(v=>v.remove()),o.current.markers={},n.length===0))return;const p=u.latLngBounds([]);n.forEach(v=>{const w=jg(v.location);if(!w)return;const x=document.createElement("div"),A=hb.createRoot(x);A.render(y.jsx(Ote,{job:v,onJobSelect:e})),o.current.popupRoots.push(A);const R=u.marker([w.lat,w.lng]).addTo(d).bindPopup(x);o.current.markers[v.id]=R,p.extend([w.lat,w.lng])}),p.isValid()&&!t&&(i&&p.extend([i.lat,i.lng]),d.fitBounds(p,{padding:[50,50],maxZoom:14}))},[n,e,t,i]),Q.useEffect(()=>{const{map:u,markers:d}=o.current;if(!u||!t||!d[t])return;const p=d[t],v=n.find(x=>x.id===t),w=v?jg(v.location):null;w&&(u.flyTo([w.lat,w.lng],15,{animate:!0,duration:1}),setTimeout(()=>{p&&typeof p.openPopup=="function"&&p.openPopup()},800)),r()},[t,n,r]),Q.useEffect(()=>{const u=window.L,{map:d}=o.current;if(!(!d||!u)&&(o.current.userMarker&&(o.current.userMarker.remove(),o.current.userMarker=null),i)){const p=u.divIcon({html:'<div class="user-location-marker"></div>',className:"",iconSize:[24,24],iconAnchor:[12,12]}),v=u.marker([i.lat,i.lng],{icon:p}).addTo(d).bindTooltip("V tr ca bn");o.current.userMarker=v}},[i]);const l=()=>{const{map:u}=o.current;u&&i&&u.flyTo([i.lat,i.lng],15)};return y.jsxs("div",{className:"relative",children:[y.jsx("div",{ref:s,className:"w-full h-[600px] rounded-lg shadow-md z-0"}),i&&y.jsx("button",{onClick:l,className:"absolute bottom-5 right-5 z-[1000] bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 transition-colors duration-200","aria-label":"V v tr ca ti",title:"V v tr ca ti",children:y.jsx(Fte,{className:"w-6 h-6 text-gray-700"})}),y.jsx("style",{children:`
          .user-location-marker {
              width: 24px;
              height: 24px;
              background-color: #3b82f6; /* blue-500 */
              border-radius: 50%;
              border: 3px solid white;
              box-shadow: 0 0 10px rgba(0,0,0,0.3);
              position: relative;
          }
          .user-location-marker::after {
              content: '';
              position: absolute;
              top: 50%;
              left: 50%;
              width: 24px;
              height: 24px;
              border-radius: 50%;
              background-color: rgba(59, 130, 246, 0.3);
              transform: translate(-50%, -50%);
              animation: pulse 2s infinite;
          }
          @keyframes pulse {
              0% {
                  transform: translate(-50%, -50%) scale(1);
                  opacity: 0.8;
              }
              100% {
                  transform: translate(-50%, -50%) scale(2.5);
                  opacity: 0;
              }
          }
      `})]})},Bte=Q.memo(Ute),qte=({className:n="w-5 h-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),Hte=({className:n="w-5 h-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m0 10V7m0 10l-6 3"})}),Gte="diutnceax",$te="ansinhso_unsigned_preset",Q0=async n=>{var r;const e=new FormData;e.append("file",n),e.append("upload_preset",$te);const t="auto";try{const i=await fetch(`https://api.cloudinary.com/v1_1/${Gte}/${t}/upload`,{method:"POST",body:e});if(!i.ok){const l=await i.json(),u=((r=l==null?void 0:l.error)==null?void 0:r.message)||"Upload to Cloudinary failed";throw console.error("Cloudinary error response:",l),new Error(`Li Cloudinary: ${u}`)}const s=await i.json();return s.secure_url?s.secure_url.trim():""}catch(i){throw console.error("Error uploading file to Cloudinary:",i),i}},jte=n=>Ye.collection("jobs").orderBy("createdAt","desc").onSnapshot(i=>{const s=[];i.forEach(o=>{var u;const l=o.data();if(l.title&&l.location){const d=(u=l.createdAt)!=null&&u.toDate?l.createdAt.toDate().toISOString():new Date().toISOString(),p={id:o.id,title:l.title,description:l.description||"",employerId:l.employerId,employerName:l.employerName,employerProfileUrl:l.employerProfileUrl,addressString:l.addressString,location:l.location,payRate:l.payRate,payType:l.payType,jobType:l.jobType||"Thi v",status:l.status,createdAt:d,hiredWorkerId:l.hiredWorkerId};s.push(p)}}),n(s)},i=>{console.error("Error fetching jobs: ",i),n([])}),zte=(n,e)=>Ye.collection("jobs").where("employerId","==",n).orderBy("createdAt","desc").onSnapshot(s=>{const o=[];s.forEach(l=>{var v;const u=l.data(),d=(v=u.createdAt)!=null&&v.toDate?u.createdAt.toDate().toISOString():new Date().toISOString(),p={id:l.id,title:u.title,description:u.description,employerId:u.employerId,employerName:u.employerName,employerProfileUrl:u.employerProfileUrl,addressString:u.addressString,location:u.location,payRate:u.payRate,payType:u.payType,jobType:u.jobType,status:u.status,createdAt:d,hiredWorkerId:u.hiredWorkerId};o.push(p)}),e(o)},s=>{console.error("Error fetching employer jobs: ",s),e([])}),Wte=async n=>{var e;try{const r=await Ye.collection("jobs").doc(n).get();if(r.exists){const i=r.data(),s=(e=i==null?void 0:i.createdAt)!=null&&e.toDate?i.createdAt.toDate().toISOString():new Date().toISOString();return{id:r.id,title:i==null?void 0:i.title,description:(i==null?void 0:i.description)||"",employerId:i==null?void 0:i.employerId,employerName:i==null?void 0:i.employerName,employerProfileUrl:i==null?void 0:i.employerProfileUrl,addressString:i==null?void 0:i.addressString,location:i==null?void 0:i.location,payRate:i==null?void 0:i.payRate,payType:i==null?void 0:i.payType,jobType:(i==null?void 0:i.jobType)||"Thi v",status:i==null?void 0:i.status,createdAt:s,hiredWorkerId:i==null?void 0:i.hiredWorkerId}}return null}catch(t){return console.error("Error fetching job by ID:",t),null}},Kte=async(n,e)=>{await Ye.collection("jobs").doc(n).update({status:e})},Jte=async(n,e)=>{var s;const t=(s=e.addressString.split(",").pop())==null?void 0:s.trim();if(!t)return;const i=Ye.collection("users").where("userType","==","WORKER");try{(await i.get()).forEach(l=>{const u=l.data();u.address&&u.address.includes(t)&&FI(u.uid,$s.NEW_JOB_MATCH,`Vic lm mi ti ${t}: "${e.title}"`,`/jobs/${n}`)})}catch(o){console.error("Error notifying workers:",o)}},Qte=async(n,e)=>{if(!e.fullName)throw new Error("Nh tuyn dng phi c h tn y   ng tin.");const r=Ye.collection("jobs").doc(),{coordinates:i,...s}=n,o=`[${i.lat} N, ${i.lng} E]`,l={...s,id:r.id,employerId:e.uid,employerName:e.fullName,employerProfileUrl:e.profileImageUrl||null,status:"OPEN",hiredWorkerId:null,createdAt:io(),location:o};await r.set(l),await Jte(r.id,n)},Zg=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),ub=({job:n,onStatusChange:e,isUpdating:t,onClick:r})=>{const i=n.status==="CLOSED";return y.jsxs("div",{onClick:()=>r(n),className:"bg-white p-4 rounded-lg border flex items-center justify-between cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[y.jsxs("div",{children:[y.jsx("p",{className:"font-semibold text-gray-800",children:n.title}),y.jsx("p",{className:"text-sm text-gray-500",children:n.addressString})]}),y.jsx("button",{onClick:s=>{s.stopPropagation(),e(n.id,i?"OPEN":"CLOSED")},disabled:t,className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors disabled:opacity-50 ${i?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:t?"...":i?"M li":"ng"})]})},Yte=({application:n,onStatusUpdate:e,onViewProfile:t,isUpdating:r})=>{const i={pending:{text:"Ch duyt",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" chp nhn",className:"bg-green-100 text-green-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"}},s=i[n.status]||i.pending;return y.jsxs("div",{className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[y.jsxs("div",{className:"flex items-center space-x-4 flex-grow w-full sm:w-auto",children:[n.workerProfileImageUrl?y.jsx("img",{src:n.workerProfileImageUrl,alt:n.workerName,className:"w-12 h-12 rounded-full object-cover flex-shrink-0"}):y.jsx(Na,{className:"w-12 h-12 flex-shrink-0"}),y.jsxs("div",{className:"flex-grow",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{onClick:t,className:"font-semibold text-gray-800 hover:text-indigo-600 text-left",children:n.workerName}),n.cvUrl&&y.jsxs("a",{href:n.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded border border-indigo-100 hover:bg-indigo-100",title:"M CV trong tab mi",onClick:o=>o.stopPropagation(),children:[y.jsx(Zg,{className:"w-3 h-3 mr-1"}),"CV"]})]}),y.jsxs("p",{className:"text-sm text-gray-600",children:[" ng tuyn vo: ",y.jsx("span",{className:"font-medium text-indigo-600",children:n.jobTitle})]}),y.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]})]}),y.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 w-full sm:w-auto justify-end",children:[n.status==="pending"&&y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>e("accepted"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 hover:bg-green-200 disabled:opacity-50",children:r?"...":"Chp nhn"}),y.jsx("button",{onClick:()=>e("rejected"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 hover:bg-red-200 disabled:opacity-50",children:r?"...":"T chi"})]}),y.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${s.className}`,children:s.text})]})]})},Sw=({application:n,onClick:e})=>{const t={pending:{text:"ang ch",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" chp nhn",className:"bg-green-100 text-green-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"}},r=t[n.status]||t.pending;return y.jsxs("div",{onClick:()=>e(n.jobId),className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-center justify-between gap-3 cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[y.jsxs("div",{className:"flex-grow text-left w-full sm:w-auto",children:[y.jsx("p",{className:"font-semibold text-gray-800",children:n.jobTitle}),y.jsxs("p",{className:"text-sm text-gray-500",children:["Nh tuyn dng: ",y.jsx("span",{className:"font-medium",children:n.employerName})]}),y.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy np n: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]}),y.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:y.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${r.className}`,children:r.text})})]})},Xte=({onViewProfile:n,onJobSelect:e})=>{const{currentUser:t,currentUserData:r,refetchUserData:i,logout:s}=po(),[o,l]=Q.useState(""),[u,d]=Q.useState(""),[p,v]=Q.useState(""),[w,x]=Q.useState(null),[A,R]=Q.useState(null),[L,j]=Q.useState(""),[B,q]=Q.useState([]),[K,te]=Q.useState(""),[ee,P]=Q.useState([]),[k,b]=Q.useState(!1),[F,D]=Q.useState({title:"",company:"",duration:""}),[O,M]=Q.useState(null),[$e,dt]=Q.useState(null),[et,tt]=Q.useState(null),[fe,Ne]=Q.useState(!1),[ye,G]=Q.useState(""),[ne,Re]=Q.useState(""),[Me,Ue]=Q.useState([]),[He,ue]=Q.useState([]),[_e,Be]=Q.useState(!0),[it,je]=Q.useState(!0),[ft,dn]=Q.useState(null),[$r,ws]=Q.useState(null),[kn,Ts]=Q.useState([]),[Es,Bt]=Q.useState(!0),[qt,ar]=Q.useState(!1),yo=Q.useRef(null),_o=Q.useRef(null);Q.useEffect(()=>{if(r){if(l(r.fullName||""),d(r.phoneNumber||""),v(r.address||""),R(r.profileImageUrl||null),j(r.bio||""),q(r.skills||[]),P(r.workHistory||[]),dt(r.cvUrl||null),tt(r.cvName||null),r.userType===$t.Employer){Be(!0),je(!0);const re=zte(r.uid,ot=>{Ue(ot),Be(!1)}),xe=Pte(r.uid,ot=>{ue(ot),je(!1)});return()=>{re(),xe()}}if(r.userType===$t.Worker){Bt(!0);const re=Dte(r.uid,xe=>{Ts(xe),Bt(!1)});return()=>re()}}},[r]);const{openJobs:Oa,closedJobs:ci}=Q.useMemo(()=>{const re=Me.filter(ot=>ot.status==="OPEN"),xe=Me.filter(ot=>ot.status==="CLOSED");return{openJobs:re,closedJobs:xe}},[Me]),{pendingApplications:vo,acceptedApplications:Is,rejectedApplications:ui}=Q.useMemo(()=>(r==null?void 0:r.userType)!==$t.Worker?{pendingApplications:[],acceptedApplications:[],rejectedApplications:[]}:{pendingApplications:kn.filter(re=>re.status==="pending"),acceptedApplications:kn.filter(re=>re.status==="accepted"),rejectedApplications:kn.filter(re=>re.status==="rejected")},[kn,r]),Ua=async(re,xe)=>{dn(re);try{await Kte(re,xe)}catch(ot){console.error("Failed to update job status:",ot),G("Li cp nht trng thi cng vic.")}finally{dn(null)}},xs=async(re,xe)=>{const ot=`${re.jobId}-${re.id}`;ws(ot);try{await Mte(re,xe)}catch(yn){console.error("Failed to update application status:",yn),G("Li cp nht trng thi ng vin.")}finally{ws(null)}},jr=async re=>{ar(!0);try{const xe=Me.find(ot=>ot.id===re);if(xe)e(xe);else{const ot=await Wte(re);ot?e(ot):alert("Cng vic ny khng cn tn ti hoc  b xa.")}}catch(xe){console.error("Error fetching job details",xe)}finally{ar(!1)}},fc=()=>{var re;(re=yo.current)==null||re.click()},bi=re=>{var ot;const xe=(ot=re.target.files)==null?void 0:ot[0];if(xe){x(xe);const yn=URL.createObjectURL(xe);R(yn)}},wo=re=>{var ot;const xe=(ot=re.target.files)==null?void 0:ot[0];if(xe){const yn=xe.name.toLowerCase(),zr=xe.type||"",xr=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],Eo=[".pdf",".doc",".docx"];if(!(xr.some(Io=>zr.includes(Io))||Eo.some(Io=>yn.endsWith(Io)))){G("Vui lng ch ti ln file PDF hoc Word.");return}if(xe.size>5*1024*1024){G("File qu ln. Vui lng chn file nh hn 5MB.");return}M(xe),G("")}},Ba=async re=>{if(re.preventDefault(),!o){G("Vui lng nhp h v tn ca bn.");return}if(!t){G("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}Ne(!0),G(""),Re("");try{let xe=(r==null?void 0:r.profileImageUrl)||null;w&&(xe=(await Q0(w)).trim());let ot=$e,yn=et;O&&(ot=(await Q0(O)).trim(),yn=O.name);const zr=Ye.collection("users").doc(t.uid),xr={fullName:o,phoneNumber:u,address:p,profileImageUrl:xe};(r==null?void 0:r.userType)===$t.Worker&&(xr.bio=L,xr.skills=B,xr.workHistory=ee,xr.cvUrl=ot,xr.cvName=yn),await zr.update(xr),dt(ot),tt(yn),R(xe),await i(),Re("Cp nht h s thnh cng!"),x(null),M(null)}catch(xe){console.error(xe),xe instanceof Error?G(xe.message):G(" c li xy ra khi cp nht h s. Vui lng th li.")}finally{Ne(!1)}},Ir=async()=>{try{await s()}catch(re){console.error("Failed to log out",re),G("ng xut tht bi. Vui lng th li.")}},Ss=()=>{K.trim()&&!B.includes(K.trim())&&(q([...B,K.trim()]),te(""))},Pi=re=>{q(B.filter(xe=>xe!==re))},To=()=>{if(F.title.trim()&&F.company.trim()&&F.duration.trim()){const re={...F,id:Date.now().toString()};P([...ee,re]),D({title:"",company:"",duration:""}),b(!1)}},di=re=>{P(ee.filter(xe=>xe.id!==re))};return r?y.jsxs("div",{className:"space-y-8",children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"H s ca bn"}),y.jsx("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-sm p-6 sm:p-8 border border-gray-200 mx-auto",children:y.jsxs("form",{onSubmit:Ba,className:"space-y-6",children:[y.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[y.jsx("input",{type:"file",ref:yo,onChange:bi,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),y.jsxs("button",{type:"button",onClick:fc,className:"relative w-32 h-32 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed hover:border-indigo-400 transition-all","aria-label":"Thay i nh i din",children:[A||r&&r.profileImageUrl?y.jsx("img",{src:A||r.profileImageUrl,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):y.jsx(Na,{className:"w-full h-full text-gray-400 p-8"}),y.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-full flex items-center justify-center transition-opacity",children:y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),y.jsx("p",{className:"text-sm text-gray-500",children:"Nhp vo nh  thay i"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),y.jsx("input",{type:"email",id:"email",value:r.email||"",disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-500"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"H v Tn"}),y.jsx("input",{id:"fullName",type:"text",value:o,onChange:re=>l(re.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"S in thoi"}),y.jsx("input",{id:"phoneNumber",type:"tel",value:u,onChange:re=>d(re.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"a ch"}),y.jsx("input",{id:"address",type:"text",value:p,onChange:re=>v(re.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),r.userType===$t.Worker&&y.jsxs(y.Fragment,{children:[y.jsx("hr",{}),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Gii thiu bn thn"}),y.jsx("textarea",{id:"bio",value:L,onChange:re=>j(re.target.value),rows:3,placeholder:"Vit mt vi dng v bn thn v kinh nghim ca bn...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s nng lc (CV)"}),y.jsx("input",{type:"file",ref:_o,onChange:wo,className:"hidden",accept:".pdf,.doc,.docx"}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("button",{type:"button",onClick:()=>{var re;return(re=_o.current)==null?void 0:re.click()},className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-200 flex items-center",children:[y.jsx(Zg,{className:"w-5 h-5 mr-2"}),O?"i file":"Ti ln CV"]}),O&&y.jsx("span",{className:"text-sm text-green-600",children:O.name}),$e&&!O&&y.jsxs("a",{href:$e,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:underline flex items-center",children:[y.jsx(X0,{className:"w-4 h-4 mr-1"}),et||"Xem CV hin ti"]})]}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"H tr nh dng PDF, Word. Ti a 5MB."})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"skills",className:"block text-sm font-medium text-gray-700 mb-1",children:"K nng"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{id:"skills",type:"text",value:K,onChange:re=>te(re.target.value),onKeyDown:re=>re.key==="Enter"&&(re.preventDefault(),Ss()),placeholder:"VD: Sa in, gi tr...",className:"flex-grow p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),y.jsx("button",{type:"button",onClick:Ss,className:"bg-indigo-100 text-indigo-700 font-semibold px-4 rounded-lg hover:bg-indigo-200",children:"Thm"})]}),y.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:B.map(re=>y.jsxs("span",{className:"flex items-center bg-gray-200 text-gray-800 text-sm font-medium px-3 py-1 rounded-full",children:[re,y.jsx("button",{type:"button",onClick:()=>Pi(re),className:"ml-2 text-gray-500 hover:text-gray-800",children:y.jsx(fb,{className:"w-4 h-4"})})]},re))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lch s lm vic"}),y.jsxs("div",{className:"space-y-3",children:[ee.map(re=>y.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("p",{className:"font-semibold text-gray-800",children:re.title}),y.jsx("p",{className:"text-sm text-gray-600",children:re.company}),y.jsx("p",{className:"text-xs text-gray-500",children:re.duration})]}),y.jsx("button",{type:"button",onClick:()=>di(re.id),className:"text-gray-400 hover:text-red-500 p-1",children:y.jsx(UI,{className:"w-5 h-5"})})]},re.id)),ee.length===0&&!k&&y.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"Cha c kinh nghim lm vic."}),k&&y.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg space-y-3 bg-white",children:[y.jsx("input",{type:"text",value:F.title,onChange:re=>D({...F,title:re.target.value}),placeholder:"Chc danh cng vic",className:"w-full p-2 border border-gray-300 rounded-md"}),y.jsx("input",{type:"text",value:F.company,onChange:re=>D({...F,company:re.target.value}),placeholder:"Tn cng ty/ni lm vic",className:"w-full p-2 border border-gray-300 rounded-md"}),y.jsx("input",{type:"text",value:F.duration,onChange:re=>D({...F,duration:re.target.value}),placeholder:"Thi gian (VD: 2020 - 2022)",className:"w-full p-2 border border-gray-300 rounded-md"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{type:"button",onClick:To,className:"bg-green-600 text-white font-semibold py-1 px-3 rounded-md text-sm hover:bg-green-700",children:"Lu"}),y.jsx("button",{type:"button",onClick:()=>b(!1),className:"bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-md text-sm hover:bg-gray-300",children:"Hy"})]})]}),!k&&y.jsxs("button",{type:"button",onClick:()=>b(!0),className:"w-full flex items-center justify-center gap-2 text-sm font-semibold text-indigo-600 hover:text-indigo-800 p-2 border-2 border-dashed rounded-lg hover:border-indigo-400 transition-colors",children:[y.jsx(Aw,{className:"w-5 h-5"}),"Thm kinh nghim"]})]})]})]})]}),ye&&y.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:ye}),ne&&y.jsx("p",{className:"text-green-600 text-sm text-center bg-green-50 p-3 rounded-lg border border-green-200",children:ne}),y.jsxs("div",{className:"pt-2 space-y-4",children:[y.jsxs("button",{type:"submit",disabled:fe,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center",children:[fe&&y.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),fe?"ang lu...":"Lu thay i"]}),y.jsx("button",{type:"button",onClick:Ir,className:"w-full bg-gray-100 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"ng xut"})]})]})}),r.userType===$t.Employer&&y.jsxs("div",{className:"max-w-4xl w-full mx-auto mt-12 space-y-10",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng ang m"}),_e?y.jsx(mr,{}):Oa.length>0?y.jsx("div",{className:"space-y-3",children:Oa.map(re=>y.jsx(ub,{job:re,onStatusChange:Ua,isUpdating:ft===re.id,onClick:xe=>e(xe)},re.id))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no ang m."})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng  ng"}),_e?y.jsx(mr,{}):ci.length>0?y.jsx("div",{className:"space-y-3",children:ci.map(re=>y.jsx(ub,{job:re,onStatusChange:Ua,isUpdating:ft===re.id,onClick:xe=>e(xe)},re.id))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no  ng."})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"ng vin  np n"}),it?y.jsx(mr,{}):He.length>0?y.jsx("div",{className:"space-y-3",children:He.map(re=>y.jsx(Yte,{application:re,onStatusUpdate:xe=>xs(re,xe),onViewProfile:()=>n(re.workerId,re),isUpdating:$r===`${re.jobId}-${re.id}`},`${re.jobId}-${re.id}`))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c ng vin no np n."})]})]}),r.userType===$t.Worker&&y.jsxs("div",{className:"max-w-2xl w-full mx-auto mt-12 space-y-10",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn ang ch"}),Es?y.jsx(mr,{}):vo.length>0?y.jsx("div",{className:"space-y-3",children:vo.map(re=>y.jsx(Sw,{application:re,onClick:jr},`${re.jobId}-${re.id}`))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no ang ch."})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cng vic  c chp thun"}),Es?y.jsx(mr,{}):Is.length>0?y.jsx("div",{className:"space-y-3",children:Is.map(re=>y.jsx(Sw,{application:re,onClick:jr},`${re.jobId}-${re.id}`))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c n ng tuyn no c chp thun."})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn b t chi"}),Es?y.jsx(mr,{}):ui.length>0?y.jsx("div",{className:"space-y-3",children:ui.map(re=>y.jsx(Sw,{application:re,onClick:jr},`${re.jobId}-${re.id}`))}):y.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no b t chi."})]})]}),qt&&y.jsx(mr,{fullScreen:!0,message:"ang ti chi tit cng vic..."})]}):y.jsx(mr,{message:"ang ti h s..."})},Zte=({initialCenter:n,initialZoom:e,onLocationChange:t})=>{const r=Q.useRef(null),i=Q.useRef(null);return Q.useEffect(()=>{if(i.current||!r.current)return;const s=window.L;if(!s){console.error("Th vin Leaflet khng tm thy.");return}const o=n||{lat:16.0544,lng:108.2022},l=e||6,u=s.map(r.current,{zoomControl:!1}).setView([o.lat,o.lng],l);return i.current=u,s.control.zoom({position:"topright"}).addTo(u),s.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(u),t({lat:o.lat,lng:o.lng}),u.on("moveend",()=>{const d=u.getCenter();t({lat:d.lat,lng:d.lng})}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>{const{latitude:p,longitude:v}=d.coords;u.setView([p,v],15)}),()=>{i.current&&(i.current.remove(),i.current=null)}},[]),y.jsxs("div",{className:"relative w-full h-80 rounded-lg shadow-md z-0 border overflow-hidden",children:[y.jsx("div",{ref:r,className:"w-full h-full"}),y.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-full pointer-events-none z-[1000]",children:y.jsx(ia,{className:"w-10 h-10 text-red-500 drop-shadow-lg"})}),y.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-sm text-gray-700 text-xs font-semibold px-3 py-1.5 rounded-full shadow-md pointer-events-none",children:"Di chuyn bn   chn v tr"})]})},ene=({onClose:n})=>{const{currentUserData:e}=po(),[t,r]=Q.useState(""),[i,s]=Q.useState(""),[o,l]=Q.useState([]),[u,d]=Q.useState([]),[p,v]=Q.useState([]),[w,x]=Q.useState(!1),[A,R]=Q.useState(!1),[L,j]=Q.useState(!1),[B,q]=Q.useState(""),[K,te]=Q.useState(""),[ee,P]=Q.useState(""),[k,b]=Q.useState(""),[F,D]=Q.useState(null),[O,M]=Q.useState(""),[$e,dt]=Q.useState("THEO NGY"),[et,tt]=Q.useState("Thi v"),[fe,Ne]=Q.useState(!1),[ye,G]=Q.useState(!1),[ne,Re]=Q.useState("");Q.useEffect(()=>{(async()=>{x(!0),Re("");try{const _e=await fetch("https://open.oapi.vn/location/provinces?size=100");if(!_e.ok)throw new Error("Network response was not ok");const it=((await _e.json()).data||[]).map(je=>({name:je.name,code:parseInt(je.id,10)}));l(it)}catch(_e){console.error("Failed to fetch provinces:",_e),Re("Khng th ti danh sch Tnh/Thnh. Vui lng th li.")}finally{x(!1)}})()},[]),Q.useEffect(()=>{if(!B){d([]),v([]),te(""),P("");return}(async()=>{R(!0),Re("");try{const _e=await fetch(`https://open.oapi.vn/location/districts/${B}?size=100`);if(!_e.ok)throw new Error("Network response was not ok");const it=((await _e.json()).data||[]).map(je=>({name:je.name,code:parseInt(je.id,10),province_code:parseInt(je.provinceId,10)}));d(it)}catch(_e){console.error("Failed to fetch districts:",_e),Re("Khng th ti danh sch Qun/Huyn.")}finally{R(!1)}})()},[B]),Q.useEffect(()=>{if(!K){v([]),P("");return}(async()=>{j(!0),Re("");try{const _e=await fetch(`https://open.oapi.vn/location/wards/${K}?size=100`);if(!_e.ok)throw new Error("Network response was not ok");const it=((await _e.json()).data||[]).map(je=>({name:je.name,code:parseInt(je.id,10),district_code:parseInt(je.districtId,10)}));v(it)}catch(_e){console.error("Failed to fetch wards:",_e),Re("Khng th ti danh sch Phng/X.")}finally{j(!1)}})()},[K]);const Me=ue=>{q(ue.target.value),te(""),P(""),d([]),v([])},Ue=ue=>{te(ue.target.value),P(""),v([])},He=async ue=>{var _e,Be,it;if(ue.preventDefault(),!e){Re("Bn phi ng nhp  ng tin.");return}if(!F){Re("Vui lng chn mt v tr trn bn .");return}if(!B||!K||!ee){Re("Vui lng chn y  Tnh/Thnh, Qun/Huyn, v Phng/X.");return}G(!0),Re("");try{const je=((_e=o.find(kn=>kn.code===parseInt(B)))==null?void 0:_e.name)||"",ft=((Be=u.find(kn=>kn.code===parseInt(K)))==null?void 0:Be.name)||"",dn=((it=p.find(kn=>kn.code===parseInt(ee)))==null?void 0:it.name)||"",$r=`${k}, ${dn}, ${ft}, ${je}`.trim(),ws={title:t,description:i,addressString:$r,coordinates:F,payRate:fe?"Tha thun":parseFloat(O)||0,payType:$e,jobType:et};await Qte(ws,e),n()}catch(je){Re(je.message||" c li xy ra. Vui lng th li."),console.error(je)}finally{G(!1)}};return y.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start p-4 overflow-y-auto",onClick:n,"aria-modal":"true",role:"dialog",children:[y.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up mt-8 mb-8",onClick:ue=>ue.stopPropagation(),children:y.jsxs("form",{onSubmit:He,children:[y.jsxs("div",{className:"p-6",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"ng tin tuyn dng mi"}),y.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cung cp thng tin chi tit v cng vic bn mun ng."}),y.jsxs("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Tiu  cng vic"}),y.jsx("input",{type:"text",id:"title",value:t,onChange:ue=>r(ue.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"M t chi tit"}),y.jsx("textarea",{id:"description",value:i,onChange:ue=>s(ue.target.value),required:!0,rows:4,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-y"})]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700",children:"Tnh/Thnh ph"}),y.jsxs("select",{id:"province",value:B,onChange:Me,required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[w?y.jsx("option",{children:"ang ti..."}):y.jsx("option",{value:"",children:"-- Chn Tnh/Thnh --"}),o.map(ue=>y.jsx("option",{value:ue.code,children:ue.name},ue.code))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"district",className:"block text-sm font-medium text-gray-700",children:"Qun/Huyn"}),y.jsxs("select",{id:"district",value:K,onChange:Ue,required:!0,disabled:!B||A,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[A?y.jsx("option",{children:"ang ti..."}):y.jsx("option",{value:"",children:"-- Chn Qun/Huyn --"}),u.map(ue=>y.jsx("option",{value:ue.code,children:ue.name},ue.code))]})]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"ward",className:"block text-sm font-medium text-gray-700",children:"Phng/X"}),y.jsxs("select",{id:"ward",value:ee,onChange:ue=>P(ue.target.value),required:!0,disabled:!K||L,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[L?y.jsx("option",{children:"ang ti..."}):y.jsx("option",{value:"",children:"-- Chn Phng/X --"}),p.map(ue=>y.jsx("option",{value:ue.code,children:ue.name},ue.code))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"streetAddress",className:"block text-sm font-medium text-gray-700",children:"S nh, tn ng"}),y.jsx("input",{type:"text",id:"streetAddress",value:k,onChange:ue=>b(ue.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"VD: 123 ng Nguyn Hu"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghim v tr chnh xc trn bn "}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Ko bn   ghim  v tr chnh xc nht ca cng vic."}),y.jsx(Zte,{onLocationChange:D,initialCenter:{lat:16.0544,lng:108.2022},initialZoom:6}),F&&y.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Ta   chn: ",F.lat.toFixed(6),", ",F.lng.toFixed(6)]})]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"jobType",className:"block text-sm font-medium text-gray-700",children:"Loi hnh cng vic"}),y.jsxs("select",{id:"jobType",value:et,onChange:ue=>tt(ue.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[y.jsx("option",{children:"Thi v"}),y.jsx("option",{children:"Bn thi gian"}),y.jsx("option",{children:"Linh hot"}),y.jsx("option",{children:"Ton thi gian"})]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"payType",className:"block text-sm font-medium text-gray-700",children:"Hnh thc tr lng"}),y.jsxs("select",{id:"payType",value:$e,onChange:ue=>dt(ue.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[y.jsx("option",{value:"THEO NGY",children:"Theo ngy"}),y.jsx("option",{value:"THEO GI",children:"Theo gi"}),y.jsx("option",{value:"THEO THNG",children:"Theo thng"})]})]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"payRate",className:"block text-sm font-medium text-gray-700",children:"Mc lng (VN)"}),y.jsx("input",{type:"number",id:"payRate",value:O,onChange:ue=>M(ue.target.value),required:!fe,disabled:fe,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"}),y.jsxs("div",{className:"mt-2 flex items-center",children:[y.jsx("input",{type:"checkbox",id:"negotiable",checked:fe,onChange:ue=>Ne(ue.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),y.jsx("label",{htmlFor:"negotiable",className:"ml-2 block text-sm text-gray-900",children:"Tha thun"})]})]})]})]}),ne&&y.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 mx-6 rounded-lg border border-red-200",children:ne}),y.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[y.jsxs("button",{type:"submit",disabled:ye,className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 flex items-center justify-center disabled:bg-indigo-400",children:[ye&&y.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ye?"ang ng tin...":"ng tin"]}),y.jsx("button",{type:"button",onClick:n,className:"w-full bg-white text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors duration-300","aria-label":"Hy",children:"Hy"})]})]})}),y.jsx("style",{children:`
        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
    `})]})},tne=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),nne=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.82m5.84-2.56a6 6 0 0 1-7.38 5.84m2.56-5.84a6 6 0 0 1 5.84-7.38m-5.84 2.56a6 6 0 0 1 7.38-5.84m-2.56 5.84a6 6 0 0 1-5.84 7.38m5.84-2.56a6 6 0 0 1-7.38 5.84m0-11.68a6 6 0 0 1 7.38-5.84m-7.38 5.84a6 6 0 0 1 5.84-7.38"})}),rne=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),ine=({onNavigateToAuth:n})=>{const e=[{name:"Tnh nng",href:"#features"},{name:"Hot ng",href:"#how-it-works"},{name:"V sao chn?",href:"#why-us"}],t=[{icon:y.jsx(fs,{className:"w-8 h-8 text-indigo-600"}),title:"Tm Vic Nhanh Chng, Gn Nh",description:"Kt ni trc tip vi hng ngn c hi vic lm thi v, bn thi gian t cc nh tuyn dng uy tn trong khu vc ca bn."},{icon:y.jsx(Ks,{className:"w-8 h-8 text-green-600"}),title:"Tch Ly Tng Lai Vi BHXH",description:"D dng trch mt phn thu nhp  ng bo him x hi t nguyn, m bo lng hu v an sinh khi v gi."},{icon:y.jsx(Yo,{className:"w-8 h-8 text-amber-600"}),title:"H Tr Thng Minh 4.0",description:"Nhn t vn t chatbot AI v lut lao ng v to nh i din chuyn nghip  gy n tng vi nh tuyn dng."}],r=[{icon:y.jsx(tne,{className:"w-8 h-8 text-blue-600"}),title:"An Ton & Minh Bch",description:"Mi cng vic u c xc thc, thng tin r rng. Chng ti bo v quyn li ca bn, gip bn thot khi s bp bnh khi tm vic qua cc knh khng chnh thc."},{icon:y.jsx(nne,{className:"w-8 h-8 text-green-600"}),title:"Hiu Qu & Nhanh Chng",description:"i vi nh tuyn dng, vic tm kim lao ng thi v ph hp tr nn d dng hn bao gi ht, gip tit kim thi gian v ti u ha hot ng kinh doanh."},{icon:y.jsx(Zm,{className:"w-8 h-8 text-red-600"}),title:"Tc ng X Hi",description:"Bn ang chung tay gii quyt bi ton an sinh cho hn 20 triu lao ng t do, gp phn xy dng mt x hi n nh v pht trin bn vng."}],i=[{quote:"Nh An Tm Vic Lm, ti  tm c cng vic ph h gn nh vi thu nhp n nh. Vic ng k v tm vic rt n gin v minh bch.",name:"Anh Minh Tun",role:"Lao ng xy dng",avatar:"https://images.unsplash.com/photo-1581092921462-2150b3e19190?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},{quote:"Nn tng gip ti nhanh chng tm c ngi gip vic theo gi mi khi qun ng khch. Cc ng vin u c thng tin r rng, rt ng tin cy.",name:"Ch Lan Anh",role:"Ch qun n",avatar:"https://images.unsplash.com/photo-1600565193348-f74d3c2723a9?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}];return y.jsxs("div",{className:"bg-white text-gray-800 antialiased animate-fade-in",children:[y.jsx("header",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-sm border-b border-gray-200",children:y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:y.jsxs("div",{className:"flex items-center justify-between h-20",children:[y.jsxs("div",{className:"flex items-center space-x-10",children:[y.jsxs("a",{href:"#",className:"flex items-center flex-shrink-0 group",children:[y.jsx(Ks,{className:"h-8 w-8 text-indigo-600"}),y.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),y.jsx("nav",{className:"hidden md:flex items-baseline space-x-6",children:e.map(s=>y.jsx("a",{href:s.href,className:"text-gray-600 hover:text-indigo-600 font-medium transition-colors",children:s.name},s.name))})]}),y.jsx("div",{className:"flex items-center space-x-4",children:y.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:"ng nhp"})})]})})}),y.jsxs("main",{children:[y.jsx("section",{className:"relative bg-gray-50",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-2 gap-16 items-center pt-24 pb-32",children:[y.jsxs("div",{className:"text-center md:text-left",children:[y.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Nn tng ",y.jsx("span",{className:"text-indigo-600",children:"An Sinh"})," v ",y.jsx("span",{className:"text-indigo-600",children:"Vic Lm"})," cho Lao ng T Do"]}),y.jsx("p",{className:"mt-6 text-lg text-gray-600",children:"Tm vic thi v linh hot, ng gp BHXH d dng, xy dng mt tng lai vng chc v an tm hn."}),y.jsxs("div",{className:"mt-10 flex flex-col sm:flex-row justify-center md:justify-start gap-4",children:[y.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"Tham Gia Ngay"}),y.jsx("a",{href:"#features",className:"bg-white text-indigo-600 font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-50 transition-colors border-2 border-indigo-200",children:"Tm hiu thm"})]})]}),y.jsx("div",{className:"hidden md:block",children:y.jsx("img",{src:"https://images.unsplash.com/photo-1552664730-d307ca884978?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Freelance working smiling",className:"rounded-2xl shadow-2xl object-cover w-full h-full"})})]})}),y.jsx("section",{id:"how-it-works",className:"py-20",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Hot ng nh th no?"}),y.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Ch vi 3 bc n gin  bt u hnh trnh ca bn."})]}),y.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-center",children:[y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"1"}),y.jsx("h3",{className:"text-xl font-bold mb-2",children:"To H S Chuyn Nghip"}),y.jsx("p",{className:"text-gray-600",children:"ng k ti khon v hon thin h s ca bn ch trong vi pht. Thm nh i din do AI to  tng c hi."})]}),y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"2"}),y.jsx("h3",{className:"text-xl font-bold mb-2",children:"Tm Vic & ng Tuyn"}),y.jsx("p",{className:"text-gray-600",children:"Duyt qua hng ngn cng vic thi v, bn thi gian c cp nht lin tc. ng tuyn ch vi mt c nhp chut."})]}),y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"3"}),y.jsx("h3",{className:"text-xl font-bold mb-2",children:"Nhn Lng & Tch Ly"}),y.jsx("p",{className:"text-gray-600",children:"Nhn thanh ton minh bch v d dng trch mt phn thu nhp  ng BHXH, m bo cho tng lai ca bn."})]})]})]})}),y.jsx("section",{id:"features",className:"py-20 bg-slate-50",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Mi th bn cn,  cng mt ni"}),y.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Chng ti n gin ha vic tm kim c hi v m bo tng lai."})]}),y.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((s,o)=>y.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[y.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-indigo-100 mb-6",children:s.icon}),y.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:s.title}),y.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),y.jsx("section",{id:"why-us",className:"py-20",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Khng Ch L Vic Lm, L S An Tm"}),y.jsx("p",{className:"mt-4 max-w-3xl mx-auto text-lg text-gray-600",children:"Chng ti khng ch kt ni bn vi cng vic. Chng ti xy dng mt nn tng vng chc cho tng lai ca bn."})]}),y.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:r.map((s,o)=>y.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[y.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-gray-100 mb-6",children:s.icon}),y.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:s.title}),y.jsx("p",{className:"text-gray-600",children:s.description})]},o))})]})}),y.jsx("section",{id:"testimonials",className:"py-20 bg-slate-50",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Ting ni t cng ng"}),y.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Xem ngi lao ng v nh tuyn dng ni g v chng ti."})]}),y.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:i.map((s,o)=>y.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200",children:[y.jsxs("p",{className:"text-gray-600 italic mb-6",children:['"',s.quote,'"']}),y.jsxs("div",{className:"flex items-center",children:[y.jsx("img",{src:s.avatar,alt:s.name,className:"w-12 h-12 rounded-full object-cover mr-4"}),y.jsxs("div",{children:[y.jsx("p",{className:"font-bold text-gray-900",children:s.name}),y.jsx("p",{className:"text-gray-500 text-sm",children:s.role})]})]})]},o))})]})}),y.jsx("section",{children:y.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center",children:[y.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Sn Sng Bt u Hnh Trnh Ca Bn?"}),y.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Tham gia cng ng An Tm Vic Lm ngay hm nay  tm kim c hi v xy dng mt tng lai an ton hn."}),y.jsx("div",{className:"mt-8",children:y.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"To ti khon min ph"})})]})})]}),y.jsx("footer",{className:"bg-gray-800 text-white",children:y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[y.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[y.jsxs("div",{className:"md:col-span-1",children:[y.jsxs("a",{href:"#",className:"flex items-center justify-center md:justify-start flex-shrink-0 group",children:[y.jsx(Ks,{className:"h-8 w-8 text-indigo-400"}),y.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),y.jsx("p",{className:"text-gray-400 mt-2 text-center md:text-left",children:"Nn tng an sinh v vic lm cho lao ng t do."})]}),y.jsxs("div",{className:"md:col-span-1",children:[y.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin kt nhanh"}),y.jsx("nav",{className:"flex flex-col items-center md:items-start space-y-2",children:e.map(s=>y.jsx("a",{href:s.href,className:"text-gray-300 hover:text-white font-medium transition-colors",children:s.name},s.name))})]}),y.jsxs("div",{className:"md:col-span-1",children:[y.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin h"}),y.jsxs("div",{className:"flex items-center justify-center md:justify-start text-gray-300",children:[y.jsx(rne,{className:"w-5 h-5 mr-2"}),y.jsx("a",{href:"mailto:nguyenduyphuc0119@gmail.com",className:"hover:text-white transition-colors",children:"nguyenduyphuc0119@gmail.com"})]})]})]}),y.jsx("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400 text-sm",children:y.jsx("p",{children:" 2024 An Tm Vic Lm. Mi quyn c bo lu."})})]})})]})},sne=()=>y.jsxs("svg",{className:"w-5 h-5 mr-3",xmlns:"http://www.w.w3.org/2000/svg",viewBox:"0 0 48 48",children:[y.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"}),y.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"}),y.jsx("path",{fill:"#4CAF50",d:"M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.222 0-9.618-3.317-11.284-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"}),y.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.012 34.423 44 29.836 44 24c0-1.341-.138-2.65-.389-3.917z"})]}),one=({onBackToLanding:n})=>{const[e,t]=Q.useState(!0),[r,i]=Q.useState(""),[s,o]=Q.useState(""),[l,u]=Q.useState(""),[d,p]=Q.useState($t.Worker),[v,w]=Q.useState(""),[x,A]=Q.useState(!1),[R,L]=Q.useState(!1),{signup:j,login:B,loginWithGoogle:q}=po(),K=async ee=>{if(ee.preventDefault(),w(""),A(!0),!e&&s!==l){w("Mt khu khng khp."),A(!1);return}try{e?await B(r,s):await j(r,s,d)}catch(P){switch(P.code){case"auth/user-not-found":w("Khng tm thy ti khon vi email ny.");break;case"auth/wrong-password":w("Sai mt khu. Vui lng th li.");break;case"auth/email-already-in-use":w("Email ny  c s dng.");break;case"auth/weak-password":w("Mt khu phi c t nht 6 k t.");break;case"auth/popup-closed-by-user":w("Bn  ng ca s ng nhp. Vui lng th li.");break;default:w(" xy ra li. Vui lng th li.");break}}finally{A(!1)}},te=async()=>{w(""),L(!0);try{await q()}catch(ee){switch(ee.code){case"auth/popup-closed-by-user":w("Bn  ng ca s ng nhp. Vui lng th li.");break;default:w("ng nhp vi Google tht bi. Vui lng th li.");break}L(!1)}};return y.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-white px-4 animate-fade-in relative",children:[y.jsxs("button",{onClick:n,className:"absolute top-6 left-6 flex items-center text-sm font-semibold text-gray-600 hover:text-indigo-600 transition-colors group",children:[y.jsx(PL,{className:"w-5 h-5 mr-2 text-gray-500 group-hover:text-indigo-600"}),"Quay li trang ch"]}),y.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-2xl border border-gray-100 p-8 space-y-6",children:[y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx(Ks,{className:"h-12 w-12 text-indigo-600"}),y.jsx("h1",{className:"mt-3 text-3xl font-bold text-gray-800",children:"Cho mng n An Tm Vic Lm"}),y.jsx("p",{className:"text-gray-600 mt-2",children:e?"ng nhp vo ti khon ca bn":"To ti khon mi"})]}),y.jsx("div",{className:"space-y-4",children:y.jsx("button",{onClick:te,disabled:R||x,className:"w-full flex justify-center items-center bg-white text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:bg-gray-200 transition-colors",children:R?y.jsxs(y.Fragment,{children:[y.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang chuyn hng..."]}):y.jsxs(y.Fragment,{children:[y.jsx(sne,{})," ng nhp vi Google"]})})}),y.jsxs("div",{className:"relative flex py-2 items-center",children:[y.jsx("div",{className:"flex-grow border-t border-gray-300"}),y.jsx("span",{className:"flex-shrink mx-4 text-gray-500 text-sm",children:"HOC"}),y.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),y.jsxs("form",{onSubmit:K,className:"space-y-6",children:[y.jsx("input",{type:"email",value:r,onChange:ee=>i(ee.target.value),placeholder:"Email",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),y.jsx("input",{type:"password",value:s,onChange:ee=>o(ee.target.value),placeholder:"Mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),!e&&y.jsxs(y.Fragment,{children:[y.jsx("input",{type:"password",value:l,onChange:ee=>u(ee.target.value),placeholder:"Xc nhn mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),y.jsxs("div",{children:[y.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bn l:"}),y.jsxs("div",{className:"flex gap-4",children:[y.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[y.jsx("input",{type:"radio",name:"role",value:$t.Worker,checked:d===$t.Worker,onChange:()=>p($t.Worker),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),y.jsx("span",{className:"text-gray-700",children:"Ngi lao ng"})]}),y.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[y.jsx("input",{type:"radio",name:"role",value:$t.Employer,checked:d===$t.Employer,onChange:()=>p($t.Employer),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),y.jsx("span",{className:"text-gray-700",children:"Nh tuyn dng"})]})]})]})]}),v&&y.jsx("p",{className:"text-red-500 text-sm text-center",children:v}),y.jsx("button",{type:"submit",disabled:x||R,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors",children:x?"ang x l...":e?"ng nhp":"ng k"})]}),y.jsxs("p",{className:"text-center text-sm",children:[e?"Cha c ti khon?":" c ti khon?",y.jsx("button",{onClick:()=>{t(!e),w("")},className:"font-medium text-indigo-600 hover:text-indigo-500 ml-1",children:e?"ng k":"ng nhp"})]})]})]})},ane=()=>{const[n,e]=Q.useState("landing");return n==="landing"?y.jsx(ine,{onNavigateToAuth:()=>e("auth")}):y.jsx(one,{onBackToLanding:()=>e("landing")})},lne=()=>{const{currentUser:n,currentUserData:e,refetchUserData:t}=po(),r=!e,[i,s]=Q.useState((e==null?void 0:e.fullName)||""),[o,l]=Q.useState((e==null?void 0:e.phoneNumber)||""),[u,d]=Q.useState((e==null?void 0:e.address)||""),[p,v]=Q.useState($t.Worker),[w,x]=Q.useState(null),[A,R]=Q.useState((e==null?void 0:e.profileImageUrl)||(n==null?void 0:n.photoURL)||null),[L,j]=Q.useState(!1),[B,q]=Q.useState(""),K=Q.useRef(null),te=()=>{var k;(k=K.current)==null||k.click()},ee=k=>{var F;const b=(F=k.target.files)==null?void 0:F[0];if(b){x(b);const D=URL.createObjectURL(b);R(D)}},P=async k=>{if(k.preventDefault(),!i){q("Vui lng nhp h v tn ca bn.");return}if(!n){q("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}j(!0),q("");try{let b=A;w&&(b=await Q0(w));const F=Ye.collection("users").doc(n.uid);r?await F.set({uid:n.uid,email:n.email,userType:p,createdAt:io(),fullName:i,phoneNumber:o,address:u,profileImageUrl:b,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}):await F.update({fullName:i,phoneNumber:o,address:u,profileImageUrl:b}),await t()}catch(b){console.error(b),b instanceof Error?q(b.message):q(" c li xy ra khi cp nht h s. Vui lng th li."),j(!1)}};return y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12",children:y.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 space-y-6 animate-fade-in-up",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:r?"Cho mng bn mi!":"Hon thin h s"}),y.jsx("p",{className:"text-gray-600 mt-2",children:r?"Vui lng chn vai tr v cp nht thng tin  bt u.":"Vui lng cp nht thng tin  tip tc."})]}),y.jsxs("form",{onSubmit:P,className:"space-y-6",children:[r&&y.jsxs("div",{className:"space-y-3",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bn mun tham gia vi t cch l?"}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("button",{type:"button",onClick:()=>v($t.Worker),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${p===$t.Worker?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[y.jsx(Cw,{className:"w-8 h-8 mb-2"}),y.jsx("span",{className:"font-bold text-sm",children:"Ngi Lao ng"})]}),y.jsxs("button",{type:"button",onClick:()=>v($t.Employer),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${p===$t.Employer?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[y.jsx(fs,{className:"w-8 h-8 mb-2"}),y.jsx("span",{className:"font-bold text-sm",children:"Nh Tuyn Dng"})]})]})]}),y.jsxs("div",{className:"flex flex-col items-center space-y-4 pt-2",children:[y.jsx("input",{type:"file",ref:K,onChange:ee,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),y.jsxs("button",{type:"button",onClick:te,className:"relative w-28 h-28 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-300 hover:border-indigo-500 transition-colors","aria-label":"Thay i nh i din",children:[A?y.jsx("img",{src:A,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):y.jsx(Na,{className:"w-12 h-12 text-gray-400"}),y.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 rounded-full flex items-center justify-center transition-opacity",children:y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),y.jsx("p",{className:"text-xs text-gray-500",children:"nh i din"})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{children:y.jsx("input",{type:"text",value:i,onChange:k=>s(k.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),y.jsx("div",{children:y.jsx("input",{type:"tel",value:o,onChange:k=>l(k.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),y.jsx("div",{children:y.jsx("input",{type:"text",value:u,onChange:k=>d(k.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})})]}),B&&y.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:B}),y.jsxs("button",{type:"submit",disabled:L,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center shadow-md",children:[L&&y.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),L?"ang x l...":r?"To h s":"Cp nht"]})]})]})})},cne=async n=>{var e;if(!n)return null;try{const r=await Ye.collection("users").doc(n).get();if(r.exists){const i=r.data(),s=(e=i.createdAt)!=null&&e.toDate?i.createdAt.toDate().toISOString():new Date().toISOString();return{uid:i.uid,email:i.email,userType:i.userType,createdAt:s,fullName:i.fullName||"Ngi dng n danh",phoneNumber:i.phoneNumber,address:i.address,profileImageUrl:i.profileImageUrl,bio:i.bio||"",skills:i.skills||[],workHistory:i.workHistory||[]}}else return console.log("No such user document!"),null}catch(t){throw console.error("Error fetching user profile:",t),t}},une=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),wV=({className:n="w-6 h-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.311a12.06 12.06 0 00-4.5 0m4.5 0a12.06 12.06 0 01-4.5 0M12 6.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5zM12 12.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5z"})}),Th=({icon:n,title:e,children:t,className:r=""})=>y.jsxs("div",{className:r,children:[y.jsxs("div",{className:"flex items-center mb-3",children:[y.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:n}),y.jsx("h4",{className:"text-lg font-bold text-gray-800",children:e})]}),y.jsx("div",{className:"pl-8",children:t})]}),dne=({userId:n,application:e,onClose:t,onStartChat:r})=>{const[i,s]=Q.useState(null),[o,l]=Q.useState(!0),[u,d]=Q.useState(""),[p,v]=Q.useState(!1);return Q.useEffect(()=>{(async()=>{l(!0),d("");try{const x=await cne(n);x?(s(x),x.cvUrl&&x.cvUrl.toLowerCase().endsWith(".pdf")&&v(!0)):d("Khng tm thy h s ngi dng.")}catch(x){console.error(x),d(" xy ra li khi ti h s.")}finally{l(!1)}})()},[n]),y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[100] flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:t,"aria-modal":"true",role:"dialog",children:y.jsxs("div",{className:"bg-gray-50 rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up flex flex-col h-[90vh]",style:{animationDuration:"0.3s"},onClick:w=>w.stopPropagation(),children:[o&&y.jsx(mr,{message:"ang ti h s..."}),u&&y.jsx("div",{className:"p-8 text-center text-red-500",children:u}),!o&&i&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"p-6 bg-white border-b",children:[y.jsxs("div",{className:"flex items-start justify-between",children:[y.jsxs("div",{className:"flex items-center space-x-4",children:[i.profileImageUrl?y.jsx("img",{src:i.profileImageUrl,alt:i.fullName||"User",className:"w-20 h-20 rounded-full object-cover border-2 border-white shadow-md"}):y.jsx(Na,{className:"w-20 h-20"}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:i.fullName}),i.address&&y.jsxs("div",{className:"flex items-center text-gray-500 mt-1",children:[y.jsx(ia,{className:"w-4 h-4 mr-1.5"}),y.jsx("p",{children:i.address})]}),((e==null?void 0:e.contactPhoneNumber)||i.phoneNumber)&&y.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ST: ",y.jsx("span",{className:"font-medium",children:(e==null?void 0:e.contactPhoneNumber)||i.phoneNumber})]}),i.email&&y.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",i.email]})]})]}),y.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"ng",children:y.jsx(u_,{className:"w-6 h-6"})})]}),r&&y.jsx("div",{className:"mt-4 flex justify-end",children:y.jsxs("button",{onClick:r,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[y.jsx(ey,{className:"w-5 h-5 mr-2"}),"Nhn tin"]})})]}),y.jsxs("div",{className:"flex-grow p-6 sm:p-8 overflow-y-auto space-y-8",children:[e&&e.introduction&&y.jsx(Th,{icon:y.jsx(bL,{className:"w-6 h-6 text-indigo-600"}),title:"Thng tin ng tuyn",className:"bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:y.jsx("div",{className:"space-y-2",children:e.introduction&&y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-bold text-indigo-800 uppercase mb-1",children:"Li nhn t ng vin"}),y.jsxs("p",{className:"text-gray-700 italic",children:['"',e.introduction,'"']})]})})}),i.cvUrl&&y.jsx(Th,{icon:y.jsx(Zg,{className:"w-6 h-6"}),title:"H s nng lc (CV)",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("a",{href:i.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition-colors shadow-sm",children:[y.jsx(Zg,{className:"w-5 h-5 mr-2"}),y.jsx("span",{className:"font-medium",children:"Ti xung / M trong tab mi"})]}),i.cvUrl.toLowerCase().endsWith(".pdf")&&y.jsx("button",{onClick:()=>v(!p),className:"text-sm text-gray-500 underline hover:text-indigo-600",children:p?"n xem trc":"Xem trc nhanh"})]}),p&&i.cvUrl&&y.jsxs("div",{className:"w-full h-[500px] border rounded-lg overflow-hidden bg-gray-100 mt-2 relative group",children:[y.jsx("iframe",{src:i.cvUrl,className:"w-full h-full",title:"CV Preview"}),y.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none bg-gray-50 opacity-0 group-hover:opacity-0 transition-opacity",children:y.jsx("p",{className:"text-gray-500",children:"ang ti bn xem trc..."})})]})]})}),i.bio&&y.jsx(Th,{icon:y.jsx(une,{className:"w-6 h-6"}),title:"Gii thiu",children:y.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:i.bio})}),i.skills&&i.skills.length>0&&y.jsx(Th,{icon:y.jsx(wV,{className:"w-6 h-6"}),title:"K nng",children:y.jsx("div",{className:"flex flex-wrap gap-2",children:i.skills.map(w=>y.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-sm font-medium px-3 py-1.5 rounded-full",children:w},w))})}),i.workHistory&&i.workHistory.length>0&&y.jsx(Th,{icon:y.jsx(fs,{className:"w-6 h-6"}),title:"Lch s lm vic",children:y.jsx("div",{className:"space-y-4",children:i.workHistory.map((w,x)=>y.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[y.jsx("h5",{className:"font-bold text-gray-800",children:w.title}),y.jsx("p",{className:"text-sm text-gray-600",children:w.company}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w.duration})]},x))})})]})]})]})})},hne=({userLocation:n,allJobs:e,currentUserData:t,onViewOnMap:r,onJobSelect:i})=>{const[s,o]=Q.useState(5),[l,u]=Q.useState(!1),[d,p]=Q.useState([]),[v,w]=Q.useState(!1),[x,A]=Q.useState(null);Q.useEffect(()=>{(async()=>{try{const te=(await Ye.collection("users").doc(t.uid).get()).data();if(te&&te.lastRecommendations){const ee=te.lastRecommendations;ee.results&&Array.isArray(ee.results)&&ee.results.length>0&&(p(ee.results),o(ee.radius||5),w(!0))}}catch(K){console.error("Failed to load recommendation history",K)}})()},[t.uid]);const R=Q.useMemo(()=>n?e.filter(q=>{const K=jg(q.location);if(!K)return!1;const te=xL(n.lat,n.lng,K.lat,K.lng);return q.distance=te,te<=s&&q.status==="OPEN"}):[],[e,n,s]),L=async()=>{if(R.length===0){p([]),w(!0);return}u(!0);try{const q=R.sort((te,ee)=>(te.distance||0)-(ee.distance||0)).slice(0,20),K=await qee(t,q);p(K),w(!0),await Ye.collection("users").doc(t.uid).update({lastRecommendations:{timestamp:new Date().toISOString(),radius:s,results:K}})}catch(q){console.error("Analysis failed",q)}finally{u(!1)}},j=q=>{const K=R.find(te=>te.id===q.jobId);K&&A({rec:q,job:K})},B=q=>q>=80?"text-green-600 bg-green-100 border-green-200":q>=50?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-red-600 bg-red-100 border-red-200";return y.jsxs("div",{className:"space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 sm:p-10 text-white shadow-lg relative overflow-hidden",children:[y.jsxs("div",{className:"relative z-10",children:[y.jsxs("h2",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[y.jsx(Yo,{className:"w-8 h-8 text-yellow-300"}),"Gi  Vic lm Thng minh"]}),y.jsx("p",{className:"text-indigo-100 max-w-2xl",children:"S dng AI  phn tch h s ca bn, so snh khong cch, k nng v mc lng  tm ra cng vic ph hp nht trong khu vc."})]}),y.jsx("div",{className:"absolute top-0 right-0 -mr-10 -mt-10 w-40 h-40 bg-white opacity-10 rounded-full"}),y.jsx("div",{className:"absolute bottom-0 left-0 -ml-10 -mb-10 w-40 h-40 bg-purple-400 opacity-20 rounded-full"})]}),y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-6",children:[y.jsxs("div",{className:"w-full sm:w-2/3",children:[y.jsxs("label",{htmlFor:"radius",className:"block text-sm font-medium text-gray-700 mb-2",children:["Khong cch tm kim: ",y.jsxs("span",{className:"text-indigo-600 font-bold",children:[s," km"]})]}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:"range",id:"radius",min:"0.5",max:"10",step:"0.5",value:s,onChange:q=>o(parseFloat(q.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),y.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[y.jsx("span",{children:"500m"}),y.jsx("span",{children:"10km"})]})]})]}),y.jsx("div",{className:"w-full sm:w-auto flex-shrink-0",children:y.jsx("button",{onClick:L,disabled:l||!n,className:"w-full sm:w-auto bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:l?y.jsxs(y.Fragment,{children:[y.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang phn tch..."]}):y.jsxs(y.Fragment,{children:[y.jsx(Yo,{className:"w-5 h-5"}),"Phn tch ngay"]})})})]}),!n&&y.jsxs("p",{className:"text-red-500 text-sm mt-2 flex items-center gap-1",children:[y.jsx(ia,{className:"w-4 h-4"}),"Vui lng bt nh v  s dng tnh nng ny."]}),n&&!v&&y.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Tm thy ",y.jsx("span",{className:"font-bold text-gray-800",children:R.length})," cng vic trong bn knh ",s,'km. Nhn "Phn tch ngay"  AI nh gi.']})]}),v&&y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Kt qu  xut (",d.length,")"]})}),d.length===0?y.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:[y.jsx(fs,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),y.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"Khng tm thy cng vic ph hp cao trong bn knh ny."}),y.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Hy th m rng khong cch tm kim hoc cp nht h s k nng ca bn."})]}):y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(q=>{var te;const K=R.find(ee=>ee.id===q.jobId);return K?y.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md hover:border-indigo-300 transition-all flex flex-col h-full relative overflow-hidden",children:[y.jsxs("div",{className:"flex justify-between items-start mb-4",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"text-lg font-bold text-gray-800 line-clamp-1",title:K.title,children:K.title}),y.jsx("p",{className:"text-sm text-gray-600 truncate",children:K.employerName})]}),y.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-4 ${B(q.matchScore)} shadow-sm flex-shrink-0 ml-2`,children:y.jsxs("span",{className:"text-sm font-bold",children:[q.matchScore,"%"]})})]}),y.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-4 space-x-3",children:[y.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[y.jsx(ia,{className:"w-3 h-3 mr-1"}),(te=K.distance)==null?void 0:te.toFixed(1)," km"]}),y.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[y.jsx(fs,{className:"w-3 h-3 mr-1"}),K.jobType]})]}),y.jsxs("div",{className:"space-y-4 flex-grow",children:[y.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-100",children:[y.jsxs("p",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide mb-1 flex items-center gap-1",children:[y.jsx(Yo,{className:"w-3 h-3"}),"AI nh gi"]}),y.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed line-clamp-3",children:q.reason})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-gray-100",children:[y.jsxs("div",{children:[y.jsx("p",{className:"font-semibold text-green-700 text-xs mb-1",children:"u im chnh"}),y.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:q.pros.slice(0,2).map((ee,P)=>y.jsxs("li",{className:"truncate",children:[" ",ee]},P))})]}),y.jsxs("div",{children:[y.jsx("p",{className:"font-semibold text-red-700 text-xs mb-1",children:"Lu "}),y.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:q.cons.slice(0,1).map((ee,P)=>y.jsxs("li",{className:"truncate",children:[" ",ee]},P))})]})]})]}),y.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[y.jsxs("button",{onClick:()=>j(q),className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 shadow-sm",children:[y.jsx(Yo,{className:"w-4 h-4"}),"Chi tit AI"]}),y.jsxs("button",{onClick:()=>r(K),className:"w-full bg-white text-indigo-600 font-bold py-2 px-4 rounded-lg border border-indigo-200 hover:bg-indigo-50 hover:border-indigo-400 transition-colors flex items-center justify-center gap-2",children:[y.jsx(ia,{className:"w-4 h-4"}),"Xem v tr"]})]})]},q.jobId):null})})]}),x&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:()=>A(null),children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up max-h-[90vh] flex flex-col",onClick:q=>q.stopPropagation(),children:[y.jsxs("div",{className:"p-6 bg-indigo-600 text-white flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[y.jsx(Yo,{className:"w-6 h-6 text-yellow-300"}),y.jsx("span",{className:"font-bold text-indigo-100 uppercase tracking-wider text-xs",children:"Phn tch chuyn su"})]}),y.jsx("h2",{className:"text-2xl font-bold",children:x.job.title}),y.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:x.job.employerName})]}),y.jsx("button",{onClick:()=>A(null),className:"text-white hover:bg-white/20 rounded-full p-1 transition-colors",children:y.jsx(u_,{className:"w-6 h-6"})})]}),y.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[y.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded-xl border border-gray-200",children:[y.jsxs("div",{className:`w-16 h-16 rounded-full border-4 ${B(x.rec.matchScore)} flex items-center justify-center bg-white text-xl font-bold shadow-sm`,children:[x.rec.matchScore,"%"]}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Mc  ph hp"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Da trn h s k nng, v tr v mong mun ca bn."})]})]}),y.jsxs("div",{children:[y.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-2",children:[y.jsx(wV,{className:"w-5 h-5 text-indigo-500 mr-2"}),"Ti sao cng vic ny ph hp?"]}),y.jsx("p",{className:"text-gray-700 leading-relaxed bg-indigo-50 p-4 rounded-lg border border-indigo-100 text-sm",children:x.rec.reason})]}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[y.jsxs("div",{children:[y.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[y.jsx(X0,{className:"w-5 h-5 text-green-500 mr-2"}),"u im"]}),y.jsx("ul",{className:"space-y-2",children:x.rec.pros.map((q,K)=>y.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[y.jsx("span",{className:"mr-2 text-green-500",children:""}),q]},K))})]}),y.jsxs("div",{children:[y.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[y.jsx(kL,{className:"w-5 h-5 text-red-500 mr-2"}),"Cn cn nhc"]}),y.jsx("ul",{className:"space-y-2",children:x.rec.cons.map((q,K)=>y.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[y.jsx("span",{className:"mr-2 text-red-500",children:""}),q]},K))})]})]}),x.rec.environmentAnalysis&&y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Phn tch mi trng & Ri ro"}),y.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm text-gray-700",children:x.rec.environmentAnalysis})]})]}),y.jsxs("div",{className:"p-6 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[y.jsxs("button",{onClick:()=>{i(x.job)},className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md flex items-center justify-center gap-2",children:[y.jsx(NL,{className:"w-5 h-5"}),"Xem tin tuyn dng & ng tuyn"]}),y.jsxs("button",{onClick:()=>{r(x.job),A(null)},className:"w-full bg-white text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors flex items-center justify-center gap-2",children:[y.jsx(ia,{className:"w-5 h-5"}),"Xem v tr trn bn "]})]})]})})]})},fne=({activeMode:n,setMode:e})=>y.jsxs("div",{className:"flex items-center bg-gray-200 rounded-lg p-1",children:[y.jsxs("button",{onClick:()=>e("list"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="list"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="list",children:[y.jsx(qte,{className:"w-4 h-4 mr-2"}),"Danh sch"]}),y.jsxs("button",{onClick:()=>e("map"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="map"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="map",children:[y.jsx(Hte,{className:"w-4 h-4 mr-2"}),"Bn "]})]}),pne=()=>{const{currentUser:n,currentUserData:e,loading:t}=po(),[r,i]=Q.useState(Tn.Jobs),[s,o]=Q.useState(null),[l,u]=Q.useState("list"),[d,p]=Q.useState(null),[v,w]=Q.useState(!1),[x,A]=Q.useState(null),[R,L]=Q.useState(null),[j,B]=Q.useState([]),[q,K]=Q.useState(!0),[te,ee]=Q.useState({}),[P,k]=Q.useState(null),[b,F]=Q.useState(null),[D,O]=Q.useState(""),[M,$e]=Q.useState("");Q.useEffect(()=>{var it;const ue=(it=window.Capacitor)==null?void 0:it.isNativePlatform();"serviceWorker"in navigator&&!ue&&window.addEventListener("load",()=>{const je=`${window.location.origin}/sw.js`;navigator.serviceWorker.register(je).then(ft=>{console.log("Service Worker registered with scope:",ft.scope)}).catch(ft=>{console.error("Service Worker registration failed:",ft)})}),navigator.geolocation.getCurrentPosition(je=>{k({lat:je.coords.latitude,lng:je.coords.longitude}),F(null)},je=>{console.error("Geolocation error:",je),F("Khng th ly v tr ca bn. Hy th cho php truy cp v tr trong trnh duyt  xem cc cng vic gn bn.")}),K(!0);const _e=jte(je=>{B(je),K(!1)}),Be=bte(ee);return()=>{_e(),Be()}},[]);const dt=ue=>{o(ue)},et=ue=>{ue&&(o(null),i(Tn.Jobs),u("map"),p(ue.id))},tt=ue=>{A(ue),i(Tn.Messaging)},fe=async ue=>{if(ue)try{const _e=await FW(ue);R&&L(null),tt(_e)}catch(_e){console.error("Failed to start conversation:",_e),alert("Khng th bt u cuc tr chuyn.")}},Ne=()=>{p(null)},ye=()=>{o(null)},G=()=>{O(""),$e("")},ne=ue=>{if(ue.startsWith("/jobs/")){const _e=ue.split("/jobs/")[1],Be=j.find(it=>it.id===_e);Be&&o(Be)}else ue==="/profile"&&i(Tn.Profile)},{uniqueLocations:Re,uniqueTypes:Me,filteredJobs:Ue}=Q.useMemo(()=>{const ue=j.filter(ft=>ft.status==="OPEN"),_e=P?ue.map(ft=>{const dn=jg(ft.location);if(dn){const $r=xL(P.lat,P.lng,dn.lat,dn.lng);return{...ft,distance:$r}}return ft}):ue,Be=[...new Set(_e.map(ft=>ft.addressString))],it=[...new Set(_e.map(ft=>ft.jobType).filter(Boolean))];let je=_e;return D&&(je=je.filter(ft=>ft.addressString===D)),M&&(je=je.filter(ft=>ft.jobType===M)),P&&je.sort((ft,dn)=>(ft.distance??1/0)-(dn.distance??1/0)),{uniqueLocations:Be,uniqueTypes:it,filteredJobs:je}},[j,D,M,P]),He=()=>{const ue=r;return y.jsx("div",{className:"animate-fade-in-up",style:{animationDuration:"0.4s"},children:(()=>{switch(r){case Tn.Jobs:return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Tm kim vic lm"}),y.jsx(fne,{activeMode:l,setMode:u})]}),y.jsx(Vte,{locations:Re,types:Me,locationFilter:D,typeFilter:M,onLocationChange:O,onTypeChange:$e,onReset:G}),b&&y.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 p-4 rounded-r-lg",role:"alert",children:[y.jsx("p",{className:"font-bold",children:"Thng bo"}),y.jsx("p",{children:b})]}),l==="list"&&y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4",children:"Vic lm kh dng"}),q?y.jsx(mr,{message:"ang ti cng vic..."}):Ue.length>0?Ue.map(_e=>y.jsx(tK,{job:_e,onClick:()=>dt(_e),applicantCount:te[_e.id]||0},_e.id)):y.jsx("div",{className:"text-center py-16 px-4 bg-gray-50 rounded-lg",children:y.jsx("p",{className:"text-gray-600",children:"Khng tm thy cng vic no ph hp vi b lc ca bn."})})]}),l==="map"&&y.jsxs("div",{children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4 mb-4",children:"V tr cng vic"}),q?y.jsx(mr,{}):y.jsx(Bte,{jobs:Ue,onJobSelect:dt,focusedJobId:d,onFocusComplete:Ne,userLocation:P})]})]});case Tn.Recommendations:return y.jsx(hne,{userLocation:P,allJobs:j,currentUserData:e,onViewOnMap:et,onJobSelect:dt});case Tn.Insurance:return y.jsx(aK,{});case Tn.Messaging:return y.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:y.jsx(hK,{initialSelectedConversationId:x,clearInitialSelection:()=>A(null)})});case Tn.Chatbot:return y.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:y.jsx(Nte,{allJobs:Ue})});case Tn.Profile:return y.jsx(Xte,{onViewProfile:(_e,Be)=>L({userId:_e,applicationContext:Be}),onJobSelect:dt});default:return null}})()},ue)};return t?y.jsx(mr,{fullScreen:!0,message:"ang ti ng dng..."}):n?!e||!e.fullName?y.jsx(lne,{}):y.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe",children:[y.jsx(YW,{activeView:r,setActiveView:i,onPostJobClick:()=>w(!0),onNotificationNavigate:ne}),y.jsx("main",{className:"max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 md:py-10 pb-28 md:pb-10",children:He()}),s&&y.jsx(Lte,{job:s,onClose:ye,onViewOnMap:()=>et(s)}),v&&y.jsx(ene,{onClose:()=>w(!1)}),R&&y.jsx(dne,{userId:R.userId,application:R.applicationContext,onClose:()=>L(null),onStartChat:R.applicationContext?()=>fe(R.applicationContext):void 0})]}):y.jsx(ane,{})},TV=document.getElementById("root");if(!TV)throw new Error("Could not find root element to mount to");const mne=hb.createRoot(TV);mne.render(y.jsx(MF.StrictMode,{children:y.jsx(VW,{children:y.jsx(pne,{})})}));
