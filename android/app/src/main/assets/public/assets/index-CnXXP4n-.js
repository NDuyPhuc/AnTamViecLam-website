var VL=Object.defineProperty;var pb=n=>{throw TypeError(n)};var jL=(n,e,t)=>e in n?VL(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var bt=(n,e,t)=>jL(n,typeof e!="symbol"?e+"":e,t),FL=(n,e,t)=>e.has(n)||pb("Cannot "+t);var mb=(n,e,t)=>e.has(n)?pb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var tm=(n,e,t)=>(FL(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function KN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lv={exports:{}},Vh={},cv={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function UL(){if(gb)return qe;gb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function E(F){return F===null||typeof F!="object"?null:(F=y&&F[y]||F["@@iterator"],typeof F=="function"?F:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,O={};function M(F,J,xe){this.props=F,this.context=J,this.refs=O,this.updater=xe||x}M.prototype.isReactComponent={},M.prototype.setState=function(F,J){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,J,"setState")},M.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function X(){}X.prototype=M.prototype;function W(F,J,xe){this.props=F,this.context=J,this.refs=O,this.updater=xe||x}var Q=W.prototype=new X;Q.constructor=W,P(Q,M.prototype),Q.isPureReactComponent=!0;var Y=Array.isArray,ue=Object.prototype.hasOwnProperty,se={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function S(F,J,xe){var De,Ae={},Ne=null,fe=null;if(J!=null)for(De in J.ref!==void 0&&(fe=J.ref),J.key!==void 0&&(Ne=""+J.key),J)ue.call(J,De)&&!R.hasOwnProperty(De)&&(Ae[De]=J[De]);var ve=arguments.length-2;if(ve===1)Ae.children=xe;else if(1<ve){for(var Me=Array(ve),Ue=0;Ue<ve;Ue++)Me[Ue]=arguments[Ue+2];Ae.children=Me}if(F&&F.defaultProps)for(De in ve=F.defaultProps,ve)Ae[De]===void 0&&(Ae[De]=ve[De]);return{$$typeof:n,type:F,key:Ne,ref:fe,props:Ae,_owner:se.current}}function k(F,J){return{$$typeof:n,type:F.type,key:J,ref:F.ref,props:F.props,_owner:F._owner}}function D(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function N(F){var J={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(xe){return J[xe]})}var j=/\/+/g;function C(F,J){return typeof F=="object"&&F!==null&&F.key!=null?N(""+F.key):J.toString(36)}function We(F,J,xe,De,Ae){var Ne=typeof F;(Ne==="undefined"||Ne==="boolean")&&(F=null);var fe=!1;if(F===null)fe=!0;else switch(Ne){case"string":case"number":fe=!0;break;case"object":switch(F.$$typeof){case n:case e:fe=!0}}if(fe)return fe=F,Ae=Ae(fe),F=De===""?"."+C(fe,0):De,Y(Ae)?(xe="",F!=null&&(xe=F.replace(j,"$&/")+"/"),We(Ae,J,xe,"",function(Ue){return Ue})):Ae!=null&&(D(Ae)&&(Ae=k(Ae,xe+(!Ae.key||fe&&fe.key===Ae.key?"":(""+Ae.key).replace(j,"$&/")+"/")+F)),J.push(Ae)),1;if(fe=0,De=De===""?".":De+":",Y(F))for(var ve=0;ve<F.length;ve++){Ne=F[ve];var Me=De+C(Ne,ve);fe+=We(Ne,J,xe,Me,Ae)}else if(Me=E(F),typeof Me=="function")for(F=Me.call(F),ve=0;!(Ne=F.next()).done;)Ne=Ne.value,Me=De+C(Ne,ve++),fe+=We(Ne,J,xe,Me,Ae);else if(Ne==="object")throw J=String(F),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return fe}function Et(F,J,xe){if(F==null)return F;var De=[],Ae=0;return We(F,De,"","",function(Ne){return J.call(xe,Ne,Ae++)}),De}function Nt(F){if(F._status===-1){var J=F._result;J=J(),J.then(function(xe){(F._status===0||F._status===-1)&&(F._status=1,F._result=xe)},function(xe){(F._status===0||F._status===-1)&&(F._status=2,F._result=xe)}),F._status===-1&&(F._status=0,F._result=J)}if(F._status===1)return F._result.default;throw F._result}var st={current:null},ce={transition:null},Se={ReactCurrentDispatcher:st,ReactCurrentBatchConfig:ce,ReactCurrentOwner:se};function me(){throw Error("act(...) is not supported in production builds of React.")}return qe.Children={map:Et,forEach:function(F,J,xe){Et(F,function(){J.apply(this,arguments)},xe)},count:function(F){var J=0;return Et(F,function(){J++}),J},toArray:function(F){return Et(F,function(J){return J})||[]},only:function(F){if(!D(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},qe.Component=M,qe.Fragment=t,qe.Profiler=s,qe.PureComponent=W,qe.StrictMode=r,qe.Suspense=h,qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Se,qe.act=me,qe.cloneElement=function(F,J,xe){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var De=P({},F.props),Ae=F.key,Ne=F.ref,fe=F._owner;if(J!=null){if(J.ref!==void 0&&(Ne=J.ref,fe=se.current),J.key!==void 0&&(Ae=""+J.key),F.type&&F.type.defaultProps)var ve=F.type.defaultProps;for(Me in J)ue.call(J,Me)&&!R.hasOwnProperty(Me)&&(De[Me]=J[Me]===void 0&&ve!==void 0?ve[Me]:J[Me])}var Me=arguments.length-2;if(Me===1)De.children=xe;else if(1<Me){ve=Array(Me);for(var Ue=0;Ue<Me;Ue++)ve[Ue]=arguments[Ue+2];De.children=ve}return{$$typeof:n,type:F.type,key:Ae,ref:Ne,props:De,_owner:fe}},qe.createContext=function(F){return F={$$typeof:a,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:i,_context:F},F.Consumer=F},qe.createElement=S,qe.createFactory=function(F){var J=S.bind(null,F);return J.type=F,J},qe.createRef=function(){return{current:null}},qe.forwardRef=function(F){return{$$typeof:c,render:F}},qe.isValidElement=D,qe.lazy=function(F){return{$$typeof:g,_payload:{_status:-1,_result:F},_init:Nt}},qe.memo=function(F,J){return{$$typeof:p,type:F,compare:J===void 0?null:J}},qe.startTransition=function(F){var J=ce.transition;ce.transition={};try{F()}finally{ce.transition=J}},qe.unstable_act=me,qe.useCallback=function(F,J){return st.current.useCallback(F,J)},qe.useContext=function(F){return st.current.useContext(F)},qe.useDebugValue=function(){},qe.useDeferredValue=function(F){return st.current.useDeferredValue(F)},qe.useEffect=function(F,J){return st.current.useEffect(F,J)},qe.useId=function(){return st.current.useId()},qe.useImperativeHandle=function(F,J,xe){return st.current.useImperativeHandle(F,J,xe)},qe.useInsertionEffect=function(F,J){return st.current.useInsertionEffect(F,J)},qe.useLayoutEffect=function(F,J){return st.current.useLayoutEffect(F,J)},qe.useMemo=function(F,J){return st.current.useMemo(F,J)},qe.useReducer=function(F,J,xe){return st.current.useReducer(F,J,xe)},qe.useRef=function(F){return st.current.useRef(F)},qe.useState=function(F){return st.current.useState(F)},qe.useSyncExternalStore=function(F,J,xe){return st.current.useSyncExternalStore(F,J,xe)},qe.useTransition=function(){return st.current.useTransition()},qe.version="18.3.1",qe}var _b;function c0(){return _b||(_b=1,cv.exports=UL()),cv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yb;function BL(){if(yb)return Vh;yb=1;var n=c0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(c,h,p){var g,y={},E=null,x=null;p!==void 0&&(E=""+p),h.key!==void 0&&(E=""+h.key),h.ref!==void 0&&(x=h.ref);for(g in h)r.call(h,g)&&!i.hasOwnProperty(g)&&(y[g]=h[g]);if(c&&c.defaultProps)for(g in h=c.defaultProps,h)y[g]===void 0&&(y[g]=h[g]);return{$$typeof:e,type:c,key:E,ref:x,props:y,_owner:s.current}}return Vh.Fragment=t,Vh.jsx=a,Vh.jsxs=a,Vh}var vb;function zL(){return vb||(vb=1,lv.exports=BL()),lv.exports}var f=zL(),H=c0();const $L=KN(H);var nm={},uv={exports:{}},ir={},hv={exports:{}},dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wb;function HL(){return wb||(wb=1,(function(n){function e(ce,Se){var me=ce.length;ce.push(Se);e:for(;0<me;){var F=me-1>>>1,J=ce[F];if(0<s(J,Se))ce[F]=Se,ce[me]=J,me=F;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Se=ce[0],me=ce.pop();if(me!==Se){ce[0]=me;e:for(var F=0,J=ce.length,xe=J>>>1;F<xe;){var De=2*(F+1)-1,Ae=ce[De],Ne=De+1,fe=ce[Ne];if(0>s(Ae,me))Ne<J&&0>s(fe,Ae)?(ce[F]=fe,ce[Ne]=me,F=Ne):(ce[F]=Ae,ce[De]=me,F=De);else if(Ne<J&&0>s(fe,me))ce[F]=fe,ce[Ne]=me,F=Ne;else break e}}return Se}function s(ce,Se){var me=ce.sortIndex-Se.sortIndex;return me!==0?me:ce.id-Se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();n.unstable_now=function(){return a.now()-c}}var h=[],p=[],g=1,y=null,E=3,x=!1,P=!1,O=!1,M=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(ce){for(var Se=t(p);Se!==null;){if(Se.callback===null)r(p);else if(Se.startTime<=ce)r(p),Se.sortIndex=Se.expirationTime,e(h,Se);else break;Se=t(p)}}function Y(ce){if(O=!1,Q(ce),!P)if(t(h)!==null)P=!0,Nt(ue);else{var Se=t(p);Se!==null&&st(Y,Se.startTime-ce)}}function ue(ce,Se){P=!1,O&&(O=!1,X(S),S=-1),x=!0;var me=E;try{for(Q(Se),y=t(h);y!==null&&(!(y.expirationTime>Se)||ce&&!N());){var F=y.callback;if(typeof F=="function"){y.callback=null,E=y.priorityLevel;var J=F(y.expirationTime<=Se);Se=n.unstable_now(),typeof J=="function"?y.callback=J:y===t(h)&&r(h),Q(Se)}else r(h);y=t(h)}if(y!==null)var xe=!0;else{var De=t(p);De!==null&&st(Y,De.startTime-Se),xe=!1}return xe}finally{y=null,E=me,x=!1}}var se=!1,R=null,S=-1,k=5,D=-1;function N(){return!(n.unstable_now()-D<k)}function j(){if(R!==null){var ce=n.unstable_now();D=ce;var Se=!0;try{Se=R(!0,ce)}finally{Se?C():(se=!1,R=null)}}else se=!1}var C;if(typeof W=="function")C=function(){W(j)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Et=We.port2;We.port1.onmessage=j,C=function(){Et.postMessage(null)}}else C=function(){M(j,0)};function Nt(ce){R=ce,se||(se=!0,C())}function st(ce,Se){S=M(function(){ce(n.unstable_now())},Se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){P||x||(P=!0,Nt(ue))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(ce){switch(E){case 1:case 2:case 3:var Se=3;break;default:Se=E}var me=E;E=Se;try{return ce()}finally{E=me}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Se){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var me=E;E=ce;try{return Se()}finally{E=me}},n.unstable_scheduleCallback=function(ce,Se,me){var F=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?F+me:F):me=F,ce){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=me+J,ce={id:g++,callback:Se,priorityLevel:ce,startTime:me,expirationTime:J,sortIndex:-1},me>F?(ce.sortIndex=me,e(p,ce),t(h)===null&&ce===t(p)&&(O?(X(S),S=-1):O=!0,st(Y,me-F))):(ce.sortIndex=J,e(h,ce),P||x||(P=!0,Nt(ue))),ce},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(ce){var Se=E;return function(){var me=E;E=Se;try{return ce.apply(this,arguments)}finally{E=me}}}})(dv)),dv}var Eb;function WL(){return Eb||(Eb=1,hv.exports=HL()),hv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function qL(){if(Ib)return ir;Ib=1;var n=c0(),e=WL();function t(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(o,l){a(o,l),a(o+"Capture",l)}function a(o,l){for(s[o]=l,o=0;o<l.length;o++)r.add(l[o])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},y={};function E(o){return h.call(y,o)?!0:h.call(g,o)?!1:p.test(o)?y[o]=!0:(g[o]=!0,!1)}function x(o,l,u,m){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function P(o,l,u,m){if(l===null||typeof l>"u"||x(o,l,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function O(o,l,u,m,_,v,T){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=o,this.type=l,this.sanitizeURL=v,this.removeEmptyString=T}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){M[o]=new O(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];M[l]=new O(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){M[o]=new O(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){M[o]=new O(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){M[o]=new O(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){M[o]=new O(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){M[o]=new O(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){M[o]=new O(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){M[o]=new O(o,5,!1,o.toLowerCase(),null,!1,!1)});var X=/[\-:]([a-z])/g;function W(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(X,W);M[l]=new O(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(X,W);M[l]=new O(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(X,W);M[l]=new O(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){M[o]=new O(o,1,!1,o.toLowerCase(),null,!1,!1)}),M.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){M[o]=new O(o,1,!1,o.toLowerCase(),null,!0,!0)});function Q(o,l,u,m){var _=M.hasOwnProperty(l)?M[l]:null;(_!==null?_.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(P(l,u,_,m)&&(u=null),m||_===null?E(l)&&(u===null?o.removeAttribute(l):o.setAttribute(l,""+u)):_.mustUseProperty?o[_.propertyName]=u===null?_.type===3?!1:"":u:(l=_.attributeName,m=_.attributeNamespace,u===null?o.removeAttribute(l):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,m?o.setAttributeNS(m,l,u):o.setAttribute(l,u))))}var Y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ue=Symbol.for("react.element"),se=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),Et=Symbol.for("react.memo"),Nt=Symbol.for("react.lazy"),st=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Se(o){return o===null||typeof o!="object"?null:(o=ce&&o[ce]||o["@@iterator"],typeof o=="function"?o:null)}var me=Object.assign,F;function J(o){if(F===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);F=l&&l[1]||""}return`
`+F+o}var xe=!1;function De(o,l){if(!o||xe)return"";xe=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(q){var m=q}Reflect.construct(o,[],l)}else{try{l.call()}catch(q){m=q}o.call(l.prototype)}else{try{throw Error()}catch(q){m=q}o()}}catch(q){if(q&&m&&typeof q.stack=="string"){for(var _=q.stack.split(`
`),v=m.stack.split(`
`),T=_.length-1,A=v.length-1;1<=T&&0<=A&&_[T]!==v[A];)A--;for(;1<=T&&0<=A;T--,A--)if(_[T]!==v[A]){if(T!==1||A!==1)do if(T--,A--,0>A||_[T]!==v[A]){var L=`
`+_[T].replace(" at new "," at ");return o.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",o.displayName)),L}while(1<=T&&0<=A);break}}}finally{xe=!1,Error.prepareStackTrace=u}return(o=o?o.displayName||o.name:"")?J(o):""}function Ae(o){switch(o.tag){case 5:return J(o.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return o=De(o.type,!1),o;case 11:return o=De(o.type.render,!1),o;case 1:return o=De(o.type,!0),o;default:return""}}function Ne(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case R:return"Fragment";case se:return"Portal";case k:return"Profiler";case S:return"StrictMode";case C:return"Suspense";case We:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case N:return(o.displayName||"Context")+".Consumer";case D:return(o._context.displayName||"Context")+".Provider";case j:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Et:return l=o.displayName||null,l!==null?l:Ne(o.type)||"Memo";case Nt:l=o._payload,o=o._init;try{return Ne(o(l))}catch{}}return null}function fe(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(l);case 8:return l===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Me(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ue(o){var l=Me(o)?"checked":"value",u=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),m=""+o[l];if(!o.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,v=u.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return _.call(this)},set:function(T){m=""+T,v.call(this,T)}}),Object.defineProperty(o,l,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(T){m=""+T},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function it(o){o._valueTracker||(o._valueTracker=Ue(o))}function Vr(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var u=l.getValue(),m="";return o&&(m=Me(o)?o.checked?"true":"false":o.value),o=m,o!==u?(l.setValue(o),!0):!1}function mr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Is(o,l){var u=l.checked;return me({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??o._wrapperState.initialChecked})}function di(o,l){var u=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;u=ve(l.value!=null?l.value:u),o._wrapperState={initialChecked:m,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function In(o,l){l=l.checked,l!=null&&Q(o,"checked",l,!1)}function fi(o,l){In(o,l);var u=ve(l.value),m=l.type;if(u!=null)m==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+u):o.value!==""+u&&(o.value=""+u);else if(m==="submit"||m==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?Ot(o,l.type,u):l.hasOwnProperty("defaultValue")&&Ot(o,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function pi(o,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,u||l===o.value||(o.value=l),o.defaultValue=l}u=o.name,u!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,u!==""&&(o.name=u)}function Ot(o,l,u){(l!=="number"||mr(o.ownerDocument)!==o)&&(u==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+u&&(o.defaultValue=""+u))}var Lt=Array.isArray;function Zn(o,l,u,m){if(o=o.options,l){l={};for(var _=0;_<u.length;_++)l["$"+u[_]]=!0;for(u=0;u<o.length;u++)_=l.hasOwnProperty("$"+o[u].value),o[u].selected!==_&&(o[u].selected=_),_&&m&&(o[u].defaultSelected=!0)}else{for(u=""+ve(u),l=null,_=0;_<o.length;_++){if(o[_].value===u){o[_].selected=!0,m&&(o[_].defaultSelected=!0);return}l!==null||o[_].disabled||(l=o[_])}l!==null&&(l.selected=!0)}}function io(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return me({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function oo(o,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(t(92));if(Lt(u)){if(1<u.length)throw Error(t(93));u=u[0]}l=u}l==null&&(l=""),u=l}o._wrapperState={initialValue:ve(u)}}function ba(o,l){var u=ve(l.value),m=ve(l.defaultValue);u!=null&&(u=""+u,u!==o.value&&(o.value=u),l.defaultValue==null&&o.defaultValue!==u&&(o.defaultValue=u)),m!=null&&(o.defaultValue=""+m)}function ts(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function ao(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mi(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?ao(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ns,Sa=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,m,_){MSApp.execUnsafeLocalFunction(function(){return o(l,u,m,_)})}:o})(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(ns=ns||document.createElement("div"),ns.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=ns.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function gi(o,l){if(l){var u=o.firstChild;if(u&&u===o.lastChild&&u.nodeType===3){u.nodeValue=l;return}}o.textContent=l}var jr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zl=["Webkit","ms","Moz","O"];Object.keys(jr).forEach(function(o){Zl.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),jr[l]=jr[o]})});function Ts(o,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||jr.hasOwnProperty(o)&&jr[o]?(""+l).trim():l+"px"}function lo(o,l){o=o.style;for(var u in l)if(l.hasOwnProperty(u)){var m=u.indexOf("--")===0,_=Ts(u,l[u],m);u==="float"&&(u="cssFloat"),m?o.setProperty(u,_):o[u]=_}}var Aa=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gr(o,l){if(l){if(Aa[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function _i(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xs=null;function co(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var rs=null,Z=null,Ee=null;function et(o){if(o=Ih(o)){if(typeof rs!="function")throw Error(t(280));var l=o.stateNode;l&&(l=gp(l),rs(o.stateNode,o.type,l))}}function un(o){Z?Ee?Ee.push(o):Ee=[o]:Z=o}function Fr(){if(Z){var o=Z,l=Ee;if(Ee=Z=null,et(o),l)for(o=0;o<l.length;o++)et(l[o])}}function _r(o,l){return o(l)}function uo(){}var ss=!1;function ho(o,l,u){if(ss)return o(l,u);ss=!0;try{return _r(o,l,u)}finally{ss=!1,(Z!==null||Ee!==null)&&(uo(),Fr())}}function Na(o,l){var u=o.stateNode;if(u===null)return null;var m=gp(u);if(m===null)return null;u=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(o=o.type,m=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!m;break e;default:o=!1}if(o)return null;if(u&&typeof u!="function")throw Error(t(231,l,typeof u));return u}var fo=!1;if(c)try{var po={};Object.defineProperty(po,"passive",{get:function(){fo=!0}}),window.addEventListener("test",po,po),window.removeEventListener("test",po,po)}catch{fo=!1}function Gf(o,l,u,m,_,v,T,A,L){var q=Array.prototype.slice.call(arguments,3);try{l.apply(u,q)}catch(re){this.onError(re)}}var yi=!1,bs=null,ec=!1,Ur=null,Kf={onError:function(o){yi=!0,bs=o}};function Qf(o,l,u,m,_,v,T,A,L){yi=!1,bs=null,Gf.apply(Kf,arguments)}function Yu(o,l,u,m,_,v,T,A,L){if(Qf.apply(this,arguments),yi){if(yi){var q=bs;yi=!1,bs=null}else throw Error(t(198));ec||(ec=!0,Ur=q)}}function is(o){var l=o,u=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(u=l.return),o=l.return;while(o)}return l.tag===3?u:null}function Ju(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function Yf(o){if(is(o)!==o)throw Error(t(188))}function Jf(o){var l=o.alternate;if(!l){if(l=is(o),l===null)throw Error(t(188));return l!==o?null:o}for(var u=o,m=l;;){var _=u.return;if(_===null)break;var v=_.alternate;if(v===null){if(m=_.return,m!==null){u=m;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===u)return Yf(_),o;if(v===m)return Yf(_),l;v=v.sibling}throw Error(t(188))}if(u.return!==m.return)u=_,m=v;else{for(var T=!1,A=_.child;A;){if(A===u){T=!0,u=_,m=v;break}if(A===m){T=!0,m=_,u=v;break}A=A.sibling}if(!T){for(A=v.child;A;){if(A===u){T=!0,u=v,m=_;break}if(A===m){T=!0,m=v,u=_;break}A=A.sibling}if(!T)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?o:l}function Xf(o){return o=Jf(o),o!==null?Ca(o):null}function Ca(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=Ca(o);if(l!==null)return l;o=o.sibling}return null}var Xu=e.unstable_scheduleCallback,tc=e.unstable_cancelCallback,ka=e.unstable_shouldYield,vi=e.unstable_requestPaint,It=e.unstable_now,F_=e.unstable_getCurrentPriorityLevel,nc=e.unstable_ImmediatePriority,Zu=e.unstable_UserBlockingPriority,Ra=e.unstable_NormalPriority,eh=e.unstable_LowPriority,rc=e.unstable_IdlePriority,Pa=null,yr=null;function Zf(o){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(Pa,o,void 0,(o.current.flags&128)===128)}catch{}}var vr=Math.clz32?Math.clz32:Da,Ss=Math.log,Br=Math.LN2;function Da(o){return o>>>=0,o===0?32:31-(Ss(o)/Br|0)|0}var As=64,mo=4194304;function ot(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function wi(o,l){var u=o.pendingLanes;if(u===0)return 0;var m=0,_=o.suspendedLanes,v=o.pingedLanes,T=u&268435455;if(T!==0){var A=T&~_;A!==0?m=ot(A):(v&=T,v!==0&&(m=ot(v)))}else T=u&~_,T!==0?m=ot(T):v!==0&&(m=ot(v));if(m===0)return 0;if(l!==0&&l!==m&&(l&_)===0&&(_=m&-m,v=l&-l,_>=v||_===16&&(v&4194240)!==0))return l;if((m&4)!==0&&(m|=u&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=m;0<l;)u=31-vr(l),_=1<<u,m|=o[u],l&=~_;return m}function Oa(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function La(o,l){for(var u=o.suspendedLanes,m=o.pingedLanes,_=o.expirationTimes,v=o.pendingLanes;0<v;){var T=31-vr(v),A=1<<T,L=_[T];L===-1?((A&u)===0||(A&m)!==0)&&(_[T]=Oa(A,l)):L<=l&&(o.expiredLanes|=A),v&=~A}}function th(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function nh(){var o=As;return As<<=1,(As&4194240)===0&&(As=64),o}function rh(o){for(var l=[],u=0;31>u;u++)l.push(o);return l}function Ma(o,l,u){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-vr(l),o[l]=u}function U_(o,l){var u=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var m=o.eventTimes;for(o=o.expirationTimes;0<u;){var _=31-vr(u),v=1<<_;l[_]=0,m[_]=-1,o[_]=-1,u&=~v}}function sh(o,l){var u=o.entangledLanes|=l;for(o=o.entanglements;u;){var m=31-vr(u),_=1<<m;_&l|o[m]&l&&(o[m]|=l),u&=~_}}var Je=0;function Ns(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var ih,sc,oh,ah,lh,Cs=!1,ic=[],ks=null,Rs=null,Tn=null,Va=new Map,Ei=new Map,wr=[],ep="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function go(o,l){switch(o){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Rs=null;break;case"mouseover":case"mouseout":Tn=null;break;case"pointerover":case"pointerout":Va.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ei.delete(l.pointerId)}}function os(o,l,u,m,_,v){return o===null||o.nativeEvent!==v?(o={blockedOn:l,domEventName:u,eventSystemFlags:m,nativeEvent:v,targetContainers:[_]},l!==null&&(l=Ih(l),l!==null&&sc(l)),o):(o.eventSystemFlags|=m,l=o.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),o)}function tp(o,l,u,m,_){switch(l){case"focusin":return ks=os(ks,o,l,u,m,_),!0;case"dragenter":return Rs=os(Rs,o,l,u,m,_),!0;case"mouseover":return Tn=os(Tn,o,l,u,m,_),!0;case"pointerover":var v=_.pointerId;return Va.set(v,os(Va.get(v)||null,o,l,u,m,_)),!0;case"gotpointercapture":return v=_.pointerId,Ei.set(v,os(Ei.get(v)||null,o,l,u,m,_)),!0}return!1}function oc(o){var l=Ba(o.target);if(l!==null){var u=is(l);if(u!==null){if(l=u.tag,l===13){if(l=Ju(u),l!==null){o.blockedOn=l,lh(o.priority,function(){oh(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){o.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}o.blockedOn=null}function pt(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var u=ac(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(u===null){u=o.nativeEvent;var m=new u.constructor(u.type,u);xs=m,u.target.dispatchEvent(m),xs=null}else return l=Ih(u),l!==null&&sc(l),o.blockedOn=u,!1;l.shift()}return!0}function np(o,l,u){pt(o)&&u.delete(l)}function B_(){Cs=!1,ks!==null&&pt(ks)&&(ks=null),Rs!==null&&pt(Rs)&&(Rs=null),Tn!==null&&pt(Tn)&&(Tn=null),Va.forEach(np),Ei.forEach(np)}function _o(o,l){o.blockedOn===l&&(o.blockedOn=null,Cs||(Cs=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,B_)))}function yo(o){function l(_){return _o(_,o)}if(0<ic.length){_o(ic[0],o);for(var u=1;u<ic.length;u++){var m=ic[u];m.blockedOn===o&&(m.blockedOn=null)}}for(ks!==null&&_o(ks,o),Rs!==null&&_o(Rs,o),Tn!==null&&_o(Tn,o),Va.forEach(l),Ei.forEach(l),u=0;u<wr.length;u++)m=wr[u],m.blockedOn===o&&(m.blockedOn=null);for(;0<wr.length&&(u=wr[0],u.blockedOn===null);)oc(u),u.blockedOn===null&&wr.shift()}var Ii=Y.ReactCurrentBatchConfig,Ti=!0;function Ps(o,l,u,m){var _=Je,v=Ii.transition;Ii.transition=null;try{Je=1,ch(o,l,u,m)}finally{Je=_,Ii.transition=v}}function rp(o,l,u,m){var _=Je,v=Ii.transition;Ii.transition=null;try{Je=4,ch(o,l,u,m)}finally{Je=_,Ii.transition=v}}function ch(o,l,u,m){if(Ti){var _=ac(o,l,u,m);if(_===null)X_(o,l,m,Ds,u),go(o,m);else if(tp(_,o,l,u,m))m.stopPropagation();else if(go(o,m),l&4&&-1<ep.indexOf(o)){for(;_!==null;){var v=Ih(_);if(v!==null&&ih(v),v=ac(o,l,u,m),v===null&&X_(o,l,m,Ds,u),v===_)break;_=v}_!==null&&m.stopPropagation()}else X_(o,l,m,null,u)}}var Ds=null;function ac(o,l,u,m){if(Ds=null,o=co(m),o=Ba(o),o!==null)if(l=is(o),l===null)o=null;else if(u=l.tag,u===13){if(o=Ju(l),o!==null)return o;o=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return Ds=o,null}function lc(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F_()){case nc:return 1;case Zu:return 4;case Ra:case eh:return 16;case rc:return 536870912;default:return 16}default:return 16}}var Er=null,cc=null,xi=null;function sp(){if(xi)return xi;var o,l=cc,u=l.length,m,_="value"in Er?Er.value:Er.textContent,v=_.length;for(o=0;o<u&&l[o]===_[o];o++);var T=u-o;for(m=1;m<=T&&l[u-m]===_[v-m];m++);return xi=_.slice(o,1<m?1-m:void 0)}function ja(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function Os(){return!0}function uh(){return!1}function Pn(o){function l(u,m,_,v,T){this._reactName=u,this._targetInst=_,this.type=m,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var A in o)o.hasOwnProperty(A)&&(u=o[A],this[A]=u?u(v):v[A]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Os:uh,this.isPropagationStopped=uh,this}return me(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),l}var Ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fa=Pn(Ls),vo=me({},Ls,{view:0,detail:0}),uc=Pn(vo),hc,dc,Ir,Ua=me({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fe,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ir&&(Ir&&o.type==="mousemove"?(hc=o.screenX-Ir.screenX,dc=o.screenY-Ir.screenY):dc=hc=0,Ir=o),hc)},movementY:function(o){return"movementY"in o?o.movementY:dc}}),hh=Pn(Ua),ip=me({},Ua,{dataTransfer:0}),op=Pn(ip),fc=me({},vo,{relatedTarget:0}),xn=Pn(fc),ap=me({},Ls,{animationName:0,elapsedTime:0,pseudoElement:0}),lp=Pn(ap),wo=me({},Ls,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),d=Pn(wo),w=me({},Ls,{data:0}),I=Pn(w),b={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function he(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=K[o])?!!l[o]:!1}function Fe(){return he}var qt=me({},vo,{key:function(o){if(o.key){var l=b[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=ja(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?z[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fe,charCode:function(o){return o.type==="keypress"?ja(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?ja(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),ct=Pn(qt),Xt=me({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tr=Pn(Xt),bi=me({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fe}),Ms=Pn(bi),Vs=me({},Ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),pc=Pn(Vs),dh=me({},Ua,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),RO=Pn(dh),PO=[9,13,27,32],z_=c&&"CompositionEvent"in window,fh=null;c&&"documentMode"in document&&(fh=document.documentMode);var DO=c&&"TextEvent"in window&&!fh,oT=c&&(!z_||fh&&8<fh&&11>=fh),aT=" ",lT=!1;function cT(o,l){switch(o){case"keyup":return PO.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uT(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var mc=!1;function OO(o,l){switch(o){case"compositionend":return uT(l);case"keypress":return l.which!==32?null:(lT=!0,aT);case"textInput":return o=l.data,o===aT&&lT?null:o;default:return null}}function LO(o,l){if(mc)return o==="compositionend"||!z_&&cT(o,l)?(o=sp(),xi=cc=Er=null,mc=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return oT&&l.locale!=="ko"?null:l.data;default:return null}}var MO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hT(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!MO[o.type]:l==="textarea"}function dT(o,l,u,m){un(m),l=fp(l,"onChange"),0<l.length&&(u=new Fa("onChange","change",null,u,m),o.push({event:u,listeners:l}))}var ph=null,mh=null;function VO(o){kT(o,0)}function cp(o){var l=wc(o);if(Vr(l))return o}function jO(o,l){if(o==="change")return l}var fT=!1;if(c){var $_;if(c){var H_="oninput"in document;if(!H_){var pT=document.createElement("div");pT.setAttribute("oninput","return;"),H_=typeof pT.oninput=="function"}$_=H_}else $_=!1;fT=$_&&(!document.documentMode||9<document.documentMode)}function mT(){ph&&(ph.detachEvent("onpropertychange",gT),mh=ph=null)}function gT(o){if(o.propertyName==="value"&&cp(mh)){var l=[];dT(l,mh,o,co(o)),ho(VO,l)}}function FO(o,l,u){o==="focusin"?(mT(),ph=l,mh=u,ph.attachEvent("onpropertychange",gT)):o==="focusout"&&mT()}function UO(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return cp(mh)}function BO(o,l){if(o==="click")return cp(l)}function zO(o,l){if(o==="input"||o==="change")return cp(l)}function $O(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var as=typeof Object.is=="function"?Object.is:$O;function gh(o,l){if(as(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var u=Object.keys(o),m=Object.keys(l);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var _=u[m];if(!h.call(l,_)||!as(o[_],l[_]))return!1}return!0}function _T(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function yT(o,l){var u=_T(o);o=0;for(var m;u;){if(u.nodeType===3){if(m=o+u.textContent.length,o<=l&&m>=l)return{node:u,offset:l-o};o=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=_T(u)}}function vT(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?vT(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function wT(){for(var o=window,l=mr();l instanceof o.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)o=l.contentWindow;else break;l=mr(o.document)}return l}function W_(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function HO(o){var l=wT(),u=o.focusedElem,m=o.selectionRange;if(l!==u&&u&&u.ownerDocument&&vT(u.ownerDocument.documentElement,u)){if(m!==null&&W_(u)){if(l=m.start,o=m.end,o===void 0&&(o=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(o,u.value.length);else if(o=(l=u.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var _=u.textContent.length,v=Math.min(m.start,_);m=m.end===void 0?v:Math.min(m.end,_),!o.extend&&v>m&&(_=m,m=v,v=_),_=yT(u,v);var T=yT(u,m);_&&T&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==T.node||o.focusOffset!==T.offset)&&(l=l.createRange(),l.setStart(_.node,_.offset),o.removeAllRanges(),v>m?(o.addRange(l),o.extend(T.node,T.offset)):(l.setEnd(T.node,T.offset),o.addRange(l)))}}for(l=[],o=u;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)o=l[u],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var WO=c&&"documentMode"in document&&11>=document.documentMode,gc=null,q_=null,_h=null,G_=!1;function ET(o,l,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;G_||gc==null||gc!==mr(m)||(m=gc,"selectionStart"in m&&W_(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),_h&&gh(_h,m)||(_h=m,m=fp(q_,"onSelect"),0<m.length&&(l=new Fa("onSelect","select",null,l,u),o.push({event:l,listeners:m}),l.target=gc)))}function up(o,l){var u={};return u[o.toLowerCase()]=l.toLowerCase(),u["Webkit"+o]="webkit"+l,u["Moz"+o]="moz"+l,u}var _c={animationend:up("Animation","AnimationEnd"),animationiteration:up("Animation","AnimationIteration"),animationstart:up("Animation","AnimationStart"),transitionend:up("Transition","TransitionEnd")},K_={},IT={};c&&(IT=document.createElement("div").style,"AnimationEvent"in window||(delete _c.animationend.animation,delete _c.animationiteration.animation,delete _c.animationstart.animation),"TransitionEvent"in window||delete _c.transitionend.transition);function hp(o){if(K_[o])return K_[o];if(!_c[o])return o;var l=_c[o],u;for(u in l)if(l.hasOwnProperty(u)&&u in IT)return K_[o]=l[u];return o}var TT=hp("animationend"),xT=hp("animationiteration"),bT=hp("animationstart"),ST=hp("transitionend"),AT=new Map,NT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Eo(o,l){AT.set(o,l),i(l,[o])}for(var Q_=0;Q_<NT.length;Q_++){var Y_=NT[Q_],qO=Y_.toLowerCase(),GO=Y_[0].toUpperCase()+Y_.slice(1);Eo(qO,"on"+GO)}Eo(TT,"onAnimationEnd"),Eo(xT,"onAnimationIteration"),Eo(bT,"onAnimationStart"),Eo("dblclick","onDoubleClick"),Eo("focusin","onFocus"),Eo("focusout","onBlur"),Eo(ST,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KO=new Set("cancel close invalid load scroll toggle".split(" ").concat(yh));function CT(o,l,u){var m=o.type||"unknown-event";o.currentTarget=u,Yu(m,l,void 0,o),o.currentTarget=null}function kT(o,l){l=(l&4)!==0;for(var u=0;u<o.length;u++){var m=o[u],_=m.event;m=m.listeners;e:{var v=void 0;if(l)for(var T=m.length-1;0<=T;T--){var A=m[T],L=A.instance,q=A.currentTarget;if(A=A.listener,L!==v&&_.isPropagationStopped())break e;CT(_,A,q),v=L}else for(T=0;T<m.length;T++){if(A=m[T],L=A.instance,q=A.currentTarget,A=A.listener,L!==v&&_.isPropagationStopped())break e;CT(_,A,q),v=L}}}if(ec)throw o=Ur,ec=!1,Ur=null,o}function Tt(o,l){var u=l[sy];u===void 0&&(u=l[sy]=new Set);var m=o+"__bubble";u.has(m)||(RT(l,o,2,!1),u.add(m))}function J_(o,l,u){var m=0;l&&(m|=4),RT(u,o,m,l)}var dp="_reactListening"+Math.random().toString(36).slice(2);function vh(o){if(!o[dp]){o[dp]=!0,r.forEach(function(u){u!=="selectionchange"&&(KO.has(u)||J_(u,!1,o),J_(u,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[dp]||(l[dp]=!0,J_("selectionchange",!1,l))}}function RT(o,l,u,m){switch(lc(l)){case 1:var _=Ps;break;case 4:_=rp;break;default:_=ch}u=_.bind(null,l,u,o),_=void 0,!fo||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),m?_!==void 0?o.addEventListener(l,u,{capture:!0,passive:_}):o.addEventListener(l,u,!0):_!==void 0?o.addEventListener(l,u,{passive:_}):o.addEventListener(l,u,!1)}function X_(o,l,u,m,_){var v=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var T=m.tag;if(T===3||T===4){var A=m.stateNode.containerInfo;if(A===_||A.nodeType===8&&A.parentNode===_)break;if(T===4)for(T=m.return;T!==null;){var L=T.tag;if((L===3||L===4)&&(L=T.stateNode.containerInfo,L===_||L.nodeType===8&&L.parentNode===_))return;T=T.return}for(;A!==null;){if(T=Ba(A),T===null)return;if(L=T.tag,L===5||L===6){m=v=T;continue e}A=A.parentNode}}m=m.return}ho(function(){var q=v,re=co(u),oe=[];e:{var te=AT.get(o);if(te!==void 0){var _e=Fa,Ie=o;switch(o){case"keypress":if(ja(u)===0)break e;case"keydown":case"keyup":_e=ct;break;case"focusin":Ie="focus",_e=xn;break;case"focusout":Ie="blur",_e=xn;break;case"beforeblur":case"afterblur":_e=xn;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=hh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=op;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=Ms;break;case TT:case xT:case bT:_e=lp;break;case ST:_e=pc;break;case"scroll":_e=uc;break;case"wheel":_e=RO;break;case"copy":case"cut":case"paste":_e=d;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Tr}var be=(l&4)!==0,Gt=!be&&o==="scroll",B=be?te!==null?te+"Capture":null:te;be=[];for(var V=q,$;V!==null;){$=V;var le=$.stateNode;if($.tag===5&&le!==null&&($=le,B!==null&&(le=Na(V,B),le!=null&&be.push(wh(V,le,$)))),Gt)break;V=V.return}0<be.length&&(te=new _e(te,Ie,null,u,re),oe.push({event:te,listeners:be}))}}if((l&7)===0){e:{if(te=o==="mouseover"||o==="pointerover",_e=o==="mouseout"||o==="pointerout",te&&u!==xs&&(Ie=u.relatedTarget||u.fromElement)&&(Ba(Ie)||Ie[Si]))break e;if((_e||te)&&(te=re.window===re?re:(te=re.ownerDocument)?te.defaultView||te.parentWindow:window,_e?(Ie=u.relatedTarget||u.toElement,_e=q,Ie=Ie?Ba(Ie):null,Ie!==null&&(Gt=is(Ie),Ie!==Gt||Ie.tag!==5&&Ie.tag!==6)&&(Ie=null)):(_e=null,Ie=q),_e!==Ie)){if(be=hh,le="onMouseLeave",B="onMouseEnter",V="mouse",(o==="pointerout"||o==="pointerover")&&(be=Tr,le="onPointerLeave",B="onPointerEnter",V="pointer"),Gt=_e==null?te:wc(_e),$=Ie==null?te:wc(Ie),te=new be(le,V+"leave",_e,u,re),te.target=Gt,te.relatedTarget=$,le=null,Ba(re)===q&&(be=new be(B,V+"enter",Ie,u,re),be.target=$,be.relatedTarget=Gt,le=be),Gt=le,_e&&Ie)t:{for(be=_e,B=Ie,V=0,$=be;$;$=yc($))V++;for($=0,le=B;le;le=yc(le))$++;for(;0<V-$;)be=yc(be),V--;for(;0<$-V;)B=yc(B),$--;for(;V--;){if(be===B||B!==null&&be===B.alternate)break t;be=yc(be),B=yc(B)}be=null}else be=null;_e!==null&&PT(oe,te,_e,be,!1),Ie!==null&&Gt!==null&&PT(oe,Gt,Ie,be,!0)}}e:{if(te=q?wc(q):window,_e=te.nodeName&&te.nodeName.toLowerCase(),_e==="select"||_e==="input"&&te.type==="file")var Ce=jO;else if(hT(te))if(fT)Ce=zO;else{Ce=UO;var Re=FO}else(_e=te.nodeName)&&_e.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(Ce=BO);if(Ce&&(Ce=Ce(o,q))){dT(oe,Ce,u,re);break e}Re&&Re(o,te,q),o==="focusout"&&(Re=te._wrapperState)&&Re.controlled&&te.type==="number"&&Ot(te,"number",te.value)}switch(Re=q?wc(q):window,o){case"focusin":(hT(Re)||Re.contentEditable==="true")&&(gc=Re,q_=q,_h=null);break;case"focusout":_h=q_=gc=null;break;case"mousedown":G_=!0;break;case"contextmenu":case"mouseup":case"dragend":G_=!1,ET(oe,u,re);break;case"selectionchange":if(WO)break;case"keydown":case"keyup":ET(oe,u,re)}var Pe;if(z_)e:{switch(o){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else mc?cT(o,u)&&(Ve="onCompositionEnd"):o==="keydown"&&u.keyCode===229&&(Ve="onCompositionStart");Ve&&(oT&&u.locale!=="ko"&&(mc||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&mc&&(Pe=sp()):(Er=re,cc="value"in Er?Er.value:Er.textContent,mc=!0)),Re=fp(q,Ve),0<Re.length&&(Ve=new I(Ve,o,null,u,re),oe.push({event:Ve,listeners:Re}),Pe?Ve.data=Pe:(Pe=uT(u),Pe!==null&&(Ve.data=Pe)))),(Pe=DO?OO(o,u):LO(o,u))&&(q=fp(q,"onBeforeInput"),0<q.length&&(re=new I("onBeforeInput","beforeinput",null,u,re),oe.push({event:re,listeners:q}),re.data=Pe))}kT(oe,l)})}function wh(o,l,u){return{instance:o,listener:l,currentTarget:u}}function fp(o,l){for(var u=l+"Capture",m=[];o!==null;){var _=o,v=_.stateNode;_.tag===5&&v!==null&&(_=v,v=Na(o,u),v!=null&&m.unshift(wh(o,v,_)),v=Na(o,l),v!=null&&m.push(wh(o,v,_))),o=o.return}return m}function yc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function PT(o,l,u,m,_){for(var v=l._reactName,T=[];u!==null&&u!==m;){var A=u,L=A.alternate,q=A.stateNode;if(L!==null&&L===m)break;A.tag===5&&q!==null&&(A=q,_?(L=Na(u,v),L!=null&&T.unshift(wh(u,L,A))):_||(L=Na(u,v),L!=null&&T.push(wh(u,L,A)))),u=u.return}T.length!==0&&o.push({event:l,listeners:T})}var QO=/\r\n?/g,YO=/\u0000|\uFFFD/g;function DT(o){return(typeof o=="string"?o:""+o).replace(QO,`
`).replace(YO,"")}function pp(o,l,u){if(l=DT(l),DT(o)!==l&&u)throw Error(t(425))}function mp(){}var Z_=null,ey=null;function ty(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ny=typeof setTimeout=="function"?setTimeout:void 0,JO=typeof clearTimeout=="function"?clearTimeout:void 0,OT=typeof Promise=="function"?Promise:void 0,XO=typeof queueMicrotask=="function"?queueMicrotask:typeof OT<"u"?function(o){return OT.resolve(null).then(o).catch(ZO)}:ny;function ZO(o){setTimeout(function(){throw o})}function ry(o,l){var u=l,m=0;do{var _=u.nextSibling;if(o.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(m===0){o.removeChild(_),yo(l);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=_}while(u);yo(l)}function Io(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function LT(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var u=o.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return o;l--}else u==="/$"&&l++}o=o.previousSibling}return null}var vc=Math.random().toString(36).slice(2),js="__reactFiber$"+vc,Eh="__reactProps$"+vc,Si="__reactContainer$"+vc,sy="__reactEvents$"+vc,eL="__reactListeners$"+vc,tL="__reactHandles$"+vc;function Ba(o){var l=o[js];if(l)return l;for(var u=o.parentNode;u;){if(l=u[Si]||u[js]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(o=LT(o);o!==null;){if(u=o[js])return u;o=LT(o)}return l}o=u,u=o.parentNode}return null}function Ih(o){return o=o[js]||o[Si],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function wc(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function gp(o){return o[Eh]||null}var iy=[],Ec=-1;function To(o){return{current:o}}function xt(o){0>Ec||(o.current=iy[Ec],iy[Ec]=null,Ec--)}function gt(o,l){Ec++,iy[Ec]=o.current,o.current=l}var xo={},Dn=To(xo),er=To(!1),za=xo;function Ic(o,l){var u=o.type.contextTypes;if(!u)return xo;var m=o.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var _={},v;for(v in u)_[v]=l[v];return m&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=_),_}function tr(o){return o=o.childContextTypes,o!=null}function _p(){xt(er),xt(Dn)}function MT(o,l,u){if(Dn.current!==xo)throw Error(t(168));gt(Dn,l),gt(er,u)}function VT(o,l,u){var m=o.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var _ in m)if(!(_ in l))throw Error(t(108,fe(o)||"Unknown",_));return me({},u,m)}function yp(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||xo,za=Dn.current,gt(Dn,o),gt(er,er.current),!0}function jT(o,l,u){var m=o.stateNode;if(!m)throw Error(t(169));u?(o=VT(o,l,za),m.__reactInternalMemoizedMergedChildContext=o,xt(er),xt(Dn),gt(Dn,o)):xt(er),gt(er,u)}var Ai=null,vp=!1,oy=!1;function FT(o){Ai===null?Ai=[o]:Ai.push(o)}function nL(o){vp=!0,FT(o)}function bo(){if(!oy&&Ai!==null){oy=!0;var o=0,l=Je;try{var u=Ai;for(Je=1;o<u.length;o++){var m=u[o];do m=m(!0);while(m!==null)}Ai=null,vp=!1}catch(_){throw Ai!==null&&(Ai=Ai.slice(o+1)),Xu(nc,bo),_}finally{Je=l,oy=!1}}return null}var Tc=[],xc=0,wp=null,Ep=0,zr=[],$r=0,$a=null,Ni=1,Ci="";function Ha(o,l){Tc[xc++]=Ep,Tc[xc++]=wp,wp=o,Ep=l}function UT(o,l,u){zr[$r++]=Ni,zr[$r++]=Ci,zr[$r++]=$a,$a=o;var m=Ni;o=Ci;var _=32-vr(m)-1;m&=~(1<<_),u+=1;var v=32-vr(l)+_;if(30<v){var T=_-_%5;v=(m&(1<<T)-1).toString(32),m>>=T,_-=T,Ni=1<<32-vr(l)+_|u<<_|m,Ci=v+o}else Ni=1<<v|u<<_|m,Ci=o}function ay(o){o.return!==null&&(Ha(o,1),UT(o,1,0))}function ly(o){for(;o===wp;)wp=Tc[--xc],Tc[xc]=null,Ep=Tc[--xc],Tc[xc]=null;for(;o===$a;)$a=zr[--$r],zr[$r]=null,Ci=zr[--$r],zr[$r]=null,Ni=zr[--$r],zr[$r]=null}var xr=null,br=null,Ct=!1,ls=null;function BT(o,l){var u=Gr(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=o,l=o.deletions,l===null?(o.deletions=[u],o.flags|=16):l.push(u)}function zT(o,l){switch(o.tag){case 5:var u=o.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,xr=o,br=Io(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,xr=o,br=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=$a!==null?{id:Ni,overflow:Ci}:null,o.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=Gr(18,null,null,0),u.stateNode=l,u.return=o,o.child=u,xr=o,br=null,!0):!1;default:return!1}}function cy(o){return(o.mode&1)!==0&&(o.flags&128)===0}function uy(o){if(Ct){var l=br;if(l){var u=l;if(!zT(o,l)){if(cy(o))throw Error(t(418));l=Io(u.nextSibling);var m=xr;l&&zT(o,l)?BT(m,u):(o.flags=o.flags&-4097|2,Ct=!1,xr=o)}}else{if(cy(o))throw Error(t(418));o.flags=o.flags&-4097|2,Ct=!1,xr=o}}}function $T(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;xr=o}function Ip(o){if(o!==xr)return!1;if(!Ct)return $T(o),Ct=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!ty(o.type,o.memoizedProps)),l&&(l=br)){if(cy(o))throw HT(),Error(t(418));for(;l;)BT(o,l),l=Io(l.nextSibling)}if($T(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var u=o.data;if(u==="/$"){if(l===0){br=Io(o.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}o=o.nextSibling}br=null}}else br=xr?Io(o.stateNode.nextSibling):null;return!0}function HT(){for(var o=br;o;)o=Io(o.nextSibling)}function bc(){br=xr=null,Ct=!1}function hy(o){ls===null?ls=[o]:ls.push(o)}var rL=Y.ReactCurrentBatchConfig;function Th(o,l,u){if(o=u.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,o));var _=m,v=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===v?l.ref:(l=function(T){var A=_.refs;T===null?delete A[v]:A[v]=T},l._stringRef=v,l)}if(typeof o!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,o))}return o}function Tp(o,l){throw o=Object.prototype.toString.call(l),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function WT(o){var l=o._init;return l(o._payload)}function qT(o){function l(B,V){if(o){var $=B.deletions;$===null?(B.deletions=[V],B.flags|=16):$.push(V)}}function u(B,V){if(!o)return null;for(;V!==null;)l(B,V),V=V.sibling;return null}function m(B,V){for(B=new Map;V!==null;)V.key!==null?B.set(V.key,V):B.set(V.index,V),V=V.sibling;return B}function _(B,V){return B=Do(B,V),B.index=0,B.sibling=null,B}function v(B,V,$){return B.index=$,o?($=B.alternate,$!==null?($=$.index,$<V?(B.flags|=2,V):$):(B.flags|=2,V)):(B.flags|=1048576,V)}function T(B){return o&&B.alternate===null&&(B.flags|=2),B}function A(B,V,$,le){return V===null||V.tag!==6?(V=nv($,B.mode,le),V.return=B,V):(V=_(V,$),V.return=B,V)}function L(B,V,$,le){var Ce=$.type;return Ce===R?re(B,V,$.props.children,le,$.key):V!==null&&(V.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===Nt&&WT(Ce)===V.type)?(le=_(V,$.props),le.ref=Th(B,V,$),le.return=B,le):(le=Gp($.type,$.key,$.props,null,B.mode,le),le.ref=Th(B,V,$),le.return=B,le)}function q(B,V,$,le){return V===null||V.tag!==4||V.stateNode.containerInfo!==$.containerInfo||V.stateNode.implementation!==$.implementation?(V=rv($,B.mode,le),V.return=B,V):(V=_(V,$.children||[]),V.return=B,V)}function re(B,V,$,le,Ce){return V===null||V.tag!==7?(V=Xa($,B.mode,le,Ce),V.return=B,V):(V=_(V,$),V.return=B,V)}function oe(B,V,$){if(typeof V=="string"&&V!==""||typeof V=="number")return V=nv(""+V,B.mode,$),V.return=B,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case ue:return $=Gp(V.type,V.key,V.props,null,B.mode,$),$.ref=Th(B,null,V),$.return=B,$;case se:return V=rv(V,B.mode,$),V.return=B,V;case Nt:var le=V._init;return oe(B,le(V._payload),$)}if(Lt(V)||Se(V))return V=Xa(V,B.mode,$,null),V.return=B,V;Tp(B,V)}return null}function te(B,V,$,le){var Ce=V!==null?V.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return Ce!==null?null:A(B,V,""+$,le);if(typeof $=="object"&&$!==null){switch($.$$typeof){case ue:return $.key===Ce?L(B,V,$,le):null;case se:return $.key===Ce?q(B,V,$,le):null;case Nt:return Ce=$._init,te(B,V,Ce($._payload),le)}if(Lt($)||Se($))return Ce!==null?null:re(B,V,$,le,null);Tp(B,$)}return null}function _e(B,V,$,le,Ce){if(typeof le=="string"&&le!==""||typeof le=="number")return B=B.get($)||null,A(V,B,""+le,Ce);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case ue:return B=B.get(le.key===null?$:le.key)||null,L(V,B,le,Ce);case se:return B=B.get(le.key===null?$:le.key)||null,q(V,B,le,Ce);case Nt:var Re=le._init;return _e(B,V,$,Re(le._payload),Ce)}if(Lt(le)||Se(le))return B=B.get($)||null,re(V,B,le,Ce,null);Tp(V,le)}return null}function Ie(B,V,$,le){for(var Ce=null,Re=null,Pe=V,Ve=V=0,fn=null;Pe!==null&&Ve<$.length;Ve++){Pe.index>Ve?(fn=Pe,Pe=null):fn=Pe.sibling;var tt=te(B,Pe,$[Ve],le);if(tt===null){Pe===null&&(Pe=fn);break}o&&Pe&&tt.alternate===null&&l(B,Pe),V=v(tt,V,Ve),Re===null?Ce=tt:Re.sibling=tt,Re=tt,Pe=fn}if(Ve===$.length)return u(B,Pe),Ct&&Ha(B,Ve),Ce;if(Pe===null){for(;Ve<$.length;Ve++)Pe=oe(B,$[Ve],le),Pe!==null&&(V=v(Pe,V,Ve),Re===null?Ce=Pe:Re.sibling=Pe,Re=Pe);return Ct&&Ha(B,Ve),Ce}for(Pe=m(B,Pe);Ve<$.length;Ve++)fn=_e(Pe,B,Ve,$[Ve],le),fn!==null&&(o&&fn.alternate!==null&&Pe.delete(fn.key===null?Ve:fn.key),V=v(fn,V,Ve),Re===null?Ce=fn:Re.sibling=fn,Re=fn);return o&&Pe.forEach(function(Oo){return l(B,Oo)}),Ct&&Ha(B,Ve),Ce}function be(B,V,$,le){var Ce=Se($);if(typeof Ce!="function")throw Error(t(150));if($=Ce.call($),$==null)throw Error(t(151));for(var Re=Ce=null,Pe=V,Ve=V=0,fn=null,tt=$.next();Pe!==null&&!tt.done;Ve++,tt=$.next()){Pe.index>Ve?(fn=Pe,Pe=null):fn=Pe.sibling;var Oo=te(B,Pe,tt.value,le);if(Oo===null){Pe===null&&(Pe=fn);break}o&&Pe&&Oo.alternate===null&&l(B,Pe),V=v(Oo,V,Ve),Re===null?Ce=Oo:Re.sibling=Oo,Re=Oo,Pe=fn}if(tt.done)return u(B,Pe),Ct&&Ha(B,Ve),Ce;if(Pe===null){for(;!tt.done;Ve++,tt=$.next())tt=oe(B,tt.value,le),tt!==null&&(V=v(tt,V,Ve),Re===null?Ce=tt:Re.sibling=tt,Re=tt);return Ct&&Ha(B,Ve),Ce}for(Pe=m(B,Pe);!tt.done;Ve++,tt=$.next())tt=_e(Pe,B,Ve,tt.value,le),tt!==null&&(o&&tt.alternate!==null&&Pe.delete(tt.key===null?Ve:tt.key),V=v(tt,V,Ve),Re===null?Ce=tt:Re.sibling=tt,Re=tt);return o&&Pe.forEach(function(ML){return l(B,ML)}),Ct&&Ha(B,Ve),Ce}function Gt(B,V,$,le){if(typeof $=="object"&&$!==null&&$.type===R&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case ue:e:{for(var Ce=$.key,Re=V;Re!==null;){if(Re.key===Ce){if(Ce=$.type,Ce===R){if(Re.tag===7){u(B,Re.sibling),V=_(Re,$.props.children),V.return=B,B=V;break e}}else if(Re.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===Nt&&WT(Ce)===Re.type){u(B,Re.sibling),V=_(Re,$.props),V.ref=Th(B,Re,$),V.return=B,B=V;break e}u(B,Re);break}else l(B,Re);Re=Re.sibling}$.type===R?(V=Xa($.props.children,B.mode,le,$.key),V.return=B,B=V):(le=Gp($.type,$.key,$.props,null,B.mode,le),le.ref=Th(B,V,$),le.return=B,B=le)}return T(B);case se:e:{for(Re=$.key;V!==null;){if(V.key===Re)if(V.tag===4&&V.stateNode.containerInfo===$.containerInfo&&V.stateNode.implementation===$.implementation){u(B,V.sibling),V=_(V,$.children||[]),V.return=B,B=V;break e}else{u(B,V);break}else l(B,V);V=V.sibling}V=rv($,B.mode,le),V.return=B,B=V}return T(B);case Nt:return Re=$._init,Gt(B,V,Re($._payload),le)}if(Lt($))return Ie(B,V,$,le);if(Se($))return be(B,V,$,le);Tp(B,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,V!==null&&V.tag===6?(u(B,V.sibling),V=_(V,$),V.return=B,B=V):(u(B,V),V=nv($,B.mode,le),V.return=B,B=V),T(B)):u(B,V)}return Gt}var Sc=qT(!0),GT=qT(!1),xp=To(null),bp=null,Ac=null,dy=null;function fy(){dy=Ac=bp=null}function py(o){var l=xp.current;xt(xp),o._currentValue=l}function my(o,l,u){for(;o!==null;){var m=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),o===u)break;o=o.return}}function Nc(o,l){bp=o,dy=Ac=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(nr=!0),o.firstContext=null)}function Hr(o){var l=o._currentValue;if(dy!==o)if(o={context:o,memoizedValue:l,next:null},Ac===null){if(bp===null)throw Error(t(308));Ac=o,bp.dependencies={lanes:0,firstContext:o}}else Ac=Ac.next=o;return l}var Wa=null;function gy(o){Wa===null?Wa=[o]:Wa.push(o)}function KT(o,l,u,m){var _=l.interleaved;return _===null?(u.next=u,gy(l)):(u.next=_.next,_.next=u),l.interleaved=u,ki(o,m)}function ki(o,l){o.lanes|=l;var u=o.alternate;for(u!==null&&(u.lanes|=l),u=o,o=o.return;o!==null;)o.childLanes|=l,u=o.alternate,u!==null&&(u.childLanes|=l),u=o,o=o.return;return u.tag===3?u.stateNode:null}var So=!1;function _y(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QT(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ri(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function Ao(o,l,u){var m=o.updateQueue;if(m===null)return null;if(m=m.shared,(Ze&2)!==0){var _=m.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),m.pending=l,ki(o,u)}return _=m.interleaved,_===null?(l.next=l,gy(m)):(l.next=_.next,_.next=l),m.interleaved=l,ki(o,u)}function Sp(o,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var m=l.lanes;m&=o.pendingLanes,u|=m,l.lanes=u,sh(o,u)}}function YT(o,l){var u=o.updateQueue,m=o.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var _=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var T={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};v===null?_=v=T:v=v.next=T,u=u.next}while(u!==null);v===null?_=v=l:v=v.next=l}else _=v=l;u={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:m.shared,effects:m.effects},o.updateQueue=u;return}o=u.lastBaseUpdate,o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=l}function Ap(o,l,u,m){var _=o.updateQueue;So=!1;var v=_.firstBaseUpdate,T=_.lastBaseUpdate,A=_.shared.pending;if(A!==null){_.shared.pending=null;var L=A,q=L.next;L.next=null,T===null?v=q:T.next=q,T=L;var re=o.alternate;re!==null&&(re=re.updateQueue,A=re.lastBaseUpdate,A!==T&&(A===null?re.firstBaseUpdate=q:A.next=q,re.lastBaseUpdate=L))}if(v!==null){var oe=_.baseState;T=0,re=q=L=null,A=v;do{var te=A.lane,_e=A.eventTime;if((m&te)===te){re!==null&&(re=re.next={eventTime:_e,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var Ie=o,be=A;switch(te=l,_e=u,be.tag){case 1:if(Ie=be.payload,typeof Ie=="function"){oe=Ie.call(_e,oe,te);break e}oe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=be.payload,te=typeof Ie=="function"?Ie.call(_e,oe,te):Ie,te==null)break e;oe=me({},oe,te);break e;case 2:So=!0}}A.callback!==null&&A.lane!==0&&(o.flags|=64,te=_.effects,te===null?_.effects=[A]:te.push(A))}else _e={eventTime:_e,lane:te,tag:A.tag,payload:A.payload,callback:A.callback,next:null},re===null?(q=re=_e,L=oe):re=re.next=_e,T|=te;if(A=A.next,A===null){if(A=_.shared.pending,A===null)break;te=A,A=te.next,te.next=null,_.lastBaseUpdate=te,_.shared.pending=null}}while(!0);if(re===null&&(L=oe),_.baseState=L,_.firstBaseUpdate=q,_.lastBaseUpdate=re,l=_.shared.interleaved,l!==null){_=l;do T|=_.lane,_=_.next;while(_!==l)}else v===null&&(_.shared.lanes=0);Ka|=T,o.lanes=T,o.memoizedState=oe}}function JT(o,l,u){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var m=o[l],_=m.callback;if(_!==null){if(m.callback=null,m=u,typeof _!="function")throw Error(t(191,_));_.call(m)}}}var xh={},Fs=To(xh),bh=To(xh),Sh=To(xh);function qa(o){if(o===xh)throw Error(t(174));return o}function yy(o,l){switch(gt(Sh,l),gt(bh,o),gt(Fs,xh),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:mi(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=mi(l,o)}xt(Fs),gt(Fs,l)}function Cc(){xt(Fs),xt(bh),xt(Sh)}function XT(o){qa(Sh.current);var l=qa(Fs.current),u=mi(l,o.type);l!==u&&(gt(bh,o),gt(Fs,u))}function vy(o){bh.current===o&&(xt(Fs),xt(bh))}var Mt=To(0);function Np(o){for(var l=o;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var wy=[];function Ey(){for(var o=0;o<wy.length;o++)wy[o]._workInProgressVersionPrimary=null;wy.length=0}var Cp=Y.ReactCurrentDispatcher,Iy=Y.ReactCurrentBatchConfig,Ga=0,Vt=null,sn=null,hn=null,kp=!1,Ah=!1,Nh=0,sL=0;function On(){throw Error(t(321))}function Ty(o,l){if(l===null)return!1;for(var u=0;u<l.length&&u<o.length;u++)if(!as(o[u],l[u]))return!1;return!0}function xy(o,l,u,m,_,v){if(Ga=v,Vt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Cp.current=o===null||o.memoizedState===null?lL:cL,o=u(m,_),Ah){v=0;do{if(Ah=!1,Nh=0,25<=v)throw Error(t(301));v+=1,hn=sn=null,l.updateQueue=null,Cp.current=uL,o=u(m,_)}while(Ah)}if(Cp.current=Dp,l=sn!==null&&sn.next!==null,Ga=0,hn=sn=Vt=null,kp=!1,l)throw Error(t(300));return o}function by(){var o=Nh!==0;return Nh=0,o}function Us(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Vt.memoizedState=hn=o:hn=hn.next=o,hn}function Wr(){if(sn===null){var o=Vt.alternate;o=o!==null?o.memoizedState:null}else o=sn.next;var l=hn===null?Vt.memoizedState:hn.next;if(l!==null)hn=l,sn=o;else{if(o===null)throw Error(t(310));sn=o,o={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},hn===null?Vt.memoizedState=hn=o:hn=hn.next=o}return hn}function Ch(o,l){return typeof l=="function"?l(o):l}function Sy(o){var l=Wr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=o;var m=sn,_=m.baseQueue,v=u.pending;if(v!==null){if(_!==null){var T=_.next;_.next=v.next,v.next=T}m.baseQueue=_=v,u.pending=null}if(_!==null){v=_.next,m=m.baseState;var A=T=null,L=null,q=v;do{var re=q.lane;if((Ga&re)===re)L!==null&&(L=L.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),m=q.hasEagerState?q.eagerState:o(m,q.action);else{var oe={lane:re,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};L===null?(A=L=oe,T=m):L=L.next=oe,Vt.lanes|=re,Ka|=re}q=q.next}while(q!==null&&q!==v);L===null?T=m:L.next=A,as(m,l.memoizedState)||(nr=!0),l.memoizedState=m,l.baseState=T,l.baseQueue=L,u.lastRenderedState=m}if(o=u.interleaved,o!==null){_=o;do v=_.lane,Vt.lanes|=v,Ka|=v,_=_.next;while(_!==o)}else _===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function Ay(o){var l=Wr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=o;var m=u.dispatch,_=u.pending,v=l.memoizedState;if(_!==null){u.pending=null;var T=_=_.next;do v=o(v,T.action),T=T.next;while(T!==_);as(v,l.memoizedState)||(nr=!0),l.memoizedState=v,l.baseQueue===null&&(l.baseState=v),u.lastRenderedState=v}return[v,m]}function ZT(){}function ex(o,l){var u=Vt,m=Wr(),_=l(),v=!as(m.memoizedState,_);if(v&&(m.memoizedState=_,nr=!0),m=m.queue,Ny(rx.bind(null,u,m,o),[o]),m.getSnapshot!==l||v||hn!==null&&hn.memoizedState.tag&1){if(u.flags|=2048,kh(9,nx.bind(null,u,m,_,l),void 0,null),dn===null)throw Error(t(349));(Ga&30)!==0||tx(u,l,_)}return _}function tx(o,l,u){o.flags|=16384,o={getSnapshot:l,value:u},l=Vt.updateQueue,l===null?(l={lastEffect:null,stores:null},Vt.updateQueue=l,l.stores=[o]):(u=l.stores,u===null?l.stores=[o]:u.push(o))}function nx(o,l,u,m){l.value=u,l.getSnapshot=m,sx(l)&&ix(o)}function rx(o,l,u){return u(function(){sx(l)&&ix(o)})}function sx(o){var l=o.getSnapshot;o=o.value;try{var u=l();return!as(o,u)}catch{return!0}}function ix(o){var l=ki(o,1);l!==null&&ds(l,o,1,-1)}function ox(o){var l=Us();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ch,lastRenderedState:o},l.queue=o,o=o.dispatch=aL.bind(null,Vt,o),[l.memoizedState,o]}function kh(o,l,u,m){return o={tag:o,create:l,destroy:u,deps:m,next:null},l=Vt.updateQueue,l===null?(l={lastEffect:null,stores:null},Vt.updateQueue=l,l.lastEffect=o.next=o):(u=l.lastEffect,u===null?l.lastEffect=o.next=o:(m=u.next,u.next=o,o.next=m,l.lastEffect=o)),o}function ax(){return Wr().memoizedState}function Rp(o,l,u,m){var _=Us();Vt.flags|=o,_.memoizedState=kh(1|l,u,void 0,m===void 0?null:m)}function Pp(o,l,u,m){var _=Wr();m=m===void 0?null:m;var v=void 0;if(sn!==null){var T=sn.memoizedState;if(v=T.destroy,m!==null&&Ty(m,T.deps)){_.memoizedState=kh(l,u,v,m);return}}Vt.flags|=o,_.memoizedState=kh(1|l,u,v,m)}function lx(o,l){return Rp(8390656,8,o,l)}function Ny(o,l){return Pp(2048,8,o,l)}function cx(o,l){return Pp(4,2,o,l)}function ux(o,l){return Pp(4,4,o,l)}function hx(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function dx(o,l,u){return u=u!=null?u.concat([o]):null,Pp(4,4,hx.bind(null,l,o),u)}function Cy(){}function fx(o,l){var u=Wr();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&Ty(l,m[1])?m[0]:(u.memoizedState=[o,l],o)}function px(o,l){var u=Wr();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&Ty(l,m[1])?m[0]:(o=o(),u.memoizedState=[o,l],o)}function mx(o,l,u){return(Ga&21)===0?(o.baseState&&(o.baseState=!1,nr=!0),o.memoizedState=u):(as(u,l)||(u=nh(),Vt.lanes|=u,Ka|=u,o.baseState=!0),l)}function iL(o,l){var u=Je;Je=u!==0&&4>u?u:4,o(!0);var m=Iy.transition;Iy.transition={};try{o(!1),l()}finally{Je=u,Iy.transition=m}}function gx(){return Wr().memoizedState}function oL(o,l,u){var m=Ro(o);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},_x(o))yx(l,u);else if(u=KT(o,l,u,m),u!==null){var _=Wn();ds(u,o,m,_),vx(u,l,m)}}function aL(o,l,u){var m=Ro(o),_={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(_x(o))yx(l,_);else{var v=o.alternate;if(o.lanes===0&&(v===null||v.lanes===0)&&(v=l.lastRenderedReducer,v!==null))try{var T=l.lastRenderedState,A=v(T,u);if(_.hasEagerState=!0,_.eagerState=A,as(A,T)){var L=l.interleaved;L===null?(_.next=_,gy(l)):(_.next=L.next,L.next=_),l.interleaved=_;return}}catch{}finally{}u=KT(o,l,_,m),u!==null&&(_=Wn(),ds(u,o,m,_),vx(u,l,m))}}function _x(o){var l=o.alternate;return o===Vt||l!==null&&l===Vt}function yx(o,l){Ah=kp=!0;var u=o.pending;u===null?l.next=l:(l.next=u.next,u.next=l),o.pending=l}function vx(o,l,u){if((u&4194240)!==0){var m=l.lanes;m&=o.pendingLanes,u|=m,l.lanes=u,sh(o,u)}}var Dp={readContext:Hr,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},lL={readContext:Hr,useCallback:function(o,l){return Us().memoizedState=[o,l===void 0?null:l],o},useContext:Hr,useEffect:lx,useImperativeHandle:function(o,l,u){return u=u!=null?u.concat([o]):null,Rp(4194308,4,hx.bind(null,l,o),u)},useLayoutEffect:function(o,l){return Rp(4194308,4,o,l)},useInsertionEffect:function(o,l){return Rp(4,2,o,l)},useMemo:function(o,l){var u=Us();return l=l===void 0?null:l,o=o(),u.memoizedState=[o,l],o},useReducer:function(o,l,u){var m=Us();return l=u!==void 0?u(l):l,m.memoizedState=m.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},m.queue=o,o=o.dispatch=oL.bind(null,Vt,o),[m.memoizedState,o]},useRef:function(o){var l=Us();return o={current:o},l.memoizedState=o},useState:ox,useDebugValue:Cy,useDeferredValue:function(o){return Us().memoizedState=o},useTransition:function(){var o=ox(!1),l=o[0];return o=iL.bind(null,o[1]),Us().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,u){var m=Vt,_=Us();if(Ct){if(u===void 0)throw Error(t(407));u=u()}else{if(u=l(),dn===null)throw Error(t(349));(Ga&30)!==0||tx(m,l,u)}_.memoizedState=u;var v={value:u,getSnapshot:l};return _.queue=v,lx(rx.bind(null,m,v,o),[o]),m.flags|=2048,kh(9,nx.bind(null,m,v,u,l),void 0,null),u},useId:function(){var o=Us(),l=dn.identifierPrefix;if(Ct){var u=Ci,m=Ni;u=(m&~(1<<32-vr(m)-1)).toString(32)+u,l=":"+l+"R"+u,u=Nh++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=sL++,l=":"+l+"r"+u.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},cL={readContext:Hr,useCallback:fx,useContext:Hr,useEffect:Ny,useImperativeHandle:dx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:px,useReducer:Sy,useRef:ax,useState:function(){return Sy(Ch)},useDebugValue:Cy,useDeferredValue:function(o){var l=Wr();return mx(l,sn.memoizedState,o)},useTransition:function(){var o=Sy(Ch)[0],l=Wr().memoizedState;return[o,l]},useMutableSource:ZT,useSyncExternalStore:ex,useId:gx,unstable_isNewReconciler:!1},uL={readContext:Hr,useCallback:fx,useContext:Hr,useEffect:Ny,useImperativeHandle:dx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:px,useReducer:Ay,useRef:ax,useState:function(){return Ay(Ch)},useDebugValue:Cy,useDeferredValue:function(o){var l=Wr();return sn===null?l.memoizedState=o:mx(l,sn.memoizedState,o)},useTransition:function(){var o=Ay(Ch)[0],l=Wr().memoizedState;return[o,l]},useMutableSource:ZT,useSyncExternalStore:ex,useId:gx,unstable_isNewReconciler:!1};function cs(o,l){if(o&&o.defaultProps){l=me({},l),o=o.defaultProps;for(var u in o)l[u]===void 0&&(l[u]=o[u]);return l}return l}function ky(o,l,u,m){l=o.memoizedState,u=u(m,l),u=u==null?l:me({},l,u),o.memoizedState=u,o.lanes===0&&(o.updateQueue.baseState=u)}var Op={isMounted:function(o){return(o=o._reactInternals)?is(o)===o:!1},enqueueSetState:function(o,l,u){o=o._reactInternals;var m=Wn(),_=Ro(o),v=Ri(m,_);v.payload=l,u!=null&&(v.callback=u),l=Ao(o,v,_),l!==null&&(ds(l,o,_,m),Sp(l,o,_))},enqueueReplaceState:function(o,l,u){o=o._reactInternals;var m=Wn(),_=Ro(o),v=Ri(m,_);v.tag=1,v.payload=l,u!=null&&(v.callback=u),l=Ao(o,v,_),l!==null&&(ds(l,o,_,m),Sp(l,o,_))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var u=Wn(),m=Ro(o),_=Ri(u,m);_.tag=2,l!=null&&(_.callback=l),l=Ao(o,_,m),l!==null&&(ds(l,o,m,u),Sp(l,o,m))}};function wx(o,l,u,m,_,v,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(m,v,T):l.prototype&&l.prototype.isPureReactComponent?!gh(u,m)||!gh(_,v):!0}function Ex(o,l,u){var m=!1,_=xo,v=l.contextType;return typeof v=="object"&&v!==null?v=Hr(v):(_=tr(l)?za:Dn.current,m=l.contextTypes,v=(m=m!=null)?Ic(o,_):xo),l=new l(u,v),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Op,o.stateNode=l,l._reactInternals=o,m&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=v),l}function Ix(o,l,u,m){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,m),l.state!==o&&Op.enqueueReplaceState(l,l.state,null)}function Ry(o,l,u,m){var _=o.stateNode;_.props=u,_.state=o.memoizedState,_.refs={},_y(o);var v=l.contextType;typeof v=="object"&&v!==null?_.context=Hr(v):(v=tr(l)?za:Dn.current,_.context=Ic(o,v)),_.state=o.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(ky(o,l,v,u),_.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(l=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),l!==_.state&&Op.enqueueReplaceState(_,_.state,null),Ap(o,u,_,m),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function kc(o,l){try{var u="",m=l;do u+=Ae(m),m=m.return;while(m);var _=u}catch(v){_=`
Error generating stack: `+v.message+`
`+v.stack}return{value:o,source:l,stack:_,digest:null}}function Py(o,l,u){return{value:o,source:null,stack:u??null,digest:l??null}}function Dy(o,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var hL=typeof WeakMap=="function"?WeakMap:Map;function Tx(o,l,u){u=Ri(-1,u),u.tag=3,u.payload={element:null};var m=l.value;return u.callback=function(){Bp||(Bp=!0,Ky=m),Dy(o,l)},u}function xx(o,l,u){u=Ri(-1,u),u.tag=3;var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var _=l.value;u.payload=function(){return m(_)},u.callback=function(){Dy(o,l)}}var v=o.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(u.callback=function(){Dy(o,l),typeof m!="function"&&(Co===null?Co=new Set([this]):Co.add(this));var T=l.stack;this.componentDidCatch(l.value,{componentStack:T!==null?T:""})}),u}function bx(o,l,u){var m=o.pingCache;if(m===null){m=o.pingCache=new hL;var _=new Set;m.set(l,_)}else _=m.get(l),_===void 0&&(_=new Set,m.set(l,_));_.has(u)||(_.add(u),o=bL.bind(null,o,l,u),l.then(o,o))}function Sx(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function Ax(o,l,u,m,_){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=Ri(-1,1),l.tag=2,Ao(u,l,1))),u.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var dL=Y.ReactCurrentOwner,nr=!1;function Hn(o,l,u,m){l.child=o===null?GT(l,null,u,m):Sc(l,o.child,u,m)}function Nx(o,l,u,m,_){u=u.render;var v=l.ref;return Nc(l,_),m=xy(o,l,u,m,v,_),u=by(),o!==null&&!nr?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~_,Pi(o,l,_)):(Ct&&u&&ay(l),l.flags|=1,Hn(o,l,m,_),l.child)}function Cx(o,l,u,m,_){if(o===null){var v=u.type;return typeof v=="function"&&!tv(v)&&v.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=v,kx(o,l,v,m,_)):(o=Gp(u.type,null,m,l,l.mode,_),o.ref=l.ref,o.return=l,l.child=o)}if(v=o.child,(o.lanes&_)===0){var T=v.memoizedProps;if(u=u.compare,u=u!==null?u:gh,u(T,m)&&o.ref===l.ref)return Pi(o,l,_)}return l.flags|=1,o=Do(v,m),o.ref=l.ref,o.return=l,l.child=o}function kx(o,l,u,m,_){if(o!==null){var v=o.memoizedProps;if(gh(v,m)&&o.ref===l.ref)if(nr=!1,l.pendingProps=m=v,(o.lanes&_)!==0)(o.flags&131072)!==0&&(nr=!0);else return l.lanes=o.lanes,Pi(o,l,_)}return Oy(o,l,u,m,_)}function Rx(o,l,u){var m=l.pendingProps,_=m.children,v=o!==null?o.memoizedState:null;if(m.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(Pc,Sr),Sr|=u;else{if((u&1073741824)===0)return o=v!==null?v.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,gt(Pc,Sr),Sr|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=v!==null?v.baseLanes:u,gt(Pc,Sr),Sr|=m}else v!==null?(m=v.baseLanes|u,l.memoizedState=null):m=u,gt(Pc,Sr),Sr|=m;return Hn(o,l,_,u),l.child}function Px(o,l){var u=l.ref;(o===null&&u!==null||o!==null&&o.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function Oy(o,l,u,m,_){var v=tr(u)?za:Dn.current;return v=Ic(l,v),Nc(l,_),u=xy(o,l,u,m,v,_),m=by(),o!==null&&!nr?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~_,Pi(o,l,_)):(Ct&&m&&ay(l),l.flags|=1,Hn(o,l,u,_),l.child)}function Dx(o,l,u,m,_){if(tr(u)){var v=!0;yp(l)}else v=!1;if(Nc(l,_),l.stateNode===null)Mp(o,l),Ex(l,u,m),Ry(l,u,m,_),m=!0;else if(o===null){var T=l.stateNode,A=l.memoizedProps;T.props=A;var L=T.context,q=u.contextType;typeof q=="object"&&q!==null?q=Hr(q):(q=tr(u)?za:Dn.current,q=Ic(l,q));var re=u.getDerivedStateFromProps,oe=typeof re=="function"||typeof T.getSnapshotBeforeUpdate=="function";oe||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==m||L!==q)&&Ix(l,T,m,q),So=!1;var te=l.memoizedState;T.state=te,Ap(l,m,T,_),L=l.memoizedState,A!==m||te!==L||er.current||So?(typeof re=="function"&&(ky(l,u,re,m),L=l.memoizedState),(A=So||wx(l,u,A,m,te,L,q))?(oe||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(l.flags|=4194308)):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=L),T.props=m,T.state=L,T.context=q,m=A):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{T=l.stateNode,QT(o,l),A=l.memoizedProps,q=l.type===l.elementType?A:cs(l.type,A),T.props=q,oe=l.pendingProps,te=T.context,L=u.contextType,typeof L=="object"&&L!==null?L=Hr(L):(L=tr(u)?za:Dn.current,L=Ic(l,L));var _e=u.getDerivedStateFromProps;(re=typeof _e=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==oe||te!==L)&&Ix(l,T,m,L),So=!1,te=l.memoizedState,T.state=te,Ap(l,m,T,_);var Ie=l.memoizedState;A!==oe||te!==Ie||er.current||So?(typeof _e=="function"&&(ky(l,u,_e,m),Ie=l.memoizedState),(q=So||wx(l,u,q,m,te,Ie,L)||!1)?(re||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,Ie,L),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,Ie,L)),typeof T.componentDidUpdate=="function"&&(l.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Ie),T.props=m,T.state=Ie,T.context=L,m=q):(typeof T.componentDidUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(l.flags|=1024),m=!1)}return Ly(o,l,u,m,v,_)}function Ly(o,l,u,m,_,v){Px(o,l);var T=(l.flags&128)!==0;if(!m&&!T)return _&&jT(l,u,!1),Pi(o,l,v);m=l.stateNode,dL.current=l;var A=T&&typeof u.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,o!==null&&T?(l.child=Sc(l,o.child,null,v),l.child=Sc(l,null,A,v)):Hn(o,l,A,v),l.memoizedState=m.state,_&&jT(l,u,!0),l.child}function Ox(o){var l=o.stateNode;l.pendingContext?MT(o,l.pendingContext,l.pendingContext!==l.context):l.context&&MT(o,l.context,!1),yy(o,l.containerInfo)}function Lx(o,l,u,m,_){return bc(),hy(_),l.flags|=256,Hn(o,l,u,m),l.child}var My={dehydrated:null,treeContext:null,retryLane:0};function Vy(o){return{baseLanes:o,cachePool:null,transitions:null}}function Mx(o,l,u){var m=l.pendingProps,_=Mt.current,v=!1,T=(l.flags&128)!==0,A;if((A=T)||(A=o!==null&&o.memoizedState===null?!1:(_&2)!==0),A?(v=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),gt(Mt,_&1),o===null)return uy(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(T=m.children,o=m.fallback,v?(m=l.mode,v=l.child,T={mode:"hidden",children:T},(m&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=T):v=Kp(T,m,0,null),o=Xa(o,m,u,null),v.return=l,o.return=l,v.sibling=o,l.child=v,l.child.memoizedState=Vy(u),l.memoizedState=My,o):jy(l,T));if(_=o.memoizedState,_!==null&&(A=_.dehydrated,A!==null))return fL(o,l,T,m,A,_,u);if(v){v=m.fallback,T=l.mode,_=o.child,A=_.sibling;var L={mode:"hidden",children:m.children};return(T&1)===0&&l.child!==_?(m=l.child,m.childLanes=0,m.pendingProps=L,l.deletions=null):(m=Do(_,L),m.subtreeFlags=_.subtreeFlags&14680064),A!==null?v=Do(A,v):(v=Xa(v,T,u,null),v.flags|=2),v.return=l,m.return=l,m.sibling=v,l.child=m,m=v,v=l.child,T=o.child.memoizedState,T=T===null?Vy(u):{baseLanes:T.baseLanes|u,cachePool:null,transitions:T.transitions},v.memoizedState=T,v.childLanes=o.childLanes&~u,l.memoizedState=My,m}return v=o.child,o=v.sibling,m=Do(v,{mode:"visible",children:m.children}),(l.mode&1)===0&&(m.lanes=u),m.return=l,m.sibling=null,o!==null&&(u=l.deletions,u===null?(l.deletions=[o],l.flags|=16):u.push(o)),l.child=m,l.memoizedState=null,m}function jy(o,l){return l=Kp({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function Lp(o,l,u,m){return m!==null&&hy(m),Sc(l,o.child,null,u),o=jy(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function fL(o,l,u,m,_,v,T){if(u)return l.flags&256?(l.flags&=-257,m=Py(Error(t(422))),Lp(o,l,T,m)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(v=m.fallback,_=l.mode,m=Kp({mode:"visible",children:m.children},_,0,null),v=Xa(v,_,T,null),v.flags|=2,m.return=l,v.return=l,m.sibling=v,l.child=m,(l.mode&1)!==0&&Sc(l,o.child,null,T),l.child.memoizedState=Vy(T),l.memoizedState=My,v);if((l.mode&1)===0)return Lp(o,l,T,null);if(_.data==="$!"){if(m=_.nextSibling&&_.nextSibling.dataset,m)var A=m.dgst;return m=A,v=Error(t(419)),m=Py(v,m,void 0),Lp(o,l,T,m)}if(A=(T&o.childLanes)!==0,nr||A){if(m=dn,m!==null){switch(T&-T){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(m.suspendedLanes|T))!==0?0:_,_!==0&&_!==v.retryLane&&(v.retryLane=_,ki(o,_),ds(m,o,_,-1))}return ev(),m=Py(Error(t(421))),Lp(o,l,T,m)}return _.data==="$?"?(l.flags|=128,l.child=o.child,l=SL.bind(null,o),_._reactRetry=l,null):(o=v.treeContext,br=Io(_.nextSibling),xr=l,Ct=!0,ls=null,o!==null&&(zr[$r++]=Ni,zr[$r++]=Ci,zr[$r++]=$a,Ni=o.id,Ci=o.overflow,$a=l),l=jy(l,m.children),l.flags|=4096,l)}function Vx(o,l,u){o.lanes|=l;var m=o.alternate;m!==null&&(m.lanes|=l),my(o.return,l,u)}function Fy(o,l,u,m,_){var v=o.memoizedState;v===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:_}:(v.isBackwards=l,v.rendering=null,v.renderingStartTime=0,v.last=m,v.tail=u,v.tailMode=_)}function jx(o,l,u){var m=l.pendingProps,_=m.revealOrder,v=m.tail;if(Hn(o,l,m.children,u),m=Mt.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Vx(o,u,l);else if(o.tag===19)Vx(o,u,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}m&=1}if(gt(Mt,m),(l.mode&1)===0)l.memoizedState=null;else switch(_){case"forwards":for(u=l.child,_=null;u!==null;)o=u.alternate,o!==null&&Np(o)===null&&(_=u),u=u.sibling;u=_,u===null?(_=l.child,l.child=null):(_=u.sibling,u.sibling=null),Fy(l,!1,_,u,v);break;case"backwards":for(u=null,_=l.child,l.child=null;_!==null;){if(o=_.alternate,o!==null&&Np(o)===null){l.child=_;break}o=_.sibling,_.sibling=u,u=_,_=o}Fy(l,!0,u,null,v);break;case"together":Fy(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Mp(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function Pi(o,l,u){if(o!==null&&(l.dependencies=o.dependencies),Ka|=l.lanes,(u&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(t(153));if(l.child!==null){for(o=l.child,u=Do(o,o.pendingProps),l.child=u,u.return=l;o.sibling!==null;)o=o.sibling,u=u.sibling=Do(o,o.pendingProps),u.return=l;u.sibling=null}return l.child}function pL(o,l,u){switch(l.tag){case 3:Ox(l),bc();break;case 5:XT(l);break;case 1:tr(l.type)&&yp(l);break;case 4:yy(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,_=l.memoizedProps.value;gt(xp,m._currentValue),m._currentValue=_;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(gt(Mt,Mt.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?Mx(o,l,u):(gt(Mt,Mt.current&1),o=Pi(o,l,u),o!==null?o.sibling:null);gt(Mt,Mt.current&1);break;case 19:if(m=(u&l.childLanes)!==0,(o.flags&128)!==0){if(m)return jx(o,l,u);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),gt(Mt,Mt.current),m)break;return null;case 22:case 23:return l.lanes=0,Rx(o,l,u)}return Pi(o,l,u)}var Fx,Uy,Ux,Bx;Fx=function(o,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)o.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},Uy=function(){},Ux=function(o,l,u,m){var _=o.memoizedProps;if(_!==m){o=l.stateNode,qa(Fs.current);var v=null;switch(u){case"input":_=Is(o,_),m=Is(o,m),v=[];break;case"select":_=me({},_,{value:void 0}),m=me({},m,{value:void 0}),v=[];break;case"textarea":_=io(o,_),m=io(o,m),v=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(o.onclick=mp)}gr(u,m);var T;u=null;for(q in _)if(!m.hasOwnProperty(q)&&_.hasOwnProperty(q)&&_[q]!=null)if(q==="style"){var A=_[q];for(T in A)A.hasOwnProperty(T)&&(u||(u={}),u[T]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(s.hasOwnProperty(q)?v||(v=[]):(v=v||[]).push(q,null));for(q in m){var L=m[q];if(A=_!=null?_[q]:void 0,m.hasOwnProperty(q)&&L!==A&&(L!=null||A!=null))if(q==="style")if(A){for(T in A)!A.hasOwnProperty(T)||L&&L.hasOwnProperty(T)||(u||(u={}),u[T]="");for(T in L)L.hasOwnProperty(T)&&A[T]!==L[T]&&(u||(u={}),u[T]=L[T])}else u||(v||(v=[]),v.push(q,u)),u=L;else q==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,A=A?A.__html:void 0,L!=null&&A!==L&&(v=v||[]).push(q,L)):q==="children"?typeof L!="string"&&typeof L!="number"||(v=v||[]).push(q,""+L):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(s.hasOwnProperty(q)?(L!=null&&q==="onScroll"&&Tt("scroll",o),v||A===L||(v=[])):(v=v||[]).push(q,L))}u&&(v=v||[]).push("style",u);var q=v;(l.updateQueue=q)&&(l.flags|=4)}},Bx=function(o,l,u,m){u!==m&&(l.flags|=4)};function Rh(o,l){if(!Ct)switch(o.tailMode){case"hidden":l=o.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?o.tail=null:u.sibling=null;break;case"collapsed":u=o.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:m.sibling=null}}function Ln(o){var l=o.alternate!==null&&o.alternate.child===o.child,u=0,m=0;if(l)for(var _=o.child;_!==null;)u|=_.lanes|_.childLanes,m|=_.subtreeFlags&14680064,m|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)u|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=m,o.childLanes=u,l}function mL(o,l,u){var m=l.pendingProps;switch(ly(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(l),null;case 1:return tr(l.type)&&_p(),Ln(l),null;case 3:return m=l.stateNode,Cc(),xt(er),xt(Dn),Ey(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(o===null||o.child===null)&&(Ip(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ls!==null&&(Jy(ls),ls=null))),Uy(o,l),Ln(l),null;case 5:vy(l);var _=qa(Sh.current);if(u=l.type,o!==null&&l.stateNode!=null)Ux(o,l,u,m,_),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(t(166));return Ln(l),null}if(o=qa(Fs.current),Ip(l)){m=l.stateNode,u=l.type;var v=l.memoizedProps;switch(m[js]=l,m[Eh]=v,o=(l.mode&1)!==0,u){case"dialog":Tt("cancel",m),Tt("close",m);break;case"iframe":case"object":case"embed":Tt("load",m);break;case"video":case"audio":for(_=0;_<yh.length;_++)Tt(yh[_],m);break;case"source":Tt("error",m);break;case"img":case"image":case"link":Tt("error",m),Tt("load",m);break;case"details":Tt("toggle",m);break;case"input":di(m,v),Tt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!v.multiple},Tt("invalid",m);break;case"textarea":oo(m,v),Tt("invalid",m)}gr(u,v),_=null;for(var T in v)if(v.hasOwnProperty(T)){var A=v[T];T==="children"?typeof A=="string"?m.textContent!==A&&(v.suppressHydrationWarning!==!0&&pp(m.textContent,A,o),_=["children",A]):typeof A=="number"&&m.textContent!==""+A&&(v.suppressHydrationWarning!==!0&&pp(m.textContent,A,o),_=["children",""+A]):s.hasOwnProperty(T)&&A!=null&&T==="onScroll"&&Tt("scroll",m)}switch(u){case"input":it(m),pi(m,v,!0);break;case"textarea":it(m),ts(m);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(m.onclick=mp)}m=_,l.updateQueue=m,m!==null&&(l.flags|=4)}else{T=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=ao(u)),o==="http://www.w3.org/1999/xhtml"?u==="script"?(o=T.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof m.is=="string"?o=T.createElement(u,{is:m.is}):(o=T.createElement(u),u==="select"&&(T=o,m.multiple?T.multiple=!0:m.size&&(T.size=m.size))):o=T.createElementNS(o,u),o[js]=l,o[Eh]=m,Fx(o,l,!1,!1),l.stateNode=o;e:{switch(T=_i(u,m),u){case"dialog":Tt("cancel",o),Tt("close",o),_=m;break;case"iframe":case"object":case"embed":Tt("load",o),_=m;break;case"video":case"audio":for(_=0;_<yh.length;_++)Tt(yh[_],o);_=m;break;case"source":Tt("error",o),_=m;break;case"img":case"image":case"link":Tt("error",o),Tt("load",o),_=m;break;case"details":Tt("toggle",o),_=m;break;case"input":di(o,m),_=Is(o,m),Tt("invalid",o);break;case"option":_=m;break;case"select":o._wrapperState={wasMultiple:!!m.multiple},_=me({},m,{value:void 0}),Tt("invalid",o);break;case"textarea":oo(o,m),_=io(o,m),Tt("invalid",o);break;default:_=m}gr(u,_),A=_;for(v in A)if(A.hasOwnProperty(v)){var L=A[v];v==="style"?lo(o,L):v==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&Sa(o,L)):v==="children"?typeof L=="string"?(u!=="textarea"||L!=="")&&gi(o,L):typeof L=="number"&&gi(o,""+L):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(s.hasOwnProperty(v)?L!=null&&v==="onScroll"&&Tt("scroll",o):L!=null&&Q(o,v,L,T))}switch(u){case"input":it(o),pi(o,m,!1);break;case"textarea":it(o),ts(o);break;case"option":m.value!=null&&o.setAttribute("value",""+ve(m.value));break;case"select":o.multiple=!!m.multiple,v=m.value,v!=null?Zn(o,!!m.multiple,v,!1):m.defaultValue!=null&&Zn(o,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=mp)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Ln(l),null;case 6:if(o&&l.stateNode!=null)Bx(o,l,o.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(t(166));if(u=qa(Sh.current),qa(Fs.current),Ip(l)){if(m=l.stateNode,u=l.memoizedProps,m[js]=l,(v=m.nodeValue!==u)&&(o=xr,o!==null))switch(o.tag){case 3:pp(m.nodeValue,u,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&pp(m.nodeValue,u,(o.mode&1)!==0)}v&&(l.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[js]=l,l.stateNode=m}return Ln(l),null;case 13:if(xt(Mt),m=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Ct&&br!==null&&(l.mode&1)!==0&&(l.flags&128)===0)HT(),bc(),l.flags|=98560,v=!1;else if(v=Ip(l),m!==null&&m.dehydrated!==null){if(o===null){if(!v)throw Error(t(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[js]=l}else bc(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ln(l),v=!1}else ls!==null&&(Jy(ls),ls=null),v=!0;if(!v)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(m=m!==null,m!==(o!==null&&o.memoizedState!==null)&&m&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(Mt.current&1)!==0?on===0&&(on=3):ev())),l.updateQueue!==null&&(l.flags|=4),Ln(l),null);case 4:return Cc(),Uy(o,l),o===null&&vh(l.stateNode.containerInfo),Ln(l),null;case 10:return py(l.type._context),Ln(l),null;case 17:return tr(l.type)&&_p(),Ln(l),null;case 19:if(xt(Mt),v=l.memoizedState,v===null)return Ln(l),null;if(m=(l.flags&128)!==0,T=v.rendering,T===null)if(m)Rh(v,!1);else{if(on!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(T=Np(o),T!==null){for(l.flags|=128,Rh(v,!1),m=T.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=u,u=l.child;u!==null;)v=u,o=m,v.flags&=14680066,T=v.alternate,T===null?(v.childLanes=0,v.lanes=o,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=T.childLanes,v.lanes=T.lanes,v.child=T.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=T.memoizedProps,v.memoizedState=T.memoizedState,v.updateQueue=T.updateQueue,v.type=T.type,o=T.dependencies,v.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),u=u.sibling;return gt(Mt,Mt.current&1|2),l.child}o=o.sibling}v.tail!==null&&It()>Dc&&(l.flags|=128,m=!0,Rh(v,!1),l.lanes=4194304)}else{if(!m)if(o=Np(T),o!==null){if(l.flags|=128,m=!0,u=o.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),Rh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!Ct)return Ln(l),null}else 2*It()-v.renderingStartTime>Dc&&u!==1073741824&&(l.flags|=128,m=!0,Rh(v,!1),l.lanes=4194304);v.isBackwards?(T.sibling=l.child,l.child=T):(u=v.last,u!==null?u.sibling=T:l.child=T,v.last=T)}return v.tail!==null?(l=v.tail,v.rendering=l,v.tail=l.sibling,v.renderingStartTime=It(),l.sibling=null,u=Mt.current,gt(Mt,m?u&1|2:u&1),l):(Ln(l),null);case 22:case 23:return Zy(),m=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==m&&(l.flags|=8192),m&&(l.mode&1)!==0?(Sr&1073741824)!==0&&(Ln(l),l.subtreeFlags&6&&(l.flags|=8192)):Ln(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function gL(o,l){switch(ly(l),l.tag){case 1:return tr(l.type)&&_p(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Cc(),xt(er),xt(Dn),Ey(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return vy(l),null;case 13:if(xt(Mt),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(t(340));bc()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return xt(Mt),null;case 4:return Cc(),null;case 10:return py(l.type._context),null;case 22:case 23:return Zy(),null;case 24:return null;default:return null}}var Vp=!1,Mn=!1,_L=typeof WeakSet=="function"?WeakSet:Set,we=null;function Rc(o,l){var u=o.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){zt(o,l,m)}else u.current=null}function By(o,l,u){try{u()}catch(m){zt(o,l,m)}}var zx=!1;function yL(o,l){if(Z_=Ti,o=wT(),W_(o)){if("selectionStart"in o)var u={start:o.selectionStart,end:o.selectionEnd};else e:{u=(u=o.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var _=m.anchorOffset,v=m.focusNode;m=m.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var T=0,A=-1,L=-1,q=0,re=0,oe=o,te=null;t:for(;;){for(var _e;oe!==u||_!==0&&oe.nodeType!==3||(A=T+_),oe!==v||m!==0&&oe.nodeType!==3||(L=T+m),oe.nodeType===3&&(T+=oe.nodeValue.length),(_e=oe.firstChild)!==null;)te=oe,oe=_e;for(;;){if(oe===o)break t;if(te===u&&++q===_&&(A=T),te===v&&++re===m&&(L=T),(_e=oe.nextSibling)!==null)break;oe=te,te=oe.parentNode}oe=_e}u=A===-1||L===-1?null:{start:A,end:L}}else u=null}u=u||{start:0,end:0}}else u=null;for(ey={focusedElem:o,selectionRange:u},Ti=!1,we=l;we!==null;)if(l=we,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,we=o;else for(;we!==null;){l=we;try{var Ie=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ie!==null){var be=Ie.memoizedProps,Gt=Ie.memoizedState,B=l.stateNode,V=B.getSnapshotBeforeUpdate(l.elementType===l.type?be:cs(l.type,be),Gt);B.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var $=l.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(le){zt(l,l.return,le)}if(o=l.sibling,o!==null){o.return=l.return,we=o;break}we=l.return}return Ie=zx,zx=!1,Ie}function Ph(o,l,u){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&o)===o){var v=_.destroy;_.destroy=void 0,v!==void 0&&By(l,u,v)}_=_.next}while(_!==m)}}function jp(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&o)===o){var m=u.create;u.destroy=m()}u=u.next}while(u!==l)}}function zy(o){var l=o.ref;if(l!==null){var u=o.stateNode;switch(o.tag){case 5:o=u;break;default:o=u}typeof l=="function"?l(o):l.current=o}}function $x(o){var l=o.alternate;l!==null&&(o.alternate=null,$x(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[js],delete l[Eh],delete l[sy],delete l[eL],delete l[tL])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Hx(o){return o.tag===5||o.tag===3||o.tag===4}function Wx(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Hx(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function $y(o,l,u){var m=o.tag;if(m===5||m===6)o=o.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(o,l):u.insertBefore(o,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(o,u)):(l=u,l.appendChild(o)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=mp));else if(m!==4&&(o=o.child,o!==null))for($y(o,l,u),o=o.sibling;o!==null;)$y(o,l,u),o=o.sibling}function Hy(o,l,u){var m=o.tag;if(m===5||m===6)o=o.stateNode,l?u.insertBefore(o,l):u.appendChild(o);else if(m!==4&&(o=o.child,o!==null))for(Hy(o,l,u),o=o.sibling;o!==null;)Hy(o,l,u),o=o.sibling}var bn=null,us=!1;function No(o,l,u){for(u=u.child;u!==null;)qx(o,l,u),u=u.sibling}function qx(o,l,u){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(Pa,u)}catch{}switch(u.tag){case 5:Mn||Rc(u,l);case 6:var m=bn,_=us;bn=null,No(o,l,u),bn=m,us=_,bn!==null&&(us?(o=bn,u=u.stateNode,o.nodeType===8?o.parentNode.removeChild(u):o.removeChild(u)):bn.removeChild(u.stateNode));break;case 18:bn!==null&&(us?(o=bn,u=u.stateNode,o.nodeType===8?ry(o.parentNode,u):o.nodeType===1&&ry(o,u),yo(o)):ry(bn,u.stateNode));break;case 4:m=bn,_=us,bn=u.stateNode.containerInfo,us=!0,No(o,l,u),bn=m,us=_;break;case 0:case 11:case 14:case 15:if(!Mn&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){_=m=m.next;do{var v=_,T=v.destroy;v=v.tag,T!==void 0&&((v&2)!==0||(v&4)!==0)&&By(u,l,T),_=_.next}while(_!==m)}No(o,l,u);break;case 1:if(!Mn&&(Rc(u,l),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(A){zt(u,l,A)}No(o,l,u);break;case 21:No(o,l,u);break;case 22:u.mode&1?(Mn=(m=Mn)||u.memoizedState!==null,No(o,l,u),Mn=m):No(o,l,u);break;default:No(o,l,u)}}function Gx(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var u=o.stateNode;u===null&&(u=o.stateNode=new _L),l.forEach(function(m){var _=AL.bind(null,o,m);u.has(m)||(u.add(m),m.then(_,_))})}}function hs(o,l){var u=l.deletions;if(u!==null)for(var m=0;m<u.length;m++){var _=u[m];try{var v=o,T=l,A=T;e:for(;A!==null;){switch(A.tag){case 5:bn=A.stateNode,us=!1;break e;case 3:bn=A.stateNode.containerInfo,us=!0;break e;case 4:bn=A.stateNode.containerInfo,us=!0;break e}A=A.return}if(bn===null)throw Error(t(160));qx(v,T,_),bn=null,us=!1;var L=_.alternate;L!==null&&(L.return=null),_.return=null}catch(q){zt(_,l,q)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Kx(l,o),l=l.sibling}function Kx(o,l){var u=o.alternate,m=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(hs(l,o),Bs(o),m&4){try{Ph(3,o,o.return),jp(3,o)}catch(be){zt(o,o.return,be)}try{Ph(5,o,o.return)}catch(be){zt(o,o.return,be)}}break;case 1:hs(l,o),Bs(o),m&512&&u!==null&&Rc(u,u.return);break;case 5:if(hs(l,o),Bs(o),m&512&&u!==null&&Rc(u,u.return),o.flags&32){var _=o.stateNode;try{gi(_,"")}catch(be){zt(o,o.return,be)}}if(m&4&&(_=o.stateNode,_!=null)){var v=o.memoizedProps,T=u!==null?u.memoizedProps:v,A=o.type,L=o.updateQueue;if(o.updateQueue=null,L!==null)try{A==="input"&&v.type==="radio"&&v.name!=null&&In(_,v),_i(A,T);var q=_i(A,v);for(T=0;T<L.length;T+=2){var re=L[T],oe=L[T+1];re==="style"?lo(_,oe):re==="dangerouslySetInnerHTML"?Sa(_,oe):re==="children"?gi(_,oe):Q(_,re,oe,q)}switch(A){case"input":fi(_,v);break;case"textarea":ba(_,v);break;case"select":var te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!v.multiple;var _e=v.value;_e!=null?Zn(_,!!v.multiple,_e,!1):te!==!!v.multiple&&(v.defaultValue!=null?Zn(_,!!v.multiple,v.defaultValue,!0):Zn(_,!!v.multiple,v.multiple?[]:"",!1))}_[Eh]=v}catch(be){zt(o,o.return,be)}}break;case 6:if(hs(l,o),Bs(o),m&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,v=o.memoizedProps;try{_.nodeValue=v}catch(be){zt(o,o.return,be)}}break;case 3:if(hs(l,o),Bs(o),m&4&&u!==null&&u.memoizedState.isDehydrated)try{yo(l.containerInfo)}catch(be){zt(o,o.return,be)}break;case 4:hs(l,o),Bs(o);break;case 13:hs(l,o),Bs(o),_=o.child,_.flags&8192&&(v=_.memoizedState!==null,_.stateNode.isHidden=v,!v||_.alternate!==null&&_.alternate.memoizedState!==null||(Gy=It())),m&4&&Gx(o);break;case 22:if(re=u!==null&&u.memoizedState!==null,o.mode&1?(Mn=(q=Mn)||re,hs(l,o),Mn=q):hs(l,o),Bs(o),m&8192){if(q=o.memoizedState!==null,(o.stateNode.isHidden=q)&&!re&&(o.mode&1)!==0)for(we=o,re=o.child;re!==null;){for(oe=we=re;we!==null;){switch(te=we,_e=te.child,te.tag){case 0:case 11:case 14:case 15:Ph(4,te,te.return);break;case 1:Rc(te,te.return);var Ie=te.stateNode;if(typeof Ie.componentWillUnmount=="function"){m=te,u=te.return;try{l=m,Ie.props=l.memoizedProps,Ie.state=l.memoizedState,Ie.componentWillUnmount()}catch(be){zt(m,u,be)}}break;case 5:Rc(te,te.return);break;case 22:if(te.memoizedState!==null){Jx(oe);continue}}_e!==null?(_e.return=te,we=_e):Jx(oe)}re=re.sibling}e:for(re=null,oe=o;;){if(oe.tag===5){if(re===null){re=oe;try{_=oe.stateNode,q?(v=_.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(A=oe.stateNode,L=oe.memoizedProps.style,T=L!=null&&L.hasOwnProperty("display")?L.display:null,A.style.display=Ts("display",T))}catch(be){zt(o,o.return,be)}}}else if(oe.tag===6){if(re===null)try{oe.stateNode.nodeValue=q?"":oe.memoizedProps}catch(be){zt(o,o.return,be)}}else if((oe.tag!==22&&oe.tag!==23||oe.memoizedState===null||oe===o)&&oe.child!==null){oe.child.return=oe,oe=oe.child;continue}if(oe===o)break e;for(;oe.sibling===null;){if(oe.return===null||oe.return===o)break e;re===oe&&(re=null),oe=oe.return}re===oe&&(re=null),oe.sibling.return=oe.return,oe=oe.sibling}}break;case 19:hs(l,o),Bs(o),m&4&&Gx(o);break;case 21:break;default:hs(l,o),Bs(o)}}function Bs(o){var l=o.flags;if(l&2){try{e:{for(var u=o.return;u!==null;){if(Hx(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var _=m.stateNode;m.flags&32&&(gi(_,""),m.flags&=-33);var v=Wx(o);Hy(o,v,_);break;case 3:case 4:var T=m.stateNode.containerInfo,A=Wx(o);$y(o,A,T);break;default:throw Error(t(161))}}catch(L){zt(o,o.return,L)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function vL(o,l,u){we=o,Qx(o)}function Qx(o,l,u){for(var m=(o.mode&1)!==0;we!==null;){var _=we,v=_.child;if(_.tag===22&&m){var T=_.memoizedState!==null||Vp;if(!T){var A=_.alternate,L=A!==null&&A.memoizedState!==null||Mn;A=Vp;var q=Mn;if(Vp=T,(Mn=L)&&!q)for(we=_;we!==null;)T=we,L=T.child,T.tag===22&&T.memoizedState!==null?Xx(_):L!==null?(L.return=T,we=L):Xx(_);for(;v!==null;)we=v,Qx(v),v=v.sibling;we=_,Vp=A,Mn=q}Yx(o)}else(_.subtreeFlags&8772)!==0&&v!==null?(v.return=_,we=v):Yx(o)}}function Yx(o){for(;we!==null;){var l=we;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Mn||jp(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!Mn)if(u===null)m.componentDidMount();else{var _=l.elementType===l.type?u.memoizedProps:cs(l.type,u.memoizedProps);m.componentDidUpdate(_,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var v=l.updateQueue;v!==null&&JT(l,v,m);break;case 3:var T=l.updateQueue;if(T!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}JT(l,T,u)}break;case 5:var A=l.stateNode;if(u===null&&l.flags&4){u=A;var L=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&u.focus();break;case"img":L.src&&(u.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var q=l.alternate;if(q!==null){var re=q.memoizedState;if(re!==null){var oe=re.dehydrated;oe!==null&&yo(oe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Mn||l.flags&512&&zy(l)}catch(te){zt(l,l.return,te)}}if(l===o){we=null;break}if(u=l.sibling,u!==null){u.return=l.return,we=u;break}we=l.return}}function Jx(o){for(;we!==null;){var l=we;if(l===o){we=null;break}var u=l.sibling;if(u!==null){u.return=l.return,we=u;break}we=l.return}}function Xx(o){for(;we!==null;){var l=we;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{jp(4,l)}catch(L){zt(l,u,L)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var _=l.return;try{m.componentDidMount()}catch(L){zt(l,_,L)}}var v=l.return;try{zy(l)}catch(L){zt(l,v,L)}break;case 5:var T=l.return;try{zy(l)}catch(L){zt(l,T,L)}}}catch(L){zt(l,l.return,L)}if(l===o){we=null;break}var A=l.sibling;if(A!==null){A.return=l.return,we=A;break}we=l.return}}var wL=Math.ceil,Fp=Y.ReactCurrentDispatcher,Wy=Y.ReactCurrentOwner,qr=Y.ReactCurrentBatchConfig,Ze=0,dn=null,Zt=null,Sn=0,Sr=0,Pc=To(0),on=0,Dh=null,Ka=0,Up=0,qy=0,Oh=null,rr=null,Gy=0,Dc=1/0,Di=null,Bp=!1,Ky=null,Co=null,zp=!1,ko=null,$p=0,Lh=0,Qy=null,Hp=-1,Wp=0;function Wn(){return(Ze&6)!==0?It():Hp!==-1?Hp:Hp=It()}function Ro(o){return(o.mode&1)===0?1:(Ze&2)!==0&&Sn!==0?Sn&-Sn:rL.transition!==null?(Wp===0&&(Wp=nh()),Wp):(o=Je,o!==0||(o=window.event,o=o===void 0?16:lc(o.type)),o)}function ds(o,l,u,m){if(50<Lh)throw Lh=0,Qy=null,Error(t(185));Ma(o,u,m),((Ze&2)===0||o!==dn)&&(o===dn&&((Ze&2)===0&&(Up|=u),on===4&&Po(o,Sn)),sr(o,m),u===1&&Ze===0&&(l.mode&1)===0&&(Dc=It()+500,vp&&bo()))}function sr(o,l){var u=o.callbackNode;La(o,l);var m=wi(o,o===dn?Sn:0);if(m===0)u!==null&&tc(u),o.callbackNode=null,o.callbackPriority=0;else if(l=m&-m,o.callbackPriority!==l){if(u!=null&&tc(u),l===1)o.tag===0?nL(eb.bind(null,o)):FT(eb.bind(null,o)),XO(function(){(Ze&6)===0&&bo()}),u=null;else{switch(Ns(m)){case 1:u=nc;break;case 4:u=Zu;break;case 16:u=Ra;break;case 536870912:u=rc;break;default:u=Ra}u=lb(u,Zx.bind(null,o))}o.callbackPriority=l,o.callbackNode=u}}function Zx(o,l){if(Hp=-1,Wp=0,(Ze&6)!==0)throw Error(t(327));var u=o.callbackNode;if(Oc()&&o.callbackNode!==u)return null;var m=wi(o,o===dn?Sn:0);if(m===0)return null;if((m&30)!==0||(m&o.expiredLanes)!==0||l)l=qp(o,m);else{l=m;var _=Ze;Ze|=2;var v=nb();(dn!==o||Sn!==l)&&(Di=null,Dc=It()+500,Ya(o,l));do try{TL();break}catch(A){tb(o,A)}while(!0);fy(),Fp.current=v,Ze=_,Zt!==null?l=0:(dn=null,Sn=0,l=on)}if(l!==0){if(l===2&&(_=th(o),_!==0&&(m=_,l=Yy(o,_))),l===1)throw u=Dh,Ya(o,0),Po(o,m),sr(o,It()),u;if(l===6)Po(o,m);else{if(_=o.current.alternate,(m&30)===0&&!EL(_)&&(l=qp(o,m),l===2&&(v=th(o),v!==0&&(m=v,l=Yy(o,v))),l===1))throw u=Dh,Ya(o,0),Po(o,m),sr(o,It()),u;switch(o.finishedWork=_,o.finishedLanes=m,l){case 0:case 1:throw Error(t(345));case 2:Ja(o,rr,Di);break;case 3:if(Po(o,m),(m&130023424)===m&&(l=Gy+500-It(),10<l)){if(wi(o,0)!==0)break;if(_=o.suspendedLanes,(_&m)!==m){Wn(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=ny(Ja.bind(null,o,rr,Di),l);break}Ja(o,rr,Di);break;case 4:if(Po(o,m),(m&4194240)===m)break;for(l=o.eventTimes,_=-1;0<m;){var T=31-vr(m);v=1<<T,T=l[T],T>_&&(_=T),m&=~v}if(m=_,m=It()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*wL(m/1960))-m,10<m){o.timeoutHandle=ny(Ja.bind(null,o,rr,Di),m);break}Ja(o,rr,Di);break;case 5:Ja(o,rr,Di);break;default:throw Error(t(329))}}}return sr(o,It()),o.callbackNode===u?Zx.bind(null,o):null}function Yy(o,l){var u=Oh;return o.current.memoizedState.isDehydrated&&(Ya(o,l).flags|=256),o=qp(o,l),o!==2&&(l=rr,rr=u,l!==null&&Jy(l)),o}function Jy(o){rr===null?rr=o:rr.push.apply(rr,o)}function EL(o){for(var l=o;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var _=u[m],v=_.getSnapshot;_=_.value;try{if(!as(v(),_))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Po(o,l){for(l&=~qy,l&=~Up,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var u=31-vr(l),m=1<<u;o[u]=-1,l&=~m}}function eb(o){if((Ze&6)!==0)throw Error(t(327));Oc();var l=wi(o,0);if((l&1)===0)return sr(o,It()),null;var u=qp(o,l);if(o.tag!==0&&u===2){var m=th(o);m!==0&&(l=m,u=Yy(o,m))}if(u===1)throw u=Dh,Ya(o,0),Po(o,l),sr(o,It()),u;if(u===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,Ja(o,rr,Di),sr(o,It()),null}function Xy(o,l){var u=Ze;Ze|=1;try{return o(l)}finally{Ze=u,Ze===0&&(Dc=It()+500,vp&&bo())}}function Qa(o){ko!==null&&ko.tag===0&&(Ze&6)===0&&Oc();var l=Ze;Ze|=1;var u=qr.transition,m=Je;try{if(qr.transition=null,Je=1,o)return o()}finally{Je=m,qr.transition=u,Ze=l,(Ze&6)===0&&bo()}}function Zy(){Sr=Pc.current,xt(Pc)}function Ya(o,l){o.finishedWork=null,o.finishedLanes=0;var u=o.timeoutHandle;if(u!==-1&&(o.timeoutHandle=-1,JO(u)),Zt!==null)for(u=Zt.return;u!==null;){var m=u;switch(ly(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&_p();break;case 3:Cc(),xt(er),xt(Dn),Ey();break;case 5:vy(m);break;case 4:Cc();break;case 13:xt(Mt);break;case 19:xt(Mt);break;case 10:py(m.type._context);break;case 22:case 23:Zy()}u=u.return}if(dn=o,Zt=o=Do(o.current,null),Sn=Sr=l,on=0,Dh=null,qy=Up=Ka=0,rr=Oh=null,Wa!==null){for(l=0;l<Wa.length;l++)if(u=Wa[l],m=u.interleaved,m!==null){u.interleaved=null;var _=m.next,v=u.pending;if(v!==null){var T=v.next;v.next=_,m.next=T}u.pending=m}Wa=null}return o}function tb(o,l){do{var u=Zt;try{if(fy(),Cp.current=Dp,kp){for(var m=Vt.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}kp=!1}if(Ga=0,hn=sn=Vt=null,Ah=!1,Nh=0,Wy.current=null,u===null||u.return===null){on=1,Dh=l,Zt=null;break}e:{var v=o,T=u.return,A=u,L=l;if(l=Sn,A.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var q=L,re=A,oe=re.tag;if((re.mode&1)===0&&(oe===0||oe===11||oe===15)){var te=re.alternate;te?(re.updateQueue=te.updateQueue,re.memoizedState=te.memoizedState,re.lanes=te.lanes):(re.updateQueue=null,re.memoizedState=null)}var _e=Sx(T);if(_e!==null){_e.flags&=-257,Ax(_e,T,A,v,l),_e.mode&1&&bx(v,q,l),l=_e,L=q;var Ie=l.updateQueue;if(Ie===null){var be=new Set;be.add(L),l.updateQueue=be}else Ie.add(L);break e}else{if((l&1)===0){bx(v,q,l),ev();break e}L=Error(t(426))}}else if(Ct&&A.mode&1){var Gt=Sx(T);if(Gt!==null){(Gt.flags&65536)===0&&(Gt.flags|=256),Ax(Gt,T,A,v,l),hy(kc(L,A));break e}}v=L=kc(L,A),on!==4&&(on=2),Oh===null?Oh=[v]:Oh.push(v),v=T;do{switch(v.tag){case 3:v.flags|=65536,l&=-l,v.lanes|=l;var B=Tx(v,L,l);YT(v,B);break e;case 1:A=L;var V=v.type,$=v.stateNode;if((v.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Co===null||!Co.has($)))){v.flags|=65536,l&=-l,v.lanes|=l;var le=xx(v,A,l);YT(v,le);break e}}v=v.return}while(v!==null)}sb(u)}catch(Ce){l=Ce,Zt===u&&u!==null&&(Zt=u=u.return);continue}break}while(!0)}function nb(){var o=Fp.current;return Fp.current=Dp,o===null?Dp:o}function ev(){(on===0||on===3||on===2)&&(on=4),dn===null||(Ka&268435455)===0&&(Up&268435455)===0||Po(dn,Sn)}function qp(o,l){var u=Ze;Ze|=2;var m=nb();(dn!==o||Sn!==l)&&(Di=null,Ya(o,l));do try{IL();break}catch(_){tb(o,_)}while(!0);if(fy(),Ze=u,Fp.current=m,Zt!==null)throw Error(t(261));return dn=null,Sn=0,on}function IL(){for(;Zt!==null;)rb(Zt)}function TL(){for(;Zt!==null&&!ka();)rb(Zt)}function rb(o){var l=ab(o.alternate,o,Sr);o.memoizedProps=o.pendingProps,l===null?sb(o):Zt=l,Wy.current=null}function sb(o){var l=o;do{var u=l.alternate;if(o=l.return,(l.flags&32768)===0){if(u=mL(u,l,Sr),u!==null){Zt=u;return}}else{if(u=gL(u,l),u!==null){u.flags&=32767,Zt=u;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{on=6,Zt=null;return}}if(l=l.sibling,l!==null){Zt=l;return}Zt=l=o}while(l!==null);on===0&&(on=5)}function Ja(o,l,u){var m=Je,_=qr.transition;try{qr.transition=null,Je=1,xL(o,l,u,m)}finally{qr.transition=_,Je=m}return null}function xL(o,l,u,m){do Oc();while(ko!==null);if((Ze&6)!==0)throw Error(t(327));u=o.finishedWork;var _=o.finishedLanes;if(u===null)return null;if(o.finishedWork=null,o.finishedLanes=0,u===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var v=u.lanes|u.childLanes;if(U_(o,v),o===dn&&(Zt=dn=null,Sn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||zp||(zp=!0,lb(Ra,function(){return Oc(),null})),v=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||v){v=qr.transition,qr.transition=null;var T=Je;Je=1;var A=Ze;Ze|=4,Wy.current=null,yL(o,u),Kx(u,o),HO(ey),Ti=!!Z_,ey=Z_=null,o.current=u,vL(u),vi(),Ze=A,Je=T,qr.transition=v}else o.current=u;if(zp&&(zp=!1,ko=o,$p=_),v=o.pendingLanes,v===0&&(Co=null),Zf(u.stateNode),sr(o,It()),l!==null)for(m=o.onRecoverableError,u=0;u<l.length;u++)_=l[u],m(_.value,{componentStack:_.stack,digest:_.digest});if(Bp)throw Bp=!1,o=Ky,Ky=null,o;return($p&1)!==0&&o.tag!==0&&Oc(),v=o.pendingLanes,(v&1)!==0?o===Qy?Lh++:(Lh=0,Qy=o):Lh=0,bo(),null}function Oc(){if(ko!==null){var o=Ns($p),l=qr.transition,u=Je;try{if(qr.transition=null,Je=16>o?16:o,ko===null)var m=!1;else{if(o=ko,ko=null,$p=0,(Ze&6)!==0)throw Error(t(331));var _=Ze;for(Ze|=4,we=o.current;we!==null;){var v=we,T=v.child;if((we.flags&16)!==0){var A=v.deletions;if(A!==null){for(var L=0;L<A.length;L++){var q=A[L];for(we=q;we!==null;){var re=we;switch(re.tag){case 0:case 11:case 15:Ph(8,re,v)}var oe=re.child;if(oe!==null)oe.return=re,we=oe;else for(;we!==null;){re=we;var te=re.sibling,_e=re.return;if($x(re),re===q){we=null;break}if(te!==null){te.return=_e,we=te;break}we=_e}}}var Ie=v.alternate;if(Ie!==null){var be=Ie.child;if(be!==null){Ie.child=null;do{var Gt=be.sibling;be.sibling=null,be=Gt}while(be!==null)}}we=v}}if((v.subtreeFlags&2064)!==0&&T!==null)T.return=v,we=T;else e:for(;we!==null;){if(v=we,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Ph(9,v,v.return)}var B=v.sibling;if(B!==null){B.return=v.return,we=B;break e}we=v.return}}var V=o.current;for(we=V;we!==null;){T=we;var $=T.child;if((T.subtreeFlags&2064)!==0&&$!==null)$.return=T,we=$;else e:for(T=V;we!==null;){if(A=we,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:jp(9,A)}}catch(Ce){zt(A,A.return,Ce)}if(A===T){we=null;break e}var le=A.sibling;if(le!==null){le.return=A.return,we=le;break e}we=A.return}}if(Ze=_,bo(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(Pa,o)}catch{}m=!0}return m}finally{Je=u,qr.transition=l}}return!1}function ib(o,l,u){l=kc(u,l),l=Tx(o,l,1),o=Ao(o,l,1),l=Wn(),o!==null&&(Ma(o,1,l),sr(o,l))}function zt(o,l,u){if(o.tag===3)ib(o,o,u);else for(;l!==null;){if(l.tag===3){ib(l,o,u);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Co===null||!Co.has(m))){o=kc(u,o),o=xx(l,o,1),l=Ao(l,o,1),o=Wn(),l!==null&&(Ma(l,1,o),sr(l,o));break}}l=l.return}}function bL(o,l,u){var m=o.pingCache;m!==null&&m.delete(l),l=Wn(),o.pingedLanes|=o.suspendedLanes&u,dn===o&&(Sn&u)===u&&(on===4||on===3&&(Sn&130023424)===Sn&&500>It()-Gy?Ya(o,0):qy|=u),sr(o,l)}function ob(o,l){l===0&&((o.mode&1)===0?l=1:(l=mo,mo<<=1,(mo&130023424)===0&&(mo=4194304)));var u=Wn();o=ki(o,l),o!==null&&(Ma(o,l,u),sr(o,u))}function SL(o){var l=o.memoizedState,u=0;l!==null&&(u=l.retryLane),ob(o,u)}function AL(o,l){var u=0;switch(o.tag){case 13:var m=o.stateNode,_=o.memoizedState;_!==null&&(u=_.retryLane);break;case 19:m=o.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(l),ob(o,u)}var ab;ab=function(o,l,u){if(o!==null)if(o.memoizedProps!==l.pendingProps||er.current)nr=!0;else{if((o.lanes&u)===0&&(l.flags&128)===0)return nr=!1,pL(o,l,u);nr=(o.flags&131072)!==0}else nr=!1,Ct&&(l.flags&1048576)!==0&&UT(l,Ep,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Mp(o,l),o=l.pendingProps;var _=Ic(l,Dn.current);Nc(l,u),_=xy(null,l,m,o,_,u);var v=by();return l.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,tr(m)?(v=!0,yp(l)):v=!1,l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_y(l),_.updater=Op,l.stateNode=_,_._reactInternals=l,Ry(l,m,o,u),l=Ly(null,l,m,!0,v,u)):(l.tag=0,Ct&&v&&ay(l),Hn(null,l,_,u),l=l.child),l;case 16:m=l.elementType;e:{switch(Mp(o,l),o=l.pendingProps,_=m._init,m=_(m._payload),l.type=m,_=l.tag=CL(m),o=cs(m,o),_){case 0:l=Oy(null,l,m,o,u);break e;case 1:l=Dx(null,l,m,o,u);break e;case 11:l=Nx(null,l,m,o,u);break e;case 14:l=Cx(null,l,m,cs(m.type,o),u);break e}throw Error(t(306,m,""))}return l;case 0:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:cs(m,_),Oy(o,l,m,_,u);case 1:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:cs(m,_),Dx(o,l,m,_,u);case 3:e:{if(Ox(l),o===null)throw Error(t(387));m=l.pendingProps,v=l.memoizedState,_=v.element,QT(o,l),Ap(l,m,null,u);var T=l.memoizedState;if(m=T.element,v.isDehydrated)if(v={element:m,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},l.updateQueue.baseState=v,l.memoizedState=v,l.flags&256){_=kc(Error(t(423)),l),l=Lx(o,l,m,u,_);break e}else if(m!==_){_=kc(Error(t(424)),l),l=Lx(o,l,m,u,_);break e}else for(br=Io(l.stateNode.containerInfo.firstChild),xr=l,Ct=!0,ls=null,u=GT(l,null,m,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(bc(),m===_){l=Pi(o,l,u);break e}Hn(o,l,m,u)}l=l.child}return l;case 5:return XT(l),o===null&&uy(l),m=l.type,_=l.pendingProps,v=o!==null?o.memoizedProps:null,T=_.children,ty(m,_)?T=null:v!==null&&ty(m,v)&&(l.flags|=32),Px(o,l),Hn(o,l,T,u),l.child;case 6:return o===null&&uy(l),null;case 13:return Mx(o,l,u);case 4:return yy(l,l.stateNode.containerInfo),m=l.pendingProps,o===null?l.child=Sc(l,null,m,u):Hn(o,l,m,u),l.child;case 11:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:cs(m,_),Nx(o,l,m,_,u);case 7:return Hn(o,l,l.pendingProps,u),l.child;case 8:return Hn(o,l,l.pendingProps.children,u),l.child;case 12:return Hn(o,l,l.pendingProps.children,u),l.child;case 10:e:{if(m=l.type._context,_=l.pendingProps,v=l.memoizedProps,T=_.value,gt(xp,m._currentValue),m._currentValue=T,v!==null)if(as(v.value,T)){if(v.children===_.children&&!er.current){l=Pi(o,l,u);break e}}else for(v=l.child,v!==null&&(v.return=l);v!==null;){var A=v.dependencies;if(A!==null){T=v.child;for(var L=A.firstContext;L!==null;){if(L.context===m){if(v.tag===1){L=Ri(-1,u&-u),L.tag=2;var q=v.updateQueue;if(q!==null){q=q.shared;var re=q.pending;re===null?L.next=L:(L.next=re.next,re.next=L),q.pending=L}}v.lanes|=u,L=v.alternate,L!==null&&(L.lanes|=u),my(v.return,u,l),A.lanes|=u;break}L=L.next}}else if(v.tag===10)T=v.type===l.type?null:v.child;else if(v.tag===18){if(T=v.return,T===null)throw Error(t(341));T.lanes|=u,A=T.alternate,A!==null&&(A.lanes|=u),my(T,u,l),T=v.sibling}else T=v.child;if(T!==null)T.return=v;else for(T=v;T!==null;){if(T===l){T=null;break}if(v=T.sibling,v!==null){v.return=T.return,T=v;break}T=T.return}v=T}Hn(o,l,_.children,u),l=l.child}return l;case 9:return _=l.type,m=l.pendingProps.children,Nc(l,u),_=Hr(_),m=m(_),l.flags|=1,Hn(o,l,m,u),l.child;case 14:return m=l.type,_=cs(m,l.pendingProps),_=cs(m.type,_),Cx(o,l,m,_,u);case 15:return kx(o,l,l.type,l.pendingProps,u);case 17:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:cs(m,_),Mp(o,l),l.tag=1,tr(m)?(o=!0,yp(l)):o=!1,Nc(l,u),Ex(l,m,_),Ry(l,m,_,u),Ly(null,l,m,!0,o,u);case 19:return jx(o,l,u);case 22:return Rx(o,l,u)}throw Error(t(156,l.tag))};function lb(o,l){return Xu(o,l)}function NL(o,l,u,m){this.tag=o,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gr(o,l,u,m){return new NL(o,l,u,m)}function tv(o){return o=o.prototype,!(!o||!o.isReactComponent)}function CL(o){if(typeof o=="function")return tv(o)?1:0;if(o!=null){if(o=o.$$typeof,o===j)return 11;if(o===Et)return 14}return 2}function Do(o,l){var u=o.alternate;return u===null?(u=Gr(o.tag,l,o.key,o.mode),u.elementType=o.elementType,u.type=o.type,u.stateNode=o.stateNode,u.alternate=o,o.alternate=u):(u.pendingProps=l,u.type=o.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=o.flags&14680064,u.childLanes=o.childLanes,u.lanes=o.lanes,u.child=o.child,u.memoizedProps=o.memoizedProps,u.memoizedState=o.memoizedState,u.updateQueue=o.updateQueue,l=o.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=o.sibling,u.index=o.index,u.ref=o.ref,u}function Gp(o,l,u,m,_,v){var T=2;if(m=o,typeof o=="function")tv(o)&&(T=1);else if(typeof o=="string")T=5;else e:switch(o){case R:return Xa(u.children,_,v,l);case S:T=8,_|=8;break;case k:return o=Gr(12,u,l,_|2),o.elementType=k,o.lanes=v,o;case C:return o=Gr(13,u,l,_),o.elementType=C,o.lanes=v,o;case We:return o=Gr(19,u,l,_),o.elementType=We,o.lanes=v,o;case st:return Kp(u,_,v,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case D:T=10;break e;case N:T=9;break e;case j:T=11;break e;case Et:T=14;break e;case Nt:T=16,m=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return l=Gr(T,u,l,_),l.elementType=o,l.type=m,l.lanes=v,l}function Xa(o,l,u,m){return o=Gr(7,o,m,l),o.lanes=u,o}function Kp(o,l,u,m){return o=Gr(22,o,m,l),o.elementType=st,o.lanes=u,o.stateNode={isHidden:!1},o}function nv(o,l,u){return o=Gr(6,o,null,l),o.lanes=u,o}function rv(o,l,u){return l=Gr(4,o.children!==null?o.children:[],o.key,l),l.lanes=u,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function kL(o,l,u,m,_){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rh(0),this.expirationTimes=rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rh(0),this.identifierPrefix=m,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function sv(o,l,u,m,_,v,T,A,L){return o=new kL(o,l,u,A,L),l===1?(l=1,v===!0&&(l|=8)):l=0,v=Gr(3,null,null,l),o.current=v,v.stateNode=o,v.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},_y(v),o}function RL(o,l,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:m==null?null:""+m,children:o,containerInfo:l,implementation:u}}function cb(o){if(!o)return xo;o=o._reactInternals;e:{if(is(o)!==o||o.tag!==1)throw Error(t(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(tr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(o.tag===1){var u=o.type;if(tr(u))return VT(o,u,l)}return l}function ub(o,l,u,m,_,v,T,A,L){return o=sv(u,m,!0,o,_,v,T,A,L),o.context=cb(null),u=o.current,m=Wn(),_=Ro(u),v=Ri(m,_),v.callback=l??null,Ao(u,v,_),o.current.lanes=_,Ma(o,_,m),sr(o,m),o}function Qp(o,l,u,m){var _=l.current,v=Wn(),T=Ro(_);return u=cb(u),l.context===null?l.context=u:l.pendingContext=u,l=Ri(v,T),l.payload={element:o},m=m===void 0?null:m,m!==null&&(l.callback=m),o=Ao(_,l,T),o!==null&&(ds(o,_,T,v),Sp(o,_,T)),T}function Yp(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function hb(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var u=o.retryLane;o.retryLane=u!==0&&u<l?u:l}}function iv(o,l){hb(o,l),(o=o.alternate)&&hb(o,l)}function PL(){return null}var db=typeof reportError=="function"?reportError:function(o){console.error(o)};function ov(o){this._internalRoot=o}Jp.prototype.render=ov.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(t(409));Qp(o,l,null,null)},Jp.prototype.unmount=ov.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;Qa(function(){Qp(null,o,null,null)}),l[Si]=null}};function Jp(o){this._internalRoot=o}Jp.prototype.unstable_scheduleHydration=function(o){if(o){var l=ah();o={blockedOn:null,target:o,priority:l};for(var u=0;u<wr.length&&l!==0&&l<wr[u].priority;u++);wr.splice(u,0,o),u===0&&oc(o)}};function av(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Xp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function fb(){}function DL(o,l,u,m,_){if(_){if(typeof m=="function"){var v=m;m=function(){var q=Yp(T);v.call(q)}}var T=ub(l,m,o,0,null,!1,!1,"",fb);return o._reactRootContainer=T,o[Si]=T.current,vh(o.nodeType===8?o.parentNode:o),Qa(),T}for(;_=o.lastChild;)o.removeChild(_);if(typeof m=="function"){var A=m;m=function(){var q=Yp(L);A.call(q)}}var L=sv(o,0,!1,null,null,!1,!1,"",fb);return o._reactRootContainer=L,o[Si]=L.current,vh(o.nodeType===8?o.parentNode:o),Qa(function(){Qp(l,L,u,m)}),L}function Zp(o,l,u,m,_){var v=u._reactRootContainer;if(v){var T=v;if(typeof _=="function"){var A=_;_=function(){var L=Yp(T);A.call(L)}}Qp(l,T,o,_)}else T=DL(u,l,o,_,m);return Yp(T)}ih=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var u=ot(l.pendingLanes);u!==0&&(sh(l,u|1),sr(l,It()),(Ze&6)===0&&(Dc=It()+500,bo()))}break;case 13:Qa(function(){var m=ki(o,1);if(m!==null){var _=Wn();ds(m,o,1,_)}}),iv(o,1)}},sc=function(o){if(o.tag===13){var l=ki(o,134217728);if(l!==null){var u=Wn();ds(l,o,134217728,u)}iv(o,134217728)}},oh=function(o){if(o.tag===13){var l=Ro(o),u=ki(o,l);if(u!==null){var m=Wn();ds(u,o,l,m)}iv(o,l)}},ah=function(){return Je},lh=function(o,l){var u=Je;try{return Je=o,l()}finally{Je=u}},rs=function(o,l,u){switch(l){case"input":if(fi(o,u),l=u.name,u.type==="radio"&&l!=null){for(u=o;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var m=u[l];if(m!==o&&m.form===o.form){var _=gp(m);if(!_)throw Error(t(90));Vr(m),fi(m,_)}}}break;case"textarea":ba(o,u);break;case"select":l=u.value,l!=null&&Zn(o,!!u.multiple,l,!1)}},_r=Xy,uo=Qa;var OL={usingClientEntryPoint:!1,Events:[Ih,wc,gp,un,Fr,Xy]},Mh={findFiberByHostInstance:Ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LL={bundleType:Mh.bundleType,version:Mh.version,rendererPackageName:Mh.rendererPackageName,rendererConfig:Mh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Xf(o),o===null?null:o.stateNode},findFiberByHostInstance:Mh.findFiberByHostInstance||PL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!em.isDisabled&&em.supportsFiber)try{Pa=em.inject(LL),yr=em}catch{}}return ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OL,ir.createPortal=function(o,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!av(l))throw Error(t(200));return RL(o,l,null,u)},ir.createRoot=function(o,l){if(!av(o))throw Error(t(299));var u=!1,m="",_=db;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),l=sv(o,1,!1,null,null,u,!1,m,_),o[Si]=l.current,vh(o.nodeType===8?o.parentNode:o),new ov(l)},ir.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=Xf(l),o=o===null?null:o.stateNode,o},ir.flushSync=function(o){return Qa(o)},ir.hydrate=function(o,l,u){if(!Xp(l))throw Error(t(200));return Zp(null,o,l,!0,u)},ir.hydrateRoot=function(o,l,u){if(!av(o))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,_=!1,v="",T=db;if(u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(T=u.onRecoverableError)),l=ub(l,null,o,1,u??null,_,!1,v,T),o[Si]=l.current,vh(o),m)for(o=0;o<m.length;o++)u=m[o],_=u._getVersion,_=_(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,_]:l.mutableSourceEagerHydrationData.push(u,_);return new Jp(l)},ir.render=function(o,l,u){if(!Xp(l))throw Error(t(200));return Zp(null,o,l,!1,u)},ir.unmountComponentAtNode=function(o){if(!Xp(o))throw Error(t(40));return o._reactRootContainer?(Qa(function(){Zp(null,null,o,!1,function(){o._reactRootContainer=null,o[Si]=null})}),!0):!1},ir.unstable_batchedUpdates=Xy,ir.unstable_renderSubtreeIntoContainer=function(o,l,u,m){if(!Xp(u))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Zp(o,l,u,!1,m)},ir.version="18.3.1-next-f1338f8080-20240426",ir}var Tb;function GL(){if(Tb)return uv.exports;Tb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),uv.exports=qL(),uv.exports}var xb;function KL(){if(xb)return nm;xb=1;var n=GL();return nm.createRoot=n.createRoot,nm.hydrateRoot=n.hydrateRoot,nm}var QL=KL();const QN=KN(QL);var pn=(n=>(n.Jobs="JOBS",n.Insurance="INSURANCE",n.Messaging="MESSAGING",n.Chatbot="CHATBOT",n.Profile="PROFILE",n.Recommendations="RECOMMENDATIONS",n))(pn||{}),cl=(n=>(n.User="USER",n.Bot="BOT",n))(cl||{}),jt=(n=>(n.Worker="WORKER",n.Employer="EMPLOYER",n))(jt||{}),Mi=(n=>(n.NEW_APPLICATION="NEW_APPLICATION",n.NEW_JOB_MATCH="NEW_JOB_MATCH",n.APPLICATION_ACCEPTED="APPLICATION_ACCEPTED",n.APPLICATION_REJECTED="APPLICATION_REJECTED",n))(Mi||{});const ii=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Ui=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Ag=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),YL=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Qv=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Yv=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),JL=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),Uo=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.75 18l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 14.25l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 18l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),ga=({className:n="w-8 h-8"})=>f.jsx("div",{className:`flex items-center justify-center rounded-full bg-blue-500 text-white ${n}`,children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),u0=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),YN=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),XL=({type:n})=>{const e="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0";switch(n){case Mi.NEW_APPLICATION:return f.jsx("div",{className:`${e} bg-blue-100 text-blue-600`,children:f.jsx(ga,{className:"w-5 h-5 bg-transparent"})});case Mi.NEW_JOB_MATCH:return f.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:f.jsx(ii,{className:"w-5 h-5"})});case Mi.APPLICATION_ACCEPTED:return f.jsx("div",{className:`${e} bg-green-100 text-green-600`,children:f.jsx(u0,{className:"w-6 h-6"})});case Mi.APPLICATION_REJECTED:return f.jsx("div",{className:`${e} bg-red-100 text-red-600`,children:f.jsx(YN,{className:"w-6 h-6"})});default:return f.jsx("div",{className:`${e} bg-gray-100 text-gray-600`,children:f.jsx(ii,{className:"w-5 h-5"})})}},ZL=({notifications:n,onNotificationClick:e,onMarkAllAsRead:t,onClose:r})=>{const s=n.filter(i=>!i.isRead).length;return f.jsx("div",{className:"fixed inset-0 z-40",onClick:r,children:f.jsxs("div",{className:"absolute top-20 right-4 sm:right-6 lg:right-8 w-full max-w-sm bg-white rounded-lg shadow-2xl border border-gray-200 overflow-hidden animate-fade-in-down z-50",style:{animationDuration:"0.2s"},onClick:i=>i.stopPropagation(),children:[f.jsxs("div",{className:"p-4 flex items-center justify-between border-b",children:[f.jsx("h3",{className:"font-bold text-gray-800",children:"Thng bo"}),s>0&&f.jsx("button",{onClick:t,className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"nh du tt c l  c"})]}),f.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.length>0?n.map(i=>f.jsxs("div",{onClick:()=>e(i),className:`flex items-start gap-4 p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b ${i.isRead?"bg-white":"bg-indigo-50"}`,children:[f.jsx(XL,{type:i.type}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-700",children:i.message}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(i.createdAt).toLocaleString("vi-VN")})]}),!i.isRead&&f.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full mt-1 flex-shrink-0"})]},i.id)):f.jsx("div",{className:"p-10 text-center text-gray-500",children:f.jsx("p",{children:"Bn khng c thng bo no."})})})]})})},eM=()=>{};var bb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae=function(n,e){if(!n)throw Pu(e)},Pu=function(n){return new Error("Firebase Database ("+JN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},tM=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],h=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},h0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,h=s+2<n.length,p=h?n[s+2]:0,g=i>>2,y=(i&3)<<4|c>>4;let E=(c&15)<<2|p>>6,x=p&63;h||(x=64,a||(E=64)),r.push(t[g],t[y],t[E],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(XN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const y=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||p==null||y==null)throw new nM;const E=i<<2|c>>4;if(r.push(E),p!==64){const x=c<<4&240|p>>2;if(r.push(x),y!==64){const P=p<<6&192|y;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class nM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZN=function(n){const e=XN(n);return h0.encodeByteArray(e,!0)},Pm=function(n){return ZN(n).replace(/\./g,"")},kd=function(n){try{return h0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rM(n){return Rd(void 0,n)}function Rd(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!sM(t)||(n[t]=Rd(n[t],e[t]));return n}function sM(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM=()=>d0().__FIREBASE_DEFAULTS__,oM=()=>{if(typeof process>"u"||typeof bb>"u")return;const n=bb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},aM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&kd(n[1]);return e&&JSON.parse(e)},f0=()=>{try{return eM()||iM()||oM()||aM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},p0=()=>{var n;return(n=f0())==null?void 0:n.config},lM=n=>{var e;return(e=f0())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function m0(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Pm(JSON.stringify(t)),Pm(JSON.stringify(a)),""].join(".")}const cd={};function cM(){const n={prod:[],emulator:[]};for(const e of Object.keys(cd))cd[e]?n.emulator.push(e):n.prod.push(e);return n}function uM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Sb=!1;function g0(n,e){if(typeof window>"u"||typeof document>"u"||!_a(window.location.host)||cd[n]===e||cd[n]||Sb)return;cd[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",i=cM().prod.length>0;function a(){const E=document.getElementById(r);E&&E.remove()}function c(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function h(E,x){E.setAttribute("width","24"),E.setAttribute("id",x),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function p(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Sb=!0,a()},E}function g(E,x){E.setAttribute("id",x),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function y(){const E=uM(r),x=t("text"),P=document.getElementById(x)||document.createElement("span"),O=t("learnmore"),M=document.getElementById(O)||document.createElement("a"),X=t("preprendIcon"),W=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const Q=E.element;c(Q),g(M,O);const Y=p();h(W,X),Q.append(W,P,M,Y),document.body.appendChild(Q)}i?(P.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ut())}function Ng(){var e;const n=(e=f0())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hM(){return typeof window<"u"||tC()}function tC(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function dM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Cg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rC(){const n=Ut();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function fM(){return JN.NODE_ADMIN===!0}function sC(){return!Ng()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function iC(){return!Ng()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function wl(){try{return typeof indexedDB=="object"}catch{return!1}}function pM(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}function mM(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM="FirebaseError";class Un extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=gM,Object.setPrototypeOf(this,Un.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hi.prototype.create)}}class hi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?_M(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Un(s,c,r)}}function _M(n,e){return n.replace(yM,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const yM=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n){return JSON.parse(n)}function an(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=function(n){let e={},t={},r={},s="";try{const i=n.split(".");e=Pd(kd(i[0])||""),t=Pd(kd(i[1])||""),s=i[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:s}},vM=function(n){const e=oC(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},wM=function(n){const e=oC(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function El(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Dm(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Om(n,e,t){const r={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=e.call(t,n[s],s,n));return r}function Hi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Ab(i)&&Ab(a)){if(!Hi(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Ab(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ed(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let y=0;y<16;y++)r[y]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let y=0;y<16;y++)r[y]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let y=16;y<80;y++){const E=r[y-3]^r[y-8]^r[y-14]^r[y-16];r[y]=(E<<1|E>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4],p,g;for(let y=0;y<80;y++){y<40?y<20?(p=c^i&(a^c),g=1518500249):(p=i^a^c,g=1859775393):y<60?(p=i&a|c&(i|a),g=2400959708):(p=i^a^c,g=3395469782);const E=(s<<5|s>>>27)+p+h+g+r[y]&4294967295;h=c,c=a,a=(i<<30|i>>>2)&4294967295,i=s,s=E}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let s=0;const i=this.buf_;let a=this.inbuf_;for(;s<t;){if(a===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(i[a]=e.charCodeAt(s),++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}else for(;s<t;)if(i[a]=e[s],++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function aC(n,e){const t=new IM(n,e);return t.subscribe.bind(t)}class IM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");TM(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=fv),s.error===void 0&&(s.error=fv),s.complete===void 0&&(s.complete=fv);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fv(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Le=function(n,e,t,r){let s;if(r<e?s="at least "+e:r>t&&(s=t===0?"none":"no more than "+t),s){const i=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(i)}};function dr(n,e){return`${n} failed: ${e} argument `}function _n(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(dr(n,e)+"must be a valid function.")}function Nb(n,e,t,r){if(t&&(typeof t!="object"||t===null))throw new Error(dr(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,ae(r<n.length,"Surrogate pair missing trail surrogate.");const a=n.charCodeAt(r)-56320;s=65536+(i<<10)+a}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},kg=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n){return n&&n._delegate?n._delegate:n}class rn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new lr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SM(e))try{this.getOrInitializeService({instanceIdentifier:el})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=el){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=el){return this.instances.has(e)}getOptions(e=el){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bM(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=el){return this.component?this.component.multipleInstances?e:el:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bM(n){return n===el?void 0:n}function SM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Jv(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0=[];var Ge;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ge||(Ge={}));const lC={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},AM=Ge.INFO,NM={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},CM=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=NM[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Du{constructor(e){this.name=e,this._logLevel=AM,this._logHandler=CM,this._userLogHandler=null,v0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}function kM(n){v0.forEach(e=>{e.setLogLevel(n)})}function RM(n,e){for(const t of v0){let r=null;e&&e.level&&(r=lC[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,i,...a)=>{const c=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");i>=(r??s.logLevel)&&n({level:Ge[i].toLowerCase(),message:c,args:a,type:s.name})}}}const PM=(n,e)=>e.some(t=>n instanceof t);let Cb,kb;function DM(){return Cb||(Cb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OM(){return kb||(kb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cC=new WeakMap,Xv=new WeakMap,uC=new WeakMap,pv=new WeakMap,w0=new WeakMap;function LM(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Bi(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&cC.set(t,n)}).catch(()=>{}),w0.set(e,n),e}function MM(n){if(Xv.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Xv.set(n,e)}let Zv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Xv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||uC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Bi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function VM(n){Zv=n(Zv)}function jM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(mv(this),e,...t);return uC.set(r,e.sort?e.sort():[e]),Bi(r)}:OM().includes(n)?function(...e){return n.apply(mv(this),e),Bi(cC.get(this))}:function(...e){return Bi(n.apply(mv(this),e))}}function FM(n){return typeof n=="function"?jM(n):(n instanceof IDBTransaction&&MM(n),PM(n,DM())?new Proxy(n,Zv):n)}function Bi(n){if(n instanceof IDBRequest)return LM(n);if(pv.has(n))return pv.get(n);const e=FM(n);return e!==n&&(pv.set(n,e),w0.set(e,n)),e}const mv=n=>w0.get(n);function Ou(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=Bi(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Bi(a.result),h.oldVersion,h.newVersion,Bi(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{i&&h.addEventListener("close",()=>i()),s&&h.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}function Qc(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),Bi(t).then(()=>{})}const UM=["get","getKey","getAll","getAllKeys","count"],BM=["put","add","delete","clear"],gv=new Map;function Rb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(gv.get(e))return gv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=BM.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||UM.includes(t)))return;const i=async function(a,...c){const h=this.transaction(a,s?"readwrite":"readonly");let p=h.store;return r&&(p=p.index(c.shift())),(await Promise.all([p[t](...c),s&&h.done]))[0]};return gv.set(e,i),i}VM(n=>({...n,get:(e,t,r)=>Rb(e,t)||n.get(e,t,r),has:(e,t)=>!!Rb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if($M(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function $M(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lm="@firebase/app",ew="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=new Du("@firebase/app"),HM="@firebase/app-compat",WM="@firebase/analytics-compat",qM="@firebase/analytics",GM="@firebase/app-check-compat",KM="@firebase/app-check",QM="@firebase/auth",YM="@firebase/auth-compat",JM="@firebase/database",XM="@firebase/data-connect",ZM="@firebase/database-compat",e5="@firebase/functions",t5="@firebase/functions-compat",n5="@firebase/installations",r5="@firebase/installations-compat",s5="@firebase/messaging",i5="@firebase/messaging-compat",o5="@firebase/performance",a5="@firebase/performance-compat",l5="@firebase/remote-config",c5="@firebase/remote-config-compat",u5="@firebase/storage",h5="@firebase/storage-compat",d5="@firebase/firestore",f5="@firebase/ai",p5="@firebase/firestore-compat",m5="firebase",g5="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="[DEFAULT]",_5={[Lm]:"fire-core",[HM]:"fire-core-compat",[qM]:"fire-analytics",[WM]:"fire-analytics-compat",[KM]:"fire-app-check",[GM]:"fire-app-check-compat",[QM]:"fire-auth",[YM]:"fire-auth-compat",[JM]:"fire-rtdb",[XM]:"fire-data-connect",[ZM]:"fire-rtdb-compat",[e5]:"fire-fn",[t5]:"fire-fn-compat",[n5]:"fire-iid",[r5]:"fire-iid-compat",[s5]:"fire-fcm",[i5]:"fire-fcm-compat",[o5]:"fire-perf",[a5]:"fire-perf-compat",[l5]:"fire-rc",[c5]:"fire-rc-compat",[u5]:"fire-gcs",[h5]:"fire-gcs-compat",[d5]:"fire-fst",[p5]:"fire-fst-compat",[f5]:"fire-vertex","fire-js":"fire-js",[m5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=new Map,su=new Map,iu=new Map;function Dd(n,e){try{n.container.addComponent(e)}catch(t){Wi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function hC(n,e){n.container.addOrOverwriteComponent(e)}function fr(n){const e=n.name;if(iu.has(e))return Wi.debug(`There were multiple attempts to register component ${e}.`),!1;iu.set(e,n);for(const t of na.values())Dd(t,n);for(const t of su.values())Dd(t,n);return!0}function Rg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function y5(n,e,t=ta){Rg(n,e).clearInstance(t)}function E0(n){return n.options!==void 0}function dC(n){return E0(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function At(n){return n==null?!1:n.settings!==void 0}function v5(){iu.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dr=new hi("app","Firebase",w5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fC=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(n,e){const t=kd(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,i=new Date().getTime();s-i<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class E5 extends fC{constructor(e,t,r,s){const i=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,a={name:r,automaticDataCollectionEnabled:i};if(e.apiKey!==void 0)super(e,a,s);else{const c=e;super(c.options,a,s)}this._serverConfig={automaticDataCollectionEnabled:i,...t},this._serverConfig.authIdToken&&Pb(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Pb(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Cn(Lm,ew,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){T0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Dr.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=g5;function I0(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:ta,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Dr.create("bad-app-name",{appName:String(s)});if(t||(t=p0()),!t)throw Dr.create("no-options");const i=na.get(s);if(i){if(Hi(t,i.options)&&Hi(r,i.config))return i;throw Dr.create("duplicate-app",{appName:s})}const a=new y0(s);for(const h of iu.values())a.addComponent(h);const c=new fC(t,r,a);return na.set(s,c),c}function I5(n,e={}){if(hM()&&!tC())throw Dr.create("invalid-server-app-environment");let t,r=e||{};if(n&&(E0(n)?t=n.options:dC(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=p0()),!t)throw Dr.create("no-options");const s={...r,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const i=g=>[...g].reduce((y,E)=>Math.imul(31,y)+E.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Dr.create("finalization-registry-not-supported",{});const a=""+i(JSON.stringify(s)),c=su.get(a);if(c)return c.incRefCount(r.releaseOnDeref),c;const h=new y0(a);for(const g of iu.values())h.addComponent(g);const p=new E5(t,r,a,h);return su.set(a,p),p}function T5(n=ta){const e=na.get(n);if(!e&&n===ta&&p0())return I0();if(!e)throw Dr.create("no-app",{appName:n});return e}function x5(){return Array.from(na.values())}async function T0(n){let e=!1;const t=n.name;na.has(t)?(e=!0,na.delete(t)):su.has(t)&&n.decRefCount()<=0&&(su.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Cn(n,e,t){let r=_5[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wi.warn(a.join(" "));return}fr(new rn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function pC(n,e){if(n!==null&&typeof n!="function")throw Dr.create("invalid-log-argument");RM(n,e)}function mC(n){kM(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5="firebase-heartbeat-database",S5=1,Od="firebase-heartbeat-store";let _v=null;function gC(){return _v||(_v=Ou(b5,S5,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Od)}catch(t){console.warn(t)}}}}).catch(n=>{throw Dr.create("idb-open",{originalErrorMessage:n.message})})),_v}async function A5(n){try{const t=(await gC()).transaction(Od),r=await t.objectStore(Od).get(_C(n));return await t.done,r}catch(e){if(e instanceof Un)Wi.warn(e.message);else{const t=Dr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Wi.warn(t.message)}}}async function Db(n,e){try{const r=(await gC()).transaction(Od,"readwrite");await r.objectStore(Od).put(e,_C(n)),await r.done}catch(t){if(t instanceof Un)Wi.warn(t.message);else{const r=Dr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Wi.warn(r.message)}}}function _C(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5=1024,C5=30;class k5{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new P5(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ob();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>C5){const a=D5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Wi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ob(),{heartbeatsToSend:r,unsentEntries:s}=R5(this._heartbeatsCache.heartbeats),i=Pm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Wi.warn(t),""}}}function Ob(){return new Date().toISOString().substring(0,10)}function R5(n,e=N5){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Lb(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Lb(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class P5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wl()?pM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await A5(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Db(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Db(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Lb(n){return Pm(JSON.stringify({version:2,heartbeats:n})).length}function D5(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(n){fr(new rn("platform-logger",e=>new zM(e),"PRIVATE")),fr(new rn("heartbeat",e=>new k5(e),"PRIVATE")),Cn(Lm,ew,n),Cn(Lm,ew,"esm2020"),Cn("fire-js","")}O5("");const L5=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Un,SDK_VERSION:Ji,_DEFAULT_ENTRY_NAME:ta,_addComponent:Dd,_addOrOverwriteComponent:hC,_apps:na,_clearComponents:v5,_components:iu,_getProvider:Rg,_isFirebaseApp:E0,_isFirebaseServerApp:At,_isFirebaseServerAppSettings:dC,_registerComponent:fr,_removeServiceInstance:y5,_serverApps:su,deleteApp:T0,getApp:T5,getApps:x5,initializeApp:I0,initializeServerApp:I5,onLog:pC,registerVersion:Cn,setLogLevel:mC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e,t){this._delegate=e,this.firebase=t,Dd(e,new rn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),T0(this._delegate)))}_getService(e,t=ta){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ta){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Dd(this._delegate,e)}_addOrOverwriteComponent(e){hC(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V5={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Mb=new hi("app-compat","Firebase",V5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(n){const e={},t={__esModule:!0,initializeApp:i,app:s,registerVersion:Cn,setLogLevel:mC,onLog:pC,apps:null,SDK_VERSION:Ji,INTERNAL:{registerComponent:c,removeApp:r,useAsService:h,modularAPIs:L5}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(p){delete e[p]}function s(p){if(p=p||ta,!Or(e,p))throw Mb.create("no-app",{appName:p});return e[p]}s.App=n;function i(p,g={}){const y=I0(p,g);if(Or(e,y.name))return e[y.name];const E=new n(y,t);return e[y.name]=E,E}function a(){return Object.keys(e).map(p=>e[p])}function c(p){const g=p.name,y=g.replace("-compat","");if(fr(p)&&p.type==="PUBLIC"){const E=(x=s())=>{if(typeof x[y]!="function")throw Mb.create("invalid-app-argument",{appName:g});return x[y]()};p.serviceProps!==void 0&&Rd(E,p.serviceProps),t[y]=E,n.prototype[y]=function(...x){return this._getService.bind(this,g).apply(this,p.multipleInstances?x:[])}}return p.type==="PUBLIC"?t[y]:null}function h(p,g){return g==="serverAuth"?null:g}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(){const n=j5(M5);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:yC,extendNamespace:e,createSubscribe:aC,ErrorFactory:hi,deepExtend:Rd};function e(t){Rd(n,t)}return n}const F5=yC();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=new Du("@firebase/app-compat"),U5="@firebase/app-compat",B5="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(n){Cn(U5,B5,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=d0();if(n.firebase!==void 0){Vb.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Vb.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Qt=F5;z5();var $5="firebase",H5="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qt.registerVersion($5,H5,"app-compat");const jh={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Lc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function vC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const q5=W5,G5=vC,wC=new hi("auth","Firebase",vC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=new Du("@firebase/auth");function K5(n,...e){Mm.logLevel<=Ge.WARN&&Mm.warn(`Auth (${Ji}): ${n}`,...e)}function mm(n,...e){Mm.logLevel<=Ge.ERROR&&Mm.error(`Auth (${Ji}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(n,...e){throw b0(n,...e)}function ln(n,...e){return b0(n,...e)}function x0(n,e,t){const r={...G5(),[e]:t};return new hi("auth","Firebase",r).create(e,{appName:n.name})}function wn(n){return x0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Lu(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Rn(n,"argument-error"),x0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function b0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wC.create(n,...e)}function ie(n,e,...t){if(!n)throw b0(e,...t)}function Ks(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mm(e),new Error(e)}function ws(n,e){n||Ks(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function S0(){return jb()==="http:"||jb()==="https:"}function jb(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(S0()||nC()||"connection"in navigator)?navigator.onLine:!0}function Y5(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t){this.shortDelay=e,this.longDelay=t,ws(t>e,"Short delay should be less than long delay!"),this.isMobile=_0()||Cg()}get(){return Q5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n,e){ws(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ks("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ks("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ks("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Z5=new ff(3e4,6e4);function Ht(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Wt(n,e,t,r,s={}){return IC(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=$l({key:n.config.apiKey,...a}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:h,...i};return dM()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&_a(n.emulatorConfig.host)&&(p.credentials="include"),EC.fetch()(await TC(n,n.config.apiHost,t,c),p)})}async function IC(n,e,t){n._canInitEmulator=!1;const r={...J5,...e};try{const s=new tV(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw td(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[h,p]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw td(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw td(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw td(n,"user-disabled",a);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw x0(n,g,p);Rn(n,g)}}catch(s){if(s instanceof Un)throw s;Rn(n,"network-request-failed",{message:String(s)})}}async function Xi(n,e,t,r,s={}){const i=await Wt(n,e,t,r,s);return"mfaPendingCredential"in i&&Rn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function TC(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?A0(n.config,s):`${n.config.apiScheme}://${s}`;return X5.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function eV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class tV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ln(this.auth,"network-request-failed")),Z5.get())})}}function td(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ln(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(n){return n!==void 0&&n.getResponse!==void 0}function Ub(n){return n!==void 0&&n.enterprise!==void 0}class xC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return eV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nV(n){return(await Wt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function bC(n,e){return Wt(n,"GET","/v2/recaptchaConfig",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rV(n,e){return Wt(n,"POST","/v1/accounts:delete",e)}async function sV(n,e){return Wt(n,"POST","/v1/accounts:update",e)}async function Vm(n,e){return Wt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iV(n,e=!1){const t=ye(n),r=await t.getIdToken(e),s=Pg(r);ie(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ud(yv(s.auth_time)),issuedAtTime:ud(yv(s.iat)),expirationTime:ud(yv(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function yv(n){return Number(n)*1e3}function Pg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return mm("JWT malformed, contained fewer than 3 sections"),null;try{const s=kd(t);return s?JSON.parse(s):(mm("Failed to decode base64 JWT payload"),null)}catch(s){return mm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Bb(n){const e=Pg(n);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qi(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Un&&oV(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function oV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ud(this.lastLoginAt),this.creationTime=ud(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Md(n){var y;const e=n.auth,t=await n.getIdToken(),r=await qi(n,Vm(e,{idToken:t}));ie(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=(y=s.providerUserInfo)!=null&&y.length?SC(s.providerUserInfo):[],a=cV(n.providerData,i),c=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),p=c?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new tw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function lV(n){const e=ye(n);await Md(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cV(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function SC(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uV(n,e){const t=await IC(n,{},async()=>{const r=$l({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await TC(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:r};return n.emulatorConfig&&_a(n.emulatorConfig.host)&&(h.credentials="include"),EC.fetch()(a,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hV(n,e){return Wt(n,"POST","/v2/accounts:revokeToken",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Bb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ie(e.length!==0,"internal-error");const t=Bb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await uV(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new Yc;return r&&(ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(ie(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(ie(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yc,this.toJSON())}_performRefresh(){return Ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(n,e){ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ms{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new aV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new tw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await qi(this,this.stsTokenManager.getToken(this.auth,e));return ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return iV(this,e)}reload(){return lV(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ms({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Md(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(At(this.auth.app))return Promise.reject(wn(this.auth));const e=await this.getIdToken();return await qi(this,rV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:y,emailVerified:E,isAnonymous:x,providerData:P,stsTokenManager:O}=t;ie(y&&O,e,"internal-error");const M=Yc.fromJSON(this.name,O);ie(typeof y=="string",e,"internal-error"),Lo(r,e.name),Lo(s,e.name),ie(typeof E=="boolean",e,"internal-error"),ie(typeof x=="boolean",e,"internal-error"),Lo(i,e.name),Lo(a,e.name),Lo(c,e.name),Lo(h,e.name),Lo(p,e.name),Lo(g,e.name);const X=new ms({uid:y,auth:e,email:s,emailVerified:E,displayName:r,isAnonymous:x,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:M,createdAt:p,lastLoginAt:g});return P&&Array.isArray(P)&&(X.providerData=P.map(W=>({...W}))),h&&(X._redirectEventId=h),X}static async _fromIdTokenResponse(e,t,r=!1){const s=new Yc;s.updateFromServerResponse(t);const i=new ms({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Md(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ie(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?SC(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Yc;c.updateFromIdToken(r);const h=new ms({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new tw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(h,p),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=new Map;function Pr(n){ws(n instanceof Function,"Expected a class definition");let e=zb.get(n);return e?(ws(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,zb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}AC.type="NONE";const ou=AC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(n,e,t){return`firebase:${n}:${e}:${t}`}class Jc{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=gl(this.userKey,s.apiKey,i),this.fullPersistenceKey=gl("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Vm(this.auth,{idToken:e}).catch(()=>{});return t?ms._fromGetAccountInfoResponse(this.auth,t,e):null}return ms._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Jc(Pr(ou),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let i=s[0]||Pr(ou);const a=gl(r,e.config.apiKey,e.name);let c=null;for(const p of t)try{const g=await p._get(a);if(g){let y;if(typeof g=="string"){const E=await Vm(e,{idToken:g}).catch(()=>{});if(!E)break;y=await ms._fromGetAccountInfoResponse(e,E,g)}else y=ms._fromJSON(e,g);p!==i&&(c=y),i=p;break}}catch{}const h=s.filter(p=>p._shouldAllowMigration);return!i._shouldAllowMigration||!h.length?new Jc(i,e,r):(i=h[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async p=>{if(p!==i)try{await p._remove(a)}catch{}})),new Jc(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PC(e))return"Blackberry";if(DC(e))return"Webos";if(CC(e))return"Safari";if((e.includes("chrome/")||kC(e))&&!e.includes("edge/"))return"Chrome";if(pf(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function NC(n=Ut()){return/firefox\//i.test(n)}function CC(n=Ut()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kC(n=Ut()){return/crios\//i.test(n)}function RC(n=Ut()){return/iemobile/i.test(n)}function pf(n=Ut()){return/android/i.test(n)}function PC(n=Ut()){return/blackberry/i.test(n)}function DC(n=Ut()){return/webos/i.test(n)}function mf(n=Ut()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function dV(n=Ut()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function fV(n=Ut()){var e;return mf(n)&&!!((e=window.navigator)!=null&&e.standalone)}function pV(){return rC()&&document.documentMode===10}function OC(n=Ut()){return mf(n)||pf(n)||DC(n)||PC(n)||/windows phone/i.test(n)||RC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(n,e=[]){let t;switch(n){case"Browser":t=$b(Ut());break;case"Worker":t=`${$b(Ut())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ji}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const h=e(i);a(h)}catch(h){c(h)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gV(n,e={}){return Wt(n,"GET","/v2/passwordPolicy",Ht(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=6;class yV{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??_V,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Hb(this),this.idTokenSubscription=new Hb(this),this.beforeStateQueue=new mV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Pr(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Jc.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Vm(this,{idToken:e}),r=await ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(At(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=r==null?void 0:r._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===c)&&(h!=null&&h.user)&&(r=h.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Md(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Y5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(At(this.app))return Promise.reject(wn(this));const t=e?ye(e):null;return t&&ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return At(this.app)?Promise.reject(wn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return At(this.app)?Promise.reject(wn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Pr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gV(this),t=new yV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await hV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Pr(e)||this._popupRedirectResolver;ie(t,this,"argument-error"),this.redirectPersistenceManager=await Jc.create(this,[Pr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,s);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(At(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&K5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Bt(n){return ye(n)}class Hb{constructor(e){this.auth=e,this.observer=null,this.addObserver=aC(t=>this.observer=t)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wV(n){gf=n}function N0(n){return gf.loadJS(n)}function EV(){return gf.recaptchaV2Script}function IV(){return gf.recaptchaEnterpriseScript}function TV(){return gf.gapiScript}function MC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV=500,bV=6e4,rm=1e12;class SV{constructor(e){this.auth=e,this.counter=rm,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new CV(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||rm;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||rm;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||rm;return(r=this._widgets.get(t))==null||r.execute(),""}}class AV{constructor(){this.enterprise=new NV}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class NV{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CV{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ie(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=kV(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},bV)},xV))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function kV(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const RV="recaptcha-enterprise",hd="NO_RECAPTCHA";class VC{constructor(e){this.type=RV,this.auth=Bt(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,c)=>{bC(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const p=new xC(h);return i.tenantId==null?i._agentRecaptchaConfig=p:i._tenantRecaptchaConfigs[i.tenantId]=p,a(p.siteKey)}}).catch(h=>{c(h)})})}function s(i,a,c){const h=window.grecaptcha;Ub(h)?h.enterprise.ready(()=>{h.enterprise.execute(i,{action:e}).then(p=>{a(p)}).catch(()=>{a(hd)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AV().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{r(this.auth).then(c=>{if(!t&&Ub(window.grecaptcha))s(c,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=IV();h.length!==0&&(h+=c),N0(h).then(()=>{s(c,i,a)}).catch(p=>{a(p)})}}).catch(c=>{a(c)})})}}async function Fh(n,e,t,r=!1,s=!1){const i=new VC(n);let a;if(s)a=hd;else try{a=await i.verify(t)}catch{a=await i.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,p=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:p,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Ko(n,e,t,r,s){var i,a;if(s==="EMAIL_PASSWORD_PROVIDER")if((i=n._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Fh(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await Fh(n,e,t,t==="getOobCode");return r(n,h)}else return Promise.reject(c)});else if(s==="PHONE_PROVIDER")if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("PHONE_PROVIDER")){const c=await Fh(n,e,t);return r(n,c).catch(async h=>{var p;if(((p=n._getRecaptchaConfig())==null?void 0:p.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(h.code==="auth/missing-recaptcha-token"||h.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const g=await Fh(n,e,t,!1,!0);return r(n,g)}return Promise.reject(h)})}else{const c=await Fh(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(s+" provider is not supported.")}async function PV(n){const e=Bt(n),t=await bC(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new xC(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new VC(e).verify()}function DV(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Pr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function OV(n,e,t){const r=Bt(n);ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=jC(e),{host:a,port:c}=LV(e),h=c===null?"":`:${c}`,p={url:`${i}//${a}${h}/`},g=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ie(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ie(Hi(p,r.config.emulator)&&Hi(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,_a(a)?(m0(`${i}//${a}${h}`),g0("Auth",!0)):s||MV()}function jC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function LV(n){const e=jC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Wb(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Wb(a)}}}function Wb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ks("not implemented")}_getIdTokenResponse(e){return Ks("not implemented")}_linkToIdToken(e,t){return Ks("not implemented")}_getReauthenticationResolver(e){return Ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FC(n,e){return Wt(n,"POST","/v1/accounts:resetPassword",Ht(n,e))}async function VV(n,e){return Wt(n,"POST","/v1/accounts:update",e)}async function jV(n,e){return Wt(n,"POST","/v1/accounts:signUp",e)}async function FV(n,e){return Wt(n,"POST","/v1/accounts:update",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UV(n,e){return Xi(n,"POST","/v1/accounts:signInWithPassword",Ht(n,e))}async function Dg(n,e){return Wt(n,"POST","/v1/accounts:sendOobCode",Ht(n,e))}async function BV(n,e){return Dg(n,e)}async function zV(n,e){return Dg(n,e)}async function $V(n,e){return Dg(n,e)}async function HV(n,e){return Dg(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WV(n,e){return Xi(n,"POST","/v1/accounts:signInWithEmailLink",Ht(n,e))}async function qV(n,e){return Xi(n,"POST","/v1/accounts:signInWithEmailLink",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd extends Mu{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Vd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Vd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ko(e,t,"signInWithPassword",UV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return WV(e,{email:this._email,oobCode:this._password});default:Rn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ko(e,r,"signUpPassword",jV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return qV(e,{idToken:t,email:this._email,oobCode:this._password});default:Rn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zi(n,e){return Xi(n,"POST","/v1/accounts:signInWithIdp",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV="http://localhost";class oi extends Mu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new oi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new oi(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return zi(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,zi(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,zi(e,t)}buildRequest(){const e={requestUri:GV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$l(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qb(n,e){return Wt(n,"POST","/v1/accounts:sendVerificationCode",Ht(n,e))}async function KV(n,e){return Xi(n,"POST","/v1/accounts:signInWithPhoneNumber",Ht(n,e))}async function QV(n,e){const t=await Xi(n,"POST","/v1/accounts:signInWithPhoneNumber",Ht(n,e));if(t.temporaryProof)throw td(n,"account-exists-with-different-credential",t);return t}const YV={USER_NOT_FOUND:"user-not-found"};async function JV(n,e){const t={...e,operation:"REAUTH"};return Xi(n,"POST","/v1/accounts:signInWithPhoneNumber",Ht(n,t),YV)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Mu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new _l({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new _l({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return KV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return QV(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return JV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new _l({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZV(n){const e=Kc(ed(n)).link,t=e?Kc(ed(e)).deep_link_id:null,r=Kc(ed(n)).deep_link_id;return(r?Kc(ed(r)).link:null)||r||t||e||n}class Og{constructor(e){const t=Kc(ed(e)),r=t.apiKey??null,s=t.oobCode??null,i=XV(t.mode??null);ie(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=ZV(e);try{return new Og(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.providerId=ya.PROVIDER_ID}static credential(e,t){return Vd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Og.parseLink(t);return ie(r,"argument-error"),Vd._fromEmailAndCode(e,r.code,r.tenantId)}}ya.PROVIDER_ID="password";ya.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ya.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends Zi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Xc extends Vu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ie("providerId"in t&&"signInMethod"in t,"argument-error"),oi._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return ie(e.idToken||e.accessToken,"argument-error"),oi._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Xc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Xc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:a,providerId:c}=e;if(!r&&!s&&!t&&!i||!c)return null;try{return new Xc(c)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends Vu{constructor(){super("facebook.com")}static credential(e){return oi._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hs.credential(e.oauthAccessToken)}catch{return null}}}Hs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return oi._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ws.credential(t,r)}catch{return null}}}Ws.GOOGLE_SIGN_IN_METHOD="google.com";Ws.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs extends Vu{constructor(){super("github.com")}static credential(e){return oi._fromParams({providerId:qs.PROVIDER_ID,signInMethod:qs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qs.credentialFromTaggedObject(e)}static credentialFromError(e){return qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qs.credential(e.oauthAccessToken)}catch{return null}}}qs.GITHUB_SIGN_IN_METHOD="github.com";qs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="http://localhost";class au extends Mu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return zi(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,zi(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,zi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=t;return!r||!s||!i||r!==s?null:new au(r,i)}static _create(e,t){return new au(e,t)}buildRequest(){return{requestUri:e4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4="saml.";class jm extends Zi{constructor(e){ie(e.startsWith(t4),"argument-error"),super(e)}static credentialFromResult(e){return jm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return jm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=au.fromJSON(e);return ie(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return au._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs extends Vu{constructor(){super("twitter.com")}static credential(e,t){return oi._fromParams({providerId:Gs.PROVIDER_ID,signInMethod:Gs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Gs.credentialFromTaggedObject(e)}static credentialFromError(e){return Gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Gs.credential(t,r)}catch{return null}}}Gs.TWITTER_SIGN_IN_METHOD="twitter.com";Gs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n,e){return Xi(n,"POST","/v1/accounts:signUp",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ms._fromIdTokenResponse(e,r,s),a=Gb(r);return new Zr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Gb(r);return new Zr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Gb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n4(n){var s;if(At(n.app))return Promise.reject(wn(n));const e=Bt(n);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new Zr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await UC(e,{returnSecureToken:!0}),r=await Zr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm extends Un{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Fm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Fm(e,t,r,s)}}function BC(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Fm._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(n,e){const t=ye(n);await Lg(!0,t,e);const{providerUserInfo:r}=await sV(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=zC(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function C0(n,e,t=!1){const r=await qi(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Zr._forOperation(n,"link",r)}async function Lg(n,e,t){await Md(e);const r=zC(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ie(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $C(n,e,t=!1){const{auth:r}=n;if(At(r.app))return Promise.reject(wn(r));const s="reauthenticate";try{const i=await qi(n,BC(r,s,e,n),t);ie(i.idToken,r,"internal-error");const a=Pg(i.idToken);ie(a,r,"internal-error");const{sub:c}=a;return ie(n.uid===c,r,"user-mismatch"),Zr._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Rn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(n,e,t=!1){if(At(n.app))return Promise.reject(wn(n));const r="signIn",s=await BC(n,r,e),i=await Zr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function Mg(n,e){return HC(Bt(n),e)}async function WC(n,e){const t=ye(n);return await Lg(!1,t,e.providerId),C0(t,e)}async function qC(n,e){return $C(ye(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s4(n,e){return Xi(n,"POST","/v1/accounts:signInWithCustomToken",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i4(n,e){if(At(n.app))return Promise.reject(wn(n));const t=Bt(n),r=await s4(t,{token:e,returnSecureToken:!0}),s=await Zr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?k0._fromServerResponse(e,t):"totpInfo"in t?R0._fromServerResponse(e,t):Rn(e,"internal-error")}}class k0 extends _f{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new k0(t)}}class R0 extends _f{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new R0(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(n,e,t){var r;ie(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),ie(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),ie(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ie(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ie(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P0(n){const e=Bt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function o4(n,e,t){const r=Bt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Vg(r,s,t),await Ko(r,s,"getOobCode",zV,"EMAIL_PASSWORD_PROVIDER")}async function a4(n,e,t){await FC(ye(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&P0(n),r})}async function l4(n,e){await FV(ye(n),{oobCode:e})}async function GC(n,e){const t=ye(n),r=await FC(t,{oobCode:e}),s=r.requestType;switch(ie(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ie(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ie(r.mfaInfo,t,"internal-error");default:ie(r.email,t,"internal-error")}let i=null;return r.mfaInfo&&(i=_f._fromServerResponse(Bt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function c4(n,e){const{data:t}=await GC(ye(n),e);return t.email}async function u4(n,e,t){if(At(n.app))return Promise.reject(wn(n));const r=Bt(n),a=await Ko(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",UC,"EMAIL_PASSWORD_PROVIDER").catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&P0(n),h}),c=await Zr._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c}function h4(n,e,t){return At(n.app)?Promise.reject(wn(n)):Mg(ye(n),ya.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&P0(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(n,e,t){const r=Bt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(a,c){ie(c.handleCodeInApp,r,"argument-error"),c&&Vg(r,a,c)}i(s,t),await Ko(r,s,"getOobCode",$V,"EMAIL_PASSWORD_PROVIDER")}function f4(n,e){const t=Og.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function p4(n,e,t){if(At(n.app))return Promise.reject(wn(n));const r=ye(n),s=ya.credentialWithLink(e,t||Ld());return ie(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Mg(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m4(n,e){return Wt(n,"POST","/v1/accounts:createAuthUri",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g4(n,e){const t=S0()?Ld():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await m4(ye(n),r);return s||[]}async function _4(n,e){const t=ye(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Vg(t.auth,s,e);const{email:i}=await BV(t.auth,s);i!==n.email&&await n.reload()}async function y4(n,e,t){const r=ye(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Vg(r.auth,i,t);const{email:a}=await HV(r.auth,i);a!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v4(n,e){return Wt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w4(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=ye(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await qi(r,v4(r.auth,i));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const c=r.providerData.find(({providerId:h})=>h==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function E4(n,e){const t=ye(n);return At(t.auth.app)?Promise.reject(wn(t.auth)):KC(t,e,null)}function I4(n,e){return KC(ye(n),null,e)}async function KC(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const a=await qi(n,VV(r,i));await n._updateTokensIfNecessary(a,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(n){var s,i;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const a=(i=(s=Pg(n.idToken))==null?void 0:s.firebase)==null?void 0:i.sign_in_provider;if(a){const c=a!=="anonymous"&&a!=="custom"?a:null;return new Zc(r,c)}}if(!e)return null;switch(e){case"facebook.com":return new x4(r,t);case"github.com":return new b4(r,t);case"google.com":return new S4(r,t);case"twitter.com":return new A4(r,t,n.screenName||null);case"custom":case"anonymous":return new Zc(r,null);default:return new Zc(r,e,t)}}class Zc{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class QC extends Zc{constructor(e,t,r,s){super(e,t,r),this.username=s}}class x4 extends Zc{constructor(e,t){super(e,"facebook.com",t)}}class b4 extends QC{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class S4 extends Zc{constructor(e,t){super(e,"google.com",t)}}class A4 extends QC{constructor(e,t,r){super(e,"twitter.com",t,r)}}function N4(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:T4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new ul("enroll",e,t)}static _fromMfaPendingCredential(e){return new ul("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return ul._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return ul._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Bt(e),s=t.customData._serverResponse,i=(s.mfaInfo||[]).map(c=>_f._fromServerResponse(r,c));ie(s.mfaPendingCredential,r,"internal-error");const a=ul._fromMfaPendingCredential(s.mfaPendingCredential);return new D0(a,i,async c=>{const h=await c._process(r,a);delete s.mfaInfo,delete s.mfaPendingCredential;const p={...s,idToken:h.idToken,refreshToken:h.refreshToken};switch(t.operationType){case"signIn":const g=await Zr._fromIdTokenResponse(r,t.operationType,p);return await r._updateCurrentUser(g.user),g;case"reauthenticate":return ie(t.user,r,"internal-error"),Zr._forOperation(t.user,t.operationType,p);default:Rn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function C4(n,e){var s;const t=ye(n),r=e;return ie(e.customData.operationType,t,"argument-error"),ie((s=r.customData._serverResponse)==null?void 0:s.mfaPendingCredential,t,"argument-error"),D0._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(n,e){return Wt(n,"POST","/v2/accounts/mfaEnrollment:start",Ht(n,e))}function k4(n,e){return Wt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ht(n,e))}function R4(n,e){return Wt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ht(n,e))}class O0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>_f._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new O0(e)}async getSession(){return ul._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,s=await this.getSession(),i=await qi(this.user,r._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await qi(this.user,R4(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const vv=new WeakMap;function P4(n){const e=ye(n);return vv.has(e)||vv.set(e,O0._fromUser(e)),vv.get(e)}const Um="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Um,"1"),this.storage.removeItem(Um),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=1e3,O4=10;class JC extends YC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,h)=>{this.notifyListeners(a,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);pV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,O4):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},D4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JC.type="LOCAL";const L0=JC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC extends YC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XC.type="SESSION";const Il=XC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new jg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async p=>p(t.origin,i)),h=await L4(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,h)=>{const p=yf("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(y){const E=y;if(E.data.eventId===p)switch(E.data.status){case"ack":clearTimeout(g),i=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(E.data.response);break;default:clearTimeout(g),clearTimeout(i),h(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(){return window}function V4(n){tn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(){return typeof tn().WorkerGlobalScope<"u"&&typeof tn().importScripts=="function"}async function j4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function F4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function U4(){return M0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="firebaseLocalStorageDb",B4=1,Bm="firebaseLocalStorage",ek="fbase_key";class vf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fg(n,e){return n.transaction([Bm],e?"readwrite":"readonly").objectStore(Bm)}function z4(){const n=indexedDB.deleteDatabase(ZC);return new vf(n).toPromise()}function nw(){const n=indexedDB.open(ZC,B4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Bm,{keyPath:ek})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Bm)?e(r):(r.close(),await z4(),e(await nw()))})})}async function Qb(n,e,t){const r=Fg(n,!0).put({[ek]:e,value:t});return new vf(r).toPromise()}async function $4(n,e){const t=Fg(n,!1).get(e),r=await new vf(t).toPromise();return r===void 0?null:r.value}function Yb(n,e){const t=Fg(n,!0).delete(e);return new vf(t).toPromise()}const H4=800,W4=3;class tk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>W4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return M0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jg._getInstance(U4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await j4(),!this.activeServiceWorker)return;this.sender=new M4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||F4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nw();return await Qb(e,Um,"1"),await Yb(e,Um),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qb(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>$4(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Yb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Fg(s,!1).getAll();return new vf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tk.type="LOCAL";const jd=tk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(n,e){return Wt(n,"POST","/v2/accounts/mfaSignIn:start",Ht(n,e))}function q4(n,e){return Wt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ht(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=MC("rcb"),G4=new ff(3e4,6e4);class K4{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=tn().grecaptcha)!=null&&e.render)}load(e,t=""){return ie(Q4(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Fb(tn().grecaptcha)?Promise.resolve(tn().grecaptcha):new Promise((r,s)=>{const i=tn().setTimeout(()=>{s(ln(e,"network-request-failed"))},G4.get());tn()[wv]=()=>{tn().clearTimeout(i),delete tn()[wv];const c=tn().grecaptcha;if(!c||!Fb(c)){s(ln(e,"internal-error"));return}const h=c.render;c.render=(p,g)=>{const y=h(p,g);return this.counter++,y},this.hostLanguage=t,r(c)};const a=`${EV()}?${$l({onload:wv,render:"explicit",hl:t})}`;N0(a).catch(()=>{clearTimeout(i),s(ln(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=tn().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Q4(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class Y4{async load(e){return new SV(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd="recaptcha",J4={theme:"light",type:"image"};let X4=class{constructor(e,t,r={...J4}){this.parameters=r,this.type=dd,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Bt(e),this.isInvisible=this.parameters.size==="invisible",ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ie(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Y4:new K4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=a=>{a&&(this.tokenChangeListeners.delete(i),s(a))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ie(!this.parameters.sitekey,this.auth,"argument-error"),ie(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=tn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ie(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ie(S0()&&!M0(),this.auth,"internal-error"),await Z4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await nV(this.auth);ie(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ie(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function Z4(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=_l._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function ej(n,e,t){if(At(n.app))return Promise.reject(wn(n));const r=Bt(n),s=await Ug(r,e,ye(t));return new V0(s,i=>Mg(r,i))}async function tj(n,e,t){const r=ye(n);await Lg(!1,r,"phone");const s=await Ug(r.auth,e,ye(t));return new V0(s,i=>WC(r,i))}async function nj(n,e,t){const r=ye(n);if(At(r.auth.app))return Promise.reject(wn(r.auth));const s=await Ug(r.auth,e,ye(t));return new V0(s,i=>qC(r,i))}async function Ug(n,e,t){var r;if(!n._getRecaptchaConfig())try{await PV(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const i=s.session;if("phoneNumber"in s){ie(i.type==="enroll",n,"internal-error");const a={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Ko(n,a,"mfaSmsEnrollment",async(g,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===hd){ie((t==null?void 0:t.type)===dd,g,"argument-error");const E=await Ev(g,y,t);return Kb(g,E)}return Kb(g,y)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).phoneSessionInfo.sessionInfo}else{ie(i.type==="signin",n,"internal-error");const a=((r=s.multiFactorHint)==null?void 0:r.uid)||s.multiFactorUid;ie(a,n,"missing-multi-factor-info");const c={mfaPendingCredential:i.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Ko(n,c,"mfaSmsSignIn",async(y,E)=>{if(E.phoneSignInInfo.captchaResponse===hd){ie((t==null?void 0:t.type)===dd,y,"argument-error");const x=await Ev(y,E,t);return Jb(y,x)}return Jb(y,E)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Ko(n,i,"sendVerificationCode",async(p,g)=>{if(g.captchaResponse===hd){ie((t==null?void 0:t.type)===dd,p,"argument-error");const y=await Ev(p,g,t);return qb(p,y)}return qb(p,g)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).sessionInfo}}finally{t==null||t._reset()}}async function rj(n,e){const t=ye(n);if(At(t.auth.app))return Promise.reject(wn(t.auth));await C0(t,e)}async function Ev(n,e,t){ie(t.type===dd,n,"argument-error");const r=await t.verify();ie(typeof r=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const i=s.phoneEnrollmentInfo.phoneNumber,a=s.phoneEnrollmentInfo.captchaResponse,c=s.phoneEnrollmentInfo.clientType,h=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:i,recaptchaToken:r,captchaResponse:a,clientType:c,recaptchaVersion:h}}),s}else if("phoneSignInInfo"in s){const i=s.phoneSignInInfo.captchaResponse,a=s.phoneSignInInfo.clientType,c=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:i,clientType:a,recaptchaVersion:c}}),s}else return Object.assign(s,{recaptchaToken:r}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl=class gm{constructor(e){this.providerId=gm.PROVIDER_ID,this.auth=Bt(e)}verifyPhoneNumber(e,t){return Ug(this.auth,e,ye(t))}static credential(e,t){return _l._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gm.credentialFromTaggedObject(t)}static credentialFromError(e){return gm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?_l._fromTokenResponse(t,r):null}};Tl.PROVIDER_ID="phone";Tl.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(n,e){return e?Pr(e):(ie(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0 extends Mu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return zi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return zi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sj(n){return HC(n.auth,new j0(n),n.bypassAuthState)}function ij(n){const{auth:e,user:t}=n;return ie(t,e,"internal-error"),$C(t,new j0(n),n.bypassAuthState)}async function oj(n){const{auth:e,user:t}=n;return ie(t,e,"internal-error"),C0(t,new j0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sj;case"linkViaPopup":case"linkViaRedirect":return oj;case"reauthViaPopup":case"reauthViaRedirect":return ij;default:Rn(this.auth,"internal-error")}}resolve(e){ws(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ws(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj=new ff(2e3,1e4);async function lj(n,e,t){if(At(n.app))return Promise.reject(ln(n,"operation-not-supported-in-this-environment"));const r=Bt(n);Lu(n,e,Zi);const s=Hl(r,t);return new Vi(r,"signInViaPopup",e,s).executeNotNull()}async function cj(n,e,t){const r=ye(n);if(At(r.auth.app))return Promise.reject(ln(r.auth,"operation-not-supported-in-this-environment"));Lu(r.auth,e,Zi);const s=Hl(r.auth,t);return new Vi(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function uj(n,e,t){const r=ye(n);Lu(r.auth,e,Zi);const s=Hl(r.auth,t);return new Vi(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Vi extends nk{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Vi.currentPopupAction&&Vi.currentPopupAction.cancel(),Vi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ie(e,this.auth,"internal-error"),e}async onExecution(){ws(this.filter.length===1,"Popup operations only handle one event");const e=yf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ln(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ln(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ln(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,aj.get())};e()}}Vi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj="pendingRedirect",fd=new Map;class dj extends nk{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=fd.get(this.auth._key());if(!e){try{const r=await fj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}fd.set(this.auth._key(),e)}return this.bypassAuthState||fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fj(n,e){const t=sk(e),r=rk(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function F0(n,e){return rk(n)._set(sk(e),"true")}function pj(){fd.clear()}function U0(n,e){fd.set(n._key(),e)}function rk(n){return Pr(n._redirectPersistence)}function sk(n){return gl(hj,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(n,e,t){return gj(n,e,t)}async function gj(n,e,t){if(At(n.app))return Promise.reject(wn(n));const r=Bt(n);Lu(n,e,Zi),await r._initializationPromise;const s=Hl(r,t);return await F0(s,r),s._openRedirect(r,e,"signInViaRedirect")}function _j(n,e,t){return yj(n,e,t)}async function yj(n,e,t){const r=ye(n);if(Lu(r.auth,e,Zi),At(r.auth.app))return Promise.reject(wn(r.auth));await r.auth._initializationPromise;const s=Hl(r.auth,t);await F0(s,r.auth);const i=await ik(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function vj(n,e,t){return wj(n,e,t)}async function wj(n,e,t){const r=ye(n);Lu(r.auth,e,Zi),await r.auth._initializationPromise;const s=Hl(r.auth,t);await Lg(!1,r,e.providerId),await F0(s,r.auth);const i=await ik(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function Ej(n,e){return await Bt(n)._initializationPromise,Bg(n,e,!1)}async function Bg(n,e,t=!1){if(At(n.app))return Promise.reject(wn(n));const r=Bt(n),s=Hl(r,e),a=await new dj(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function ik(n){const e=yf(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij=600*1e3;class ok{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Tj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ak(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(ln(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ij&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xb(e))}saveEventToCache(e){this.cachedEventUids.add(Xb(e)),this.lastProcessedEventTime=Date.now()}}function Xb(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ak({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Tj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ak(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lk(n,e={}){return Wt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bj=/^https?/;async function Sj(n){if(n.config.emulator)return;const{authorizedDomains:e}=await lk(n);for(const t of e)try{if(Aj(t))return}catch{}Rn(n,"unauthorized-domain")}function Aj(n){const e=Ld(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!bj.test(t))return!1;if(xj.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=new ff(3e4,6e4);function Zb(){const n=tn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Cj(n){return new Promise((e,t)=>{var s,i,a;function r(){Zb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zb(),t(ln(n,"network-request-failed"))},timeout:Nj.get()})}if((i=(s=tn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=tn().gapi)!=null&&a.load)r();else{const c=MC("iframefcb");return tn()[c]=()=>{gapi.load?r():t(ln(n,"network-request-failed"))},N0(`${TV()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw _m=null,e})}let _m=null;function kj(n){return _m=_m||Cj(n),_m}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new ff(5e3,15e3),Pj="__/auth/iframe",Dj="emulator/auth/iframe",Oj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Mj(n){const e=n.config;ie(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?A0(e,Dj):`https://${n.config.authDomain}/${Pj}`,r={apiKey:e.apiKey,appName:n.name,v:Ji},s=Lj.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${$l(r).slice(1)}`}async function Vj(n){const e=await kj(n),t=tn().gapi;return ie(t,n,"internal-error"),e.open({where:document.body,url:Mj(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Oj,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ln(n,"network-request-failed"),c=tn().setTimeout(()=>{i(a)},Rj.get());function h(){tn().clearTimeout(c),s(r)}r.ping(h).then(h,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Fj=500,Uj=600,Bj="_blank",zj="http://localhost";class eS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $j(n,e,t,r=Fj,s=Uj){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const h={...jj,width:r.toString(),height:s.toString(),top:i,left:a},p=Ut().toLowerCase();t&&(c=kC(p)?Bj:t),NC(p)&&(e=e||zj,h.scrollbars="yes");const g=Object.entries(h).reduce((E,[x,P])=>`${E}${x}=${P},`,"");if(fV(p)&&c!=="_self")return Hj(e||"",c),new eS(null);const y=window.open(e||"",c,g);ie(y,n,"popup-blocked");try{y.focus()}catch{}return new eS(y)}function Hj(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj="__/auth/handler",qj="emulator/auth/handler",Gj=encodeURIComponent("fac");async function rw(n,e,t,r,s,i){ie(n.config.authDomain,n,"auth-domain-config-required"),ie(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ji,eventId:s};if(e instanceof Zi){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Dm(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries(i||{}))a[g]=y}if(e instanceof Vu){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(a.scopes=g.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const g of Object.keys(c))c[g]===void 0&&delete c[g];const h=await n._getAppCheckToken(),p=h?`#${Gj}=${encodeURIComponent(h)}`:"";return`${Kj(n)}?${$l(c).slice(1)}${p}`}function Kj({config:n}){return n.emulator?A0(n,qj):`https://${n.authDomain}/${Wj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="webStorageSupport";class Qj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Il,this._completeRedirectFn=Bg,this._overrideRedirectResult=U0}async _openPopup(e,t,r,s){var a;ws((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await rw(e,t,r,Ld(),s);return $j(e,i,yf())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await rw(e,t,r,Ld(),s);return V4(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ws(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Vj(e),r=new ok(e);return t.register("authEvent",s=>(ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Iv,{type:Iv},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Iv];i!==void 0&&t(!!i),Rn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Sj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return OC()||CC()||mf()}}const Yj=Qj;class Jj{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ks("unexpected MultiFactorSessionType")}}}class B0 extends Jj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new B0(e)}_finalizeEnroll(e,t,r){return k4(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return q4(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ck{constructor(){}static assertion(e){return B0._fromCredential(e)}}ck.FACTOR_ID="phone";var tS="@firebase/auth",nS="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function e3(n){fr(new rn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LC(n)},p=new vV(r,s,i,h);return DV(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),fr(new rn("auth-internal",e=>{const t=Bt(e.getProvider("auth").getImmediate());return(r=>new Xj(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cn(tS,nS,Zj(n)),Cn(tS,nS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=300;lM("authIdTokenMaxAge");function n3(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}wV({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ln("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",n3().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});e3("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=2e3;async function s3(n,e,t){const{BuildInfo:r}=xl();ws(e.sessionId,"AuthEvent did not contain a session ID");const s=await c3(e.sessionId),i={};return mf()?i.ibi=r.packageName:pf()?i.apn=r.packageName:Rn(n,"operation-not-supported-in-this-environment"),r.displayName&&(i.appDisplayName=r.displayName),i.sessionId=s,rw(n,t,e.type,void 0,e.eventId??void 0,i)}async function i3(n){const{BuildInfo:e}=xl(),t={};mf()?t.iosBundleId=e.packageName:pf()?t.androidPackageName=e.packageName:Rn(n,"operation-not-supported-in-this-environment"),await lk(n,t)}function o3(n){const{cordova:e}=xl();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,dV()?"_blank":"_system","location=yes"),t(s)})})}async function a3(n,e,t){const{cordova:r}=xl();let s=()=>{};try{await new Promise((i,a)=>{let c=null;function h(){var E;i();const y=(E=r.plugins.browsertab)==null?void 0:E.close;typeof y=="function"&&y(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function p(){c||(c=window.setTimeout(()=>{a(ln(n,"redirect-cancelled-by-user"))},r3))}function g(){(document==null?void 0:document.visibilityState)==="visible"&&p()}e.addPassiveListener(h),document.addEventListener("resume",p,!1),pf()&&document.addEventListener("visibilitychange",g,!1),s=()=>{e.removePassiveListener(h),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",g,!1),c&&window.clearTimeout(c)}})}finally{s()}}function l3(n){var t,r,s,i,a,c,h,p,g,y;const e=xl();ie(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ie(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ie(typeof((a=(i=(s=e==null?void 0:e.cordova)==null?void 0:s.plugins)==null?void 0:i.browsertab)==null?void 0:a.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ie(typeof((p=(h=(c=e==null?void 0:e.cordova)==null?void 0:c.plugins)==null?void 0:h.browsertab)==null?void 0:p.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ie(typeof((y=(g=e==null?void 0:e.cordova)==null?void 0:g.InAppBrowser)==null?void 0:y.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function c3(n){const e=u3(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function u3(n){if(ws(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=20;class d3 extends ok{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function f3(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:g3(),postBody:null,tenantId:n.tenantId,error:ln(n,"no-auth-event")}}function p3(n,e){return sw()._set(iw(n),e)}async function rS(n){const e=await sw()._get(iw(n));return e&&await sw()._remove(iw(n)),e}function m3(n,e){var r,s;const t=y3(e);if(t.includes("/__/auth/callback")){const i=ym(t),a=i.firebaseError?_3(decodeURIComponent(i.firebaseError)):null,c=(s=(r=a==null?void 0:a.code)==null?void 0:r.split("auth/"))==null?void 0:s[1],h=c?ln(c):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function g3(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<h3;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function sw(){return Pr(L0)}function iw(n){return gl("authEvent",n.config.apiKey,n.name)}function _3(n){try{return JSON.parse(n)}catch{return null}}function y3(n){const e=ym(n),t=e.link?decodeURIComponent(e.link):void 0,r=ym(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return ym(s).link||s||r||t||n}function ym(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Kc(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3=500;class w3{constructor(){this._redirectPersistence=Il,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Bg,this._overrideRedirectResult=U0}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new d3(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Rn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,s){l3(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),pj(),await this._originValidation(e);const a=f3(e,r,s);await p3(e,a);const c=await s3(e,a,t),h=await o3(c);return a3(e,i,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=i3(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:s,BuildInfo:i}=xl(),a=setTimeout(async()=>{await rS(e),t.onEvent(sS())},v3),c=async g=>{clearTimeout(a);const y=await rS(e);let E=null;y&&(g!=null&&g.url)&&(E=m3(y,g.url)),t.onEvent(E||sS())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,c);const h=s,p=`${i.packageName.toLowerCase()}://`;xl().handleOpenURL=async g=>{if(g.toLowerCase().startsWith(p)&&c({url:g}),typeof h=="function")try{h(g)}catch(y){console.error(y)}}}}const E3=w3;function sS(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ln("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(n,e){Bt(n)._logFramework(e)}var T3="@firebase/auth-compat",x3="0.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=1e3;function pd(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function S3(){return pd()==="http:"||pd()==="https:"}function uk(n=Ut()){return!!((pd()==="file:"||pd()==="ionic:"||pd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function A3(){return Cg()||Ng()}function N3(){return rC()&&(document==null?void 0:document.documentMode)===11}function C3(n=Ut()){return/Edge\/\d+/.test(n)}function k3(n=Ut()){return N3()||C3(n)}function hk(){try{const n=self.localStorage,e=yf();if(n)return n.setItem(e,"1"),n.removeItem(e),k3()?wl():!0}catch{return z0()&&wl()}return!1}function z0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Tv(){return(S3()||nC()||uk())&&!A3()&&hk()&&!z0()}function dk(){return uk()&&typeof document<"u"}async function R3(){return dk()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},b3);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function P3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr={LOCAL:"local",NONE:"none",SESSION:"session"},Uh=ie,fk="persistence";function D3(n,e){if(Uh(Object.values(kr).includes(e),n,"invalid-persistence-type"),Cg()){Uh(e!==kr.SESSION,n,"unsupported-persistence-type");return}if(Ng()){Uh(e===kr.NONE,n,"unsupported-persistence-type");return}if(z0()){Uh(e===kr.NONE||e===kr.LOCAL&&wl(),n,"unsupported-persistence-type");return}Uh(e===kr.NONE||hk(),n,"unsupported-persistence-type")}async function ow(n){await n._initializationPromise;const e=pk(),t=gl(fk,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function O3(n,e){const t=pk();if(!t)return[];const r=gl(fk,n,e);switch(t.getItem(r)){case kr.NONE:return[ou];case kr.LOCAL:return[jd,Il];case kr.SESSION:return[Il];default:return[]}}function pk(){var n;try{return((n=P3())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=ie;class zo{constructor(){this.browserResolver=Pr(Yj),this.cordovaResolver=Pr(E3),this.underlyingResolver=null,this._redirectPersistence=Il,this._completeRedirectFn=Bg,this._overrideRedirectResult=U0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,s)}async _openRedirect(e,t,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return dk()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return L3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await R3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(n){return n.unwrap()}function M3(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(n){return gk(n)}function j3(n,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new F3(n,C4(n,e))}else if(t){const s=gk(e),i=e;s&&(i.credential=s,i.tenantId=t.tenantId||void 0,i.email=t.email||void 0,i.phoneNumber=t.phoneNumber||void 0)}}function gk(n){const{_tokenResponse:e}=n instanceof Un?n.customData:n;if(!e)return null;if(!(n instanceof Un)&&"temporaryProof"in e&&"phoneNumber"in e)return Tl.credentialFromResult(n);const t=e.providerId;if(!t||t===jh.PASSWORD)return null;let r;switch(t){case jh.GOOGLE:r=Ws;break;case jh.FACEBOOK:r=Hs;break;case jh.GITHUB:r=qs;break;case jh.TWITTER:r=Gs;break;default:const{oauthIdToken:s,oauthAccessToken:i,oauthTokenSecret:a,pendingToken:c,nonce:h}=e;return!i&&!a&&!s&&!c?null:c?t.startsWith("saml.")?au._create(t,c):oi._fromParams({providerId:t,signInMethod:t,pendingToken:c,idToken:s,accessToken:i}):new Xc(t).credential({idToken:s,accessToken:i,rawNonce:h})}return n instanceof Un?r.credentialFromError(n):r.credentialFromResult(n)}function or(n,e){return e.catch(t=>{throw t instanceof Un&&j3(n,t),t}).then(t=>{const r=t.operationType,s=t.user;return{operationType:r,credential:V3(t),additionalUserInfo:N4(t),user:zg.getOrCreate(s)}})}async function aw(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>or(n,t.confirm(r))}}class F3{constructor(e,t){this.resolver=t,this.auth=M3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return or(mk(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zg=class nd{constructor(e){this._delegate=e,this.multiFactor=P4(e)}static getOrCreate(e){return nd.USER_MAP.has(e)||nd.USER_MAP.set(e,new nd(e)),nd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return or(this.auth,WC(this._delegate,e))}async linkWithPhoneNumber(e,t){return aw(this.auth,tj(this._delegate,e,t))}async linkWithPopup(e){return or(this.auth,uj(this._delegate,e,zo))}async linkWithRedirect(e){return await ow(Bt(this.auth)),vj(this._delegate,e,zo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return or(this.auth,qC(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return aw(this.auth,nj(this._delegate,e,t))}reauthenticateWithPopup(e){return or(this.auth,cj(this._delegate,e,zo))}async reauthenticateWithRedirect(e){return await ow(Bt(this.auth)),_j(this._delegate,e,zo)}sendEmailVerification(e){return _4(this._delegate,e)}async unlink(e){return await r4(this._delegate,e),this}updateEmail(e){return E4(this._delegate,e)}updatePassword(e){return I4(this._delegate,e)}updatePhoneNumber(e){return rj(this._delegate,e)}updateProfile(e){return w4(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return y4(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};zg.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh=ie;class lw{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Bh(r,"invalid-api-key",{appName:e.name}),Bh(r,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?zo:void 0;this._delegate=t.initialize({options:{persistence:U3(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(q5),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?zg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){OV(this._delegate,e,t)}applyActionCode(e){return l4(this._delegate,e)}checkActionCode(e){return GC(this._delegate,e)}confirmPasswordReset(e,t){return a4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return or(this._delegate,u4(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return g4(this._delegate,e)}isSignInWithEmailLink(e){return f4(this._delegate,e)}async getRedirectResult(){Bh(Tv(),this._delegate,"operation-not-supported-in-this-environment");const e=await Ej(this._delegate,zo);return e?or(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){I3(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:s,error:i,complete:a}=iS(e,t,r);return this._delegate.onAuthStateChanged(s,i,a)}onIdTokenChanged(e,t,r){const{next:s,error:i,complete:a}=iS(e,t,r);return this._delegate.onIdTokenChanged(s,i,a)}sendSignInLinkToEmail(e,t){return d4(this._delegate,e,t)}sendPasswordResetEmail(e,t){return o4(this._delegate,e,t||void 0)}async setPersistence(e){D3(this._delegate,e);let t;switch(e){case kr.SESSION:t=Il;break;case kr.LOCAL:t=await Pr(jd)._isAvailable()?jd:L0;break;case kr.NONE:t=ou;break;default:return Rn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return or(this._delegate,n4(this._delegate))}signInWithCredential(e){return or(this._delegate,Mg(this._delegate,e))}signInWithCustomToken(e){return or(this._delegate,i4(this._delegate,e))}signInWithEmailAndPassword(e,t){return or(this._delegate,h4(this._delegate,e,t))}signInWithEmailLink(e,t){return or(this._delegate,p4(this._delegate,e,t))}signInWithPhoneNumber(e,t){return aw(this._delegate,ej(this._delegate,e,t))}async signInWithPopup(e){return Bh(Tv(),this._delegate,"operation-not-supported-in-this-environment"),or(this._delegate,lj(this._delegate,e,zo))}async signInWithRedirect(e){return Bh(Tv(),this._delegate,"operation-not-supported-in-this-environment"),await ow(this._delegate),mj(this._delegate,e,zo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return c4(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}lw.Persistence=kr;function iS(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const s=r;return{next:a=>s(a&&zg.getOrCreate(a)),error:e,complete:t}}function U3(n,e){const t=O3(n,e);if(typeof self<"u"&&!t.includes(jd)&&t.push(jd),typeof window<"u")for(const r of[L0,Il])t.includes(r)||t.push(r);return t.includes(ou)||t.push(ou),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{static credential(e,t){return Tl.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Tl(mk(Qt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}$0.PHONE_SIGN_IN_METHOD=Tl.PHONE_SIGN_IN_METHOD;$0.PROVIDER_ID=Tl.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=ie;class z3{constructor(e,t,r=Qt.app()){var s;B3((s=r.options)==null?void 0:s.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new X4(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="auth-compat";function H3(n){n.INTERNAL.registerComponent(new rn($3,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new lw(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Lc.EMAIL_SIGNIN,PASSWORD_RESET:Lc.PASSWORD_RESET,RECOVER_EMAIL:Lc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Lc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Lc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Lc.VERIFY_EMAIL}},EmailAuthProvider:ya,FacebookAuthProvider:Hs,GithubAuthProvider:qs,GoogleAuthProvider:Ws,OAuthProvider:Xc,SAMLAuthProvider:jm,PhoneAuthProvider:$0,PhoneMultiFactorGenerator:ck,RecaptchaVerifier:z3,TwitterAuthProvider:Gs,Auth:lw,AuthCredential:Mu,Error:Un}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(T3,x3)}H3(Qt);var oS={};const aS="@firebase/database",lS="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _k="";function yk(n){_k=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),an(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Pd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Or(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new W3(e)}}catch{}return new q3},hl=vk("localStorage"),cw=vk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eu=new Du("@firebase/database"),wk=(function(){let n=1;return function(){return n++}})(),Ek=function(n){const e=xM(n),t=new EM;t.update(e);const r=t.digest();return h0.encodeByteArray(r)},wf=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=wf.apply(null,r):typeof r=="object"?e+=an(r):e+=r,e+=" "}return e};let yl=null,cS=!0;const Ik=function(n,e){ae(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(eu.logLevel=Ge.VERBOSE,yl=eu.log.bind(eu),e&&cw.set("logging_enabled",!0)):typeof n=="function"?yl=n:(yl=null,cw.remove("logging_enabled"))},vn=function(...n){if(cS===!0&&(cS=!1,yl===null&&cw.get("logging_enabled")===!0&&Ik(!0)),yl){const e=wf.apply(null,n);yl(e)}},Ef=function(n){return function(...e){vn(n,...e)}},uw=function(...n){const e="FIREBASE INTERNAL ERROR: "+wf(...n);eu.error(e)},ai=function(...n){const e=`FIREBASE FATAL ERROR: ${wf(...n)}`;throw eu.error(e),new Error(e)},Bn=function(...n){const e="FIREBASE WARNING: "+wf(...n);eu.warn(e)},G3=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Bn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},$g=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},K3=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ra="[MIN_NAME]",Gi="[MAX_NAME]",Wl=function(n,e){if(n===e)return 0;if(n===ra||e===Gi)return-1;if(e===ra||n===Gi)return 1;{const t=uS(n),r=uS(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},Q3=function(n,e){return n===e?0:n<e?-1:1},zh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+an(e))},H0=function(n){if(typeof n!="object"||n===null)return an(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=an(e[r]),t+=":",t+=H0(n[e[r]]);return t+="}",t},Tk=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let s=0;s<t;s+=e)s+e>t?r.push(n.substring(s,t)):r.push(n.substring(s,s+e));return r};function En(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const xk=function(n){ae(!$g(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let s,i,a,c,h;n===0?(i=0,a=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(c=Math.min(Math.floor(Math.log(n)/Math.LN2),r),i=c+r,a=Math.round(n*Math.pow(2,t-c)-Math.pow(2,t))):(i=0,a=Math.round(n/Math.pow(2,1-r-t))));const p=[];for(h=t;h;h-=1)p.push(a%2?1:0),a=Math.floor(a/2);for(h=e;h;h-=1)p.push(i%2?1:0),i=Math.floor(i/2);p.push(s?1:0),p.reverse();const g=p.join("");let y="";for(h=0;h<64;h+=8){let E=parseInt(g.substr(h,8),2).toString(16);E.length===1&&(E="0"+E),y=y+E}return y.toLowerCase()},Y3=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},J3=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function X3(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const Z3=new RegExp("^-?(0*)\\d{1,10}$"),eF=-2147483648,tF=2147483647,uS=function(n){if(Z3.test(n)){const e=Number(n);if(e>=eF&&e<=tF)return e}return null},ju=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Bn("Exception was thrown by user callback.",t),e},Math.floor(0))}},nF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},md=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rF{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,At(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Bn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(vn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Bn(e)}}class tu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}tu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="5",bk="v",Sk="s",Ak="r",Nk="f",Ck=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kk="ls",Rk="p",hw="ac",Pk="websocket",Dk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e,t,r,s,i=!1,a="",c=!1,h=!1,p=null){this.secure=t,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=a,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=h,this.emulatorOptions=p,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=hl.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&hl.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function iF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Lk(n,e,t){ae(typeof e=="string","typeof type must == string"),ae(typeof t=="object","typeof params must == object");let r;if(e===Pk)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Dk)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);iF(n)&&(t.ns=n.namespace);const s=[];return En(t,(i,a)=>{s.push(i+"="+a)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(){this.counters_={}}incrementCounter(e,t=1){Or(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return rM(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv={},bv={};function q0(n){const e=n.toString();return xv[e]||(xv[e]=new oF),xv[e]}function aF(n,e){const t=n.toString();return bv[t]||(bv[t]=e()),bv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&ju(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="start",cF="close",uF="pLPCommand",hF="pRTLPCB",Mk="id",Vk="pw",jk="ser",dF="cb",fF="seg",pF="ts",mF="d",gF="dframe",Fk=1870,Uk=30,_F=Fk-Uk,yF=25e3,vF=3e4;class $o{constructor(e,t,r,s,i,a,c){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=a,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ef(e),this.stats_=q0(t),this.urlFn=h=>(this.appCheckToken&&(h[hw]=this.appCheckToken),Lk(t,Dk,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new lF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(vF)),K3(()=>{if(this.isClosed_)return;this.scriptTagHolder=new G0((...i)=>{const[a,c,h,p,g]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===hS)this.id=c,this.password=h;else if(a===cF)c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...i)=>{const[a,c]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(a,c)},()=>{this.onClosed_()},this.urlFn);const r={};r[hS]="t",r[jk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[dF]=this.scriptTagHolder.uniqueCallbackIdentifier),r[bk]=W0,this.transportSessionId&&(r[Sk]=this.transportSessionId),this.lastSessionId&&(r[kk]=this.lastSessionId),this.applicationId&&(r[Rk]=this.applicationId),this.appCheckToken&&(r[hw]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ck.test(location.hostname)&&(r[Ak]=Nk);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){$o.forceAllow_=!0}static forceDisallow(){$o.forceDisallow_=!0}static isAvailable(){return $o.forceAllow_?!0:!$o.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Y3()&&!J3()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=an(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=ZN(t),s=Tk(r,_F);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[gF]="t",r[Mk]=e,r[Vk]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=an(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class G0{constructor(e,t,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=wk(),window[uF+this.uniqueCallbackIdentifier]=e,window[hF+this.uniqueCallbackIdentifier]=t,this.myIFrame=G0.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(c){vn("frame writing exception"),c.stack&&vn(c.stack),vn(c)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||vn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Mk]=this.myID,e[Vk]=this.myPW,e[jk]=this.currentSerial;let t=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Uk+r.length<=Fk;){const a=this.pendingSegs.shift();r=r+"&"+fF+s+"="+a.seg+"&"+pF+s+"="+a.ts+"&"+mF+s+"="+a.d,s++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(r,Math.floor(yF)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{vn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=16384,EF=45e3;let zm=null;typeof MozWebSocket<"u"?zm=MozWebSocket:typeof WebSocket<"u"&&(zm=WebSocket);class Kr{constructor(e,t,r,s,i,a,c){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ef(this.connId),this.stats_=q0(t),this.connURL=Kr.connectionURL_(t,a,c,s,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,s,i){const a={};return a[bk]=W0,typeof location<"u"&&location.hostname&&Ck.test(location.hostname)&&(a[Ak]=Nk),t&&(a[Sk]=t),r&&(a[kk]=r),s&&(a[hw]=s),i&&(a[Rk]=i),Lk(e,Pk,a)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,hl.set("previous_websocket_failure",!0);try{let r;fM(),this.mySock=new zm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Kr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&zm!==null&&!Kr.forceDisallow_}static previouslyFailed(){return hl.isInMemoryStorage||hl.get("previous_websocket_failure")===!0}markConnectionHealthy(){hl.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=Pd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ae(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=an(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=Tk(t,wF);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(EF))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Kr.responsesRequiredToBeHealthy=2;Kr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{static get ALL_TRANSPORTS(){return[$o,Kr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Kr&&Kr.isAvailable();let r=t&&!Kr.previouslyFailed();if(e.webSocketOnly&&(t||Bn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Kr];else{const s=this.transports_=[];for(const i of lu.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);lu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}lu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=6e4,TF=5e3,xF=10*1024,bF=100*1024,Sv="t",dS="d",SF="s",fS="r",AF="e",pS="o",mS="a",gS="n",_S="p",NF="h";class CF{constructor(e,t,r,s,i,a,c,h,p,g){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=a,this.onReady_=c,this.onDisconnect_=h,this.onKill_=p,this.lastSessionId=g,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ef("c:"+this.id+":"),this.transportManager_=new lu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=md(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>bF?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xF?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Sv in e){const t=e[Sv];t===mS?this.upgradeIfSecondaryHealthy_():t===fS?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===pS&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=zh("t",e),r=zh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_S,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mS,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gS,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=zh("t",e),r=zh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=zh(Sv,e);if(dS in e){const r=e[dS];if(t===NF){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===gS){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===SF?this.onConnectionShutdown_(r):t===fS?this.onReset_(r):t===AF?uw("Server Error: "+r):t===pS?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):uw("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),W0!==r&&Bn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),md(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(IF))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):md(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(TF))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_S,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(hl.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{put(e,t,r,s){}merge(e,t,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e){this.allowedEvents_=e,this.listeners_={},ae(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const s=this.getInitialEvent(e);s&&t.apply(r,s)}off(e,t,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===t&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){ae(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m extends zk{static getInstance(){return new $m}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!_0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return ae(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=32,vS=768;class lt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function nt(){return new lt("")}function ze(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function sa(n){return n.pieces_.length-n.pieceNum_}function mt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new lt(n.pieces_,e)}function K0(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function kF(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Fd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function $k(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new lt(e,0)}function Rt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof lt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&t.push(r[s])}return new lt(t,0)}function $e(n){return n.pieceNum_>=n.pieces_.length}function Qn(n,e){const t=ze(n),r=ze(e);if(t===null)return e;if(t===r)return Qn(mt(n),mt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function RF(n,e){const t=Fd(n,0),r=Fd(e,0);for(let s=0;s<t.length&&s<r.length;s++){const i=Wl(t[s],r[s]);if(i!==0)return i}return t.length===r.length?0:t.length<r.length?-1:1}function Q0(n,e){if(sa(n)!==sa(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Qr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(sa(n)>sa(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class PF{constructor(e,t){this.errorPrefix_=t,this.parts_=Fd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=kg(this.parts_[r]);Hk(this)}}function DF(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=kg(e),Hk(n)}function OF(n){const e=n.parts_.pop();n.byteLength_-=kg(e),n.parts_.length>0&&(n.byteLength_-=1)}function Hk(n){if(n.byteLength_>vS)throw new Error(n.errorPrefix_+"has a key path longer than "+vS+" bytes ("+n.byteLength_+").");if(n.parts_.length>yS)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+yS+") or object contains a cycle "+tl(n))}function tl(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends zk{static getInstance(){return new Y0}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return ae(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=1e3,LF=300*1e3,wS=30*1e3,MF=1.3,VF=3e4,jF="server_kill",ES=3;class $i extends Bk{constructor(e,t,r,s,i,a,c,h){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=h,this.id=$i.nextPersistentConnectionId_++,this.log_=Ef("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=$h,this.maxReconnectDelay_=LF,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Y0.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&$m.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const s=++this.requestNumber_,i={r:s,a:e,b:t};this.log_(an(i)),ae(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const t=new lr,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const c=a.d;a.s==="ok"?t.resolve(c):t.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,r,s){this.initConnection_();const i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ae(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");const c={onComplete:s,hashFn:t,query:e,tag:r};this.listens.get(a).set(i,c),this.connected_&&this.sendListen_(c)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},a="q";e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(a,i,c=>{const h=c.d,p=c.s;$i.warnOnListenWarnings_(h,t),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",c),p!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(p,h))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Or(e,"w")){const r=El(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();Bn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||wM(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=vM(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,s=>{const i=s.s,a=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,t)}sendUnlisten_(e,t,r,s){this.log_("Unlisten on "+e+" for "+t);const i={p:e},a="n";s&&(i.q=r,i.t=s),this.sendRequest(a,i)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,s){const i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(e,t,r,s){this.putInternal("p",e,t,r,s)}merge(e,t,r,s){this.putInternal("m",e,t,r,s)}putInternal(e,t,r,s,i){this.initConnection_();const a={p:t,d:r};i!==void 0&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:s}),this.outstandingPutCount_++;const c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,i=>{this.log_(t+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+an(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):uw("Unrecognized action received from server: "+an(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ae(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$h,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=$h,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>VF&&(this.reconnectDelay_=$h),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*MF)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+$i.nextConnectionId_++,i=this.lastSessionId;let a=!1,c=null;const h=function(){c?c.close():(a=!0,r())},p=function(y){ae(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(y)};this.realtime_={close:h,sendRequest:p};const g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,E]=await Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);a?vn("getToken() completed but was canceled"):(vn("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=E&&E.token,c=new CF(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,x=>{Bn(x+" ("+this.repoInfo_.toString()+")"),this.interrupt(jF)},i))}catch(y){this.log_("Failed to get token: "+y),a||(this.repoInfo_.nodeAdmin&&Bn(y),h())}}}interrupt(e){vn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){vn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Dm(this.interruptReasons_)&&(this.reconnectDelay_=$h,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(i=>H0(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const r=new lt(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(t),i.delete(t),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,t){vn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ES&&(this.reconnectDelay_=wS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){vn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ES&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+_k.replace(/\./g,"-")]=1,_0()?e["framework.cordova"]=1:Cg()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=$m.getInstance().currentlyOnline();return Dm(this.interruptReasons_)&&e}}$i.nextPersistentConnectionId_=0;$i.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ke(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ke(ra,e),s=new Ke(ra,t);return this.compare(r,s)!==0}minPost(){return Ke.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sm;class Wk extends Hg{static get __EMPTY_NODE(){return sm}static set __EMPTY_NODE(e){sm=e}compare(e,t){return Wl(e.name,t.name)}isDefinedOn(e){throw Pu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ke.MIN}maxPost(){return new Ke(Gi,sm)}makePost(e,t){return ae(typeof e=="string","KeyIndex indexValue must always be a string."),new Ke(e,sm)}toString(){return".key"}}const ei=new Wk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let im=class{constructor(e,t,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=t?r(e.key,t):1,s&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ar=class rd{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??rd.RED,this.left=s??Qs.EMPTY_NODE,this.right=i??Qs.EMPTY_NODE}copy(e,t,r,s,i){return new rd(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Qs.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,s;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Qs.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,rd.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,rd.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Ar.RED=!0;Ar.BLACK=!1;class FF{copy(e,t,r,s,i){return this}insert(e,t,r){return new Ar(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Qs=class vm{constructor(e,t=vm.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new vm(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ar.BLACK,null,null))}remove(e){return new vm(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ar.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,s=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new im(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new im(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new im(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new im(this.root_,null,this.comparator_,!0,e)}};Qs.EMPTY_NODE=new FF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(n,e){return Wl(n.name,e.name)}function J0(n,e){return Wl(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dw;function BF(n){dw=n}const qk=function(n){return typeof n=="number"?"number:"+xk(n):"string:"+n},Gk=function(n){if(n.isLeafNode()){const e=n.val();ae(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Or(e,".sv"),"Priority must be a string or number.")}else ae(n===dw||n.isEmpty(),"priority of unexpected type.");ae(n===dw||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IS;class mn{static set __childrenNodeConstructor(e){IS=e}static get __childrenNodeConstructor(){return IS}constructor(e,t=mn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ae(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Gk(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new mn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:mn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return $e(e)?this:ze(e)===".priority"?this.priorityNode_:mn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:mn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=ze(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(ae(r!==".priority"||sa(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,mn.__childrenNodeConstructor.EMPTY_NODE.updateChild(mt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+qk(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=xk(this.value_):e+=this.value_,this.lazyHash_=Ek(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===mn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof mn.__childrenNodeConstructor?-1:(ae(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,s=mn.VALUE_TYPE_ORDER.indexOf(t),i=mn.VALUE_TYPE_ORDER.indexOf(r);return ae(s>=0,"Unknown leaf type: "+t),ae(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}mn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kk,Qk;function zF(n){Kk=n}function $F(n){Qk=n}class HF extends Hg{compare(e,t){const r=e.node.getPriority(),s=t.node.getPriority(),i=r.compareTo(s);return i===0?Wl(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ke.MIN}maxPost(){return new Ke(Gi,new mn("[PRIORITY-POST]",Qk))}makePost(e,t){const r=Kk(e);return new Ke(t,new mn("[PRIORITY-POST]",r))}toString(){return".priority"}}const yt=new HF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WF=Math.log(2);class qF{constructor(e){const t=i=>parseInt(Math.log(i)/WF,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Hm=function(n,e,t,r){n.sort(e);const s=function(h,p){const g=p-h;let y,E;if(g===0)return null;if(g===1)return y=n[h],E=t?t(y):y,new Ar(E,y.node,Ar.BLACK,null,null);{const x=parseInt(g/2,10)+h,P=s(h,x),O=s(x+1,p);return y=n[x],E=t?t(y):y,new Ar(E,y.node,Ar.BLACK,P,O)}},i=function(h){let p=null,g=null,y=n.length;const E=function(P,O){const M=y-P,X=y;y-=P;const W=s(M+1,X),Q=n[M],Y=t?t(Q):Q;x(new Ar(Y,Q.node,O,null,W))},x=function(P){p?(p.left=P,p=P):(g=P,p=P)};for(let P=0;P<h.count;++P){const O=h.nextBitIsOne(),M=Math.pow(2,h.count-(P+1));O?E(M,Ar.BLACK):(E(M,Ar.BLACK),E(M,Ar.RED))}return g},a=new qF(n.length),c=i(a);return new Qs(r||e,c)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Av;const Mc={};class ji{static get Default(){return ae(Mc&&yt,"ChildrenNode.ts has not been loaded"),Av=Av||new ji({".priority":Mc},{".priority":yt}),Av}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=El(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qs?t:null}hasIndex(e){return Or(this.indexSet_,e.toString())}addIndex(e,t){ae(e!==ei,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=t.getIterator(Ke.Wrap);let a=i.getNext();for(;a;)s=s||e.isDefinedOn(a.node),r.push(a),a=i.getNext();let c;s?c=Hm(r,e.getCompare()):c=Mc;const h=e.toString(),p={...this.indexSet_};p[h]=e;const g={...this.indexes_};return g[h]=c,new ji(g,p)}addToIndexes(e,t){const r=Om(this.indexes_,(s,i)=>{const a=El(this.indexSet_,i);if(ae(a,"Missing index implementation for "+i),s===Mc)if(a.isDefinedOn(e.node)){const c=[],h=t.getIterator(Ke.Wrap);let p=h.getNext();for(;p;)p.name!==e.name&&c.push(p),p=h.getNext();return c.push(e),Hm(c,a.getCompare())}else return Mc;else{const c=t.get(e.name);let h=s;return c&&(h=h.remove(new Ke(e.name,c))),h.insert(e,e.node)}});return new ji(r,this.indexSet_)}removeFromIndexes(e,t){const r=Om(this.indexes_,s=>{if(s===Mc)return s;{const i=t.get(e.name);return i?s.remove(new Ke(e.name,i)):s}});return new ji(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh;class Oe{static get EMPTY_NODE(){return Hh||(Hh=new Oe(new Qs(J0),null,ji.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Gk(this.priorityNode_),this.children_.isEmpty()&&ae(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Hh}updatePriority(e){return this.children_.isEmpty()?this:new Oe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Hh:t}}getChild(e){const t=ze(e);return t===null?this:this.getImmediateChild(t).getChild(mt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ae(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Ke(e,t);let s,i;t.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(r,this.children_));const a=s.isEmpty()?Hh:this.priorityNode_;return new Oe(s,a,i)}}updateChild(e,t){const r=ze(e);if(r===null)return t;{ae(ze(e)!==".priority"||sa(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(mt(e),t);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,s=0,i=!0;if(this.forEachChild(yt,(a,c)=>{t[a]=c.val(e),r++,i&&Oe.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):i=!1}),!e&&i&&s<2*r){const a=[];for(const c in t)a[c]=t[c];return a}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+qk(this.getPriority().val())+":"),this.forEachChild(yt,(t,r)=>{const s=r.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Ek(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new Ke(e,t));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ke(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ke(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Ke.Wrap);let i=s.peek();for(;i!=null&&t.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Ke.Wrap);let i=s.peek();for(;i!=null&&t.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===If?-1:0}withIndex(e){if(e===ei||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Oe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ei||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(yt),s=t.getIterator(yt);let i=r.getNext(),a=s.getNext();for(;i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=r.getNext(),a=s.getNext()}return i===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===ei?null:this.indexMap_.get(e.toString())}}Oe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class GF extends Oe{constructor(){super(new Qs(J0),Oe.EMPTY_NODE,ji.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Oe.EMPTY_NODE}isEmpty(){return!1}}const If=new GF;Object.defineProperties(Ke,{MIN:{value:new Ke(ra,Oe.EMPTY_NODE)},MAX:{value:new Ke(Gi,If)}});Wk.__EMPTY_NODE=Oe.EMPTY_NODE;mn.__childrenNodeConstructor=Oe;BF(If);$F(If);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=!0;function Ft(n,e=null){if(n===null)return Oe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ae(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new mn(t,Ft(e))}if(!(n instanceof Array)&&KF){const t=[];let r=!1;if(En(n,(a,c)=>{if(a.substring(0,1)!=="."){const h=Ft(c);h.isEmpty()||(r=r||!h.getPriority().isEmpty(),t.push(new Ke(a,h)))}}),t.length===0)return Oe.EMPTY_NODE;const i=Hm(t,UF,a=>a.name,J0);if(r){const a=Hm(t,yt.getCompare());return new Oe(i,Ft(e),new ji({".priority":a},{".priority":yt}))}else return new Oe(i,Ft(e),ji.Default)}else{let t=Oe.EMPTY_NODE;return En(n,(r,s)=>{if(Or(n,r)&&r.substring(0,1)!=="."){const i=Ft(s);(i.isLeafNode()||!i.isEmpty())&&(t=t.updateImmediateChild(r,i))}}),t.updatePriority(Ft(e))}}zF(Ft);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0 extends Hg{constructor(e){super(),this.indexPath_=e,ae(!$e(e)&&ze(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),s=this.extractChild(t.node),i=r.compareTo(s);return i===0?Wl(e.name,t.name):i}makePost(e,t){const r=Ft(e),s=Oe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ke(t,s)}maxPost(){const e=Oe.EMPTY_NODE.updateChild(this.indexPath_,If);return new Ke(Gi,e)}toString(){return Fd(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF extends Hg{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Wl(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ke.MIN}maxPost(){return Ke.MAX}makePost(e,t){const r=Ft(e);return new Ke(t,r)}toString(){return".value"}}const Z0=new QF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(n){return{type:"value",snapshotNode:n}}function cu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ud(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Bd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function YF(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e){this.index_=e}updateChild(e,t,r,s,i,a){ae(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=e.getImmediateChild(t);return c.getChild(s).equals(r.getChild(s))&&c.isEmpty()===r.isEmpty()||(a!=null&&(r.isEmpty()?e.hasChild(t)?a.trackChildChange(Ud(t,c)):ae(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?a.trackChildChange(cu(t,r)):a.trackChildChange(Bd(t,r,c))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(yt,(s,i)=>{t.hasChild(s)||r.trackChildChange(Ud(s,i))}),t.isLeafNode()||t.forEachChild(yt,(s,i)=>{if(e.hasChild(s)){const a=e.getImmediateChild(s);a.equals(i)||r.trackChildChange(Bd(s,i,a))}else r.trackChildChange(cu(s,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Oe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e){this.indexedFilter_=new eE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=zd.getStartPost_(e),this.endPost_=zd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,s,i,a){return this.matches(new Ke(t,r))||(r=Oe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,s,i,a)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Oe.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(Oe.EMPTY_NODE);const i=this;return t.forEachChild(yt,(a,c)=>{i.matches(new Ke(a,c))||(s=s.updateImmediateChild(a,Oe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new zd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,s,i,a){return this.rangedFilter_.matches(new Ke(t,r))||(r=Oe.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,s,i,a):this.fullLimitUpdateChild_(e,t,r,i,a)}updateFullNode(e,t,r){let s;if(t.isLeafNode()||t.isEmpty())s=Oe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=Oe.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;i.hasNext()&&a<this.limit_;){const c=i.getNext();if(this.withinDirectionalStart(c))if(this.withinDirectionalEnd(c))s=s.updateImmediateChild(c.name,c.node),a++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(Oe.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let a=0;for(;i.hasNext();){const c=i.getNext();a<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?a++:s=s.updateImmediateChild(c.name,Oe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,s,i){let a;if(this.reverse_){const y=this.index_.getCompare();a=(E,x)=>y(x,E)}else a=this.index_.getCompare();const c=e;ae(c.numChildren()===this.limit_,"");const h=new Ke(t,r),p=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),g=this.rangedFilter_.matches(h);if(c.hasChild(t)){const y=c.getImmediateChild(t);let E=s.getChildAfterChild(this.index_,p,this.reverse_);for(;E!=null&&(E.name===t||c.hasChild(E.name));)E=s.getChildAfterChild(this.index_,E,this.reverse_);const x=E==null?1:a(E,h);if(g&&!r.isEmpty()&&x>=0)return i!=null&&i.trackChildChange(Bd(t,r,y)),c.updateImmediateChild(t,r);{i!=null&&i.trackChildChange(Ud(t,y));const O=c.updateImmediateChild(t,Oe.EMPTY_NODE);return E!=null&&this.rangedFilter_.matches(E)?(i!=null&&i.trackChildChange(cu(E.name,E.node)),O.updateImmediateChild(E.name,E.node)):O}}else return r.isEmpty()?e:g&&a(p,h)>=0?(i!=null&&(i.trackChildChange(Ud(p.name,p.node)),i.trackChildChange(cu(t,r))),c.updateImmediateChild(t,r).updateImmediateChild(p.name,Oe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=yt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ae(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ae(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ra}hasEnd(){return this.endSet_}getIndexEndValue(){return ae(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ae(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ae(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===yt}copy(){const e=new Wg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function XF(n){return n.loadsAllData()?new eE(n.getIndex()):n.hasLimit()?new JF(n):new zd(n)}function ZF(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function e6(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function fw(n,e,t){const r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function t6(n,e,t){let r;return n.index_===ei||t?r=fw(n,e,t):r=fw(n,e,Gi),r.startAfterSet_=!0,r}function pw(n,e,t){const r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function n6(n,e,t){let r;return n.index_===ei||t?r=pw(n,e,t):r=pw(n,e,ra),r.endBeforeSet_=!0,r}function qg(n,e){const t=n.copy();return t.index_=e,t}function TS(n){const e={};if(n.isDefault())return e;let t;if(n.index_===yt?t="$priority":n.index_===Z0?t="$value":n.index_===ei?t="$key":(ae(n.index_ instanceof X0,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=an(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=an(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+an(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=an(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+an(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function xS(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==yt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm extends Bk{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ae(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Ef("p:rest:"),this.listens_={}}listen(e,t,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const a=Wm.getListenId_(e,r),c={};this.listens_[a]=c;const h=TS(e._queryParams);this.restRequest_(i+".json",h,(p,g)=>{let y=g;if(p===404&&(y=null,p=null),p===null&&this.onDataUpdate_(i,y,!1,r),El(this.listens_,a)===c){let E;p?p===401?E="permission_denied":E="rest_error:"+p:E="ok",s(E,null)}})}unlisten(e,t){const r=Wm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=TS(e._queryParams),r=e._path.toString(),s=new lr;return this.restRequest_(r+".json",t,(i,a)=>{let c=a;i===404&&(c=null,i=null),i===null?(this.onDataUpdate_(r,c,!1,null),s.resolve(c)):s.reject(new Error(c))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(t.auth=s.accessToken),i&&i.token&&(t.ac=i.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+$l(t);this.log_("Sending REST request for "+a);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(r&&c.readyState===4){this.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);let h=null;if(c.status>=200&&c.status<300){try{h=Pd(c.responseText)}catch{Bn("Failed to parse JSON response for "+a+": "+c.responseText)}r(null,h)}else c.status!==401&&c.status!==404&&Bn("Got unsuccessful REST response for "+a+" Status: "+c.status),r(c.status);r=null}},c.open("GET",a,!0),c.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(){this.rootNode_=Oe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(){return{value:null,children:new Map}}function Fu(n,e,t){if($e(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=ze(e);n.children.has(r)||n.children.set(r,qm());const s=n.children.get(r);e=mt(e),Fu(s,e,t)}}function mw(n,e){if($e(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(yt,(r,s)=>{Fu(n,new lt(r),s)}),mw(n,e)}}else if(n.children.size>0){const t=ze(e);return e=mt(e),n.children.has(t)&&mw(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function gw(n,e,t){n.value!==null?t(e,n.value):s6(n,(r,s)=>{const i=new lt(e.toString()+"/"+r);gw(s,i,t)})}function s6(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&En(this.last_,(r,s)=>{t[r]=t[r]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=10*1e3,o6=30*1e3,a6=300*1e3;class l6{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new i6(e);const r=bS+(o6-bS)*Math.random();md(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;En(e,(s,i)=>{i>0&&Or(this.statsToReport_,s)&&(t[s]=i,r=!0)}),r&&this.server_.reportStats(t),md(this.reportStats_.bind(this),Math.floor(Math.random()*2*a6))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gs;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(gs||(gs={}));function tE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function nE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function rE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=gs.ACK_USER_WRITE,this.source=tE()}operationForChild(e){if($e(this.path)){if(this.affectedTree.value!=null)return ae(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new lt(e));return new Gm(nt(),t,this.revert)}}else return ae(ze(this.path)===e,"operationForChild called for unrelated child."),new Gm(mt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,t){this.source=e,this.path=t,this.type=gs.LISTEN_COMPLETE}operationForChild(e){return $e(this.path)?new $d(this.source,nt()):new $d(this.source,mt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=gs.OVERWRITE}operationForChild(e){return $e(this.path)?new bl(this.source,nt(),this.snap.getImmediateChild(e)):new bl(this.source,mt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=gs.MERGE}operationForChild(e){if($e(this.path)){const t=this.children.subtree(new lt(e));return t.isEmpty()?null:t.value?new bl(this.source,nt(),t.value):new uu(this.source,nt(),t)}else return ae(ze(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new uu(this.source,mt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if($e(e))return this.isFullyInitialized()&&!this.filtered_;const t=ze(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function u6(n,e,t,r){const s=[],i=[];return e.forEach(a=>{a.type==="child_changed"&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&i.push(YF(a.childName,a.snapshotNode))}),Wh(n,s,"child_removed",e,r,t),Wh(n,s,"child_added",e,r,t),Wh(n,s,"child_moved",i,r,t),Wh(n,s,"child_changed",e,r,t),Wh(n,s,"value",e,r,t),s}function Wh(n,e,t,r,s,i){const a=r.filter(c=>c.type===t);a.sort((c,h)=>d6(n,c,h)),a.forEach(c=>{const h=h6(n,c,i);s.forEach(p=>{p.respondsTo(c.type)&&e.push(p.createEvent(h,n.query_))})})}function h6(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function d6(n,e,t){if(e.childName==null||t.childName==null)throw Pu("Should only compare child_ events.");const r=new Ke(e.childName,e.snapshotNode),s=new Ke(t.childName,t.snapshotNode);return n.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n,e){return{eventCache:n,serverCache:e}}function gd(n,e,t,r){return Gg(new ia(e,t,r),n.serverCache)}function Jk(n,e,t,r){return Gg(n.eventCache,new ia(e,t,r))}function Km(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Sl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nv;const f6=()=>(Nv||(Nv=new Qs(Q3)),Nv);class _t{static fromObject(e){let t=new _t(null);return En(e,(r,s)=>{t=t.set(new lt(r),s)}),t}constructor(e,t=f6()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:nt(),value:this.value};if($e(e))return null;{const r=ze(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(mt(e),t);return i!=null?{path:Rt(new lt(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if($e(e))return this;{const t=ze(e),r=this.children.get(t);return r!==null?r.subtree(mt(e)):new _t(null)}}set(e,t){if($e(e))return new _t(t,this.children);{const r=ze(e),i=(this.children.get(r)||new _t(null)).set(mt(e),t),a=this.children.insert(r,i);return new _t(this.value,a)}}remove(e){if($e(e))return this.children.isEmpty()?new _t(null):new _t(null,this.children);{const t=ze(e),r=this.children.get(t);if(r){const s=r.remove(mt(e));let i;return s.isEmpty()?i=this.children.remove(t):i=this.children.insert(t,s),this.value===null&&i.isEmpty()?new _t(null):new _t(this.value,i)}else return this}}get(e){if($e(e))return this.value;{const t=ze(e),r=this.children.get(t);return r?r.get(mt(e)):null}}setTree(e,t){if($e(e))return t;{const r=ze(e),i=(this.children.get(r)||new _t(null)).setTree(mt(e),t);let a;return i.isEmpty()?a=this.children.remove(r):a=this.children.insert(r,i),new _t(this.value,a)}}fold(e){return this.fold_(nt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Rt(e,s),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,nt(),t)}findOnPath_(e,t,r){const s=this.value?r(t,this.value):!1;if(s)return s;if($e(e))return null;{const i=ze(e),a=this.children.get(i);return a?a.findOnPath_(mt(e),Rt(t,i),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,nt(),t)}foreachOnPath_(e,t,r){if($e(e))return this;{this.value&&r(t,this.value);const s=ze(e),i=this.children.get(s);return i?i.foreachOnPath_(mt(e),Rt(t,s),r):new _t(null)}}foreach(e){this.foreach_(nt(),e)}foreach_(e,t){this.children.inorderTraversal((r,s)=>{s.foreach_(Rt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.writeTree_=e}static empty(){return new _s(new _t(null))}}function _d(n,e,t){if($e(e))return new _s(new _t(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const a=Qn(s,e);return i=i.updateChild(a,t),new _s(n.writeTree_.set(s,i))}else{const s=new _t(t),i=n.writeTree_.setTree(e,s);return new _s(i)}}}function _w(n,e,t){let r=n;return En(t,(s,i)=>{r=_d(r,Rt(e,s),i)}),r}function SS(n,e){if($e(e))return _s.empty();{const t=n.writeTree_.setTree(e,new _t(null));return new _s(t)}}function yw(n,e){return ql(n,e)!=null}function ql(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Qn(t.path,e)):null}function AS(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(yt,(r,s)=>{e.push(new Ke(r,s))}):n.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new Ke(r,s.value))}),e}function Qo(n,e){if($e(e))return n;{const t=ql(n,e);return t!=null?new _s(new _t(t)):new _s(n.writeTree_.subtree(e))}}function vw(n){return n.writeTree_.isEmpty()}function hu(n,e){return Xk(nt(),n.writeTree_,e)}function Xk(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(ae(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):t=Xk(Rt(n,s),i,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Rt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n,e){return nR(e,n)}function p6(n,e,t,r,s){ae(r>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:s}),s&&(n.visibleWrites=_d(n.visibleWrites,e,t)),n.lastWriteId=r}function m6(n,e,t,r){ae(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=_w(n.visibleWrites,e,t),n.lastWriteId=r}function g6(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function _6(n,e){const t=n.allWrites.findIndex(c=>c.writeId===e);ae(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let s=r.visible,i=!1,a=n.allWrites.length-1;for(;s&&a>=0;){const c=n.allWrites[a];c.visible&&(a>=t&&y6(c,r.path)?s=!1:Qr(r.path,c.path)&&(i=!0)),a--}if(s){if(i)return v6(n),!0;if(r.snap)n.visibleWrites=SS(n.visibleWrites,r.path);else{const c=r.children;En(c,h=>{n.visibleWrites=SS(n.visibleWrites,Rt(r.path,h))})}return!0}else return!1}function y6(n,e){if(n.snap)return Qr(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Qr(Rt(n.path,t),e))return!0;return!1}function v6(n){n.visibleWrites=Zk(n.allWrites,w6,nt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function w6(n){return n.visible}function Zk(n,e,t){let r=_s.empty();for(let s=0;s<n.length;++s){const i=n[s];if(e(i)){const a=i.path;let c;if(i.snap)Qr(t,a)?(c=Qn(t,a),r=_d(r,c,i.snap)):Qr(a,t)&&(c=Qn(a,t),r=_d(r,nt(),i.snap.getChild(c)));else if(i.children){if(Qr(t,a))c=Qn(t,a),r=_w(r,c,i.children);else if(Qr(a,t))if(c=Qn(a,t),$e(c))r=_w(r,nt(),i.children);else{const h=El(i.children,ze(c));if(h){const p=h.getChild(mt(c));r=_d(r,nt(),p)}}}else throw Pu("WriteRecord should have .snap or .children")}}return r}function eR(n,e,t,r,s){if(!r&&!s){const i=ql(n.visibleWrites,e);if(i!=null)return i;{const a=Qo(n.visibleWrites,e);if(vw(a))return t;if(t==null&&!yw(a,nt()))return null;{const c=t||Oe.EMPTY_NODE;return hu(a,c)}}}else{const i=Qo(n.visibleWrites,e);if(!s&&vw(i))return t;if(!s&&t==null&&!yw(i,nt()))return null;{const a=function(p){return(p.visible||s)&&(!r||!~r.indexOf(p.writeId))&&(Qr(p.path,e)||Qr(e,p.path))},c=Zk(n.allWrites,a,e),h=t||Oe.EMPTY_NODE;return hu(c,h)}}}function E6(n,e,t){let r=Oe.EMPTY_NODE;const s=ql(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(yt,(i,a)=>{r=r.updateImmediateChild(i,a)}),r;if(t){const i=Qo(n.visibleWrites,e);return t.forEachChild(yt,(a,c)=>{const h=hu(Qo(i,new lt(a)),c);r=r.updateImmediateChild(a,h)}),AS(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}else{const i=Qo(n.visibleWrites,e);return AS(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}}function I6(n,e,t,r,s){ae(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Rt(e,t);if(yw(n.visibleWrites,i))return null;{const a=Qo(n.visibleWrites,i);return vw(a)?s.getChild(t):hu(a,s.getChild(t))}}function T6(n,e,t,r){const s=Rt(e,t),i=ql(n.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(t)){const a=Qo(n.visibleWrites,s);return hu(a,r.getNode().getImmediateChild(t))}else return null}function x6(n,e){return ql(n.visibleWrites,e)}function b6(n,e,t,r,s,i,a){let c;const h=Qo(n.visibleWrites,e),p=ql(h,nt());if(p!=null)c=p;else if(t!=null)c=hu(h,t);else return[];if(c=c.withIndex(a),!c.isEmpty()&&!c.isLeafNode()){const g=[],y=a.getCompare(),E=i?c.getReverseIteratorFrom(r,a):c.getIteratorFrom(r,a);let x=E.getNext();for(;x&&g.length<s;)y(x,r)!==0&&g.push(x),x=E.getNext();return g}else return[]}function S6(){return{visibleWrites:_s.empty(),allWrites:[],lastWriteId:-1}}function Qm(n,e,t,r){return eR(n.writeTree,n.treePath,e,t,r)}function sE(n,e){return E6(n.writeTree,n.treePath,e)}function NS(n,e,t,r){return I6(n.writeTree,n.treePath,e,t,r)}function Ym(n,e){return x6(n.writeTree,Rt(n.treePath,e))}function A6(n,e,t,r,s,i){return b6(n.writeTree,n.treePath,e,t,r,s,i)}function iE(n,e,t){return T6(n.writeTree,n.treePath,e,t)}function tR(n,e){return nR(Rt(n.treePath,e),n.writeTree)}function nR(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;ae(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ae(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(t==="child_added"&&i==="child_removed")this.changeMap.set(r,Bd(r,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&i==="child_changed")this.changeMap.set(r,Ud(r,s.oldSnap));else if(t==="child_changed"&&i==="child_added")this.changeMap.set(r,cu(r,e.snapshotNode));else if(t==="child_changed"&&i==="child_changed")this.changeMap.set(r,Bd(r,e.snapshotNode,s.oldSnap));else throw Pu("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const rR=new C6;class oE{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new ia(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return iE(this.writes_,e,r)}}getChildAfterChild(e,t,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Sl(this.viewCache_),i=A6(this.writes_,s,t,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k6(n){return{filter:n}}function R6(n,e){ae(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ae(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function P6(n,e,t,r,s){const i=new N6;let a,c;if(t.type===gs.OVERWRITE){const p=t;p.source.fromUser?a=ww(n,e,p.path,p.snap,r,s,i):(ae(p.source.fromServer,"Unknown source."),c=p.source.tagged||e.serverCache.isFiltered()&&!$e(p.path),a=Jm(n,e,p.path,p.snap,r,s,c,i))}else if(t.type===gs.MERGE){const p=t;p.source.fromUser?a=O6(n,e,p.path,p.children,r,s,i):(ae(p.source.fromServer,"Unknown source."),c=p.source.tagged||e.serverCache.isFiltered(),a=Ew(n,e,p.path,p.children,r,s,c,i))}else if(t.type===gs.ACK_USER_WRITE){const p=t;p.revert?a=V6(n,e,p.path,r,s,i):a=L6(n,e,p.path,p.affectedTree,r,s,i)}else if(t.type===gs.LISTEN_COMPLETE)a=M6(n,e,t.path,r,i);else throw Pu("Unknown operation type: "+t.type);const h=i.getChanges();return D6(e,a,h),{viewCache:a,changes:h}}function D6(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Km(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&t.push(Yk(Km(e)))}}function sR(n,e,t,r,s,i){const a=e.eventCache;if(Ym(r,t)!=null)return e;{let c,h;if($e(t))if(ae(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=Sl(e),g=p instanceof Oe?p:Oe.EMPTY_NODE,y=sE(r,g);c=n.filter.updateFullNode(e.eventCache.getNode(),y,i)}else{const p=Qm(r,Sl(e));c=n.filter.updateFullNode(e.eventCache.getNode(),p,i)}else{const p=ze(t);if(p===".priority"){ae(sa(t)===1,"Can't have a priority with additional path components");const g=a.getNode();h=e.serverCache.getNode();const y=NS(r,t,g,h);y!=null?c=n.filter.updatePriority(g,y):c=a.getNode()}else{const g=mt(t);let y;if(a.isCompleteForChild(p)){h=e.serverCache.getNode();const E=NS(r,t,a.getNode(),h);E!=null?y=a.getNode().getImmediateChild(p).updateChild(g,E):y=a.getNode().getImmediateChild(p)}else y=iE(r,p,e.serverCache);y!=null?c=n.filter.updateChild(a.getNode(),p,y,g,s,i):c=a.getNode()}}return gd(e,c,a.isFullyInitialized()||$e(t),n.filter.filtersNodes())}}function Jm(n,e,t,r,s,i,a,c){const h=e.serverCache;let p;const g=a?n.filter:n.filter.getIndexedFilter();if($e(t))p=g.updateFullNode(h.getNode(),r,null);else if(g.filtersNodes()&&!h.isFiltered()){const x=h.getNode().updateChild(t,r);p=g.updateFullNode(h.getNode(),x,null)}else{const x=ze(t);if(!h.isCompleteForPath(t)&&sa(t)>1)return e;const P=mt(t),M=h.getNode().getImmediateChild(x).updateChild(P,r);x===".priority"?p=g.updatePriority(h.getNode(),M):p=g.updateChild(h.getNode(),x,M,P,rR,null)}const y=Jk(e,p,h.isFullyInitialized()||$e(t),g.filtersNodes()),E=new oE(s,y,i);return sR(n,y,t,s,E,c)}function ww(n,e,t,r,s,i,a){const c=e.eventCache;let h,p;const g=new oE(s,e,i);if($e(t))p=n.filter.updateFullNode(e.eventCache.getNode(),r,a),h=gd(e,p,!0,n.filter.filtersNodes());else{const y=ze(t);if(y===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),r),h=gd(e,p,c.isFullyInitialized(),c.isFiltered());else{const E=mt(t),x=c.getNode().getImmediateChild(y);let P;if($e(E))P=r;else{const O=g.getCompleteChild(y);O!=null?K0(E)===".priority"&&O.getChild($k(E)).isEmpty()?P=O:P=O.updateChild(E,r):P=Oe.EMPTY_NODE}if(x.equals(P))h=e;else{const O=n.filter.updateChild(c.getNode(),y,P,E,g,a);h=gd(e,O,c.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function CS(n,e){return n.eventCache.isCompleteForChild(e)}function O6(n,e,t,r,s,i,a){let c=e;return r.foreach((h,p)=>{const g=Rt(t,h);CS(e,ze(g))&&(c=ww(n,c,g,p,s,i,a))}),r.foreach((h,p)=>{const g=Rt(t,h);CS(e,ze(g))||(c=ww(n,c,g,p,s,i,a))}),c}function kS(n,e,t){return t.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Ew(n,e,t,r,s,i,a,c){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,p;$e(t)?p=r:p=new _t(null).setTree(t,r);const g=e.serverCache.getNode();return p.children.inorderTraversal((y,E)=>{if(g.hasChild(y)){const x=e.serverCache.getNode().getImmediateChild(y),P=kS(n,x,E);h=Jm(n,h,new lt(y),P,s,i,a,c)}}),p.children.inorderTraversal((y,E)=>{const x=!e.serverCache.isCompleteForChild(y)&&E.value===null;if(!g.hasChild(y)&&!x){const P=e.serverCache.getNode().getImmediateChild(y),O=kS(n,P,E);h=Jm(n,h,new lt(y),O,s,i,a,c)}}),h}function L6(n,e,t,r,s,i,a){if(Ym(s,t)!=null)return e;const c=e.serverCache.isFiltered(),h=e.serverCache;if(r.value!=null){if($e(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return Jm(n,e,t,h.getNode().getChild(t),s,i,c,a);if($e(t)){let p=new _t(null);return h.getNode().forEachChild(ei,(g,y)=>{p=p.set(new lt(g),y)}),Ew(n,e,t,p,s,i,c,a)}else return e}else{let p=new _t(null);return r.foreach((g,y)=>{const E=Rt(t,g);h.isCompleteForPath(E)&&(p=p.set(g,h.getNode().getChild(E)))}),Ew(n,e,t,p,s,i,c,a)}}function M6(n,e,t,r,s){const i=e.serverCache,a=Jk(e,i.getNode(),i.isFullyInitialized()||$e(t),i.isFiltered());return sR(n,a,t,r,rR,s)}function V6(n,e,t,r,s,i){let a;if(Ym(r,t)!=null)return e;{const c=new oE(r,e,s),h=e.eventCache.getNode();let p;if($e(t)||ze(t)===".priority"){let g;if(e.serverCache.isFullyInitialized())g=Qm(r,Sl(e));else{const y=e.serverCache.getNode();ae(y instanceof Oe,"serverChildren would be complete if leaf node"),g=sE(r,y)}g=g,p=n.filter.updateFullNode(h,g,i)}else{const g=ze(t);let y=iE(r,g,e.serverCache);y==null&&e.serverCache.isCompleteForChild(g)&&(y=h.getImmediateChild(g)),y!=null?p=n.filter.updateChild(h,g,y,mt(t),c,i):e.eventCache.getNode().hasChild(g)?p=n.filter.updateChild(h,g,Oe.EMPTY_NODE,mt(t),c,i):p=h,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Qm(r,Sl(e)),a.isLeafNode()&&(p=n.filter.updateFullNode(p,a,i)))}return a=e.serverCache.isFullyInitialized()||Ym(r,nt())!=null,gd(e,p,a,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new eE(r.getIndex()),i=XF(r);this.processor_=k6(i);const a=t.serverCache,c=t.eventCache,h=s.updateFullNode(Oe.EMPTY_NODE,a.getNode(),null),p=i.updateFullNode(Oe.EMPTY_NODE,c.getNode(),null),g=new ia(h,a.isFullyInitialized(),s.filtersNodes()),y=new ia(p,c.isFullyInitialized(),i.filtersNodes());this.viewCache_=Gg(y,g),this.eventGenerator_=new c6(this.query_)}get query(){return this.query_}}function F6(n){return n.viewCache_.serverCache.getNode()}function U6(n){return Km(n.viewCache_)}function B6(n,e){const t=Sl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!$e(e)&&!t.getImmediateChild(ze(e)).isEmpty())?t.getChild(e):null}function RS(n){return n.eventRegistrations_.length===0}function z6(n,e){n.eventRegistrations_.push(e)}function PS(n,e,t){const r=[];if(t){ae(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(i=>{const a=i.createCancelEvent(t,s);a&&r.push(a)})}if(e){let s=[];for(let i=0;i<n.eventRegistrations_.length;++i){const a=n.eventRegistrations_[i];if(!a.matches(e))s.push(a);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(i+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return r}function DS(n,e,t,r){e.type===gs.MERGE&&e.source.queryId!==null&&(ae(Sl(n.viewCache_),"We should always have a full cache before handling merges"),ae(Km(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,i=P6(n.processor_,s,e,t,r);return R6(n.processor_,i.viewCache),ae(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=i.viewCache,iR(n,i.changes,i.viewCache.eventCache.getNode(),null)}function $6(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(yt,(i,a)=>{r.push(cu(i,a))}),t.isFullyInitialized()&&r.push(Yk(t.getNode())),iR(n,r,t.getNode(),e)}function iR(n,e,t,r){const s=r?[r]:n.eventRegistrations_;return u6(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xm;class oR{constructor(){this.views=new Map}}function H6(n){ae(!Xm,"__referenceConstructor has already been defined"),Xm=n}function W6(){return ae(Xm,"Reference.ts has not been loaded"),Xm}function q6(n){return n.views.size===0}function aE(n,e,t,r){const s=e.source.queryId;if(s!==null){const i=n.views.get(s);return ae(i!=null,"SyncTree gave us an op for an invalid query."),DS(i,e,t,r)}else{let i=[];for(const a of n.views.values())i=i.concat(DS(a,e,t,r));return i}}function aR(n,e,t,r,s){const i=e._queryIdentifier,a=n.views.get(i);if(!a){let c=Qm(t,s?r:null),h=!1;c?h=!0:r instanceof Oe?(c=sE(t,r),h=!1):(c=Oe.EMPTY_NODE,h=!1);const p=Gg(new ia(c,h,!1),new ia(r,s,!1));return new j6(e,p)}return a}function G6(n,e,t,r,s,i){const a=aR(n,e,r,s,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,a),z6(a,t),$6(a,t)}function K6(n,e,t,r){const s=e._queryIdentifier,i=[];let a=[];const c=oa(n);if(s==="default")for(const[h,p]of n.views.entries())a=a.concat(PS(p,t,r)),RS(p)&&(n.views.delete(h),p.query._queryParams.loadsAllData()||i.push(p.query));else{const h=n.views.get(s);h&&(a=a.concat(PS(h,t,r)),RS(h)&&(n.views.delete(s),h.query._queryParams.loadsAllData()||i.push(h.query)))}return c&&!oa(n)&&i.push(new(W6())(e._repo,e._path)),{removed:i,events:a}}function lR(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Yo(n,e){let t=null;for(const r of n.views.values())t=t||B6(r,e);return t}function cR(n,e){if(e._queryParams.loadsAllData())return Qg(n);{const r=e._queryIdentifier;return n.views.get(r)}}function uR(n,e){return cR(n,e)!=null}function oa(n){return Qg(n)!=null}function Qg(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zm;function Q6(n){ae(!Zm,"__referenceConstructor has already been defined"),Zm=n}function Y6(){return ae(Zm,"Reference.ts has not been loaded"),Zm}let J6=1;class OS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new _t(null),this.pendingWriteTree_=S6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function lE(n,e,t,r,s){return p6(n.pendingWriteTree_,e,t,r,s),s?Uu(n,new bl(tE(),e,t)):[]}function X6(n,e,t,r){m6(n.pendingWriteTree_,e,t,r);const s=_t.fromObject(t);return Uu(n,new uu(tE(),e,s))}function Ho(n,e,t=!1){const r=g6(n.pendingWriteTree_,e);if(_6(n.pendingWriteTree_,e)){let i=new _t(null);return r.snap!=null?i=i.set(nt(),!0):En(r.children,a=>{i=i.set(new lt(a),!0)}),Uu(n,new Gm(r.path,i,t))}else return[]}function Tf(n,e,t){return Uu(n,new bl(nE(),e,t))}function Z6(n,e,t){const r=_t.fromObject(t);return Uu(n,new uu(nE(),e,r))}function eU(n,e){return Uu(n,new $d(nE(),e))}function tU(n,e,t){const r=cE(n,t);if(r){const s=uE(r),i=s.path,a=s.queryId,c=Qn(i,e),h=new $d(rE(a),c);return hE(n,i,h)}else return[]}function eg(n,e,t,r,s=!1){const i=e._path,a=n.syncPointTree_.get(i);let c=[];if(a&&(e._queryIdentifier==="default"||uR(a,e))){const h=K6(a,e,t,r);q6(a)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const p=h.removed;if(c=h.events,!s){const g=p.findIndex(E=>E._queryParams.loadsAllData())!==-1,y=n.syncPointTree_.findOnPath(i,(E,x)=>oa(x));if(g&&!y){const E=n.syncPointTree_.subtree(i);if(!E.isEmpty()){const x=sU(E);for(let P=0;P<x.length;++P){const O=x[P],M=O.query,X=pR(n,O);n.listenProvider_.startListening(yd(M),Hd(n,M),X.hashFn,X.onComplete)}}}!y&&p.length>0&&!r&&(g?n.listenProvider_.stopListening(yd(e),null):p.forEach(E=>{const x=n.queryToTagMap.get(Jg(E));n.listenProvider_.stopListening(yd(E),x)}))}iU(n,p)}return c}function hR(n,e,t,r){const s=cE(n,r);if(s!=null){const i=uE(s),a=i.path,c=i.queryId,h=Qn(a,e),p=new bl(rE(c),h,t);return hE(n,a,p)}else return[]}function nU(n,e,t,r){const s=cE(n,r);if(s){const i=uE(s),a=i.path,c=i.queryId,h=Qn(a,e),p=_t.fromObject(t),g=new uu(rE(c),h,p);return hE(n,a,g)}else return[]}function Iw(n,e,t,r=!1){const s=e._path;let i=null,a=!1;n.syncPointTree_.foreachOnPath(s,(E,x)=>{const P=Qn(E,s);i=i||Yo(x,P),a=a||oa(x)});let c=n.syncPointTree_.get(s);c?(a=a||oa(c),i=i||Yo(c,nt())):(c=new oR,n.syncPointTree_=n.syncPointTree_.set(s,c));let h;i!=null?h=!0:(h=!1,i=Oe.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((x,P)=>{const O=Yo(P,nt());O&&(i=i.updateImmediateChild(x,O))}));const p=uR(c,e);if(!p&&!e._queryParams.loadsAllData()){const E=Jg(e);ae(!n.queryToTagMap.has(E),"View does not exist, but we have a tag");const x=oU();n.queryToTagMap.set(E,x),n.tagToQueryMap.set(x,E)}const g=Kg(n.pendingWriteTree_,s);let y=G6(c,e,t,g,i,h);if(!p&&!a&&!r){const E=cR(c,e);y=y.concat(aU(n,e,E))}return y}function Yg(n,e,t){const s=n.pendingWriteTree_,i=n.syncPointTree_.findOnPath(e,(a,c)=>{const h=Qn(a,e),p=Yo(c,h);if(p)return p});return eR(s,e,i,t,!0)}function rU(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(p,g)=>{const y=Qn(p,t);r=r||Yo(g,y)});let s=n.syncPointTree_.get(t);s?r=r||Yo(s,nt()):(s=new oR,n.syncPointTree_=n.syncPointTree_.set(t,s));const i=r!=null,a=i?new ia(r,!0,!1):null,c=Kg(n.pendingWriteTree_,e._path),h=aR(s,e,c,i?a.getNode():Oe.EMPTY_NODE,i);return U6(h)}function Uu(n,e){return dR(e,n.syncPointTree_,null,Kg(n.pendingWriteTree_,nt()))}function dR(n,e,t,r){if($e(n.path))return fR(n,e,t,r);{const s=e.get(nt());t==null&&s!=null&&(t=Yo(s,nt()));let i=[];const a=ze(n.path),c=n.operationForChild(a),h=e.children.get(a);if(h&&c){const p=t?t.getImmediateChild(a):null,g=tR(r,a);i=i.concat(dR(c,h,p,g))}return s&&(i=i.concat(aE(s,n,r,t))),i}}function fR(n,e,t,r){const s=e.get(nt());t==null&&s!=null&&(t=Yo(s,nt()));let i=[];return e.children.inorderTraversal((a,c)=>{const h=t?t.getImmediateChild(a):null,p=tR(r,a),g=n.operationForChild(a);g&&(i=i.concat(fR(g,c,h,p)))}),s&&(i=i.concat(aE(s,n,r,t))),i}function pR(n,e){const t=e.query,r=Hd(n,t);return{hashFn:()=>(F6(e)||Oe.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?tU(n,t._path,r):eU(n,t._path);{const i=X3(s,t);return eg(n,t,null,i)}}}}function Hd(n,e){const t=Jg(e);return n.queryToTagMap.get(t)}function Jg(n){return n._path.toString()+"$"+n._queryIdentifier}function cE(n,e){return n.tagToQueryMap.get(e)}function uE(n){const e=n.indexOf("$");return ae(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new lt(n.substr(0,e))}}function hE(n,e,t){const r=n.syncPointTree_.get(e);ae(r,"Missing sync point for query tag that we're tracking");const s=Kg(n.pendingWriteTree_,e);return aE(r,t,s,null)}function sU(n){return n.fold((e,t,r)=>{if(t&&oa(t))return[Qg(t)];{let s=[];return t&&(s=lR(t)),En(r,(i,a)=>{s=s.concat(a)}),s}})}function yd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(Y6())(n._repo,n._path):n}function iU(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const s=Jg(r),i=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(i)}}}function oU(){return J6++}function aU(n,e,t){const r=e._path,s=Hd(n,e),i=pR(n,t),a=n.listenProvider_.startListening(yd(e),s,i.hashFn,i.onComplete),c=n.syncPointTree_.subtree(r);if(s)ae(!oa(c.value),"If we're adding a query, it shouldn't be shadowed");else{const h=c.fold((p,g,y)=>{if(!$e(p)&&g&&oa(g))return[Qg(g).query];{let E=[];return g&&(E=E.concat(lR(g).map(x=>x.query))),En(y,(x,P)=>{E=E.concat(P)}),E}});for(let p=0;p<h.length;++p){const g=h[p];n.listenProvider_.stopListening(yd(g),Hd(n,g))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new dE(t)}node(){return this.node_}}class fE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Rt(this.path_,e);return new fE(this.syncTree_,t)}node(){return Yg(this.syncTree_,this.path_)}}const lU=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},LS=function(n,e,t){if(!n||typeof n!="object")return n;if(ae(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return cU(n[".sv"],e,t);if(typeof n[".sv"]=="object")return uU(n[".sv"],e);ae(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},cU=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ae(!1,"Unexpected server value: "+n)}},uU=function(n,e,t){n.hasOwnProperty("increment")||ae(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&ae(!1,"Unexpected increment value: "+r);const s=e.node();if(ae(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const a=s.getValue();return typeof a!="number"?r:a+r},mR=function(n,e,t,r){return mE(e,new fE(t,n),r)},pE=function(n,e,t){return mE(n,new dE(e),t)};function mE(n,e,t){const r=n.getPriority().val(),s=LS(r,e.getImmediateChild(".priority"),t);let i;if(n.isLeafNode()){const a=n,c=LS(a.getValue(),e,t);return c!==a.getValue()||s!==a.getPriority().val()?new mn(c,Ft(s)):n}else{const a=n;return i=a,s!==a.getPriority().val()&&(i=i.updatePriority(new mn(s))),a.forEachChild(yt,(c,h)=>{const p=mE(h,e.getImmediateChild(c),t);p!==h&&(i=i.updateImmediateChild(c,p))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Xg(n,e){let t=e instanceof lt?e:new lt(e),r=n,s=ze(t);for(;s!==null;){const i=El(r.node.children,s)||{children:{},childCount:0};r=new gE(s,r,i),t=mt(t),s=ze(t)}return r}function Gl(n){return n.node.value}function _E(n,e){n.node.value=e,Tw(n)}function gR(n){return n.node.childCount>0}function hU(n){return Gl(n)===void 0&&!gR(n)}function Zg(n,e){En(n.node.children,(t,r)=>{e(new gE(t,n,r))})}function _R(n,e,t,r){t&&e(n),Zg(n,s=>{_R(s,e,!0)})}function dU(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function xf(n){return new lt(n.parent===null?n.name:xf(n.parent)+"/"+n.name)}function Tw(n){n.parent!==null&&fU(n.parent,n.name,n)}function fU(n,e,t){const r=hU(t),s=Or(n.node.children,e);r&&s?(delete n.node.children[e],n.node.childCount--,Tw(n)):!r&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Tw(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=/[\[\].#$\/\u0000-\u001F\u007F]/,mU=/[\[\].#$\u0000-\u001F\u007F]/,Cv=10*1024*1024,e_=function(n){return typeof n=="string"&&n.length!==0&&!pU.test(n)},yR=function(n){return typeof n=="string"&&n.length!==0&&!mU.test(n)},gU=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yR(n)},Wd=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!$g(n)||n&&typeof n=="object"&&Or(n,".sv")},li=function(n,e,t,r){r&&e===void 0||bf(dr(n,"value"),e,t)},bf=function(n,e,t){const r=t instanceof lt?new PF(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+tl(r));if(typeof e=="function")throw new Error(n+"contains a function "+tl(r)+" with contents = "+e.toString());if($g(e))throw new Error(n+"contains "+e.toString()+" "+tl(r));if(typeof e=="string"&&e.length>Cv/3&&kg(e)>Cv)throw new Error(n+"contains a string greater than "+Cv+" utf8 bytes "+tl(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(En(e,(a,c)=>{if(a===".value")s=!0;else if(a!==".priority"&&a!==".sv"&&(i=!0,!e_(a)))throw new Error(n+" contains an invalid key ("+a+") "+tl(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);DF(r,a),bf(n,c,r),OF(r)}),s&&i)throw new Error(n+' contains ".value" child '+tl(r)+" in addition to actual children.")}},_U=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const i=Fd(r);for(let a=0;a<i.length;a++)if(!(i[a]===".priority"&&a===i.length-1)){if(!e_(i[a]))throw new Error(n+"contains an invalid key ("+i[a]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(RF);let s=null;for(t=0;t<e.length;t++){if(r=e[t],s!==null&&Qr(s,r))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},vR=function(n,e,t,r){const s=dr(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];En(e,(a,c)=>{const h=new lt(a);if(bf(s,c,Rt(t,h)),K0(h)===".priority"&&!Wd(c))throw new Error(s+"contains an invalid value for '"+h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(h)}),_U(s,i)},yE=function(n,e,t){if($g(e))throw new Error(dr(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Wd(e))throw new Error(dr(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Sf=function(n,e,t,r){if(t!==void 0&&!e_(t))throw new Error(dr(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},qd=function(n,e,t,r){if(!yR(t))throw new Error(dr(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},yU=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),qd(n,e,t)},Yr=function(n,e){if(ze(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},wR=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!e_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!gU(t))throw new Error(dr(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function t_(n,e){let t=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();t!==null&&!Q0(i,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:i}),t.events.push(s)}t&&n.eventLists_.push(t)}function ER(n,e,t){t_(n,t),IR(n,r=>Q0(r,e))}function Lr(n,e,t){t_(n,t),IR(n,r=>Qr(r,e)||Qr(e,r))}function IR(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const s=n.eventLists_[r];if(s){const i=s.path;e(i)?(wU(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function wU(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();yl&&vn("event: "+t.toString()),ju(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR="repo_interrupt",EU=25;class IU{constructor(e,t,r,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new vU,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=qm(),this.transactionQueueTree_=new gE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function TU(n,e,t){if(n.stats_=q0(n.repoInfo_),n.forceRestClient_||nF())n.server_=new Wm(n.repoInfo_,(r,s,i,a)=>{MS(n,r,s,i,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>VS(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{an(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new $i(n.repoInfo_,e,(r,s,i,a)=>{MS(n,r,s,i,a)},r=>{VS(n,r)},r=>{xU(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=aF(n.repoInfo_,()=>new l6(n.stats_,n.server_)),n.infoData_=new r6,n.infoSyncTree_=new OS({startListening:(r,s,i,a)=>{let c=[];const h=n.infoData_.getNode(r._path);return h.isEmpty()||(c=Tf(n.infoSyncTree_,r._path,h),setTimeout(()=>{a("ok")},0)),c},stopListening:()=>{}}),vE(n,"connected",!1),n.serverSyncTree_=new OS({startListening:(r,s,i,a)=>(n.server_.listen(r,i,s,(c,h)=>{const p=a(c,h);Lr(n.eventQueue_,r._path,p)}),[]),stopListening:(r,s)=>{n.server_.unlisten(r,s)}})}function xR(n){const t=n.infoData_.getNode(new lt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Af(n){return lU({timestamp:xR(n)})}function MS(n,e,t,r,s){n.dataUpdateCount++;const i=new lt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let a=[];if(s)if(r){const h=Om(t,p=>Ft(p));a=nU(n.serverSyncTree_,i,h,s)}else{const h=Ft(t);a=hR(n.serverSyncTree_,i,h,s)}else if(r){const h=Om(t,p=>Ft(p));a=Z6(n.serverSyncTree_,i,h)}else{const h=Ft(t);a=Tf(n.serverSyncTree_,i,h)}let c=i;a.length>0&&(c=du(n,i)),Lr(n.eventQueue_,c,a)}function VS(n,e){vE(n,"connected",e),e===!1&&AU(n)}function xU(n,e){En(e,(t,r)=>{vE(n,t,r)})}function vE(n,e,t){const r=new lt("/.info/"+e),s=Ft(t);n.infoData_.updateSnapshot(r,s);const i=Tf(n.infoSyncTree_,r,s);Lr(n.eventQueue_,r,i)}function n_(n){return n.nextWriteId_++}function bU(n,e,t){const r=rU(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(s=>{const i=Ft(s).withIndex(e._queryParams.getIndex());Iw(n.serverSyncTree_,e,t,!0);let a;if(e._queryParams.loadsAllData())a=Tf(n.serverSyncTree_,e._path,i);else{const c=Hd(n.serverSyncTree_,e);a=hR(n.serverSyncTree_,e._path,i,c)}return Lr(n.eventQueue_,e._path,a),eg(n.serverSyncTree_,e,t,null,!0),i},s=>(Bu(n,"get for query "+an(e)+" failed: "+s),Promise.reject(new Error(s))))}function wE(n,e,t,r,s){Bu(n,"set",{path:e.toString(),value:t,priority:r});const i=Af(n),a=Ft(t,r),c=Yg(n.serverSyncTree_,e),h=pE(a,c,i),p=n_(n),g=lE(n.serverSyncTree_,e,h,p,!0);t_(n.eventQueue_,g),n.server_.put(e.toString(),a.val(!0),(E,x)=>{const P=E==="ok";P||Bn("set at "+e+" failed: "+E);const O=Ho(n.serverSyncTree_,p,!P);Lr(n.eventQueue_,e,O),aa(n,s,E,x)});const y=IE(n,e);du(n,y),Lr(n.eventQueue_,y,[])}function SU(n,e,t,r){Bu(n,"update",{path:e.toString(),value:t});let s=!0;const i=Af(n),a={};if(En(t,(c,h)=>{s=!1,a[c]=mR(Rt(e,c),Ft(h),n.serverSyncTree_,i)}),s)vn("update() called with empty data.  Don't do anything."),aa(n,r,"ok",void 0);else{const c=n_(n),h=X6(n.serverSyncTree_,e,a,c);t_(n.eventQueue_,h),n.server_.merge(e.toString(),t,(p,g)=>{const y=p==="ok";y||Bn("update at "+e+" failed: "+p);const E=Ho(n.serverSyncTree_,c,!y),x=E.length>0?du(n,e):e;Lr(n.eventQueue_,x,E),aa(n,r,p,g)}),En(t,p=>{const g=IE(n,Rt(e,p));du(n,g)}),Lr(n.eventQueue_,e,[])}}function AU(n){Bu(n,"onDisconnectEvents");const e=Af(n),t=qm();gw(n.onDisconnect_,nt(),(s,i)=>{const a=mR(s,i,n.serverSyncTree_,e);Fu(t,s,a)});let r=[];gw(t,nt(),(s,i)=>{r=r.concat(Tf(n.serverSyncTree_,s,i));const a=IE(n,s);du(n,a)}),n.onDisconnect_=qm(),Lr(n.eventQueue_,nt(),r)}function NU(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&mw(n.onDisconnect_,e),aa(n,t,r,s)})}function jS(n,e,t,r){const s=Ft(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(i,a)=>{i==="ok"&&Fu(n.onDisconnect_,e,s),aa(n,r,i,a)})}function CU(n,e,t,r,s){const i=Ft(t,r);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,c)=>{a==="ok"&&Fu(n.onDisconnect_,e,i),aa(n,s,a,c)})}function kU(n,e,t,r){if(Dm(t)){vn("onDisconnect().update() called with empty data.  Don't do anything."),aa(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,i)=>{s==="ok"&&En(t,(a,c)=>{const h=Ft(c);Fu(n.onDisconnect_,Rt(e,a),h)}),aa(n,r,s,i)})}function RU(n,e,t){let r;ze(e._path)===".info"?r=Iw(n.infoSyncTree_,e,t):r=Iw(n.serverSyncTree_,e,t),ER(n.eventQueue_,e._path,r)}function xw(n,e,t){let r;ze(e._path)===".info"?r=eg(n.infoSyncTree_,e,t):r=eg(n.serverSyncTree_,e,t),ER(n.eventQueue_,e._path,r)}function bR(n){n.persistentConnection_&&n.persistentConnection_.interrupt(TR)}function PU(n){n.persistentConnection_&&n.persistentConnection_.resume(TR)}function Bu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),vn(t,...e)}function aa(n,e,t,r){e&&ju(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let i=s;r&&(i+=": "+r);const a=new Error(i);a.code=s,e(a)}})}function DU(n,e,t,r,s,i){Bu(n,"transaction on "+e);const a={path:e,update:t,onComplete:r,status:null,order:wk(),applyLocally:i,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=EE(n,e,void 0);a.currentInputSnapshot=c;const h=a.update(c.val());if(h===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{bf("transaction failed: Data returned ",h,a.path),a.status=0;const p=Xg(n.transactionQueueTree_,e),g=Gl(p)||[];g.push(a),_E(p,g);let y;typeof h=="object"&&h!==null&&Or(h,".priority")?(y=El(h,".priority"),ae(Wd(y),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):y=(Yg(n.serverSyncTree_,e)||Oe.EMPTY_NODE).getPriority().val();const E=Af(n),x=Ft(h,y),P=pE(x,c,E);a.currentOutputSnapshotRaw=x,a.currentOutputSnapshotResolved=P,a.currentWriteId=n_(n);const O=lE(n.serverSyncTree_,e,P,a.currentWriteId,a.applyLocally);Lr(n.eventQueue_,e,O),r_(n,n.transactionQueueTree_)}}function EE(n,e,t){return Yg(n.serverSyncTree_,e,t)||Oe.EMPTY_NODE}function r_(n,e=n.transactionQueueTree_){if(e||s_(n,e),Gl(e)){const t=AR(n,e);ae(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&OU(n,xf(e),t)}else gR(e)&&Zg(e,t=>{r_(n,t)})}function OU(n,e,t){const r=t.map(p=>p.currentWriteId),s=EE(n,e,r);let i=s;const a=s.hash();for(let p=0;p<t.length;p++){const g=t[p];ae(g.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),g.status=1,g.retryCount++;const y=Qn(e,g.path);i=i.updateChild(y,g.currentOutputSnapshotRaw)}const c=i.val(!0),h=e;n.server_.put(h.toString(),c,p=>{Bu(n,"transaction put response",{path:h.toString(),status:p});let g=[];if(p==="ok"){const y=[];for(let E=0;E<t.length;E++)t[E].status=2,g=g.concat(Ho(n.serverSyncTree_,t[E].currentWriteId)),t[E].onComplete&&y.push(()=>t[E].onComplete(null,!0,t[E].currentOutputSnapshotResolved)),t[E].unwatcher();s_(n,Xg(n.transactionQueueTree_,e)),r_(n,n.transactionQueueTree_),Lr(n.eventQueue_,e,g);for(let E=0;E<y.length;E++)ju(y[E])}else{if(p==="datastale")for(let y=0;y<t.length;y++)t[y].status===3?t[y].status=4:t[y].status=0;else{Bn("transaction at "+h.toString()+" failed: "+p);for(let y=0;y<t.length;y++)t[y].status=4,t[y].abortReason=p}du(n,e)}},a)}function du(n,e){const t=SR(n,e),r=xf(t),s=AR(n,t);return LU(n,s,r),r}function LU(n,e,t){if(e.length===0)return;const r=[];let s=[];const a=e.filter(c=>c.status===0).map(c=>c.currentWriteId);for(let c=0;c<e.length;c++){const h=e[c],p=Qn(t,h.path);let g=!1,y;if(ae(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)g=!0,y=h.abortReason,s=s.concat(Ho(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=EU)g=!0,y="maxretry",s=s.concat(Ho(n.serverSyncTree_,h.currentWriteId,!0));else{const E=EE(n,h.path,a);h.currentInputSnapshot=E;const x=e[c].update(E.val());if(x!==void 0){bf("transaction failed: Data returned ",x,h.path);let P=Ft(x);typeof x=="object"&&x!=null&&Or(x,".priority")||(P=P.updatePriority(E.getPriority()));const M=h.currentWriteId,X=Af(n),W=pE(P,E,X);h.currentOutputSnapshotRaw=P,h.currentOutputSnapshotResolved=W,h.currentWriteId=n_(n),a.splice(a.indexOf(M),1),s=s.concat(lE(n.serverSyncTree_,h.path,W,h.currentWriteId,h.applyLocally)),s=s.concat(Ho(n.serverSyncTree_,M,!0))}else g=!0,y="nodata",s=s.concat(Ho(n.serverSyncTree_,h.currentWriteId,!0))}Lr(n.eventQueue_,t,s),s=[],g&&(e[c].status=2,(function(E){setTimeout(E,Math.floor(0))})(e[c].unwatcher),e[c].onComplete&&(y==="nodata"?r.push(()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot)):r.push(()=>e[c].onComplete(new Error(y),!1,null))))}s_(n,n.transactionQueueTree_);for(let c=0;c<r.length;c++)ju(r[c]);r_(n,n.transactionQueueTree_)}function SR(n,e){let t,r=n.transactionQueueTree_;for(t=ze(e);t!==null&&Gl(r)===void 0;)r=Xg(r,t),e=mt(e),t=ze(e);return r}function AR(n,e){const t=[];return NR(n,e,t),t.sort((r,s)=>r.order-s.order),t}function NR(n,e,t){const r=Gl(e);if(r)for(let s=0;s<r.length;s++)t.push(r[s]);Zg(e,s=>{NR(n,s,t)})}function s_(n,e){const t=Gl(e);if(t){let r=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[r]=t[s],r++);t.length=r,_E(e,t.length>0?t:void 0)}Zg(e,r=>{s_(n,r)})}function IE(n,e){const t=xf(SR(n,e)),r=Xg(n.transactionQueueTree_,e);return dU(r,s=>{kv(n,s)}),kv(n,r),_R(r,s=>{kv(n,s)}),t}function kv(n,e){const t=Gl(e);if(t){const r=[];let s=[],i=-1;for(let a=0;a<t.length;a++)t[a].status===3||(t[a].status===1?(ae(i===a-1,"All SENT items should be at beginning of queue."),i=a,t[a].status=3,t[a].abortReason="set"):(ae(t[a].status===0,"Unexpected transaction status in abort"),t[a].unwatcher(),s=s.concat(Ho(n.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&r.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));i===-1?_E(e,void 0):t.length=i+1,Lr(n.eventQueue_,xf(e),s);for(let a=0;a<r.length;a++)ju(r[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let s=t[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function VU(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Bn(`Invalid query segment '${t}' in query '${n}'`)}return e}const bw=function(n,e){const t=jU(n),r=t.namespace;t.domain==="firebase.com"&&ai(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ai("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||G3();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Ok(t.host,t.secure,r,s,e,"",r!==t.subdomain),path:new lt(t.pathString)}},jU=function(n){let e="",t="",r="",s="",i="",a=!0,c="https",h=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(c=n.substring(0,p-1),n=n.substring(p+2));let g=n.indexOf("/");g===-1&&(g=n.length);let y=n.indexOf("?");y===-1&&(y=n.length),e=n.substring(0,Math.min(g,y)),g<y&&(s=MU(n.substring(g,y)));const E=VU(n.substring(Math.min(n.length,y)));p=e.indexOf(":"),p>=0?(a=c==="https"||c==="wss",h=parseInt(e.substring(p+1),10)):p=e.length;const x=e.slice(0,p);if(x.toLowerCase()==="localhost")t="localhost";else if(x.split(".").length<=2)t=x;else{const P=e.indexOf(".");r=e.substring(0,P).toLowerCase(),t=e.substring(P+1),i=r}"ns"in E&&(i=E.ns)}return{host:e,port:h,domain:t,subdomain:r,secure:a,scheme:c,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",FU=(function(){let n=0;const e=[];return function(t){const r=t===n;n=t;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=FS.charAt(t%64),t=Math.floor(t/64);ae(t===0,"Cannot push at time == 0");let a=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)a+=FS.charAt(e[s]);return ae(a.length===20,"nextPushId: Length should be 20."),a}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,t,r,s){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+an(this.snapshot.exportVal())}}class kR{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ae(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UU=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new lr;return NU(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Yr("OnDisconnect.remove",this._path);const e=new lr;return jS(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Yr("OnDisconnect.set",this._path),li("OnDisconnect.set",e,this._path,!1);const t=new lr;return jS(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Yr("OnDisconnect.setWithPriority",this._path),li("OnDisconnect.setWithPriority",e,this._path,!1),yE("OnDisconnect.setWithPriority",t);const r=new lr;return CU(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Yr("OnDisconnect.update",this._path),vR("OnDisconnect.update",e,this._path);const t=new lr;return kU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,t,r,s){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=s}get key(){return $e(this._path)?null:K0(this._path)}get ref(){return new es(this._repo,this._path)}get _queryIdentifier(){const e=xS(this._queryParams),t=H0(e);return t==="{}"?"default":t}get _queryObject(){return xS(this._queryParams)}isEqual(e){if(e=ye(e),!(e instanceof pr))return!1;const t=this._repo===e._repo,r=Q0(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+kF(this._path)}}function i_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function va(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ei){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ra)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==Gi)throw new Error(r);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===yt){if(e!=null&&!Wd(e)||t!=null&&!Wd(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ae(n.getIndex()instanceof X0||n.getIndex()===Z0,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function o_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class es extends pr{constructor(e,t){super(e,t,new Wg,!1)}get parent(){const e=$k(this._path);return e===null?null:new es(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let a_=class Sw{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new lt(e),r=Al(this.ref,e);return new Sw(this._node.getChild(t),r,yt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new Sw(s,Al(this.ref,r),yt)))}hasChild(e){const t=new lt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function RR(n,e){return n=ye(n),n._checkNotDeleted("ref"),e!==void 0?Al(n._root,e):n._root}function US(n,e){n=ye(n),n._checkNotDeleted("refFromURL");const t=bw(e,n._repo.repoInfo_.nodeAdmin);wR("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ai("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),RR(n,t.path.toString())}function Al(n,e){return n=ye(n),ze(n._path)===null?yU("child","path",e):qd("child","path",e),new es(n._repo,Rt(n._path,e))}function BU(n,e){n=ye(n),Yr("push",n._path),li("push",e,n._path,!0);const t=xR(n._repo),r=FU(t),s=Al(n,r),i=Al(n,r);let a;return e!=null?a=xE(i,e).then(()=>i):a=Promise.resolve(i),s.then=a.then.bind(a),s.catch=a.then.bind(a,void 0),s}function zU(n){return Yr("remove",n._path),xE(n,null)}function xE(n,e){n=ye(n),Yr("set",n._path),li("set",e,n._path,!1);const t=new lr;return wE(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function $U(n,e){n=ye(n),Yr("setPriority",n._path),yE("setPriority",e);const t=new lr;return wE(n._repo,Rt(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function HU(n,e,t){if(Yr("setWithPriority",n._path),li("setWithPriority",e,n._path,!1),yE("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new lr;return wE(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function WU(n,e){vR("update",e,n._path);const t=new lr;return SU(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function qU(n){n=ye(n);const e=new TE(()=>{}),t=new Nf(e);return bU(n._repo,n,t).then(r=>new a_(r,new es(n._repo,n._path),n._queryParams.getIndex()))}class Nf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new CR("value",this,new a_(e.snapshotNode,new es(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kR(this,e,t):null}matches(e){return e instanceof Nf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class l_{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kR(this,e,t):null}createEvent(e,t){ae(e.childName!=null,"Child events should have a childName.");const r=Al(new es(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new CR(e.type,this,new a_(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof l_?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Cf(n,e,t,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const h=t,p=(g,y)=>{xw(n._repo,n,c),h(g,y)};p.userCallback=t.userCallback,p.context=t.context,t=p}const a=new TE(t,i||void 0),c=e==="value"?new Nf(a):new l_(e,a);return RU(n._repo,n,c),()=>xw(n._repo,n,c)}function Aw(n,e,t,r){return Cf(n,"value",e,t,r)}function BS(n,e,t,r){return Cf(n,"child_added",e,t,r)}function zS(n,e,t,r){return Cf(n,"child_changed",e,t,r)}function $S(n,e,t,r){return Cf(n,"child_moved",e,t,r)}function HS(n,e,t,r){return Cf(n,"child_removed",e,t,r)}function WS(n,e,t){let r=null;const s=t?new TE(t):null;e==="value"?r=new Nf(s):e&&(r=new l_(e,s)),xw(n._repo,n,r)}let Es=class{},PR=class extends Es{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){li("endAt",this._value,e._path,!0);const t=pw(e._queryParams,this._value,this._key);if(o_(t),va(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new pr(e._repo,e._path,t,e._orderByCalled)}};function GU(n,e){return Sf("endAt","key",e),new PR(n,e)}class KU extends Es{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){li("endBefore",this._value,e._path,!1);const t=n6(e._queryParams,this._value,this._key);if(o_(t),va(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new pr(e._repo,e._path,t,e._orderByCalled)}}function QU(n,e){return Sf("endBefore","key",e),new KU(n,e)}let DR=class extends Es{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){li("startAt",this._value,e._path,!0);const t=fw(e._queryParams,this._value,this._key);if(o_(t),va(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new pr(e._repo,e._path,t,e._orderByCalled)}};function YU(n=null,e){return Sf("startAt","key",e),new DR(n,e)}class JU extends Es{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){li("startAfter",this._value,e._path,!1);const t=t6(e._queryParams,this._value,this._key);if(o_(t),va(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new pr(e._repo,e._path,t,e._orderByCalled)}}function XU(n,e){return Sf("startAfter","key",e),new JU(n,e)}class ZU extends Es{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new pr(e._repo,e._path,ZF(e._queryParams,this._limit),e._orderByCalled)}}function eB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ZU(n)}class tB extends Es{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new pr(e._repo,e._path,e6(e._queryParams,this._limit),e._orderByCalled)}}function nB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new tB(n)}class rB extends Es{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){i_(e,"orderByChild");const t=new lt(this._path);if($e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new X0(t),s=qg(e._queryParams,r);return va(s),new pr(e._repo,e._path,s,!0)}}function sB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return qd("orderByChild","path",n),new rB(n)}class iB extends Es{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){i_(e,"orderByKey");const t=qg(e._queryParams,ei);return va(t),new pr(e._repo,e._path,t,!0)}}function oB(){return new iB}class aB extends Es{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){i_(e,"orderByPriority");const t=qg(e._queryParams,yt);return va(t),new pr(e._repo,e._path,t,!0)}}function lB(){return new aB}class cB extends Es{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){i_(e,"orderByValue");const t=qg(e._queryParams,Z0);return va(t),new pr(e._repo,e._path,t,!0)}}function uB(){return new cB}class hB extends Es{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(li("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new PR(this._value,this._key)._apply(new DR(this._value,this._key)._apply(e))}}function dB(n,e){return Sf("equalTo","key",e),new hB(n,e)}function fs(n,...e){let t=ye(n);for(const r of e)t=r._apply(t);return t}H6(es);Q6(es);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB="FIREBASE_DATABASE_EMULATOR_HOST",Nw={};let pB=!1;function mB(n,e,t,r){const s=e.lastIndexOf(":"),i=e.substring(0,s),a=_a(i);n.repoInfo_=new Ok(e,a,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function OR(n,e,t,r,s){let i=r||n.options.databaseURL;i===void 0&&(n.options.projectId||ai("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vn("Using default host for project ",n.options.projectId),i=`${n.options.projectId}-default-rtdb.firebaseio.com`);let a=bw(i,s),c=a.repoInfo,h,p;typeof process<"u"&&oS&&(p=oS[fB]),p?(h=!0,i=`http://${p}?ns=${c.namespace}`,a=bw(i,s),c=a.repoInfo):h=!a.repoInfo.secure;const g=s&&h?new tu(tu.OWNER):new sF(n.name,n.options,e);wR("Invalid Firebase Database URL",a),$e(a.path)||ai("Database URL must point to the root of a Firebase Database (not including a child path).");const y=_B(c,n,g,new rF(n,t));return new yB(y,n)}function gB(n,e){const t=Nw[e];(!t||t[n.key]!==n)&&ai(`Database ${e}(${n.repoInfo_}) has already been deleted.`),bR(n),delete t[n.key]}function _B(n,e,t,r){let s=Nw[e.name];s||(s={},Nw[e.name]=s);let i=s[n.toURLString()];return i&&ai("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new IU(n,pB,t,r),s[n.toURLString()]=i,i}let yB=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(TU(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new es(this._repo,nt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(gB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ai("Cannot call "+e+" on a deleted database.")}};function LR(){lu.IS_TRANSPORT_INITIALIZED&&Bn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vB(){LR(),$o.forceDisallow()}function wB(){LR(),Kr.forceDisallow(),$o.forceAllow()}function EB(n,e,t,r={}){n=ye(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,i=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&Hi(r,i.repoInfo_.emulatorOptions))return;ai("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ai('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new tu(tu.OWNER);else if(r.mockUserToken){const c=typeof r.mockUserToken=="string"?r.mockUserToken:eC(r.mockUserToken,n.app.options.projectId);a=new tu(c)}_a(e)&&(m0(e),g0("Database",!0)),mB(i,s,r,a)}function IB(n){n=ye(n),n._checkNotDeleted("goOffline"),bR(n._repo)}function TB(n){n=ye(n),n._checkNotDeleted("goOnline"),PU(n._repo)}function xB(n,e){Ik(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bB(n){yk(Ji),fr(new rn("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return OR(r,s,i,t)},"PUBLIC").setMultipleInstances(!0)),Cn(aS,lS,n),Cn(aS,lS,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB={".sv":"timestamp"};function AB(){return SB}function NB(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CB=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function kB(n,e,t){if(n=ye(n),Yr("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=(t==null?void 0:t.applyLocally)??!0,s=new lr,i=(c,h,p)=>{let g=null;c?s.reject(c):(g=new a_(p,new es(n._repo,n._path),yt),s.resolve(new CB(h,g)))},a=Aw(n,()=>{});return DU(n._repo,n._path,e,i,a,r),s.promise}$i.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};$i.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};bB();const RB="@firebase/database-compat",PB="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB=new Du("@firebase/database-compat"),MR=function(n){const e="FIREBASE WARNING: "+n;DB.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB=function(n,e,t,r){if(t!==void 0&&typeof t!="boolean")throw new Error(dr(n,e)+"must be a boolean.")},LB=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(dr(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MB{constructor(e){this._delegate=e}cancel(e){Le("OnDisconnect.cancel",0,1,arguments.length),_n("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){Le("OnDisconnect.remove",0,1,arguments.length),_n("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){Le("OnDisconnect.set",1,2,arguments.length),_n("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),s=>t(s)),r}setWithPriority(e,t,r){Le("OnDisconnect.setWithPriority",2,3,arguments.length),_n("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,t);return r&&s.then(()=>r(null),i=>r(i)),s}update(e,t){if(Le("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,MR("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_n("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),s=>t(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VB{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Le("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,t){this._database=e,this._delegate=t}val(){return Le("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Le("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Le("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Le("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Le("DataSnapshot.child",0,1,arguments.length),e=String(e),qd("DataSnapshot.child","path",e),new Jo(this._database,this._delegate.child(e))}hasChild(e){return Le("DataSnapshot.hasChild",1,1,arguments.length),qd("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return Le("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Le("DataSnapshot.forEach",1,1,arguments.length),_n("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Jo(this._database,t)))}hasChildren(){return Le("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Le("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Le("DataSnapshot.ref",0,0,arguments.length),new Rr(this._database,this._delegate.ref)}get ref(){return this.getRef()}}let VR=class qn{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,s){var h;Le("Query.on",2,4,arguments.length),_n("Query.on","callback",t,!1);const i=qn.getCancelAndContextArgs_("Query.on",r,s),a=(p,g)=>{t.call(i.context,new Jo(this.database,p),g)};a.userCallback=t,a.context=i.context;const c=(h=i.cancel)==null?void 0:h.bind(i.context);switch(e){case"value":return Aw(this._delegate,a,c),t;case"child_added":return BS(this._delegate,a,c),t;case"child_removed":return HS(this._delegate,a,c),t;case"child_changed":return zS(this._delegate,a,c),t;case"child_moved":return $S(this._delegate,a,c),t;default:throw new Error(dr("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(Le("Query.off",0,3,arguments.length),LB("Query.off",e),_n("Query.off","callback",t,!0),Nb("Query.off","context",r),t){const s=()=>{};s.userCallback=t,s.context=r,WS(this._delegate,e,s)}else WS(this._delegate,e)}get(){return qU(this._delegate).then(e=>new Jo(this.database,e))}once(e,t,r,s){Le("Query.once",1,4,arguments.length),_n("Query.once","callback",t,!0);const i=qn.getCancelAndContextArgs_("Query.once",r,s),a=new lr,c=(p,g)=>{const y=new Jo(this.database,p);t&&t.call(i.context,y,g),a.resolve(y)};c.userCallback=t,c.context=i.context;const h=p=>{i.cancel&&i.cancel.call(i.context,p),a.reject(p)};switch(e){case"value":Aw(this._delegate,c,h,{onlyOnce:!0});break;case"child_added":BS(this._delegate,c,h,{onlyOnce:!0});break;case"child_removed":HS(this._delegate,c,h,{onlyOnce:!0});break;case"child_changed":zS(this._delegate,c,h,{onlyOnce:!0});break;case"child_moved":$S(this._delegate,c,h,{onlyOnce:!0});break;default:throw new Error(dr("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return a.promise}limitToFirst(e){return Le("Query.limitToFirst",1,1,arguments.length),new qn(this.database,fs(this._delegate,eB(e)))}limitToLast(e){return Le("Query.limitToLast",1,1,arguments.length),new qn(this.database,fs(this._delegate,nB(e)))}orderByChild(e){return Le("Query.orderByChild",1,1,arguments.length),new qn(this.database,fs(this._delegate,sB(e)))}orderByKey(){return Le("Query.orderByKey",0,0,arguments.length),new qn(this.database,fs(this._delegate,oB()))}orderByPriority(){return Le("Query.orderByPriority",0,0,arguments.length),new qn(this.database,fs(this._delegate,lB()))}orderByValue(){return Le("Query.orderByValue",0,0,arguments.length),new qn(this.database,fs(this._delegate,uB()))}startAt(e=null,t){return Le("Query.startAt",0,2,arguments.length),new qn(this.database,fs(this._delegate,YU(e,t)))}startAfter(e=null,t){return Le("Query.startAfter",0,2,arguments.length),new qn(this.database,fs(this._delegate,XU(e,t)))}endAt(e=null,t){return Le("Query.endAt",0,2,arguments.length),new qn(this.database,fs(this._delegate,GU(e,t)))}endBefore(e=null,t){return Le("Query.endBefore",0,2,arguments.length),new qn(this.database,fs(this._delegate,QU(e,t)))}equalTo(e,t){return Le("Query.equalTo",1,2,arguments.length),new qn(this.database,fs(this._delegate,dB(e,t)))}toString(){return Le("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Le("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Le("Query.isEqual",1,1,arguments.length),!(e instanceof qn)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const s={cancel:void 0,context:void 0};if(t&&r)s.cancel=t,_n(e,"cancel",s.cancel,!0),s.context=r,Nb(e,"context",s.context);else if(t)if(typeof t=="object"&&t!==null)s.context=t;else if(typeof t=="function")s.cancel=t;else throw new Error(dr(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new Rr(this.database,new es(this._delegate._repo,this._delegate._path))}};class Rr extends VR{constructor(e,t){super(e,new pr(t._repo,t._path,new Wg,!1)),this.database=e,this._delegate=t}getKey(){return Le("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Le("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Rr(this.database,Al(this._delegate,e))}getParent(){Le("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Rr(this.database,e):null}getRoot(){return Le("Reference.root",0,0,arguments.length),new Rr(this.database,this._delegate.root)}set(e,t){Le("Reference.set",1,2,arguments.length),_n("Reference.set","onComplete",t,!0);const r=xE(this._delegate,e);return t&&r.then(()=>t(null),s=>t(s)),r}update(e,t){if(Le("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,MR("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Yr("Reference.update",this._delegate._path),_n("Reference.update","onComplete",t,!0);const r=WU(this._delegate,e);return t&&r.then(()=>t(null),s=>t(s)),r}setWithPriority(e,t,r){Le("Reference.setWithPriority",2,3,arguments.length),_n("Reference.setWithPriority","onComplete",r,!0);const s=HU(this._delegate,e,t);return r&&s.then(()=>r(null),i=>r(i)),s}remove(e){Le("Reference.remove",0,1,arguments.length),_n("Reference.remove","onComplete",e,!0);const t=zU(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){Le("Reference.transaction",1,3,arguments.length),_n("Reference.transaction","transactionUpdate",e,!1),_n("Reference.transaction","onComplete",t,!0),OB("Reference.transaction","applyLocally",r);const s=kB(this._delegate,e,{applyLocally:r}).then(i=>new VB(i.committed,new Jo(this.database,i.snapshot)));return t&&s.then(i=>t(null,i.committed,i.snapshot),i=>t(i,!1,null)),s}setPriority(e,t){Le("Reference.setPriority",1,2,arguments.length),_n("Reference.setPriority","onComplete",t,!0);const r=$U(this._delegate,e);return t&&r.then(()=>t(null),s=>t(s)),r}push(e,t){Le("Reference.push",0,2,arguments.length),_n("Reference.push","onComplete",t,!0);const r=BU(this._delegate,e),s=r.then(a=>new Rr(this.database,a));t&&s.then(()=>t(null),a=>t(a));const i=new Rr(this.database,r);return i.then=s.then.bind(s),i.catch=s.catch.bind(s,void 0),i}onDisconnect(){return Yr("Reference.onDisconnect",this._delegate._path),new MB(new UU(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:vB,forceLongPolling:wB}}useEmulator(e,t,r={}){EB(this._delegate,e,t,r)}ref(e){if(Le("database.ref",0,1,arguments.length),e instanceof Rr){const t=US(this._delegate,e.toString());return new Rr(this,t)}else{const t=RR(this._delegate,e);return new Rr(this,t)}}refFromURL(e){Le("database.refFromURL",1,1,arguments.length);const r=US(this._delegate,e);return new Rr(this,r)}goOffline(){return Le("database.goOffline",0,0,arguments.length),IB(this._delegate)}goOnline(){return Le("database.goOnline",0,0,arguments.length),TB(this._delegate)}}Gd.ServerValue={TIMESTAMP:AB(),increment:n=>NB(n)};function jB({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:s,namespace:i,nodeAdmin:a=!1}){yk(t);const c=new y0("database-standalone"),h=new Jv("auth-internal",c);h.setComponent(new rn("auth-internal",()=>r,"PRIVATE"));let p;return s&&(p=new Jv("app-check-internal",c),p.setComponent(new rn("app-check-internal",()=>s,"PRIVATE"))),{instance:new Gd(OR(n,h,p,e,a),n),namespace:i}}var FB=Object.freeze({__proto__:null,initStandalone:jB});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB=Gd.ServerValue;function BB(n){n.INTERNAL.registerComponent(new rn("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:t});return new Gd(s,r)},"PUBLIC").setServiceProps({Reference:Rr,Query:VR,Database:Gd,DataSnapshot:Jo,enableLogging:xB,INTERNAL:FB,ServerValue:UB}).setMultipleInstances(!0)),n.registerVersion(RB,PB)}BB(Qt);var qS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xo,jR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,S){function k(){}k.prototype=S.prototype,R.F=S.prototype,R.prototype=new k,R.prototype.constructor=R,R.D=function(D,N,j){for(var C=Array(arguments.length-2),We=2;We<arguments.length;We++)C[We-2]=arguments[We];return S.prototype[N].apply(D,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,S,k){k||(k=0);const D=Array(16);if(typeof S=="string")for(var N=0;N<16;++N)D[N]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(N=0;N<16;++N)D[N]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=R.g[0],k=R.g[1],N=R.g[2];let j=R.g[3],C;C=S+(j^k&(N^j))+D[0]+3614090360&4294967295,S=k+(C<<7&4294967295|C>>>25),C=j+(N^S&(k^N))+D[1]+3905402710&4294967295,j=S+(C<<12&4294967295|C>>>20),C=N+(k^j&(S^k))+D[2]+606105819&4294967295,N=j+(C<<17&4294967295|C>>>15),C=k+(S^N&(j^S))+D[3]+3250441966&4294967295,k=N+(C<<22&4294967295|C>>>10),C=S+(j^k&(N^j))+D[4]+4118548399&4294967295,S=k+(C<<7&4294967295|C>>>25),C=j+(N^S&(k^N))+D[5]+1200080426&4294967295,j=S+(C<<12&4294967295|C>>>20),C=N+(k^j&(S^k))+D[6]+2821735955&4294967295,N=j+(C<<17&4294967295|C>>>15),C=k+(S^N&(j^S))+D[7]+4249261313&4294967295,k=N+(C<<22&4294967295|C>>>10),C=S+(j^k&(N^j))+D[8]+1770035416&4294967295,S=k+(C<<7&4294967295|C>>>25),C=j+(N^S&(k^N))+D[9]+2336552879&4294967295,j=S+(C<<12&4294967295|C>>>20),C=N+(k^j&(S^k))+D[10]+4294925233&4294967295,N=j+(C<<17&4294967295|C>>>15),C=k+(S^N&(j^S))+D[11]+2304563134&4294967295,k=N+(C<<22&4294967295|C>>>10),C=S+(j^k&(N^j))+D[12]+1804603682&4294967295,S=k+(C<<7&4294967295|C>>>25),C=j+(N^S&(k^N))+D[13]+4254626195&4294967295,j=S+(C<<12&4294967295|C>>>20),C=N+(k^j&(S^k))+D[14]+2792965006&4294967295,N=j+(C<<17&4294967295|C>>>15),C=k+(S^N&(j^S))+D[15]+1236535329&4294967295,k=N+(C<<22&4294967295|C>>>10),C=S+(N^j&(k^N))+D[1]+4129170786&4294967295,S=k+(C<<5&4294967295|C>>>27),C=j+(k^N&(S^k))+D[6]+3225465664&4294967295,j=S+(C<<9&4294967295|C>>>23),C=N+(S^k&(j^S))+D[11]+643717713&4294967295,N=j+(C<<14&4294967295|C>>>18),C=k+(j^S&(N^j))+D[0]+3921069994&4294967295,k=N+(C<<20&4294967295|C>>>12),C=S+(N^j&(k^N))+D[5]+3593408605&4294967295,S=k+(C<<5&4294967295|C>>>27),C=j+(k^N&(S^k))+D[10]+38016083&4294967295,j=S+(C<<9&4294967295|C>>>23),C=N+(S^k&(j^S))+D[15]+3634488961&4294967295,N=j+(C<<14&4294967295|C>>>18),C=k+(j^S&(N^j))+D[4]+3889429448&4294967295,k=N+(C<<20&4294967295|C>>>12),C=S+(N^j&(k^N))+D[9]+568446438&4294967295,S=k+(C<<5&4294967295|C>>>27),C=j+(k^N&(S^k))+D[14]+3275163606&4294967295,j=S+(C<<9&4294967295|C>>>23),C=N+(S^k&(j^S))+D[3]+4107603335&4294967295,N=j+(C<<14&4294967295|C>>>18),C=k+(j^S&(N^j))+D[8]+1163531501&4294967295,k=N+(C<<20&4294967295|C>>>12),C=S+(N^j&(k^N))+D[13]+2850285829&4294967295,S=k+(C<<5&4294967295|C>>>27),C=j+(k^N&(S^k))+D[2]+4243563512&4294967295,j=S+(C<<9&4294967295|C>>>23),C=N+(S^k&(j^S))+D[7]+1735328473&4294967295,N=j+(C<<14&4294967295|C>>>18),C=k+(j^S&(N^j))+D[12]+2368359562&4294967295,k=N+(C<<20&4294967295|C>>>12),C=S+(k^N^j)+D[5]+4294588738&4294967295,S=k+(C<<4&4294967295|C>>>28),C=j+(S^k^N)+D[8]+2272392833&4294967295,j=S+(C<<11&4294967295|C>>>21),C=N+(j^S^k)+D[11]+1839030562&4294967295,N=j+(C<<16&4294967295|C>>>16),C=k+(N^j^S)+D[14]+4259657740&4294967295,k=N+(C<<23&4294967295|C>>>9),C=S+(k^N^j)+D[1]+2763975236&4294967295,S=k+(C<<4&4294967295|C>>>28),C=j+(S^k^N)+D[4]+1272893353&4294967295,j=S+(C<<11&4294967295|C>>>21),C=N+(j^S^k)+D[7]+4139469664&4294967295,N=j+(C<<16&4294967295|C>>>16),C=k+(N^j^S)+D[10]+3200236656&4294967295,k=N+(C<<23&4294967295|C>>>9),C=S+(k^N^j)+D[13]+681279174&4294967295,S=k+(C<<4&4294967295|C>>>28),C=j+(S^k^N)+D[0]+3936430074&4294967295,j=S+(C<<11&4294967295|C>>>21),C=N+(j^S^k)+D[3]+3572445317&4294967295,N=j+(C<<16&4294967295|C>>>16),C=k+(N^j^S)+D[6]+76029189&4294967295,k=N+(C<<23&4294967295|C>>>9),C=S+(k^N^j)+D[9]+3654602809&4294967295,S=k+(C<<4&4294967295|C>>>28),C=j+(S^k^N)+D[12]+3873151461&4294967295,j=S+(C<<11&4294967295|C>>>21),C=N+(j^S^k)+D[15]+530742520&4294967295,N=j+(C<<16&4294967295|C>>>16),C=k+(N^j^S)+D[2]+3299628645&4294967295,k=N+(C<<23&4294967295|C>>>9),C=S+(N^(k|~j))+D[0]+4096336452&4294967295,S=k+(C<<6&4294967295|C>>>26),C=j+(k^(S|~N))+D[7]+1126891415&4294967295,j=S+(C<<10&4294967295|C>>>22),C=N+(S^(j|~k))+D[14]+2878612391&4294967295,N=j+(C<<15&4294967295|C>>>17),C=k+(j^(N|~S))+D[5]+4237533241&4294967295,k=N+(C<<21&4294967295|C>>>11),C=S+(N^(k|~j))+D[12]+1700485571&4294967295,S=k+(C<<6&4294967295|C>>>26),C=j+(k^(S|~N))+D[3]+2399980690&4294967295,j=S+(C<<10&4294967295|C>>>22),C=N+(S^(j|~k))+D[10]+4293915773&4294967295,N=j+(C<<15&4294967295|C>>>17),C=k+(j^(N|~S))+D[1]+2240044497&4294967295,k=N+(C<<21&4294967295|C>>>11),C=S+(N^(k|~j))+D[8]+1873313359&4294967295,S=k+(C<<6&4294967295|C>>>26),C=j+(k^(S|~N))+D[15]+4264355552&4294967295,j=S+(C<<10&4294967295|C>>>22),C=N+(S^(j|~k))+D[6]+2734768916&4294967295,N=j+(C<<15&4294967295|C>>>17),C=k+(j^(N|~S))+D[13]+1309151649&4294967295,k=N+(C<<21&4294967295|C>>>11),C=S+(N^(k|~j))+D[4]+4149444226&4294967295,S=k+(C<<6&4294967295|C>>>26),C=j+(k^(S|~N))+D[11]+3174756917&4294967295,j=S+(C<<10&4294967295|C>>>22),C=N+(S^(j|~k))+D[2]+718787259&4294967295,N=j+(C<<15&4294967295|C>>>17),C=k+(j^(N|~S))+D[9]+3951481745&4294967295,R.g[0]=R.g[0]+S&4294967295,R.g[1]=R.g[1]+(N+(C<<21&4294967295|C>>>11))&4294967295,R.g[2]=R.g[2]+N&4294967295,R.g[3]=R.g[3]+j&4294967295}r.prototype.v=function(R,S){S===void 0&&(S=R.length);const k=S-this.blockSize,D=this.C;let N=this.h,j=0;for(;j<S;){if(N==0)for(;j<=k;)s(this,R,j),j+=this.blockSize;if(typeof R=="string"){for(;j<S;)if(D[N++]=R.charCodeAt(j++),N==this.blockSize){s(this,D),N=0;break}}else for(;j<S;)if(D[N++]=R[j++],N==this.blockSize){s(this,D),N=0;break}}this.h=N,this.o+=S},r.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var S=1;S<R.length-8;++S)R[S]=0;S=this.o*8;for(var k=R.length-8;k<R.length;++k)R[k]=S&255,S/=256;for(this.v(R),R=Array(16),S=0,k=0;k<4;++k)for(let D=0;D<32;D+=8)R[S++]=this.g[k]>>>D&255;return R};function i(R,S){var k=c;return Object.prototype.hasOwnProperty.call(k,R)?k[R]:k[R]=S(R)}function a(R,S){this.h=S;const k=[];let D=!0;for(let N=R.length-1;N>=0;N--){const j=R[N]|0;D&&j==S||(k[N]=j,D=!1)}this.g=k}var c={};function h(R){return-128<=R&&R<128?i(R,function(S){return new a([S|0],S<0?-1:0)}):new a([R|0],R<0?-1:0)}function p(R){if(isNaN(R)||!isFinite(R))return y;if(R<0)return M(p(-R));const S=[];let k=1;for(let D=0;R>=k;D++)S[D]=R/k|0,k*=4294967296;return new a(S,0)}function g(R,S){if(R.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(R.charAt(0)=="-")return M(g(R.substring(1),S));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=p(Math.pow(S,8));let D=y;for(let j=0;j<R.length;j+=8){var N=Math.min(8,R.length-j);const C=parseInt(R.substring(j,j+N),S);N<8?(N=p(Math.pow(S,N)),D=D.j(N).add(p(C))):(D=D.j(k),D=D.add(p(C)))}return D}var y=h(0),E=h(1),x=h(16777216);n=a.prototype,n.m=function(){if(O(this))return-M(this).m();let R=0,S=1;for(let k=0;k<this.g.length;k++){const D=this.i(k);R+=(D>=0?D:4294967296+D)*S,S*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P(this))return"0";if(O(this))return"-"+M(this).toString(R);const S=p(Math.pow(R,6));var k=this;let D="";for(;;){const N=Y(k,S).g;k=X(k,N.j(S));let j=((k.g.length>0?k.g[0]:k.h)>>>0).toString(R);if(k=N,P(k))return j+D;for(;j.length<6;)j="0"+j;D=j+D}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function P(R){if(R.h!=0)return!1;for(let S=0;S<R.g.length;S++)if(R.g[S]!=0)return!1;return!0}function O(R){return R.h==-1}n.l=function(R){return R=X(this,R),O(R)?-1:P(R)?0:1};function M(R){const S=R.g.length,k=[];for(let D=0;D<S;D++)k[D]=~R.g[D];return new a(k,~R.h).add(E)}n.abs=function(){return O(this)?M(this):this},n.add=function(R){const S=Math.max(this.g.length,R.g.length),k=[];let D=0;for(let N=0;N<=S;N++){let j=D+(this.i(N)&65535)+(R.i(N)&65535),C=(j>>>16)+(this.i(N)>>>16)+(R.i(N)>>>16);D=C>>>16,j&=65535,C&=65535,k[N]=C<<16|j}return new a(k,k[k.length-1]&-2147483648?-1:0)};function X(R,S){return R.add(M(S))}n.j=function(R){if(P(this)||P(R))return y;if(O(this))return O(R)?M(this).j(M(R)):M(M(this).j(R));if(O(R))return M(this.j(M(R)));if(this.l(x)<0&&R.l(x)<0)return p(this.m()*R.m());const S=this.g.length+R.g.length,k=[];for(var D=0;D<2*S;D++)k[D]=0;for(D=0;D<this.g.length;D++)for(let N=0;N<R.g.length;N++){const j=this.i(D)>>>16,C=this.i(D)&65535,We=R.i(N)>>>16,Et=R.i(N)&65535;k[2*D+2*N]+=C*Et,W(k,2*D+2*N),k[2*D+2*N+1]+=j*Et,W(k,2*D+2*N+1),k[2*D+2*N+1]+=C*We,W(k,2*D+2*N+1),k[2*D+2*N+2]+=j*We,W(k,2*D+2*N+2)}for(R=0;R<S;R++)k[R]=k[2*R+1]<<16|k[2*R];for(R=S;R<2*S;R++)k[R]=0;return new a(k,0)};function W(R,S){for(;(R[S]&65535)!=R[S];)R[S+1]+=R[S]>>>16,R[S]&=65535,S++}function Q(R,S){this.g=R,this.h=S}function Y(R,S){if(P(S))throw Error("division by zero");if(P(R))return new Q(y,y);if(O(R))return S=Y(M(R),S),new Q(M(S.g),M(S.h));if(O(S))return S=Y(R,M(S)),new Q(M(S.g),S.h);if(R.g.length>30){if(O(R)||O(S))throw Error("slowDivide_ only works with positive integers.");for(var k=E,D=S;D.l(R)<=0;)k=ue(k),D=ue(D);var N=se(k,1),j=se(D,1);for(D=se(D,2),k=se(k,2);!P(D);){var C=j.add(D);C.l(R)<=0&&(N=N.add(k),j=C),D=se(D,1),k=se(k,1)}return S=X(R,N.j(S)),new Q(N,S)}for(N=y;R.l(S)>=0;){for(k=Math.max(1,Math.floor(R.m()/S.m())),D=Math.ceil(Math.log(k)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),j=p(k),C=j.j(S);O(C)||C.l(R)>0;)k-=D,j=p(k),C=j.j(S);P(j)&&(j=E),N=N.add(j),R=X(R,C)}return new Q(N,R)}n.B=function(R){return Y(this,R).h},n.and=function(R){const S=Math.max(this.g.length,R.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)&R.i(D);return new a(k,this.h&R.h)},n.or=function(R){const S=Math.max(this.g.length,R.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)|R.i(D);return new a(k,this.h|R.h)},n.xor=function(R){const S=Math.max(this.g.length,R.g.length),k=[];for(let D=0;D<S;D++)k[D]=this.i(D)^R.i(D);return new a(k,this.h^R.h)};function ue(R){const S=R.g.length+1,k=[];for(let D=0;D<S;D++)k[D]=R.i(D)<<1|R.i(D-1)>>>31;return new a(k,R.h)}function se(R,S){const k=S>>5;S%=32;const D=R.g.length-k,N=[];for(let j=0;j<D;j++)N[j]=S>0?R.i(j+k)>>>S|R.i(j+k+1)<<32-S:R.i(j+k);return new a(N,R.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,jR=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=p,a.fromString=g,Xo=a}).apply(typeof qS<"u"?qS:typeof self<"u"?self:typeof window<"u"?window:{});var om=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FR,sd,UR,wm,Cw,BR,zR,$R;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof om=="object"&&om];for(var w=0;w<d.length;++w){var I=d[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function s(d,w){if(w)e:{var I=r;d=d.split(".");for(var b=0;b<d.length-1;b++){var z=d[b];if(!(z in I))break e;I=I[z]}d=d[d.length-1],b=I[d],w=w(b),w!=b&&w!=null&&e(I,d,{configurable:!0,writable:!0,value:w})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(w){var I=[],b;for(b in w)Object.prototype.hasOwnProperty.call(w,b)&&I.push([b,w[b]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function c(d){var w=typeof d;return w=="object"&&d!=null||w=="function"}function h(d,w,I){return d.call.apply(d.bind,arguments)}function p(d,w,I){return p=h,p.apply(null,arguments)}function g(d,w){var I=Array.prototype.slice.call(arguments,1);return function(){var b=I.slice();return b.push.apply(b,arguments),d.apply(this,b)}}function y(d,w){function I(){}I.prototype=w.prototype,d.Z=w.prototype,d.prototype=new I,d.prototype.constructor=d,d.Ob=function(b,z,K){for(var he=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)he[Fe-2]=arguments[Fe];return w.prototype[z].apply(b,he)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function x(d){const w=d.length;if(w>0){const I=Array(w);for(let b=0;b<w;b++)I[b]=d[b];return I}return[]}function P(d,w){for(let b=1;b<arguments.length;b++){const z=arguments[b];var I=typeof z;if(I=I!="object"?I:z?Array.isArray(z)?"array":I:"null",I=="array"||I=="object"&&typeof z.length=="number"){I=d.length||0;const K=z.length||0;d.length=I+K;for(let he=0;he<K;he++)d[I+he]=z[he]}else d.push(z)}}class O{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function M(d){a.setTimeout(()=>{throw d},0)}function X(){var d=R;let w=null;return d.g&&(w=d.g,d.g=d.g.next,d.g||(d.h=null),w.next=null),w}class W{constructor(){this.h=this.g=null}add(w,I){const b=Q.get();b.set(w,I),this.h?this.h.next=b:this.g=b,this.h=b}}var Q=new O(()=>new Y,d=>d.reset());class Y{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,se=!1,R=new W,S=()=>{const d=Promise.resolve(void 0);ue=()=>{d.then(k)}};function k(){for(var d;d=X();){try{d.h.call(d.g)}catch(I){M(I)}var w=Q;w.j(d),w.h<100&&(w.h++,d.next=w.g,w.g=d)}se=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(d,w){this.type=d,this.g=this.target=w,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,w=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const I=()=>{};a.addEventListener("test",I,w),a.removeEventListener("test",I,w)}catch{}return d})();function C(d){return/^[\s\xa0]*$/.test(d)}function We(d,w){N.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,w)}y(We,N),We.prototype.init=function(d,w){const I=this.type=d.type,b=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=w,w=d.relatedTarget,w||(I=="mouseover"?w=d.fromElement:I=="mouseout"&&(w=d.toElement)),this.relatedTarget=w,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&We.Z.h.call(this)},We.prototype.h=function(){We.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Et="closure_listenable_"+(Math.random()*1e6|0),Nt=0;function st(d,w,I,b,z){this.listener=d,this.proxy=null,this.src=w,this.type=I,this.capture=!!b,this.ha=z,this.key=++Nt,this.da=this.fa=!1}function ce(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Se(d,w,I){for(const b in d)w.call(I,d[b],b,d)}function me(d,w){for(const I in d)w.call(void 0,d[I],I,d)}function F(d){const w={};for(const I in d)w[I]=d[I];return w}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xe(d,w){let I,b;for(let z=1;z<arguments.length;z++){b=arguments[z];for(I in b)d[I]=b[I];for(let K=0;K<J.length;K++)I=J[K],Object.prototype.hasOwnProperty.call(b,I)&&(d[I]=b[I])}}function De(d){this.src=d,this.g={},this.h=0}De.prototype.add=function(d,w,I,b,z){const K=d.toString();d=this.g[K],d||(d=this.g[K]=[],this.h++);const he=Ne(d,w,b,z);return he>-1?(w=d[he],I||(w.fa=!1)):(w=new st(w,this.src,K,!!b,z),w.fa=I,d.push(w)),w};function Ae(d,w){const I=w.type;if(I in d.g){var b=d.g[I],z=Array.prototype.indexOf.call(b,w,void 0),K;(K=z>=0)&&Array.prototype.splice.call(b,z,1),K&&(ce(w),d.g[I].length==0&&(delete d.g[I],d.h--))}}function Ne(d,w,I,b){for(let z=0;z<d.length;++z){const K=d[z];if(!K.da&&K.listener==w&&K.capture==!!I&&K.ha==b)return z}return-1}var fe="closure_lm_"+(Math.random()*1e6|0),ve={};function Me(d,w,I,b,z){if(Array.isArray(w)){for(let K=0;K<w.length;K++)Me(d,w[K],I,b,z);return null}return I=pi(I),d&&d[Et]?d.J(w,I,c(b)?!!b.capture:!1,z):Ue(d,w,I,!1,b,z)}function Ue(d,w,I,b,z,K){if(!w)throw Error("Invalid event type");const he=c(z)?!!z.capture:!!z;let Fe=In(d);if(Fe||(d[fe]=Fe=new De(d)),I=Fe.add(w,I,b,he,K),I.proxy)return I;if(b=it(),I.proxy=b,b.src=d,b.listener=I,d.addEventListener)j||(z=he),z===void 0&&(z=!1),d.addEventListener(w.toString(),b,z);else if(d.attachEvent)d.attachEvent(Is(w.toString()),b);else if(d.addListener&&d.removeListener)d.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return I}function it(){function d(I){return w.call(d.src,d.listener,I)}const w=di;return d}function Vr(d,w,I,b,z){if(Array.isArray(w))for(var K=0;K<w.length;K++)Vr(d,w[K],I,b,z);else b=c(b)?!!b.capture:!!b,I=pi(I),d&&d[Et]?(d=d.i,K=String(w).toString(),K in d.g&&(w=d.g[K],I=Ne(w,I,b,z),I>-1&&(ce(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete d.g[K],d.h--)))):d&&(d=In(d))&&(w=d.g[w.toString()],d=-1,w&&(d=Ne(w,I,b,z)),(I=d>-1?w[d]:null)&&mr(I))}function mr(d){if(typeof d!="number"&&d&&!d.da){var w=d.src;if(w&&w[Et])Ae(w.i,d);else{var I=d.type,b=d.proxy;w.removeEventListener?w.removeEventListener(I,b,d.capture):w.detachEvent?w.detachEvent(Is(I),b):w.addListener&&w.removeListener&&w.removeListener(b),(I=In(w))?(Ae(I,d),I.h==0&&(I.src=null,w[fe]=null)):ce(d)}}}function Is(d){return d in ve?ve[d]:ve[d]="on"+d}function di(d,w){if(d.da)d=!0;else{w=new We(w,this);const I=d.listener,b=d.ha||d.src;d.fa&&mr(d),d=I.call(b,w)}return d}function In(d){return d=d[fe],d instanceof De?d:null}var fi="__closure_events_fn_"+(Math.random()*1e9>>>0);function pi(d){return typeof d=="function"?d:(d[fi]||(d[fi]=function(w){return d.handleEvent(w)}),d[fi])}function Ot(){D.call(this),this.i=new De(this),this.M=this,this.G=null}y(Ot,D),Ot.prototype[Et]=!0,Ot.prototype.removeEventListener=function(d,w,I,b){Vr(this,d,w,I,b)};function Lt(d,w){var I,b=d.G;if(b)for(I=[];b;b=b.G)I.push(b);if(d=d.M,b=w.type||w,typeof w=="string")w=new N(w,d);else if(w instanceof N)w.target=w.target||d;else{var z=w;w=new N(b,d),xe(w,z)}z=!0;let K,he;if(I)for(he=I.length-1;he>=0;he--)K=w.g=I[he],z=Zn(K,b,!0,w)&&z;if(K=w.g=d,z=Zn(K,b,!0,w)&&z,z=Zn(K,b,!1,w)&&z,I)for(he=0;he<I.length;he++)K=w.g=I[he],z=Zn(K,b,!1,w)&&z}Ot.prototype.N=function(){if(Ot.Z.N.call(this),this.i){var d=this.i;for(const w in d.g){const I=d.g[w];for(let b=0;b<I.length;b++)ce(I[b]);delete d.g[w],d.h--}}this.G=null},Ot.prototype.J=function(d,w,I,b){return this.i.add(String(d),w,!1,I,b)},Ot.prototype.K=function(d,w,I,b){return this.i.add(String(d),w,!0,I,b)};function Zn(d,w,I,b){if(w=d.i.g[String(w)],!w)return!0;w=w.concat();let z=!0;for(let K=0;K<w.length;++K){const he=w[K];if(he&&!he.da&&he.capture==I){const Fe=he.listener,qt=he.ha||he.src;he.fa&&Ae(d.i,he),z=Fe.call(qt,b)!==!1&&z}}return z&&!b.defaultPrevented}function io(d,w){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:a.setTimeout(d,w||0)}function oo(d){d.g=io(()=>{d.g=null,d.i&&(d.i=!1,oo(d))},d.l);const w=d.h;d.h=null,d.m.apply(null,w)}class ba extends D{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:oo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ts(d){D.call(this),this.h=d,this.g={}}y(ts,D);var ao=[];function mi(d){Se(d.g,function(w,I){this.g.hasOwnProperty(I)&&mr(w)},d),d.g={}}ts.prototype.N=function(){ts.Z.N.call(this),mi(this)},ts.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ns=a.JSON.stringify,Sa=a.JSON.parse,gi=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function jr(){}function Zl(){}var Ts={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function lo(){N.call(this,"d")}y(lo,N);function Aa(){N.call(this,"c")}y(Aa,N);var gr={},_i=null;function xs(){return _i=_i||new Ot}gr.Ia="serverreachability";function co(d){N.call(this,gr.Ia,d)}y(co,N);function rs(d){const w=xs();Lt(w,new co(w))}gr.STAT_EVENT="statevent";function Z(d,w){N.call(this,gr.STAT_EVENT,d),this.stat=w}y(Z,N);function Ee(d){const w=xs();Lt(w,new Z(w,d))}gr.Ja="timingevent";function et(d,w){N.call(this,gr.Ja,d),this.size=w}y(et,N);function un(d,w){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},w)}function Fr(){this.g=!0}Fr.prototype.ua=function(){this.g=!1};function _r(d,w,I,b,z,K){d.info(function(){if(d.g)if(K){var he="",Fe=K.split("&");for(let ct=0;ct<Fe.length;ct++){var qt=Fe[ct].split("=");if(qt.length>1){const Xt=qt[0];qt=qt[1];const Tr=Xt.split("_");he=Tr.length>=2&&Tr[1]=="type"?he+(Xt+"="+qt+"&"):he+(Xt+"=redacted&")}}}else he=null;else he=K;return"XMLHTTP REQ ("+b+") [attempt "+z+"]: "+w+`
`+I+`
`+he})}function uo(d,w,I,b,z,K,he){d.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+z+"]: "+w+`
`+I+`
`+K+" "+he})}function ss(d,w,I,b){d.info(function(){return"XMLHTTP TEXT ("+w+"): "+Na(d,I)+(b?" "+b:"")})}function ho(d,w){d.info(function(){return"TIMEOUT: "+w})}Fr.prototype.info=function(){};function Na(d,w){if(!d.g)return w;if(!w)return null;try{const K=JSON.parse(w);if(K){for(d=0;d<K.length;d++)if(Array.isArray(K[d])){var I=K[d];if(!(I.length<2)){var b=I[1];if(Array.isArray(b)&&!(b.length<1)){var z=b[0];if(z!="noop"&&z!="stop"&&z!="close")for(let he=1;he<b.length;he++)b[he]=""}}}}return ns(K)}catch{return w}}var fo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},po={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gf;function yi(){}y(yi,jr),yi.prototype.g=function(){return new XMLHttpRequest},Gf=new yi;function bs(d){return encodeURIComponent(String(d))}function ec(d){var w=1;d=d.split(":");const I=[];for(;w>0&&d.length;)I.push(d.shift()),w--;return d.length&&I.push(d.join(":")),I}function Ur(d,w,I,b){this.j=d,this.i=w,this.l=I,this.S=b||1,this.V=new ts(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Kf}function Kf(){this.i=null,this.g="",this.h=!1}var Qf={},Yu={};function is(d,w,I){d.M=1,d.A=wi(Br(w)),d.u=I,d.R=!0,Ju(d,null)}function Ju(d,w){d.F=Date.now(),Ca(d),d.B=Br(d.A);var I=d.B,b=d.S;Array.isArray(b)||(b=[String(b)]),ah(I.i,"t",b),d.C=0,I=d.j.L,d.h=new Kf,d.g=ip(d.j,I?w:null,!d.u),d.P>0&&(d.O=new ba(p(d.Y,d,d.g),d.P)),w=d.V,I=d.g,b=d.ba;var z="readystatechange";Array.isArray(z)||(z&&(ao[0]=z.toString()),z=ao);for(let K=0;K<z.length;K++){const he=Me(I,z[K],b||w.handleEvent,!1,w.h||w);if(!he)break;w.g[he.key]=he}w=d.J?F(d.J):{},d.u?(d.v||(d.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,w)):(d.v="GET",d.g.ea(d.B,d.v,null,w)),rs(),_r(d.i,d.v,d.B,d.l,d.S,d.u)}Ur.prototype.ba=function(d){d=d.target;const w=this.O;w&&Ps(d)==3?w.j():this.Y(d)},Ur.prototype.Y=function(d){try{if(d==this.g)e:{const Fe=Ps(this.g),qt=this.g.ya(),ct=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||rp(this.g)))){this.K||Fe!=4||qt==7||(qt==8||ct<=0?rs(3):rs(2)),tc(this);var w=this.g.ca();this.X=w;var I=Yf(this);if(this.o=w==200,uo(this.i,this.v,this.B,this.l,this.S,Fe,w),this.o){if(this.U&&!this.L){t:{if(this.g){var b,z=this.g;if((b=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(b)){var K=b;break t}}K=null}if(d=K)ss(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,It(this,d);else{this.o=!1,this.m=3,Ee(12),vi(this),ka(this);break e}}if(this.R){d=!0;let Xt;for(;!this.K&&this.C<I.length;)if(Xt=Xf(this,I),Xt==Yu){Fe==4&&(this.m=4,Ee(14),d=!1),ss(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==Qf){this.m=4,Ee(15),ss(this.i,this.l,I,"[Invalid Chunk]"),d=!1;break}else ss(this.i,this.l,Xt,null),It(this,Xt);if(Jf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||I.length!=0||this.h.h||(this.m=1,Ee(16),d=!1),this.o=this.o&&d,!d)ss(this.i,this.l,I,"[Invalid Chunked Response]"),vi(this),ka(this);else if(I.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Fa(he),he.P=!0,Ee(11))}}else ss(this.i,this.l,I,null),It(this,I);Fe==4&&vi(this),this.o&&!this.K&&(Fe==4?hc(this.j,this):(this.o=!1,Ca(this)))}else ch(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,Ee(12)):(this.m=0,Ee(13)),vi(this),ka(this)}}}catch{}finally{}};function Yf(d){if(!Jf(d))return d.g.la();const w=rp(d.g);if(w==="")return"";let I="";const b=w.length,z=Ps(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return vi(d),ka(d),"";d.h.i=new a.TextDecoder}for(let K=0;K<b;K++)d.h.h=!0,I+=d.h.i.decode(w[K],{stream:!(z&&K==b-1)});return w.length=0,d.h.g+=I,d.C=0,d.h.g}function Jf(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Xf(d,w){var I=d.C,b=w.indexOf(`
`,I);return b==-1?Yu:(I=Number(w.substring(I,b)),isNaN(I)?Qf:(b+=1,b+I>w.length?Yu:(w=w.slice(b,b+I),d.C=b+I,w)))}Ur.prototype.cancel=function(){this.K=!0,vi(this)};function Ca(d){d.T=Date.now()+d.H,Xu(d,d.H)}function Xu(d,w){if(d.D!=null)throw Error("WatchDog timer not null");d.D=un(p(d.aa,d),w)}function tc(d){d.D&&(a.clearTimeout(d.D),d.D=null)}Ur.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(ho(this.i,this.B),this.M!=2&&(rs(),Ee(17)),vi(this),this.m=2,ka(this)):Xu(this,this.T-d)};function ka(d){d.j.I==0||d.K||hc(d.j,d)}function vi(d){tc(d);var w=d.O;w&&typeof w.dispose=="function"&&w.dispose(),d.O=null,mi(d.V),d.g&&(w=d.g,d.g=null,w.abort(),w.dispose())}function It(d,w){try{var I=d.j;if(I.I!=0&&(I.g==d||eh(I.h,d))){if(!d.L&&eh(I.h,d)&&I.I==3){try{var b=I.Ba.g.parse(w)}catch{b=null}if(Array.isArray(b)&&b.length==3){var z=b;if(z[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<d.F)uc(I),Er(I);else break e;Ls(I),Ee(18)}}else I.xa=z[1],0<I.xa-I.K&&z[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=un(p(I.Va,I),6e3));Ra(I.h)<=1&&I.ta&&(I.ta=void 0)}else Ir(I,11)}else if((d.L||I.g==d)&&uc(I),!C(w))for(z=I.Ba.g.parse(w),w=0;w<z.length;w++){let ct=z[w];const Xt=ct[0];if(!(Xt<=I.K))if(I.K=Xt,ct=ct[1],I.I==2)if(ct[0]=="c"){I.M=ct[1],I.ba=ct[2];const Tr=ct[3];Tr!=null&&(I.ka=Tr,I.j.info("VER="+I.ka));const bi=ct[4];bi!=null&&(I.za=bi,I.j.info("SVER="+I.za));const Ms=ct[5];Ms!=null&&typeof Ms=="number"&&Ms>0&&(b=1.5*Ms,I.O=b,I.j.info("backChannelRequestTimeoutMs_="+b)),b=I;const Vs=d.g;if(Vs){const pc=Vs.g?Vs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pc){var K=b.h;K.g||pc.indexOf("spdy")==-1&&pc.indexOf("quic")==-1&&pc.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(rc(K,K.h),K.h=null))}if(b.G){const dh=Vs.g?Vs.g.getResponseHeader("X-HTTP-Session-Id"):null;dh&&(b.wa=dh,ot(b.J,b.G,dh))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-d.F,I.j.info("Handshake RTT: "+I.T+"ms")),b=I;var he=d;if(b.na=hh(b,b.L?b.ba:null,b.W),he.L){Pa(b.h,he);var Fe=he,qt=b.O;qt&&(Fe.H=qt),Fe.D&&(tc(Fe),Ca(Fe)),b.g=he}else Pn(b);I.i.length>0&&xi(I)}else ct[0]!="stop"&&ct[0]!="close"||Ir(I,7);else I.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Ir(I,7):lc(I):ct[0]!="noop"&&I.l&&I.l.qa(ct),I.A=0)}}rs(4)}catch{}}var F_=class{constructor(d,w){this.g=d,this.map=w}};function nc(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Zu(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Ra(d){return d.h?1:d.g?d.g.size:0}function eh(d,w){return d.h?d.h==w:d.g?d.g.has(w):!1}function rc(d,w){d.g?d.g.add(w):d.h=w}function Pa(d,w){d.h&&d.h==w?d.h=null:d.g&&d.g.has(w)&&d.g.delete(w)}nc.prototype.cancel=function(){if(this.i=yr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function yr(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let w=d.i;for(const I of d.g.values())w=w.concat(I.G);return w}return x(d.i)}var Zf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vr(d,w){if(d){d=d.split("&");for(let I=0;I<d.length;I++){const b=d[I].indexOf("=");let z,K=null;b>=0?(z=d[I].substring(0,b),K=d[I].substring(b+1)):z=d[I],w(z,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Ss(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;d instanceof Ss?(this.l=d.l,Da(this,d.j),this.o=d.o,this.g=d.g,As(this,d.u),this.h=d.h,mo(this,lh(d.i)),this.m=d.m):d&&(w=String(d).match(Zf))?(this.l=!1,Da(this,w[1]||"",!0),this.o=Oa(w[2]||""),this.g=Oa(w[3]||"",!0),As(this,w[4]),this.h=Oa(w[5]||"",!0),mo(this,w[6]||"",!0),this.m=Oa(w[7]||"")):(this.l=!1,this.i=new Je(null,this.l))}Ss.prototype.toString=function(){const d=[];var w=this.j;w&&d.push(La(w,nh,!0),":");var I=this.g;return(I||w=="file")&&(d.push("//"),(w=this.o)&&d.push(La(w,nh,!0),"@"),d.push(bs(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&d.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&d.push("/"),d.push(La(I,I.charAt(0)=="/"?Ma:rh,!0))),(I=this.i.toString())&&d.push("?",I),(I=this.m)&&d.push("#",La(I,sh)),d.join("")},Ss.prototype.resolve=function(d){const w=Br(this);let I=!!d.j;I?Da(w,d.j):I=!!d.o,I?w.o=d.o:I=!!d.g,I?w.g=d.g:I=d.u!=null;var b=d.h;if(I)As(w,d.u);else if(I=!!d.h){if(b.charAt(0)!="/")if(this.g&&!this.h)b="/"+b;else{var z=w.h.lastIndexOf("/");z!=-1&&(b=w.h.slice(0,z+1)+b)}if(z=b,z==".."||z==".")b="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){b=z.lastIndexOf("/",0)==0,z=z.split("/");const K=[];for(let he=0;he<z.length;){const Fe=z[he++];Fe=="."?b&&he==z.length&&K.push(""):Fe==".."?((K.length>1||K.length==1&&K[0]!="")&&K.pop(),b&&he==z.length&&K.push("")):(K.push(Fe),b=!0)}b=K.join("/")}else b=z}return I?w.h=b:I=d.i.toString()!=="",I?mo(w,lh(d.i)):I=!!d.m,I&&(w.m=d.m),w};function Br(d){return new Ss(d)}function Da(d,w,I){d.j=I?Oa(w,!0):w,d.j&&(d.j=d.j.replace(/:$/,""))}function As(d,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);d.u=w}else d.u=null}function mo(d,w,I){w instanceof Je?(d.i=w,ic(d.i,d.l)):(I||(w=La(w,U_)),d.i=new Je(w,d.l))}function ot(d,w,I){d.i.set(w,I)}function wi(d){return ot(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Oa(d,w){return d?w?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function La(d,w,I){return typeof d=="string"?(d=encodeURI(d).replace(w,th),I&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function th(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var nh=/[#\/\?@]/g,rh=/[#\?:]/g,Ma=/[#\?]/g,U_=/[#\?@]/g,sh=/#/g;function Je(d,w){this.h=this.g=null,this.i=d||null,this.j=!!w}function Ns(d){d.g||(d.g=new Map,d.h=0,d.i&&vr(d.i,function(w,I){d.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}n=Je.prototype,n.add=function(d,w){Ns(this),this.i=null,d=Cs(this,d);let I=this.g.get(d);return I||this.g.set(d,I=[]),I.push(w),this.h+=1,this};function ih(d,w){Ns(d),w=Cs(d,w),d.g.has(w)&&(d.i=null,d.h-=d.g.get(w).length,d.g.delete(w))}function sc(d,w){return Ns(d),w=Cs(d,w),d.g.has(w)}n.forEach=function(d,w){Ns(this),this.g.forEach(function(I,b){I.forEach(function(z){d.call(w,z,b,this)},this)},this)};function oh(d,w){Ns(d);let I=[];if(typeof w=="string")sc(d,w)&&(I=I.concat(d.g.get(Cs(d,w))));else for(d=Array.from(d.g.values()),w=0;w<d.length;w++)I=I.concat(d[w]);return I}n.set=function(d,w){return Ns(this),this.i=null,d=Cs(this,d),sc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[w]),this.h+=1,this},n.get=function(d,w){return d?(d=oh(this,d),d.length>0?String(d[0]):w):w};function ah(d,w,I){ih(d,w),I.length>0&&(d.i=null,d.g.set(Cs(d,w),x(I)),d.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],w=Array.from(this.g.keys());for(let b=0;b<w.length;b++){var I=w[b];const z=bs(I);I=oh(this,I);for(let K=0;K<I.length;K++){let he=z;I[K]!==""&&(he+="="+bs(I[K])),d.push(he)}}return this.i=d.join("&")};function lh(d){const w=new Je;return w.i=d.i,d.g&&(w.g=new Map(d.g),w.h=d.h),w}function Cs(d,w){return w=String(w),d.j&&(w=w.toLowerCase()),w}function ic(d,w){w&&!d.j&&(Ns(d),d.i=null,d.g.forEach(function(I,b){const z=b.toLowerCase();b!=z&&(ih(this,b),ah(this,z,I))},d)),d.j=w}function ks(d,w){const I=new Fr;if(a.Image){const b=new Image;b.onload=g(Tn,I,"TestLoadImage: loaded",!0,w,b),b.onerror=g(Tn,I,"TestLoadImage: error",!1,w,b),b.onabort=g(Tn,I,"TestLoadImage: abort",!1,w,b),b.ontimeout=g(Tn,I,"TestLoadImage: timeout",!1,w,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=d}else w(!1)}function Rs(d,w){const I=new Fr,b=new AbortController,z=setTimeout(()=>{b.abort(),Tn(I,"TestPingServer: timeout",!1,w)},1e4);fetch(d,{signal:b.signal}).then(K=>{clearTimeout(z),K.ok?Tn(I,"TestPingServer: ok",!0,w):Tn(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(z),Tn(I,"TestPingServer: error",!1,w)})}function Tn(d,w,I,b,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),b(I)}catch{}}function Va(){this.g=new gi}function Ei(d){this.i=d.Sb||null,this.h=d.ab||!1}y(Ei,jr),Ei.prototype.g=function(){return new wr(this.i,this.h)};function wr(d,w){Ot.call(this),this.H=d,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(wr,Ot),n=wr.prototype,n.open=function(d,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=w,this.readyState=1,os(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(w.body=d),(this.H||a).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,go(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,os(this)),this.g&&(this.readyState=3,os(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ep(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function ep(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var w=d.value?d.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!d.done}))&&(this.response=this.responseText+=w)}d.done?go(this):os(this),this.readyState==3&&ep(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,go(this))},n.Na=function(d){this.g&&(this.response=d,go(this))},n.ga=function(){this.g&&go(this)};function go(d){d.readyState=4,d.l=null,d.j=null,d.B=null,os(d)}n.setRequestHeader=function(d,w){this.A.append(d,w)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,d.push(I[0]+": "+I[1]),I=w.next();return d.join(`\r
`)};function os(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(wr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function tp(d){let w="";return Se(d,function(I,b){w+=b,w+=":",w+=I,w+=`\r
`}),w}function oc(d,w,I){e:{for(b in I){var b=!1;break e}b=!0}b||(I=tp(I),typeof d=="string"?I!=null&&bs(I):ot(d,w,I))}function pt(d){Ot.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(pt,Ot);var np=/^https?$/i,B_=["POST","PUT"];n=pt.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,w,I,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);w=w?w.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gf.g(),this.g.onreadystatechange=E(p(this.Ca,this));try{this.B=!0,this.g.open(w,String(d),!0),this.B=!1}catch(K){_o(this,K);return}if(d=I||"",I=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var z in b)I.set(z,b[z]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const K of b.keys())I.set(K,b.get(K));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(I.keys()).find(K=>K.toLowerCase()=="content-type"),z=a.FormData&&d instanceof a.FormData,!(Array.prototype.indexOf.call(B_,w,void 0)>=0)||b||z||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,he]of I)this.g.setRequestHeader(K,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(K){_o(this,K)}};function _o(d,w){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=w,d.o=5,yo(d),Ti(d)}function yo(d){d.A||(d.A=!0,Lt(d,"complete"),Lt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Lt(this,"complete"),Lt(this,"abort"),Ti(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ti(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ii(this):this.Xa())},n.Xa=function(){Ii(this)};function Ii(d){if(d.h&&typeof i<"u"){if(d.v&&Ps(d)==4)setTimeout(d.Ca.bind(d),0);else if(Lt(d,"readystatechange"),Ps(d)==4){d.h=!1;try{const K=d.ca();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var b;if(b=K===0){let he=String(d.D).match(Zf)[1]||null;!he&&a.self&&a.self.location&&(he=a.self.location.protocol.slice(0,-1)),b=!np.test(he?he.toLowerCase():"")}I=b}if(I)Lt(d,"complete"),Lt(d,"success");else{d.o=6;try{var z=Ps(d)>2?d.g.statusText:""}catch{z=""}d.l=z+" ["+d.ca()+"]",yo(d)}}finally{Ti(d)}}}}function Ti(d,w){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const I=d.g;d.g=null,w||Lt(d,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ps(d){return d.g?d.g.readyState:0}n.ca=function(){try{return Ps(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var w=this.g.responseText;return d&&w.indexOf(d)==0&&(w=w.substring(d.length)),Sa(w)}};function rp(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function ch(d){const w={};d=(d.g&&Ps(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<d.length;b++){if(C(d[b]))continue;var I=ec(d[b]);const z=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const K=w[z]||[];w[z]=K,K.push(I)}me(w,function(b){return b.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ds(d,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[d]||w}function ac(d){this.za=0,this.i=[],this.j=new Fr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ds("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ds("baseRetryDelayMs",5e3,d),this.Za=Ds("retryDelaySeedMs",1e4,d),this.Ta=Ds("forwardChannelMaxRetries",2,d),this.va=Ds("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new nc(d&&d.concurrentRequestLimit),this.Ba=new Va,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ac.prototype,n.ka=8,n.I=1,n.connect=function(d,w,I,b){Ee(0),this.W=d,this.H=w||{},I&&b!==void 0&&(this.H.OSID=I,this.H.OAID=b),this.F=this.X,this.J=hh(this,null,this.W),xi(this)};function lc(d){if(cc(d),d.I==3){var w=d.V++,I=Br(d.J);if(ot(I,"SID",d.M),ot(I,"RID",w),ot(I,"TYPE","terminate"),Os(d,I),w=new Ur(d,d.j,w),w.M=2,w.A=wi(Br(I)),I=!1,a.navigator&&a.navigator.sendBeacon)try{I=a.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&a.Image&&(new Image().src=w.A,I=!0),I||(w.g=ip(w.j,null),w.g.ea(w.A)),w.F=Date.now(),Ca(w)}Ua(d)}function Er(d){d.g&&(Fa(d),d.g.cancel(),d.g=null)}function cc(d){Er(d),d.v&&(a.clearTimeout(d.v),d.v=null),uc(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&a.clearTimeout(d.m),d.m=null)}function xi(d){if(!Zu(d.h)&&!d.m){d.m=!0;var w=d.Ea;ue||S(),se||(ue(),se=!0),R.add(w,d),d.D=0}}function sp(d,w){return Ra(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=w.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=un(p(d.Ea,d,w),dc(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const z=new Ur(this,this.j,d);let K=this.o;if(this.U&&(K?(K=F(K),xe(K,this.U)):K=this.U),this.u!==null||this.R||(z.J=K,K=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var b=this.i[I];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(w+=b,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=uh(this,z,w),I=Br(this.J),ot(I,"RID",d),ot(I,"CVER",22),this.G&&ot(I,"X-HTTP-Session-Id",this.G),Os(this,I),K&&(this.R?w="headers="+bs(tp(K))+"&"+w:this.u&&oc(I,this.u,K)),rc(this.h,z),this.Ra&&ot(I,"TYPE","init"),this.S?(ot(I,"$req",w),ot(I,"SID","null"),z.U=!0,is(z,I,null)):is(z,I,w),this.I=2}}else this.I==3&&(d?ja(this,d):this.i.length==0||Zu(this.h)||ja(this))};function ja(d,w){var I;w?I=w.l:I=d.V++;const b=Br(d.J);ot(b,"SID",d.M),ot(b,"RID",I),ot(b,"AID",d.K),Os(d,b),d.u&&d.o&&oc(b,d.u,d.o),I=new Ur(d,d.j,I,d.D+1),d.u===null&&(I.J=d.o),w&&(d.i=w.G.concat(d.i)),w=uh(d,I,1e3),I.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),rc(d.h,I),is(I,b,w)}function Os(d,w){d.H&&Se(d.H,function(I,b){ot(w,b,I)}),d.l&&Se({},function(I,b){ot(w,b,I)})}function uh(d,w,I){I=Math.min(d.i.length,I);const b=d.l?p(d.l.Ka,d.l,d):null;e:{var z=d.i;let Fe=-1;for(;;){const qt=["count="+I];Fe==-1?I>0?(Fe=z[0].g,qt.push("ofs="+Fe)):Fe=0:qt.push("ofs="+Fe);let ct=!0;for(let Xt=0;Xt<I;Xt++){var K=z[Xt].g;const Tr=z[Xt].map;if(K-=Fe,K<0)Fe=Math.max(0,z[Xt].g-100),ct=!1;else try{K="req"+K+"_"||"";try{var he=Tr instanceof Map?Tr:Object.entries(Tr);for(const[bi,Ms]of he){let Vs=Ms;c(Ms)&&(Vs=ns(Ms)),qt.push(K+bi+"="+encodeURIComponent(Vs))}}catch(bi){throw qt.push(K+"type="+encodeURIComponent("_badmap")),bi}}catch{b&&b(Tr)}}if(ct){he=qt.join("&");break e}}he=void 0}return d=d.i.splice(0,I),w.G=d,he}function Pn(d){if(!d.g&&!d.v){d.Y=1;var w=d.Da;ue||S(),se||(ue(),se=!0),R.add(w,d),d.A=0}}function Ls(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=un(p(d.Da,d),dc(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,vo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=un(p(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ee(10),Er(this),vo(this))};function Fa(d){d.B!=null&&(a.clearTimeout(d.B),d.B=null)}function vo(d){d.g=new Ur(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var w=Br(d.na);ot(w,"RID","rpc"),ot(w,"SID",d.M),ot(w,"AID",d.K),ot(w,"CI",d.F?"0":"1"),!d.F&&d.ia&&ot(w,"TO",d.ia),ot(w,"TYPE","xmlhttp"),Os(d,w),d.u&&d.o&&oc(w,d.u,d.o),d.O&&(d.g.H=d.O);var I=d.g;d=d.ba,I.M=1,I.A=wi(Br(w)),I.u=null,I.R=!0,Ju(I,d)}n.Va=function(){this.C!=null&&(this.C=null,Er(this),Ls(this),Ee(19))};function uc(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function hc(d,w){var I=null;if(d.g==w){uc(d),Fa(d),d.g=null;var b=2}else if(eh(d.h,w))I=w.G,Pa(d.h,w),b=1;else return;if(d.I!=0){if(w.o)if(b==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var z=d.D;b=xs(),Lt(b,new et(b,I)),xi(d)}else Pn(d);else if(z=w.m,z==3||z==0&&w.X>0||!(b==1&&sp(d,w)||b==2&&Ls(d)))switch(I&&I.length>0&&(w=d.h,w.i=w.i.concat(I)),z){case 1:Ir(d,5);break;case 4:Ir(d,10);break;case 3:Ir(d,6);break;default:Ir(d,2)}}}function dc(d,w){let I=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(I*=2),I*w}function Ir(d,w){if(d.j.info("Error code "+w),w==2){var I=p(d.bb,d),b=d.Ua;const z=!b;b=new Ss(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Da(b,"https"),wi(b),z?ks(b.toString(),I):Rs(b.toString(),I)}else Ee(2);d.I=0,d.l&&d.l.pa(w),Ua(d),cc(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Ee(2)):(this.j.info("Failed to ping google.com"),Ee(1))};function Ua(d){if(d.I=0,d.ja=[],d.l){const w=yr(d.h);(w.length!=0||d.i.length!=0)&&(P(d.ja,w),P(d.ja,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.oa()}}function hh(d,w,I){var b=I instanceof Ss?Br(I):new Ss(I);if(b.g!="")w&&(b.g=w+"."+b.g),As(b,b.u);else{var z=a.location;b=z.protocol,w=w?w+"."+z.hostname:z.hostname,z=+z.port;const K=new Ss(null);b&&Da(K,b),w&&(K.g=w),z&&As(K,z),I&&(K.h=I),b=K}return I=d.G,w=d.wa,I&&w&&ot(b,I,w),ot(b,"VER",d.ka),Os(d,b),b}function ip(d,w,I){if(w&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=d.Aa&&!d.ma?new pt(new Ei({ab:I})):new pt(d.ma),w.Fa(d.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function op(){}n=op.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function fc(){}fc.prototype.g=function(d,w){return new xn(d,w)};function xn(d,w){Ot.call(this),this.g=new ac(w),this.l=d,this.h=w&&w.messageUrlParams||null,d=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(d?d["X-WebChannel-Content-Type"]=w.messageContentType:d={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(d?d["X-WebChannel-Client-Profile"]=w.sa:d={"X-WebChannel-Client-Profile":w.sa}),this.g.U=d,(d=w&&w.Qb)&&!C(d)&&(this.g.u=d),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!C(w)&&(this.g.G=w,d=this.h,d!==null&&w in d&&(d=this.h,w in d&&delete d[w])),this.j=new wo(this)}y(xn,Ot),xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){lc(this.g)},xn.prototype.o=function(d){var w=this.g;if(typeof d=="string"){var I={};I.__data__=d,d=I}else this.v&&(I={},I.__data__=ns(d),d=I);w.i.push(new F_(w.Ya++,d)),w.I==3&&xi(w)},xn.prototype.N=function(){this.g.l=null,delete this.j,lc(this.g),delete this.g,xn.Z.N.call(this)};function ap(d){lo.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var w=d.__sm__;if(w){e:{for(const I in w){d=I;break e}d=void 0}(this.i=d)&&(d=this.i,w=w!==null&&d in w?w[d]:void 0),this.data=w}else this.data=d}y(ap,lo);function lp(){Aa.call(this),this.status=1}y(lp,Aa);function wo(d){this.g=d}y(wo,op),wo.prototype.ra=function(){Lt(this.g,"a")},wo.prototype.qa=function(d){Lt(this.g,new ap(d))},wo.prototype.pa=function(d){Lt(this.g,new lp)},wo.prototype.oa=function(){Lt(this.g,"b")},fc.prototype.createWebChannel=fc.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,$R=function(){return new fc},zR=function(){return xs()},BR=gr,Cw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},fo.NO_ERROR=0,fo.TIMEOUT=8,fo.HTTP_ERROR=6,wm=fo,po.COMPLETE="complete",UR=po,Zl.EventType=Ts,Ts.OPEN="a",Ts.CLOSE="b",Ts.ERROR="c",Ts.MESSAGE="d",Ot.prototype.listen=Ot.prototype.J,sd=Zl,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,FR=pt}).apply(typeof om<"u"?om:typeof self<"u"?self:typeof window<"u"?window:{});const GS="@firebase/firestore",KS="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new Du("@firebase/firestore");function $c(){return la.logLevel}function zB(n){la.setLogLevel(n)}function ne(n,...e){if(la.logLevel<=Ge.DEBUG){const t=e.map(bE);la.debug(`Firestore (${zu}): ${n}`,...t)}}function Kt(n,...e){if(la.logLevel<=Ge.ERROR){const t=e.map(bE);la.error(`Firestore (${zu}): ${n}`,...t)}}function ci(n,...e){if(la.logLevel<=Ge.WARN){const t=e.map(bE);la.warn(`Firestore (${zu}): ${n}`,...t)}}function bE(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,HR(n,r,t)}function HR(n,e,t){let r=`FIRESTORE (${zu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Kt(r),new Error(r)}function Te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||HR(e,s,r)}function $B(n,e){n||ge(57014,e)}function pe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends Un{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yn.UNAUTHENTICATED)))}shutdown(){}}class WB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class qB{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Te(this.o===void 0,42304);let r=this.i;const s=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let i=new kn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new kn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const h=i;e.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},c=h=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new kn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string",31837,{l:r}),new WR(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class GB{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class KB{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new GB(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class QS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class QB{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,At(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Te(this.o===void 0,3512);const r=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new QS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new QS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YB(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=YB(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function je(n,e){return n<e?-1:n>e?1:0}function kw(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Rv(s)===Rv(i)?je(s,i):Rv(s)?1:-1}return je(n.length,e.length)}const JB=55296,XB=57343;function Rv(n){const e=n.charCodeAt(0);return e>=JB&&e<=XB}function fu(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function qR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="__name__";class zs{constructor(e,t,r){t===void 0?t=0:t>e.length&&ge(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ge(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return zs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zs?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=zs.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return je(e.length,t.length)}static compareSegments(e,t){const r=zs.isNumericId(e),s=zs.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?zs.extractNumericId(e).compare(zs.extractNumericId(t)):kw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xo.fromString(e.substring(4,e.length-2))}}class Qe extends zs{construct(e,t,r){return new Qe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ee(G.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new Qe(t)}static emptyPath(){return new Qe([])}}const ZB=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pt extends zs{construct(e,t,r){return new Pt(e,t,r)}static isValidIdentifier(e){return ZB.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===YS}static keyField(){return new Pt([YS])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ee(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new ee(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ee(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new ee(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pt(t)}static emptyPath(){return new Pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(Qe.fromString(e))}static fromName(e){return new de(Qe.fromString(e).popFirst(5))}static empty(){return new de(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Qe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new Qe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(n,e,t){if(!t)throw new ee(G.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function GR(n,e,t,r){if(e===!0&&r===!0)throw new ee(G.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function JS(n){if(!de.isDocumentKey(n))throw new ee(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function XS(n){if(de.isDocumentKey(n))throw new ee(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function KR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function c_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ge(12329,{type:typeof n})}function rt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ee(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=c_(n);throw new ee(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function QR(n,e){if(e<=0)throw new ee(G.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n,e){const t={typeString:n};return e&&(t.value=e),t}function kf(n,e){if(!KR(n))throw new ee(G.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new ee(G.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=-62135596800,eA=1e6;class at{static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*eA);return new at(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ee(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ee(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ZS)throw new ee(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/eA}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:at._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kf(e,at._jsonSchema))return new at(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ZS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}at._jsonSchemaVersion="firestore/timestamp/1.0",at._jsonSchema={type:nn("string",at._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{static fromTimestamp(e){return new ke(e)}static min(){return new ke(new at(0,0))}static max(){return new ke(new at(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=-1;class tg{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Rw(n){return n.fields.find((e=>e.kind===2))}function nl(n){return n.fields.filter((e=>e.kind!==2))}tg.UNKNOWN_ID=-1;class Em{constructor(e,t){this.fieldPath=e,this.kind=t}}class Kd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Kd(0,Mr.min())}}function YR(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ke.fromTimestamp(r===1e9?new at(t+1,0):new at(t,r));return new Mr(s,de.empty(),e)}function JR(n){return new Mr(n.readTime,n.key,pu)}class Mr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Mr(ke.min(),de.empty(),pu)}static max(){return new Mr(ke.max(),de.empty(),pu)}}function NE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=de.comparator(n.documentKey,e.documentKey),t!==0?t:je(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wa(n){if(n.code!==G.FAILED_PRECONDITION||n.message!==XR)throw n;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):U.reject(t)}static resolve(e){return new U(((t,r)=>{t(e)}))}static reject(e){return new U(((t,r)=>{r(e)}))}static waitFor(e){return new U(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(h=>r(h)))})),a=!0,i===s&&t()}))}static or(e){let t=U.resolve(!1);for(const r of e)t=t.next((s=>s?U.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new U(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let h=0;h<i;h++){const p=h;t(e[p]).next((g=>{a[p]=g,++c,c===i&&r(a)}),(g=>s(g)))}}))}static doWhile(e,t){return new U(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="SimpleDb";class u_{static open(e,t,r,s){try{return new u_(t,e.transaction(s,r))}catch(i){throw new vd(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new kn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vd(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=CE(r.target.error);this.S.reject(new vd(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ne(Nr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new t9(t)}}class ti{static delete(e){return ne(Nr,"Removing database:",e),sl(d0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!wl())return!1;if(ti.F())return!0;const e=Ut(),t=ti.M(e),r=0<t&&t<10,s=eP(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,ti.M(Ut())===12.2&&Kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ne(Nr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const a=i.target.result;t(a)},s.onblocked=()=>{r(new vd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const a=i.target.error;a.name==="VersionError"?r(new ee(G.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ee(G.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new vd(e,a))},s.onupgradeneeded=i=>{ne(Nr,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const a=i.target.result;this.N.k(a,s.transaction,i.oldVersion,this.version).next((()=>{ne(Nr,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const c=u_.open(this.db,e,i?"readonly":"readwrite",r),h=s(c).next((p=>(c.C(),p))).catch((p=>(c.abort(p),U.reject(p)))).toPromise();return h.catch((()=>{})),await c.D,h}catch(c){const h=c,p=h.name!=="FirebaseError"&&a<3;if(ne(Nr,"Transaction failed with error:",h.message,"Retrying:",p),this.close(),!p)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eP(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class e9{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return sl(this.U.delete())}}class vd extends ee{constructor(e,t){super(G.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ea(n){return n.name==="IndexedDbTransactionError"}class t9{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(ne(Nr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(ne(Nr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),sl(r)}add(e){return ne(Nr,"ADD",this.store.name,e,e),sl(this.store.add(e))}get(e){return sl(this.store.get(e)).next((t=>(t===void 0&&(t=null),ne(Nr,"GET",this.store.name,e,t),t)))}delete(e){return ne(Nr,"DELETE",this.store.name,e),sl(this.store.delete(e))}count(){return ne(Nr,"COUNT",this.store.name),sl(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new U(((a,c)=>{i.onerror=h=>{c(h.target.error)},i.onsuccess=h=>{a(h.target.result)}}))}{const i=this.cursor(r),a=[];return this.H(i,((c,h)=>{a.push(h)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new U(((s,i)=>{r.onerror=a=>{i(a.target.error)},r.onsuccess=a=>{s(a.target.result)}}))}Z(e,t){ne(Nr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const s=this.cursor(r);return this.H(s,((i,a,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}te(e){const t=this.cursor({});return new U(((r,s)=>{t.onerror=i=>{const a=CE(i.target.error);s(a)},t.onsuccess=i=>{const a=i.target.result;a?e(a.primaryKey,a.value).next((c=>{c?a.continue():r()})):r()}}))}H(e,t){const r=[];return new U(((s,i)=>{e.onerror=a=>{i(a.target.error)},e.onsuccess=a=>{const c=a.target.result;if(!c)return void s();const h=new e9(c),p=t(c.primaryKey,c.value,h);if(p instanceof U){const g=p.catch((y=>(h.done(),U.reject(y))));r.push(g)}h.isDone?s():h.G===null?c.continue():c.continue(h.G)}})).next((()=>U.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function sl(n){return new U(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=CE(r.target.error);t(s)}}))}let tA=!1;function CE(n){const e=ti.M(Ut());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tA||(tA=!0,setTimeout((()=>{throw r}),0)),r}}return n}const wd="IndexBackfiller";class n9{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ne(wd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ne(wd,`Documents written: ${t}`)}catch(t){Ea(t)?ne(wd,"Ignoring IndexedDB error during index backfill: ",t):await wa(t)}await this.re(6e4)}))}}class r9{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let s=t,i=!0;return U.doWhile((()=>i===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return ne(wd,`Processing collection: ${a}`),this.oe(e,a,s).next((c=>{s-=c,r.add(a)}));i=!1})))).next((()=>t-s))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((i=>{const a=i.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(s,i))).next((c=>(ne(wd,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((s,i)=>{const a=JR(i);NE(a,r)>0&&(r=a)})),new Mr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo=-1;function Rf(n){return n==null}function Qd(n){return n===0&&1/n==-1/0}function tP(n){return typeof n=="number"&&Number.isInteger(n)&&!Qd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="";function zn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=nA(e)),e=s9(n.get(t),e);return nA(e)}function s9(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case ng:t+="";break;default:t+=i}}return t}function nA(n){return n+ng+""}function Ys(n){const e=n.length;if(Te(e>=2,64408,{path:n}),e===2)return Te(n.charAt(0)===ng&&n.charAt(1)==="",56145,{path:n}),Qe.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const a=n.indexOf(ng,i);switch((a<0||a>t)&&ge(50515,{path:n}),n.charAt(a+1)){case"":const c=n.substring(i,a);let h;s.length===0?h=c:(s+=c,h=s,s=""),r.push(h);break;case"":s+=n.substring(i,a),s+="\0";break;case"":s+=n.substring(i,a+1);break;default:ge(61167,{path:n})}i=a+2}return new Qe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl="remoteDocuments",Pf="owner",Vc="owner",Yd="mutationQueues",i9="userId",ps="mutations",rA="batchId",dl="userMutationsIndex",sA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(n,e){return[n,zn(e)]}function nP(n,e,t){return[n,zn(e),t]}const o9={},mu="documentMutations",rg="remoteDocumentsV14",a9=["prefixPath","collectionGroup","readTime","documentId"],Tm="documentKeyIndex",l9=["prefixPath","collectionGroup","documentId"],rP="collectionGroupIndex",c9=["collectionGroup","readTime","prefixPath","documentId"],Jd="remoteDocumentGlobal",Pw="remoteDocumentGlobalKey",gu="targets",sP="queryTargetsIndex",u9=["canonicalId","targetId"],_u="targetDocuments",h9=["targetId","path"],kE="documentTargetsIndex",d9=["path","targetId"],sg="targetGlobalKey",vl="targetGlobal",Xd="collectionParents",f9=["collectionId","parent"],yu="clientMetadata",p9="clientId",h_="bundles",m9="bundleId",d_="namedQueries",g9="name",RE="indexConfiguration",_9="indexId",Dw="collectionGroupIndex",y9="collectionGroup",Ed="indexState",v9=["indexId","uid"],iP="sequenceNumberIndex",w9=["uid","sequenceNumber"],Id="indexEntries",E9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oP="documentKeyIndex",I9=["indexId","uid","orderedDocumentKey"],f_="documentOverlays",T9=["userId","collectionPath","documentId"],Ow="collectionPathOverlayIndex",x9=["userId","collectionPath","largestBatchId"],aP="collectionGroupOverlayIndex",b9=["userId","collectionGroup","largestBatchId"],PE="globals",S9="name",lP=[Yd,ps,mu,rl,gu,Pf,vl,_u,yu,Jd,Xd,h_,d_],A9=[...lP,f_],cP=[Yd,ps,mu,rg,gu,Pf,vl,_u,yu,Jd,Xd,h_,d_,f_],uP=cP,DE=[...uP,RE,Ed,Id],N9=DE,hP=[...DE,PE],C9=hP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw extends ZR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function cn(n,e){const t=pe(n);return ti.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ia(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,t){this.comparator=e,this.root=t||An.EMPTY}insert(e,t){return new wt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,An.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,An.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new am(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new am(this.root,e,this.comparator,!1)}getReverseIterator(){return new am(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new am(this.root,e,this.comparator,!0)}}class am{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class An{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??An.RED,this.left=s??An.EMPTY,this.right=i??An.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new An(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return An.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return An.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,An.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,An.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ge(27949);return e+(this.isRed()?0:1)}}An.EMPTY=null,An.RED=!0,An.BLACK=!1;An.EMPTY=new class{constructor(){this.size=0}get key(){throw ge(57766)}get value(){throw ge(16141)}get color(){throw ge(16727)}get left(){throw ge(29726)}get right(){throw ge(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new An(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new oA(this.data.getIterator())}getIteratorFrom(e){return new oA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof dt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new dt(this.comparator);return t.data=e,t}}class oA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function jc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.fields=e,e.sort(Pt.comparator)}static empty(){return new ur([])}unionWith(e){let t=new dt(Pt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ur(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return fu(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k9(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new fP("Invalid base64 string: "+i):i}})(e);return new $t(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new $t(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$t.EMPTY_BYTE_STRING=new $t("");const R9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ki(n){if(Te(!!n,39018),typeof n=="string"){let e=0;const t=R9.exec(n);if(Te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:kt(n.seconds),nanos:kt(n.nanos)}}function kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Qi(n){return typeof n=="string"?$t.fromBase64String(n):$t.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP="server_timestamp",mP="__type__",gP="__previous_value__",_P="__local_write_time__";function p_(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[mP])==null?void 0:r.stringValue)===pP}function m_(n){const e=n.mapValue.fields[gP];return p_(e)?m_(e):e}function Zd(n){const e=Ki(n.mapValue.fields[_P].timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(e,t,r,s,i,a,c,h,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=p,this.isUsingEmulator=g}}const Mw="(default)";class ca{constructor(e,t){this.projectId=e,this.database=t||Mw}static empty(){return new ca("","")}get isDefaultDatabase(){return this.database===Mw}isEqual(e){return e instanceof ca&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE="__type__",yP="__max__",Wo={mapValue:{fields:{__type__:{stringValue:yP}}}},LE="__vector__",vu="value",xm={nullValue:"NULL_VALUE"};function ua(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?p_(n)?4:vP(n)?9007199254740991:g_(n)?10:11:ge(28295,{value:n})}function ui(n,e){if(n===e)return!0;const t=ua(n);if(t!==ua(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Zd(n).isEqual(Zd(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Ki(s.timestampValue),c=Ki(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return Qi(s.bytesValue).isEqual(Qi(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return kt(s.geoPointValue.latitude)===kt(i.geoPointValue.latitude)&&kt(s.geoPointValue.longitude)===kt(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return kt(s.integerValue)===kt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=kt(s.doubleValue),c=kt(i.doubleValue);return a===c?Qd(a)===Qd(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return fu(n.arrayValue.values||[],e.arrayValue.values||[],ui);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(iA(a)!==iA(c))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(c[h]===void 0||!ui(a[h],c[h])))return!1;return!0})(n,e);default:return ge(52216,{left:n})}}function ef(n,e){return(n.values||[]).find((t=>ui(t,e)))!==void 0}function ha(n,e){if(n===e)return 0;const t=ua(n),r=ua(e);if(t!==r)return je(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return je(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=kt(i.integerValue||i.doubleValue),h=kt(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(n,e);case 3:return aA(n.timestampValue,e.timestampValue);case 4:return aA(Zd(n),Zd(e));case 5:return kw(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=Qi(i),h=Qi(a);return c.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),h=a.split("/");for(let p=0;p<c.length&&p<h.length;p++){const g=je(c[p],h[p]);if(g!==0)return g}return je(c.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=je(kt(i.latitude),kt(a.latitude));return c!==0?c:je(kt(i.longitude),kt(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return lA(n.arrayValue,e.arrayValue);case 10:return(function(i,a){var E,x,P,O;const c=i.fields||{},h=a.fields||{},p=(E=c[vu])==null?void 0:E.arrayValue,g=(x=h[vu])==null?void 0:x.arrayValue,y=je(((P=p==null?void 0:p.values)==null?void 0:P.length)||0,((O=g==null?void 0:g.values)==null?void 0:O.length)||0);return y!==0?y:lA(p,g)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===Wo.mapValue&&a===Wo.mapValue)return 0;if(i===Wo.mapValue)return 1;if(a===Wo.mapValue)return-1;const c=i.fields||{},h=Object.keys(c),p=a.fields||{},g=Object.keys(p);h.sort(),g.sort();for(let y=0;y<h.length&&y<g.length;++y){const E=kw(h[y],g[y]);if(E!==0)return E;const x=ha(c[h[y]],p[g[y]]);if(x!==0)return x}return je(h.length,g.length)})(n.mapValue,e.mapValue);default:throw ge(23264,{he:t})}}function aA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return je(n,e);const t=Ki(n),r=Ki(e),s=je(t.seconds,r.seconds);return s!==0?s:je(t.nanos,r.nanos)}function lA(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=ha(t[s],r[s]);if(i)return i}return je(t.length,r.length)}function wu(n){return Vw(n)}function Vw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ki(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Qi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return de.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Vw(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Vw(t.fields[a])}`;return s+"}"})(n.mapValue):ge(61005,{value:n})}function bm(n){switch(ua(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=m_(n);return e?16+bm(e):16;case 5:return 2*n.stringValue.length;case 6:return Qi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+bm(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Ia(r.fields,((i,a)=>{s+=i.length+bm(a)})),s})(n.mapValue);default:throw ge(13486,{value:n})}}function Nl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function jw(n){return!!n&&"integerValue"in n}function tf(n){return!!n&&"arrayValue"in n}function cA(n){return!!n&&"nullValue"in n}function uA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sm(n){return!!n&&"mapValue"in n}function g_(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[OE])==null?void 0:r.stringValue)===LE}function Td(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ia(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Td(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Td(n.arrayValue.values[t]);return e}return{...n}}function vP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===yP}const wP={mapValue:{fields:{[OE]:{stringValue:LE},[vu]:{arrayValue:{}}}}};function D9(n){return"nullValue"in n?xm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Nl(ca.empty(),de.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?g_(n)?wP:{mapValue:{}}:ge(35942,{value:n})}function O9(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Nl(ca.empty(),de.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?wP:"mapValue"in n?g_(n)?{mapValue:{}}:Wo:ge(61959,{value:n})}function hA(n,e){const t=ha(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function dA(n,e){const t=ha(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Sm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Td(t)}setAll(e){let t=Pt.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const h=this.getFieldsMap(t);this.applyChanges(h,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=Td(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Sm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ui(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Sm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ia(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new Nn(Td(this.value))}}function EP(n){const e=[];return Ia(n.fields,((t,r)=>{const s=new Pt([t]);if(Sm(r)){const i=EP(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new ur(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new St(e,0,ke.min(),ke.min(),ke.min(),Nn.empty(),0)}static newFoundDocument(e,t,r,s){return new St(e,1,t,ke.min(),r,s,0)}static newNoDocument(e,t){return new St(e,2,t,ke.min(),ke.min(),Nn.empty(),0)}static newUnknownDocument(e,t){return new St(e,3,t,ke.min(),ke.min(),Nn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,t){this.position=e,this.inclusive=t}}function fA(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=de.comparator(de.fromName(a.referenceValue),t.key):r=ha(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function pA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ui(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t="asc"){this.field=e,this.dir=t}}function L9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{}class Ye extends IP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new M9(e,t,r):t==="array-contains"?new F9(e,r):t==="in"?new NP(e,r):t==="not-in"?new U9(e,r):t==="array-contains-any"?new B9(e,r):new Ye(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new V9(e,r):new j9(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ha(t,this.value)):t!==null&&ua(this.value)===ua(t)&&this.matchesComparison(ha(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends IP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ht(e,t)}matches(e){return Eu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Eu(n){return n.op==="and"}function Fw(n){return n.op==="or"}function ME(n){return TP(n)&&Eu(n)}function TP(n){for(const e of n.filters)if(e instanceof ht)return!1;return!0}function Uw(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+wu(n.value);if(ME(n))return n.filters.map((e=>Uw(e))).join(",");{const e=n.filters.map((t=>Uw(t))).join(",");return`${n.op}(${e})`}}function xP(n,e){return n instanceof Ye?(function(r,s){return s instanceof Ye&&r.op===s.op&&r.field.isEqual(s.field)&&ui(r.value,s.value)})(n,e):n instanceof ht?(function(r,s){return s instanceof ht&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&xP(a,s.filters[c])),!0):!1})(n,e):void ge(19439)}function bP(n,e){const t=n.filters.concat(e);return ht.create(t,n.op)}function SP(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${wu(t.value)}`})(n):n instanceof ht?(function(t){return t.op.toString()+" {"+t.getFilters().map(SP).join(" ,")+"}"})(n):"Filter"}class M9 extends Ye{constructor(e,t,r){super(e,t,r),this.key=de.fromName(r.referenceValue)}matches(e){const t=de.comparator(e.key,this.key);return this.matchesComparison(t)}}class V9 extends Ye{constructor(e,t){super(e,"in",t),this.keys=AP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class j9 extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=AP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function AP(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>de.fromName(r.referenceValue)))}class F9 extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tf(t)&&ef(t.arrayValue,this.value)}}class NP extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ef(this.value.arrayValue,t)}}class U9 extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(ef(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ef(this.value.arrayValue,t)}}class B9 extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>ef(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z9{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Bw(n,e=null,t=[],r=[],s=null,i=null,a=null){return new z9(n,e,t,r,s,i,a)}function Cl(n){const e=pe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Uw(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),Rf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>wu(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>wu(r))).join(",")),e.Te=t}return e.Te}function Df(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!L9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!xP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pA(n.startAt,e.startAt)&&pA(n.endAt,e.endAt)}function ig(n){return de.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function og(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function mA(n,e,t){let r=xm,s=!0;for(const i of og(n,e)){let a=xm,c=!0;switch(i.op){case"<":case"<=":a=D9(i.value);break;case"==":case"in":case">=":a=i.value;break;case">":a=i.value,c=!1;break;case"!=":case"not-in":a=xm}hA({value:r,inclusive:s},{value:a,inclusive:c})<0&&(r=a,s=c)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const a=t.position[i];hA({value:r,inclusive:s},{value:a,inclusive:t.inclusive})<0&&(r=a,s=t.inclusive);break}}return{value:r,inclusive:s}}function gA(n,e,t){let r=Wo,s=!0;for(const i of og(n,e)){let a=Wo,c=!0;switch(i.op){case">=":case">":a=O9(i.value),c=!1;break;case"==":case"in":case"<=":a=i.value;break;case"<":a=i.value,c=!1;break;case"!=":case"not-in":a=Wo}dA({value:r,inclusive:s},{value:a,inclusive:c})>0&&(r=a,s=c)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const a=t.position[i];dA({value:r,inclusive:s},{value:a,inclusive:t.inclusive})>0&&(r=a,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function CP(n,e,t,r,s,i,a,c){return new eo(n,e,t,r,s,i,a,c)}function $u(n){return new eo(n)}function _A(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function VE(n){return n.collectionGroup!==null}function nu(n){const e=pe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new dt(Pt.comparator);return a.filters.forEach((h=>{h.getFlattenedFilters().forEach((p=>{p.isInequality()&&(c=c.add(p.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new nf(i,r))})),t.has(Pt.keyField().canonicalString())||e.Ie.push(new nf(Pt.keyField(),r))}return e.Ie}function Yn(n){const e=pe(n);return e.Ee||(e.Ee=$9(e,nu(n))),e.Ee}function $9(n,e){if(n.limitType==="F")return Bw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new nf(s.field,i)}));const t=n.endAt?new da(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new da(n.startAt.position,n.startAt.inclusive):null;return Bw(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function zw(n,e){const t=n.filters.concat([e]);return new eo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ag(n,e,t){return new eo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Of(n,e){return Df(Yn(n),Yn(e))&&n.limitType===e.limitType}function kP(n){return`${Cl(Yn(n))}|lt:${n.limitType}`}function Hc(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>SP(s))).join(", ")}]`),Rf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>wu(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>wu(s))).join(",")),`Target(${r})`})(Yn(n))}; limitType=${n.limitType})`}function Lf(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):de.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of nu(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,h){const p=fA(a,c,h);return a.inclusive?p<=0:p<0})(r.startAt,nu(r),s)||r.endAt&&!(function(a,c,h){const p=fA(a,c,h);return a.inclusive?p>=0:p>0})(r.endAt,nu(r),s))})(n,e)}function RP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function PP(n){return(e,t)=>{let r=!1;for(const s of nu(n)){const i=H9(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function H9(n,e,t){const r=n.field.isKeyField()?de.comparator(e.key,t.key):(function(i,a,c){const h=a.data.field(i),p=c.data.field(i);return h!==null&&p!==null?ha(h,p):ge(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ge(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ia(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return dP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9=new wt(de.comparator);function hr(){return W9}const DP=new wt(de.comparator);function id(...n){let e=DP;for(const t of n)e=e.insert(t.key,t);return e}function OP(n){let e=DP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Js(){return xd()}function LP(){return xd()}function xd(){return new to((n=>n.toString()),((n,e)=>n.isEqual(e)))}const q9=new wt(de.comparator),G9=new dt(de.comparator);function Be(...n){let e=G9;for(const t of n)e=e.add(t);return e}const K9=new dt(je);function jE(){return K9}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qd(e)?"-0":e}}function MP(n){return{integerValue:""+n}}function VP(n,e){return tP(e)?MP(e):FE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this._=void 0}}function Q9(n,e,t){return n instanceof Iu?(function(s,i){const a={fields:{[mP]:{stringValue:pP},[_P]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&p_(i)&&(i=m_(i)),i&&(a.fields[gP]=i),{mapValue:a}})(t,e):n instanceof kl?FP(n,e):n instanceof Rl?UP(n,e):(function(s,i){const a=jP(s,i),c=yA(a)+yA(s.Ae);return jw(a)&&jw(s.Ae)?MP(c):FE(s.serializer,c)})(n,e)}function Y9(n,e,t){return n instanceof kl?FP(n,e):n instanceof Rl?UP(n,e):t}function jP(n,e){return n instanceof Tu?(function(r){return jw(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Iu extends __{}class kl extends __{constructor(e){super(),this.elements=e}}function FP(n,e){const t=BP(e);for(const r of n.elements)t.some((s=>ui(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Rl extends __{constructor(e){super(),this.elements=e}}function UP(n,e){let t=BP(e);for(const r of n.elements)t=t.filter((s=>!ui(s,r)));return{arrayValue:{values:t}}}class Tu extends __{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function yA(n){return kt(n.integerValue||n.doubleValue)}function BP(n){return tf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,t){this.field=e,this.transform=t}}function J9(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof kl&&s instanceof kl||r instanceof Rl&&s instanceof Rl?fu(r.elements,s.elements,ui):r instanceof Tu&&s instanceof Tu?ui(r.Ae,s.Ae):r instanceof Iu&&s instanceof Iu})(n.transform,e.transform)}class X9{constructor(e,t){this.version=e,this.transformResults=t}}class Dt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dt}static exists(e){return new Dt(void 0,e)}static updateTime(e){return new Dt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Am(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class y_{}function zP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Wu(n.key,Dt.none()):new Hu(n.key,n.data,Dt.none());{const t=n.data,r=Nn.empty();let s=new dt(Pt.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new no(n.key,r,new ur(s.toArray()),Dt.none())}}function Z9(n,e,t){n instanceof Hu?(function(s,i,a){const c=s.value.clone(),h=wA(s.fieldTransforms,i,a.transformResults);c.setAll(h),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof no?(function(s,i,a){if(!Am(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=wA(s.fieldTransforms,i,a.transformResults),h=i.data;h.setAll($P(s)),h.setAll(c),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function bd(n,e,t,r){return n instanceof Hu?(function(i,a,c,h){if(!Am(i.precondition,a))return c;const p=i.value.clone(),g=EA(i.fieldTransforms,h,a);return p.setAll(g),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof no?(function(i,a,c,h){if(!Am(i.precondition,a))return c;const p=EA(i.fieldTransforms,h,a),g=a.data;return g.setAll($P(i)),g.setAll(p),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((y=>y.field)))})(n,e,t,r):(function(i,a,c){return Am(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function e7(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=jP(r.transform,s||null);i!=null&&(t===null&&(t=Nn.empty()),t.set(r.field,i))}return t||null}function vA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&fu(r,s,((i,a)=>J9(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hu extends y_{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class no extends y_{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $P(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function wA(n,e,t){const r=new Map;Te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Y9(a,c,t[s]))}return r}function EA(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Q9(i,a,e))}return r}class Wu extends y_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UE extends y_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Z9(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=bd(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=bd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=LP();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const h=zP(a,c);h!==null&&r.set(s.key,h),a.isValidDocument()||a.convertToNoDocument(ke.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Be())}isEqual(e){return this.batchId===e.batchId&&fu(this.mutations,e.mutations,((t,r)=>vA(t,r)))&&fu(this.baseMutations,e.baseMutations,((t,r)=>vA(t,r)))}}class zE{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return q9})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new zE(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en,Xe;function HP(n){switch(n){case G.OK:return ge(64938);case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return ge(15467,{code:n})}}function WP(n){if(n===void 0)return Kt("GRPC error has no .code"),G.UNKNOWN;switch(n){case en.OK:return G.OK;case en.CANCELLED:return G.CANCELLED;case en.UNKNOWN:return G.UNKNOWN;case en.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case en.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case en.INTERNAL:return G.INTERNAL;case en.UNAVAILABLE:return G.UNAVAILABLE;case en.UNAUTHENTICATED:return G.UNAUTHENTICATED;case en.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case en.NOT_FOUND:return G.NOT_FOUND;case en.ALREADY_EXISTS:return G.ALREADY_EXISTS;case en.PERMISSION_DENIED:return G.PERMISSION_DENIED;case en.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case en.ABORTED:return G.ABORTED;case en.OUT_OF_RANGE:return G.OUT_OF_RANGE;case en.UNIMPLEMENTED:return G.UNIMPLEMENTED;case en.DATA_LOSS:return G.DATA_LOSS;default:return ge(39323,{code:n})}}(Xe=en||(en={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n7=new Xo([4294967295,4294967295],0);function IA(n){const e=qP().encode(n),t=new jR;return t.update(e),new Uint8Array(t.digest())}function TA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Xo([t,r],0),new Xo([s,i],0)]}class HE{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new od(`Invalid padding: ${t}`);if(r<0)throw new od(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new od(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new od(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Xo.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Xo.fromNumber(r)));return s.compare(n7)===1&&(s=new Xo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=IA(e),[r,s]=TA(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new HE(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=IA(e),[r,s]=TA(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class od extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,jf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Vf(ke.min(),s,new wt(je),hr(),Be())}}class jf{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new jf(r,t,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class GP{constructor(e,t){this.targetId=e,this.Ce=t}}class KP{constructor(e,t,r=$t.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class xA{constructor(){this.ve=0,this.Fe=bA(),this.Me=$t.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Be(),t=Be(),r=Be();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:ge(38017,{changeType:i})}})),new jf(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=bA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class r7{constructor(e){this.Ge=e,this.ze=new Map,this.je=hr(),this.Je=lm(),this.He=lm(),this.Ye=new wt(je)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ge(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(ig(i))if(r===0){const a=new de(i.path);this.et(t,a,St.newNoDocument(a,ke.min()))}else Te(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),h=c?this.ct(c,e,a):1;if(h!==0){this.it(t);const p=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=Qi(r).toUint8Array()}catch(h){if(h instanceof fP)return ci("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new HE(a,s,i)}catch(h){return ci(h instanceof od?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&ig(c.target)){const h=new de(c.target.path);this.It(h).has(a)||this.Et(a,h)||this.et(a,h,St.newNoDocument(h,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=Be();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((h=>{const p=this.ot(h);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Vf(e,t,this.Ye,this.je,r);return this.je=hr(),this.Je=lm(),this.He=lm(),this.Ye=new wt(je),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new xA,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new dt(je),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new dt(je),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ne("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new xA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function lm(){return new wt(de.comparator)}function bA(){return new wt(de.comparator)}const s7={asc:"ASCENDING",desc:"DESCENDING"},i7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},o7={and:"AND",or:"OR"};class a7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $w(n,e){return n.useProto3Json||Rf(e)?e:{value:e}}function xu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function l7(n,e){return xu(n,e.toTimestamp())}function Yt(n){return Te(!!n,49232),ke.fromTimestamp((function(t){const r=Ki(t);return new at(r.seconds,r.nanos)})(n))}function WE(n,e){return Hw(n,e).canonicalString()}function Hw(n,e){const t=(function(s){return new Qe(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function YP(n){const e=Qe.fromString(n);return Te(o2(e),10190,{key:e.toString()}),e}function rf(n,e){return WE(n.databaseId,e.path)}function ni(n,e){const t=YP(e);if(t.get(1)!==n.databaseId.projectId)throw new ee(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ee(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new de(ZP(t))}function JP(n,e){return WE(n.databaseId,e)}function XP(n){const e=YP(n);return e.length===4?Qe.emptyPath():ZP(e)}function Ww(n){return new Qe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ZP(n){return Te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function SA(n,e,t){return{name:rf(n,e),fields:t.value.mapValue.fields}}function e2(n,e,t){const r=ni(n,e.name),s=Yt(e.updateTime),i=e.createTime?Yt(e.createTime):ke.min(),a=new Nn({mapValue:{fields:e.fields}}),c=St.newFoundDocument(r,s,i,a);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function c7(n,e){return"found"in e?(function(r,s){Te(!!s.found,43571),s.found.name,s.found.updateTime;const i=ni(r,s.found.name),a=Yt(s.found.updateTime),c=s.found.createTime?Yt(s.found.createTime):ke.min(),h=new Nn({mapValue:{fields:s.found.fields}});return St.newFoundDocument(i,a,c,h)})(n,e):"missing"in e?(function(r,s){Te(!!s.missing,3894),Te(!!s.readTime,22933);const i=ni(r,s.missing),a=Yt(s.readTime);return St.newNoDocument(i,a)})(n,e):ge(7234,{result:e})}function u7(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ge(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(p,g){return p.useProto3Json?(Te(g===void 0||typeof g=="string",58123),$t.fromBase64String(g||"")):(Te(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),$t.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(p){const g=p.code===void 0?G.UNKNOWN:WP(p.code);return new ee(g,p.message||"")})(a);t=new KP(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ni(n,r.document.name),i=Yt(r.document.updateTime),a=r.document.createTime?Yt(r.document.createTime):ke.min(),c=new Nn({mapValue:{fields:r.document.fields}}),h=St.newFoundDocument(s,i,a,c),p=r.targetIds||[],g=r.removedTargetIds||[];t=new Nm(p,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ni(n,r.document),i=r.readTime?Yt(r.readTime):ke.min(),a=St.newNoDocument(s,i),c=r.removedTargetIds||[];t=new Nm([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ni(n,r.document),i=r.removedTargetIds||[];t=new Nm([],i,s,null)}else{if(!("filter"in e))return ge(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new t7(s,i),c=r.targetId;t=new GP(c,a)}}return t}function sf(n,e){let t;if(e instanceof Hu)t={update:SA(n,e.key,e.value)};else if(e instanceof Wu)t={delete:rf(n,e.key)};else if(e instanceof no)t={update:SA(n,e.key,e.data),updateMask:g7(e.fieldMask)};else{if(!(e instanceof UE))return ge(16599,{Vt:e.type});t={verify:rf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Iu)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof kl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Rl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Tu)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw ge(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:l7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ge(27497)})(n,e.precondition)),t}function qw(n,e){const t=e.currentDocument?(function(i){return i.updateTime!==void 0?Dt.updateTime(Yt(i.updateTime)):i.exists!==void 0?Dt.exists(i.exists):Dt.none()})(e.currentDocument):Dt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(a,c){let h=null;if("setToServerValue"in c)Te(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),h=new Iu;else if("appendMissingElements"in c){const g=c.appendMissingElements.values||[];h=new kl(g)}else if("removeAllFromArray"in c){const g=c.removeAllFromArray.values||[];h=new Rl(g)}else"increment"in c?h=new Tu(a,c.increment):ge(16584,{proto:c});const p=Pt.fromServerFormat(c.fieldPath);return new Mf(p,h)})(n,s))):[];if(e.update){e.update.name;const s=ni(n,e.update.name),i=new Nn({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(h){const p=h.fieldPaths||[];return new ur(p.map((g=>Pt.fromServerFormat(g))))})(e.updateMask);return new no(s,i,a,t,r)}return new Hu(s,i,t,r)}if(e.delete){const s=ni(n,e.delete);return new Wu(s,t)}if(e.verify){const s=ni(n,e.verify);return new UE(s,t)}return ge(1463,{proto:e})}function h7(n,e){return n&&n.length>0?(Te(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?Yt(s.updateTime):Yt(i);return a.isEqual(ke.min())&&(a=Yt(i)),new X9(a,s.transformResults||[])})(t,e)))):[]}function t2(n,e){return{documents:[JP(n,e.path)]}}function n2(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=JP(n,s);const i=(function(p){if(p.length!==0)return i2(ht.create(p,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(p){if(p.length!==0)return p.map((g=>(function(E){return{field:Wc(E.field),direction:f7(E.dir)}})(g)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=$w(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function r2(n){let e=XP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Te(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let i=[];t.where&&(i=(function(y){const E=s2(y);return E instanceof ht&&ME(E)?E.getFilters():[E]})(t.where));let a=[];t.orderBy&&(a=(function(y){return y.map((E=>(function(P){return new nf(qc(P.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(E)))})(t.orderBy));let c=null;t.limit&&(c=(function(y){let E;return E=typeof y=="object"?y.value:y,Rf(E)?null:E})(t.limit));let h=null;t.startAt&&(h=(function(y){const E=!!y.before,x=y.values||[];return new da(x,E)})(t.startAt));let p=null;return t.endAt&&(p=(function(y){const E=!y.before,x=y.values||[];return new da(x,E)})(t.endAt)),CP(e,s,a,i,c,"F",h,p)}function d7(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function s2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=qc(t.unaryFilter.field);return Ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=qc(t.unaryFilter.field);return Ye.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qc(t.unaryFilter.field);return Ye.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qc(t.unaryFilter.field);return Ye.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ge(61313);default:return ge(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(qc(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ge(58110);default:return ge(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ht.create(t.compositeFilter.filters.map((r=>s2(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ge(1026)}})(t.compositeFilter.op))})(n):ge(30097,{filter:n})}function f7(n){return s7[n]}function p7(n){return i7[n]}function m7(n){return o7[n]}function Wc(n){return{fieldPath:n.canonicalString()}}function qc(n){return Pt.fromServerFormat(n.fieldPath)}function i2(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(uA(t.value))return{unaryFilter:{field:Wc(t.field),op:"IS_NAN"}};if(cA(t.value))return{unaryFilter:{field:Wc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(uA(t.value))return{unaryFilter:{field:Wc(t.field),op:"IS_NOT_NAN"}};if(cA(t.value))return{unaryFilter:{field:Wc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wc(t.field),op:p7(t.op),value:t.value}}})(n):n instanceof ht?(function(t){const r=t.getFilters().map((s=>i2(s)));return r.length===1?r[0]:{compositeFilter:{op:m7(t.op),filters:r}}})(n):ge(54877,{filter:n})}function g7(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function o2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,t,r,s,i=ke.min(),a=ke.min(),c=$t.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new Fi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e){this.yt=e}}function _7(n,e){let t;if(e.document)t=e2(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=de.fromSegments(e.noDocument.path),s=Dl(e.noDocument.readTime);t=St.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ge(56709);{const r=de.fromSegments(e.unknownDocument.path),s=Dl(e.unknownDocument.version);t=St.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const i=new at(s[0],s[1]);return ke.fromTimestamp(i)})(e.readTime)),t}function AA(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:lg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(i,a){return{name:rf(i,a.key),fields:a.data.value.mapValue.fields,updateTime:xu(i,a.version.toTimestamp()),createTime:xu(i,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Pl(e.version)};else{if(!e.isUnknownDocument())return ge(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Pl(e.version)}}return r}function lg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Pl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Dl(n){const e=new at(n.seconds,n.nanoseconds);return ke.fromTimestamp(e)}function il(n,e){const t=(e.baseMutations||[]).map((i=>qw(n.yt,i)));for(let i=0;i<e.mutations.length-1;++i){const a=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const c=e.mutations[i+1];a.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map((i=>qw(n.yt,i))),s=at.fromMillis(e.localWriteTimeMs);return new BE(e.batchId,s,t,r)}function ad(n){const e=Dl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Dl(n.lastLimboFreeSnapshotVersion):ke.min();let r;return r=(function(i){return i.documents!==void 0})(n.query)?(function(i){const a=i.documents.length;return Te(a===1,1966,{count:a}),Yn($u(XP(i.documents[0])))})(n.query):(function(i){return Yn(r2(i))})(n.query),new Fi(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,$t.fromBase64String(n.resumeToken))}function l2(n,e){const t=Pl(e.snapshotVersion),r=Pl(e.lastLimboFreeSnapshotVersion);let s;s=ig(e.target)?t2(n.yt,e.target):n2(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cl(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function qE(n){const e=r2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ag(e,e.limit,"L"):e}function Pv(n,e){return new $E(e.largestBatchId,qw(n.yt,e.overlayMutation))}function NA(n,e){const t=e.path.lastSegment();return[n,zn(e.path.popLast()),t]}function CA(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Pl(r.readTime),documentKey:zn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{getBundleMetadata(e,t){return kA(e).get(t).next((r=>{if(r)return(function(i){return{id:i.bundleId,createTime:Dl(i.createTime),version:i.version}})(r)}))}saveBundleMetadata(e,t){return kA(e).put((function(s){return{bundleId:s.id,createTime:Pl(Yt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return RA(e).get(t).next((r=>{if(r)return(function(i){return{name:i.name,query:qE(i.bundledQuery),readTime:Dl(i.readTime)}})(r)}))}saveNamedQuery(e,t){return RA(e).put((function(s){return{name:s.name,readTime:Pl(Yt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function kA(n){return cn(n,h_)}function RA(n){return cn(n,d_)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new v_(e,r)}getOverlay(e,t){return qh(e).get(NA(this.userId,t)).next((r=>r?Pv(this.serializer,r):null))}getOverlays(e,t){const r=Js();return U.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((i,a)=>{const c=new $E(t,a);s.push(this.St(e,c))})),U.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((a=>s.add(zn(a.getCollectionPath()))));const i=[];return s.forEach((a=>{const c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);i.push(qh(e).Z(Ow,c))})),U.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Js(),i=zn(t),a=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return qh(e).J(Ow,a).next((c=>{for(const h of c){const p=Pv(this.serializer,h);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const i=Js();let a;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qh(e).ee({index:aP,range:c},((h,p,g)=>{const y=Pv(this.serializer,p);i.size()<s||y.largestBatchId===a?(i.set(y.getKey(),y),a=y.largestBatchId):g.done()})).next((()=>i))}St(e,t){return qh(e).put((function(s,i,a){const[c,h,p]=NA(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:p,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:sf(s.yt,a.mutation)}})(this.serializer,this.userId,t))}}function qh(n){return cn(n,f_)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{bt(e){return cn(e,PE)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?$t.fromUint8Array(r):$t.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(kt(e.integerValue));else if("doubleValue"in e){const r=kt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Qd(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ki(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Qi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?vP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):g_(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ge(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){var a,c;const r=e.fields||{};this.Ft(t,53);const s=vu,i=((c=(a=r[s].arrayValue)==null?void 0:a.values)==null?void 0:c.length)||0;this.Ft(t,15),t.Mt(kt(i)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),de.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ol.Kt=new ol;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=255;function w7(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function PA(n){const e=64-(function(r){let s=0;for(let i=0;i<8;++i){const a=w7(255&r[i]);if(s+=a,a!==8)break}return s})(n);return Math.ceil(e/8)}class E7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),r=PA(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=PA(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Fc),this.sn(255)}_n(){this.an(Fc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Fc?(this.sn(Fc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Fc?(this.an(Fc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class I7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class T7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Gh{constructor(){this.cn=new E7,this.ln=new I7(this.cn),this.hn=new T7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,t,r,s){this.Tn=e,this.In=t,this.En=r,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new al(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Cm(this.En),directionalValue:Cm(this.dn),orderedDocumentKey:Cm(t),documentKey:r.path.toArray()}}Vn(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=DA(n.En,e.En),t!==0?t:(t=DA(n.dn,e.dn),t!==0?t:de.comparator(n.In,e.In)))}function DA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Cm(n){return iC()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function OA(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class LA{constructor(e){this.mn=new dt(((t,r)=>Pt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Te(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Rw(e);if(t!==void 0&&!this.wn(t))return!1;const r=nl(e);let s=new Set,i=0,a=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!s.has(c.field.canonicalString())){const h=r[i];if(!this.Sn(c,h)||!this.bn(this.fn[a++],h))return!1}++i}for(;i<r.length;++i){const c=r[i];if(a>=this.fn.length||!this.bn(this.fn[a++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new dt(Pt.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Em(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Em(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Em(r.field,r.dir==="asc"?0:1)));return new tg(tg.UNKNOWN_ID,this.collectionId,t,Kd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(n){var t,r;if(Te(n instanceof Ye||n instanceof ht,20012),n instanceof Ye){if(n instanceof NP){const s=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((i=>Ye.create(n.field,"==",i))))||[];return ht.create(s,"or")}return n}const e=n.filters.map((s=>c2(s)));return ht.create(e,n.op)}function x7(n){if(n.getFilters().length===0)return[];const e=Qw(c2(n));return Te(u2(e),7391),Gw(e)||Kw(e)?[e]:e.getFilters()}function Gw(n){return n instanceof Ye}function Kw(n){return n instanceof ht&&ME(n)}function u2(n){return Gw(n)||Kw(n)||(function(t){if(t instanceof ht&&Fw(t)){for(const r of t.getFilters())if(!Gw(r)&&!Kw(r))return!1;return!0}return!1})(n)}function Qw(n){if(Te(n instanceof Ye||n instanceof ht,34018),n instanceof Ye)return n;if(n.filters.length===1)return Qw(n.filters[0]);const e=n.filters.map((r=>Qw(r)));let t=ht.create(e,n.op);return t=cg(t),u2(t)?t:(Te(t instanceof ht,64498),Te(Eu(t),40251),Te(t.filters.length>1,57927),t.filters.reduce(((r,s)=>GE(r,s))))}function GE(n,e){let t;return Te(n instanceof Ye||n instanceof ht,38388),Te(e instanceof Ye||e instanceof ht,25473),t=n instanceof Ye?e instanceof Ye?(function(s,i){return ht.create([s,i],"and")})(n,e):MA(n,e):e instanceof Ye?MA(e,n):(function(s,i){if(Te(s.filters.length>0&&i.filters.length>0,48005),Eu(s)&&Eu(i))return bP(s,i.getFilters());const a=Fw(s)?s:i,c=Fw(s)?i:s,h=a.filters.map((p=>GE(p,c)));return ht.create(h,"or")})(n,e),cg(t)}function MA(n,e){if(Eu(e))return bP(e,n.getFilters());{const t=e.filters.map((r=>GE(n,r)));return ht.create(t,"or")}}function cg(n){if(Te(n instanceof Ye||n instanceof ht,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return cg(e[0]);if(TP(n))return n;const t=e.map((s=>cg(s))),r=[];return t.forEach((s=>{s instanceof Ye?r.push(s):s instanceof ht&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:ht.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(){this.Cn=new KE}addToCollectionParentIndex(e,t){return this.Cn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(Mr.min())}updateCollectionGroup(e,t,r){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class KE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new dt(Qe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new dt(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="IndexedDbIndexManager",cm=new Uint8Array(0);class S7{constructor(e,t){this.databaseId=t,this.vn=new KE,this.Fn=new to((r=>Cl(r)),((r,s)=>Df(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const i={collectionId:r,parent:zn(s)};return jA(e).put(i)}return U.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[qR(t),""],!1,!0);return jA(e).J(s).next((i=>{for(const a of i){if(a.collectionId!==t)break;r.push(Ys(a.parent))}return r}))}addFieldIndex(e,t){const r=Kh(e),s=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete s.indexId;const i=r.add(s);if(t.indexState){const a=Bc(e);return i.next((c=>{a.put(CA(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const r=Kh(e),s=Bc(e),i=Uc(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Kh(e),r=Uc(e),s=Bc(e);return t.Z().next((()=>r.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return U.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const i=new LA(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))))}getDocumentsMatchingTarget(e,t){const r=Uc(e);let s=!0;const i=new Map;return U.forEach(this.Mn(t),(a=>this.xn(e,a).next((c=>{s&&(s=!!c),i.set(a,c)})))).next((()=>{if(s){let a=Be();const c=[];return U.forEach(i,((h,p)=>{ne(VA,`Using index ${(function(Q){return`id=${Q.indexId}|cg=${Q.collectionGroup}|f=${Q.fields.map((Y=>`${Y.fieldPath}:${Y.kind}`)).join(",")}`})(h)} to execute ${Cl(t)}`);const g=(function(Q,Y){const ue=Rw(Y);if(ue===void 0)return null;for(const se of og(Q,ue.fieldPath))switch(se.op){case"array-contains-any":return se.value.arrayValue.values||[];case"array-contains":return[se.value]}return null})(p,h),y=(function(Q,Y){const ue=new Map;for(const se of nl(Y))for(const R of og(Q,se.fieldPath))switch(R.op){case"==":case"in":ue.set(se.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return ue.set(se.fieldPath.canonicalString(),R.value),Array.from(ue.values())}return null})(p,h),E=(function(Q,Y){const ue=[];let se=!0;for(const R of nl(Y)){const S=R.kind===0?mA(Q,R.fieldPath,Q.startAt):gA(Q,R.fieldPath,Q.startAt);ue.push(S.value),se&&(se=S.inclusive)}return new da(ue,se)})(p,h),x=(function(Q,Y){const ue=[];let se=!0;for(const R of nl(Y)){const S=R.kind===0?gA(Q,R.fieldPath,Q.endAt):mA(Q,R.fieldPath,Q.endAt);ue.push(S.value),se&&(se=S.inclusive)}return new da(ue,se)})(p,h),P=this.On(h,p,E),O=this.On(h,p,x),M=this.Nn(h,p,y),X=this.Bn(h.indexId,g,P,E.inclusive,O,x.inclusive,M);return U.forEach(X,(W=>r.Y(W,t.limit).next((Q=>{Q.forEach((Y=>{const ue=de.fromSegments(Y.documentKey);a.has(ue)||(a=a.add(ue),c.push(ue))}))}))))})).next((()=>c))}return U.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=x7(ht.create(e.filters,"and")).map((r=>Bw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,s,i,a,c){const h=(t!=null?t.length:1)*Math.max(r.length,i.length),p=h/(t!=null?t.length:1),g=[];for(let y=0;y<h;++y){const E=t?this.Ln(t[y/p]):cm,x=this.kn(e,E,r[y%p],s),P=this.qn(e,E,i[y%p],a),O=c.map((M=>this.kn(e,E,M,!0)));g.push(...this.createRange(x,P,O))}return g}kn(e,t,r,s){const i=new al(e,de.empty(),t,r);return s?i:i.An()}qn(e,t,r,s){const i=new al(e,de.empty(),t,r);return s?i.An():i}xn(e,t){const r=new LA(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((i=>{let a=null;for(const c of i)r.yn(c)&&(!a||c.fields.length>a.fields.length)&&(a=c);return a}))}getIndexType(e,t){let r=2;const s=this.Mn(t);return U.forEach(s,(i=>this.xn(e,i).next((a=>{a?r!==0&&a.fields.length<(function(h){let p=new dt(Pt.comparator),g=!1;for(const y of h.filters)for(const E of y.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?g=!0:p=p.add(E.field));for(const y of h.orderBy)y.field.isKeyField()||(p=p.add(y.field));return p.size+(g?1:0)})(i)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&s.length>1&&r===2?1:r))}Qn(e,t){const r=new Gh;for(const s of nl(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const a=r.Pn(s.kind);ol.Kt.Dt(i,a)}return r.un()}Ln(e){const t=new Gh;return ol.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Gh;return ol.Kt.Dt(Nl(this.databaseId,t),r.Pn((function(i){const a=nl(i);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let s=[];s.push(new Gh);let i=0;for(const a of nl(e)){const c=r[i++];for(const h of s)if(this.Un(t,a.fieldPath)&&tf(c))s=this.Kn(s,a,c);else{const p=h.Pn(a.kind);ol.Kt.Dt(c,p)}}return this.Wn(s)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const s=[...e],i=[];for(const a of r.arrayValue.values||[])for(const c of s){const h=new Gh;h.seed(c.un()),ol.Kt.Dt(a,h.Pn(t.kind)),i.push(h)}return i}Un(e,t){return!!e.filters.find((r=>r instanceof Ye&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Kh(e),s=Bc(e);return(t?r.J(Dw,IDBKeyRange.bound(t,t)):r.J()).next((i=>{const a=[];return U.forEach(i,(c=>s.get([c.indexId,this.uid]).next((h=>{a.push((function(g,y){const E=y?new Kd(y.sequenceNumber,new Mr(Dl(y.readTime),new de(Ys(y.documentKey)),y.largestBatchId)):Kd.empty(),x=g.fields.map((([P,O])=>new Em(Pt.fromServerFormat(P),O)));return new tg(g.indexId,g.collectionGroup,x,E)})(c,h))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:je(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=Kh(e),i=Bc(e);return this.Gn(e).next((a=>s.J(Dw,IDBKeyRange.bound(t,t)).next((c=>U.forEach(c,(h=>i.put(CA(h.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return U.forEach(t,((s,i)=>{const a=r.get(s.collectionGroup);return(a?U.resolve(a):this.getFieldIndexes(e,s.collectionGroup)).next((c=>(r.set(s.collectionGroup,c),U.forEach(c,(h=>this.zn(e,s,h).next((p=>{const g=this.jn(i,h);return p.isEqual(g)?U.resolve():this.Jn(e,i,h,p,g)})))))))}))}Hn(e,t,r,s){return Uc(e).put(s.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,s){return Uc(e).delete(s.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const s=Uc(e);let i=new dt(Mo);return s.ee({index:oP,range:IDBKeyRange.only([r.indexId,this.uid,Cm(this.$n(r,t))])},((a,c)=>{i=i.add(new al(r.indexId,t,OA(c.arrayValue),OA(c.directionalValue)))})).next((()=>i))}jn(e,t){let r=new dt(Mo);const s=this.Qn(t,e);if(s==null)return r;const i=Rw(t);if(i!=null){const a=e.data.field(i.fieldPath);if(tf(a))for(const c of a.arrayValue.values||[])r=r.add(new al(t.indexId,e.key,this.Ln(c),s))}else r=r.add(new al(t.indexId,e.key,cm,s));return r}Jn(e,t,r,s,i){ne(VA,"Updating index entries for document '%s'",t.key);const a=[];return(function(h,p,g,y,E){const x=h.getIterator(),P=p.getIterator();let O=jc(x),M=jc(P);for(;O||M;){let X=!1,W=!1;if(O&&M){const Q=g(O,M);Q<0?W=!0:Q>0&&(X=!0)}else O!=null?W=!0:X=!0;X?(y(M),M=jc(P)):W?(E(O),O=jc(x)):(O=jc(x),M=jc(P))}})(s,i,Mo,(c=>{a.push(this.Hn(e,t,r,c))}),(c=>{a.push(this.Yn(e,t,r,c))})),U.waitFor(a)}Gn(e){let t=1;return Bc(e).ee({index:iP,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,i)=>{i.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,c)=>Mo(a,c))).filter(((a,c,h)=>!c||Mo(a,h[c-1])!==0));const s=[];s.push(e);for(const a of r){const c=Mo(a,e),h=Mo(a,t);if(c===0)s[0]=e.An();else if(c>0&&h<0)s.push(a),s.push(a.An());else if(h>0)break}s.push(t);const i=[];for(let a=0;a<s.length;a+=2){if(this.Zn(s[a],s[a+1]))return[];const c=s[a].Vn(this.uid,cm,de.empty()),h=s[a+1].Vn(this.uid,cm,de.empty());i.push(IDBKeyRange.bound(c,h))}return i}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(FA)}getMinOffset(e,t){return U.mapArray(this.Mn(t),(r=>this.xn(e,r).next((s=>s||ge(44426))))).next(FA)}}function jA(n){return cn(n,Xd)}function Uc(n){return cn(n,Id)}function Kh(n){return cn(n,RE)}function Bc(n){return cn(n,Ed)}function FA(n){Te(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;NE(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Mr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},h2=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(n,e,t){const r=n.store(ps),s=n.store(mu),i=[],a=IDBKeyRange.only(t.batchId);let c=0;const h=r.ee({range:a},((g,y,E)=>(c++,E.delete())));i.push(h.next((()=>{Te(c===1,47070,{batchId:t.batchId})})));const p=[];for(const g of t.mutations){const y=nP(e,g.key.path,t.batchId);i.push(s.delete(y)),p.push(g.key)}return U.waitFor(i).next((()=>p))}function ug(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ge(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(h2,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class w_{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,t,r,s){Te(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new w_(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vo(e).ee({index:dl,range:r},((s,i,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const i=Gc(e),a=Vo(e);return a.add({}).next((c=>{Te(typeof c=="number",49019);const h=new BE(c,t,r,s),p=(function(x,P,O){const M=O.baseMutations.map((W=>sf(x.yt,W))),X=O.mutations.map((W=>sf(x.yt,W)));return{userId:P,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:M,mutations:X}})(this.serializer,this.userId,h),g=[];let y=new dt(((E,x)=>je(E.canonicalString(),x.canonicalString())));for(const E of s){const x=nP(this.userId,E.key.path,c);y=y.add(E.key.path.popLast()),g.push(a.put(p)),g.push(i.put(x,o9))}return y.forEach((E=>{g.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Xn[c]=h.keys()})),U.waitFor(g).next((()=>h))}))}lookupMutationBatch(e,t){return Vo(e).get(t).next((r=>r?(Te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),il(this.serializer,r)):null))}er(e,t){return this.Xn[t]?U.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Vo(e).ee({index:dl,range:s},((a,c,h)=>{c.userId===this.userId&&(Te(c.batchId>=r,47524,{tr:r}),i=il(this.serializer,c)),h.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Zo;return Vo(e).ee({index:dl,range:t,reverse:!0},((s,i,a)=>{r=i.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Zo],[this.userId,Number.POSITIVE_INFINITY]);return Vo(e).J(dl,t).next((r=>r.map((s=>il(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Im(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Gc(e).ee({range:s},((a,c,h)=>{const[p,g,y]=a,E=Ys(g);if(p===this.userId&&t.path.isEqual(E))return Vo(e).get(y).next((x=>{if(!x)throw ge(61480,{nr:a,batchId:y});Te(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:y}),i.push(il(this.serializer,x))}));h.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(je);const s=[];return t.forEach((i=>{const a=Im(this.userId,i.path),c=IDBKeyRange.lowerBound(a),h=Gc(e).ee({range:c},((p,g,y)=>{const[E,x,P]=p,O=Ys(x);E===this.userId&&i.path.isEqual(O)?r=r.add(P):y.done()}));s.push(h)})),U.waitFor(s).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Im(this.userId,r),a=IDBKeyRange.lowerBound(i);let c=new dt(je);return Gc(e).ee({range:a},((h,p,g)=>{const[y,E,x]=h,P=Ys(E);y===this.userId&&r.isPrefixOf(P)?P.length===s&&(c=c.add(x)):g.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],s=[];return t.forEach((i=>{s.push(Vo(e).get(i).next((a=>{if(a===null)throw ge(35274,{batchId:i});Te(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:i}),r.push(il(this.serializer,a))})))})),U.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return d2(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),U.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return U.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),s=[];return Gc(e).ee({range:r},((i,a,c)=>{if(i[0]===this.userId){const h=Ys(i[1]);s.push(h)}else c.done()})).next((()=>{Te(s.length===0,56720,{sr:s.map((i=>i.canonicalString()))})}))}))}containsKey(e,t){return f2(e,this.userId,t)}_r(e){return p2(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Zo,lastStreamToken:""}))}}function f2(n,e,t){const r=Im(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let a=!1;return Gc(n).ee({range:i,X:!0},((c,h,p)=>{const[g,y,E]=c;g===e&&y===s&&(a=!0),p.done()})).next((()=>a))}function Vo(n){return cn(n,ps)}function Gc(n){return cn(n,mu)}function p2(n){return cn(n,Yd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ol(0)}static cr(){return new Ol(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Ol(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>ke.fromTimestamp(new at(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>zc(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Te(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let s=0;const i=[];return zc(e).ee(((a,c)=>{const h=ad(c);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(s++,i.push(this.removeTargetData(e,h)))})).next((()=>U.waitFor(i))).next((()=>s))}forEachTarget(e,t){return zc(e).ee(((r,s)=>{const i=ad(s);t(i)}))}lr(e){return BA(e).get(sg).next((t=>(Te(t!==null,2888),t)))}hr(e,t){return BA(e).put(sg,t)}Pr(e,t){return zc(e).put(l2(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Cl(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return zc(e).ee({range:s,index:sP},((a,c,h)=>{const p=ad(c);Df(t,p.target)&&(i=p,h.done())})).next((()=>i))}addMatchingKeys(e,t,r){const s=[],i=Bo(e);return t.forEach((a=>{const c=zn(a.path);s.push(i.put({targetId:r,path:c})),s.push(this.referenceDelegate.addReference(e,r,a))})),U.waitFor(s)}removeMatchingKeys(e,t,r){const s=Bo(e);return U.forEach(t,(i=>{const a=zn(i.path);return U.waitFor([s.delete([r,a]),this.referenceDelegate.removeReference(e,r,i)])}))}removeMatchingKeysForTargetId(e,t){const r=Bo(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Bo(e);let i=Be();return s.ee({range:r,X:!0},((a,c,h)=>{const p=Ys(a[1]),g=new de(p);i=i.add(g)})).next((()=>i))}containsKey(e,t){const r=zn(t.path),s=IDBKeyRange.bound([r],[qR(r)],!1,!0);let i=0;return Bo(e).ee({index:kE,X:!0,range:s},(([a,c],h,p)=>{a!==0&&(i++,p.done())})).next((()=>i>0))}At(e,t){return zc(e).get(t).next((r=>r?ad(r):null))}}function zc(n){return cn(n,gu)}function BA(n){return cn(n,vl)}function Bo(n){return cn(n,_u)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA="LruGarbageCollector",N7=1048576;function $A([n,e],[t,r]){const s=je(n,t);return s===0?je(e,r):s}class C7{constructor(e){this.Ir=e,this.buffer=new dt($A),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();$A(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class m2{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ne(zA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ea(t)?ne(zA,"Ignoring IndexedDB error during garbage collection: ",t):await wa(t)}await this.Vr(3e5)}))}}class k7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(cr.ce);const r=new C7(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(UA)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),UA):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,h,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,a=Date.now(),this.nthSequenceNumber(e,s)))).next((y=>(r=y,c=Date.now(),this.removeTargets(e,r,t)))).next((y=>(i=y,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((y=>(p=Date.now(),$c()<=Ge.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-g}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(h-c)+`ms
	Removed ${y} documents in `+(p-h)+`ms
Total Duration: ${p-g}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:y}))))}}function g2(n,e){return new k7(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(e,t){this.db=e,this.garbageCollector=g2(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,s)=>t(s)))}addReference(e,t,r){return um(e,r)}removeReference(e,t,r){return um(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return um(e,t)}br(e,t){return(function(s,i){let a=!1;return p2(s).te((c=>f2(s,c,i).next((h=>(h&&(a=!0),U.resolve(!h)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,((a,c)=>{if(c<=t){const h=this.br(e,a).next((p=>{if(!p)return i++,r.getEntry(e,a).next((()=>(r.removeEntry(a,ke.min()),Bo(e).delete((function(y){return[0,zn(y.path)]})(a)))))}));s.push(h)}})).next((()=>U.waitFor(s))).next((()=>r.apply(e))).next((()=>i))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return um(e,t)}Sr(e,t){const r=Bo(e);let s,i=cr.ce;return r.ee({index:kE},(([a,c],{path:h,sequenceNumber:p})=>{a===0?(i!==cr.ce&&t(new de(Ys(s)),i),i=p,s=h):i=cr.ce})).next((()=>{i!==cr.ce&&t(new de(Ys(s)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function um(n,e){return Bo(n).put((function(r,s){return{targetId:0,path:zn(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(){this.changes=new to((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?U.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Za(e).put(r)}removeEntry(e,t,r){return Za(e).delete((function(i,a){const c=i.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],lg(a),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=St.newInvalidDocument(t);return Za(e).ee({index:Tm,range:IDBKeyRange.only(Qh(t))},((s,i)=>{r=this.Cr(t,i)})).next((()=>r))}vr(e,t){let r={size:0,document:St.newInvalidDocument(t)};return Za(e).ee({index:Tm,range:IDBKeyRange.only(Qh(t))},((s,i)=>{r={document:this.Cr(t,i),size:ug(i)}})).next((()=>r))}getEntries(e,t){let r=hr();return this.Fr(e,t,((s,i)=>{const a=this.Cr(s,i);r=r.insert(s,a)})).next((()=>r))}Mr(e,t){let r=hr(),s=new wt(de.comparator);return this.Fr(e,t,((i,a)=>{const c=this.Cr(i,a);r=r.insert(i,c),s=s.insert(i,ug(a))})).next((()=>({documents:r,Or:s})))}Fr(e,t,r){if(t.isEmpty())return U.resolve();let s=new dt(qA);t.forEach((h=>s=s.add(h)));const i=IDBKeyRange.bound(Qh(s.first()),Qh(s.last())),a=s.getIterator();let c=a.getNext();return Za(e).ee({index:Tm,range:i},((h,p,g)=>{const y=de.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;c&&qA(c,y)<0;)r(c,null),c=a.getNext();c&&c.isEqual(y)&&(r(c,p),c=a.hasNext()?a.getNext():null),c?g.j(Qh(c)):g.done()})).next((()=>{for(;c;)r(c,null),c=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,i){const a=t.path,c=[a.popLast().toArray(),a.lastSegment(),lg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Za(e).J(IDBKeyRange.bound(c,h,!0)).next((p=>{i==null||i.incrementDocumentReadCount(p.length);let g=hr();for(const y of p){const E=this.Cr(de.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);E.isFoundDocument()&&(Lf(t,E)||s.has(E.key))&&(g=g.insert(E.key,E))}return g}))}getAllFromCollectionGroup(e,t,r,s){let i=hr();const a=WA(t,r),c=WA(t,Mr.max());return Za(e).ee({index:rP,range:IDBKeyRange.bound(a,c,!0)},((h,p,g)=>{const y=this.Cr(de.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);i=i.insert(y.key,y),i.size===s&&g.done()})).next((()=>i))}newChangeBuffer(e){return new D7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return HA(e).get(Pw).next((t=>(Te(!!t,20021),t)))}Dr(e,t){return HA(e).put(Pw,t)}Cr(e,t){if(t){const r=_7(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ke.min())))return r}return St.newInvalidDocument(e)}}function y2(n){return new P7(n)}class D7 extends _2{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new to((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new dt(((i,a)=>je(i.canonicalString(),a.canonicalString())));return this.changes.forEach(((i,a)=>{const c=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,c.readTime)),a.isValidDocument()){const h=AA(this.Nr.serializer,a);s=s.add(i.path.popLast());const p=ug(h);r+=p-c.size,t.push(this.Nr.addEntry(e,i,h))}else if(r-=c.size,this.trackRemovals){const h=AA(this.Nr.serializer,a.convertToNoDocument(ke.min()));t.push(this.Nr.addEntry(e,i,h))}})),s.forEach((i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))})),t.push(this.Nr.updateMetadata(e,r)),U.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:s})=>(s.forEach(((i,a)=>{this.Br.set(i,{size:a,readTime:r.get(i).readTime})})),r)))}}function HA(n){return cn(n,Jd)}function Za(n){return cn(n,rg)}function Qh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function WA(n,e){const t=e.documentKey.path.toArray();return[n,lg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function qA(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=je(t[i],r[i]),s)return s;return s=je(t.length,r.length),s||(s=je(t[t.length-2],r[r.length-2]),s||je(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&bd(r.mutation,s,ur.empty(),at.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Be()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Be()){const s=Js();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=id();return i.forEach(((c,h)=>{a=a.insert(c,h.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Js();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Be())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=hr();const a=xd(),c=(function(){return xd()})();return t.forEach(((h,p)=>{const g=r.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof no)?i=i.insert(p.key,p):g!==void 0?(a.set(p.key,g.mutation.getFieldMask()),bd(g.mutation,p,g.mutation.getFieldMask(),at.now())):a.set(p.key,ur.empty())})),this.recalculateAndSaveOverlays(e,i).next((h=>(h.forEach(((p,g)=>a.set(p,g))),t.forEach(((p,g)=>c.set(p,new O7(g,a.get(p)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=xd();let s=new wt(((a,c)=>a-c)),i=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((h=>{const p=t.get(h);if(p===null)return;let g=r.get(h)||ur.empty();g=c.applyToLocalView(p,g),r.set(h,g);const y=(s.get(c.batchId)||Be()).add(h);s=s.insert(c.batchId,y)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),p=h.key,g=h.value,y=LP();g.forEach((E=>{if(!i.has(E)){const x=zP(t.get(E),r.get(E));x!==null&&y.set(E,x),i=i.add(E)}})),a.push(this.documentOverlayCache.saveOverlays(e,p,y))}return U.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return de.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):VE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):U.resolve(Js());let c=pu,h=i;return a.next((p=>U.forEach(p,((g,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),i.get(g)?U.resolve():this.remoteDocumentCache.getEntry(e,g).next((E=>{h=h.insert(g,E)}))))).next((()=>this.populateOverlays(e,p,i))).next((()=>this.computeViews(e,h,p,Be()))).next((g=>({batchId:c,changes:OP(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new de(t)).next((r=>{let s=id();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=id();return this.indexManager.getCollectionParents(e,i).next((c=>U.forEach(c,(h=>{const p=(function(y,E){return new eo(E,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,h.child(i));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((g=>{g.forEach(((y,E)=>{a=a.insert(y,E)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((h,p)=>{const g=p.getKey();a.get(g)===null&&(a=a.insert(g,St.newInvalidDocument(g)))}));let c=id();return a.forEach(((h,p)=>{const g=i.get(h);g!==void 0&&bd(g.mutation,p,ur.empty(),at.now()),Lf(t,p)&&(c=c.insert(h,p))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return U.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Yt(s.createTime)}})(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:qE(s.bundledQuery),readTime:Yt(s.readTime)}})(t)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M7{constructor(){this.overlays=new wt(de.comparator),this.qr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Js();return U.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),U.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,t,r){const s=Js(),i=t.length+1,a=new de(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const h=c.getNext().value,p=h.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===i&&h.largestBatchId>r&&s.set(h.getKey(),h)}return U.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new wt(((p,g)=>p-g));const a=this.overlays.getIterator();for(;a.hasNext();){const p=a.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let g=i.get(p.largestBatchId);g===null&&(g=Js(),i=i.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const c=Js(),h=i.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((p,g)=>c.set(p,g))),!(c.size()>=s)););return U.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new $E(t,r));let i=this.qr.get(t);i===void 0&&(i=Be(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(){this.sessionToken=$t.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(){this.Qr=new dt(gn.$r),this.Ur=new dt(gn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new gn(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new gn(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new de(new Qe([])),r=new gn(t,e),s=new gn(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new de(new Qe([])),r=new gn(t,e),s=new gn(t,e+1);let i=Be();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new gn(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class gn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return de.comparator(e.key,t.key)||je(e.Yr,t.Yr)}static Kr(e,t){return je(e.Yr,t.Yr)||de.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new dt(gn.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new BE(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new gn(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,t){return U.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Zo:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new gn(t,0),s=new gn(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(je);return t.forEach((s=>{const i=new gn(s,0),a=new gn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;de.isDocumentKey(i)||(i=i.child(""));const a=new gn(new de(i),0);let c=new dt(je);return this.Zr.forEachWhile((h=>{const p=h.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(c=c.add(h.Yr)),!0)}),a),U.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(t.mutations,(s=>{const i=new gn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new gn(t,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e){this.ri=e,this.docs=(function(){return new wt(de.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return U.resolve(r?r.document.mutableCopy():St.newInvalidDocument(t))}getEntries(e,t){let r=hr();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():St.newInvalidDocument(s))})),U.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=hr();const a=t.path,c=new de(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:p,value:{document:g}}=h.getNext();if(!a.isPrefixOf(p.path))break;p.path.length>a.length+1||NE(JR(g),r)<=0||(s.has(g.key)||Lf(t,g))&&(i=i.insert(g.key,g.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,t,r,s){ge(9500)}ii(e,t){return U.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new U7(this)}getSize(e){return U.resolve(this.size)}}class U7 extends _2{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),U.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e){this.persistence=e,this.si=new to((t=>Cl(t)),Df),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.oi=0,this._i=new QE,this.targetCount=0,this.ai=Ol.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),U.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ol(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.Pr(t),U.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),U.waitFor(i).next((()=>s))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return U.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),U.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),U.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return U.resolve(r)}containsKey(e,t){return U.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,t){this.ui={},this.overlays={},this.ci=new cr(0),this.li=!1,this.li=!0,this.hi=new V7,this.referenceDelegate=e(this),this.Pi=new B7(this),this.indexManager=new b7,this.remoteDocumentCache=(function(s){return new F7(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new a2(t),this.Ii=new L7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new M7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new j7(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ne("MemoryPersistence","Starting transaction:",e);const s=new z7(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return U.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class z7 extends ZR{constructor(e){super(),this.currentSequenceNumber=e}}class E_{constructor(e){this.persistence=e,this.Ri=new QE,this.Vi=null}static mi(e){return new E_(e)}get fi(){if(this.Vi)return this.Vi;throw ge(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),U.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,(r=>{const s=de.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,ke.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class hg{constructor(e,t){this.persistence=e,this.pi=new to((r=>zn(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=g2(this,t)}static mi(e,t){return new hg(e,t)}Ei(){}di(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return U.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?U.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,ke.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bm(e.data.value)),t}br(e,t,r){return U.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(e){this.serializer=e}k(e,t,r,s){const i=new u_("createOrUpgrade",t);r<1&&s>=1&&((function(h){h.createObjectStore(Pf)})(e),(function(h){h.createObjectStore(Yd,{keyPath:i9}),h.createObjectStore(ps,{keyPath:rA,autoIncrement:!0}).createIndex(dl,sA,{unique:!0}),h.createObjectStore(mu)})(e),GA(e),(function(h){h.createObjectStore(rl)})(e));let a=U.resolve();return r<3&&s>=3&&(r!==0&&((function(h){h.deleteObjectStore(_u),h.deleteObjectStore(gu),h.deleteObjectStore(vl)})(e),GA(e)),a=a.next((()=>(function(h){const p=h.store(vl),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ke.min().toTimestamp(),targetCount:0};return p.put(sg,g)})(i)))),r<4&&s>=4&&(r!==0&&(a=a.next((()=>(function(h,p){return p.store(ps).J().next((y=>{h.deleteObjectStore(ps),h.createObjectStore(ps,{keyPath:rA,autoIncrement:!0}).createIndex(dl,sA,{unique:!0});const E=p.store(ps),x=y.map((P=>E.put(P)));return U.waitFor(x)}))})(e,i)))),a=a.next((()=>{(function(h){h.createObjectStore(yu,{keyPath:p9})})(e)}))),r<5&&s>=5&&(a=a.next((()=>this.yi(i)))),r<6&&s>=6&&(a=a.next((()=>((function(h){h.createObjectStore(Jd)})(e),this.wi(i))))),r<7&&s>=7&&(a=a.next((()=>this.Si(i)))),r<8&&s>=8&&(a=a.next((()=>this.bi(e,i)))),r<9&&s>=9&&(a=a.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(a=a.next((()=>this.Di(i)))),r<11&&s>=11&&(a=a.next((()=>{(function(h){h.createObjectStore(h_,{keyPath:m9})})(e),(function(h){h.createObjectStore(d_,{keyPath:g9})})(e)}))),r<12&&s>=12&&(a=a.next((()=>{(function(h){const p=h.createObjectStore(f_,{keyPath:T9});p.createIndex(Ow,x9,{unique:!1}),p.createIndex(aP,b9,{unique:!1})})(e)}))),r<13&&s>=13&&(a=a.next((()=>(function(h){const p=h.createObjectStore(rg,{keyPath:a9});p.createIndex(Tm,l9),p.createIndex(rP,c9)})(e))).next((()=>this.Ci(e,i))).next((()=>e.deleteObjectStore(rl)))),r<14&&s>=14&&(a=a.next((()=>this.Fi(e,i)))),r<15&&s>=15&&(a=a.next((()=>(function(h){h.createObjectStore(RE,{keyPath:_9,autoIncrement:!0}).createIndex(Dw,y9,{unique:!1}),h.createObjectStore(Ed,{keyPath:v9}).createIndex(iP,w9,{unique:!1}),h.createObjectStore(Id,{keyPath:E9}).createIndex(oP,I9,{unique:!1})})(e)))),r<16&&s>=16&&(a=a.next((()=>{t.objectStore(Ed).clear()})).next((()=>{t.objectStore(Id).clear()}))),r<17&&s>=17&&(a=a.next((()=>{(function(h){h.createObjectStore(PE,{keyPath:S9})})(e)}))),r<18&&s>=18&&iC()&&(a=a.next((()=>{t.objectStore(Ed).clear()})).next((()=>{t.objectStore(Id).clear()}))),a}wi(e){let t=0;return e.store(rl).ee(((r,s)=>{t+=ug(s)})).next((()=>{const r={byteSize:t};return e.store(Jd).put(Pw,r)}))}yi(e){const t=e.store(Yd),r=e.store(ps);return t.J().next((s=>U.forEach(s,(i=>{const a=IDBKeyRange.bound([i.userId,Zo],[i.userId,i.lastAcknowledgedBatchId]);return r.J(dl,a).next((c=>U.forEach(c,(h=>{Te(h.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const p=il(this.serializer,h);return d2(e,i.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(_u),r=e.store(rl);return e.store(vl).get(sg).next((s=>{const i=[];return r.ee(((a,c)=>{const h=new Qe(a),p=(function(y){return[0,zn(y)]})(h);i.push(t.get(p).next((g=>g?U.resolve():(y=>t.put({targetId:0,path:zn(y),sequenceNumber:s.highestListenSequenceNumber}))(h))))})).next((()=>U.waitFor(i)))}))}bi(e,t){e.createObjectStore(Xd,{keyPath:f9});const r=t.store(Xd),s=new KE,i=a=>{if(s.add(a)){const c=a.lastSegment(),h=a.popLast();return r.put({collectionId:c,parent:zn(h)})}};return t.store(rl).ee({X:!0},((a,c)=>{const h=new Qe(a);return i(h.popLast())})).next((()=>t.store(mu).ee({X:!0},(([a,c,h],p)=>{const g=Ys(c);return i(g.popLast())}))))}Di(e){const t=e.store(gu);return t.ee(((r,s)=>{const i=ad(s),a=l2(this.serializer,i);return t.put(a)}))}Ci(e,t){const r=t.store(rl),s=[];return r.ee(((i,a)=>{const c=t.store(rg),h=(function(y){return y.document?new de(Qe.fromString(y.document.name).popFirst(5)):y.noDocument?de.fromSegments(y.noDocument.path):y.unknownDocument?de.fromSegments(y.unknownDocument.path):ge(36783)})(a).path.toArray(),p={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};s.push(c.put(p))})).next((()=>U.waitFor(s)))}Fi(e,t){const r=t.store(ps),s=y2(this.serializer),i=new YE(E_.mi,this.serializer.yt);return r.J().next((a=>{const c=new Map;return a.forEach((h=>{let p=c.get(h.userId)??Be();il(this.serializer,h).keys().forEach((g=>p=p.add(g))),c.set(h.userId,p)})),U.forEach(c,((h,p)=>{const g=new yn(p),y=v_.wt(this.serializer,g),E=i.getIndexManager(g),x=w_.wt(g,this.serializer,E,i.referenceDelegate);return new v2(s,x,y,E).recalculateAndSaveOverlaysForDocumentKeys(new Lw(t,cr.ce),h).next()}))}))}}function GA(n){n.createObjectStore(_u,{keyPath:h9}).createIndex(kE,d9,{unique:!0}),n.createObjectStore(gu,{keyPath:"targetId"}).createIndex(sP,u9,{unique:!0}),n.createObjectStore(vl)}const jo="IndexedDbPersistence",Dv=18e5,Ov=5e3,Lv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",w2="main";class JE{constructor(e,t,r,s,i,a,c,h,p,g,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=i,this.window=a,this.document=c,this.xi=p,this.Oi=g,this.Ni=y,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=E=>Promise.resolve(),!JE.v())throw new ee(G.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new R7(this,s),this.$i=t+w2,this.serializer=new a2(h),this.Ui=new ti(this.$i,this.Ni,new $7(this.serializer)),this.hi=new v7,this.Pi=new A7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=y2(this.serializer),this.Ii=new y7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,g===!1&&Kt(jo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ee(G.FAILED_PRECONDITION,Lv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new cr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>hm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ea(e))return ne(jo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ne(jo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Yh(e).get(Vc).next((t=>U.resolve(this.es(t))))}ts(e){return hm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Dv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=cn(t,yu);return r.J().next((s=>{const i=this.ss(s,Dv),a=s.filter((c=>i.indexOf(c)===-1));return U.forEach(a,(c=>r.delete(c.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?U.resolve(!0):Yh(e).get(Vc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ov)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ee(G.FAILED_PRECONDITION,Lv);return!1}}return!(!this.networkEnabled||!this.inForeground)||hm(e).J().next((r=>this.ss(r,Ov).find((s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,a=!this.inForeground&&s.inForeground,c=this.networkEnabled===s.networkEnabled;if(i||a&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ne(jo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pf,yu],(e=>{const t=new Lw(e,cr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>hm(e).J().next((t=>this.ss(t,Dv).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return w_.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new S7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return v_.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){ne(jo,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=(function(h){return h===18?C9:h===17?hP:h===16?N9:h===15?DE:h===14?uP:h===13?cP:h===12?A9:h===11?lP:void ge(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,s,i,(c=>(a=new Lw(c,this.ci?this.ci.next():cr.ce),t==="readwrite-primary"?this.Hi(a).next((h=>!!h||this.Yi(a))).next((h=>{if(!h)throw Kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ee(G.FAILED_PRECONDITION,XR);return r(a)})).next((h=>this.Xi(a).next((()=>h)))):this.Is(a).next((()=>r(a)))))).then((c=>(a.raiseOnCommittedEvent(),c)))}Is(e){return Yh(e).get(Vc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ov)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ee(G.FAILED_PRECONDITION,Lv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yh(e).put(Vc,t)}static v(){return ti.v()}Zi(e){const t=Yh(e);return t.get(Vc).next((r=>this.es(r)?(ne(jo,"Releasing primary lease."),t.delete(Vc)):U.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Kt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;sC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const r=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ne(jo,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Kt(jo,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Kt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Yh(n){return cn(n,Pf)}function hm(n){return cn(n,yu)}function XE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Be(),s=Be();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ZE(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return sC()?8:eP(Ut())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new H7;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?($c()<=Ge.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Hc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):($c()<=Ge.DEBUG&&ne("QueryEngine","Query:",Hc(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?($c()<=Ge.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Hc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yn(t))):U.resolve())}ys(e,t){if(_A(t))return U.resolve(null);let r=Yn(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ag(t,null,"F"),r=Yn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=Be(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((h=>{const p=this.Ds(t,c);return this.Cs(t,p,a,h.readTime)?this.ys(e,ag(t,null,"F")):this.vs(e,p,t,h)}))))})))))}ws(e,t,r,s){return _A(t)||s.isEqual(ke.min())?U.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?U.resolve(null):($c()<=Ge.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hc(t)),this.vs(e,a,t,YR(s,pu)).next((c=>c)))}))}Ds(e,t){let r=new dt(PP(e));return t.forEach(((s,i)=>{Lf(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return $c()<=Ge.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Hc(t)),this.ps.getDocumentsMatchingQuery(e,t,Mr.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="LocalStore",W7=3e8;class q7{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new wt(je),this.xs=new to((i=>Cl(i)),Df),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function I2(n,e,t,r){return new q7(n,e,t,r)}async function T2(n,e){const t=pe(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let h=Be();for(const p of s){a.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}for(const p of i){c.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next((p=>({Ls:p,removedBatchIds:a,addedBatchIds:c})))}))}))}function G7(n,e){const t=pe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,h,p,g){const y=p.batch,E=y.keys();let x=U.resolve();return E.forEach((P=>{x=x.next((()=>g.getEntry(h,P))).next((O=>{const M=p.docVersions.get(P);Te(M!==null,48541),O.version.compareTo(M)<0&&(y.applyToRemoteDocument(O,p),O.isValidDocument()&&(O.setReadTime(p.commitVersion),g.addEntry(O)))}))})),x.next((()=>c.mutationQueue.removeMutationBatch(h,y)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let h=Be();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(h=h.add(c.batch.mutations[p].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function x2(n){const e=pe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function K7(n,e){const t=pe(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((g,y)=>{const E=s.get(y);if(!E)return;c.push(t.Pi.removeMatchingKeys(i,g.removedDocuments,y).next((()=>t.Pi.addMatchingKeys(i,g.addedDocuments,y))));let x=E.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?x=x.withResumeToken($t.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):g.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(g.resumeToken,r)),s=s.insert(y,x),(function(O,M,X){return O.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=W7?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(E,x,g)&&c.push(t.Pi.updateTargetData(i,x))}));let h=hr(),p=Be();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,g))})),c.push(b2(i,a,e.documentUpdates).next((g=>{h=g.ks,p=g.qs}))),!r.isEqual(ke.min())){const g=t.Pi.getLastRemoteSnapshotVersion(i).next((y=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(g)}return U.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,h,p))).next((()=>h))})).then((i=>(t.Ms=s,i)))}function b2(n,e,t){let r=Be(),s=Be();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=hr();return t.forEach(((c,h)=>{const p=i.get(c);h.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(c)),h.isNoDocument()&&h.version.isEqual(ke.min())?(e.removeEntry(c,h.readTime),a=a.insert(c,h)):!p.isValidDocument()||h.version.compareTo(p.version)>0||h.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(h),a=a.insert(c,h)):ne(eI,"Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",h.version)})),{ks:a,qs:s}}))}function Q7(n,e){const t=pe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Zo),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function bu(n,e){const t=pe(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,U.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new Fi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Su(n,e,t){const r=pe(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Ea(a))throw a;ne(eI,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function dg(n,e,t){const r=pe(n);let s=ke.min(),i=Be();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(h,p,g){const y=pe(h),E=y.xs.get(g);return E!==void 0?U.resolve(y.Ms.get(E)):y.Pi.getTargetData(p,g)})(r,a,Yn(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((h=>{i=h}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:ke.min(),t?i:Be()))).next((c=>(N2(r,RP(e),c),{documents:c,Qs:i})))))}function S2(n,e){const t=pe(n),r=pe(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(i=>r.At(i,e).next((a=>a?a.target:null))))}function A2(n,e){const t=pe(n),r=t.Os.get(e)||ke.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,YR(r,pu),Number.MAX_SAFE_INTEGER))).then((s=>(N2(t,e,s),s)))}function N2(n,e,t){let r=n.Os.get(e)||ke.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}async function Y7(n,e,t,r){const s=pe(n);let i=Be(),a=hr();for(const p of t){const g=e.$s(p.metadata.name);p.document&&(i=i.add(g));const y=e.Us(p);y.setReadTime(e.Ks(p.metadata.readTime)),a=a.insert(g,y)}const c=s.Ns.newChangeBuffer({trackRemovals:!0}),h=await bu(s,(function(g){return Yn($u(Qe.fromString(`__bundle__/docs/${g}`)))})(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",(p=>b2(p,c,a).next((g=>(c.apply(p),g))).next((g=>s.Pi.removeMatchingKeysForTargetId(p,h.targetId).next((()=>s.Pi.addMatchingKeys(p,i,h.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(p,g.ks,g.qs))).next((()=>g.ks))))))}async function J7(n,e,t=Be()){const r=await bu(n,Yn(qE(e.bundledQuery))),s=pe(n);return s.persistence.runTransaction("Save named query","readwrite",(i=>{const a=Yt(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return s.Ii.saveNamedQuery(i,e);const c=r.withResumeToken($t.EMPTY_BYTE_STRING,a);return s.Ms=s.Ms.insert(c.targetId,c),s.Pi.updateTargetData(i,c).next((()=>s.Pi.removeMatchingKeysForTargetId(i,r.targetId))).next((()=>s.Pi.addMatchingKeys(i,t,r.targetId))).next((()=>s.Ii.saveNamedQuery(i,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="firestore_clients";function KA(n,e){return`${C2}_${n}_${e}`}const k2="firestore_mutations";function QA(n,e,t){let r=`${k2}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const R2="firestore_targets";function Mv(n,e){return`${R2}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="SharedClientState";class fg{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Ws(e,t,r){const s=JSON.parse(r);let i,a=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(i=new ee(s.error.code,s.error.message))),a?new fg(e,t,s.state,i):(Kt($s,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sd{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new ee(r.error.code,r.error.message))),i?new Sd(e,r.state,s):(Kt($s,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=jE();for(let a=0;s&&a<r.activeTargetIds.length;++a)s=tP(r.activeTargetIds[a]),i=i.add(r.activeTargetIds[a]);return s?new pg(e,i):(Kt($s,`Failed to parse client data for instance '${e}': ${t}`),null)}}class tI{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new tI(t.clientId,t.onlineState):(Kt($s,`Failed to parse online state: ${e}`),null)}}class Yw{constructor(){this.activeTargetIds=jE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Vv{constructor(e,t,r,s,i){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new wt(je),this.started=!1,this.Xs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.eo=KA(this.persistenceKey,this.Js),this.no=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Yw),this.ro=new RegExp(`^${C2}_${a}_([^_]*)$`),this.io=new RegExp(`^${k2}_${a}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${R2}_${a}_(\\d+)$`),this.oo=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this._o=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(KA(this.persistenceKey,r));if(s){const i=pg.Ws(r,s);i&&(this.Zs=this.Zs.insert(i.clientId,i))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Mv(this.persistenceKey,e));if(s){const i=Sd.Ws(e,s);i&&(r=i.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Mv(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((s=>{this.Po(s)})),this.currentUser=e,r.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ne($s,"READ",e,t),t}setItem(e,t){ne($s,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ne($s,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ne($s,"EVENT",t.key,t.newValue),t.key===this.eo)return void Kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(i){let a=cr.ce;if(i!=null)try{const c=JSON.parse(i);Te(typeof c=="number",30636,{So:i}),a=c}catch(c){Kt($s,"Failed to read sequence number from WebStorage",c)}return a})(t.newValue);r!==cr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const s=new fg(this.currentUser,e,t,r),i=QA(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Gs())}Po(e){const t=QA(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const s=Mv(this.persistenceKey,e),i=new Sd(e,t,r);this.setItem(s,i.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return pg.Ws(r,t)}fo(e,t){const r=this.io.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return fg.Ws(new yn(i),s,t)}yo(e,t){const r=this.so.exec(e),s=Number(r[1]);return Sd.Ws(s,t)}uo(e){return tI.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ne($s,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),i=this.lo(r),a=[],c=[];return i.forEach((h=>{s.has(h)||a.push(h)})),s.forEach((h=>{i.has(h)||c.push(h)})),this.syncEngine.Fo(a,c).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=jE();return e.forEach(((r,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class P2{constructor(){this.Mo=new Yw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Yw,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="ConnectivityMonitor";class JA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ne(YA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ne(YA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dm=null;function Jw(){return dm===null?dm=(function(){return 268435456+Math.round(2147483648*Math.random())})():dm++,"0x"+dm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="RestConnection",Z7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class e8{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Mw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Jw(),c=this.zo(e,t.toUriEncodedString());ne(jv,`Sending RPC '${e}' ${a}:`,c,r);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,i);const{host:p}=new URL(c),g=_a(p);return this.Jo(e,c,h,r,g).then((y=>(ne(jv,`Received RPC '${e}' ${a}: `,y),y)),(y=>{throw ci(jv,`RPC '${e}' ${a} failed with error: `,y,"url: ",c,"request:",r),y}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=Z7[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class n8 extends e8{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Jw();return new Promise(((c,h)=>{const p=new FR;p.setWithCredentials(!0),p.listenOnce(UR.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case wm.NO_ERROR:const y=p.getResponseJson();ne(Vn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),c(y);break;case wm.TIMEOUT:ne(Vn,`RPC '${e}' ${a} timed out`),h(new ee(G.DEADLINE_EXCEEDED,"Request time out"));break;case wm.HTTP_ERROR:const E=p.getStatus();if(ne(Vn,`RPC '${e}' ${a} failed with status:`,E,"response text:",p.getResponseText()),E>0){let x=p.getResponseJson();Array.isArray(x)&&(x=x[0]);const P=x==null?void 0:x.error;if(P&&P.status&&P.message){const O=(function(X){const W=X.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(W)>=0?W:G.UNKNOWN})(P.status);h(new ee(O,P.message))}else h(new ee(G.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new ee(G.UNAVAILABLE,"Connection failed."));break;default:ge(9055,{l_:e,streamId:a,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{ne(Vn,`RPC '${e}' ${a} completed.`)}}));const g=JSON.stringify(s);ne(Vn,`RPC '${e}' ${a} sending request:`,s),p.send(t,"POST",g,r,15)}))}T_(e,t,r){const s=Jw(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=$R(),c=zR(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(h.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=i.join("");ne(Vn,`Creating RPC '${e}' stream ${s}: ${g}`,h);const y=a.createWebChannel(g,h);this.I_(y);let E=!1,x=!1;const P=new t8({Yo:M=>{x?ne(Vn,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(E||(ne(Vn,`Opening RPC '${e}' stream ${s} transport.`),y.open(),E=!0),ne(Vn,`RPC '${e}' stream ${s} sending:`,M),y.send(M))},Zo:()=>y.close()}),O=(M,X,W)=>{M.listen(X,(Q=>{try{W(Q)}catch(Y){setTimeout((()=>{throw Y}),0)}}))};return O(y,sd.EventType.OPEN,(()=>{x||(ne(Vn,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),O(y,sd.EventType.CLOSE,(()=>{x||(x=!0,ne(Vn,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(y))})),O(y,sd.EventType.ERROR,(M=>{x||(x=!0,ci(Vn,`RPC '${e}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),P.a_(new ee(G.UNAVAILABLE,"The operation could not be completed")))})),O(y,sd.EventType.MESSAGE,(M=>{var X;if(!x){const W=M.data[0];Te(!!W,16349);const Q=W,Y=(Q==null?void 0:Q.error)||((X=Q[0])==null?void 0:X.error);if(Y){ne(Vn,`RPC '${e}' stream ${s} received error:`,Y);const ue=Y.status;let se=(function(k){const D=en[k];if(D!==void 0)return WP(D)})(ue),R=Y.message;se===void 0&&(se=G.INTERNAL,R="Unknown error status: "+ue+" with message "+Y.message),x=!0,P.a_(new ee(se,R)),y.close()}else ne(Vn,`RPC '${e}' stream ${s} received:`,W),P.u_(W)}})),O(c,BR.STAT_EVENT,(M=>{M.stat===Cw.PROXY?ne(Vn,`RPC '${e}' stream ${s} detected buffering proxy`):M.stat===Cw.NOPROXY&&ne(Vn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(){return typeof window<"u"?window:null}function km(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(n){return new a7(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="PersistentStream";class O2{constructor(e,t,r,s,i,a,c,h){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new nI(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===G.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new ee(G.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ne(XA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ne(XA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class r8 extends O2{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=u7(this.serializer,e),r=(function(i){if(!("targetChange"in i))return ke.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ke.min():a.readTime?Yt(a.readTime):ke.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ww(this.serializer),t.addTarget=(function(i,a){let c;const h=a.target;if(c=ig(h)?{documents:t2(i,h)}:{query:n2(i,h).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=QP(i,a.resumeToken);const p=$w(i,a.expectedCount);p!==null&&(c.expectedCount=p)}else if(a.snapshotVersion.compareTo(ke.min())>0){c.readTime=xu(i,a.snapshotVersion.toTimestamp());const p=$w(i,a.expectedCount);p!==null&&(c.expectedCount=p)}return c})(this.serializer,e);const r=d7(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ww(this.serializer),t.removeTarget=e,this.q_(t)}}class s8 extends O2{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=h7(e.writeResults,e.commitTime),r=Yt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ww(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>sf(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{}class o8 extends i8{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ee(G.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Hw(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ee(G.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Hw(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ee(G.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class a8{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kt(t),this.aa=!1):ne("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll="RemoteStore";class l8{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Ta(this)&&(ne(Ll,"Restarting streams for network reachability change."),await(async function(h){const p=pe(h);p.Ea.add(4),await qu(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Uf(p)})(this))}))})),this.Ra=new a8(r,s)}}async function Uf(n){if(Ta(n))for(const e of n.da)await e(!0)}async function qu(n){for(const e of n.da)await e(!1)}function I_(n,e){const t=pe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),iI(t)?sI(t):Ku(t).O_()&&rI(t,e))}function Au(n,e){const t=pe(n),r=Ku(t);t.Ia.delete(e),r.O_()&&L2(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ta(t)&&t.Ra.set("Unknown"))}function rI(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ku(n).Y_(e)}function L2(n,e){n.Va.Ue(e),Ku(n).Z_(e)}function sI(n){n.Va=new r7({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ku(n).start(),n.Ra.ua()}function iI(n){return Ta(n)&&!Ku(n).x_()&&n.Ia.size>0}function Ta(n){return pe(n).Ea.size===0}function M2(n){n.Va=void 0}async function c8(n){n.Ra.set("Online")}async function u8(n){n.Ia.forEach(((e,t)=>{rI(n,e)}))}async function h8(n,e){M2(n),iI(n)?(n.Ra.ha(e),sI(n)):n.Ra.set("Unknown")}async function d8(n,e,t){if(n.Ra.set("Online"),e instanceof KP&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){ne(Ll,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await mg(n,r)}else if(e instanceof Nm?n.Va.Ze(e):e instanceof GP?n.Va.st(e):n.Va.tt(e),!t.isEqual(ke.min()))try{const r=await x2(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((h,p)=>{if(h.resumeToken.approximateByteSize()>0){const g=i.Ia.get(p);g&&i.Ia.set(p,g.withResumeToken(h.resumeToken,a))}})),c.targetMismatches.forEach(((h,p)=>{const g=i.Ia.get(h);if(!g)return;i.Ia.set(h,g.withResumeToken($t.EMPTY_BYTE_STRING,g.snapshotVersion)),L2(i,h);const y=new Fi(g.target,h,p,g.sequenceNumber);rI(i,y)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){ne(Ll,"Failed to raise snapshot:",r),await mg(n,r)}}async function mg(n,e,t){if(!Ea(e))throw e;n.Ea.add(1),await qu(n),n.Ra.set("Offline"),t||(t=()=>x2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ne(Ll,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Uf(n)}))}function V2(n,e){return e().catch((t=>mg(n,t,e)))}async function Gu(n){const e=pe(n),t=fa(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Zo;for(;f8(e);)try{const s=await Q7(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,p8(e,s)}catch(s){await mg(e,s)}j2(e)&&F2(e)}function f8(n){return Ta(n)&&n.Ta.length<10}function p8(n,e){n.Ta.push(e);const t=fa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function j2(n){return Ta(n)&&!fa(n).x_()&&n.Ta.length>0}function F2(n){fa(n).start()}async function m8(n){fa(n).ra()}async function g8(n){const e=fa(n);for(const t of n.Ta)e.ea(t.mutations)}async function _8(n,e,t){const r=n.Ta.shift(),s=zE.from(r,e,t);await V2(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Gu(n)}async function y8(n,e){e&&fa(n).X_&&await(async function(r,s){if((function(a){return HP(a)&&a!==G.ABORTED})(s.code)){const i=r.Ta.shift();fa(r).B_(),await V2(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Gu(r)}})(n,e),j2(n)&&F2(n)}async function ZA(n,e){const t=pe(n);t.asyncQueue.verifyOperationInProgress(),ne(Ll,"RemoteStore received new credentials");const r=Ta(t);t.Ea.add(3),await qu(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Uf(t)}async function Xw(n,e){const t=pe(n);e?(t.Ea.delete(2),await Uf(t)):e||(t.Ea.add(2),await qu(t),t.Ra.set("Unknown"))}function Ku(n){return n.ma||(n.ma=(function(t,r,s){const i=pe(t);return i.sa(),new r8(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:c8.bind(null,n),t_:u8.bind(null,n),r_:h8.bind(null,n),H_:d8.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),iI(n)?sI(n):n.Ra.set("Unknown")):(await n.ma.stop(),M2(n))}))),n.ma}function fa(n){return n.fa||(n.fa=(function(t,r,s){const i=pe(t);return i.sa(),new s8(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:m8.bind(null,n),r_:y8.bind(null,n),ta:g8.bind(null,n),na:_8.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Gu(n)):(await n.fa.stop(),n.Ta.length>0&&(ne(Ll,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new kn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new oI(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ee(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qu(n,e){if(Kt("AsyncQueue",`${e}: ${n}`),Ea(n))return new ee(G.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{static emptySet(e){return new ru(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||de.comparator(t.key,r.key):(t,r)=>de.comparator(t.key,r.key),this.keyedMap=id(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ru)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ru;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(){this.ga=new wt(de.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ge(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Nu{constructor(e,t,r,s,i,a,c,h,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Nu(e,t,ru.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Of(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class w8{constructor(){this.queries=t1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=pe(t),i=s.queries;s.queries=t1(),i.forEach(((a,c)=>{for(const h of c.Sa)h.onError(r)}))})(this,new ee(G.ABORTED,"Firestore shutting down"))}}function t1(){return new to((n=>kP(n)),Of)}async function aI(n,e){const t=pe(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new v8,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Qu(a,`Initialization of query '${Hc(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&cI(t)}async function lI(n,e){const t=pe(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function E8(n,e){const t=pe(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&cI(t)}function I8(n,e,t){const r=pe(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function cI(n){n.Ca.forEach((e=>{e.next()}))}var Zw,n1;(n1=Zw||(Zw={})).Ma="default",n1.Cache="cache";class uI{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Nu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Nu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zw.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(e){this.serializer=e}$s(e){return ni(this.serializer,e)}Us(e){return e.metadata.exists?e2(this.serializer,e.document,!1):St.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Yt(e)}}class x8{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=U2(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=Qe.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new r1(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.$s(s.metadata.name);for(const a of s.metadata.queries){const c=(t.get(a)||Be()).add(i);t.set(a,c)}}return t}async ja(e){const t=await Y7(e,new r1(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await J7(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function U2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e){this.key=e}}class z2{constructor(e){this.key=e}}class $2{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Be(),this.mutatedKeys=Be(),this.eu=PP(e),this.tu=new ru(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new e1,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,y)=>{const E=s.get(g),x=Lf(this.query,y)?y:null,P=!!E&&this.mutatedKeys.has(E.key),O=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let M=!1;E&&x?E.data.isEqual(x.data)?P!==O&&(r.track({type:3,doc:x}),M=!0):this.su(E,x)||(r.track({type:2,doc:x}),M=!0,(h&&this.eu(x,h)>0||p&&this.eu(x,p)<0)&&(c=!0)):!E&&x?(r.track({type:0,doc:x}),M=!0):E&&!x&&(r.track({type:1,doc:E}),M=!0,(h||p)&&(c=!0)),M&&(x?(a=a.add(x),i=O?i.add(g):i.delete(g)):(a=a.delete(g),i=i.delete(g)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const g=this.query.limitType==="F"?a.last():a.first();a=a.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((g,y)=>(function(x,P){const O=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge(20277,{Rt:M})}};return O(x)-O(P)})(g.type,y.type)||this.eu(g.doc,y.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,p=h!==this.Za;return this.Za=h,a.length!==0||p?{snapshot:new Nu(this.query,e.tu,i,a,e.mutatedKeys,h===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new e1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Be(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new z2(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new B2(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Be();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Nu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const xa="SyncEngine";class b8{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class S8{constructor(e){this.key=e,this.hu=!1}}class A8{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new to((c=>kP(c)),Of),this.Iu=new Map,this.Eu=new Set,this.du=new wt(de.comparator),this.Au=new Map,this.Ru=new QE,this.Vu={},this.mu=new Map,this.fu=Ol.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function N8(n,e,t=!0){const r=T_(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await H2(r,e,t,!0),s}async function C8(n,e){const t=T_(n);await H2(t,e,!0,!1)}async function H2(n,e,t,r){const s=await bu(n.localStore,Yn(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await hI(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&I_(n.remoteStore,s),c}async function hI(n,e,t,r,s){n.pu=(y,E,x)=>(async function(O,M,X,W){let Q=M.view.ru(X);Q.Cs&&(Q=await dg(O.localStore,M.query,!1).then((({documents:R})=>M.view.ru(R,Q))));const Y=W&&W.targetChanges.get(M.targetId),ue=W&&W.targetMismatches.get(M.targetId)!=null,se=M.view.applyChanges(Q,O.isPrimaryClient,Y,ue);return e0(O,M.targetId,se.au),se.snapshot})(n,y,E,x);const i=await dg(n.localStore,e,!0),a=new $2(e,i.Qs),c=a.ru(i.documents),h=jf.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=a.applyChanges(c,n.isPrimaryClient,h);e0(n,t,p.au);const g=new b8(e,t,a);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function k8(n,e,t){const r=pe(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!Of(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Su(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Au(r.remoteStore,s.targetId),Cu(r,s.targetId)})).catch(wa)):(Cu(r,s.targetId),await Su(r.localStore,s.targetId,!0))}async function R8(n,e){const t=pe(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Au(t.remoteStore,r.targetId))}async function P8(n,e,t){const r=mI(n);try{const s=await(function(a,c){const h=pe(a),p=at.now(),g=c.reduce(((x,P)=>x.add(P.key)),Be());let y,E;return h.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let P=hr(),O=Be();return h.Ns.getEntries(x,g).next((M=>{P=M,P.forEach(((X,W)=>{W.isValidDocument()||(O=O.add(X))}))})).next((()=>h.localDocuments.getOverlayedDocuments(x,P))).next((M=>{y=M;const X=[];for(const W of c){const Q=e7(W,y.get(W.key).overlayedDocument);Q!=null&&X.push(new no(W.key,Q,EP(Q.value.mapValue),Dt.exists(!0)))}return h.mutationQueue.addMutationBatch(x,p,X,c)})).next((M=>{E=M;const X=M.applyToLocalDocumentSet(y,O);return h.documentOverlayCache.saveOverlays(x,M.batchId,X)}))})).then((()=>({batchId:E.batchId,changes:OP(y)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,h){let p=a.Vu[a.currentUser.toKey()];p||(p=new wt(je)),p=p.insert(c,h),a.Vu[a.currentUser.toKey()]=p})(r,s.batchId,t),await ro(r,s.changes),await Gu(r.remoteStore)}catch(s){const i=Qu(s,"Failed to persist write");t.reject(i)}}async function W2(n,e){const t=pe(n);try{const r=await K7(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Te(a.hu,14607):s.removedDocuments.size>0&&(Te(a.hu,42227),a.hu=!1))})),await ro(t,r,e)}catch(r){await wa(r)}}function s1(n,e,t){const r=pe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const h=pe(a);h.onlineState=c;let p=!1;h.queries.forEach(((g,y)=>{for(const E of y.Sa)E.va(c)&&(p=!0)})),p&&cI(h)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function D8(n,e,t){const r=pe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new wt(de.comparator);a=a.insert(i,St.newNoDocument(i,ke.min()));const c=Be().add(i),h=new Vf(ke.min(),new Map,new wt(je),a,c);await W2(r,h),r.du=r.du.remove(i),r.Au.delete(e),pI(r)}else await Su(r.localStore,e,!1).then((()=>Cu(r,e,t))).catch(wa)}async function O8(n,e){const t=pe(n),r=e.batch.batchId;try{const s=await G7(t.localStore,e);fI(t,r,null),dI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ro(t,s)}catch(s){await wa(s)}}async function L8(n,e,t){const r=pe(n);try{const s=await(function(a,c){const h=pe(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return h.mutationQueue.lookupMutationBatch(p,c).next((y=>(Te(y!==null,37113),g=y.keys(),h.mutationQueue.removeMutationBatch(p,y)))).next((()=>h.mutationQueue.performConsistencyCheck(p))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(p,g,c))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>h.localDocuments.getDocuments(p,g)))}))})(r.localStore,e);fI(r,e,t),dI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ro(r,s)}catch(s){await wa(s)}}async function M8(n,e){const t=pe(n);Ta(t.remoteStore)||ne(xa,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(a){const c=pe(a);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(h=>c.mutationQueue.getHighestUnacknowledgedBatchId(h)))})(t.localStore);if(r===Zo)return void e.resolve();const s=t.mu.get(r)||[];s.push(e),t.mu.set(r,s)}catch(r){const s=Qu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function dI(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function fI(n,e,t){const r=pe(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Cu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||q2(n,r)}))}function q2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Au(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),pI(n))}function e0(n,e,t){for(const r of t)r instanceof B2?(n.Ru.addReference(r.key,e),V8(n,r)):r instanceof z2?(ne(xa,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||q2(n,r.key)):ge(19791,{wu:r})}function V8(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ne(xa,"New document in limbo: "+t),n.Eu.add(r),pI(n))}function pI(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new de(Qe.fromString(e)),r=n.fu.next();n.Au.set(r,new S8(t)),n.du=n.du.insert(t,r),I_(n.remoteStore,new Fi(Yn($u(t.path)),r,"TargetPurposeLimboResolution",cr.ce))}}async function ro(n,e,t){const r=pe(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,h)=>{a.push(r.pu(h,e,t).then((p=>{var g;if((p||t)&&r.isPrimaryClient){const y=p?!p.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,y?"current":"not-current")}if(p){s.push(p);const y=ZE.As(h.targetId,p);i.push(y)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(h,p){const g=pe(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>U.forEach(p,(E=>U.forEach(E.Es,(x=>g.persistence.referenceDelegate.addReference(y,E.targetId,x))).next((()=>U.forEach(E.ds,(x=>g.persistence.referenceDelegate.removeReference(y,E.targetId,x)))))))))}catch(y){if(!Ea(y))throw y;ne(eI,"Failed to update sequence numbers: "+y)}for(const y of p){const E=y.targetId;if(!y.fromCache){const x=g.Ms.get(E),P=x.snapshotVersion,O=x.withLastLimboFreeSnapshotVersion(P);g.Ms=g.Ms.insert(E,O)}}})(r.localStore,i))}async function j8(n,e){const t=pe(n);if(!t.currentUser.isEqual(e)){ne(xa,"User change. New user:",e.toKey());const r=await T2(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((h=>{h.reject(new ee(G.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ro(t,r.Ls)}}function F8(n,e){const t=pe(n),r=t.Au.get(e);if(r&&r.hu)return Be().add(r.key);{let s=Be();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}async function U8(n,e){const t=pe(n),r=await dg(t.localStore,e.query,!0),s=e.view.cu(r);return t.isPrimaryClient&&e0(t,e.targetId,s.au),s}async function B8(n,e){const t=pe(n);return A2(t.localStore,e).then((r=>ro(t,r)))}async function z8(n,e,t,r){const s=pe(n),i=await(function(c,h){const p=pe(c),g=pe(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(y=>g.er(y,h).next((E=>E?p.localDocuments.getDocuments(y,E):U.resolve(null)))))})(s.localStore,e);i!==null?(t==="pending"?await Gu(s.remoteStore):t==="acknowledged"||t==="rejected"?(fI(s,e,r||null),dI(s,e),(function(c,h){pe(pe(c).mutationQueue).ir(h)})(s.localStore,e)):ge(6720,"Unknown batchState",{Su:t}),await ro(s,i)):ne(xa,"Cannot apply mutation batch with id: "+e)}async function $8(n,e){const t=pe(n);if(T_(t),mI(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await i1(t,r.toArray());t.gu=!0,await Xw(t.remoteStore,!0);for(const i of s)I_(t.remoteStore,i)}else if(e===!1&&t.gu!==!1){const r=[];let s=Promise.resolve();t.Iu.forEach(((i,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):s=s.then((()=>(Cu(t,a),Su(t.localStore,a,!0)))),Au(t.remoteStore,a)})),await s,await i1(t,r),(function(a){const c=pe(a);c.Au.forEach(((h,p)=>{Au(c.remoteStore,p)})),c.Ru.Jr(),c.Au=new Map,c.du=new wt(de.comparator)})(t),t.gu=!1,await Xw(t.remoteStore,!1)}}async function i1(n,e,t){const r=pe(n),s=[],i=[];for(const a of e){let c;const h=r.Iu.get(a);if(h&&h.length!==0){c=await bu(r.localStore,Yn(h[0]));for(const p of h){const g=r.Tu.get(p),y=await U8(r,g);y.snapshot&&i.push(y.snapshot)}}else{const p=await S2(r.localStore,a);c=await bu(r.localStore,p),await hI(r,G2(p),a,!1,c.resumeToken)}s.push(c)}return r.Pu.H_(i),s}function G2(n){return CP(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function H8(n){return(function(t){return pe(pe(t).persistence).Ts()})(pe(n).localStore)}async function W8(n,e,t,r){const s=pe(n);if(s.gu)return void ne(xa,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const a=await A2(s.localStore,RP(i[0])),c=Vf.createSynthesizedRemoteEventForCurrentChange(e,t==="current",$t.EMPTY_BYTE_STRING);await ro(s,a,c);break}case"rejected":await Su(s.localStore,e,!0),Cu(s,e,r);break;default:ge(64155,t)}}async function q8(n,e,t){const r=T_(n);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ne(xa,"Adding an already active target "+s);continue}const i=await S2(r.localStore,s),a=await bu(r.localStore,i);await hI(r,G2(i),a.targetId,!1,a.resumeToken),I_(r.remoteStore,a)}for(const s of t)r.Iu.has(s)&&await Su(r.localStore,s,!1).then((()=>{Au(r.remoteStore,s),Cu(r,s)})).catch(wa)}}function T_(n){const e=pe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=W2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=F8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=D8.bind(null,e),e.Pu.H_=E8.bind(null,e.eventManager),e.Pu.yu=I8.bind(null,e.eventManager),e}function mI(n){const e=pe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=O8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L8.bind(null,e),e}function G8(n,e,t){const r=pe(n);(async function(i,a,c){try{const h=await a.getMetadata();if(await(function(x,P){const O=pe(x),M=Yt(P.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",(X=>O.Ii.getBundleMetadata(X,P.id))).then((X=>!!X&&X.createTime.compareTo(M)>=0))})(i.localStore,h))return await a.close(),c._completeWith((function(x){return{taskState:"Success",documentsLoaded:x.totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}})(h)),Promise.resolve(new Set);c._updateProgress(U2(h));const p=new x8(h,a.serializer);let g=await a.bu();for(;g;){const E=await p.Ga(g);E&&c._updateProgress(E),g=await a.bu()}const y=await p.ja(i.localStore);return await ro(i,y.Ha,void 0),await(function(x,P){const O=pe(x);return O.persistence.runTransaction("Save bundle","readwrite",(M=>O.Ii.saveBundleMetadata(M,P)))})(i.localStore,h),c._completeWith(y.progress),Promise.resolve(y.Ja)}catch(h){return ci(xa,`Loading bundle failed with ${h}`),c._failWith(h),Promise.resolve(new Set)}})(r,e,t).then((s=>{r.sharedClientState.notifyBundleLoaded(s)}))}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ff(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return I2(this.persistence,new E2,e.initialUser,this.serializer)}Cu(e){return new YE(E_.mi,this.serializer)}Du(e){return new P2}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class K8 extends of{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Te(this.persistence.referenceDelegate instanceof hg,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new m2(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new YE((r=>hg.mi(r,t)),this.serializer)}}class K2 extends of{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await mI(this.xu.syncEngine),await Gu(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return I2(this.persistence,new E2,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new m2(r,e.asyncQueue,t)}Mu(e,t){const r=new r9(t,this.persistence);return new n9(e.asyncQueue,r)}Cu(e){const t=XE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new JE(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,D2(),km(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new P2}}class Q8 extends K2{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Vv&&(this.sharedClientState.syncEngine={Co:z8.bind(null,t),vo:W8.bind(null,t),Fo:q8.bind(null,t),Ts:H8.bind(null,t),Do:B8.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await $8(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=D2();if(!Vv.v(t))throw new ee(G.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=XE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Vv(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class af{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>s1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=j8.bind(null,this.syncEngine),await Xw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new w8})()}createDatastore(e){const t=Ff(e.databaseInfo.databaseId),r=(function(i){return new n8(i)})(e.databaseInfo);return(function(i,a,c,h){return new o8(i,a,c,h)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new l8(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>s1(this.syncEngine,t,0)),(function(){return JA.v()?new JA:new X7})())}createSyncEngine(e,t){return(function(s,i,a,c,h,p,g){const y=new A8(s,i,a,c,h,p);return g&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const i=pe(s);ne(Ll,"RemoteStore shutting down."),i.Ea.add(5),await qu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}af.provider={build:()=>new af};function o1(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new kn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(r);return new T8(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ee(G.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,i){const a=pe(s),c={documents:i.map((y=>rf(a.serializer,y)))},h=await a.Ho("BatchGetDocuments",a.serializer.databaseId,Qe.emptyPath(),c,i.length),p=new Map;h.forEach((y=>{const E=c7(a.serializer,y);p.set(E.key.toString(),E)}));const g=[];return i.forEach((y=>{const E=p.get(y.toString());Te(!!E,55234,{key:y}),g.push(E)})),g})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Wu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const s=de.fromPath(r);this.mutations.push(new UE(s,this.precondition(s)))})),await(async function(r,s){const i=pe(r),a={writes:s.map((c=>sf(i.serializer,c)))};await i.Go("Commit",i.serializer.databaseId,Qe.emptyPath(),a)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ge(50498,{Gu:e.constructor.name});t=ke.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ee(G.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ke.min())?Dt.exists(!1):Dt.updateTime(t):Dt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ke.min()))throw new ee(G.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Dt.updateTime(t)}return Dt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new nI(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new J8(this.datastore),t=this.Hu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((s=>{this.Yu(s)}))))})).catch((r=>{this.Yu(r)}))}))}Hu(e){try{const t=this.updateFunction(e);return!Rf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!HP(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa="FirestoreClient";class Z8{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=yn.UNAUTHENTICATED,this.clientId=SE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{ne(pa,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(ne(pa,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Qu(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Fv(n,e){n.asyncQueue.verifyOperationInProgress(),ne(pa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await T2(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function a1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await gI(n);ne(pa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>ZA(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>ZA(e.remoteStore,s))),n._onlineComponents=e}async function gI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ne(pa,"Using user provided OfflineComponentProvider");try{await Fv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;ci("Error using user provided cache. Falling back to memory cache: "+t),await Fv(n,new of)}}else ne(pa,"Using default OfflineComponentProvider"),await Fv(n,new K8(void 0));return n._offlineComponents}async function b_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ne(pa,"Using user provided OnlineComponentProvider"),await a1(n,n._uninitializedComponentsProvider._online)):(ne(pa,"Using default OnlineComponentProvider"),await a1(n,new af))),n._onlineComponents}function Q2(n){return gI(n).then((e=>e.persistence))}function _I(n){return gI(n).then((e=>e.localStore))}function Y2(n){return b_(n).then((e=>e.remoteStore))}function yI(n){return b_(n).then((e=>e.syncEngine))}function ez(n){return b_(n).then((e=>e.datastore))}async function ku(n){const e=await b_(n),t=e.eventManager;return t.onListen=N8.bind(null,e.syncEngine),t.onUnlisten=k8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=C8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=R8.bind(null,e.syncEngine),t}function tz(n){return n.asyncQueue.enqueue((async()=>{const e=await Q2(n),t=await Y2(n);return e.setNetworkEnabled(!0),(function(s){const i=pe(s);return i.Ea.delete(0),Uf(i)})(t)}))}function nz(n){return n.asyncQueue.enqueue((async()=>{const e=await Q2(n),t=await Y2(n);return e.setNetworkEnabled(!1),(async function(s){const i=pe(s);i.Ea.add(0),await qu(i),i.Ra.set("Offline")})(t)}))}function rz(n,e){const t=new kn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,i,a){try{const c=await(function(p,g){const y=pe(p);return y.persistence.runTransaction("read document","readonly",(E=>y.localDocuments.getDocument(E,g)))})(s,i);c.isFoundDocument()?a.resolve(c):c.isNoDocument()?a.resolve(null):a.reject(new ee(G.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){const h=Qu(c,`Failed to get document '${i} from cache`);a.reject(h)}})(await _I(n),e,t))),t.promise}function J2(n,e,t={}){const r=new kn;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,c,h,p){const g=new x_({next:E=>{g.Nu(),a.enqueueAndForget((()=>lI(i,y)));const x=E.docs.has(c);!x&&E.fromCache?p.reject(new ee(G.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&E.fromCache&&h&&h.source==="server"?p.reject(new ee(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),y=new uI($u(c.path),g,{includeMetadataChanges:!0,qa:!0});return aI(i,y)})(await ku(n),n.asyncQueue,e,t,r))),r.promise}function sz(n,e){const t=new kn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,i,a){try{const c=await dg(s,i,!0),h=new $2(i,c.Qs),p=h.ru(c.documents),g=h.applyChanges(p,!1);a.resolve(g.snapshot)}catch(c){const h=Qu(c,`Failed to execute query '${i} against cache`);a.reject(h)}})(await _I(n),e,t))),t.promise}function X2(n,e,t={}){const r=new kn;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,c,h,p){const g=new x_({next:E=>{g.Nu(),a.enqueueAndForget((()=>lI(i,y))),E.fromCache&&h.source==="server"?p.reject(new ee(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(E)},error:E=>p.reject(E)}),y=new uI(c,g,{includeMetadataChanges:!0,qa:!0});return aI(i,y)})(await ku(n),n.asyncQueue,e,t,r))),r.promise}function iz(n,e){const t=new x_(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,i){pe(s).Ca.add(i),i.next()})(await ku(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,i){pe(s).Ca.delete(i)})(await ku(n),t)))}}function oz(n,e,t,r){const s=(function(a,c){let h;return h=typeof a=="string"?qP().encode(a):a,(function(g,y){return new Y8(g,y)})((function(g,y){if(g instanceof Uint8Array)return o1(g,y);if(g instanceof ArrayBuffer)return o1(new Uint8Array(g),y);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(h),c)})(t,Ff(e));n.asyncQueue.enqueueAndForget((async()=>{G8(await yI(n),s,r)}))}function az(n,e){return n.asyncQueue.enqueue((async()=>(function(r,s){const i=pe(r);return i.persistence.runTransaction("Get named query","readonly",(a=>i.Ii.getNamedQuery(a,s)))})(await _I(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="firestore.googleapis.com",c1=!0;class u1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ee(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eD,this.ssl=c1}else this.host=e.host,this.ssl=e.ssl??c1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=h2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<N7)throw new ee(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Z2(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bf{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new u1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ee(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ee(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new u1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new HB;switch(r.type){case"firstParty":return new KB(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ee(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=l1.get(t);r&&(ne("ComponentProvider","Removing Datastore"),l1.delete(t),r.terminate())})(this),Promise.resolve()}}function lz(n,e,t,r={}){var p;n=rt(n,Bf);const s=_a(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(m0(`https://${c}`),g0("Firestore",!0)),i.host!==eD&&i.host!==c&&ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...i,host:c,ssl:s,emulatorOptions:r};if(!Hi(h,a)&&(n._setSettings(h),r.mockUserToken)){let g,y;if(typeof r.mockUserToken=="string")g=r.mockUserToken,y=yn.MOCK_USER;else{g=eC(r.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new ee(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new yn(E)}n._authCredentials=new WB(new WR(g,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xn=class tD{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new tD(this.firestore,e,this._query)}},vt=class ld{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ea(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ld(this.firestore,e,this._key)}toJSON(){return{type:ld._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(kf(t,ld._jsonSchema))return new ld(e,r||null,new de(Qe.fromString(t.referencePath)))}};vt._jsonSchemaVersion="firestore/documentReference/1.0",vt._jsonSchema={type:nn("string",vt._jsonSchemaVersion),referencePath:nn("string")};let ea=class nD extends Xn{constructor(e,t,r){super(e,t,$u(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vt(this.firestore,null,new de(e))}withConverter(e){return new nD(this.firestore,e,this._path)}};function rD(n,e,...t){if(n=ye(n),AE("collection","path",e),n instanceof Bf){const r=Qe.fromString(e,...t);return XS(r),new ea(n,null,r)}{if(!(n instanceof vt||n instanceof ea))throw new ee(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Qe.fromString(e,...t));return XS(r),new ea(n.firestore,null,r)}}function cz(n,e){if(n=rt(n,Bf),AE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ee(G.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xn(n,null,(function(r){return new eo(Qe.emptyPath(),r)})(e))}function gg(n,e,...t){if(n=ye(n),arguments.length===1&&(e=SE.newId()),AE("doc","path",e),n instanceof Bf){const r=Qe.fromString(e,...t);return JS(r),new vt(n,null,new de(r))}{if(!(n instanceof vt||n instanceof ea))throw new ee(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Qe.fromString(e,...t));return JS(r),new vt(n.firestore,n instanceof ea?n.converter:null,new de(r))}}function sD(n,e){return n=ye(n),e=ye(e),(n instanceof vt||n instanceof ea)&&(e instanceof vt||e instanceof ea)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function iD(n,e){return n=ye(n),e=ye(e),n instanceof Xn&&e instanceof Xn&&n.firestore===e.firestore&&Of(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="AsyncQueue";class d1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new nI(this,"async_queue_retry"),this._c=()=>{const r=km();r&&ne(h1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=km();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=km();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new kn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ea(e))throw e;ne(h1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Kt("INTERNAL UNHANDLED ERROR: ",f1(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=oI.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&ge(47125,{Pc:f1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function f1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class uz{constructor(){this._progressObserver={},this._taskCompletionResolver=new kn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=-1;let Jt=class extends Bf{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new d1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d1(e),this._firestoreClient=void 0,await e}}};function $n(n){if(n._terminated)throw new ee(G.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||oD(n),n._firestoreClient}function oD(n){var r,s,i;const e=n._freezeSettings(),t=(function(c,h,p,g){return new P9(c,h,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Z2(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Z8(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(c){const h=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(h),_online:h}})(n._componentsProvider))}function dz(n,e){ci("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return aD(n,af.provider,{build:r=>new K2(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function fz(n){ci("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();aD(n,af.provider,{build:t=>new Q8(t,e.cacheSizeBytes)})}function aD(n,e,t){if((n=rt(n,Jt))._firestoreClient||n._terminated)throw new ee(G.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ee(G.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},oD(n)}function pz(n){if(n._initialized&&!n._terminated)throw new ee(G.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new kn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!ti.v())return Promise.resolve();const s=r+w2;await ti.delete(s)})(XE(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function mz(n){return(function(t){const r=new kn;return t.asyncQueue.enqueueAndForget((async()=>M8(await yI(t),r))),r.promise})($n(n=rt(n,Jt)))}function gz(n){return tz($n(n=rt(n,Jt)))}function _z(n){return nz($n(n=rt(n,Jt)))}function yz(n,e){const t=$n(n=rt(n,Jt)),r=new uz;return oz(t,n._databaseId,e,r),r}function vz(n,e){return az($n(n=rt(n,Jt)),e).then((t=>t?new Xn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fn($t.fromBase64String(e))}catch(t){throw new ee(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fn($t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kf(e,Fn._jsonSchema))return Fn.fromBase64String(e.bytes)}}Fn._jsonSchemaVersion="firestore/bytes/1.0",Fn._jsonSchema={type:nn("string",Fn._jsonSchemaVersion),bytes:nn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ma=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ee(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kl=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ee(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ee(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ys._jsonSchemaVersion}}static fromJSON(e){if(kf(e,ys._jsonSchema))return new ys(e.latitude,e.longitude)}}ys._jsonSchemaVersion="firestore/geoPoint/1.0",ys._jsonSchema={type:nn("string",ys._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ri._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kf(e,ri._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ri(e.vectorValues);throw new ee(G.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ri._jsonSchemaVersion="firestore/vectorValue/1.0",ri._jsonSchema={type:nn("string",ri._jsonSchemaVersion),vectorValues:nn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz=/^__.*__$/;class Ez{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new no(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hu(e,this.data,t,this.fieldTransforms)}}class lD{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new no(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function cD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge(40011,{Ac:n})}}class S_{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new S_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return _g(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(cD(this.Ac)&&wz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Iz{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ff(e)}Cc(e,t,r,s=!1){return new S_({Ac:e,methodName:t,Dc:r,path:Pt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ql(n){const e=n._freezeSettings(),t=Ff(n._databaseId);return new Iz(n._databaseId,!!e.ignoreUndefinedProperties,t)}function A_(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);bI("Data must be an object, but it was:",a,r);const c=dD(r,a);let h,p;if(i.merge)h=new ur(a.fieldMask),p=a.fieldTransforms;else if(i.mergeFields){const g=[];for(const y of i.mergeFields){const E=n0(e,y,t);if(!a.contains(E))throw new ee(G.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);pD(g,E)||g.push(E)}h=new ur(g),p=a.fieldTransforms.filter((y=>h.covers(y.field)))}else h=null,p=a.fieldTransforms;return new Ez(new Nn(c),h,p)}class zf extends Kl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zf}}function uD(n,e,t){return new S_({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class vI extends Kl{_toFieldTransform(e){return new Mf(e.path,new Iu)}isEqual(e){return e instanceof vI}}class wI extends Kl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=uD(this,e,!0),r=this.vc.map((i=>Yl(i,t))),s=new kl(r);return new Mf(e.path,s)}isEqual(e){return e instanceof wI&&Hi(this.vc,e.vc)}}class EI extends Kl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=uD(this,e,!0),r=this.vc.map((i=>Yl(i,t))),s=new Rl(r);return new Mf(e.path,s)}isEqual(e){return e instanceof EI&&Hi(this.vc,e.vc)}}class II extends Kl{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Tu(e.serializer,VP(e.serializer,this.Fc));return new Mf(e.path,t)}isEqual(e){return e instanceof II&&this.Fc===e.Fc}}function TI(n,e,t,r){const s=n.Cc(1,e,t);bI("Data must be an object, but it was:",s,r);const i=[],a=Nn.empty();Ia(r,((h,p)=>{const g=SI(e,h,t);p=ye(p);const y=s.yc(g);if(p instanceof zf)i.push(g);else{const E=Yl(p,y);E!=null&&(i.push(g),a.set(g,E))}}));const c=new ur(i);return new lD(a,c,s.fieldTransforms)}function xI(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[n0(e,r,t)],h=[s];if(i.length%2!=0)throw new ee(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<i.length;E+=2)c.push(n0(e,i[E])),h.push(i[E+1]);const p=[],g=Nn.empty();for(let E=c.length-1;E>=0;--E)if(!pD(p,c[E])){const x=c[E];let P=h[E];P=ye(P);const O=a.yc(x);if(P instanceof zf)p.push(x);else{const M=Yl(P,O);M!=null&&(p.push(x),g.set(x,M))}}const y=new ur(p);return new lD(g,y,a.fieldTransforms)}function hD(n,e,t,r=!1){return Yl(t,n.Cc(r?4:3,e))}function Yl(n,e){if(fD(n=ye(n)))return bI("Unsupported field value:",e,n),dD(n,e);if(n instanceof Kl)return(function(r,s){if(!cD(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let h=Yl(c,s.wc(a));h==null&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=at.fromDate(r);return{timestampValue:xu(s.serializer,i)}}if(r instanceof at){const i=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xu(s.serializer,i)}}if(r instanceof ys)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fn)return{bytesValue:QP(s.serializer,r._byteString)};if(r instanceof vt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:WE(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ri)return(function(a,c){return{mapValue:{fields:{[OE]:{stringValue:LE},[vu]:{arrayValue:{values:a.toArray().map((p=>{if(typeof p!="number")throw c.Sc("VectorValues must only contain numeric values.");return FE(c.serializer,p)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${c_(r)}`)})(n,e)}function dD(n,e){const t={};return dP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ia(n,((r,s)=>{const i=Yl(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function fD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof at||n instanceof ys||n instanceof Fn||n instanceof vt||n instanceof Kl||n instanceof ri)}function bI(n,e,t){if(!fD(t)||!KR(t)){const r=c_(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function n0(n,e,t){if((e=ye(e))instanceof ma)return e._internalPath;if(typeof e=="string")return SI(n,e);throw _g("Field path arguments must be of type string or ",n,!1,void 0,t)}const Tz=new RegExp("[~\\*/\\[\\]]");function SI(n,e,t){if(e.search(Tz)>=0)throw _g(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ma(...e.split("."))._internalPath}catch{throw _g(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _g(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(i||a)&&(h+=" (found",i&&(h+=` in field ${r}`),a&&(h+=` in document ${s}`),h+=")"),new ee(G.INVALID_ARGUMENT,c+n+h)}function pD(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(N_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class xz extends lf{data(){return super.data()}}function N_(n,e){return typeof e=="string"?SI(n,e):e instanceof ma?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ee(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AI{}class $f extends AI{}function Fo(n,e,...t){let r=[];e instanceof AI&&r.push(e),r=r.concat(t),(function(i){const a=i.filter((h=>h instanceof NI)).length,c=i.filter((h=>h instanceof C_)).length;if(a>1||a>0&&c>0)throw new ee(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class C_ extends $f{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new C_(e,t,r)}_apply(e){const t=this._parse(e);return _D(e._query,t),new Xn(e.firestore,e.converter,zw(e._query,t))}_parse(e){const t=Ql(e.firestore);return(function(i,a,c,h,p,g,y){let E;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ee(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){m1(y,g);const P=[];for(const O of y)P.push(p1(h,i,O));E={arrayValue:{values:P}}}else E=p1(h,i,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||m1(y,g),E=hD(c,a,y,g==="in"||g==="not-in");return Ye.create(p,g,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bz(n,e,t){const r=e,s=N_("where",n);return C_._create(s,r,t)}class NI extends AI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new NI(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,i){let a=s;const c=i.getFlattenedFilters();for(const h of c)_D(a,h),a=zw(a,h)})(e._query,t),new Xn(e.firestore,e.converter,zw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class CI extends $f{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new CI(e,t)}_apply(e){const t=(function(s,i,a){if(s.startAt!==null)throw new ee(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ee(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nf(i,a)})(e._query,this._field,this._direction);return new Xn(e.firestore,e.converter,(function(s,i){const a=s.explicitOrderBy.concat([i]);return new eo(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Sz(n,e="asc"){const t=e,r=N_("orderBy",n);return CI._create(r,t)}class k_ extends $f{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new k_(e,t,r)}_apply(e){return new Xn(e.firestore,e.converter,ag(e._query,this._limit,this._limitType))}}function Az(n){return QR("limit",n),k_._create("limit",n,"F")}function Nz(n){return QR("limitToLast",n),k_._create("limitToLast",n,"L")}class R_ extends $f{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new R_(e,t,r)}_apply(e){const t=gD(e,this.type,this._docOrFields,this._inclusive);return new Xn(e.firestore,e.converter,(function(s,i){return new eo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)})(e._query,t))}}function Cz(...n){return R_._create("startAt",n,!0)}function kz(...n){return R_._create("startAfter",n,!1)}class P_ extends $f{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new P_(e,t,r)}_apply(e){const t=gD(e,this.type,this._docOrFields,this._inclusive);return new Xn(e.firestore,e.converter,(function(s,i){return new eo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)})(e._query,t))}}function Rz(...n){return P_._create("endBefore",n,!1)}function Pz(...n){return P_._create("endAt",n,!0)}function gD(n,e,t,r){if(t[0]=ye(t[0]),t[0]instanceof lf)return(function(i,a,c,h,p){if(!h)throw new ee(G.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const g=[];for(const y of nu(i))if(y.field.isKeyField())g.push(Nl(a,h.key));else{const E=h.data.field(y.field);if(p_(E))throw new ee(G.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const x=y.field.canonicalString();throw new ee(G.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}g.push(E)}return new da(g,p)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Ql(n.firestore);return(function(a,c,h,p,g,y){const E=a.explicitOrderBy;if(g.length>E.length)throw new ee(G.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let P=0;P<g.length;P++){const O=g[P];if(E[P].field.isKeyField()){if(typeof O!="string")throw new ee(G.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof O}`);if(!VE(a)&&O.indexOf("/")!==-1)throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${O}' contains a slash.`);const M=a.path.child(Qe.fromString(O));if(!de.isDocumentKey(M))throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${M}' is not because it contains an odd number of segments.`);const X=new de(M);x.push(Nl(c,X))}else{const M=hD(h,p,O);x.push(M)}}return new da(x,y)})(n._query,n.firestore._databaseId,s,e,t,r)}}function p1(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new ee(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!VE(e)&&t.indexOf("/")!==-1)throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Qe.fromString(t));if(!de.isDocumentKey(r))throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Nl(n,new de(r))}if(t instanceof vt)return Nl(n,t._key);throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${c_(t)}.`)}function m1(n,e){if(!Array.isArray(n)||n.length===0)throw new ee(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _D(n,e){const t=(function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ee(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ee(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class kI{convertValue(e,t="none"){switch(ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ia(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){var r,s,i;const t=(i=(s=(r=e.fields)==null?void 0:r[vu].arrayValue)==null?void 0:s.values)==null?void 0:i.map((a=>kt(a.doubleValue)));return new ri(t)}convertGeoPoint(e){return new ys(kt(e.latitude),kt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=m_(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Zd(e));default:return null}}convertTimestamp(e){const t=Ki(e);return new at(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Qe.fromString(e);Te(o2(r),9688,{name:e});const s=new ca(r.get(1),r.get(3)),i=new de(r.popFirst(5));return s.isEqual(t)||Kt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Dz extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}class fl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Xr=class yD extends lf{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ad(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(N_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(G.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=yD._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Xr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xr._jsonSchema={type:nn("string",Xr._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};let Ad=class extends Xr{data(e={}){return super.data(e)}},vs=class vD{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new fl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Ad(this._firestore,this._userDataWriter,r.key,r,new fl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ee(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const h=new Ad(s._firestore,s._userDataWriter,c.doc.key,c.doc,new fl(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const h=new Ad(s._firestore,s._userDataWriter,c.doc.key,c.doc,new fl(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return c.type!==0&&(p=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),g=a.indexOf(c.doc.key)),{type:Oz(c.type),doc:h,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(G.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vD._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=SE.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function Oz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge(61501,{type:n})}}function wD(n,e){return n instanceof Xr&&e instanceof Xr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof vs&&e instanceof vs&&n._firestore===e._firestore&&iD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lz(n){n=rt(n,vt);const e=rt(n.firestore,Jt);return J2($n(e),n._key).then((t=>RI(e,n,t)))}vs._jsonSchemaVersion="firestore/querySnapshot/1.0",vs._jsonSchema={type:nn("string",vs._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};class Jl extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}function Mz(n){n=rt(n,vt);const e=rt(n.firestore,Jt),t=$n(e),r=new Jl(e);return rz(t,n._key).then((s=>new Xr(e,r,n._key,s,new fl(s!==null&&s.hasLocalMutations,!0),n.converter)))}function Vz(n){n=rt(n,vt);const e=rt(n.firestore,Jt);return J2($n(e),n._key,{source:"server"}).then((t=>RI(e,n,t)))}function jz(n){n=rt(n,Xn);const e=rt(n.firestore,Jt),t=$n(e),r=new Jl(e);return mD(n._query),X2(t,n._query).then((s=>new vs(e,r,n,s)))}function Fz(n){n=rt(n,Xn);const e=rt(n.firestore,Jt),t=$n(e),r=new Jl(e);return sz(t,n._query).then((s=>new vs(e,r,n,s)))}function Uz(n){n=rt(n,Xn);const e=rt(n.firestore,Jt),t=$n(e),r=new Jl(e);return X2(t,n._query,{source:"server"}).then((s=>new vs(e,r,n,s)))}function g1(n,e,t){n=rt(n,vt);const r=rt(n.firestore,Jt),s=D_(n.converter,e,t);return Hf(r,[A_(Ql(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Dt.none())])}function _1(n,e,t,...r){n=rt(n,vt);const s=rt(n.firestore,Jt),i=Ql(s);let a;return a=typeof(e=ye(e))=="string"||e instanceof ma?xI(i,"updateDoc",n._key,e,t,r):TI(i,"updateDoc",n._key,e),Hf(s,[a.toMutation(n._key,Dt.exists(!0))])}function Bz(n){return Hf(rt(n.firestore,Jt),[new Wu(n._key,Dt.none())])}function zz(n,e){const t=rt(n.firestore,Jt),r=gg(n),s=D_(n.converter,e);return Hf(t,[A_(Ql(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Dt.exists(!1))]).then((()=>r))}function ED(n,...e){var h,p,g;n=ye(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||t0(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(t0(e[r])){const y=e[r];e[r]=(h=y.next)==null?void 0:h.bind(y),e[r+1]=(p=y.error)==null?void 0:p.bind(y),e[r+2]=(g=y.complete)==null?void 0:g.bind(y)}let i,a,c;if(n instanceof vt)a=rt(n.firestore,Jt),c=$u(n._key.path),i={next:y=>{e[r]&&e[r](RI(a,n,y))},error:e[r+1],complete:e[r+2]};else{const y=rt(n,Xn);a=rt(y.firestore,Jt),c=y._query;const E=new Jl(a);i={next:x=>{e[r]&&e[r](new vs(a,E,y,x))},error:e[r+1],complete:e[r+2]},mD(n._query)}return(function(E,x,P,O){const M=new x_(O),X=new uI(x,M,P);return E.asyncQueue.enqueueAndForget((async()=>aI(await ku(E),X))),()=>{M.Nu(),E.asyncQueue.enqueueAndForget((async()=>lI(await ku(E),X)))}})($n(a),c,s,i)}function $z(n,e){return iz($n(n=rt(n,Jt)),t0(e)?e:{next:e})}function Hf(n,e){return(function(r,s){const i=new kn;return r.asyncQueue.enqueueAndForget((async()=>P8(await yI(r),s,i))),i.promise})($n(n),e)}function RI(n,e,t){const r=t.docs.get(e._key),s=new Jl(n);return new Xr(n,s,e._key,r,new fl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hz={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wz=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ql(e)}set(e,t,r){this._verifyNotCommitted();const s=qo(e,this._firestore),i=D_(s.converter,t,r),a=A_(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,Dt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=qo(e,this._firestore);let a;return a=typeof(t=ye(t))=="string"||t instanceof ma?xI(this._dataReader,"WriteBatch.update",i._key,t,r,s):TI(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(a.toMutation(i._key,Dt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qo(e,this._firestore);return this._mutations=this._mutations.concat(new Wu(t._key,Dt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ee(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function qo(n,e){if((n=ye(n)).firestore!==e)throw new ee(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ql(e)}get(e){const t=qo(e,this._firestore),r=new Dz(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return ge(24041);const i=s[0];if(i.isFoundDocument())return new lf(this._firestore,r,i.key,i,t.converter);if(i.isNoDocument())return new lf(this._firestore,r,t._key,null,t.converter);throw ge(18433,{doc:i})}))}set(e,t,r){const s=qo(e,this._firestore),i=D_(s.converter,t,r),a=A_(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,a),this}update(e,t,r,...s){const i=qo(e,this._firestore);let a;return a=typeof(t=ye(t))=="string"||t instanceof ma?xI(this._dataReader,"Transaction.update",i._key,t,r,s):TI(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,a),this}delete(e){const t=qo(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gz=class extends qz{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qo(e,this._firestore),r=new Jl(this._firestore);return super.get(e).then((s=>new Xr(this._firestore,r,t._key,s._document,new fl(!1,!1),t.converter)))}};function Kz(n,e,t){n=rt(n,Jt);const r={...Hz,...t};return(function(i){if(i.maxAttempts<1)throw new ee(G.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(i,a,c){const h=new kn;return i.asyncQueue.enqueueAndForget((async()=>{const p=await ez(i);new X8(i.asyncQueue,p,c,a,h).ju()})),h.promise})($n(n),(s=>e(new Gz(n,s))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(){return new zf("deleteField")}function Yz(){return new vI("serverTimestamp")}function Jz(...n){return new wI("arrayUnion",n)}function Xz(...n){return new EI("arrayRemove",n)}function Zz(n){return new II("increment",n)}(function(e,t=!0){(function(s){zu=s})(Ji),fr(new rn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Jt(new qB(r.getProvider("auth-internal")),new QB(a,r.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ee(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ca(p.options.projectId,g)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),Cn(GS,KS,e),Cn(GS,KS,"esm2020")})();const e$="@firebase/firestore-compat",t$="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ee("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(){if(typeof Uint8Array>"u")throw new ee("unimplemented","Uint8Arrays are not available in this environment.")}function v1(){if(!k9())throw new ee("unimplemented","Blobs are unavailable in Firestore in this environment.")}class cf{constructor(e){this._delegate=e}static fromBase64String(e){return v1(),new cf(Fn.fromBase64String(e))}static fromUint8Array(e){return y1(),new cf(Fn.fromUint8Array(e))}toBase64(){return v1(),this._delegate.toBase64()}toUint8Array(){return y1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n){return n$(n,["next","error","complete"])}function n$(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r${enableIndexedDbPersistence(e,t){return dz(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return fz(e._delegate)}clearIndexedDbPersistence(e){return pz(e._delegate)}}class ID{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ca||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ci("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){lz(this._delegate,e,t,r)}enableNetwork(){return gz(this._delegate)}disableNetwork(){return _z(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,GR("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return mz(this._delegate)}onSnapshotsInSync(e){return $z(this._delegate,e)}get app(){if(!this._appCompat)throw new ee("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ru(this,rD(this._delegate,e))}catch(t){throw Kn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Jr(this,gg(this._delegate,e))}catch(t){throw Kn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Gn(this,cz(this._delegate,e))}catch(t){throw Kn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Kz(this._delegate,t=>e(new TD(this,t)))}batch(){return $n(this._delegate),new xD(new Wz(this._delegate,e=>Hf(this._delegate,e)))}loadBundle(e){return yz(this._delegate,e)}namedQuery(e){return vz(this._delegate,e).then(t=>t?new Gn(this,t):null)}}class O_ extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new cf(new Fn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Jr.forKey(t,this.firestore,null)}}function s$(n){zB(n)}class TD{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new O_(e)}get(e){const t=pl(e);return this._delegate.get(t).then(r=>new uf(this._firestore,new Xr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=pl(e);return r?(PI("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=pl(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=pl(e);return this._delegate.delete(t),this}}class xD{constructor(e){this._delegate=e}set(e,t,r){const s=pl(e);return r?(PI("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=pl(e);return arguments.length===2?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=pl(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ml{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Ad(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new hf(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Ml.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(t);return i||(i=new Ml(e,new O_(e),t),s.set(t,i)),i}}Ml.INSTANCES=new WeakMap;class Jr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new O_(e)}static forPath(e,t,r){if(e.length%2!==0)throw new ee("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Jr(t,new vt(t._delegate,r,new de(e)))}static forKey(e,t,r){return new Jr(t,new vt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ru(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ru(this.firestore,rD(this._delegate,e))}catch(t){throw Kn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ye(e),e instanceof vt?sD(this._delegate,e):!1}set(e,t){t=PI("DocumentReference.set",t);try{return t?g1(this._delegate,e,t):g1(this._delegate,e)}catch(r){throw Kn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?_1(this._delegate,e):_1(this._delegate,e,t,...r)}catch(s){throw Kn(s,"updateDoc()","DocumentReference.update()")}}delete(){return Bz(this._delegate)}onSnapshot(...e){const t=bD(e),r=SD(e,s=>new uf(this.firestore,new Xr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return ED(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Mz(this._delegate):(e==null?void 0:e.source)==="server"?t=Vz(this._delegate):t=Lz(this._delegate),t.then(r=>new uf(this.firestore,new Xr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Jr(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Kn(n,e,t){return n.message=n.message.replace(e,t),n}function bD(n){for(const e of n)if(typeof e=="object"&&!r0(e))return e;return{}}function SD(n,e){var r,s;let t;return r0(n[0])?t=n[0]:r0(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:i=>{t.next&&t.next(e(i))},error:(r=t.error)==null?void 0:r.bind(t),complete:(s=t.complete)==null?void 0:s.bind(t)}}class uf{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Jr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return wD(this._delegate,e._delegate)}}class hf extends uf{data(e){const t=this._delegate.data(e);return this._delegate._converter||$B(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Gn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new O_(e)}where(e,t,r){try{return new Gn(this.firestore,Fo(this._delegate,bz(e,t,r)))}catch(s){throw Kn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Gn(this.firestore,Fo(this._delegate,Sz(e,t)))}catch(r){throw Kn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Gn(this.firestore,Fo(this._delegate,Az(e)))}catch(t){throw Kn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Gn(this.firestore,Fo(this._delegate,Nz(e)))}catch(t){throw Kn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Gn(this.firestore,Fo(this._delegate,Cz(...e)))}catch(t){throw Kn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Gn(this.firestore,Fo(this._delegate,kz(...e)))}catch(t){throw Kn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Gn(this.firestore,Fo(this._delegate,Rz(...e)))}catch(t){throw Kn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Gn(this.firestore,Fo(this._delegate,Pz(...e)))}catch(t){throw Kn(t,"endAt()","Query.endAt()")}}isEqual(e){return iD(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Fz(this._delegate):(e==null?void 0:e.source)==="server"?t=Uz(this._delegate):t=jz(this._delegate),t.then(r=>new s0(this.firestore,new vs(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=bD(e),r=SD(e,s=>new s0(this.firestore,new vs(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return ED(this._delegate,t,r)}withConverter(e){return new Gn(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class i${constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new hf(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class s0{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Gn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new hf(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new i$(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new hf(this._firestore,r))})}isEqual(e){return wD(this._delegate,e._delegate)}}class Ru extends Gn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Jr(this.firestore,e):null}doc(e){try{return e===void 0?new Jr(this.firestore,gg(this._delegate)):new Jr(this.firestore,gg(this._delegate,e))}catch(t){throw Kn(t,"doc()","CollectionReference.doc()")}}add(e){return zz(this._delegate,e).then(t=>new Jr(this.firestore,t))}isEqual(e){return sD(this._delegate,e._delegate)}withConverter(e){return new Ru(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function pl(n){return rt(n,vt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(...e){this._delegate=new ma(...e)}static documentId(){return new DI(Pt.keyField().canonicalString())}isEqual(e){return e=ye(e),e instanceof ma?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{static serverTimestamp(){const e=Yz();return e._methodName="FieldValue.serverTimestamp",new ll(e)}static delete(){const e=Qz();return e._methodName="FieldValue.delete",new ll(e)}static arrayUnion(...e){const t=Jz(...e);return t._methodName="FieldValue.arrayUnion",new ll(t)}static arrayRemove(...e){const t=Xz(...e);return t._methodName="FieldValue.arrayRemove",new ll(t)}static increment(e){const t=Zz(e);return t._methodName="FieldValue.increment",new ll(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o$={Firestore:ID,GeoPoint:ys,Timestamp:at,Blob:cf,Transaction:TD,WriteBatch:xD,DocumentReference:Jr,DocumentSnapshot:uf,Query:Gn,QueryDocumentSnapshot:hf,QuerySnapshot:s0,CollectionReference:Ru,FieldPath:DI,FieldValue:ll,setLogLevel:s$,CACHE_SIZE_UNLIMITED:hz};function a$(n,e){n.INTERNAL.registerComponent(new rn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps({...o$}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l$(n){a$(n,(e,t)=>new ID(e,t,new r$)),n.registerVersion(e$,t$)}l$(Qt);const AD="@firebase/installations",OI="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=1e4,CD=`w:${OI}`,kD="FIS_v2",c$="https://firebaseinstallations.googleapis.com/v1",u$=3600*1e3,h$="installations",d$="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f$={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Vl=new hi(h$,d$,f$);function RD(n){return n instanceof Un&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD({projectId:n}){return`${c$}/projects/${n}/installations`}function DD(n){return{token:n.token,requestStatus:2,expiresIn:m$(n.expiresIn),creationTime:Date.now()}}async function OD(n,e){const r=(await e.json()).error;return Vl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function LD({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function p$(n,{refreshToken:e}){const t=LD(n);return t.append("Authorization",g$(e)),t}async function MD(n){const e=await n();return e.status>=500&&e.status<600?n():e}function m$(n){return Number(n.replace("s","000"))}function g$(n){return`${kD} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _$({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=PD(n),s=LD(n),i=e.getImmediate({optional:!0});if(i){const p=await i.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const a={fid:t,authVersion:kD,appId:n.appId,sdkVersion:CD},c={method:"POST",headers:s,body:JSON.stringify(a)},h=await MD(()=>fetch(r,c));if(h.ok){const p=await h.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:DD(p.authToken)}}else throw await OD("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y$(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v$=/^[cdef][\w-]{21}$/,i0="";function w$(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=E$(n);return v$.test(t)?t:i0}catch{return i0}}function E$(n){return y$(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=new Map;function FD(n,e){const t=L_(n);UD(t,e),I$(t,e)}function UD(n,e){const t=jD.get(n);if(t)for(const r of t)r(e)}function I$(n,e){const t=T$();t&&t.postMessage({key:n,fid:e}),x$()}let ml=null;function T$(){return!ml&&"BroadcastChannel"in self&&(ml=new BroadcastChannel("[Firebase] FID Change"),ml.onmessage=n=>{UD(n.data.key,n.data.fid)}),ml}function x$(){jD.size===0&&ml&&(ml.close(),ml=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b$="firebase-installations-database",S$=1,jl="firebase-installations-store";let Uv=null;function LI(){return Uv||(Uv=Ou(b$,S$,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(jl)}}})),Uv}async function yg(n,e){const t=L_(n),s=(await LI()).transaction(jl,"readwrite"),i=s.objectStore(jl),a=await i.get(t);return await i.put(e,t),await s.done,(!a||a.fid!==e.fid)&&FD(n,e.fid),e}async function BD(n){const e=L_(n),r=(await LI()).transaction(jl,"readwrite");await r.objectStore(jl).delete(e),await r.done}async function M_(n,e){const t=L_(n),s=(await LI()).transaction(jl,"readwrite"),i=s.objectStore(jl),a=await i.get(t),c=e(a);return c===void 0?await i.delete(t):await i.put(c,t),await s.done,c&&(!a||a.fid!==c.fid)&&FD(n,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(n){let e;const t=await M_(n.appConfig,r=>{const s=A$(r),i=N$(n,s);return e=i.registrationPromise,i.installationEntry});return t.fid===i0?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function A$(n){const e=n||{fid:w$(),registrationStatus:0};return zD(e)}function N$(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Vl.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=C$(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:k$(n)}:{installationEntry:e}}async function C$(n,e){try{const t=await _$(n,e);return yg(n.appConfig,t)}catch(t){throw RD(t)&&t.customData.serverCode===409?await BD(n.appConfig):await yg(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function k$(n){let e=await w1(n.appConfig);for(;e.registrationStatus===1;)await VD(100),e=await w1(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await MI(n);return r||t}return e}function w1(n){return M_(n,e=>{if(!e)throw Vl.create("installation-not-found");return zD(e)})}function zD(n){return R$(n)?{fid:n.fid,registrationStatus:0}:n}function R$(n){return n.registrationStatus===1&&n.registrationTime+ND<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P$({appConfig:n,heartbeatServiceProvider:e},t){const r=D$(n,t),s=p$(n,t),i=e.getImmediate({optional:!0});if(i){const p=await i.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const a={installation:{sdkVersion:CD,appId:n.appId}},c={method:"POST",headers:s,body:JSON.stringify(a)},h=await MD(()=>fetch(r,c));if(h.ok){const p=await h.json();return DD(p)}else throw await OD("Generate Auth Token",h)}function D$(n,{fid:e}){return`${PD(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VI(n,e=!1){let t;const r=await M_(n.appConfig,i=>{if(!$D(i))throw Vl.create("not-registered");const a=i.authToken;if(!e&&M$(a))return i;if(a.requestStatus===1)return t=O$(n,e),i;{if(!navigator.onLine)throw Vl.create("app-offline");const c=j$(i);return t=L$(n,c),c}});return t?await t:r.authToken}async function O$(n,e){let t=await E1(n.appConfig);for(;t.authToken.requestStatus===1;)await VD(100),t=await E1(n.appConfig);const r=t.authToken;return r.requestStatus===0?VI(n,e):r}function E1(n){return M_(n,e=>{if(!$D(e))throw Vl.create("not-registered");const t=e.authToken;return F$(t)?{...e,authToken:{requestStatus:0}}:e})}async function L$(n,e){try{const t=await P$(n,e),r={...e,authToken:t};return await yg(n.appConfig,r),t}catch(t){if(RD(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await BD(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await yg(n.appConfig,r)}throw t}}function $D(n){return n!==void 0&&n.registrationStatus===2}function M$(n){return n.requestStatus===2&&!V$(n)}function V$(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+u$}function j$(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function F$(n){return n.requestStatus===1&&n.requestTime+ND<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U$(n){const e=n,{installationEntry:t,registrationPromise:r}=await MI(e);return r?r.catch(console.error):VI(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B$(n,e=!1){const t=n;return await z$(t),(await VI(t,e)).token}async function z$(n){const{registrationPromise:e}=await MI(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $$(n){if(!n||!n.options)throw Bv("App Configuration");if(!n.name)throw Bv("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Bv(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Bv(n){return Vl.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="installations",H$="installations-internal",W$=n=>{const e=n.getProvider("app").getImmediate(),t=$$(e),r=Rg(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},q$=n=>{const e=n.getProvider("app").getImmediate(),t=Rg(e,HD).getImmediate();return{getId:()=>U$(t),getToken:s=>B$(t,s)}};function G$(){fr(new rn(HD,W$,"PUBLIC")),fr(new rn(H$,q$,"PRIVATE"))}G$();Cn(AD,OI);Cn(AD,OI,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$="/firebase-messaging-sw.js",Q$="/firebase-cloud-messaging-push-scope",WD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Y$="https://fcmregistrations.googleapis.com/v1",qD="google.c.a.c_id",J$="google.c.a.c_l",X$="google.c.a.ts",Z$="google.c.a.e",I1=1e4;var T1;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(T1||(T1={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var df;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(df||(df={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function eH(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="fcm_token_details_db",tH=5,x1="fcm_token_object_Store";async function nH(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(zv))return null;let e=null;return(await Ou(zv,tH,{upgrade:async(r,s,i,a)=>{if(s<2||!r.objectStoreNames.contains(x1))return;const c=a.objectStore(x1),h=await c.index("fcmSenderId").get(n);if(await c.clear(),!!h){if(s===2){const p=h;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:Oi(p.vapidKey)}}}else if(s===3){const p=h;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Oi(p.auth),p256dh:Oi(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Oi(p.vapidKey)}}}else if(s===4){const p=h;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Oi(p.auth),p256dh:Oi(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Oi(p.vapidKey)}}}}}})).close(),await Qc(zv),await Qc("fcm_vapid_details_db"),await Qc("undefined"),rH(e)?e:null}function rH(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sH="firebase-messaging-database",iH=1,Fl="firebase-messaging-store";let $v=null;function jI(){return $v||($v=Ou(sH,iH,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Fl)}}})),$v}async function GD(n){const e=UI(n),r=await(await jI()).transaction(Fl).objectStore(Fl).get(e);if(r)return r;{const s=await nH(n.appConfig.senderId);if(s)return await FI(n,s),s}}async function FI(n,e){const t=UI(n),s=(await jI()).transaction(Fl,"readwrite");return await s.objectStore(Fl).put(e,t),await s.done,e}async function oH(n){const e=UI(n),r=(await jI()).transaction(Fl,"readwrite");await r.objectStore(Fl).delete(e),await r.done}function UI({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aH={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Jn=new hi("messaging","Messaging",aH);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lH(n,e){const t=await zI(n),r=QD(e),s={method:"POST",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(BI(n.appConfig),s)).json()}catch(a){throw Jn.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(i.error){const a=i.error.message;throw Jn.create("token-subscribe-failed",{errorInfo:a})}if(!i.token)throw Jn.create("token-subscribe-no-token");return i.token}async function cH(n,e){const t=await zI(n),r=QD(e.subscriptionOptions),s={method:"PATCH",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${BI(n.appConfig)}/${e.token}`,s)).json()}catch(a){throw Jn.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(i.error){const a=i.error.message;throw Jn.create("token-update-failed",{errorInfo:a})}if(!i.token)throw Jn.create("token-update-no-token");return i.token}async function KD(n,e){const r={method:"DELETE",headers:await zI(n)};try{const i=await(await fetch(`${BI(n.appConfig)}/${e}`,r)).json();if(i.error){const a=i.error.message;throw Jn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(s){throw Jn.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function BI({projectId:n}){return`${Y$}/projects/${n}/registrations`}async function zI({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function QD({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const s={web:{endpoint:t,auth:e,p256dh:n}};return r!==WD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH=10080*60*1e3;async function hH(n){const e=await pH(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Oi(e.getKey("auth")),p256dh:Oi(e.getKey("p256dh"))},r=await GD(n.firebaseDependencies);if(r){if(mH(r.subscriptionOptions,t))return Date.now()>=r.createTime+uH?fH(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await KD(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return b1(n.firebaseDependencies,t)}else return b1(n.firebaseDependencies,t)}async function dH(n){const e=await GD(n.firebaseDependencies);e&&(await KD(n.firebaseDependencies,e.token),await oH(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function fH(n,e){try{const t=await cH(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await FI(n.firebaseDependencies,r),t}catch(t){throw t}}async function b1(n,e){const r={token:await lH(n,e),createTime:Date.now(),subscriptionOptions:e};return await FI(n,r),r.token}async function pH(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:eH(e)})}function mH(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,s=e.auth===n.auth,i=e.p256dh===n.p256dh;return t&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return gH(e,n),_H(e,n),yH(e,n),e}function gH(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const s=e.notification.image;s&&(n.notification.image=s);const i=e.notification.icon;i&&(n.notification.icon=i)}function _H(n,e){e.data&&(n.data=e.data)}function yH(n,e){var s,i,a,c;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;n.fcmOptions={};const t=((i=e.fcmOptions)==null?void 0:i.link)??((a=e.notification)==null?void 0:a.click_action);t&&(n.fcmOptions.link=t);const r=(c=e.fcmOptions)==null?void 0:c.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vH(n){return typeof n=="object"&&!!n&&qD in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wH(n){if(!n||!n.options)throw Hv("App Configuration Object");if(!n.name)throw Hv("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Hv(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Hv(n){return Jn.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EH=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=wH(e);this.firebaseDependencies={app:e,appConfig:s,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(n){try{n.swRegistration=await navigator.serviceWorker.register(K$,{scope:Q$}),n.swRegistration.update().catch(()=>{}),await IH(n.swRegistration)}catch(e){throw Jn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function IH(n){return new Promise((e,t)=>{const r=setTimeout(()=>t(new Error(`Service worker not registered after ${I1} ms`)),I1),s=n.installing||n.waiting;n.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var a;((a=i.target)==null?void 0:a.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TH(n,e){if(!e&&!n.swRegistration&&await YD(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Jn.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xH(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=WD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(n,e){if(!navigator)throw Jn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Jn.create("permission-blocked");return await xH(n,e==null?void 0:e.vapidKey),await TH(n,e==null?void 0:e.serviceWorkerRegistration),hH(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bH(n,e,t){const r=SH(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[qD],message_name:t[J$],message_time:t[X$],message_device_time:Math.floor(Date.now()/1e3)})}function SH(n){switch(n){case df.NOTIFICATION_CLICKED:return"notification_open";case df.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AH(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===df.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(S1(t)):n.onMessageHandler.next(S1(t)));const r=t.data;vH(r)&&r[Z$]==="1"&&await bH(n,t.messageType,r)}const A1="@firebase/messaging",N1="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NH=n=>{const e=new EH(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>AH(e,t)),e},CH=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>JD(e,r)}};function kH(){fr(new rn("messaging",NH,"PUBLIC")),fr(new rn("messaging-internal",CH,"PRIVATE")),Cn(A1,N1),Cn(A1,N1,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RH(n){if(!navigator)throw Jn.create("only-available-in-window");return n.swRegistration||await YD(n),dH(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PH(n,e){if(!navigator)throw Jn.create("only-available-in-window");return n.onMessageHandler=e,()=>{n.onMessageHandler=null}}async function DH(n,e){return n=ye(n),JD(n,e)}function OH(n){return n=ye(n),RH(n)}function LH(n,e){return n=ye(n),PH(n,e)}kH();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",MH="https://fcmregistrations.googleapis.com/v1",ZD="FCM_MSG",VH="google.c.a.c_id",jH=3,FH=1;var vg;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(vg||(vg={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var wg;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(wg||(wg={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function UH(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="fcm_token_details_db",BH=5,C1="fcm_token_object_Store";async function zH(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Wv))return null;let e=null;return(await Ou(Wv,BH,{upgrade:async(r,s,i,a)=>{if(s<2||!r.objectStoreNames.contains(C1))return;const c=a.objectStore(C1),h=await c.index("fcmSenderId").get(n);if(await c.clear(),!!h){if(s===2){const p=h;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:Li(p.vapidKey)}}}else if(s===3){const p=h;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Li(p.auth),p256dh:Li(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Li(p.vapidKey)}}}else if(s===4){const p=h;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Li(p.auth),p256dh:Li(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Li(p.vapidKey)}}}}}})).close(),await Qc(Wv),await Qc("fcm_vapid_details_db"),await Qc("undefined"),$H(e)?e:null}function $H(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HH="firebase-messaging-database",WH=1,Ul="firebase-messaging-store";let qv=null;function $I(){return qv||(qv=Ou(HH,WH,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Ul)}}})),qv}async function HI(n){const e=qI(n),r=await(await $I()).transaction(Ul).objectStore(Ul).get(e);if(r)return r;{const s=await zH(n.appConfig.senderId);if(s)return await WI(n,s),s}}async function WI(n,e){const t=qI(n),s=(await $I()).transaction(Ul,"readwrite");return await s.objectStore(Ul).put(e,t),await s.done,e}async function qH(n){const e=qI(n),r=(await $I()).transaction(Ul,"readwrite");await r.objectStore(Ul).delete(e),await r.done}function qI({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GH={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},si=new hi("messaging","Messaging",GH);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KH(n,e){const t=await KI(n),r=tO(e),s={method:"POST",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(GI(n.appConfig),s)).json()}catch(a){throw si.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(i.error){const a=i.error.message;throw si.create("token-subscribe-failed",{errorInfo:a})}if(!i.token)throw si.create("token-subscribe-no-token");return i.token}async function QH(n,e){const t=await KI(n),r=tO(e.subscriptionOptions),s={method:"PATCH",headers:t,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${GI(n.appConfig)}/${e.token}`,s)).json()}catch(a){throw si.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(i.error){const a=i.error.message;throw si.create("token-update-failed",{errorInfo:a})}if(!i.token)throw si.create("token-update-no-token");return i.token}async function eO(n,e){const r={method:"DELETE",headers:await KI(n)};try{const i=await(await fetch(`${GI(n.appConfig)}/${e}`,r)).json();if(i.error){const a=i.error.message;throw si.create("token-unsubscribe-failed",{errorInfo:a})}}catch(s){throw si.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function GI({projectId:n}){return`${MH}/projects/${n}/registrations`}async function KI({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function tO({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const s={web:{endpoint:t,auth:e,p256dh:n}};return r!==XD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YH=10080*60*1e3;async function JH(n){const e=await ZH(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Li(e.getKey("auth")),p256dh:Li(e.getKey("p256dh"))},r=await HI(n.firebaseDependencies);if(r){if(eW(r.subscriptionOptions,t))return Date.now()>=r.createTime+YH?XH(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await eO(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return R1(n.firebaseDependencies,t)}else return R1(n.firebaseDependencies,t)}async function k1(n){const e=await HI(n.firebaseDependencies);e&&(await eO(n.firebaseDependencies,e.token),await qH(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function XH(n,e){try{const t=await QH(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await WI(n.firebaseDependencies,r),t}catch(t){throw t}}async function R1(n,e){const r={token:await KH(n,e),createTime:Date.now(),subscriptionOptions:e};return await WI(n,r),r.token}async function ZH(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:UH(e)})}function eW(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,s=e.auth===n.auth,i=e.p256dh===n.p256dh;return t&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return nW(e,n),rW(e,n),sW(e,n),e}function nW(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const s=e.notification.image;s&&(n.notification.image=s);const i=e.notification.icon;i&&(n.notification.icon=i)}function rW(n,e){e.data&&(n.data=e.data)}function sW(n,e){var s,i,a,c;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;n.fcmOptions={};const t=((i=e.fcmOptions)==null?void 0:i.link)??((a=e.notification)==null?void 0:a.click_action);t&&(n.fcmOptions.link=t);const r=(c=e.fcmOptions)==null?void 0:c.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iW(n){return typeof n=="object"&&!!n&&VH in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oW(n){return new Promise(e=>{setTimeout(e,n)})}async function aW(n,e){const t=lW(e,await n.firebaseDependencies.installations.getId());cW(n,t,e.productId)}function lW(n,e){var r,s;const t={};return n.from&&(t.project_number=n.from),n.fcmMessageId&&(t.message_id=n.fcmMessageId),t.instance_id=e,n.notification?t.message_type=vg.DISPLAY_NOTIFICATION.toString():t.message_type=vg.DATA_MESSAGE.toString(),t.sdk_platform=jH.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),n.collapse_key&&(t.collapse_key=n.collapse_key),t.event=FH.toString(),(r=n.fcmOptions)!=null&&r.analytics_label&&(t.analytics_label=(s=n.fcmOptions)==null?void 0:s.analytics_label),t}function cW(n,e,t){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(r.compliance_data=uW(t)),n.logEvents.push(r)}function uW(n){return{privacy_context:{prequest:{origin_associated_product_id:n}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hW(n,e){var s;const{newSubscription:t}=n;if(!t){await k1(e);return}const r=await HI(e.firebaseDependencies);await k1(e),e.vapidKey=((s=r==null?void 0:r.subscriptionOptions)==null?void 0:s.vapidKey)??XD,await JH(e)}async function dW(n,e){const t=mW(n);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await aW(e,t);const r=await nO();if(_W(r))return yW(r,t);if(t.notification&&await vW(pW(t)),!!e&&e.onBackgroundMessageHandler){const s=tW(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(s):e.onBackgroundMessageHandler.next(s)}}async function fW(n){var a,c;const e=(c=(a=n.notification)==null?void 0:a.data)==null?void 0:c[ZD];if(e){if(n.action)return}else return;n.stopImmediatePropagation(),n.notification.close();const t=wW(e);if(!t)return;const r=new URL(t,self.location.href),s=new URL(self.location.origin);if(r.host!==s.host)return;let i=await gW(r);if(i?i=await i.focus():(i=await self.clients.openWindow(t),await oW(3e3)),!!i)return e.messageType=wg.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,i.postMessage(e)}function pW(n){const e={...n.notification};return e.data={[ZD]:n},e}function mW({data:n}){if(!n)return null;try{return n.json()}catch{return null}}async function gW(n){const e=await nO();for(const t of e){const r=new URL(t.url,self.location.href);if(n.host===r.host)return t}return null}function _W(n){return n.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function yW(n,e){e.isFirebaseMessaging=!0,e.messageType=wg.PUSH_RECEIVED;for(const t of n)t.postMessage(e)}function nO(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function vW(n){const{actions:e}=n,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(n.title??"",n)}function wW(n){var t,r;const e=((t=n.fcmOptions)==null?void 0:t.link)??((r=n.notification)==null?void 0:r.click_action);return e||(iW(n.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EW(n){if(!n||!n.options)throw Gv("App Configuration Object");if(!n.name)throw Gv("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Gv(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Gv(n){return si.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=EW(e);this.firebaseDependencies={app:e,appConfig:s,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=n=>{const e=new IW(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(dW(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(hW(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(fW(t))}),e};function xW(){fr(new rn("messaging-sw",TW,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bW(n,e){if(self.document!==void 0)throw si.create("only-available-in-sw");return n.onBackgroundMessageHandler=e,()=>{n.onBackgroundMessageHandler=null}}function SW(n,e){return n=ye(n),bW(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xW();const AW="@firebase/messaging-compat",NW="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CW(){return self&&"ServiceWorkerGlobalScope"in self?RW():kW()}function kW(){return typeof window<"u"&&wl()&&mM()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function RW(){return wl()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class P1{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return DH(this._delegate,e)}async deleteToken(){return OH(this._delegate)}onMessage(e){return LH(this._delegate,e)}onBackgroundMessage(e){return SW(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PW=n=>self&&"ServiceWorkerGlobalScope"in self?new P1(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging-sw").getImmediate()):new P1(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging").getImmediate()),DW={isSupported:CW};function OW(){Qt.INTERNAL.registerComponent(new rn("messaging-compat",PW,"PUBLIC").setServiceProps(DW))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */OW();Qt.registerVersion(AW,NW);const LW={apiKey:"AIzaSyAsAmByLvLqfFAKPiAeen0UJWdjT9MnTxQ",authDomain:"antamvieclam.firebaseapp.com",projectId:"antamvieclam",storageBucket:"antamvieclam.appspot.com",messagingSenderId:"221272132411",appId:"1:221272132411:web:83f7ab86a08823f3c8451e",measurementId:"G-2PT3C0KQWB",databaseURL:"https://antamvieclam-default-rtdb.asia-southeast1.firebasedatabase.app"};Qt.apps.length?Qt.app():Qt.initializeApp(LW);const Jh=Qt.auth(),He=Qt.firestore(),D1=Qt.messaging(),Eg=Qt.database(),Yi=Qt.firestore.FieldValue.serverTimestamp,MW=Qt.firestore.FieldValue.arrayUnion,rO=Qt.firestore.FieldValue.increment,VW="BC0S6kKANv-QpY1c-5rXw1Xg_WfH3Z7T6t_g8C6Z4-F8r4w8S9tQ8n7w6X3Z7f7b5t3b3Y5F-E1d0D9k8H",jW=async n=>{if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}if(Notification.permission==="granted")await O1(n);else if(Notification.permission!=="denied"){console.log("Requesting notification permission...");try{await Notification.requestPermission()==="granted"?(console.log("Notification permission granted."),await O1(n)):console.log("Notification permission denied.")}catch(e){console.error("An error occurred while requesting permission:",e)}}else console.log("Notification permission previously denied.")},O1=async n=>{try{const e=await D1.getToken({vapidKey:VW});e?(await He.collection("users").doc(n).update({fcmTokens:MW(e)}),console.log("FCM token saved for user."),D1.onMessage(r=>{console.log("Foreground message received. ",r)})):console.log("No registration token available. Request permission to generate one.")}catch(e){console.error("An error occurred while retrieving token:",e)}},QI=async(n,e,t,r)=>{try{await He.collection("notifications").add({userId:n,type:e,message:t,link:r,isRead:!1,createdAt:Yi()})}catch(s){console.error("Error creating notification:",s)}},FW=(n,e)=>He.collection("notifications").where("userId","==",n).onSnapshot(i=>{const a=[];i.forEach(c=>{var g;const h=c.data(),p=(g=h.createdAt)!=null&&g.toDate?h.createdAt.toDate().toISOString():new Date().toISOString();a.push({id:c.id,...h,createdAt:p})}),a.sort((c,h)=>new Date(h.createdAt).getTime()-new Date(c.createdAt).getTime()),e(a)},i=>{console.error("Error fetching notifications:",i),e([])}),UW=async n=>{await He.collection("notifications").doc(n).update({isRead:!0})},BW=async(n,e)=>{const t=e.filter(s=>!s.isRead);if(t.length===0)return;const r=He.batch();t.forEach(s=>{const i=He.collection("notifications").doc(s.id);r.update(i,{isRead:!0})}),await r.commit()},sO={isOnline:!1,lastSeen:Qt.database.ServerValue.TIMESTAMP},zW={isOnline:!0,lastSeen:Qt.database.ServerValue.TIMESTAMP},$W=async n=>{try{await Eg.ref(`/users/${n}/status`).set(sO)}catch(e){console.error("Error setting user offline:",e)}},HW=n=>{const e=Eg.ref(`/users/${n}/status`),t=Eg.ref(".info/connected"),r=t.on("value",s=>{s.val()!==!1&&e.onDisconnect().set(sO).then(()=>{e.set(zW).catch(i=>console.warn("Presence set online failed",i.code))}).catch(i=>console.warn("Presence onDisconnect failed",i.code))});return()=>{t.off("value",r)}},iO=H.createContext(void 0),so=()=>{const n=H.useContext(iO);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},WW=({children:n})=>{const[e,t]=H.useState(null),[r,s]=H.useState(null),[i,a]=H.useState(!0),c=async P=>{var X;if(!P){s(null);return}const M=await He.collection("users").doc(P.uid).get();if(M.exists){const W=M.data(),Q=(X=W.createdAt)!=null&&X.toDate?W.createdAt.toDate().toISOString():new Date().toISOString(),Y={uid:W.uid,email:W.email,userType:W.userType,createdAt:Q,fullName:W.fullName,phoneNumber:W.phoneNumber,address:W.address,profileImageUrl:W.profileImageUrl,fcmTokens:W.fcmTokens||[],bio:W.bio||"",skills:W.skills||[],workHistory:W.workHistory||[],cvUrl:W.cvUrl||null,cvName:W.cvName||null};s(Y)}else console.log("No such user document!"),s(null)},h=H.useCallback(async()=>{e&&await c(e)},[e]),p=async(P,O,M)=>{const X=await Jh.createUserWithEmailAndPassword(P,O),{user:W}=X;if(!W)throw new Error("User creation failed.");return await He.collection("users").doc(W.uid).set({uid:W.uid,email:W.email,userType:M,createdAt:Yi(),fullName:null,phoneNumber:null,address:null,profileImageUrl:null,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}),X},g=(P,O)=>Jh.signInWithEmailAndPassword(P,O),y=async()=>(e&&await $W(e.uid),Jh.signOut()),E=async()=>{const P=new Qt.auth.GoogleAuthProvider;try{await Jh.signInWithPopup(P)}catch(O){throw console.error("Error with Google Sign-in Popup:",O),O}};H.useEffect(()=>{let P;const O=Jh.onAuthStateChanged(async M=>{P&&(P(),P=void 0),t(M),M?(await c(M),await jW(M.uid),P=HW(M.uid)):s(null),a(!1)});return()=>{O(),P&&P()}},[]);const x={currentUser:e,currentUserData:r,loading:i,signup:p,login:g,logout:y,loginWithGoogle:E,refetchUserData:h};return f.jsx(iO.Provider,{value:x,children:!i&&n})},qW=async n=>{const{workerId:e,employerId:t}=n,r=[e,t].sort(),s=r.join("_"),i=He.collection("conversations").doc(s);if(!(await i.get()).exists){const c={[e]:{fullName:n.workerName,profileImageUrl:n.workerProfileImageUrl||null},[t]:{fullName:n.employerName,profileImageUrl:n.employerProfileImageUrl||null}},h={[e]:0,[t]:0};await i.set({id:s,participants:r,participantInfo:c,lastMessage:`Bt u tr chuyn v cng vic: ${n.jobTitle}`,lastMessageTimestamp:Yi(),unreadCounts:h})}return s},oO=(n,e)=>He.collection("conversations").where("participants","array-contains",n).onSnapshot(i=>{const a=[];i.forEach(c=>{var g;const h=c.data(),p=(g=h.lastMessageTimestamp)!=null&&g.toDate?h.lastMessageTimestamp.toDate().toISOString():new Date().toISOString();a.push({id:c.id,...h,lastMessageTimestamp:p})}),a.sort((c,h)=>new Date(h.lastMessageTimestamp||0).getTime()-new Date(c.lastMessageTimestamp||0).getTime()),e(a)},i=>{console.error("Error fetching conversations:",i),e([])}),GW=(n,e)=>He.collection("conversations").doc(n).collection("messages").orderBy("timestamp","asc").onSnapshot(i=>{const a=[];i.forEach(c=>{var g;const h=c.data(),p=(g=h.timestamp)!=null&&g.toDate?h.timestamp.toDate().toISOString():new Date().toISOString();a.push({id:c.id,conversationId:n,...h,timestamp:p})}),e(a)},i=>{console.error("Error fetching messages:",i),e([])}),KW=async(n,e,t,r)=>{if(!r.trim())return;await He.collection("conversations").doc(n).collection("messages").add({senderId:e,text:r,timestamp:Yi(),status:"sent",deleted:!1});const i=He.collection("conversations").doc(n),a=await i.get();if(a.exists){const h=a.data().participants.find(p=>p!==e);if(h){const p={lastMessage:r,lastMessageTimestamp:Yi(),[`unreadCounts.${h}`]:rO(1)};await i.update(p)}}},QW=async(n,e)=>{const t=He.collection("conversations").doc(n);try{await t.update({[`unreadCounts.${e}`]:0})}catch(r){console.error("Error marking conversation as read:",r)}},YW=async(n,e)=>{const r=He.collection("conversations").doc(n).collection("messages").where("senderId","!=",e).where("status","==","sent");try{const s=await r.get();if(s.empty)return;const i=He.batch();s.forEach(a=>{i.update(a.ref,{status:"read"})}),await i.commit()}catch(s){console.error("Error marking messages as read:",s)}},JW=async(n,e,t,r)=>{if(t!==r)throw new Error("You can only delete your own messages.");await He.collection("conversations").doc(n).collection("messages").doc(e).update({text:"Tin nhn ny  c thu hi.",deleted:!0})},XW=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M10 2a2 2 0 00-2 2v1h4V4a2 2 0 00-2-2zM4 7v1h12V7a1 1 0 00-1-1H5a1 1 0 00-1 1zm0 3v7a1 1 0 001 1h10a1 1 0 001-1v-7H4z",clipRule:"evenodd"})}),ZW=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M12.016 2.002c-5.523 0-9.984 4.47-9.984 9.998 0 3.803 2.12 7.126 5.234 8.786a.75.75 0 00.98-.103l.055-.065a.75.75 0 00-.03-1.06l-1.29-1.29a.75.75 0 01-.217-.53v-3.384a3.75 3.75 0 016.48-2.457.75.75 0 001.353-.646A3.75 3.75 0 0118 9.75v3.384a.75.75 0 01-.217.53l-1.29 1.29a.75.75 0 00-.03 1.06l.055.065a.75.75 0 00.98.103c3.113-1.66 5.234-4.983 5.234-8.786C22 6.472 17.539 2.002 12.016 2.002zM8.982 13.24a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l4.5-4.5a.75.75 0 00-1.06-1.06L10.5 14.94l-1.518-1.518z",clipRule:"evenodd"})}),eq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})}),tq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4.804 21.644A6.707 6.707 0 006 21.75a6.721 6.721 0 003.583-1.029c.774.182 1.584.279 2.417.279 5.352 0 9.75-4.348 9.75-9.75S17.352 2.25 12 2.25 2.25 6.598 2.25 12c0 1.752.47 3.419 1.305 4.804l-1.125 4.498a.75.75 0 00.916.916l4.498-1.125zM8.25 12a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H9a.75.75 0 01-.75-.75zm3.75 0a.75.75 0 01.75-.75h.01a.75.75 0 010 1.5H12.75a.75.75 0 01-.75-.75zm3-1.5a.75.75 0 000 1.5h.01a.75.75 0 000-1.5H15z",clipRule:"evenodd"})}),nq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",clipRule:"evenodd"})}),rq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:f.jsx("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 01.721.544l.813 2.846a3.75 3.75 0 002.576 2.576l2.846.813a.75.75 0 010 1.442l-2.846.813a3.75 3.75 0 00-2.576 2.576l-.813 2.846a.75.75 0 01-1.442 0l-.813-2.846a3.75 3.75 0 00-2.576-2.576l-2.846-.813a.75.75 0 010-1.442l2.846-.813a3.75 3.75 0 002.576-2.576l.813-2.846A.75.75 0 019 4.5zM18 1.5a.75.75 0 01.728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 010 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 01-1.456 0l-.258-1.036a2.625 2.625 0 00-1.91-1.91l-1.036-.258a.75.75 0 010-1.456l1.036-.258a2.625 2.625 0 001.91-1.91l.258-1.036A.75.75 0 0118 1.5zM16.5 15a.75.75 0 01.712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 010 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 01-1.422 0l-.395-1.183a1.5 1.5 0 00-.948-.948l-1.183-.395a.75.75 0 010-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0116.5 15z",clipRule:"evenodd"})}),sq=({icon:n,activeIcon:e,label:t,isActive:r,onClick:s,hasUnread:i=!1})=>f.jsxs("button",{onClick:s,className:`relative flex flex-col items-center justify-center space-y-1 w-full p-2 rounded-lg transition-colors duration-200 ${r?"text-indigo-600 bg-indigo-50":"text-gray-500 hover:bg-gray-100"}`,children:[r?e:n,f.jsx("span",{className:"text-[10px] font-medium text-center leading-tight",children:t}),i&&f.jsx("span",{className:"absolute top-1 right-3 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),iq=({label:n,isActive:e,onClick:t,hasUnread:r=!1})=>f.jsxs("button",{onClick:t,className:`relative px-3 py-2 rounded-md text-sm transition-colors duration-200 ${e?"text-indigo-600 font-semibold":"text-gray-600 hover:text-indigo-600 font-medium"}`,children:[n,e&&f.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-5 h-0.5 bg-indigo-600 rounded-full"}),r&&f.jsx("span",{className:"absolute top-1 right-0 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]}),oq=({activeView:n,setActiveView:e,onPostJobClick:t,onNotificationNavigate:r})=>{const{currentUser:s,currentUserData:i,logout:a}=so(),[c,h]=H.useState([]),[p,g]=H.useState(!1),[y,E]=H.useState(0),x=c.filter(W=>!W.isRead).length;H.useEffect(()=>{if(s){const W=FW(s.uid,h),Q=oO(s.uid,Y=>{const ue=Y.reduce((se,R)=>{var S;return se+(((S=R.unreadCounts)==null?void 0:S[s.uid])||0)},0);E(ue)});return()=>{W(),Q()}}},[s]);const P=async()=>{try{await a()}catch(W){console.error("Failed to log out",W)}},O=W=>{UW(W.id),r(W.link),g(!1)},M=()=>{s&&BW(s.uid,c)};let X=[{view:pn.Jobs,label:"Tm Vic",icon:f.jsx(ii,{className:"w-6 h-6"}),activeIcon:f.jsx(XW,{className:"w-6 h-6"})},{view:pn.Insurance,label:"Bo Him",icon:f.jsx(Ui,{className:"w-6 h-6"}),activeIcon:f.jsx(ZW,{className:"w-6 h-6"})},{view:pn.Messaging,label:"Tin Nhn",icon:f.jsx(Ag,{className:"w-6 h-6"}),activeIcon:f.jsx(eq,{className:"w-6 h-6"}),hasUnread:y>0},{view:pn.Chatbot,label:"Hi p",icon:f.jsx(YL,{className:"w-6 h-6"}),activeIcon:f.jsx(tq,{className:"w-6 h-6"})},{view:pn.Profile,label:"H S",icon:f.jsx(Qv,{className:"w-6 h-6"}),activeIcon:f.jsx(nq,{className:"w-6 h-6"})}];return(i==null?void 0:i.userType)===jt.Worker&&X.splice(1,0,{view:pn.Recommendations,label:"Gi  AI",icon:f.jsx(Uo,{className:"w-6 h-6"}),activeIcon:f.jsx(rq,{className:"w-6 h-6"})}),f.jsxs(f.Fragment,{children:[f.jsx("header",{className:"hidden md:block sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center justify-between h-20",children:[f.jsxs("div",{className:"flex items-center space-x-10",children:[f.jsxs("button",{onClick:()=>e(pn.Jobs),className:"flex items-center flex-shrink-0 group",children:[f.jsx(Ui,{className:"h-8 w-8 text-indigo-600 group-hover:animate-pulse"}),f.jsx("h1",{className:"ml-3 text-2xl font-bold text-gray-800",children:"An Tm Vic Lm"})]}),f.jsx("nav",{className:"flex items-baseline space-x-2 lg:space-x-4",children:X.map(W=>f.jsx(iq,{label:W.label,isActive:n===W.view,onClick:()=>e(W.view),hasUnread:W.hasUnread},W.view))})]}),s&&i&&f.jsxs("div",{className:"flex items-center space-x-4",children:[i.userType===jt.Employer&&f.jsxs("button",{onClick:t,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[f.jsx(Yv,{className:"w-5 h-5 mr-2"}),"ng tin"]}),f.jsx("div",{className:"relative",children:f.jsxs("button",{onClick:()=>g(W=>!W),className:"p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Thng bo",children:[f.jsx(JL,{}),x>0&&f.jsx("span",{className:"absolute top-1 right-1 block h-2.5 w-2.5 rounded-full bg-red-500 border-2 border-white"})]})}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsxs("span",{className:"text-sm text-gray-600 text-right hidden lg:block",children:["Cho, ",f.jsx("span",{className:"font-semibold",children:i.fullName||s.email})]}),i.profileImageUrl?f.jsx("img",{src:i.profileImageUrl,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover"}):f.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:f.jsx(Qv,{className:"w-6 h-6 text-gray-500"})})]}),f.jsx("button",{onClick:P,className:"text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors",children:"ng xut"})]})]})})}),f.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.05)]",children:f.jsx("div",{className:"max-w-7xl mx-auto px-2",children:f.jsx("nav",{className:`grid grid-cols-${X.length} gap-1 h-full items-center p-1.5`,children:X.map(W=>f.jsx(sq,{icon:W.icon,activeIcon:W.activeIcon,label:W.label,isActive:n===W.view,onClick:()=>e(W.view),hasUnread:W.hasUnread},W.view))})})}),s&&(i==null?void 0:i.userType)===jt.Employer&&f.jsx("div",{className:"md:hidden fixed bottom-20 right-4 z-50",children:f.jsx("button",{onClick:t,className:"bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"ng tin tuyn dng mi",children:f.jsx(Yv,{className:"w-8 h-8"})})}),p&&f.jsx(ZL,{notifications:c,onNotificationClick:O,onMarkAllAsRead:M,onClose:()=>g(!1)})]})},aq=n=>{if(typeof n=="string")return n;try{return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n)}catch{return`${n} VN`}},aO=(n,e)=>{if(n==="Tha thun")return"Tha thun";const t=aq(n);switch(e){case"THEO GI":return`${t}/gi`;case"THEO NGY":return`${t}/ngy`;case"THEO THNG":return`${t}/thng`;default:return t}},Ig=n=>{if(!n||typeof n!="string")return null;try{const e=n.match(/\[\s*(-?\d+\.?\d*)\s*\s*N,\s*(-?\d+\.?\d*)\s*\s*E\s*\]/);if(e&&e.length===3){const t=parseFloat(e[1]),r=parseFloat(e[2]);if(!isNaN(t)&&!isNaN(r))return{lat:t,lng:r}}return null}catch(e){return console.error("Error parsing location string:",n,e),null}},lO=(n,e,t,r)=>{const i=(t-n)*(Math.PI/180),a=(r-e)*(Math.PI/180),c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n*(Math.PI/180))*Math.cos(t*(Math.PI/180))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},YI=(n,e="post")=>{const t=new Date,r=new Date(n),s=Math.floor((t.getTime()-r.getTime())/1e3);if(s<5)return e==="presence"?"vi giy trc":"va xong";if(s<60)return`${s} giy trc`;const i=Math.floor(s/60);if(i<60)return`${i} pht trc`;const a=Math.floor(i/60);if(a<24)return`${a} gi trc`;const c=Math.floor(a/24);return c===1?"hm qua":c<7?`${c} ngy trc`:new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)},lq=({className:n="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Go=({className:n="w-8 h-8"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-3.96 0-7.25 3.29-7.25 7.353 0 4.434 5.333 11.235 6.75 12.83a.75.75 0 001.002 0c1.417-1.595 6.75-8.396 6.75-12.83C19.25 5.543 15.96 2.25 12 2.25zM12 12a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z",clipRule:"evenodd"})}),cO=({className:n="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),cq=({className:n="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})}),uq=({job:n,onClick:e,applicantCount:t})=>{const r=n.status==="CLOSED",s=i=>{i.stopPropagation();const a="nguyenduyphuc0119@gmail.com",c=encodeURIComponent(`Bo co tin tuyn dng: ${n.title}`),h=encodeURIComponent(`Knh gi Ban qun tr An Tm Vic Lm,

Ti mun bo co tin tuyn dng sau v ni dung khng chnh xc hoc khng ph hp:

- ID Cng vic: ${n.id}
- Tiu : ${n.title}
- Nh tuyn dng: ${n.employerName}

L do bo co:
(Vui lng nhp l do ca bn ti y)

Trn trng.`);window.location.href=`mailto:${a}?subject=${c}&body=${h}`};return f.jsxs("div",{onClick:e,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&e()},className:`bg-white p-5 rounded-xl border border-gray-200 flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-5 transition-all duration-300 ${r?"opacity-60":"hover:shadow-lg hover:border-indigo-300 cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transform hover:-translate-y-1"}`,role:"button",tabIndex:0,"aria-label":`Xem chi tit cng vic ${n.title} ti ${n.employerName}`,children:[n.employerProfileUrl?f.jsx("img",{src:n.employerProfileUrl,alt:`${n.employerName} logo`,className:"w-20 h-20 rounded-lg object-cover flex-shrink-0"}):f.jsx("div",{className:"w-20 h-20 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0",children:f.jsx(ii,{className:"w-10 h-10 text-gray-400"})}),f.jsxs("div",{className:"flex-grow flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx("h3",{className:"font-bold text-lg text-gray-800",children:n.title}),f.jsx("p",{className:"text-sm text-gray-600",children:n.employerName})]}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500 flex-shrink-0 ml-4 pt-1",title:`ng vo ${new Date(n.createdAt).toLocaleString("vi-VN")}`,children:[f.jsx(cO,{className:"w-4 h-4 mr-1"}),f.jsx("span",{children:YI(n.createdAt)})]})]}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.addressString}),f.jsxs("div",{className:"mt-3 flex items-center justify-between pt-3 border-t border-gray-100 sm:mt-auto flex-wrap gap-y-2",children:[f.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[f.jsx("span",{className:"text-sm font-semibold text-green-700 bg-green-100 px-3 py-1 rounded-full",children:aO(n.payRate,n.payType)}),n.distance!==void 0&&f.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`Khong cch c tnh ${n.distance.toFixed(1)} km`,children:[f.jsx(Go,{className:"w-4 h-4 mr-1 text-gray-500"}),f.jsxs("span",{children:[n.distance.toFixed(1)," km"]})]}),t>0&&f.jsxs("div",{className:"flex items-center text-xs text-gray-600 font-medium",title:`${t} ngi  ng tuyn`,children:[f.jsx(lq,{className:"w-4 h-4 mr-1 text-gray-500"}),f.jsx("span",{children:t})]}),n.jobType&&f.jsx("span",{className:"text-xs text-indigo-700 font-medium bg-indigo-100 px-3 py-1 rounded-full",children:n.jobType}),r?f.jsx("span",{className:"text-xs font-medium text-gray-700 bg-gray-200 px-3 py-1 rounded-full",children:" ng"}):f.jsx("span",{className:"text-xs font-medium text-green-700 bg-green-100 px-3 py-1 rounded-full",children:"ang tuyn"})]}),f.jsxs("button",{onClick:s,className:"flex items-center text-xs font-medium text-gray-400 hover:text-red-500 transition-colors p-1 rounded",title:"Bo co tin tuyn dng ny","aria-label":"Bo co tin tuyn dng",children:[f.jsx(cq,{className:"w-4 h-4 mr-1"}),"Bo xu"]})]})]})]})},uO={points:250,pointsGoal:1e3,pointsRewardVND:5e5,autoDeductEnabled:!0,autoDeductAccumulatedThisMonth:15e4},hq=`
BN L TR L AI CA NN TNG "AN TM VIC LM".

MC TIU CA NN TNG:
"An Tm Vic Lm" l mt nn tng s c to ra vi s mnh h tr cng ng lao ng t do ti Vit Nam. Chng ti gii quyt hai vn  ln:
1.  **Vic lm:** Gip ngi lao ng d dng tm thy cc cng vic thi v, bn thi gian, hoc linh hot  gn h mt cch an ton v minh bch.
2.  **An sinh x hi:** Khuyn khch v to iu kin  ngi lao ng tham gia bo him x hi (BHXH) t nguyn, m bo h c lng hu v s n nh khi v gi.

CHC NNG CHNH:
-   **Tm vic:** Ngi lao ng tm vic, nh tuyn dng ng tin.
-   **Bo him:** Cung cp thng tin v cc cng c  ngi lao ng tch ly cho BHXH t nguyn v tham kho cc sn phm bo him b sung.
-   **Hi p (Chatbot):** Bn, tr l AI, gip gii p cc thc mc lin quan n vic lm, bo him v cch s dng nn tng.

HY S DNG BI CNH DI Y  TR LI CU HI CA NGI DNG MT CCH CHNH XC NHT.
`.trim(),V_=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),hO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-4.5 0V6.75a.75.75 0 01.75-.75h3.75a.75.75 0 01.75.75v3.75M13.5 6l5.25 5.25"})}),dq=({onClose:n})=>f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:n,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden relative animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:t=>t.stopPropagation(),children:[f.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"ng",children:f.jsx(V_,{className:"w-6 h-6"})}),f.jsxs("div",{className:"p-8 text-center",children:[f.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(Ui,{className:"w-8 h-8 text-indigo-600"})}),f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Chuyn n Cng Dch v cng"}),f.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Bn s c chuyn hng n trang web chnh thc ca Bo him X hi Vit Nam  thc hin thanh ton mt cch an ton."}),f.jsxs("a",{href:"https://dichvucong.baohiemxahoi.gov.vn/#/index?login=1&url=%2Fthanh-toan-bhxh-dien-tu%2Fngan-hang-lien-ket&queryUrl=",target:"_blank",rel:"noopener noreferrer",className:"mt-6 w-full inline-flex items-center justify-center bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 shadow-sm",children:["Tip tc n trang thanh ton",f.jsx(hO,{className:"w-5 h-5 ml-2"})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Lu : Bn s cn ng nhp vo ti khon BHXH ca mnh trn cng dch v cng."})]})]})}),dO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),L1=({className:n="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 01-3 0m3 0h1.5M15.75 18.75a1.5 1.5 0 01-3 0m3 0h1.5m-9-1.5H5.625c-.621 0-1.125-.504-1.125-1.125V11.25c0-.621.504-1.125 1.125-1.125h12.75c.621 0 1.125.504 1.125 1.125v4.875c0 .621-.504 1.125-1.125 1.125H12M5.25 12.75v-1.5m13.5 1.5v-1.5"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 12.75h13.5m-13.5 0a3 3 0 003 3h7.5a3 3 0 003-3"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 9.75h13.5"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 4.5l-2.25 2.25"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 4.5l2.25 2.25"})]}),M1=({className:n="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.5c0 1.242-1.008 2.25-2.25 2.25S16.5 17.742 16.5 16.5 17.508 14.25 18.75 14.25 21 15.258 21 16.5z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5c0 1.242-1.008 2.25-2.25 2.25S3 17.742 3 16.5 4.008 14.25 5.25 14.25 7.5 15.258 7.5 16.5z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 16.5h9"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 16.5v-4.5a1.5 1.5 0 011.5-1.5h1.5v-1.5H12a3 3 0 00-3 3v4.5"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9l2.25 3h3.75"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 6.75l-.75-1.5"})]}),Rm=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),fO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),fq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21V11.25m0-1.01V8.25m0 5.25v5.25m0-5.25H4.5m7.5 0H19.5M3.75 11.25h16.5M4.5 21h15M3 11.25a.75.75 0 01.75-.75h16.5a.75.75 0 01.75.75v9a.75.75 0 01-.75.75H3.75a.75.75 0 01-.75-.75v-9z"})}),V1=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955a.75.75 0 011.06 0l8.955 8.955a.75.75 0 01-1.06 1.06l-1.72-1.72V21a.75.75 0 01-.75.75H5.25a.75.75 0 01-.75-.75V11.34l-1.72 1.72a.75.75 0 01-1.06-1.06z"})}),pq=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.18-3.185m-3.18-3.182a8.25 8.25 0 00-11.664 0l-3.182 3.182"})}),mq=[{title:"BH xe my bt buc",description:"Bo v trch nhim dn s ca bn khi tham gia giao thng.",link:"https://motor-civil.globalcare.vn/293f4359&skip-password=1?token=2306244fxozgmotc",icon:f.jsx(M1,{className:"w-7 h-7 text-gray-700"})},{title:"BH  t bt buc",description:"Yn tm vng li vi bo him trch nhim dn s cho  t.",link:"https://oto-civil.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:f.jsx(L1,{className:"w-7 h-7 text-gray-700"})},{title:"BH vt cht  t",description:"Bo v ton din cho x yu trc mi ri ro va chm, h hng.",link:"https://phydam.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:f.jsx(L1,{className:"w-7 h-7 text-gray-700"})},{title:"BH sc khe",description:"Chm sc sc khe ton din cho bn v gia nh.",link:"https://globalcare.vn/products-hub?code=health&token=2306244fxozgmotc",icon:f.jsx(Rm,{className:"w-7 h-7 text-red-500"})},{title:"BH an ninh mng",description:"Bo v bn khi cc ri ro v tn cng trn khng gian mng.",link:"https://globalcare.vn/bao-hiem-an-ninh-mang?token=2306244fxozgmotc",icon:f.jsx(fO,{className:"w-7 h-7 text-blue-600"})},{title:"BH ton din h kinh doanh",description:"An tm kinh doanh vi gii php bo v ti sn v hot ng.",link:"https://globalcare.vn/bao-hiem-toan-dien-ho-kinh-doanh-ca-the?token=2306244fxozgmotc",icon:f.jsx(fq,{className:"w-7 h-7 text-yellow-600"})},{title:"BH cu h xe my 24/7",description:"H tr kp thi mi lc, mi ni khi xe bn gp s c.",link:"https://globalcare.vn/dich-vu-cuu-ho-xe-may?token=2306244fxozgmotc",icon:f.jsx(M1,{className:"w-7 h-7 text-gray-700"})},{title:"BH bnh him ngho",description:"Ngun ti chnh vng chc gip bn vt qua bnh tt.",link:"https://critical-disease.globalcare.vn/b45306c2?token=2306244fxozgmotc",icon:f.jsx(Rm,{className:"w-7 h-7 text-red-500"})},{title:"BH VIB care",description:"Gi chm sc sc khe cao cp vi nhiu quyn li vt tri.",link:"https://vbi-care.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:f.jsx(Rm,{className:"w-7 h-7 text-red-500"})},{title:"BH nh t nhn",description:"Bo v t m ca bn trc nhng ri ro chy, n, thin tai.",link:"https://private-home.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:f.jsx(V1,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn Tomato",description:"Gi bo him tai nn c nhn linh hot, chi ph thp.",link:"https://tomato.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:f.jsx(Ui,{className:"w-7 h-7 text-indigo-600"})},{title:"BH Home Care",description:"Bo v ton din cho ngi nh v ti sn bn trong.",link:"https://private-home.globalcare.vn/3bb76e94?token=2306244fxozgmotc",icon:f.jsx(V1,{className:"w-7 h-7 text-green-600"})},{title:"BH tai nn c nhn",description:"An tm trc mi ri ro khng lng trc trong cuc sng.",link:"https://personal-accident.globalcare.vn/293f4359?token=2306244fxozgmotc",icon:f.jsx(Ui,{className:"w-7 h-7 text-indigo-600"})}],gq=()=>{const n=uO,[e,t]=H.useState(!1),[r,s]=H.useState(n.autoDeductEnabled),i=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-12",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Trung tm An Sinh"}),f.jsx("p",{className:"text-lg text-gray-600",children:"Tch ly cho tng lai, an tm cho hm nay."})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Bo him X hi T nguyn"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"relative bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col opacity-70",children:[f.jsx("div",{className:"absolute top-3 right-3 bg-gray-200 text-gray-700 text-xs font-semibold px-3 py-1 rounded-full z-10",children:"D kin ra mt"}),f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:f.jsx(Uo,{className:"w-6 h-6 text-gray-400"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Tch im An Sinh"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Hon thnh vic, nhn thng t nn tng."})]})]}),f.jsxs("div",{className:"flex-grow space-y-3 mt-auto",children:[f.jsxs("p",{className:"text-3xl font-bold text-gray-400",children:["0 ",f.jsxs("span",{className:"text-xl font-semibold text-gray-500",children:["/ ",n.pointsGoal," im"]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:f.jsx("div",{className:"bg-gray-300 h-2.5 rounded-full",style:{width:"0%"}})}),f.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 p-3 rounded-lg mt-3 flex items-start space-x-2",children:[f.jsx(dO,{className:"w-4 h-4 text-gray-500 flex-shrink-0 mt-0.5"}),f.jsxs("p",{children:[f.jsx("span",{className:"font-semibold",children:"[Tnh nng d kin]"})," Vi mi cng vic hon thnh, bn s c cng im. Khon h tr ",f.jsx("span",{className:"font-semibold text-gray-500",children:i(n.pointsRewardVND)})," s c ti tr bi ",f.jsx("span",{className:"font-semibold",children:"Qu An Sinh"})," khi bn t mc im."]})]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:f.jsx(pq,{className:"w-6 h-6 text-indigo-600"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Tch Ly T ng"}),f.jsx("p",{className:"text-sm text-gray-500",children:" dnh cho tng lai."})]})]}),f.jsx("button",{onClick:()=>s(!r),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${r?"bg-indigo-600":"bg-gray-300"}`,children:f.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]}),f.jsx("div",{className:"flex-grow flex flex-col items-center justify-center bg-gray-50 rounded-lg p-4 text-center mt-auto",children:r?f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"S tin  tch ly trong thng ny"}),f.jsx("p",{className:"text-4xl font-extrabold text-indigo-600 my-2",children:i(n.autoDeductAccumulatedThisMonth)}),f.jsx("p",{className:"text-xs text-gray-500",children:"H thng s t ng trch 2% thu nhp t cc cng vic bn lm qua nn tng. Khon tch ly ny s c t li vo u mi thng."})]}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Tnh nng ang tt"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bt  t ng trch mt phn thu nhp cho qu BHXH ca bn."})]})})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Ch ng ng gp"}),f.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bn c th ng thm vo qu BHXH ca mnh bt c lc no  nhanh chng t c mc tiu hu tr."}),f.jsx("button",{onClick:()=>t(!0),className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 shadow-sm",children:"ng BHXH ngay"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Sn phm Bo him B sung"}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:mq.map(a=>f.jsxs("a",{href:a.link,target:"_blank",rel:"noopener noreferrer",className:"group block p-5 bg-white rounded-xl border border-gray-200 hover:border-indigo-400 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center",children:a.icon}),f.jsx(hO,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-600 transition-colors"})]}),f.jsx("p",{className:"font-bold text-gray-800 mt-4",children:a.title}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.description})]},a.title))})]})]}),e&&f.jsx(dq,{onClose:()=>t(!1)})]})},pO=n=>{const[e,t]=H.useState({isOnline:!1,statusText:null});return H.useEffect(()=>{if(!n){t({isOnline:!1,statusText:null});return}const r=Eg.ref(`/users/${n}/status`),s=r.on("value",i=>{const a=i.val();if(a!=null&&a.isOnline)t({isOnline:!0,statusText:"ang hot ng"});else if(a!=null&&a.lastSeen&&typeof a.lastSeen=="number")try{const c=new Date(a.lastSeen).toISOString();t({isOnline:!1,statusText:`Hot ng ${YI(c,"presence")}`})}catch{console.warn("Invalid lastSeen date for user:",n,a.lastSeen),t({isOnline:!1,statusText:"Khng hot ng"})}else t({isOnline:!1,statusText:"Khng hot ng"})},i=>{console.warn("Error reading presence:",i),t({isOnline:!1,statusText:null})});return()=>r.off("value",s)},[n]),e},ar=({fullScreen:n=!1,message:e})=>{const t=n?"fixed inset-0 flex flex-col items-center justify-center bg-gray-50 z-50":"flex flex-col items-center justify-center";return f.jsxs("div",{className:t,children:[f.jsx("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-indigo-500"}),e&&f.jsx("p",{className:"mt-4 text-lg font-semibold text-gray-700",children:e})]})},mO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.85.064-1.649-.24-2.228-.796a4.425 4.425 0 01-1.16-3.197V8.511c0-.969.616-1.813 1.5-2.097L16.5 6.25l3.75 2.261zM3.75 14.25a2.25 2.25 0 002.25 2.25h3.75V15.75h-3.75a.75.75 0 01-.75-.75V8.25a.75.75 0 01.75-.75h3.75V6.75h-3.75a2.25 2.25 0 00-2.25 2.25v6z"})}),gO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),_q=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),yq=({className:n="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 12.75l6 6 9-13.5",opacity:"0.5"})]}),JI=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),vq=({status:n})=>n==="read"?f.jsx(yq,{className:"w-4 h-4 text-blue-500"}):f.jsx(_q,{className:"w-4 h-4 text-gray-400"}),wq=({convo:n,isActive:e,currentUserId:t,onClick:r})=>{var h;const s=n.participants.find(p=>p!==t),i=s?n.participantInfo[s]:null,{isOnline:a}=pO(s||null),c=((h=n.unreadCounts)==null?void 0:h[t])||0;return f.jsxs("div",{onClick:r,className:`p-4 flex items-center space-x-3 cursor-pointer transition-colors ${e?"bg-indigo-50":"hover:bg-gray-50"}`,children:[f.jsxs("div",{className:"relative flex-shrink-0",children:[i!=null&&i.profileImageUrl?f.jsx("img",{src:i.profileImageUrl,alt:"",className:"w-12 h-12 rounded-full object-cover"}):f.jsx(ga,{className:"w-12 h-12"}),a&&f.jsx("span",{className:"w-3.5 h-3.5 bg-green-500 rounded-full absolute bottom-0 right-0 border-2 border-white"})]}),f.jsxs("div",{className:"flex-grow overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("p",{className:`font-semibold text-gray-800 truncate ${c>0?"font-bold":""}`,children:i==null?void 0:i.fullName}),c>0&&f.jsx("span",{className:"bg-indigo-600 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full flex-shrink-0",children:c})]}),f.jsx("p",{className:`text-sm truncate ${c>0?"text-indigo-700 font-semibold":"text-gray-500"}`,children:n.lastMessage})]})]})},Eq=({initialSelectedConversationId:n,clearInitialSelection:e})=>{const{currentUser:t,currentUserData:r}=so(),[s,i]=H.useState([]),[a,c]=H.useState(null),[h,p]=H.useState([]),[g,y]=H.useState(""),[E,x]=H.useState(!0),[P,O]=H.useState(!1),[M,X]=H.useState(!1),W=(a==null?void 0:a.participants.find(N=>N!==(t==null?void 0:t.uid)))||null,Q=W&&a?a.participantInfo[W]:null,{statusText:Y}=pO(W),ue=H.useRef(null);H.useEffect(()=>{if(!t)return;x(!0);const N=oO(t.uid,j=>{if(i(j),x(!1),n){const C=j.find(We=>We.id===n);C&&c(C),e()}});return()=>N()},[t,n,e]),H.useEffect(()=>{if(!a||!t){p([]);return}O(!0),QW(a.id,t.uid),YW(a.id,t.uid);const N=GW(a.id,j=>{p(j),O(!1)});return()=>N()},[a,t]),H.useEffect(()=>{var N;(N=ue.current)==null||N.scrollIntoView({behavior:"smooth"})},[h]);const se=async N=>{if(N.preventDefault(),!(!g.trim()||!a||!t||!(r!=null&&r.fullName))){X(!0);try{await KW(a.id,t.uid,r.fullName,g),y("")}catch(j){console.error("Failed to send message:",j)}finally{X(!1)}}},R=async N=>{if(!(!t||!a||N.senderId!==t.uid)&&window.confirm("Bn c chc mun thu hi tin nhn ny khng?"))try{await JW(a.id,N.id,t.uid,N.senderId)}catch(j){console.error("Failed to delete message:",j),alert(" c li xy ra khi thu hi tin nhn.")}},S=window.innerWidth<768,k=!S||S&&!a,D=!S||S&&a;return f.jsxs("div",{className:"flex h-full bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[k&&f.jsxs("div",{className:`w-full md:w-1/3 border-r border-gray-200 flex flex-col ${!a&&S?"":"hidden md:flex"}`,children:[f.jsx("div",{className:"p-4 border-b border-gray-200",children:f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tin nhn"})}),f.jsx("div",{className:"flex-grow overflow-y-auto",children:E?f.jsx(ar,{}):s.length>0?s.map(N=>f.jsx(wq,{convo:N,isActive:(a==null?void 0:a.id)===N.id,currentUserId:t.uid,onClick:()=>c(N)},N.id)):f.jsx("div",{className:"p-6 text-center text-gray-500",children:f.jsx("p",{children:"Cha c cuc tr chuyn no."})})})]}),D&&f.jsx("div",{className:"w-full md:w-2/3 flex flex-col",children:a?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center space-x-3",children:[S&&f.jsx("button",{onClick:()=>c(null),className:"p-2 rounded-full hover:bg-gray-100",children:f.jsx(gO,{className:"w-5 h-5"})}),f.jsx("div",{className:"relative flex-shrink-0",children:Q!=null&&Q.profileImageUrl?f.jsx("img",{src:Q.profileImageUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):f.jsx(ga,{className:"w-10 h-10"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-gray-800",children:Q==null?void 0:Q.fullName}),Y&&f.jsx("p",{className:"text-xs text-gray-500",children:Y})]})]}),f.jsxs("div",{className:"flex-grow p-4 space-y-2 overflow-y-auto bg-gray-50",children:[P?f.jsx(ar,{}):h.map(N=>f.jsxs("div",{className:`flex flex-col group ${N.senderId===(t==null?void 0:t.uid)?"items-end":"items-start"}`,children:[f.jsxs("div",{className:`flex items-end gap-2 ${N.senderId===(t==null?void 0:t.uid)?"flex-row-reverse":"flex-row"}`,children:[N.senderId===(t==null?void 0:t.uid)&&!N.deleted&&f.jsx("button",{onClick:()=>R(N),className:"opacity-0 group-hover:opacity-100 transition-opacity text-gray-400 hover:text-red-500 p-1 mb-1",children:f.jsx(JI,{className:"w-4 h-4"})}),f.jsx("div",{className:`max-w-xs md:max-w-md px-4 py-2 rounded-2xl break-words whitespace-pre-wrap ${N.deleted?"bg-transparent text-gray-500 italic":N.senderId===(t==null?void 0:t.uid)?"bg-indigo-600 text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-200"}`,children:f.jsx("p",{className:"text-sm",children:N.text})})]}),!N.deleted&&f.jsxs("div",{className:"flex items-center text-xs text-gray-400 mt-1 px-1",children:[f.jsx("span",{className:"mr-1",children:YI(N.timestamp)}),N.senderId===(t==null?void 0:t.uid)&&f.jsx(vq,{status:N.status})]})]},N.id)),f.jsx("div",{ref:ue})]}),f.jsx("div",{className:"p-4 bg-white border-t border-gray-200",children:f.jsxs("form",{onSubmit:se,className:"flex items-center space-x-3",children:[f.jsx("input",{type:"text",value:g,onChange:N=>y(N.target.value),placeholder:"Nhp tin nhn...",className:"flex-1 p-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500",disabled:M}),f.jsx("button",{type:"submit",disabled:M||!g.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors",children:f.jsx(Ag,{className:"h-6 w-6"})})]})})]}):f.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-gray-500 p-4",children:[f.jsx(mO,{className:"w-16 h-16 text-gray-300 mb-4"}),f.jsx("h3",{className:"text-xl font-semibold",children:"Chn mt cuc tr chuyn"}),f.jsx("p",{children:"Bt u lin lc vi nh tuyn dng hoc ngi lao ng ti y."})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var j1;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(j1||(j1={}));var F1;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(F1||(F1={}));var U1;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(U1||(U1={}));var B1;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(B1||(B1={}));var z1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(z1||(z1={}));var $1;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})($1||($1={}));var H1;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(H1||(H1={}));var W1;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(W1||(W1={}));var q1;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(q1||(q1={}));var G1;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(G1||(G1={}));var K1;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(K1||(K1={}));var Q1;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Q1||(Q1={}));var Y1;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Y1||(Y1={}));var J1;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(J1||(J1={}));var X1;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(X1||(X1={}));var Z1;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Z1||(Z1={}));var eN;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(eN||(eN={}));var tN;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(tN||(tN={}));var nN;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(nN||(nN={}));var rN;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(rN||(rN={}));var sN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(sN||(sN={}));var iN;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(iN||(iN={}));var oN;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(oN||(oN={}));var aN;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(aN||(aN={}));var lN;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(lN||(lN={}));var cN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(cN||(cN={}));var uN;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(uN||(uN={}));var hN;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(hN||(hN={}));var dN;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(dN||(dN={}));var fN;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(fN||(fN={}));var pN;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(pN||(pN={}));var mN;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(mN||(mN={}));var gN;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(gN||(gN={}));var _N;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(_N||(_N={}));var yN;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(yN||(yN={}));var vN;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(vN||(vN={}));var wN;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(wN||(wN={}));var EN;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(EN||(EN={}));var IN;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(IN||(IN={}));var TN;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(TN||(TN={}));var xN;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(xN||(xN={}));var bN;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(bN||(bN={}));var SN;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(SN||(SN={}));var AN;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(AN||(AN={}));var NN;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(NN||(NN={}));var CN;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(CN||(CN={}));var kN;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(kN||(kN={}));var RN;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(RN||(RN={}));var PN;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(PN||(PN={}));var DN;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(DN||(DN={}));var ON;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(ON||(ON={}));var LN;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(LN||(LN={}));var MN;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(MN||(MN={}));var VN;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(VN||(VN={}));var jN;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(jN||(jN={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var FN;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(FN||(FN={}));const UN="https://an-tam-viec-lam-website.vercel.app/api/chat",Iq=async(n,e,t)=>{console.group(" [GeminiService] Start");const r=`
        ${t.projectContext}

        DI Y L D LIU HIN TI CA NN TNG:
        - Cng vic mu: ${JSON.stringify(t.jobs.slice(0,3))}
        - Bo him: ${JSON.stringify(t.insuranceInfo)}
        
        HY TR LI NGN GN, THN THIN.
    `,i=e.filter((c,h)=>!0).map(c=>({role:c.author===cl.User?"user":"model",parts:[{text:c.text}]})),a=(c,h,p)=>Promise.race([fetch(c,h),new Promise((g,y)=>setTimeout(()=>y(new Error(`Request timed out after ${p}ms`)),p))]);try{console.log(` [Step 1] Th gi Server: ${UN}`);const c=await a(UN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,history:i,systemInstruction:r})},15e3),h=c.headers.get("content-type");if(c.ok&&h&&h.includes("application/json")){const g=await c.json();if(g.text)return console.log(" [Backend Vercel] Thnh cng!"),console.groupEnd(),g.text}let p=`Backend Status: ${c.status}`;try{const g=await c.json();g.error&&(p+=` - ${g.error}`)}catch{}throw new Error(p)}catch(c){return console.warn(` [Backend Failed] ${c instanceof Error?c.message:"Unknown error"}. Chuyn sang Client SDK.`),console.log(" [Step 2] Gi trc tip t Client..."),console.error(" [Client SDK] Thiu API_KEY trong bin mi trng (process.env.API_KEY)."),console.groupEnd()," H thng ang bo tr kt ni (Missing Configuration). Vui lng th li sau."}},Tq=async(n,e)=>e.length?(console.warn("Missing API_KEY for analysis"),[]):[],XI="ai_conversations",xq=(n,e)=>He.collection("users").doc(n).collection(XI).orderBy("timestamp","asc").onSnapshot(s=>{const i=[];s.forEach(a=>{const c=a.data();i.push({author:c.author,text:c.text})}),e(i)},s=>{console.error("Error fetching AI chat history:",s),e([])}),BN=async(n,e)=>{try{await He.collection("users").doc(n).collection(XI).add({text:e.text,author:e.author,timestamp:Yi()})}catch(t){console.error("Error saving AI chat message:",t)}},bq=async n=>{try{const t=await He.collection("users").doc(n).collection(XI).get(),r=He.batch();t.docs.forEach(s=>{r.delete(s.ref)}),await r.commit()}catch(e){throw console.error("Error clearing AI chat history:",e),e}},_O=({className:n="w-8 h-8"})=>f.jsx("div",{className:`flex items-center justify-center rounded-full bg-indigo-500 text-white ${n}`,children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 0011 7v10zM4 17a1 1 0 001.447.894l4-2A1 1 0 0010 15V5a1 1 0 00-1.447-.894l-4 2A1 1 0 004 7v10z"})})});function ZI(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Xl=ZI();function yO(n){Xl=n}const vO=/[&<>"']/,Sq=new RegExp(vO.source,"g"),wO=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Aq=new RegExp(wO.source,"g"),Nq={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},zN=n=>Nq[n];function Cr(n,e){if(e){if(vO.test(n))return n.replace(Sq,zN)}else if(wO.test(n))return n.replace(Aq,zN);return n}const Cq=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function kq(n){return n.replace(Cq,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Rq=/(^|[^\[])\^/g;function ft(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(Rq,"$1"),t=t.replace(s,a),r},getRegex:()=>new RegExp(t,e)};return r}function $N(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Nd={exec:()=>null};function HN(n,e){const t=n.replace(/\|/g,(i,a,c)=>{let h=!1,p=a;for(;--p>=0&&c[p]==="\\";)h=!h;return h?"|":" |"}),r=t.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function fm(n,e,t){const r=n.length;if(r===0)return"";let s=0;for(;s<r&&n.charAt(r-s-1)===e;)s++;return n.slice(0,r-s)}function Pq(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function WN(n,e,t,r){const s=e.href,i=e.title?Cr(e.title):null,a=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const c={type:"link",raw:t,href:s,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,c}return{type:"image",raw:t,href:s,title:i,text:Cr(a)}}function Dq(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(s=>{const i=s.match(/^\s+/);if(i===null)return s;const[a]=i;return a.length>=r.length?s.slice(r.length):s}).join(`
`)}class Tg{constructor(e){bt(this,"options");bt(this,"rules");bt(this,"lexer");this.options=e||Xl}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:fm(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=Dq(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=fm(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=fm(r.replace(/^ *>[ \t]?/gm,""),`
`);const s=this.lexer.state.top;this.lexer.state.top=!0;const i=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const s=r.length>1,i={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const a=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let c="",h="",p=!1;for(;e;){let g=!1;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let y=t[2].split(`
`,1)[0].replace(/^\t+/,X=>" ".repeat(3*X.length)),E=e.split(`
`,1)[0],x=0;this.options.pedantic?(x=2,h=y.trimStart()):(x=t[2].search(/[^ ]/),x=x>4?1:x,h=y.slice(x),x+=t[1].length);let P=!1;if(!y&&/^ *$/.test(E)&&(c+=E+`
`,e=e.substring(E.length+1),g=!0),!g){const X=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),W=new RegExp(`^ {0,${Math.min(3,x-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Q=new RegExp(`^ {0,${Math.min(3,x-1)}}(?:\`\`\`|~~~)`),Y=new RegExp(`^ {0,${Math.min(3,x-1)}}#`);for(;e;){const ue=e.split(`
`,1)[0];if(E=ue,this.options.pedantic&&(E=E.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Q.test(E)||Y.test(E)||X.test(E)||W.test(e))break;if(E.search(/[^ ]/)>=x||!E.trim())h+=`
`+E.slice(x);else{if(P||y.search(/[^ ]/)>=4||Q.test(y)||Y.test(y)||W.test(y))break;h+=`
`+E}!P&&!E.trim()&&(P=!0),c+=ue+`
`,e=e.substring(ue.length+1),y=E.slice(x)}}i.loose||(p?i.loose=!0:/\n *\n *$/.test(c)&&(p=!0));let O=null,M;this.options.gfm&&(O=/^\[[ xX]\] /.exec(h),O&&(M=O[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),i.items.push({type:"list_item",raw:c,task:!!O,checked:M,loose:!1,text:h,tokens:[]}),i.raw+=c}i.items[i.items.length-1].raw=c.trimEnd(),i.items[i.items.length-1].text=h.trimEnd(),i.raw=i.raw.trimEnd();for(let g=0;g<i.items.length;g++)if(this.lexer.state.top=!1,i.items[g].tokens=this.lexer.blockTokens(i.items[g].text,[]),!i.loose){const y=i.items[g].tokens.filter(x=>x.type==="space"),E=y.length>0&&y.some(x=>/\n.*\n/.test(x.raw));i.loose=E}if(i.loose)for(let g=0;g<i.items.length;g++)i.items[g].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:i}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=HN(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),i=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===s.length){for(const c of s)/^ *-+: *$/.test(c)?a.align.push("right"):/^ *:-+: *$/.test(c)?a.align.push("center"):/^ *:-+ *$/.test(c)?a.align.push("left"):a.align.push(null);for(const c of r)a.header.push({text:c,tokens:this.lexer.inline(c)});for(const c of i)a.rows.push(HN(c,a.header.length).map(h=>({text:h,tokens:this.lexer.inline(h)})));return a}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Cr(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=fm(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{const a=Pq(t[2],"()");if(a>-1){const h=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,h).trim(),t[3]=""}}let s=t[2],i="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);a&&(s=a[1],i=a[3])}else i=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(r)?s=s.slice(1):s=s.slice(1,-1)),WN(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const s=(r[2]||r[1]).replace(/\s+/g," "),i=t[s.toLowerCase()];if(!i){const a=r[0].charAt(0);return{type:"text",raw:a,text:a}}return WN(r,i,r[0],this.lexer)}}emStrong(e,t,r=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const a=[...s[0]].length-1;let c,h,p=a,g=0;const y=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(y.lastIndex=0,t=t.slice(-1*e.length+a);(s=y.exec(t))!=null;){if(c=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!c)continue;if(h=[...c].length,s[3]||s[4]){p+=h;continue}else if((s[5]||s[6])&&a%3&&!((a+h)%3)){g+=h;continue}if(p-=h,p>0)continue;h=Math.min(h,h+p+g);const E=[...s[0]][0].length,x=e.slice(0,a+s.index+E+h);if(Math.min(a,h)%2){const O=x.slice(1,-1);return{type:"em",raw:x,text:O,tokens:this.lexer.inlineTokens(O)}}const P=x.slice(2,-2);return{type:"strong",raw:x,text:P,tokens:this.lexer.inlineTokens(P)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),i=/^ /.test(r)&&/ $/.test(r);return s&&i&&(r=r.substring(1,r.length-1)),r=Cr(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,s;return t[2]==="@"?(r=Cr(t[1]),s="mailto:"+r):(r=Cr(t[1]),s=r),{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let s,i;if(t[2]==="@")s=Cr(t[0]),i="mailto:"+s;else{let a;do a=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(a!==t[0]);s=Cr(t[0]),t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=Cr(t[0]),{type:"text",raw:t[0],text:r}}}}const Oq=/^(?: *(?:\n|$))+/,Lq=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Mq=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Wf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Vq=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,EO=/(?:[*+-]|\d{1,9}[.)])/,IO=ft(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,EO).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),eT=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jq=/^[^\n]+/,tT=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Fq=ft(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",tT).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Uq=ft(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,EO).getRegex(),j_="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",nT=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Bq=ft("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",nT).replace("tag",j_).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),TO=ft(eT).replace("hr",Wf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j_).getRegex(),zq=ft(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",TO).getRegex(),rT={blockquote:zq,code:Lq,def:Fq,fences:Mq,heading:Vq,hr:Wf,html:Bq,lheading:IO,list:Uq,newline:Oq,paragraph:TO,table:Nd,text:jq},qN=ft("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Wf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j_).getRegex(),$q={...rT,table:qN,paragraph:ft(eT).replace("hr",Wf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",qN).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j_).getRegex()},Hq={...rT,html:ft(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",nT).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Nd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ft(eT).replace("hr",Wf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",IO).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},xO=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Wq=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,bO=/^( {2,}|\\)\n(?!\s*$)/,qq=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,qf="\\p{P}\\p{S}",Gq=ft(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,qf).getRegex(),Kq=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Qq=ft(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,qf).getRegex(),Yq=ft("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,qf).getRegex(),Jq=ft("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,qf).getRegex(),Xq=ft(/\\([punct])/,"gu").replace(/punct/g,qf).getRegex(),Zq=ft(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),eG=ft(nT).replace("(?:-->|$)","-->").getRegex(),tG=ft("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",eG).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),xg=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,nG=ft(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",xg).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),SO=ft(/^!?\[(label)\]\[(ref)\]/).replace("label",xg).replace("ref",tT).getRegex(),AO=ft(/^!?\[(ref)\](?:\[\])?/).replace("ref",tT).getRegex(),rG=ft("reflink|nolink(?!\\()","g").replace("reflink",SO).replace("nolink",AO).getRegex(),sT={_backpedal:Nd,anyPunctuation:Xq,autolink:Zq,blockSkip:Kq,br:bO,code:Wq,del:Nd,emStrongLDelim:Qq,emStrongRDelimAst:Yq,emStrongRDelimUnd:Jq,escape:xO,link:nG,nolink:AO,punctuation:Gq,reflink:SO,reflinkSearch:rG,tag:tG,text:qq,url:Nd},sG={...sT,link:ft(/^!?\[(label)\]\((.*?)\)/).replace("label",xg).getRegex(),reflink:ft(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",xg).getRegex()},o0={...sT,escape:ft(xO).replace("])","~|])").getRegex(),url:ft(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},iG={...o0,br:ft(bO).replace("{2,}","*").getRegex(),text:ft(o0.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},pm={normal:rT,gfm:$q,pedantic:Hq},Xh={normal:sT,gfm:o0,breaks:iG,pedantic:sG};class Xs{constructor(e){bt(this,"tokens");bt(this,"options");bt(this,"state");bt(this,"tokenizer");bt(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Xl,this.options.tokenizer=this.options.tokenizer||new Tg,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:pm.normal,inline:Xh.normal};this.options.pedantic?(t.block=pm.pedantic,t.inline=Xh.pedantic):this.options.gfm&&(t.block=pm.gfm,this.options.breaks?t.inline=Xh.breaks:t.inline=Xh.gfm),this.tokenizer.rules=t}static get rules(){return{block:pm,inline:Xh}}static lex(e,t){return new Xs(t).lex(e)}static lexInline(e,t){return new Xs(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(c,h,p)=>h+"    ".repeat(p.length));let r,s,i,a;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(r=c.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(i=e,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const h=e.slice(1);let p;this.options.extensions.startBlock.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(i=e.substring(0,c+1))}if(this.state.top&&(r=this.tokenizer.paragraph(i))){s=t[t.length-1],a&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),a=i.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,i,a=e,c,h,p;if(this.tokens.links){const g=Object.keys(this.tokens.links);if(g.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)g.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,c.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(h||(p=""),h=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(g=>(r=g.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,a,p)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(i=e,this.options.extensions&&this.options.extensions.startInline){let g=1/0;const y=e.slice(1);let E;this.options.extensions.startInline.forEach(x=>{E=x.call({lexer:this},y),typeof E=="number"&&E>=0&&(g=Math.min(g,E))}),g<1/0&&g>=0&&(i=e.substring(0,g+1))}if(r=this.tokenizer.inlineText(i)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(p=r.raw.slice(-1)),h=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(e){const g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return t}}class bg{constructor(e){bt(this,"options");this.options=e||Xl}code(e,t,r){var i;const s=(i=(t||"").match(/^\S*/))==null?void 0:i[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+Cr(s)+'">'+(r?e:Cr(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:Cr(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const s=t?"ol":"ul",i=t&&r!==1?' start="'+r+'"':"";return"<"+s+i+`>
`+e+"</"+s+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const s=$N(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+r+"</a>",i}image(e,t,r){const s=$N(e);if(s===null)return r;e=s;let i=`<img src="${e}" alt="${r}"`;return t&&(i+=` title="${t}"`),i+=">",i}text(e){return e}}class iT{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class Zs{constructor(e){bt(this,"options");bt(this,"renderer");bt(this,"textRenderer");this.options=e||Xl,this.options.renderer=this.options.renderer||new bg,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new iT}static parse(e,t){return new Zs(t).parse(e)}static parseInline(e,t){return new Zs(t).parseInline(e)}parse(e,t=!0){let r="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const a=i,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=c||"";continue}}switch(i.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const a=i;r+=this.renderer.heading(this.parseInline(a.tokens),a.depth,kq(this.parseInline(a.tokens,this.textRenderer)));continue}case"code":{const a=i;r+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=i;let c="",h="";for(let g=0;g<a.header.length;g++)h+=this.renderer.tablecell(this.parseInline(a.header[g].tokens),{header:!0,align:a.align[g]});c+=this.renderer.tablerow(h);let p="";for(let g=0;g<a.rows.length;g++){const y=a.rows[g];h="";for(let E=0;E<y.length;E++)h+=this.renderer.tablecell(this.parseInline(y[E].tokens),{header:!1,align:a.align[E]});p+=this.renderer.tablerow(h)}r+=this.renderer.table(c,p);continue}case"blockquote":{const a=i,c=this.parse(a.tokens);r+=this.renderer.blockquote(c);continue}case"list":{const a=i,c=a.ordered,h=a.start,p=a.loose;let g="";for(let y=0;y<a.items.length;y++){const E=a.items[y],x=E.checked,P=E.task;let O="";if(E.task){const M=this.renderer.checkbox(!!x);p?E.tokens.length>0&&E.tokens[0].type==="paragraph"?(E.tokens[0].text=M+" "+E.tokens[0].text,E.tokens[0].tokens&&E.tokens[0].tokens.length>0&&E.tokens[0].tokens[0].type==="text"&&(E.tokens[0].tokens[0].text=M+" "+E.tokens[0].tokens[0].text)):E.tokens.unshift({type:"text",text:M+" "}):O+=M+" "}O+=this.parse(E.tokens,p),g+=this.renderer.listitem(O,P,!!x)}r+=this.renderer.list(g,c,h);continue}case"html":{const a=i;r+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=i;r+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=i,c=a.tokens?this.parseInline(a.tokens):a.text;for(;s+1<e.length&&e[s+1].type==="text";)a=e[++s],c+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);r+=t?this.renderer.paragraph(c):c;continue}default:{const a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=a||"";continue}}switch(i.type){case"escape":{const a=i;r+=t.text(a.text);break}case"html":{const a=i;r+=t.html(a.text);break}case"link":{const a=i;r+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{const a=i;r+=t.image(a.href,a.title,a.text);break}case"strong":{const a=i;r+=t.strong(this.parseInline(a.tokens,t));break}case"em":{const a=i;r+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{const a=i;r+=t.codespan(a.text);break}case"br":{r+=t.br();break}case"del":{const a=i;r+=t.del(this.parseInline(a.tokens,t));break}case"text":{const a=i;r+=t.text(a.text);break}default:{const a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}}class Cd{constructor(e){bt(this,"options");this.options=e||Xl}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}bt(Cd,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var zl,a0,NO;class oG{constructor(...e){mb(this,zl);bt(this,"defaults",ZI());bt(this,"options",this.setOptions);bt(this,"parse",tm(this,zl,a0).call(this,Xs.lex,Zs.parse));bt(this,"parseInline",tm(this,zl,a0).call(this,Xs.lexInline,Zs.parseInline));bt(this,"Parser",Zs);bt(this,"Renderer",bg);bt(this,"TextRenderer",iT);bt(this,"Lexer",Xs);bt(this,"Tokenizer",Tg);bt(this,"Hooks",Cd);this.use(...e)}walkTokens(e,t){var s,i;let r=[];for(const a of e)switch(r=r.concat(t.call(this,a)),a.type){case"table":{const c=a;for(const h of c.header)r=r.concat(this.walkTokens(h.tokens,t));for(const h of c.rows)for(const p of h)r=r.concat(this.walkTokens(p.tokens,t));break}case"list":{const c=a;r=r.concat(this.walkTokens(c.items,t));break}default:{const c=a;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(h=>{const p=c[h].flat(1/0);r=r.concat(this.walkTokens(p,t))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const a=t.renderers[i.name];a?t.renderers[i.name]=function(...c){let h=i.renderer.apply(this,c);return h===!1&&(h=a.apply(this,c)),h}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=t[i.level];a?a.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),s.extensions=t),r.renderer){const i=this.defaults.renderer||new bg(this.defaults);for(const a in r.renderer){if(!(a in i))throw new Error(`renderer '${a}' does not exist`);if(a==="options")continue;const c=a,h=r.renderer[c],p=i[c];i[c]=(...g)=>{let y=h.apply(i,g);return y===!1&&(y=p.apply(i,g)),y||""}}s.renderer=i}if(r.tokenizer){const i=this.defaults.tokenizer||new Tg(this.defaults);for(const a in r.tokenizer){if(!(a in i))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;const c=a,h=r.tokenizer[c],p=i[c];i[c]=(...g)=>{let y=h.apply(i,g);return y===!1&&(y=p.apply(i,g)),y}}s.tokenizer=i}if(r.hooks){const i=this.defaults.hooks||new Cd;for(const a in r.hooks){if(!(a in i))throw new Error(`hook '${a}' does not exist`);if(a==="options")continue;const c=a,h=r.hooks[c],p=i[c];Cd.passThroughHooks.has(a)?i[c]=g=>{if(this.defaults.async)return Promise.resolve(h.call(i,g)).then(E=>p.call(i,E));const y=h.call(i,g);return p.call(i,y)}:i[c]=(...g)=>{let y=h.apply(i,g);return y===!1&&(y=p.apply(i,g)),y}}s.hooks=i}if(r.walkTokens){const i=this.defaults.walkTokens,a=r.walkTokens;s.walkTokens=function(c){let h=[];return h.push(a.call(this,c)),i&&(h=h.concat(i.call(this,c))),h}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Xs.lex(e,t??this.defaults)}parser(e,t){return Zs.parse(e,t??this.defaults)}}zl=new WeakSet,a0=function(e,t){return(r,s)=>{const i={...s},a={...this.defaults,...i};this.defaults.async===!0&&i.async===!1&&(a.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),a.async=!0);const c=tm(this,zl,NO).call(this,!!a.silent,!!a.async);if(typeof r>"u"||r===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(r):r).then(h=>e(h,a)).then(h=>a.hooks?a.hooks.processAllTokens(h):h).then(h=>a.walkTokens?Promise.all(this.walkTokens(h,a.walkTokens)).then(()=>h):h).then(h=>t(h,a)).then(h=>a.hooks?a.hooks.postprocess(h):h).catch(c);try{a.hooks&&(r=a.hooks.preprocess(r));let h=e(r,a);a.hooks&&(h=a.hooks.processAllTokens(h)),a.walkTokens&&this.walkTokens(h,a.walkTokens);let p=t(h,a);return a.hooks&&(p=a.hooks.postprocess(p)),p}catch(h){return c(h)}}},NO=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+Cr(r.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(r);throw r}};const Bl=new oG;function ut(n,e){return Bl.parse(n,e)}ut.options=ut.setOptions=function(n){return Bl.setOptions(n),ut.defaults=Bl.defaults,yO(ut.defaults),ut};ut.getDefaults=ZI;ut.defaults=Xl;ut.use=function(...n){return Bl.use(...n),ut.defaults=Bl.defaults,yO(ut.defaults),ut};ut.walkTokens=function(n,e){return Bl.walkTokens(n,e)};ut.parseInline=Bl.parseInline;ut.Parser=Zs;ut.parser=Zs.parse;ut.Renderer=bg;ut.TextRenderer=iT;ut.Lexer=Xs;ut.lexer=Xs.lex;ut.Tokenizer=Tg;ut.Hooks=Cd;ut.parse=ut;ut.options;ut.setOptions;ut.use;ut.walkTokens;ut.parseInline;const aG=ut;Zs.parse;Xs.lex;const lG=({content:n})=>{const[e,t]=H.useState("");return H.useEffect(()=>{(async()=>{try{const s=await aG(n);t(s)}catch(s){console.error("Markdown parse error",s),t(n)}})()},[n]),f.jsx("div",{className:"markdown-content text-sm",dangerouslySetInnerHTML:{__html:e}})},cG=({message:n})=>{const e=n.author===cl.User;return f.jsxs("div",{className:`flex items-start gap-3 ${e?"justify-end":""}`,children:[!e&&f.jsx(_O,{}),f.jsx("div",{className:`max-w-[85%] md:max-w-lg px-4 py-3 rounded-2xl shadow-sm ${e?"bg-blue-500 text-white rounded-br-none":"bg-white border border-gray-100 text-gray-800 rounded-bl-none"}`,children:e?f.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.text}):f.jsx(lG,{content:n.text})}),e&&f.jsx(ga,{})]})},uG=({allJobs:n})=>{const{currentUser:e}=so(),[t,r]=H.useState([]),[s,i]=H.useState(""),[a,c]=H.useState(!1),h=H.useRef(null),p={author:cl.Bot,text:"Xin cho! Ti c th gip g cho bn v cng vic hoc chnh sch bo him x hi?"};H.useEffect(()=>{if(!e)return;const x=xq(e.uid,P=>{P.length===0?r([p]):r(P)});return()=>x()},[e]);const g=()=>{var x;(x=h.current)==null||x.scrollIntoView({behavior:"smooth"})};H.useEffect(g,[t,a]);const y=async x=>{if(x.preventDefault(),!s.trim()||a||!e)return;const P=s,O={author:cl.User,text:P};i(""),c(!0);try{await BN(e.uid,O);const M={jobs:n,insuranceInfo:uO,projectContext:hq},X=[...t,O],W=await Iq(P,X,M),Q={author:cl.Bot,text:W};await BN(e.uid,Q)}catch(M){console.error("Chat error:",M);const X={author:cl.Bot,text:"Xin li, ti ang gp s c kt ni. Vui lng th li sau."};r(W=>[...W,X])}finally{c(!1)}},E=async()=>{e&&window.confirm("Bn c chc mun xa ton b lch s tr chuyn khng?")&&(await bq(e.uid),r([p]))};return f.jsxs("div",{className:"flex flex-col h-full bg-gray-50 rounded-lg shadow-md overflow-hidden relative",children:[f.jsx("style",{children:`
            .markdown-content ul {
                list-style-type: disc;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content ol {
                list-style-type: decimal;
                margin-left: 1.5em;
                margin-bottom: 0.75em;
                margin-top: 0.25em;
            }
            .markdown-content li {
                margin-bottom: 0.25em;
                line-height: 1.5;
            }
            .markdown-content p {
                margin-bottom: 0.75em;
                line-height: 1.6;
            }
            .markdown-content p:last-child {
                margin-bottom: 0;
            }
            .markdown-content strong {
                font-weight: 700;
                color: #111827; /* gray-900 */
            }
            .markdown-content em {
                font-style: italic;
            }
            .markdown-content h1, .markdown-content h2, .markdown-content h3 {
                font-weight: 700;
                margin-top: 1em;
                margin-bottom: 0.5em;
                color: #1f2937; /* gray-800 */
                font-size: 1em; /* Keep text size consistent but bold */
            }
            .markdown-content a {
                color: #2563eb; /* blue-600 */
                text-decoration: underline;
            }
        `}),f.jsxs("div",{className:"px-4 py-3 bg-white border-b flex justify-between items-center shadow-sm z-10",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("span",{className:"relative flex h-3 w-3",children:[f.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),f.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tr l AI An Tm"})]}),t.length>1&&f.jsx("button",{onClick:E,className:"text-gray-400 hover:text-red-500 transition-colors p-1.5 rounded-full hover:bg-gray-100",title:"Xa lch s tr chuyn",children:f.jsx(JI,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto bg-slate-50",children:[t.map((x,P)=>f.jsx(cG,{message:x},P)),a&&f.jsxs("div",{className:"flex items-start gap-3 animate-pulse",children:[f.jsx(_O,{}),f.jsx("div",{className:"bg-white border border-gray-100 text-gray-800 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm",children:f.jsxs("div",{className:"flex items-center space-x-1.5",children:[f.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),f.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),f.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce"})]})})]}),f.jsx("div",{ref:h})]}),f.jsx("div",{className:"p-4 bg-white border-t shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:f.jsxs("form",{onSubmit:y,className:"flex items-center space-x-3",children:[f.jsx("input",{type:"text",value:s,onChange:x=>i(x.target.value),placeholder:"Hi v vic lm, bo him...",className:"flex-1 p-3 px-4 border border-gray-300 rounded-full focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 shadow-sm",disabled:a}),f.jsx("button",{type:"submit",disabled:a||!s.trim(),className:"bg-indigo-600 text-white rounded-full p-3 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-all duration-300 shadow-md hover:shadow-lg transform active:scale-95",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]})},hG=async(n,e,t="",r="")=>{if(e.userType!=="WORKER")throw new Error("Only workers can apply for jobs.");if(!e.fullName)throw new Error("Worker must have a full name to apply.");const s=`${n.id}_${e.uid}`,i=He.collection("applications").doc(s);if((await i.get()).exists)throw new Error("You have already applied for this job.");const c={jobId:n.id,jobTitle:n.title,workerId:e.uid,workerName:e.fullName,workerProfileImageUrl:e.profileImageUrl||null,employerId:n.employerId,employerName:n.employerName,employerProfileImageUrl:n.employerProfileUrl||null,applicationDate:Yi(),status:"pending",cvUrl:e.cvUrl||null,cvName:e.cvName||null,introduction:t,contactPhoneNumber:r||e.phoneNumber||""},h=He.batch();h.set(i,c);const p=He.collection("jobs").doc(n.id);h.update(p,{applicantCount:rO(1)}),await h.commit(),await QI(n.employerId,Mi.NEW_APPLICATION,`${e.fullName} va ng tuyn vo cng vic: "${n.title}"`,"/profile")},dG=async(n,e)=>{const t=`${n}_${e}`;return(await He.collection("applications").doc(t).get()).exists},fG=(n,e)=>He.collection("applications").where("employerId","==",n).onSnapshot(i=>{const a=[];i.forEach(c=>{var y;const h=c.data(),p=(y=h.applicationDate)!=null&&y.toDate?h.applicationDate.toDate().toISOString():new Date().toISOString(),g={id:c.id,jobId:h.jobId,jobTitle:h.jobTitle,workerId:h.workerId,workerName:h.workerName,employerName:h.employerName||"Khng r",workerProfileImageUrl:h.workerProfileImageUrl,employerId:h.employerId,employerProfileImageUrl:h.employerProfileImageUrl,applicationDate:p,status:h.status,cvUrl:h.cvUrl||null,cvName:h.cvName||null,introduction:h.introduction||"",contactPhoneNumber:h.contactPhoneNumber||""};a.push(g)}),a.sort((c,h)=>new Date(h.applicationDate).getTime()-new Date(c.applicationDate).getTime()),e(a)},i=>{console.error("Error fetching employer applications: ",i),e([])}),pG=(n,e)=>He.collection("applications").where("workerId","==",n).onSnapshot(i=>{const a=[];i.forEach(c=>{var y;const h=c.data(),p=(y=h.applicationDate)!=null&&y.toDate?h.applicationDate.toDate().toISOString():new Date().toISOString(),g={id:c.id,jobId:h.jobId,jobTitle:h.jobTitle,workerId:h.workerId,workerName:h.workerName,employerName:h.employerName||"Khng r",workerProfileImageUrl:h.workerProfileImageUrl,employerId:h.employerId,employerProfileImageUrl:h.employerProfileImageUrl,applicationDate:p,status:h.status,cvUrl:h.cvUrl||null,cvName:h.cvName||null,introduction:h.introduction||"",contactPhoneNumber:h.contactPhoneNumber||""};a.push(g)}),a.sort((c,h)=>new Date(h.applicationDate).getTime()-new Date(c.applicationDate).getTime()),e(a)},i=>{console.error("Error fetching worker applications: ",i),e([])}),mG=async(n,e)=>{await He.collection("applications").doc(n.id).update({status:e});const r=e==="accepted"?Mi.APPLICATION_ACCEPTED:Mi.APPLICATION_REJECTED,s=e==="accepted"?`Chc mng! n ng tuyn ca bn cho cng vic "${n.jobTitle}"  c chp nhn.`:`Rt tic, n ng tuyn ca bn cho cng vic "${n.jobTitle}"  b t chi.`;await QI(n.workerId,r,s,"/profile")},gG=({job:n,onClose:e,onViewOnMap:t})=>{const{currentUser:r,currentUserData:s}=so(),[i,a]=H.useState(!1),[c,h]=H.useState(!1),[p,g]=H.useState(""),[y,E]=H.useState(!1),[x,P]=H.useState(""),[O,M]=H.useState("");H.useEffect(()=>{s!=null&&s.phoneNumber&&P(s.phoneNumber)},[s]),H.useEffect(()=>{const Y=se=>{se.key==="Escape"&&e()};return document.body.style.overflow="hidden",window.addEventListener("keydown",Y),(async()=>{if(r&&(s==null?void 0:s.userType)==="WORKER"){const se=await dG(n.id,r.uid);h(se)}})(),()=>{window.removeEventListener("keydown",Y),document.body.style.overflow="unset"}},[e,n.id,r,s]);const X=()=>{if(!r||!s){g("Bn cn ng nhp  ng tuyn.");return}E(!0)},W=async Y=>{if(Y.preventDefault(),!(!r||!s)){if(!x.trim()){g("Vui lng nhp s in thoi lin h.");return}a(!0),g("");try{await hG(n,s,O,x),h(!0),E(!1)}catch(ue){console.error("Application failed:",ue),g(" c li xy ra khi ng tuyn. Vui lng th li.")}finally{a(!1)}}},Q=(s==null?void 0:s.uid)===n.employerId;return f.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center",role:"dialog","aria-modal":"true",children:[f.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:e}),f.jsxs("div",{className:"bg-white w-full md:w-[90%] md:max-w-3xl h-[90vh] md:h-auto md:max-h-[85vh] rounded-t-2xl md:rounded-2xl shadow-2xl flex flex-col relative z-10 animate-slide-up md:animate-fade-in overflow-hidden",onClick:Y=>Y.stopPropagation(),children:[f.jsx("div",{className:"md:hidden w-full flex justify-center pt-3 pb-1 bg-white cursor-pointer",onClick:e,children:f.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),f.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-start bg-white flex-shrink-0",children:[f.jsxs("div",{className:"flex gap-4 overflow-hidden",children:[n.employerProfileUrl?f.jsx("img",{src:n.employerProfileUrl,alt:"logo",className:"w-14 h-14 rounded-lg object-cover border border-gray-100 flex-shrink-0"}):f.jsx("div",{className:"w-14 h-14 rounded-lg bg-indigo-50 flex items-center justify-center flex-shrink-0",children:f.jsx(ii,{className:"w-8 h-8 text-indigo-500"})}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate leading-tight",children:n.title}),f.jsx("p",{className:"text-gray-500 text-sm truncate mt-1",children:n.employerName}),f.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[f.jsx("span",{className:"bg-green-100 text-green-700 text-xs font-bold px-2 py-0.5 rounded-md",children:aO(n.payRate,n.payType)}),f.jsxs("span",{className:"text-gray-400 text-xs flex items-center",children:[f.jsx(cO,{className:"w-3 h-3 mr-1"}),new Date(n.createdAt).toLocaleDateString("vi-VN")]})]})]})]}),f.jsx("button",{onClick:e,className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-500 transition-colors flex-shrink-0 ml-2",children:f.jsx(V_,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-white",children:[f.jsxs("div",{className:"flex items-start gap-3 mb-6 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[f.jsx(Go,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"a im lm vic"}),f.jsx("p",{className:"text-sm text-gray-600",children:n.addressString}),f.jsx("button",{onClick:t,className:"text-xs text-indigo-600 font-semibold hover:underline mt-1",children:"Xem trn bn "})]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"M t cng vic"}),f.jsx("div",{className:"text-gray-600 leading-relaxed whitespace-pre-wrap text-sm md:text-base",children:n.description})]}),f.jsxs("div",{className:"flex flex-wrap gap-2 mb-8",children:[f.jsx("span",{className:"bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-medium border border-indigo-100",children:n.jobType}),n.payType&&f.jsxs("span",{className:"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium border border-gray-200",children:["Tr lng ",n.payType.toLowerCase()]})]}),y&&!c&&f.jsxs("div",{className:"mb-6 bg-indigo-50 p-5 rounded-xl border border-indigo-100 animate-fade-in",children:[f.jsxs("h3",{className:"font-bold text-indigo-800 mb-4 flex items-center text-lg",children:[f.jsx(Ag,{className:"w-5 h-5 mr-2"}),"Thng tin ng tuyn"]}),f.jsxs("form",{onSubmit:W,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{htmlFor:"contactPhone",className:"block text-sm font-medium text-gray-700 mb-1",children:["S in thoi lin h ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"tel",id:"contactPhone",value:x,onChange:Y=>P(Y.target.value),className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Nhp s in thoi...",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"introduction",className:"block text-sm font-medium text-gray-700 mb-1",children:"Li nhn (Ty chn)"}),f.jsx("textarea",{id:"introduction",value:O,onChange:Y=>M(Y.target.value),rows:3,className:"w-full p-3 border border-indigo-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none",placeholder:"Gii thiu ngn gn v kinh nghim ca bn..."})]}),p&&f.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded border border-red-100",children:p}),f.jsxs("div",{className:"flex gap-3 pt-2",children:[f.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 font-semibold flex-1",children:"Hy"}),f.jsx("button",{type:"submit",disabled:i,className:"flex-[2] bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-400 flex items-center justify-center shadow-md",children:i?f.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Gi h s"})]})]})]})]}),!y&&f.jsxs("div",{className:"p-4 bg-white border-t border-gray-100 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] flex-shrink-0",children:[(s==null?void 0:s.userType)==="WORKER"&&!Q&&f.jsx("button",{onClick:X,disabled:i||c,className:`flex-1 font-bold py-3 px-4 rounded-xl transition-all duration-300 flex items-center justify-center shadow-md active:scale-95 ${c?"bg-green-100 text-green-700 cursor-default":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:c?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mr-2",children:""}),"  ng tuyn"]}):"ng tuyn ngay"}),Q&&f.jsx("div",{className:"flex-1 bg-gray-100 text-gray-500 font-medium py-3 px-4 rounded-xl text-center text-sm flex items-center justify-center",children:"y l bi ng ca bn"}),f.jsx("button",{onClick:e,className:"px-5 bg-white text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-50 border border-gray-200 transition-colors active:scale-95",children:"ng"})]})]}),f.jsx("style",{children:`
        @keyframes slide-up {
            0% { transform: translateY(100%); }
            100% { transform: translateY(0); }
        }
        .animate-slide-up {
            animation: slide-up 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        /* Override fade-in for desktop to be simpler */
        @media (min-width: 768px) {
            .animate-slide-up {
                animation: fade-in 0.2s ease-out forwards;
            }
        }
    `})]})},_G=({locations:n,types:e,locationFilter:t,typeFilter:r,onLocationChange:s,onTypeChange:i,onReset:a})=>f.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"location-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"a im"}),f.jsxs("select",{id:"location-filter",value:t,onChange:c=>s(c.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${t?"text-gray-900 font-medium":"text-gray-500"}`,children:[f.jsx("option",{value:"",children:"Tt c a im"}),n.map(c=>f.jsx("option",{value:c,children:c},c))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"type-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi hnh"}),f.jsxs("select",{id:"type-filter",value:r,onChange:c=>i(c.target.value),className:`w-full p-2.5 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-300 ${r?"text-gray-900 font-medium":"text-gray-500"}`,children:[f.jsx("option",{value:"",children:"Tt c loi hnh"}),e.map(c=>f.jsx("option",{value:c,children:c},c))]})]}),f.jsx("div",{className:"flex items-end",children:f.jsx("button",{onClick:a,className:"w-full bg-gray-100 text-gray-700 font-semibold py-2.5 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"Xa b lc"})})]})}),yG=({className:n="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),vG=({job:n,onJobSelect:e})=>f.jsxs("div",{className:"p-1 font-sans",children:[f.jsx("h4",{className:"font-bold text-sm text-gray-800",children:n.title}),f.jsx("p",{className:"text-xs text-gray-600 mb-1",children:n.employerName}),f.jsx("button",{onClick:()=>e(n),className:"text-xs font-semibold text-indigo-600 hover:text-indigo-800 transition-colors",children:"Xem chi tit"})]}),wG=({jobs:n,onJobSelect:e,focusedJobId:t,onFocusComplete:r,userLocation:s})=>{const i=H.useRef(null),a=H.useRef({map:null,markers:{},userMarker:null,popupRoots:[]});H.useEffect(()=>{if(a.current.map||!i.current)return;const h=window.L;if(!h){console.error("Th vin Leaflet khng tm thy. Vui lng m bo  ti th vin.");return}const p=h.map(i.current).setView([16.0544,108.2022],6);return p.options.scrollWheelZoom=!0,h.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(p),s?p.setView([s.lat,s.lng],13):navigator.geolocation&&navigator.geolocation.getCurrentPosition(g=>{const{latitude:y,longitude:E}=g.coords;p.setView([y,E],13)}),a.current.map=p,setTimeout(()=>{a.current.map&&a.current.map.invalidateSize()},400),()=>{a.current.popupRoots.forEach(g=>g.unmount()),a.current.popupRoots=[],a.current.map&&(a.current.map.remove(),a.current.map=null)}},[s]),H.useEffect(()=>{const h=window.L,{map:p}=a.current;if(!p||!h||(a.current.popupRoots.forEach(y=>y.unmount()),a.current.popupRoots=[],Object.values(a.current.markers).forEach(y=>y.remove()),a.current.markers={},n.length===0))return;const g=h.latLngBounds([]);n.forEach(y=>{const E=Ig(y.location);if(!E)return;const x=document.createElement("div"),P=QN.createRoot(x);P.render(f.jsx(vG,{job:y,onJobSelect:e})),a.current.popupRoots.push(P);const O=h.marker([E.lat,E.lng]).addTo(p).bindPopup(x);a.current.markers[y.id]=O,g.extend([E.lat,E.lng])}),g.isValid()&&!t&&(s&&g.extend([s.lat,s.lng]),p.fitBounds(g,{padding:[50,50],maxZoom:14}))},[n,e,t,s]),H.useEffect(()=>{const{map:h,markers:p}=a.current;if(!h||!t||!p[t])return;const g=p[t],y=n.find(x=>x.id===t),E=y?Ig(y.location):null;E&&(h.flyTo([E.lat,E.lng],15,{animate:!0,duration:1}),setTimeout(()=>{g&&typeof g.openPopup=="function"&&g.openPopup()},800)),r()},[t,n,r]),H.useEffect(()=>{const h=window.L,{map:p}=a.current;if(!(!p||!h)&&(a.current.userMarker&&(a.current.userMarker.remove(),a.current.userMarker=null),s)){const g=h.divIcon({html:'<div class="user-location-marker"></div>',className:"",iconSize:[24,24],iconAnchor:[12,12]}),y=h.marker([s.lat,s.lng],{icon:g}).addTo(p).bindTooltip("V tr ca bn");a.current.userMarker=y}},[s]);const c=()=>{const{map:h}=a.current;h&&s&&h.flyTo([s.lat,s.lng],15)};return f.jsxs("div",{className:"relative",children:[f.jsx("div",{ref:i,className:"w-full h-[600px] rounded-lg shadow-md z-0"}),s&&f.jsx("button",{onClick:c,className:"absolute bottom-5 right-5 z-[1000] bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 transition-colors duration-200","aria-label":"V v tr ca ti",title:"V v tr ca ti",children:f.jsx(yG,{className:"w-6 h-6 text-gray-700"})}),f.jsx("style",{children:`
          .user-location-marker {
              width: 24px;
              height: 24px;
              background-color: #3b82f6; /* blue-500 */
              border-radius: 50%;
              border: 3px solid white;
              box-shadow: 0 0 10px rgba(0,0,0,0.3);
              position: relative;
          }
          .user-location-marker::after {
              content: '';
              position: absolute;
              top: 50%;
              left: 50%;
              width: 24px;
              height: 24px;
              border-radius: 50%;
              background-color: rgba(59, 130, 246, 0.3);
              transform: translate(-50%, -50%);
              animation: pulse 2s infinite;
          }
          @keyframes pulse {
              0% {
                  transform: translate(-50%, -50%) scale(1);
                  opacity: 0.8;
              }
              100% {
                  transform: translate(-50%, -50%) scale(2.5);
                  opacity: 0;
              }
          }
      `})]})},EG=H.memo(wG),IG=({className:n="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),TG=({className:n="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m0 10V7m0 10l-6 3"})}),xG="diutnceax",bG="ansinhso_unsigned_preset",l0=async n=>{var r;const e=new FormData;e.append("file",n),e.append("upload_preset",bG);const t="auto";try{const s=await fetch(`https://api.cloudinary.com/v1_1/${xG}/${t}/upload`,{method:"POST",body:e});if(!s.ok){const c=await s.json(),h=((r=c==null?void 0:c.error)==null?void 0:r.message)||"Upload to Cloudinary failed";throw console.error("Cloudinary error response:",c),new Error(`Li Cloudinary: ${h}`)}const i=await s.json();return i.secure_url?i.secure_url.trim():""}catch(s){throw console.error("Error uploading file to Cloudinary:",s),s}},SG=n=>He.collection("jobs").where("status","==","OPEN").onSnapshot(s=>{const i=[];s.forEach(a=>{var h;const c=a.data();if(c.title&&c.location){const p=(h=c.createdAt)!=null&&h.toDate?c.createdAt.toDate().toISOString():new Date().toISOString(),g={id:a.id,title:c.title,description:c.description||"",employerId:c.employerId,employerName:c.employerName,employerProfileUrl:c.employerProfileUrl,addressString:c.addressString,location:c.location,payRate:c.payRate,payType:c.payType,jobType:c.jobType||"Thi v",status:c.status,createdAt:p,hiredWorkerId:c.hiredWorkerId,applicantCount:c.applicantCount||0};i.push(g)}}),i.sort((a,c)=>new Date(c.createdAt).getTime()-new Date(a.createdAt).getTime()),n(i)},s=>{console.error("Error fetching jobs: ",s),n([])}),AG=(n,e)=>He.collection("jobs").where("employerId","==",n).onSnapshot(i=>{const a=[];i.forEach(c=>{var y;const h=c.data(),p=(y=h.createdAt)!=null&&y.toDate?h.createdAt.toDate().toISOString():new Date().toISOString(),g={id:c.id,title:h.title,description:h.description,employerId:h.employerId,employerName:h.employerName,employerProfileUrl:h.employerProfileUrl,addressString:h.addressString,location:h.location,payRate:h.payRate,payType:h.payType,jobType:h.jobType,status:h.status,createdAt:p,hiredWorkerId:h.hiredWorkerId,applicantCount:h.applicantCount||0};a.push(g)}),a.sort((c,h)=>new Date(h.createdAt).getTime()-new Date(c.createdAt).getTime()),e(a)},i=>{console.error("Error fetching employer jobs: ",i),e([])}),NG=async n=>{var e;try{const r=await He.collection("jobs").doc(n).get();if(r.exists){const s=r.data(),i=(e=s==null?void 0:s.createdAt)!=null&&e.toDate?s.createdAt.toDate().toISOString():new Date().toISOString();return{id:r.id,title:s==null?void 0:s.title,description:(s==null?void 0:s.description)||"",employerId:s==null?void 0:s.employerId,employerName:s==null?void 0:s.employerName,employerProfileUrl:s==null?void 0:s.employerProfileUrl,addressString:s==null?void 0:s.addressString,location:s==null?void 0:s.location,payRate:s==null?void 0:s.payRate,payType:s==null?void 0:s.payType,jobType:(s==null?void 0:s.jobType)||"Thi v",status:s==null?void 0:s.status,createdAt:i,hiredWorkerId:s==null?void 0:s.hiredWorkerId,applicantCount:(s==null?void 0:s.applicantCount)||0}}return null}catch(t){return console.error("Error fetching job by ID:",t),null}},CG=async(n,e)=>{await He.collection("jobs").doc(n).update({status:e})},kG=async(n,e)=>{var i;const t=(i=e.addressString.split(",").pop())==null?void 0:i.trim();if(!t)return;const s=He.collection("users").where("userType","==","WORKER");try{(await s.get()).forEach(c=>{const h=c.data();h.address&&h.address.includes(t)&&QI(h.uid,Mi.NEW_JOB_MATCH,`Vic lm mi ti ${t}: "${e.title}"`,`/jobs/${n}`)})}catch(a){console.error("Error notifying workers:",a)}},RG=async(n,e)=>{if(!e.fullName)throw new Error("Nh tuyn dng phi c h tn y   ng tin.");const r=He.collection("jobs").doc(),{coordinates:s,...i}=n,a=`[${s.lat} N, ${s.lng} E]`,c={...i,id:r.id,employerId:e.uid,employerName:e.fullName,employerProfileUrl:e.profileImageUrl||null,status:"OPEN",hiredWorkerId:null,createdAt:Yi(),location:a,applicantCount:0};await r.set(c),await kG(r.id,n)},Sg=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),GN=({job:n,onStatusChange:e,isUpdating:t,onClick:r})=>{const s=n.status==="CLOSED";return f.jsxs("div",{onClick:()=>r(n),className:"bg-white p-4 rounded-lg border flex items-center justify-between cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-gray-800",children:n.title}),f.jsx("p",{className:"text-sm text-gray-500",children:n.addressString})]}),f.jsx("button",{onClick:i=>{i.stopPropagation(),e(n.id,s?"OPEN":"CLOSED")},disabled:t,className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors disabled:opacity-50 ${s?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:t?"...":s?"M li":"ng"})]})},PG=({application:n,onStatusUpdate:e,onViewProfile:t,isUpdating:r})=>{const s={pending:{text:"Ch duyt",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" chp nhn",className:"bg-green-100 text-green-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"}},i=s[n.status]||s.pending;return f.jsxs("div",{className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-4 flex-grow w-full sm:w-auto",children:[n.workerProfileImageUrl?f.jsx("img",{src:n.workerProfileImageUrl,alt:n.workerName,className:"w-12 h-12 rounded-full object-cover flex-shrink-0"}):f.jsx(ga,{className:"w-12 h-12 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:t,className:"font-semibold text-gray-800 hover:text-indigo-600 text-left",children:n.workerName}),n.cvUrl&&f.jsxs("a",{href:n.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded border border-indigo-100 hover:bg-indigo-100",title:"M CV trong tab mi",onClick:a=>a.stopPropagation(),children:[f.jsx(Sg,{className:"w-3 h-3 mr-1"}),"CV"]})]}),f.jsxs("p",{className:"text-sm text-gray-600",children:[" ng tuyn vo: ",f.jsx("span",{className:"font-medium text-indigo-600",children:n.jobTitle})]}),f.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]})]}),f.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 w-full sm:w-auto justify-end",children:[n.status==="pending"&&f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>e("accepted"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 hover:bg-green-200 disabled:opacity-50",children:r?"...":"Chp nhn"}),f.jsx("button",{onClick:()=>e("rejected"),disabled:r,className:"px-3 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 hover:bg-red-200 disabled:opacity-50",children:r?"...":"T chi"})]}),f.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${i.className}`,children:i.text})]})]})},Kv=({application:n,onClick:e})=>{const t={pending:{text:"ang ch",className:"bg-yellow-100 text-yellow-800"},accepted:{text:" chp nhn",className:"bg-green-100 text-green-800"},rejected:{text:" t chi",className:"bg-red-100 text-red-800"}},r=t[n.status]||t.pending;return f.jsxs("div",{onClick:()=>e(n.jobId),className:"bg-white p-4 rounded-lg border flex flex-col sm:flex-row items-center justify-between gap-3 cursor-pointer hover:shadow-md hover:border-indigo-200 transition-all",children:[f.jsxs("div",{className:"flex-grow text-left w-full sm:w-auto",children:[f.jsx("p",{className:"font-semibold text-gray-800",children:n.jobTitle}),f.jsxs("p",{className:"text-sm text-gray-500",children:["Nh tuyn dng: ",f.jsx("span",{className:"font-medium",children:n.employerName})]}),f.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ngy np n: ",new Date(n.applicationDate).toLocaleDateString("vi-VN")]})]}),f.jsx("div",{className:"flex-shrink-0 flex items-center gap-2",children:f.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${r.className}`,children:r.text})})]})},DG=({onViewProfile:n,onJobSelect:e})=>{const{currentUser:t,currentUserData:r,refetchUserData:s,logout:i}=so(),[a,c]=H.useState(""),[h,p]=H.useState(""),[g,y]=H.useState(""),[E,x]=H.useState(null),[P,O]=H.useState(null),[M,X]=H.useState(""),[W,Q]=H.useState([]),[Y,ue]=H.useState(""),[se,R]=H.useState([]),[S,k]=H.useState(!1),[D,N]=H.useState({title:"",company:"",duration:""}),[j,C]=H.useState(null),[We,Et]=H.useState(null),[Nt,st]=H.useState(null),[ce,Se]=H.useState(!1),[me,F]=H.useState(""),[J,xe]=H.useState(""),[De,Ae]=H.useState([]),[Ne,fe]=H.useState([]),[ve,Me]=H.useState(!0),[Ue,it]=H.useState(!0),[Vr,mr]=H.useState(null),[Is,di]=H.useState(null),[In,fi]=H.useState([]),[pi,Ot]=H.useState(!0),[Lt,Zn]=H.useState(!1),io=H.useRef(null),oo=H.useRef(null);H.useEffect(()=>{if(r){if(c(r.fullName||""),p(r.phoneNumber||""),y(r.address||""),O(r.profileImageUrl||null),X(r.bio||""),Q(r.skills||[]),R(r.workHistory||[]),Et(r.cvUrl||null),st(r.cvName||null),r.userType===jt.Employer){Me(!0),it(!0);const Z=AG(r.uid,et=>{Ae(et),Me(!1)}),Ee=fG(r.uid,et=>{fe(et),it(!1)});return()=>{Z(),Ee()}}if(r.userType===jt.Worker){Ot(!0);const Z=pG(r.uid,Ee=>{fi(Ee),Ot(!1)});return()=>Z()}}},[r]);const{openJobs:ba,closedJobs:ts}=H.useMemo(()=>{const Z=De.filter(et=>et.status==="OPEN"),Ee=De.filter(et=>et.status==="CLOSED");return{openJobs:Z,closedJobs:Ee}},[De]),{pendingApplications:ao,acceptedApplications:mi,rejectedApplications:ns}=H.useMemo(()=>(r==null?void 0:r.userType)!==jt.Worker?{pendingApplications:[],acceptedApplications:[],rejectedApplications:[]}:{pendingApplications:In.filter(Z=>Z.status==="pending"),acceptedApplications:In.filter(Z=>Z.status==="accepted"),rejectedApplications:In.filter(Z=>Z.status==="rejected")},[In,r]),Sa=async(Z,Ee)=>{mr(Z);try{await CG(Z,Ee)}catch(et){console.error("Failed to update job status:",et),F("Li cp nht trng thi cng vic.")}finally{mr(null)}},gi=async(Z,Ee)=>{const et=`${Z.jobId}-${Z.id}`;di(et);try{await mG(Z,Ee)}catch(un){console.error("Failed to update application status:",un),F("Li cp nht trng thi ng vin.")}finally{di(null)}},jr=async Z=>{Zn(!0);try{const Ee=De.find(et=>et.id===Z);if(Ee)e(Ee);else{const et=await NG(Z);et?e(et):alert("Cng vic ny khng cn tn ti hoc  b xa.")}}catch(Ee){console.error("Error fetching job details",Ee)}finally{Zn(!1)}},Zl=()=>{var Z;(Z=io.current)==null||Z.click()},Ts=Z=>{var et;const Ee=(et=Z.target.files)==null?void 0:et[0];if(Ee){x(Ee);const un=URL.createObjectURL(Ee);O(un)}},lo=Z=>{var et;const Ee=(et=Z.target.files)==null?void 0:et[0];if(Ee){const un=Ee.name.toLowerCase(),Fr=Ee.type||"",_r=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],uo=[".pdf",".doc",".docx"];if(!(_r.some(ho=>Fr.includes(ho))||uo.some(ho=>un.endsWith(ho)))){F("Vui lng ch ti ln file PDF hoc Word.");return}if(Ee.size>5*1024*1024){F("File qu ln. Vui lng chn file nh hn 5MB.");return}C(Ee),F("")}},Aa=async Z=>{if(Z.preventDefault(),!a){F("Vui lng nhp h v tn ca bn.");return}if(!t){F("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}Se(!0),F(""),xe("");try{let Ee=(r==null?void 0:r.profileImageUrl)||null;E&&(Ee=(await l0(E)).trim());let et=We,un=Nt;j&&(et=(await l0(j)).trim(),un=j.name);const Fr=He.collection("users").doc(t.uid),_r={fullName:a,phoneNumber:h,address:g,profileImageUrl:Ee};(r==null?void 0:r.userType)===jt.Worker&&(_r.bio=M,_r.skills=W,_r.workHistory=se,_r.cvUrl=et,_r.cvName=un),await Fr.update(_r),Et(et),st(un),O(Ee),await s(),xe("Cp nht h s thnh cng!"),x(null),C(null)}catch(Ee){console.error(Ee),Ee instanceof Error?F(Ee.message):F(" c li xy ra khi cp nht h s. Vui lng th li.")}finally{Se(!1)}},gr=async()=>{try{await i()}catch(Z){console.error("Failed to log out",Z),F("ng xut tht bi. Vui lng th li.")}},_i=()=>{Y.trim()&&!W.includes(Y.trim())&&(Q([...W,Y.trim()]),ue(""))},xs=Z=>{Q(W.filter(Ee=>Ee!==Z))},co=()=>{if(D.title.trim()&&D.company.trim()&&D.duration.trim()){const Z={...D,id:Date.now().toString()};R([...se,Z]),N({title:"",company:"",duration:""}),k(!1)}},rs=Z=>{R(se.filter(Ee=>Ee.id!==Z))};return r?f.jsxs("div",{className:"space-y-8",children:[f.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"H s ca bn"}),f.jsx("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-sm p-6 sm:p-8 border border-gray-200 mx-auto",children:f.jsxs("form",{onSubmit:Aa,className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[f.jsx("input",{type:"file",ref:io,onChange:Ts,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),f.jsxs("button",{type:"button",onClick:Zl,className:"relative w-32 h-32 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed hover:border-indigo-400 transition-all","aria-label":"Thay i nh i din",children:[P||r&&r.profileImageUrl?f.jsx("img",{src:P||r.profileImageUrl,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):f.jsx(ga,{className:"w-full h-full text-gray-400 p-8"}),f.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-full flex items-center justify-center transition-opacity",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),f.jsx("p",{className:"text-sm text-gray-500",children:"Nhp vo nh  thay i"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"email",id:"email",value:r.email||"",disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-500"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"H v Tn"}),f.jsx("input",{id:"fullName",type:"text",value:a,onChange:Z=>c(Z.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"S in thoi"}),f.jsx("input",{id:"phoneNumber",type:"tel",value:h,onChange:Z=>p(Z.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"a ch"}),f.jsx("input",{id:"address",type:"text",value:g,onChange:Z=>y(Z.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),r.userType===jt.Worker&&f.jsxs(f.Fragment,{children:[f.jsx("hr",{}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Gii thiu bn thn"}),f.jsx("textarea",{id:"bio",value:M,onChange:Z=>X(Z.target.value),rows:3,placeholder:"Vit mt vi dng v bn thn v kinh nghim ca bn...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s nng lc (CV)"}),f.jsx("input",{type:"file",ref:oo,onChange:lo,className:"hidden",accept:".pdf,.doc,.docx"}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("button",{type:"button",onClick:()=>{var Z;return(Z=oo.current)==null?void 0:Z.click()},className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-200 flex items-center",children:[f.jsx(Sg,{className:"w-5 h-5 mr-2"}),j?"i file":"Ti ln CV"]}),j&&f.jsx("span",{className:"text-sm text-green-600",children:j.name}),We&&!j&&f.jsxs("a",{href:We,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:underline flex items-center",children:[f.jsx(u0,{className:"w-4 h-4 mr-1"}),Nt||"Xem CV hin ti"]})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"H tr nh dng PDF, Word. Ti a 5MB."})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"skills",className:"block text-sm font-medium text-gray-700 mb-1",children:"K nng"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{id:"skills",type:"text",value:Y,onChange:Z=>ue(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&(Z.preventDefault(),_i()),placeholder:"VD: Sa in, gi tr...",className:"flex-grow p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),f.jsx("button",{type:"button",onClick:_i,className:"bg-indigo-100 text-indigo-700 font-semibold px-4 rounded-lg hover:bg-indigo-200",children:"Thm"})]}),f.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:W.map(Z=>f.jsxs("span",{className:"flex items-center bg-gray-200 text-gray-800 text-sm font-medium px-3 py-1 rounded-full",children:[Z,f.jsx("button",{type:"button",onClick:()=>xs(Z),className:"ml-2 text-gray-500 hover:text-gray-800",children:f.jsx(YN,{className:"w-4 h-4"})})]},Z))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lch s lm vic"}),f.jsxs("div",{className:"space-y-3",children:[se.map(Z=>f.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-gray-800",children:Z.title}),f.jsx("p",{className:"text-sm text-gray-600",children:Z.company}),f.jsx("p",{className:"text-xs text-gray-500",children:Z.duration})]}),f.jsx("button",{type:"button",onClick:()=>rs(Z.id),className:"text-gray-400 hover:text-red-500 p-1",children:f.jsx(JI,{className:"w-5 h-5"})})]},Z.id)),se.length===0&&!S&&f.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"Cha c kinh nghim lm vic."}),S&&f.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg space-y-3 bg-white",children:[f.jsx("input",{type:"text",value:D.title,onChange:Z=>N({...D,title:Z.target.value}),placeholder:"Chc danh cng vic",className:"w-full p-2 border border-gray-300 rounded-md"}),f.jsx("input",{type:"text",value:D.company,onChange:Z=>N({...D,company:Z.target.value}),placeholder:"Tn cng ty/ni lm vic",className:"w-full p-2 border border-gray-300 rounded-md"}),f.jsx("input",{type:"text",value:D.duration,onChange:Z=>N({...D,duration:Z.target.value}),placeholder:"Thi gian (VD: 2020 - 2022)",className:"w-full p-2 border border-gray-300 rounded-md"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{type:"button",onClick:co,className:"bg-green-600 text-white font-semibold py-1 px-3 rounded-md text-sm hover:bg-green-700",children:"Lu"}),f.jsx("button",{type:"button",onClick:()=>k(!1),className:"bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-md text-sm hover:bg-gray-300",children:"Hy"})]})]}),!S&&f.jsxs("button",{type:"button",onClick:()=>k(!0),className:"w-full flex items-center justify-center gap-2 text-sm font-semibold text-indigo-600 hover:text-indigo-800 p-2 border-2 border-dashed rounded-lg hover:border-indigo-400 transition-colors",children:[f.jsx(Yv,{className:"w-5 h-5"}),"Thm kinh nghim"]})]})]})]})]}),me&&f.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:me}),J&&f.jsx("p",{className:"text-green-600 text-sm text-center bg-green-50 p-3 rounded-lg border border-green-200",children:J}),f.jsxs("div",{className:"pt-2 space-y-4",children:[f.jsxs("button",{type:"submit",disabled:ce,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center",children:[ce&&f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ce?"ang lu...":"Lu thay i"]}),f.jsx("button",{type:"button",onClick:gr,className:"w-full bg-gray-100 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300 border border-gray-300",children:"ng xut"})]})]})}),r.userType===jt.Employer&&f.jsxs("div",{className:"max-w-4xl w-full mx-auto mt-12 space-y-10",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng ang m"}),ve?f.jsx(ar,{}):ba.length>0?f.jsx("div",{className:"space-y-3",children:ba.map(Z=>f.jsx(GN,{job:Z,onStatusChange:Sa,isUpdating:Vr===Z.id,onClick:Ee=>e(Ee)},Z.id))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no ang m."})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Bi ng  ng"}),ve?f.jsx(ar,{}):ts.length>0?f.jsx("div",{className:"space-y-3",children:ts.map(Z=>f.jsx(GN,{job:Z,onStatusChange:Sa,isUpdating:Vr===Z.id,onClick:Ee=>e(Ee)},Z.id))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c tin tuyn dng no  ng."})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"ng vin  np n"}),Ue?f.jsx(ar,{}):Ne.length>0?f.jsx("div",{className:"space-y-3",children:Ne.map(Z=>f.jsx(PG,{application:Z,onStatusUpdate:Ee=>gi(Z,Ee),onViewProfile:()=>n(Z.workerId,Z),isUpdating:Is===`${Z.jobId}-${Z.id}`},`${Z.jobId}-${Z.id}`))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c ng vin no np n."})]})]}),r.userType===jt.Worker&&f.jsxs("div",{className:"max-w-2xl w-full mx-auto mt-12 space-y-10",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn ang ch"}),pi?f.jsx(ar,{}):ao.length>0?f.jsx("div",{className:"space-y-3",children:ao.map(Z=>f.jsx(Kv,{application:Z,onClick:jr},`${Z.jobId}-${Z.id}`))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no ang ch."})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cng vic  c chp thun"}),pi?f.jsx(ar,{}):mi.length>0?f.jsx("div",{className:"space-y-3",children:mi.map(Z=>f.jsx(Kv,{application:Z,onClick:jr},`${Z.jobId}-${Z.id}`))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Cha c n ng tuyn no c chp thun."})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"n ng tuyn b t chi"}),pi?f.jsx(ar,{}):ns.length>0?f.jsx("div",{className:"space-y-3",children:ns.map(Z=>f.jsx(Kv,{application:Z,onClick:jr},`${Z.jobId}-${Z.id}`))}):f.jsx("p",{className:"text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"Bn khng c n ng tuyn no b t chi."})]})]}),Lt&&f.jsx(ar,{fullScreen:!0,message:"ang ti chi tit cng vic..."})]}):f.jsx(ar,{message:"ang ti h s..."})},OG=({initialCenter:n,initialZoom:e,onLocationChange:t})=>{const r=H.useRef(null),s=H.useRef(null);return H.useEffect(()=>{if(s.current||!r.current)return;const i=window.L;if(!i){console.error("Th vin Leaflet khng tm thy.");return}const a=n||{lat:16.0544,lng:108.2022},c=e||6,h=i.map(r.current,{zoomControl:!1}).setView([a.lat,a.lng],c);return s.current=h,i.control.zoom({position:"topright"}).addTo(h),i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(h),t({lat:a.lat,lng:a.lng}),h.on("moveend",()=>{const p=h.getCenter();t({lat:p.lat,lng:p.lng})}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(p=>{const{latitude:g,longitude:y}=p.coords;h.setView([g,y],15)}),()=>{s.current&&(s.current.remove(),s.current=null)}},[]),f.jsxs("div",{className:"relative w-full h-80 rounded-lg shadow-md z-0 border overflow-hidden",children:[f.jsx("div",{ref:r,className:"w-full h-full"}),f.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-full pointer-events-none z-[1000]",children:f.jsx(Go,{className:"w-10 h-10 text-red-500 drop-shadow-lg"})}),f.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-sm text-gray-700 text-xs font-semibold px-3 py-1.5 rounded-full shadow-md pointer-events-none",children:"Di chuyn bn   chn v tr"})]})},LG=({onClose:n})=>{const{currentUserData:e}=so(),[t,r]=H.useState(""),[s,i]=H.useState(""),[a,c]=H.useState([]),[h,p]=H.useState([]),[g,y]=H.useState([]),[E,x]=H.useState(!1),[P,O]=H.useState(!1),[M,X]=H.useState(!1),[W,Q]=H.useState(""),[Y,ue]=H.useState(""),[se,R]=H.useState(""),[S,k]=H.useState(""),[D,N]=H.useState(null),[j,C]=H.useState(""),[We,Et]=H.useState("THEO NGY"),[Nt,st]=H.useState("Thi v"),[ce,Se]=H.useState(!1),[me,F]=H.useState(!1),[J,xe]=H.useState("");H.useEffect(()=>{(async()=>{x(!0),xe("");try{const ve=await fetch("https://open.oapi.vn/location/provinces?size=100");if(!ve.ok)throw new Error("Network response was not ok");const Ue=((await ve.json()).data||[]).map(it=>({name:it.name,code:parseInt(it.id,10)}));c(Ue)}catch(ve){console.error("Failed to fetch provinces:",ve),xe("Khng th ti danh sch Tnh/Thnh. Vui lng th li.")}finally{x(!1)}})()},[]),H.useEffect(()=>{if(!W){p([]),y([]),ue(""),R("");return}(async()=>{O(!0),xe("");try{const ve=await fetch(`https://open.oapi.vn/location/districts/${W}?size=100`);if(!ve.ok)throw new Error("Network response was not ok");const Ue=((await ve.json()).data||[]).map(it=>({name:it.name,code:parseInt(it.id,10),province_code:parseInt(it.provinceId,10)}));p(Ue)}catch(ve){console.error("Failed to fetch districts:",ve),xe("Khng th ti danh sch Qun/Huyn.")}finally{O(!1)}})()},[W]),H.useEffect(()=>{if(!Y){y([]),R("");return}(async()=>{X(!0),xe("");try{const ve=await fetch(`https://open.oapi.vn/location/wards/${Y}?size=100`);if(!ve.ok)throw new Error("Network response was not ok");const Ue=((await ve.json()).data||[]).map(it=>({name:it.name,code:parseInt(it.id,10),district_code:parseInt(it.districtId,10)}));y(Ue)}catch(ve){console.error("Failed to fetch wards:",ve),xe("Khng th ti danh sch Phng/X.")}finally{X(!1)}})()},[Y]);const De=fe=>{Q(fe.target.value),ue(""),R(""),p([]),y([])},Ae=fe=>{ue(fe.target.value),R(""),y([])},Ne=async fe=>{var ve,Me,Ue;if(fe.preventDefault(),!e){xe("Bn phi ng nhp  ng tin.");return}if(!D){xe("Vui lng chn mt v tr trn bn .");return}if(!W||!Y||!se){xe("Vui lng chn y  Tnh/Thnh, Qun/Huyn, v Phng/X.");return}F(!0),xe("");try{const it=((ve=a.find(In=>In.code===parseInt(W)))==null?void 0:ve.name)||"",Vr=((Me=h.find(In=>In.code===parseInt(Y)))==null?void 0:Me.name)||"",mr=((Ue=g.find(In=>In.code===parseInt(se)))==null?void 0:Ue.name)||"",Is=`${S}, ${mr}, ${Vr}, ${it}`.trim(),di={title:t,description:s,addressString:Is,coordinates:D,payRate:ce?"Tha thun":parseFloat(j)||0,payType:We,jobType:Nt};await RG(di,e),n()}catch(it){xe(it.message||" c li xy ra. Vui lng th li."),console.error(it)}finally{F(!1)}};return f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start p-4 overflow-y-auto",onClick:n,"aria-modal":"true",role:"dialog",children:[f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up mt-8 mb-8",onClick:fe=>fe.stopPropagation(),children:f.jsxs("form",{onSubmit:Ne,children:[f.jsxs("div",{className:"p-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"ng tin tuyn dng mi"}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cung cp thng tin chi tit v cng vic bn mun ng."}),f.jsxs("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Tiu  cng vic"}),f.jsx("input",{type:"text",id:"title",value:t,onChange:fe=>r(fe.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"M t chi tit"}),f.jsx("textarea",{id:"description",value:s,onChange:fe=>i(fe.target.value),required:!0,rows:4,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-y"})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700",children:"Tnh/Thnh ph"}),f.jsxs("select",{id:"province",value:W,onChange:De,required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[E?f.jsx("option",{children:"ang ti..."}):f.jsx("option",{value:"",children:"-- Chn Tnh/Thnh --"}),a.map(fe=>f.jsx("option",{value:fe.code,children:fe.name},fe.code))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"district",className:"block text-sm font-medium text-gray-700",children:"Qun/Huyn"}),f.jsxs("select",{id:"district",value:Y,onChange:Ae,required:!0,disabled:!W||P,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[P?f.jsx("option",{children:"ang ti..."}):f.jsx("option",{value:"",children:"-- Chn Qun/Huyn --"}),h.map(fe=>f.jsx("option",{value:fe.code,children:fe.name},fe.code))]})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"ward",className:"block text-sm font-medium text-gray-700",children:"Phng/X"}),f.jsxs("select",{id:"ward",value:se,onChange:fe=>R(fe.target.value),required:!0,disabled:!Y||M,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100",children:[M?f.jsx("option",{children:"ang ti..."}):f.jsx("option",{value:"",children:"-- Chn Phng/X --"}),g.map(fe=>f.jsx("option",{value:fe.code,children:fe.name},fe.code))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"streetAddress",className:"block text-sm font-medium text-gray-700",children:"S nh, tn ng"}),f.jsx("input",{type:"text",id:"streetAddress",value:S,onChange:fe=>k(fe.target.value),required:!0,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"VD: 123 ng Nguyn Hu"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghim v tr chnh xc trn bn "}),f.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Ko bn   ghim  v tr chnh xc nht ca cng vic."}),f.jsx(OG,{onLocationChange:N,initialCenter:{lat:16.0544,lng:108.2022},initialZoom:6}),D&&f.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Ta   chn: ",D.lat.toFixed(6),", ",D.lng.toFixed(6)]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"jobType",className:"block text-sm font-medium text-gray-700",children:"Loi hnh cng vic"}),f.jsxs("select",{id:"jobType",value:Nt,onChange:fe=>st(fe.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[f.jsx("option",{children:"Thi v"}),f.jsx("option",{children:"Bn thi gian"}),f.jsx("option",{children:"Linh hot"}),f.jsx("option",{children:"Ton thi gian"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"payType",className:"block text-sm font-medium text-gray-700",children:"Hnh thc tr lng"}),f.jsxs("select",{id:"payType",value:We,onChange:fe=>Et(fe.target.value),className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[f.jsx("option",{value:"THEO NGY",children:"Theo ngy"}),f.jsx("option",{value:"THEO GI",children:"Theo gi"}),f.jsx("option",{value:"THEO THNG",children:"Theo thng"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"payRate",className:"block text-sm font-medium text-gray-700",children:"Mc lng (VN)"}),f.jsx("input",{type:"number",id:"payRate",value:j,onChange:fe=>C(fe.target.value),required:!ce,disabled:ce,className:"mt-1 w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100"}),f.jsxs("div",{className:"mt-2 flex items-center",children:[f.jsx("input",{type:"checkbox",id:"negotiable",checked:ce,onChange:fe=>Se(fe.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),f.jsx("label",{htmlFor:"negotiable",className:"ml-2 block text-sm text-gray-900",children:"Tha thun"})]})]})]})]}),J&&f.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 mx-6 rounded-lg border border-red-200",children:J}),f.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[f.jsxs("button",{type:"submit",disabled:me,className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 flex items-center justify-center disabled:bg-indigo-400",children:[me&&f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),me?"ang ng tin...":"ng tin"]}),f.jsx("button",{type:"button",onClick:n,className:"w-full bg-white text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors duration-300","aria-label":"Hy",children:"Hy"})]})]})}),f.jsx("style",{children:`
        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
    `})]})},MG=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),VG=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.82m5.84-2.56a6 6 0 0 1-7.38 5.84m2.56-5.84a6 6 0 0 1 5.84-7.38m-5.84 2.56a6 6 0 0 1 7.38-5.84m-2.56 5.84a6 6 0 0 1-5.84 7.38m5.84-2.56a6 6 0 0 1-7.38 5.84m0-11.68a6 6 0 0 1 7.38-5.84m-7.38 5.84a6 6 0 0 1 5.84-7.38"})}),jG=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),FG=({onNavigateToAuth:n})=>{const e=[{name:"Tnh nng",href:"#features"},{name:"Hot ng",href:"#how-it-works"},{name:"V sao chn?",href:"#why-us"}],t=[{icon:f.jsx(ii,{className:"w-8 h-8 text-indigo-600"}),title:"Tm Vic Nhanh Chng, Gn Nh",description:"Kt ni trc tip vi hng ngn c hi vic lm thi v, bn thi gian t cc nh tuyn dng uy tn trong khu vc ca bn."},{icon:f.jsx(Ui,{className:"w-8 h-8 text-green-600"}),title:"Tch Ly Tng Lai Vi BHXH",description:"D dng trch mt phn thu nhp  ng bo him x hi t nguyn, m bo lng hu v an sinh khi v gi."},{icon:f.jsx(Uo,{className:"w-8 h-8 text-amber-600"}),title:"H Tr Thng Minh 4.0",description:"Nhn t vn t chatbot AI v lut lao ng v to nh i din chuyn nghip  gy n tng vi nh tuyn dng."}],r=[{icon:f.jsx(MG,{className:"w-8 h-8 text-blue-600"}),title:"An Ton & Minh Bch",description:"Mi cng vic u c xc thc, thng tin r rng. Chng ti bo v quyn li ca bn, gip bn thot khi s bp bnh khi tm vic qua cc knh khng chnh thc."},{icon:f.jsx(VG,{className:"w-8 h-8 text-green-600"}),title:"Hiu Qu & Nhanh Chng",description:"i vi nh tuyn dng, vic tm kim lao ng thi v ph hp tr nn d dng hn bao gi ht, gip tit kim thi gian v ti u ha hot ng kinh doanh."},{icon:f.jsx(Rm,{className:"w-8 h-8 text-red-600"}),title:"Tc ng X Hi",description:"Bn ang chung tay gii quyt bi ton an sinh cho hn 20 triu lao ng t do, gp phn xy dng mt x hi n nh v pht trin bn vng."}],s=[{quote:"Nh An Tm Vic Lm, ti  tm c cng vic ph h gn nh vi thu nhp n nh. Vic ng k v tm vic rt n gin v minh bch.",name:"Anh Minh Tun",role:"Lao ng xy dng",avatar:"https://images.unsplash.com/photo-1581092921462-2150b3e19190?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},{quote:"Nn tng gip ti nhanh chng tm c ngi gip vic theo gi mi khi qun ng khch. Cc ng vin u c thng tin r rng, rt ng tin cy.",name:"Ch Lan Anh",role:"Ch qun n",avatar:"https://images.unsplash.com/photo-1600565193348-f74d3c2723a9?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}];return f.jsxs("div",{className:"bg-white text-gray-800 antialiased animate-fade-in",children:[f.jsx("header",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-sm border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center justify-between h-20",children:[f.jsxs("div",{className:"flex items-center space-x-10",children:[f.jsxs("a",{href:"#",className:"flex items-center flex-shrink-0 group",children:[f.jsx(Ui,{className:"h-8 w-8 text-indigo-600"}),f.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),f.jsx("nav",{className:"hidden md:flex items-baseline space-x-6",children:e.map(i=>f.jsx("a",{href:i.href,className:"text-gray-600 hover:text-indigo-600 font-medium transition-colors",children:i.name},i.name))})]}),f.jsx("div",{className:"flex items-center space-x-4",children:f.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:"ng nhp"})})]})})}),f.jsxs("main",{children:[f.jsx("section",{className:"relative bg-gray-50",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-2 gap-16 items-center pt-24 pb-32",children:[f.jsxs("div",{className:"text-center md:text-left",children:[f.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold text-gray-900 tracking-tight leading-tight",children:["Nn tng ",f.jsx("span",{className:"text-indigo-600",children:"An Sinh"})," v ",f.jsx("span",{className:"text-indigo-600",children:"Vic Lm"})," cho Lao ng T Do"]}),f.jsx("p",{className:"mt-6 text-lg text-gray-600",children:"Tm vic thi v linh hot, ng gp BHXH d dng, xy dng mt tng lai vng chc v an tm hn."}),f.jsxs("div",{className:"mt-10 flex flex-col sm:flex-row justify-center md:justify-start gap-4",children:[f.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"Tham Gia Ngay"}),f.jsx("a",{href:"#features",className:"bg-white text-indigo-600 font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-50 transition-colors border-2 border-indigo-200",children:"Tm hiu thm"})]})]}),f.jsx("div",{className:"hidden md:block",children:f.jsx("img",{src:"https://images.unsplash.com/photo-1552664730-d307ca884978?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Freelance working smiling",className:"rounded-2xl shadow-2xl object-cover w-full h-full"})})]})}),f.jsx("section",{id:"how-it-works",className:"py-20",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"text-center mb-16",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Hot ng nh th no?"}),f.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Ch vi 3 bc n gin  bt u hnh trnh ca bn."})]}),f.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-center",children:[f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"1"}),f.jsx("h3",{className:"text-xl font-bold mb-2",children:"To H S Chuyn Nghip"}),f.jsx("p",{className:"text-gray-600",children:"ng k ti khon v hon thin h s ca bn ch trong vi pht. Thm nh i din do AI to  tng c hi."})]}),f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"2"}),f.jsx("h3",{className:"text-xl font-bold mb-2",children:"Tm Vic & ng Tuyn"}),f.jsx("p",{className:"text-gray-600",children:"Duyt qua hng ngn cng vic thi v, bn thi gian c cp nht lin tc. ng tuyn ch vi mt c nhp chut."})]}),f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full text-2xl font-bold mb-4 border-4 border-white shadow-md",children:"3"}),f.jsx("h3",{className:"text-xl font-bold mb-2",children:"Nhn Lng & Tch Ly"}),f.jsx("p",{className:"text-gray-600",children:"Nhn thanh ton minh bch v d dng trch mt phn thu nhp  ng BHXH, m bo cho tng lai ca bn."})]})]})]})}),f.jsx("section",{id:"features",className:"py-20 bg-slate-50",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"text-center mb-16",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Mi th bn cn,  cng mt ni"}),f.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Chng ti n gin ha vic tm kim c hi v m bo tng lai."})]}),f.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((i,a)=>f.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[f.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-indigo-100 mb-6",children:i.icon}),f.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:i.title}),f.jsx("p",{className:"text-gray-600",children:i.description})]},a))})]})}),f.jsx("section",{id:"why-us",className:"py-20",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"text-center mb-16",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Khng Ch L Vic Lm, L S An Tm"}),f.jsx("p",{className:"mt-4 max-w-3xl mx-auto text-lg text-gray-600",children:"Chng ti khng ch kt ni bn vi cng vic. Chng ti xy dng mt nn tng vng chc cho tng lai ca bn."})]}),f.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:r.map((i,a)=>f.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[f.jsx("div",{className:"flex items-center justify-center h-16 w-16 rounded-full bg-gray-100 mb-6",children:i.icon}),f.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:i.title}),f.jsx("p",{className:"text-gray-600",children:i.description})]},a))})]})}),f.jsx("section",{id:"testimonials",className:"py-20 bg-slate-50",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"text-center mb-16",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Ting ni t cng ng"}),f.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Xem ngi lao ng v nh tuyn dng ni g v chng ti."})]}),f.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:s.map((i,a)=>f.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md border border-gray-200",children:[f.jsxs("p",{className:"text-gray-600 italic mb-6",children:['"',i.quote,'"']}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("img",{src:i.avatar,alt:i.name,className:"w-12 h-12 rounded-full object-cover mr-4"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-bold text-gray-900",children:i.name}),f.jsx("p",{className:"text-gray-500 text-sm",children:i.role})]})]})]},a))})]})}),f.jsx("section",{children:f.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center",children:[f.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Sn Sng Bt u Hnh Trnh Ca Bn?"}),f.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Tham gia cng ng An Tm Vic Lm ngay hm nay  tm kim c hi v xy dng mt tng lai an ton hn."}),f.jsx("div",{className:"mt-8",children:f.jsx("button",{onClick:n,className:"bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105 shadow-lg",children:"To ti khon min ph"})})]})})]}),f.jsx("footer",{className:"bg-gray-800 text-white",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[f.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"md:col-span-1",children:[f.jsxs("a",{href:"#",className:"flex items-center justify-center md:justify-start flex-shrink-0 group",children:[f.jsx(Ui,{className:"h-8 w-8 text-indigo-400"}),f.jsx("h1",{className:"ml-3 text-2xl font-bold",children:"An Tm Vic Lm"})]}),f.jsx("p",{className:"text-gray-400 mt-2 text-center md:text-left",children:"Nn tng an sinh v vic lm cho lao ng t do."})]}),f.jsxs("div",{className:"md:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin kt nhanh"}),f.jsx("nav",{className:"flex flex-col items-center md:items-start space-y-2",children:e.map(i=>f.jsx("a",{href:i.href,className:"text-gray-300 hover:text-white font-medium transition-colors",children:i.name},i.name))})]}),f.jsxs("div",{className:"md:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-white mb-4 text-center md:text-left",children:"Lin h"}),f.jsxs("div",{className:"flex items-center justify-center md:justify-start text-gray-300",children:[f.jsx(jG,{className:"w-5 h-5 mr-2"}),f.jsx("a",{href:"mailto:nguyenduyphuc0119@gmail.com",className:"hover:text-white transition-colors",children:"nguyenduyphuc0119@gmail.com"})]})]})]}),f.jsx("div",{className:"mt-8 pt-8 border-t border-gray-700 text-center text-gray-400 text-sm",children:f.jsx("p",{children:" 2024 An Tm Vic Lm. Mi quyn c bo lu."})})]})})]})},UG=()=>f.jsxs("svg",{className:"w-5 h-5 mr-3",xmlns:"http://www.w.w3.org/2000/svg",viewBox:"0 0 48 48",children:[f.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"}),f.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"}),f.jsx("path",{fill:"#4CAF50",d:"M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.222 0-9.618-3.317-11.284-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"}),f.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.012 34.423 44 29.836 44 24c0-1.341-.138-2.65-.389-3.917z"})]}),BG=({onBackToLanding:n})=>{const[e,t]=H.useState(!0),[r,s]=H.useState(""),[i,a]=H.useState(""),[c,h]=H.useState(""),[p,g]=H.useState(jt.Worker),[y,E]=H.useState(""),[x,P]=H.useState(!1),[O,M]=H.useState(!1),{signup:X,login:W,loginWithGoogle:Q}=so(),Y=async se=>{if(se.preventDefault(),E(""),P(!0),!e&&i!==c){E("Mt khu khng khp."),P(!1);return}try{e?await W(r,i):await X(r,i,p)}catch(R){switch(R.code){case"auth/user-not-found":E("Khng tm thy ti khon vi email ny.");break;case"auth/wrong-password":E("Sai mt khu. Vui lng th li.");break;case"auth/email-already-in-use":E("Email ny  c s dng.");break;case"auth/weak-password":E("Mt khu phi c t nht 6 k t.");break;case"auth/popup-closed-by-user":E("Bn  ng ca s ng nhp. Vui lng th li.");break;default:E(" xy ra li. Vui lng th li.");break}}finally{P(!1)}},ue=async()=>{E(""),M(!0);try{await Q()}catch(se){switch(se.code){case"auth/popup-closed-by-user":E("Bn  ng ca s ng nhp. Vui lng th li.");break;default:E("ng nhp vi Google tht bi. Vui lng th li.");break}M(!1)}};return f.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-white px-4 animate-fade-in relative",children:[f.jsxs("button",{onClick:n,className:"absolute top-6 left-6 flex items-center text-sm font-semibold text-gray-600 hover:text-indigo-600 transition-colors group",children:[f.jsx(gO,{className:"w-5 h-5 mr-2 text-gray-500 group-hover:text-indigo-600"}),"Quay li trang ch"]}),f.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-2xl border border-gray-100 p-8 space-y-6",children:[f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx(Ui,{className:"h-12 w-12 text-indigo-600"}),f.jsx("h1",{className:"mt-3 text-3xl font-bold text-gray-800",children:"Cho mng n An Tm Vic Lm"}),f.jsx("p",{className:"text-gray-600 mt-2",children:e?"ng nhp vo ti khon ca bn":"To ti khon mi"})]}),f.jsx("div",{className:"space-y-4",children:f.jsx("button",{onClick:ue,disabled:O||x,className:"w-full flex justify-center items-center bg-white text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:bg-gray-200 transition-colors",children:O?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang chuyn hng..."]}):f.jsxs(f.Fragment,{children:[f.jsx(UG,{})," ng nhp vi Google"]})})}),f.jsxs("div",{className:"relative flex py-2 items-center",children:[f.jsx("div",{className:"flex-grow border-t border-gray-300"}),f.jsx("span",{className:"flex-shrink mx-4 text-gray-500 text-sm",children:"HOC"}),f.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),f.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[f.jsx("input",{type:"email",value:r,onChange:se=>s(se.target.value),placeholder:"Email",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),f.jsx("input",{type:"password",value:i,onChange:se=>a(se.target.value),placeholder:"Mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),!e&&f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"password",value:c,onChange:se=>h(se.target.value),placeholder:"Xc nhn mt khu",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),f.jsxs("div",{children:[f.jsx("span",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bn l:"}),f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"role",value:jt.Worker,checked:p===jt.Worker,onChange:()=>g(jt.Worker),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),f.jsx("span",{className:"text-gray-700",children:"Ngi lao ng"})]}),f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"role",value:jt.Employer,checked:p===jt.Employer,onChange:()=>g(jt.Employer),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),f.jsx("span",{className:"text-gray-700",children:"Nh tuyn dng"})]})]})]})]}),y&&f.jsx("p",{className:"text-red-500 text-sm text-center",children:y}),f.jsx("button",{type:"submit",disabled:x||O,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors",children:x?"ang x l...":e?"ng nhp":"ng k"})]}),f.jsxs("p",{className:"text-center text-sm",children:[e?"Cha c ti khon?":" c ti khon?",f.jsx("button",{onClick:()=>{t(!e),E("")},className:"font-medium text-indigo-600 hover:text-indigo-500 ml-1",children:e?"ng k":"ng nhp"})]})]})]})},zG=()=>{const[n,e]=H.useState("landing");return n==="landing"?f.jsx(FG,{onNavigateToAuth:()=>e("auth")}):f.jsx(BG,{onBackToLanding:()=>e("landing")})},$G=()=>{const{currentUser:n,currentUserData:e,refetchUserData:t}=so(),r=!e,[s,i]=H.useState((e==null?void 0:e.fullName)||""),[a,c]=H.useState((e==null?void 0:e.phoneNumber)||""),[h,p]=H.useState((e==null?void 0:e.address)||""),[g,y]=H.useState(jt.Worker),[E,x]=H.useState(null),[P,O]=H.useState((e==null?void 0:e.profileImageUrl)||(n==null?void 0:n.photoURL)||null),[M,X]=H.useState(!1),[W,Q]=H.useState(""),Y=H.useRef(null),ue=()=>{var S;(S=Y.current)==null||S.click()},se=S=>{var D;const k=(D=S.target.files)==null?void 0:D[0];if(k){x(k);const N=URL.createObjectURL(k);O(N)}},R=async S=>{if(S.preventDefault(),!s){Q("Vui lng nhp h v tn ca bn.");return}if(!n){Q("Phin ng nhp  ht hn. Vui lng ng nhp li.");return}X(!0),Q("");try{let k=P;E&&(k=await l0(E));const D=He.collection("users").doc(n.uid);r?await D.set({uid:n.uid,email:n.email,userType:g,createdAt:Yi(),fullName:s,phoneNumber:a,address:h,profileImageUrl:k,fcmTokens:[],bio:"",skills:[],workHistory:[],cvUrl:null,cvName:null}):await D.update({fullName:s,phoneNumber:a,address:h,profileImageUrl:k}),await t()}catch(k){console.error(k),k instanceof Error?Q(k.message):Q(" c li xy ra khi cp nht h s. Vui lng th li."),X(!1)}};return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12",children:f.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 space-y-6 animate-fade-in-up",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:r?"Cho mng bn mi!":"Hon thin h s"}),f.jsx("p",{className:"text-gray-600 mt-2",children:r?"Vui lng chn vai tr v cp nht thng tin  bt u.":"Vui lng cp nht thng tin  tip tc."})]}),f.jsxs("form",{onSubmit:R,className:"space-y-6",children:[r&&f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bn mun tham gia vi t cch l?"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("button",{type:"button",onClick:()=>y(jt.Worker),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${g===jt.Worker?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[f.jsx(Qv,{className:"w-8 h-8 mb-2"}),f.jsx("span",{className:"font-bold text-sm",children:"Ngi Lao ng"})]}),f.jsxs("button",{type:"button",onClick:()=>y(jt.Employer),className:`p-4 rounded-lg border-2 flex flex-col items-center justify-center transition-all ${g===jt.Employer?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[f.jsx(ii,{className:"w-8 h-8 mb-2"}),f.jsx("span",{className:"font-bold text-sm",children:"Nh Tuyn Dng"})]})]})]}),f.jsxs("div",{className:"flex flex-col items-center space-y-4 pt-2",children:[f.jsx("input",{type:"file",ref:Y,onChange:se,className:"hidden",accept:"image/png, image/jpeg, image/jpg"}),f.jsxs("button",{type:"button",onClick:ue,className:"relative w-28 h-28 rounded-full group bg-gray-100 flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-300 hover:border-indigo-500 transition-colors","aria-label":"Thay i nh i din",children:[P?f.jsx("img",{src:P,alt:"Xem trc",className:"w-full h-full rounded-full object-cover"}):f.jsx(ga,{className:"w-12 h-12 text-gray-400"}),f.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 rounded-full flex items-center justify-center transition-opacity",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),f.jsx("p",{className:"text-xs text-gray-500",children:"nh i din"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{children:f.jsx("input",{type:"text",value:s,onChange:S=>i(S.target.value),placeholder:"H v Tn",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),f.jsx("div",{children:f.jsx("input",{type:"tel",value:a,onChange:S=>c(S.target.value),placeholder:"S in thoi (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})}),f.jsx("div",{children:f.jsx("input",{type:"text",value:h,onChange:S=>p(S.target.value),placeholder:"a ch (ty chn)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-shadow"})})]}),W&&f.jsx("p",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:W}),f.jsxs("button",{type:"submit",disabled:M,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-400 transition-colors flex items-center justify-center shadow-md",children:[M&&f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),M?"ang x l...":r?"To h s":"Cp nht"]})]})]})})},HG=async n=>{var e;if(!n)return null;try{const r=await He.collection("users").doc(n).get();if(r.exists){const s=r.data(),i=(e=s.createdAt)!=null&&e.toDate?s.createdAt.toDate().toISOString():new Date().toISOString();return{uid:s.uid,email:s.email,userType:s.userType,createdAt:i,fullName:s.fullName||"Ngi dng n danh",phoneNumber:s.phoneNumber,address:s.address,profileImageUrl:s.profileImageUrl,bio:s.bio||"",skills:s.skills||[],workHistory:s.workHistory||[]}}else return console.log("No such user document!"),null}catch(t){throw console.error("Error fetching user profile:",t),t}},WG=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),CO=({className:n="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.311a12.06 12.06 0 00-4.5 0m4.5 0a12.06 12.06 0 01-4.5 0M12 6.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5zM12 12.75a2.25 2.25 0 110-4.5 2.25 2.25 0 010 4.5z"})}),Zh=({icon:n,title:e,children:t,className:r=""})=>f.jsxs("div",{className:r,children:[f.jsxs("div",{className:"flex items-center mb-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:n}),f.jsx("h4",{className:"text-lg font-bold text-gray-800",children:e})]}),f.jsx("div",{className:"pl-8",children:t})]}),qG=({userId:n,application:e,onClose:t,onStartChat:r})=>{const[s,i]=H.useState(null),[a,c]=H.useState(!0),[h,p]=H.useState(""),[g,y]=H.useState(!1);return H.useEffect(()=>{(async()=>{c(!0),p("");try{const x=await HG(n);x?(i(x),x.cvUrl&&x.cvUrl.toLowerCase().endsWith(".pdf")&&y(!0)):p("Khng tm thy h s ngi dng.")}catch(x){console.error(x),p(" xy ra li khi ti h s.")}finally{c(!1)}})()},[n]),f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[100] flex justify-center items-center p-4 animate-fade-in",style:{animationDuration:"0.2s"},onClick:t,"aria-modal":"true",role:"dialog",children:f.jsxs("div",{className:"bg-gray-50 rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up flex flex-col h-[90vh]",style:{animationDuration:"0.3s"},onClick:E=>E.stopPropagation(),children:[a&&f.jsx(ar,{message:"ang ti h s..."}),h&&f.jsx("div",{className:"p-8 text-center text-red-500",children:h}),!a&&s&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-6 bg-white border-b",children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[s.profileImageUrl?f.jsx("img",{src:s.profileImageUrl,alt:s.fullName||"User",className:"w-20 h-20 rounded-full object-cover border-2 border-white shadow-md"}):f.jsx(ga,{className:"w-20 h-20"}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:s.fullName}),s.address&&f.jsxs("div",{className:"flex items-center text-gray-500 mt-1",children:[f.jsx(Go,{className:"w-4 h-4 mr-1.5"}),f.jsx("p",{children:s.address})]}),((e==null?void 0:e.contactPhoneNumber)||s.phoneNumber)&&f.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ST: ",f.jsx("span",{className:"font-medium",children:(e==null?void 0:e.contactPhoneNumber)||s.phoneNumber})]}),s.email&&f.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",s.email]})]})]}),f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"ng",children:f.jsx(V_,{className:"w-6 h-6"})})]}),r&&f.jsx("div",{className:"mt-4 flex justify-end",children:f.jsxs("button",{onClick:r,className:"flex items-center bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[f.jsx(Ag,{className:"w-5 h-5 mr-2"}),"Nhn tin"]})})]}),f.jsxs("div",{className:"flex-grow p-6 sm:p-8 overflow-y-auto space-y-8",children:[e&&e.introduction&&f.jsx(Zh,{icon:f.jsx(mO,{className:"w-6 h-6 text-indigo-600"}),title:"Thng tin ng tuyn",className:"bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:f.jsx("div",{className:"space-y-2",children:e.introduction&&f.jsxs("div",{children:[f.jsx("p",{className:"text-xs font-bold text-indigo-800 uppercase mb-1",children:"Li nhn t ng vin"}),f.jsxs("p",{className:"text-gray-700 italic",children:['"',e.introduction,'"']})]})})}),s.cvUrl&&f.jsx(Zh,{icon:f.jsx(Sg,{className:"w-6 h-6"}),title:"H s nng lc (CV)",children:f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("a",{href:s.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition-colors shadow-sm",children:[f.jsx(Sg,{className:"w-5 h-5 mr-2"}),f.jsx("span",{className:"font-medium",children:"Ti xung / M trong tab mi"})]}),s.cvUrl.toLowerCase().endsWith(".pdf")&&f.jsx("button",{onClick:()=>y(!g),className:"text-sm text-gray-500 underline hover:text-indigo-600",children:g?"n xem trc":"Xem trc nhanh"})]}),g&&s.cvUrl&&f.jsxs("div",{className:"w-full h-[500px] border rounded-lg overflow-hidden bg-gray-100 mt-2 relative group",children:[f.jsx("iframe",{src:s.cvUrl,className:"w-full h-full",title:"CV Preview"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none bg-gray-50 opacity-0 group-hover:opacity-0 transition-opacity",children:f.jsx("p",{className:"text-gray-500",children:"ang ti bn xem trc..."})})]})]})}),s.bio&&f.jsx(Zh,{icon:f.jsx(WG,{className:"w-6 h-6"}),title:"Gii thiu",children:f.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:s.bio})}),s.skills&&s.skills.length>0&&f.jsx(Zh,{icon:f.jsx(CO,{className:"w-6 h-6"}),title:"K nng",children:f.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map(E=>f.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-sm font-medium px-3 py-1.5 rounded-full",children:E},E))})}),s.workHistory&&s.workHistory.length>0&&f.jsx(Zh,{icon:f.jsx(ii,{className:"w-6 h-6"}),title:"Lch s lm vic",children:f.jsx("div",{className:"space-y-4",children:s.workHistory.map((E,x)=>f.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[f.jsx("h5",{className:"font-bold text-gray-800",children:E.title}),f.jsx("p",{className:"text-sm text-gray-600",children:E.company}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:E.duration})]},x))})})]})]})]})})},GG=({userLocation:n,allJobs:e,currentUserData:t,onViewOnMap:r,onJobSelect:s})=>{const[i,a]=H.useState(5),[c,h]=H.useState(!1),[p,g]=H.useState([]),[y,E]=H.useState(!1),[x,P]=H.useState(null);H.useEffect(()=>{(async()=>{try{const ue=(await He.collection("users").doc(t.uid).get()).data();if(ue&&ue.lastRecommendations){const se=ue.lastRecommendations;se.results&&Array.isArray(se.results)&&se.results.length>0&&(g(se.results),a(se.radius||5),E(!0))}}catch(Y){console.error("Failed to load recommendation history",Y)}})()},[t.uid]);const O=H.useMemo(()=>n?e.filter(Q=>{const Y=Ig(Q.location);if(!Y)return!1;const ue=lO(n.lat,n.lng,Y.lat,Y.lng);return Q.distance=ue,ue<=i&&Q.status==="OPEN"}):[],[e,n,i]),M=async()=>{if(O.length===0){g([]),E(!0);return}h(!0);try{const Q=O.sort((ue,se)=>(ue.distance||0)-(se.distance||0)).slice(0,20),Y=await Tq(t,Q);g(Y),E(!0),await He.collection("users").doc(t.uid).update({lastRecommendations:{timestamp:new Date().toISOString(),radius:i,results:Y}})}catch(Q){console.error("Analysis failed",Q)}finally{h(!1)}},X=Q=>{const Y=O.find(ue=>ue.id===Q.jobId);Y&&P({rec:Q,job:Y})},W=Q=>Q>=80?"text-green-600 bg-green-100 border-green-200":Q>=50?"text-yellow-600 bg-yellow-100 border-yellow-200":"text-red-600 bg-red-100 border-red-200";return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 sm:p-10 text-white shadow-lg relative overflow-hidden",children:[f.jsxs("div",{className:"relative z-10",children:[f.jsxs("h2",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[f.jsx(Uo,{className:"w-8 h-8 text-yellow-300"}),"Gi  Vic lm Thng minh"]}),f.jsx("p",{className:"text-indigo-100 max-w-2xl",children:"S dng AI  phn tch h s ca bn, so snh khong cch, k nng v mc lng  tm ra cng vic ph hp nht trong khu vc."})]}),f.jsx("div",{className:"absolute top-0 right-0 -mr-10 -mt-10 w-40 h-40 bg-white opacity-10 rounded-full"}),f.jsx("div",{className:"absolute bottom-0 left-0 -ml-10 -mb-10 w-40 h-40 bg-purple-400 opacity-20 rounded-full"})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-6",children:[f.jsxs("div",{className:"w-full sm:w-2/3",children:[f.jsxs("label",{htmlFor:"radius",className:"block text-sm font-medium text-gray-700 mb-2",children:["Khong cch tm kim: ",f.jsxs("span",{className:"text-indigo-600 font-bold",children:[i," km"]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"range",id:"radius",min:"0.5",max:"10",step:"0.5",value:i,onChange:Q=>a(parseFloat(Q.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),f.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[f.jsx("span",{children:"500m"}),f.jsx("span",{children:"10km"})]})]})]}),f.jsx("div",{className:"w-full sm:w-auto flex-shrink-0",children:f.jsx("button",{onClick:M,disabled:c||!n,className:"w-full sm:w-auto bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:c?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang phn tch..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Uo,{className:"w-5 h-5"}),"Phn tch ngay"]})})})]}),!n&&f.jsxs("p",{className:"text-red-500 text-sm mt-2 flex items-center gap-1",children:[f.jsx(Go,{className:"w-4 h-4"}),"Vui lng bt nh v  s dng tnh nng ny."]}),n&&!y&&f.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Tm thy ",f.jsx("span",{className:"font-bold text-gray-800",children:O.length})," cng vic trong bn knh ",i,'km. Nhn "Phn tch ngay"  AI nh gi.']})]}),y&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Kt qu  xut (",p.length,")"]})}),p.length===0?f.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:[f.jsx(ii,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"Khng tm thy cng vic ph hp cao trong bn knh ny."}),f.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Hy th m rng khong cch tm kim hoc cp nht h s k nng ca bn."})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(Q=>{var ue;const Y=O.find(se=>se.id===Q.jobId);return Y?f.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md hover:border-indigo-300 transition-all flex flex-col h-full relative overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-gray-800 line-clamp-1",title:Y.title,children:Y.title}),f.jsx("p",{className:"text-sm text-gray-600 truncate",children:Y.employerName})]}),f.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-4 ${W(Q.matchScore)} shadow-sm flex-shrink-0 ml-2`,children:f.jsxs("span",{className:"text-sm font-bold",children:[Q.matchScore,"%"]})})]}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-4 space-x-3",children:[f.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[f.jsx(Go,{className:"w-3 h-3 mr-1"}),(ue=Y.distance)==null?void 0:ue.toFixed(1)," km"]}),f.jsxs("span",{className:"flex items-center bg-gray-100 px-2 py-1 rounded",children:[f.jsx(ii,{className:"w-3 h-3 mr-1"}),Y.jobType]})]}),f.jsxs("div",{className:"space-y-4 flex-grow",children:[f.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-100",children:[f.jsxs("p",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide mb-1 flex items-center gap-1",children:[f.jsx(Uo,{className:"w-3 h-3"}),"AI nh gi"]}),f.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed line-clamp-3",children:Q.reason})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-gray-100",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-green-700 text-xs mb-1",children:"u im chnh"}),f.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:Q.pros.slice(0,2).map((se,R)=>f.jsxs("li",{className:"truncate",children:[" ",se]},R))})]}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-red-700 text-xs mb-1",children:"Lu "}),f.jsx("ul",{className:"text-xs text-gray-600 space-y-0.5",children:Q.cons.slice(0,1).map((se,R)=>f.jsxs("li",{className:"truncate",children:[" ",se]},R))})]})]})]}),f.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[f.jsxs("button",{onClick:()=>X(Q),className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 shadow-sm",children:[f.jsx(Uo,{className:"w-4 h-4"}),"Chi tit AI"]}),f.jsxs("button",{onClick:()=>r(Y),className:"w-full bg-white text-indigo-600 font-bold py-2 px-4 rounded-lg border border-indigo-200 hover:bg-indigo-50 hover:border-indigo-400 transition-colors flex items-center justify-center gap-2",children:[f.jsx(Go,{className:"w-4 h-4"}),"Xem v tr"]})]})]},Q.jobId):null})})]}),x&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:()=>P(null),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden relative animate-fade-in-up max-h-[90vh] flex flex-col",onClick:Q=>Q.stopPropagation(),children:[f.jsxs("div",{className:"p-6 bg-indigo-600 text-white flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx(Uo,{className:"w-6 h-6 text-yellow-300"}),f.jsx("span",{className:"font-bold text-indigo-100 uppercase tracking-wider text-xs",children:"Phn tch chuyn su"})]}),f.jsx("h2",{className:"text-2xl font-bold",children:x.job.title}),f.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:x.job.employerName})]}),f.jsx("button",{onClick:()=>P(null),className:"text-white hover:bg-white/20 rounded-full p-1 transition-colors",children:f.jsx(V_,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded-xl border border-gray-200",children:[f.jsxs("div",{className:`w-16 h-16 rounded-full border-4 ${W(x.rec.matchScore)} flex items-center justify-center bg-white text-xl font-bold shadow-sm`,children:[x.rec.matchScore,"%"]}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Mc  ph hp"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Da trn h s k nng, v tr v mong mun ca bn."})]})]}),f.jsxs("div",{children:[f.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-2",children:[f.jsx(CO,{className:"w-5 h-5 text-indigo-500 mr-2"}),"Ti sao cng vic ny ph hp?"]}),f.jsx("p",{className:"text-gray-700 leading-relaxed bg-indigo-50 p-4 rounded-lg border border-indigo-100 text-sm",children:x.rec.reason})]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[f.jsx(u0,{className:"w-5 h-5 text-green-500 mr-2"}),"u im"]}),f.jsx("ul",{className:"space-y-2",children:x.rec.pros.map((Q,Y)=>f.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[f.jsx("span",{className:"mr-2 text-green-500",children:""}),Q]},Y))})]}),f.jsxs("div",{children:[f.jsxs("h4",{className:"flex items-center font-bold text-gray-800 mb-3",children:[f.jsx(fO,{className:"w-5 h-5 text-red-500 mr-2"}),"Cn cn nhc"]}),f.jsx("ul",{className:"space-y-2",children:x.rec.cons.map((Q,Y)=>f.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[f.jsx("span",{className:"mr-2 text-red-500",children:""}),Q]},Y))})]})]}),x.rec.environmentAnalysis&&f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Phn tch mi trng & Ri ro"}),f.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm text-gray-700",children:x.rec.environmentAnalysis})]})]}),f.jsxs("div",{className:"p-6 bg-gray-50 border-t flex flex-col sm:flex-row gap-3",children:[f.jsxs("button",{onClick:()=>{s(x.job)},className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md flex items-center justify-center gap-2",children:[f.jsx(dO,{className:"w-5 h-5"}),"Xem tin tuyn dng & ng tuyn"]}),f.jsxs("button",{onClick:()=>{r(x.job),P(null)},className:"w-full bg-white text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-100 border border-gray-300 transition-colors flex items-center justify-center gap-2",children:[f.jsx(Go,{className:"w-5 h-5"}),"Xem v tr trn bn "]})]})]})})]})},KG=({activeMode:n,setMode:e})=>f.jsxs("div",{className:"flex items-center bg-gray-200 rounded-lg p-1",children:[f.jsxs("button",{onClick:()=>e("list"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="list"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="list",children:[f.jsx(IG,{className:"w-4 h-4 mr-2"}),"Danh sch"]}),f.jsxs("button",{onClick:()=>e("map"),className:`flex items-center justify-center w-full px-3 py-1.5 text-sm font-semibold rounded-md transition-colors ${n==="map"?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-indigo-600"}`,"aria-pressed":n==="map",children:[f.jsx(TG,{className:"w-4 h-4 mr-2"}),"Bn "]})]}),QG=()=>{const{currentUser:n,currentUserData:e,loading:t}=so(),[r,s]=H.useState(pn.Jobs),[i,a]=H.useState(null),[c,h]=H.useState("list"),[p,g]=H.useState(null),[y,E]=H.useState(!1),[x,P]=H.useState(null),[O,M]=H.useState(null),[X,W]=H.useState([]),[Q,Y]=H.useState(!0),[ue,se]=H.useState(null),[R,S]=H.useState(null),[k,D]=H.useState(""),[N,j]=H.useState("");H.useEffect(()=>{var fe;const Ae=(fe=window.Capacitor)==null?void 0:fe.isNativePlatform();"serviceWorker"in navigator&&!Ae&&window.addEventListener("load",()=>{const ve=`${window.location.origin}/sw.js`;navigator.serviceWorker.register(ve).then(Me=>{console.log("Service Worker registered with scope:",Me.scope)}).catch(Me=>{console.error("Service Worker registration failed:",Me)})}),navigator.geolocation.getCurrentPosition(ve=>{se({lat:ve.coords.latitude,lng:ve.coords.longitude}),S(null)},ve=>{console.error("Geolocation error:",ve),S("Khng th ly v tr ca bn. Hy th cho php truy cp v tr trong trnh duyt  xem cc cng vic gn bn.")}),Y(!0);const Ne=SG(ve=>{W(ve),Y(!1)});return()=>{Ne()}},[]);const C=Ae=>{a(Ae)},We=Ae=>{Ae&&(a(null),s(pn.Jobs),h("map"),g(Ae.id))},Et=Ae=>{P(Ae),s(pn.Messaging)},Nt=async Ae=>{if(Ae)try{const Ne=await qW(Ae);O&&M(null),Et(Ne)}catch(Ne){console.error("Failed to start conversation:",Ne),alert("Khng th bt u cuc tr chuyn.")}},st=()=>{g(null)},ce=()=>{a(null)},Se=()=>{D(""),j("")},me=Ae=>{if(Ae.startsWith("/jobs/")){const Ne=Ae.split("/jobs/")[1],fe=X.find(ve=>ve.id===Ne);fe&&a(fe)}else Ae==="/profile"&&s(pn.Profile)},{uniqueLocations:F,uniqueTypes:J,filteredJobs:xe}=H.useMemo(()=>{const Ae=X.filter(Ue=>Ue.status==="OPEN"),Ne=ue?Ae.map(Ue=>{const it=Ig(Ue.location);if(it){const Vr=lO(ue.lat,ue.lng,it.lat,it.lng);return{...Ue,distance:Vr}}return Ue}):Ae,fe=[...new Set(Ne.map(Ue=>Ue.addressString))],ve=[...new Set(Ne.map(Ue=>Ue.jobType).filter(Boolean))];let Me=Ne;return k&&(Me=Me.filter(Ue=>Ue.addressString===k)),N&&(Me=Me.filter(Ue=>Ue.jobType===N)),ue&&Me.sort((Ue,it)=>(Ue.distance??1/0)-(it.distance??1/0)),{uniqueLocations:fe,uniqueTypes:ve,filteredJobs:Me}},[X,k,N,ue]),De=()=>{const Ae=r;return f.jsx("div",{className:"animate-fade-in-up",style:{animationDuration:"0.4s"},children:(()=>{switch(r){case pn.Jobs:return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[f.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Tm kim vic lm"}),f.jsx(KG,{activeMode:c,setMode:h})]}),f.jsx(_G,{locations:F,types:J,locationFilter:k,typeFilter:N,onLocationChange:D,onTypeChange:j,onReset:Se}),R&&f.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 p-4 rounded-r-lg",role:"alert",children:[f.jsx("p",{className:"font-bold",children:"Thng bo"}),f.jsx("p",{children:R})]}),c==="list"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4",children:"Vic lm kh dng"}),Q?f.jsx(ar,{message:"ang ti cng vic..."}):xe.length>0?xe.map(Ne=>f.jsx(uq,{job:Ne,onClick:()=>C(Ne),applicantCount:Ne.applicantCount||0},Ne.id)):f.jsx("div",{className:"text-center py-16 px-4 bg-gray-50 rounded-lg",children:f.jsx("p",{className:"text-gray-600",children:"Khng tm thy cng vic no ph hp vi b lc ca bn."})})]}),c==="map"&&f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800 pt-4 mb-4",children:"V tr cng vic"}),Q?f.jsx(ar,{}):f.jsx(EG,{jobs:xe,onJobSelect:C,focusedJobId:p,onFocusComplete:st,userLocation:ue})]})]});case pn.Recommendations:return f.jsx(GG,{userLocation:ue,allJobs:X,currentUserData:e,onViewOnMap:We,onJobSelect:C});case pn.Insurance:return f.jsx(gq,{});case pn.Messaging:return f.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:f.jsx(Eq,{initialSelectedConversationId:x,clearInitialSelection:()=>P(null)})});case pn.Chatbot:return f.jsx("div",{className:"h-[calc(100vh-12rem)] md:h-[calc(100vh-10rem)]",children:f.jsx(uG,{allJobs:xe})});case pn.Profile:return f.jsx(DG,{onViewProfile:(Ne,fe)=>M({userId:Ne,applicationContext:fe}),onJobSelect:C});default:return null}})()},Ae)};return t?f.jsx(ar,{fullScreen:!0,message:"ang ti ng dng..."}):n?!e||!e.fullName?f.jsx($G,{}):f.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe",children:[f.jsx(oq,{activeView:r,setActiveView:s,onPostJobClick:()=>E(!0),onNotificationNavigate:me}),f.jsx("main",{className:"max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 md:py-10 pb-28 md:pb-10",children:De()}),i&&f.jsx(gG,{job:i,onClose:ce,onViewOnMap:()=>We(i)}),y&&f.jsx(LG,{onClose:()=>E(!1)}),O&&f.jsx(qG,{userId:O.userId,application:O.applicationContext,onClose:()=>M(null),onStartChat:O.applicationContext?()=>Nt(O.applicationContext):void 0})]}):f.jsx(zG,{})},kO=document.getElementById("root");if(!kO)throw new Error("Could not find root element to mount to");const YG=QN.createRoot(kO);YG.render(f.jsx($L.StrictMode,{children:f.jsx(WW,{children:f.jsx(QG,{})})}));
